@&#MAIN-TITLE@&#A mixed-integer linear programming model to optimize the vertical alignment considering blocks and side-slopes in road construction

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Vertical alignment is computed using a mixed-integer linear program.


                        
                        
                           
                           More than 15 percent error reduction is achieved using side-slopes approximation.


                        
                        
                           
                           Natural blocks are handled without breaking the linearity of the model.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Combinatorial optimization

Mixed integer linear program

OR in road design (natural resources)

Earthwork optimization

Vertical alignment optimization

@&#ABSTRACT@&#


               
               
                  In the vertical alignment phase of road design, one minimizes the cost of moving material between different sections of the road while maintaining safety and building code constraints. Existing vertical alignment models consider neither the side-slopes of the road nor the natural blocks like rivers, mountains, etc., in the construction area. The calculated cost without the side-slopes can have significant errors (more than 20 percent), and the earthwork schedule without considering the blocks is unrealistic. In this study, we present a novel mixed integer linear programming model for the vertical alignment problem that considers both of these issues. The numerical results show that the approximation of the side-slopes can generate solutions within an acceptable error margin specified by the user without increasing the time complexity significantly.
               
            

@&#INTRODUCTION@&#

Road design, the question of how to build a new road from A to B, is surprisingly complicated. Given the infinite number of potential roads between any two points, it is obvious that enumerating ‘all potential options’ and then selecting the best is obviously impossible. What is less obvious, is that even given just two options, the question of evaluating each option for comparison is quite hard.

A potential road is often viewed as a fixed horizontal alignment, i.e., a road trajectory from a satellite’s eye view. In order to evaluate the cost of the potential road, the road designer is required to look at the vertical ground profile along the horizontal alignment and select a vertical road profile. The road profile must respect various grade constraints and other road specifications, while simultaneously minimizing the cost of construction. Finding this vertical road profile is called the vertical alignment problem in road design (AASHTO, 2004; Jha et al., 2006). As the solution to the vertical alignment problem is used to evaluate a potential horizontal alignment, the ability to create an accurate optimal vertical alignment is a key step to determining a final road design. (Note that, the optimal vertical alignment alone is not sufficient to evaluate a horizontal alignment; other factors such as land acquisition costs and changes to traffic flow must be considered Angulo et al. 2014; Maji and Jha 2011.)

The vertical alignment problem arises in a wide range of design road scenarios: from highways to mountain roads and from new roads to lane expansion. As such, it can be viewed as a highly important sub-problem in road design. Unlike horizontal alignment, vertical alignment optimization is a well-defined problem, which does not depend on non-mathematical factors like political issues. As such, it is studied comprehensively and several different modeling techniques can be found in the literature (see Section 1.1 ). In this study, we propose a new model to optimize the vertical alignment for a predetermined horizontal alignment.

This new model advances the current state-of-the-art for vertical alignment in several ways, all of which are focused on increasing the accuracy of the vertical alignment problem. Working from Moreb (2009) and Koch and Lucet (2010), we extend the vertical alignment model to include blocks and side-slopes.

Blocks are physical challenges, such as bridging a river or tunneling through a mountain, that must be overcome before earth movement can occur. It is known that, ‘optimal vertical alignments’ that do not properly implement blocks are unrealistic and therefore inaccurate (Hare et al., 2011). To incorporate blocks into vertical alignment we adapt the work of Hare et al. (2011).

Side-slopes are the gradual slopes on the sides of the road required for stability. The existence of side-slopes implies that the amount of earthwork required is not linear in relation to the change in road height. Ignoring this within a vertical alignment model results in a noticeable error in the solution. To incorporate side-slopes into vertical alignment, we introduce approximation slabs (details appear in Section 2). Using real-life test problems, we find that modeling without side-slopes results in errors ranging from 20 percent to 40 percent.

The overall result is a new model for the vertical alignment problem that is significantly more accurate than previous models. These results are applicable to any company working in road design, and in particular are implemented in our industrial partner’s road design software.

Within this work we provide details on how the vertical alignment model was adapted to incorporate blocks and side-slopes (Sections 2 and 3). After providing some analysis of the new model (Section 4), we compare the model’s robustness and accuracy to previous methods (Section 5.2). Finally, we examine how the model behavior is affected by several of the design variables (Section 5.3). This provides insight on how to select appropriate values for these variables in practice. We end with some concluding remarks.

Before detailing our model and solution techniques for vertical alignment, we provide a brief historical overview of the vertical alignment problem.

The vertical alignment problem has been approached in several manners. Numerical search, dynamic programming, and mathematical programming are frequently applied approaches (Jha et al., 2006). One of the successful attempts using numerical search can be found in Goh and Teo (1988), in which the vertical alignment problem is formulated as a calculus of variations problem and then converted to an optimal control problem. The resulting model becomes a general constrained non-linear optimization problem that can be solved by known numerical search algorithms. Most dynamic programming attempts discretize the search space by horizontal and vertical grid lines, where each of the horizontal grid lines stands for a state, and each of the vertical grid lines represents a stage in the multi-stage decision process. The output of this formulation is the elevation along each vertical grid line. (A mixed-integer linear programming producing the same output can be found in Trypia (1979).) The studies by Goh et al. (1988),Fwa (1989), and Goktepe et al. (2005) are based on a similar concept with different improvements. A recent approach using dynamic programming (Goktepe et al., 2009) integrated the Weighted Ground Line Method (WGLM) of earthwork optimization with a dynamic programming model of vertical alignment. A numerical search cannot guarantee the global optimality for a complex model, and dynamic programing can miss a good solution because of the discretization process and the required post-processing steps.


                        Mayer and Stark (1981) developed a linear programming model that minimizes the earth moving cost while balancing the earth quantities in any section. A similar model was developed by Nandgaonkar (1981). Oglesby and Hicks (1982) used a combination of a graphical method called the mass haul diagram and linear programming for earthwork optimization. Easa (1988) extended the model of Mayer and Stark (1981) and proposed a numerical search algorithm that looks for a feasible vertical alignment while optimizing earthwork operations by linear programming as a sub-routine. Easa (1987); 1988) considered nonconstant unit cost for material movement, and for linear unit costs he proposed a quadratic programming model (Easa, 1988) of the earthwork operation. Moreb and Bafail advanced these techniques and demonstrated they could be used to solve the land-leveling problem (a specific example of earthwork optimization) (Moreb and Bafail, 1994). Moreb (1996) further modeled the vertical alignment and earthwork operation in a single linear program. Both Easa’s model (Easa, 1988) and Moreb’s model (Moreb, 1996) give piecewise linear alignments. ReVelle et al. (1997) developed a model that approximated the road profile with a fifth order polynomial while using a linear program to find the optimal coefficients of the polynomial. Aljohani and Moreb (2003) gave a more flexible representation using polynomials of any degree. The problem of using a single polynomial is that the solution is highly dependent on its degree. Moreb and Aljohani (2004) found a quadratic spline representation of the road profile that minimizes earthwork cost using linear programming to avoid the shortcomings of the polynomial approach. Moreb (2009) further improved the model by adding some additional constraints that ensure smoothness at the connectivity of two spline pieces and generalized the technique with a piecewise polynomial of any degree. Koch and Lucet (2010) improved the accuracy of the spline model by changing two constraints and reported that only a linear or a quadratic spline could be used while maintaining the linear structure of the model. Hare et al. (2014) recently examined a variety of techniques to improve the speed of solving the vertical alignment problem. (For more information on these techniques we refer to Rahman (2012) and references therein.) The research in this paper focuses on improving the overall accuracy of the vertical alignment problem.

Among the other recent models on the vertical alignment problem, Goktepe et al. (2009) proposed a genetic algorithm based on a constrained curve-fitting method, and Garber and Hoel (2009) used a greedy mass haul diagram based approach. A detailed survey about the research in this area can be found in Jha et al. (2006).


                        Hao and Pan (2011) studied the accuracy of earthwork calculation based on triangulated information. Later, Cheng and Jiang (2013) compared the accuracy resulting from the 2D average-end-area method vs. 3D models. They confirmed the feasibility of the average-end-area method widely used in the literature when section lengths are less than 30 meters. Consequently, one does not have to resort to more computationally expensive models that track movements of each block of material (Burdett and Kozan, 2010; 2014) (blocks in these two articles refer to a volume of material while blocks in Koch and Lucet (2010); Hare et al. (2011) and the present article is to be understood as an obstacle).

An example of vertical alignment is shown in Fig. 1
                     , where the s-axis represents the station points, and the h-axis represents the elevations. Ground and road profiles are the states of the construction area before and after the road is constructed. The construction area is divided into smaller units called sections. The set 
                        
                           S
                           =
                           {
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           n
                           }
                        
                      holds the indices of all the sections. The road profile is represented by a quadratic spline. The set 
                        
                           G
                           =
                           {
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           m
                           }
                        
                      holds the indices of all the spline segments. For all 
                        
                           g
                           ∈
                           G
                           ,
                        
                      the equation for each spline segment is

                        
                           (2.1)
                           
                              
                                 
                                    P
                                    g
                                 
                                 
                                    (
                                    x
                                    )
                                 
                                 =
                                 
                                    a
                                    
                                       g
                                       ,
                                       1
                                    
                                 
                                 +
                                 
                                    a
                                    
                                       g
                                       ,
                                       2
                                    
                                 
                                 x
                                 +
                                 
                                    a
                                    
                                       g
                                       ,
                                       3
                                    
                                 
                                 
                                    x
                                    2
                                 
                                 .
                              
                           
                        
                     A spline segment spans one or more sections. If a spline segment g spans ng
                      sections, then we define the set 
                        
                           
                              S
                              g
                           
                           =
                           
                              {
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              
                                 n
                                 g
                              
                              }
                           
                        
                     . Consequently,

                        
                           (2.2)
                           
                              
                                 n
                                 =
                                 
                                    ∑
                                    
                                       g
                                       ∈
                                       G
                                    
                                 
                                 
                                    n
                                    g
                                 
                                 .
                              
                           
                        
                     The starting station point of the ith section of the gth spline segment is denoted by s
                     
                        g, i
                     , and the ending station point is denoted by s
                     
                        g, i + 1. So, by definition

                        
                           
                              
                                 
                                    s
                                    
                                       g
                                       ,
                                       
                                          n
                                          g
                                       
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    s
                                    
                                       g
                                       +
                                       1
                                       ,
                                       1
                                    
                                 
                                 
                                    ,
                                    
                                    
                                    for
                                    
                                    all
                                    
                                    
                                    g
                                    ∈
                                    G
                                    ∖
                                    
                                       {
                                       m
                                       }
                                    
                                    .
                                 
                              
                           
                        
                     The function

                        
                           (2.3)
                           
                              
                                 ϰ
                                 :
                                 (
                                 G
                                 ,
                                 
                                    S
                                    g
                                 
                                 )
                                 →
                                 S
                              
                           
                        
                     maps the section index in a spline segment to the absolute section index. The spline representing the road profile in Fig. 1
has 5 segments, and each segment spans 10 sections. An example of the mapping function is ϰ(2, 1) = 11. Since the constructed road cannot be too steep, the slope of the spline segments must be bounded. For a spline segment g, Lg
                      and Ug
                      represent the lower and upper bounds of its slope. The set 
                        H
                      consists of pairs (s, H) such that the elevation of the road must be H at station point s, and the set 
                        
                           H
                           
                              
                              ′
                           
                        
                      consists of pairs 
                        
                           (
                           s
                           ,
                           
                              H
                              
                                 
                                 ′
                              
                           
                           )
                        
                      such that the slope of the road must be 
                        
                           H
                           
                              
                              ′
                           
                        
                      at station point s. Normally, 
                        H
                      and 
                        
                           H
                           
                              
                              ′
                           
                        
                      contain data for the start and end stations of the road.


A section is called a cut (respectively fill), if the volume difference between the ground profile and the road profile at the section is positive (respectively negative). The net volume of a cut (respectively fill) is positive (respectively negative). Borrow pits are external sections from which earth can be borrowed, and waste pits are external sections to which earth can be dumped. Both borrow and waste pits incur a usage cost. By design, a borrow pit is always a cut, and a waste pit is always a fill. There are nb
                      borrow pits, which are indexed by the set 
                        
                           B
                           =
                           {
                           n
                           +
                           1
                           ,
                           n
                           +
                           2
                           ,
                           …
                           ,
                           n
                           +
                           
                              n
                              b
                           
                           }
                           ,
                        
                      
                     nw
                      waste pits, which are indexed by the set 
                        
                           W
                           =
                           {
                           n
                           +
                           
                              n
                              b
                           
                           +
                           1
                           ,
                           n
                           +
                           
                              n
                              b
                           
                           +
                           2
                           ,
                           …
                           ,
                           n
                           +
                           
                              n
                              b
                           
                           +
                           
                              n
                              w
                           
                           }
                        
                     . The function

                        
                           (2.4)
                           
                              
                                 ϑ
                                 :
                                 B
                                 →
                                 S
                              
                           
                        
                     maps the borrow pit index to the section index to which it is attached and the function

                        
                           (2.5)
                           
                              
                                 φ
                                 :
                                 W
                                 →
                                 S
                              
                           
                        
                     maps the waste pit index to the section index to which it is attached. The distance from a borrow or waste pit to the associated section is called the dead haul distance and is denoted by 
                        
                           
                              d
                              ˜
                           
                           i
                        
                      where 
                        
                           i
                           ∈
                           B
                           ∪
                           W
                        
                     . The capacity of the ith borrow pit (respectively waste pit) is denoted by 
                        
                           C
                           
                              i
                           
                           b
                        
                      (respectively 
                        
                           C
                           
                              i
                           
                           w
                        
                     ). The index set 
                        
                           N
                           =
                           S
                           ∪
                           B
                           ∪
                           W
                        
                      is defined to be the set of all the sections, borrow pits, and waste pits indices.

Moving earth from a borrow pit to a waste pit introduces costs without any benefit and is not permitted.

The set 
                        
                           
                              N
                              ^
                           
                           2
                        
                      consists of all pairs of indices (i, j) such that moving earth from section i to section j is permitted. The definition of 
                        
                           
                              N
                              ^
                           
                           2
                        
                      is

                        
                           (2.6)
                           
                              
                                 
                                    
                                       N
                                       ^
                                    
                                    2
                                 
                                 =
                                 
                                    {
                                    
                                       (
                                       i
                                       ,
                                       j
                                       )
                                    
                                    :
                                    
                                       
                                          
                                             
                                                j
                                                ∈
                                                S
                                                ∪
                                                W
                                                ,
                                                
                                                j
                                                ≠
                                                i
                                             
                                          
                                          
                                             
                                                
                                                if
                                                
                                                
                                                
                                                i
                                                ∈
                                                S
                                             
                                          
                                       
                                       
                                          
                                             
                                                j
                                                ∈
                                                S
                                             
                                          
                                          
                                             
                                                
                                                if
                                                
                                                
                                                
                                                i
                                                ∈
                                                B
                                             
                                          
                                       
                                    
                                    }
                                 
                                 .
                              
                           
                        
                     
                  

A block is an obstacle that needs to be dealt with before any earth can be moved over the location (Hare et al., 2011). There are nz
                      blocks, which are indexed by the set 
                        
                           I
                           =
                           {
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           
                              n
                              z
                           
                           }
                        
                     . The function

                        
                           (2.7)
                           
                              
                                 ς
                                 :
                                 I
                                 →
                                 S
                              
                           
                        
                     maps the block index to the section index. The process is discretized into time-steps to deal with blocks. The set 
                        T
                      contains the indices of the time-steps, and the binary variable ykt
                      represents whether a block 
                        
                           k
                           ∈
                           I
                        
                      is present at time-step t (ykt
                      = 0) or not (ykt
                      = 1). It is ensured that at each time-step at least one block is removed, i.e., the number of time-steps is at most nz
                      + 1. An access road is defined as a road that gives access for earthwork to begin at any section to which it is attached. We assume that there is a borrow pit and a waste pit with infinite capacity attached with each access road. We need the following definitions,

                        
                           (2.8)
                           
                              
                                 
                                    N
                                    
                                       b
                                    
                                    k
                                 
                                 =
                                 
                                    {
                                    
                                       (
                                       i
                                       ,
                                       j
                                       )
                                    
                                    ∈
                                    
                                       
                                          N
                                          ^
                                       
                                       2
                                    
                                    :
                                    
                                    block
                                    
                                    k
                                    
                                    is
                                    
                                    between
                                    
                                    i
                                    
                                    and
                                    
                                    j
                                    }
                                 
                              
                           
                        
                     
                     
                        
                           (2.9)
                           
                              
                                 
                                    N
                                    
                                       b
                                    
                                    
                                       
                                          k
                                          1
                                       
                                       ,
                                       
                                          k
                                          2
                                       
                                    
                                 
                                 =
                                 
                                    {
                                    i
                                    ∈
                                    N
                                    :
                                    
                                    
                                       
                                          
                                             
                                                i
                                                
                                                is
                                                
                                                between
                                                
                                                blocks
                                                
                                                
                                                   k
                                                   1
                                                
                                                
                                                and
                                                
                                                
                                                   k
                                                   2
                                                
                                                
                                                and
                                                
                                                there
                                                
                                                is
                                             
                                          
                                       
                                       
                                          
                                             
                                                no
                                                
                                                access
                                                
                                                road
                                                
                                                between
                                                
                                                blocks
                                                
                                                
                                                   k
                                                   1
                                                
                                                
                                                and
                                                
                                                
                                                   k
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    }
                                 
                              
                           
                        
                     
                     
                        
                           (2.10)
                           
                              
                                 
                                    N
                                    
                                       b
                                    
                                    
                                       ←
                                       ,
                                       k
                                    
                                 
                                 =
                                 
                                    {
                                    i
                                    ∈
                                    N
                                    :
                                    
                                    
                                       
                                          
                                             
                                                i
                                                
                                                is
                                                
                                                before
                                                
                                                block
                                                
                                                k
                                                
                                                and
                                                
                                                there
                                                
                                                is
                                             
                                          
                                       
                                       
                                          
                                             
                                                no
                                                
                                                access
                                                
                                                road
                                                
                                                before
                                                
                                                block
                                                
                                                k
                                             
                                          
                                       
                                    
                                    }
                                 
                              
                           
                        
                     
                     
                        
                           (2.11)
                           
                              
                                 
                                    N
                                    
                                       b
                                    
                                    
                                       k
                                       ,
                                       →
                                    
                                 
                                 =
                                 
                                    {
                                    i
                                    ∈
                                    N
                                    :
                                    
                                    
                                       
                                          
                                             
                                                i
                                                
                                                is
                                                
                                                after
                                                
                                                block
                                                
                                                k
                                                
                                                and
                                                
                                                there
                                                
                                                is
                                             
                                          
                                       
                                       
                                          
                                             
                                                no
                                                
                                                access
                                                
                                                road
                                                
                                                after
                                                
                                                block
                                                
                                                k
                                             
                                          
                                       
                                    
                                    }
                                 
                                 .
                              
                           
                        
                     
                  

The cost for cutting earth from a section is called the excavation cost, the cost for moving earth from a section to another section is called the hauling cost, and the cost for filling a section with earth is called the embankment cost. For 
                        
                           i
                           ∈
                           N
                           ,
                        
                      the per unit volume excavation cost is pi
                     , and the per unit volume embankment cost is qi
                     . For 
                        
                           i
                           ,
                           j
                           ∈
                           N
                           ,
                        
                      the per unit volume hauling cost from i to j is cij
                     . In order to retain the logical consistency in the problem, the cost must maintain strict triangular inequality, i.e., for all 
                        
                           i
                           ,
                           j
                           ,
                           k
                           ∈
                           N
                           ,
                        
                      
                     i ≠ j, j ≠ k, and k ≠ i,

                        
                           (2.12)
                           
                              
                                 
                                    p
                                    i
                                 
                                 +
                                 
                                    c
                                    
                                       i
                                       j
                                    
                                 
                                 +
                                 
                                    q
                                    j
                                 
                                 <
                                 
                                    (
                                    
                                       p
                                       i
                                    
                                    +
                                    
                                       c
                                       
                                          i
                                          k
                                       
                                    
                                    +
                                    
                                       q
                                       k
                                    
                                    )
                                 
                                 +
                                 
                                    (
                                    
                                       p
                                       k
                                    
                                    +
                                    
                                       c
                                       
                                          k
                                          j
                                       
                                    
                                    +
                                    
                                       q
                                       j
                                    
                                    )
                                 
                                 ;
                              
                           
                        
                     see Hare et al. (2011) for the details.


The decision variables are

                        
                           •
                           
                              
                                 
                                    V
                                    
                                       i
                                    
                                    +
                                 
                               (for all 
                                 
                                    i
                                    ∈
                                    S
                                 
                              ): excavated volume for a section,


                              
                                 
                                    V
                                    
                                       i
                                    
                                    −
                                 
                               (for all 
                                 
                                    i
                                    ∈
                                    S
                                 
                              ): embanked volume for a section,


                              xijt
                               (for all 
                                 
                                    
                                       (
                                       i
                                       ,
                                       j
                                       )
                                    
                                    ∈
                                    
                                       N
                                       2
                                    
                                    ,
                                    t
                                    ∈
                                    T
                                 
                              ): hauled volume from i to j at time-step t,


                              a
                              
                                 g, k
                               (for all 
                                 
                                    g
                                    ∈
                                    G
                                    ,
                                    k
                                    ∈
                                    {
                                    1
                                    ,
                                    2
                                    ,
                                    3
                                    }
                                 
                              ): the coefficients of the quadratic spline,


                              ui
                               (for all 
                                 
                                    i
                                    ∈
                                    S
                                 
                              ): the elevation difference of the ground profile from the road profile for a section,


                              ykt
                               (for all 
                                 
                                    t
                                    ∈
                                    T
                                    ,
                                    k
                                    ∈
                                    I
                                 
                              ): the block removal indicators, and


                              bi
                               (for all 
                                 
                                    i
                                    ∈
                                    S
                                 
                              ): stockpiling variables.

It should be noted that the lower and upper bounds for ui
                      are 
                        u
                      
                     
                        i
                      and 
                        
                           
                              u
                              ¯
                           
                           i
                        
                      respectively, ui
                      > 0 represents a cut, ui
                      < 0 represents a fill, and ui
                      = 0 represents a section that is neither cut nor fill. The maximum excavated volume is 
                        
                           M
                           
                              i
                           
                           +
                        
                      and the maximum embanked volume is 
                        
                           M
                           
                              i
                           
                           −
                        
                      for a section i. We define M to be

                        
                           (2.13)
                           
                              
                                 M
                                 =
                                 
                                    max
                                    
                                       i
                                       ∈
                                       S
                                    
                                 
                                 
                                    {
                                    
                                       M
                                       
                                          i
                                       
                                       +
                                    
                                    ,
                                    
                                       M
                                       
                                          i
                                       
                                       −
                                    
                                    }
                                 
                                 ,
                              
                           
                        
                     and δ to be a very small positive number equal to the smallest possible positive excavated or embanked volume.

The time-steps and blocks introduce an interesting phenomenon called stockpiling (Hare et al., 2011). Stockpiling is storing earth temporarily in a section until a block is removed and then moving the stored earth on the other side of the block. If the amount of stockpiling is not checked, then additional temporary blocks may be created. Stockpiling constraints in Hare et al. (2011) limit the amount of earth that can be stockpiled. However, the excavation cost of stockpiled earth is less than the excavation cost of a section, which is not considered in Hare et al. (2011). To avoid this source of error, this model assumes no stockpiling occurs. In terms of modeling, this assumption does not allow both 
                        
                           V
                           
                              i
                           
                           +
                        
                      and 
                        
                           V
                           
                              i
                           
                           −
                        
                      to have a positive value for a section i, and the binary variables bi
                      ensure that.


                     Moreb (2009) does not consider the side-slopes of the roads when calculating the volume. Without the side-slopes the volume of a section i is a linear function of ui
                     . But with side-slopes the cross-section of the road at a section is a trapezoid (see Figs. 2 and 3
                     
                     ) and the volume becomes a quadratic function of ui
                     , i.e., the linear structure of the model is violated. A similar issue was addressed by Easa (1988) and a quadratic programming model was proposed. However, in this research we maintain the linear structure of the model by approximating the cut volume of a section i with 
                        
                           k
                           
                              i
                           
                           +
                        
                      rectangular bars and the fill volume with 
                        
                           k
                           
                              i
                           
                           −
                        
                     rectangular bars. These rectangular bars are called slabs. One such approximation is shown in Figs. 2 and 3. For a cut i, the areas and heights of slabs are 
                        
                           A
                           
                              i
                           
                           k
                        
                      and 
                        
                           
                              u
                              ¯
                           
                           
                              i
                           
                           k
                        
                      respectively, where 
                        
                           k
                           ∈
                           {
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           
                              k
                              
                                 i
                              
                              +
                           
                           }
                           ,
                        
                      and for a fill, they are 
                        
                           B
                           
                              i
                           
                           k
                        
                      and 
                        
                           
                              
                                 u
                                 ̲
                              
                              
                                 i
                              
                              k
                           
                           ,
                        
                      where 
                        
                           k
                           ∈
                           {
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           
                              k
                              
                                 i
                              
                              −
                           
                           }
                        
                     .

The objective of this problem is to find the vertical alignment while minimizing the total excavation cost, embankment cost, and hauling cost. So, the objective function can be written as,

                        
                           (3.1)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          min
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                S
                                             
                                          
                                          
                                             (
                                             
                                                p
                                                i
                                             
                                             
                                                V
                                                
                                                   i
                                                
                                                +
                                             
                                             +
                                             
                                                q
                                                i
                                             
                                             
                                                V
                                                
                                                   i
                                                
                                                −
                                             
                                             )
                                          
                                          +
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                B
                                             
                                          
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                S
                                             
                                          
                                          
                                             ∑
                                             
                                                t
                                                ∈
                                                T
                                             
                                          
                                          
                                             p
                                             i
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                                t
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          
                                          
                                          
                                          
                                          
                                          
                                          
                                          
                                          +
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                W
                                             
                                          
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                S
                                             
                                          
                                          
                                             ∑
                                             
                                                t
                                                ∈
                                                T
                                             
                                          
                                          
                                             q
                                             i
                                          
                                          
                                             x
                                             
                                                j
                                                i
                                                t
                                             
                                          
                                          +
                                          
                                             ∑
                                             
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                
                                                ∈
                                                
                                                   
                                                      N
                                                      ^
                                                   
                                                   2
                                                
                                             
                                          
                                          
                                             ∑
                                             
                                                t
                                                ∈
                                                T
                                             
                                          
                                          
                                             c
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             x
                                             
                                                i
                                                j
                                                t
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     The first set of constraints are called the balance constraints: for 
                        
                           i
                           ∈
                           S
                           ,
                        
                     
                     
                        
                           (3.2)
                           
                              
                                 
                                    ∑
                                    
                                       t
                                       ∈
                                       T
                                    
                                 
                                 
                                    ∑
                                    
                                       j
                                       ∈
                                       S
                                       ∪
                                       W
                                    
                                 
                                 
                                    x
                                    
                                       i
                                       j
                                       t
                                    
                                 
                                 =
                                 
                                    V
                                    
                                       i
                                    
                                    +
                                 
                                 
                                 and
                                 
                                 
                                    ∑
                                    
                                       t
                                       ∈
                                       T
                                    
                                 
                                 
                                    ∑
                                    
                                       j
                                       ∈
                                       S
                                       ∪
                                       B
                                    
                                 
                                 
                                    x
                                    
                                       j
                                       i
                                       t
                                    
                                 
                                 =
                                 
                                    V
                                    
                                       i
                                    
                                    −
                                 
                                 .
                              
                           
                        
                     The pit constraints define the capacity of the borrow and waste pits: for all 
                        
                           i
                           ∈
                           B
                           ∪
                           W
                           ,
                        
                     
                     
                        
                           (3.3)
                           
                              
                                 
                                    ∑
                                    
                                       t
                                       ∈
                                       T
                                    
                                 
                                 
                                    ∑
                                    
                                       j
                                       ∈
                                       S
                                    
                                 
                                 
                                    x
                                    
                                       i
                                       j
                                       t
                                    
                                 
                                 ≤
                                 
                                    C
                                    
                                       i
                                    
                                    b
                                 
                                 
                                    (
                                    if
                                    
                                    i
                                    ∈
                                    B
                                    )
                                 
                                 
                                 and
                                 
                                 
                                    ∑
                                    
                                       t
                                       ∈
                                       T
                                    
                                 
                                 
                                    ∑
                                    
                                       j
                                       ∈
                                       S
                                    
                                 
                                 
                                    x
                                    
                                       j
                                       i
                                       t
                                    
                                 
                                 ≤
                                 
                                    C
                                    
                                       i
                                    
                                    w
                                 
                                 
                                    (
                                    if
                                    
                                    i
                                    ∈
                                    W
                                    )
                                 
                                 .
                              
                           
                        
                     A few constraints are required to handle blocks in the model. From the definition of blocks, no earth movement is allowed over a block until it is removed: for all 
                        
                           
                              t
                              ∈
                              T
                              ∖
                              
                                 {
                                 1
                                 }
                              
                              ,
                              
                                 (
                                 i
                                 ,
                                 j
                                 )
                              
                              ∈
                           
                           
                              N
                              
                                 b
                              
                              k
                           
                           ,
                        
                     
                     
                        
                           (3.4a)
                           
                              
                                 
                                    x
                                    
                                       i
                                       j
                                       t
                                    
                                 
                                 ≤
                                 M
                                 
                                    y
                                    
                                       k
                                       ,
                                       t
                                       −
                                       1
                                    
                                 
                                 .
                              
                           
                        
                     At the same time, if there is no access road between two blocks, before the first block, or after the last block, earth movement must be prohibited among those sections: for all 
                        
                           
                              t
                              ∈
                              T
                              ∖
                              
                                 {
                                 1
                                 }
                              
                              ,
                           
                           
                              k
                              1
                           
                           ,
                           
                              k
                              2
                           
                           ∈
                           I
                           ,
                           i
                           ,
                           j
                           ∈
                           
                              N
                              
                                 b
                              
                              
                                 
                                    k
                                    1
                                 
                                 ,
                                 
                                    k
                                    2
                                 
                              
                           
                           ,
                        
                     
                     
                        
                           (3.4b)
                           
                              
                                 
                                    x
                                    
                                       i
                                       j
                                       t
                                    
                                 
                                 ≤
                                 M
                                 
                                    y
                                    
                                       
                                          k
                                          1
                                       
                                       ,
                                       t
                                       −
                                       1
                                    
                                 
                                 +
                                 M
                                 
                                    y
                                    
                                       
                                          k
                                          2
                                       
                                       ,
                                       t
                                       −
                                       1
                                    
                                 
                                 ,
                              
                           
                        
                     for all 
                        
                           
                              t
                              ∈
                              T
                              ∖
                              
                                 {
                                 1
                                 }
                              
                              ,
                              k
                              ∈
                              I
                              ,
                              i
                              ,
                              j
                              ∈
                           
                           
                              N
                              
                                 b
                              
                              
                                 ←
                                 ,
                                 k
                              
                           
                           ,
                        
                     
                     
                        
                           (3.4c)
                           
                              
                                 
                                    x
                                    
                                       i
                                       j
                                       t
                                    
                                 
                                 ≤
                                 M
                                 
                                    y
                                    
                                       k
                                       ,
                                       t
                                       −
                                       1
                                    
                                 
                                 ,
                              
                           
                        
                     and for all 
                        
                           
                              t
                              ∈
                              T
                              ∖
                              
                                 {
                                 1
                                 }
                              
                              ,
                              k
                              ∈
                              I
                              ,
                              i
                              ,
                              j
                              ∈
                           
                           
                              N
                              
                                 b
                              
                              
                                 k
                                 ,
                                 →
                              
                           
                           ,
                        
                     
                     
                        
                           (3.4d)
                           
                              
                                 
                                    x
                                    
                                       i
                                       j
                                       t
                                    
                                 
                                 ≤
                                 M
                                 
                                    y
                                    
                                       k
                                       ,
                                       t
                                       −
                                       1
                                    
                                 
                                 .
                              
                           
                        
                     The next set of block constraints are called the block removal indicator constraints, which set the variables ykt
                      (for all 
                        
                           k
                           ∈
                           I
                           ,
                           t
                           ∈
                           T
                        
                     ) to the value 1 indicating the block is removed. These constraints in Hare et al. (2011) have 
                        
                           
                              y
                              
                                 k
                                 t
                              
                           
                           
                              V
                              
                                 ς
                                 (
                                 k
                                 )
                              
                              +
                           
                        
                      and 
                        
                           
                              y
                              
                                 k
                                 t
                              
                           
                           
                              V
                              
                                 ς
                                 (
                                 k
                                 )
                              
                              −
                           
                        
                      (for all 
                        
                           k
                           ∈
                           I
                           ,
                           t
                           ∈
                           T
                        
                     ) terms that are linear for a earthwork optimization problem but quadratic for the vertical alignment problem. Using linearization techniques from Bisschop (2009), we introduce additional continuous variables 
                        
                           W
                           
                              k
                              t
                           
                           +
                        
                      and 
                        
                           W
                           
                              k
                              t
                           
                           −
                        
                      (for all 
                        
                           k
                           ∈
                           I
                           ,
                           t
                           ∈
                           T
                        
                     ) to ensure 
                        
                           
                              W
                              
                                 k
                                 t
                              
                              +
                           
                           =
                           
                              y
                              
                                 k
                                 t
                              
                           
                           
                              V
                              
                                 ς
                                 (
                                 k
                                 )
                              
                              +
                           
                        
                      and 
                        
                           
                              W
                              
                                 k
                                 t
                              
                              −
                           
                           =
                           
                              y
                              
                                 k
                                 t
                              
                           
                           
                              V
                              
                                 ς
                                 (
                                 k
                                 )
                              
                              −
                           
                        
                      by the following equations,

                        
                           (3.4e)
                           
                              
                                 
                                    
                                       0
                                    
                                    
                                       ≤
                                    
                                    
                                       
                                          
                                             W
                                             
                                                k
                                                t
                                             
                                             +
                                          
                                          ≤
                                          
                                             M
                                             
                                                ς
                                                (
                                                k
                                                )
                                             
                                             +
                                          
                                          
                                             y
                                             
                                                k
                                                t
                                             
                                          
                                          
                                          
                                          and
                                          
                                          
                                          
                                             V
                                             
                                                ς
                                                (
                                                k
                                                )
                                             
                                             +
                                          
                                          −
                                          
                                             M
                                             
                                                ς
                                                (
                                                k
                                                )
                                             
                                             +
                                          
                                          
                                             (
                                             1
                                             −
                                             
                                                y
                                                
                                                   k
                                                   t
                                                
                                             
                                             )
                                          
                                          ≤
                                          
                                             W
                                             
                                                k
                                                t
                                             
                                             +
                                          
                                          ≤
                                          
                                             V
                                             
                                                ς
                                                (
                                                k
                                                )
                                             
                                             +
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (3.4f)
                           
                              
                                 
                                    
                                       0
                                    
                                    
                                       ≤
                                    
                                    
                                       
                                          
                                             W
                                             
                                                k
                                                t
                                             
                                             −
                                          
                                          ≤
                                          
                                             M
                                             
                                                ς
                                                (
                                                k
                                                )
                                             
                                             −
                                          
                                          
                                             y
                                             
                                                k
                                                t
                                             
                                          
                                          
                                          
                                          and
                                          
                                          
                                          
                                             V
                                             
                                                ς
                                                (
                                                k
                                                )
                                             
                                             −
                                          
                                          −
                                          
                                             M
                                             
                                                ς
                                                (
                                                k
                                                )
                                             
                                             −
                                          
                                          
                                             (
                                             1
                                             −
                                             
                                                y
                                                
                                                   k
                                                   t
                                                
                                             
                                             )
                                          
                                          ≤
                                          
                                             W
                                             
                                                k
                                                t
                                             
                                             −
                                          
                                          ≤
                                          
                                             V
                                             
                                                ς
                                                (
                                                k
                                                )
                                             
                                             −
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     Finally, the block removal indicator constraints can be written as, for all 
                        
                           k
                           ∈
                           I
                           ,
                           t
                           ∈
                           T
                           ,
                        
                     
                     
                        
                           (3.4g)
                           
                              
                                 
                                    ∑
                                    
                                       t
                                       =
                                       0
                                    
                                    u
                                 
                                 
                                    ∑
                                    
                                       j
                                       ∈
                                       S
                                       ∪
                                       W
                                    
                                 
                                 
                                    x
                                    
                                       ς
                                       (
                                       k
                                       )
                                       j
                                       t
                                    
                                 
                                 ≥
                                 
                                    W
                                    
                                       k
                                       u
                                    
                                    +
                                 
                                 
                                 and
                                 
                                 
                                    ∑
                                    
                                       t
                                       =
                                       0
                                    
                                    u
                                 
                                 
                                    ∑
                                    
                                       j
                                       ∈
                                       S
                                       ∪
                                       B
                                    
                                 
                                 
                                    x
                                    
                                       j
                                       ς
                                       (
                                       k
                                       )
                                       t
                                    
                                 
                                 ≥
                                 
                                    W
                                    
                                       k
                                       u
                                    
                                    −
                                 
                                 .
                              
                           
                        
                     Time-steps are defined such that at least one block is removed at each time-step, which is ensured by the following constraints: for all 
                        
                           t
                           ∈
                           T
                           ∖
                           {
                           
                              n
                              z
                           
                           +
                           1
                           }
                           ,
                        
                     
                     
                        
                           (3.4h)
                           
                              
                                 
                                    ∑
                                    
                                       k
                                       ∈
                                       I
                                    
                                 
                                 
                                    y
                                    
                                       k
                                       t
                                    
                                 
                                 ≥
                                 t
                                 
                                 
                                 and
                                 
                                 
                                 
                                    y
                                    
                                       k
                                       ,
                                       (
                                       t
                                       +
                                       1
                                       )
                                    
                                 
                                 ≥
                                 
                                    y
                                    
                                       k
                                       ,
                                       t
                                    
                                 
                                 .
                              
                           
                        
                     
                  

The volume constraints state the calculation of cut and fill volume of sections using side-slope approximation. Given 
                        
                           0
                           <
                           
                              A
                              
                                 i
                              
                              1
                           
                           <
                           
                              A
                              
                                 i
                              
                              2
                           
                           <
                           ⋯
                           <
                           
                              A
                              
                                 i
                              
                              
                                 k
                                 
                                    i
                                 
                                 +
                              
                           
                        
                      and 
                        
                           0
                           <
                           
                              B
                              
                                 i
                              
                              1
                           
                           <
                           
                              B
                              
                                 i
                              
                              2
                           
                           <
                           ⋯
                           <
                           
                              B
                              
                                 i
                              
                              
                                 k
                                 
                                    i
                                 
                                 −
                              
                           
                           ,
                        
                      these constraints can be written as, for all 
                        
                           
                              k
                              a
                           
                           ∈
                           
                              {
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              
                                 k
                                 
                                    i
                                 
                                 +
                              
                              }
                           
                        
                     
                     
                        
                           (3.5a)
                           
                              
                                 
                                    V
                                    
                                       i
                                    
                                    +
                                 
                                 ≥
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       
                                          k
                                          a
                                       
                                       −
                                       1
                                    
                                 
                                 
                                    A
                                    
                                       i
                                    
                                    k
                                 
                                 
                                    
                                       u
                                       ¯
                                    
                                    
                                       i
                                    
                                    k
                                 
                                 +
                                 
                                    A
                                    
                                       i
                                    
                                    
                                       k
                                       a
                                    
                                 
                                 
                                    (
                                    
                                       u
                                       i
                                    
                                    −
                                    
                                       ∑
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          
                                             k
                                             a
                                          
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          u
                                          ¯
                                       
                                       
                                          i
                                       
                                       k
                                    
                                    )
                                 
                                 ,
                              
                           
                        
                     and for all 
                        
                           
                              k
                              b
                           
                           ∈
                           
                              {
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              
                                 k
                                 
                                    i
                                 
                                 −
                              
                              }
                           
                        
                     
                     
                        
                           (3.5b)
                           
                              
                                 
                                    V
                                    
                                       i
                                    
                                    −
                                 
                                 ≥
                                 −
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       
                                          k
                                          b
                                       
                                       −
                                       1
                                    
                                 
                                 
                                    B
                                    
                                       i
                                    
                                    k
                                 
                                 
                                    
                                       u
                                       ̲
                                    
                                    
                                       i
                                    
                                    k
                                 
                                 −
                                 
                                    B
                                    
                                       i
                                    
                                    
                                       k
                                       b
                                    
                                 
                                 
                                    (
                                    
                                       u
                                       i
                                    
                                    −
                                    
                                       ∑
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          
                                             k
                                             b
                                          
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          u
                                          ̲
                                       
                                       
                                          i
                                       
                                       k
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     
                  

The volume constraints are described in details in Section 4.2. Stockpiling constraints ensure that no stockpiling occurs. In that case, for any section 
                        
                           i
                           ∈
                           S
                        
                      at least one of 
                        
                           V
                           
                              i
                           
                           +
                        
                      and 
                        
                           V
                           
                              i
                           
                           −
                        
                      must be zero, which is assured by binary variables bi
                     . For all section 
                        
                           i
                           ∈
                           S
                           ,
                        
                      the stockpiling constraints can be written as

                        
                           (3.6a)
                           
                              
                                 
                                    V
                                    
                                       i
                                    
                                    +
                                 
                                 ≤
                                 M
                                 
                                    b
                                    i
                                 
                                 ,
                              
                           
                        
                     
                     
                        
                           (3.6b)
                           
                              
                                 
                                    V
                                    
                                       i
                                    
                                    +
                                 
                                 ≥
                                 δ
                                 
                                    b
                                    i
                                 
                                 ,
                              
                           
                        
                     
                     
                        
                           (3.6c)
                           
                              
                                 
                                    V
                                    
                                       i
                                    
                                    −
                                 
                                 ≤
                                 M
                                 
                                    (
                                    1
                                    −
                                    
                                       b
                                       i
                                    
                                    )
                                 
                                 ,
                              
                           
                        
                     
                     
                        
                           (3.6d)
                           
                              
                                 
                                    V
                                    
                                       i
                                    
                                    −
                                 
                                 ≥
                                 δ
                                 
                                    (
                                    1
                                    −
                                    
                                       b
                                       i
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     
                  

The gap constraints are introduced to describe the definition of the variables ui
                     , which is the height difference between the ground profile and the road profile. Koch and Lucet (2010) demonstrated that considering area gap gives a better approximation than considering the height gap in the middle of a section. For all 
                        
                           g
                           ∈
                           G
                           ,
                           i
                           ∈
                           
                              S
                              g
                           
                        
                      the gap constraints can be written as

                        
                           (3.7)
                           
                              
                                 
                                    ∫
                                    
                                       
                                          s
                                          
                                             g
                                             ,
                                             i
                                          
                                       
                                    
                                    
                                       s
                                       
                                          g
                                          ,
                                          i
                                          +
                                          1
                                       
                                    
                                 
                                 
                                    h
                                    
                                       g
                                       ,
                                       i
                                    
                                 
                                 d
                                 x
                                 −
                                 
                                    ∫
                                    
                                       
                                          s
                                          
                                             g
                                             ,
                                             i
                                          
                                       
                                    
                                    
                                       s
                                       
                                          g
                                          ,
                                          i
                                          +
                                          1
                                       
                                    
                                 
                                 
                                    P
                                    g
                                 
                                 
                                    (
                                    x
                                    )
                                 
                                 d
                                 x
                                 =
                                 
                                    ∫
                                    
                                       
                                          s
                                          
                                             g
                                             ,
                                             i
                                          
                                       
                                    
                                    
                                       s
                                       
                                          g
                                          ,
                                          i
                                          +
                                          1
                                       
                                    
                                 
                                 
                                    u
                                    
                                       ϰ
                                       (
                                       g
                                       ,
                                       i
                                       )
                                    
                                 
                                 d
                                 x
                                 .
                              
                           
                        
                     The slope constraints imply that the slope of a spline segment g must not go beyond a minimum value Lg
                      or a maximum value Ug
                      for safety reasons. Since the spline segments are quadratic, checking the slope bounds at the beginning and end point of the spline segments is sufficient. For all 
                        
                           g
                           ∈
                           G
                           ,
                           i
                           ∈
                           {
                           1
                           ,
                           
                              n
                              g
                           
                           }
                        
                      the slope constraints can be written as

                        
                           (3.8)
                           
                              
                                 
                                    L
                                    g
                                 
                                 ≤
                                 
                                    P
                                    
                                       g
                                    
                                    
                                       
                                       ′
                                    
                                 
                                 
                                    (
                                    
                                       s
                                       
                                          g
                                          ,
                                          i
                                       
                                    
                                    )
                                 
                                 ≤
                                 
                                    U
                                    g
                                 
                                 .
                              
                           
                        
                     The smoothness constraints force the spline segments to be continuous at their joining points, as well as, differentiable. So, for all 
                        
                           g
                           ∈
                           G
                           ∖
                           {
                           1
                           }
                        
                     
                     
                        
                           (3.9)
                           
                              
                                 
                                    P
                                    
                                       g
                                       −
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       s
                                       
                                          g
                                          ,
                                          1
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    P
                                    g
                                 
                                 
                                    (
                                    
                                       s
                                       
                                          g
                                          ,
                                          1
                                       
                                    
                                    )
                                 
                                 
                                 
                                 
                                 and
                                 
                                 
                                 
                                 
                                    P
                                    
                                       g
                                       −
                                       1
                                    
                                    
                                       
                                       ′
                                    
                                 
                                 
                                    (
                                    
                                       s
                                       
                                          g
                                          ,
                                          1
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    P
                                    
                                       g
                                    
                                    
                                       
                                       ′
                                    
                                 
                                 
                                    (
                                    
                                       s
                                       
                                          g
                                          ,
                                          1
                                       
                                    
                                    )
                                 
                              
                           
                        
                     The fixed point constraints set the elevation and slope of the road at some predefined points. The set 
                        H
                      consists of pairs (s, H) such that the elevation of the road must be H at station point s, and the set 
                        
                           H
                           
                              
                              ′
                           
                        
                      consists of pairs 
                        
                           (
                           s
                           ,
                           
                              H
                              
                                 
                                 ′
                              
                           
                           )
                        
                      such that the slope of the road must be 
                        
                           H
                           
                              
                              ′
                           
                        
                      at station point s.

                        
                           (3.10)
                           
                              
                                 
                                    
                                       
                                          
                                             P
                                             g
                                          
                                          
                                             (
                                             s
                                             )
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          H
                                          
                                          
                                          
                                          for
                                          
                                          all
                                          
                                          
                                          
                                             (
                                             s
                                             ,
                                             H
                                             )
                                          
                                          ∈
                                          H
                                          
                                          
                                          
                                          and
                                          
                                          
                                          
                                          
                                             P
                                             
                                                g
                                             
                                             
                                                
                                                ′
                                             
                                          
                                          
                                             (
                                             s
                                             )
                                          
                                          =
                                          
                                             H
                                             
                                                
                                                ′
                                             
                                          
                                          
                                          for
                                          
                                          all
                                          
                                          
                                             (
                                             s
                                             ,
                                             
                                                H
                                                
                                                   
                                                   ′
                                                
                                             
                                             )
                                          
                                          ∈
                                          
                                             H
                                             
                                                
                                                ′
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     Finally, the bounds for the decision variables are xijt
                      ≥ 0, ykt
                      ∈ {0, 1}, 
                        
                           
                              
                                 u
                                 ̲
                              
                              i
                           
                           ≤
                           
                              u
                              i
                           
                           ≤
                           
                              
                                 u
                                 ¯
                              
                              i
                           
                           ,
                        
                     
                     
                        
                           0
                           ≤
                           
                              V
                              
                                 i
                              
                              +
                           
                           ≤
                           
                              M
                              
                                 i
                              
                              +
                           
                           ,
                        
                     
                     
                        
                           0
                           ≤
                           
                              V
                              
                                 i
                              
                              −
                           
                           ≤
                           
                              M
                              
                                 i
                              
                              −
                           
                           ,
                        
                      and 
                        
                           
                              a
                              
                                 g
                                 ,
                                 k
                              
                           
                           ∈
                           R
                        
                     .

A stockpile-prone section is defined to be a section that is likely to have stockpiling, if the stockpiling constraints are not enforced. So the model can be improved by enforcing constraints (3.6) only for the sections that are stockpile-prone. But there are no known algorithms to detect the stockpile-prone sections for a given ground profile. For this reason, the stockpiling constraints are written for all the sections. However, we will later prove that the binary variable bi
                         will have no effect on the solution time when i is not a stockpile-prone section.

Constructed roads must have side-slopes for stability reasons. Not considering side-slopes in the model introduces significant errors in the volume calculation. Figs. 2 and 3 show the approximation of side-slopes for a cut and a fill respectively.

The cross-section of a cut i is approximated by 
                           
                              k
                              
                                 i
                              
                              +
                           
                         slabs having elevations 
                           
                              
                                 
                                    u
                                    ¯
                                 
                                 
                                    i
                                 
                                 1
                              
                              ,
                              
                                 
                                    u
                                    ¯
                                 
                                 
                                    i
                                 
                                 2
                              
                              ,
                              …
                              ,
                              
                                 
                                    u
                                    ¯
                                 
                                 
                                    i
                                 
                                 
                                    k
                                    
                                       i
                                    
                                    +
                                 
                              
                           
                         and areas 
                           
                              
                                 A
                                 
                                    i
                                 
                                 1
                              
                              ,
                              
                                 A
                                 
                                    i
                                 
                                 2
                              
                              ,
                              …
                              ,
                              
                                 A
                                 
                                    i
                                 
                                 
                                    k
                                    
                                       i
                                    
                                    +
                                 
                              
                              ,
                           
                         and a fill i is approximated by 
                           
                              k
                              
                                 i
                              
                              −
                           
                         slabs having elevations 
                           
                              
                                 
                                    u
                                    ̲
                                 
                                 
                                    i
                                 
                                 1
                              
                              ,
                              
                                 
                                    u
                                    ̲
                                 
                                 
                                    i
                                 
                                 2
                              
                              ,
                              …
                              ,
                              
                                 
                                    u
                                    ̲
                                 
                                 
                                    i
                                 
                                 
                                    k
                                    
                                       i
                                    
                                    +
                                 
                              
                           
                         and areas 
                           
                              
                                 B
                                 
                                    i
                                 
                                 1
                              
                              ,
                              
                                 B
                                 
                                    i
                                 
                                 2
                              
                              ,
                              …
                              ,
                              
                                 B
                                 
                                    i
                                 
                                 
                                    k
                                    
                                       i
                                    
                                    −
                                 
                              
                           
                        with the following assumptions

                           
                              (4.1)
                              
                                 
                                    0
                                    <
                                    
                                       A
                                       
                                          i
                                       
                                       1
                                    
                                    <
                                    
                                       A
                                       
                                          i
                                       
                                       2
                                    
                                    <
                                    ⋯
                                    <
                                    
                                       A
                                       
                                          i
                                       
                                       
                                          k
                                          
                                             i
                                          
                                          +
                                       
                                    
                                    
                                    
                                    and
                                    
                                    
                                    0
                                    <
                                    
                                       B
                                       
                                          i
                                       
                                       1
                                    
                                    <
                                    
                                       B
                                       
                                          i
                                       
                                       2
                                    
                                    <
                                    ⋯
                                    <
                                    
                                       B
                                       
                                          i
                                       
                                       
                                          k
                                          
                                             i
                                          
                                          −
                                       
                                    
                                    .
                                 
                              
                           
                        It should be noted that 
                           
                              
                                 u
                                 ̲
                              
                              
                                 i
                              
                              k
                           
                         are negative numbers for all 
                           
                              k
                              ∈
                              {
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              
                                 k
                                 
                                    i
                                 
                                 −
                              
                              }
                           
                        .

                           Theorem 1
                           
                              If a section i is not a stockpile-prone section, and Assumptions (
                              
                                 4.1
                              
                              ) hold, then Eqs. (
                              
                                 3.5a
                              
                              ) and (
                              
                                 3.5b
                              
                              ) will generate the intended volume approximations,
                              
                                 
                                    V
                                    
                                       i
                                    
                                    +
                                 
                               
                              and
                              
                                 
                                    V
                                    
                                       i
                                    
                                    −
                                 
                              
                              .
                           

Notice Eq. (3.5a) consists of 
                                 
                                    k
                                    
                                       i
                                    
                                    +
                                 
                               equations where 
                                 
                                    V
                                    
                                       i
                                    
                                    +
                                 
                               is greater or equal to the right hand sides of these equations. Since 
                                 
                                    V
                                    
                                       i
                                    
                                    +
                                 
                               is being minimized in the objective function and it is non-negative, at the optimal solution,

                                 
                                    (4.2)
                                    
                                       
                                          
                                             
                                                
                                                   V
                                                   
                                                      i
                                                   
                                                   +
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   max
                                                   
                                                      {
                                                      0
                                                      ,
                                                      
                                                         max
                                                         
                                                            
                                                               k
                                                               a
                                                            
                                                            ∈
                                                            
                                                               {
                                                               1
                                                               ,
                                                               2
                                                               ,
                                                               …
                                                               ,
                                                               
                                                                  k
                                                                  
                                                                     i
                                                                  
                                                                  +
                                                               
                                                               }
                                                            
                                                         
                                                      
                                                      
                                                         {
                                                         
                                                            ∑
                                                            
                                                               k
                                                               =
                                                               1
                                                            
                                                            
                                                               
                                                                  k
                                                                  a
                                                               
                                                               −
                                                               1
                                                            
                                                         
                                                         
                                                            A
                                                            
                                                               i
                                                            
                                                            k
                                                         
                                                         
                                                            
                                                               u
                                                               ¯
                                                            
                                                            
                                                               i
                                                            
                                                            k
                                                         
                                                         +
                                                         
                                                            A
                                                            
                                                               i
                                                            
                                                            
                                                               k
                                                               a
                                                            
                                                         
                                                         
                                                            (
                                                            
                                                               u
                                                               i
                                                            
                                                            −
                                                            
                                                               ∑
                                                               
                                                                  k
                                                                  =
                                                                  1
                                                               
                                                               
                                                                  
                                                                     k
                                                                     a
                                                                  
                                                                  −
                                                                  1
                                                               
                                                            
                                                            
                                                               
                                                                  u
                                                                  ¯
                                                               
                                                               
                                                                  i
                                                               
                                                               k
                                                            
                                                            )
                                                         
                                                         }
                                                      
                                                      }
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              Similarly,

                                 
                                    (4.3)
                                    
                                       
                                          
                                             
                                                
                                                   V
                                                   
                                                      i
                                                   
                                                   −
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   max
                                                   
                                                      {
                                                      0
                                                      ,
                                                      
                                                         max
                                                         
                                                            
                                                               k
                                                               b
                                                            
                                                            ∈
                                                            
                                                               {
                                                               1
                                                               ,
                                                               2
                                                               ,
                                                               …
                                                               ,
                                                               
                                                                  k
                                                                  
                                                                     i
                                                                  
                                                                  −
                                                               
                                                               }
                                                            
                                                         
                                                      
                                                      
                                                         {
                                                         −
                                                         
                                                            ∑
                                                            
                                                               k
                                                               =
                                                               1
                                                            
                                                            
                                                               
                                                                  k
                                                                  b
                                                               
                                                               −
                                                               1
                                                            
                                                         
                                                         
                                                            B
                                                            
                                                               i
                                                            
                                                            k
                                                         
                                                         
                                                            
                                                               u
                                                               ̲
                                                            
                                                            
                                                               i
                                                            
                                                            k
                                                         
                                                         −
                                                         
                                                            B
                                                            
                                                               i
                                                            
                                                            
                                                               k
                                                               b
                                                            
                                                         
                                                         
                                                            (
                                                            
                                                               u
                                                               i
                                                            
                                                            −
                                                            
                                                               ∑
                                                               
                                                                  k
                                                                  =
                                                                  1
                                                               
                                                               
                                                                  
                                                                     k
                                                                     b
                                                                  
                                                                  −
                                                                  1
                                                               
                                                            
                                                            
                                                               
                                                                  u
                                                                  ̲
                                                               
                                                               
                                                                  i
                                                               
                                                               k
                                                            
                                                            )
                                                         
                                                         }
                                                      
                                                      }
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

For a cut ui
                               > 0, so for all 
                                 
                                    
                                       k
                                       b
                                    
                                    ∈
                                    
                                       {
                                       1
                                       ,
                                       2
                                       ,
                                       …
                                       ,
                                       
                                          k
                                          
                                             i
                                          
                                          −
                                       
                                       }
                                    
                                    ,
                                 
                               the terms 
                                 
                                    −
                                    
                                       ∑
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          
                                             k
                                             b
                                          
                                          −
                                          1
                                       
                                    
                                    
                                       B
                                       
                                          i
                                       
                                       k
                                    
                                    
                                       
                                          u
                                          ̲
                                       
                                       
                                          i
                                       
                                       k
                                    
                                    −
                                    
                                       B
                                       
                                          i
                                       
                                       
                                          k
                                          b
                                       
                                    
                                    
                                       (
                                       
                                          u
                                          i
                                       
                                       −
                                       
                                          ∑
                                          
                                             k
                                             =
                                             1
                                          
                                          
                                             
                                                k
                                                b
                                             
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             u
                                             ̲
                                          
                                          
                                             i
                                          
                                          k
                                       
                                       )
                                    
                                 
                               are negative numbers. Therefore, 
                                 
                                    
                                       V
                                       
                                          i
                                       
                                       −
                                    
                                    =
                                    0
                                 
                              .

If 
                                 
                                    0
                                    <
                                    
                                       
                                          u
                                          ¯
                                       
                                       
                                          i
                                       
                                       d
                                    
                                    <
                                    
                                       u
                                       i
                                    
                                    ≤
                                    
                                       
                                          u
                                          ¯
                                       
                                       
                                          i
                                       
                                       
                                          d
                                          +
                                          1
                                       
                                    
                                    ,
                                 
                               then ka
                               = d + 1 gives the maximum term. For all ka
                               < d + 1, the volume for the last d + 1 − ka
                               slabs are calculated by using area 
                                 
                                    A
                                    
                                       i
                                    
                                    
                                       k
                                       a
                                    
                                 
                               and since 
                                 
                                    
                                       A
                                       
                                          i
                                       
                                       
                                          k
                                          a
                                       
                                    
                                    <
                                    
                                       A
                                       
                                          i
                                       
                                       
                                          
                                             k
                                             a
                                          
                                          +
                                          1
                                       
                                    
                                    <
                                    ⋯
                                    <
                                    
                                       A
                                       
                                          i
                                       
                                       
                                          d
                                          +
                                          1
                                       
                                    
                                    ,
                                 
                               the calculated volume cannot be the maximum. For all ka
                               > d + 1, the term 
                                 
                                    (
                                    
                                       u
                                       i
                                    
                                    −
                                    
                                       ∑
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          
                                             k
                                             a
                                          
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          u
                                          ¯
                                       
                                       
                                          i
                                       
                                       k
                                    
                                    )
                                 
                               is negative and since 
                                 
                                    
                                       A
                                       
                                          i
                                       
                                       
                                          d
                                          +
                                          1
                                       
                                    
                                    <
                                    
                                       A
                                       
                                          i
                                       
                                       
                                          d
                                          +
                                          2
                                       
                                    
                                    <
                                    ⋯
                                    <
                                    
                                       A
                                       
                                          i
                                       
                                       
                                          k
                                          a
                                       
                                    
                                    ,
                                 
                               the calculated volume cannot be the maximum. So, if 
                                 
                                    0
                                    <
                                    
                                       
                                          u
                                          ¯
                                       
                                       
                                          i
                                       
                                       d
                                    
                                    <
                                    
                                       u
                                       i
                                    
                                    ≤
                                    
                                       
                                          u
                                          ¯
                                       
                                       
                                          i
                                       
                                       
                                          d
                                          +
                                          1
                                       
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             V
                                             
                                                i
                                             
                                             +
                                          
                                          =
                                          
                                             ∑
                                             
                                                k
                                                =
                                                1
                                             
                                             d
                                          
                                          
                                             A
                                             
                                                i
                                             
                                             k
                                          
                                          
                                             
                                                u
                                                ¯
                                             
                                             
                                                i
                                             
                                             k
                                          
                                          +
                                          
                                             A
                                             
                                                i
                                             
                                             
                                                d
                                                +
                                                1
                                             
                                          
                                          
                                             (
                                             
                                                u
                                                i
                                             
                                             −
                                             
                                                ∑
                                                
                                                   k
                                                   =
                                                   1
                                                
                                                d
                                             
                                             
                                                
                                                   u
                                                   ¯
                                                
                                                
                                                   i
                                                
                                                k
                                             
                                             )
                                          
                                       
                                    
                                 
                              is the intended volume, since it is the exact volume up to slab d, and the remaining elevation is multiplied with the area of slab d + 1.

Similar logic can be applied for a fill section.□


                              The MILP algorithm will only branch on bi if i is a stockpile-prone section.
                           

Consider bi
                               to be continuous on 0 ≤ bi
                               ≤ 1 instead of binary. If i is not a stockpile-prone section, then either 
                                 
                                    V
                                    
                                       i
                                    
                                    +
                                 
                               or 
                                 
                                    V
                                    
                                       i
                                    
                                    −
                                 
                               will be zero. If 
                                 
                                    V
                                    
                                       i
                                    
                                    +
                                 
                               is zero, then bi
                               must be zero by Eq. (3.6b) since δ > 0. If 
                                 
                                    V
                                    
                                       i
                                    
                                    −
                                 
                               is zero, then bi
                               must be 1 by Eq. (3.6d) since δ > 0. So if i is not a stockpile-prone section, bi
                               will not take a fractional value.

The branch and bound algorithm for solving mixed integer linear programs (MILP) make branching decisions based on the linear programming (LP) relaxation of the MILP, and the algorithm will branch on only those binary variables that have fractional values on the LP relaxation. So if i is not a stockpile-prone section, the branch and bound algorithm will never branch on bi
                              . The MILP algorithm will run as if the binary variable bi
                               never existed. (Most pre-solvers will in fact remove the variable from the optimization problem.)□

The best known time complexity of a linear program is polynomially dependent on the number of continuous variables (interior point methods). If the number of constraints is less than the number of continuous variables, then the dual problem can be solved, in which case, the time complexity is polynomially dependent on the number of constraints. If there are integer variables in the problem, then a solution tree is created and at each node of the tree a linear program is solved. So the time complexity of a MILP is exponentially dependent on the number of integer variables. The details of the time complexities of the algorithms can be found in Boyd and Vandenberghe (2004).

                           Proposition 1
                           
                              The MILP has
                              
                                 
                                    O
                                    (
                                    
                                       n
                                       2
                                    
                                    
                                       n
                                       z
                                    
                                    )
                                 
                               
                              continuous variables.
                           

The MILP has n variables for excavation volume, n variables for embankment volume, (n
                              2 + nbn + nwn)(nz
                               + 1) variables for hauling volume, 2nz
                              (nz
                               + 1) number of 
                                 
                                    W
                                    
                                       k
                                       u
                                    
                                    +
                                 
                               and 
                                 
                                    W
                                    
                                       k
                                       u
                                    
                                    −
                                 
                              variables, 3m variables for the spline coefficients, and n variables for section elevation. So, the total number of continuous variables is

                                 
                                    
                                       
                                          
                                             
                                             
                                             
                                                
                                                   n
                                                   +
                                                   n
                                                   +
                                                   
                                                      (
                                                      
                                                         n
                                                         2
                                                      
                                                      +
                                                      
                                                         n
                                                         b
                                                      
                                                      n
                                                      +
                                                      
                                                         n
                                                         w
                                                      
                                                      n
                                                      )
                                                   
                                                   
                                                      (
                                                      
                                                         n
                                                         z
                                                      
                                                      +
                                                      1
                                                      )
                                                   
                                                   +
                                                   2
                                                   
                                                      n
                                                      z
                                                   
                                                   
                                                      (
                                                      
                                                         n
                                                         z
                                                      
                                                      +
                                                      1
                                                      )
                                                   
                                                   +
                                                   3
                                                   m
                                                   +
                                                   n
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   
                                                   =
                                                   3
                                                   n
                                                   +
                                                   3
                                                   m
                                                   +
                                                   
                                                      (
                                                      
                                                         n
                                                         2
                                                      
                                                      +
                                                      
                                                         n
                                                         b
                                                      
                                                      n
                                                      +
                                                      
                                                         n
                                                         w
                                                      
                                                      n
                                                      +
                                                      2
                                                      
                                                         n
                                                         z
                                                      
                                                      )
                                                   
                                                   
                                                      (
                                                      
                                                         n
                                                         z
                                                      
                                                      +
                                                      1
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   
                                                   ≤
                                                   6
                                                   n
                                                   +
                                                   
                                                      (
                                                      
                                                         n
                                                         2
                                                      
                                                      +
                                                      
                                                         n
                                                         2
                                                      
                                                      +
                                                      
                                                         n
                                                         2
                                                      
                                                      +
                                                      2
                                                      
                                                         n
                                                         z
                                                      
                                                      )
                                                   
                                                   
                                                      (
                                                      
                                                         n
                                                         z
                                                      
                                                      +
                                                      
                                                         n
                                                         z
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                             
                                                
                                                   
                                                   =
                                                   6
                                                   n
                                                   +
                                                   6
                                                   
                                                      n
                                                      2
                                                   
                                                   
                                                      n
                                                      z
                                                   
                                                   +
                                                   4
                                                   
                                                      n
                                                      
                                                         z
                                                      
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              since n ≥ nb, n ≥ nw, n ≥ m, and n ≥ nz
                              . (We assume nz
                               ≥ 1.)□


                              The MILP has
                              
                                 
                                    O
                                    (
                                    
                                       n
                                       
                                          z
                                       
                                       2
                                    
                                    +
                                    n
                                    )
                                 
                               
                              binary variables.
                           

The total number of binary variables is 
                                 
                                    
                                       n
                                       z
                                    
                                    
                                       (
                                       
                                          n
                                          z
                                       
                                       +
                                       1
                                       )
                                    
                                    +
                                    n
                                    ≤
                                    2
                                    
                                       n
                                       
                                          z
                                       
                                       2
                                    
                                    +
                                    n
                                 
                               assuming nz
                               ≥ 1.□


                              The MILP has
                              
                                 
                                    O
                                    (
                                    
                                       n
                                       2
                                    
                                    
                                       n
                                       
                                          z
                                       
                                       3
                                    
                                    )
                                 
                               
                              constraints.
                           

The number of constraints are shown in Table 1
                              . The total number of constraints is 
                                 
                                    O
                                    (
                                    
                                       n
                                       2
                                    
                                    
                                       n
                                       
                                          z
                                       
                                       3
                                    
                                    )
                                 
                              .□

The algorithms described in Hare et al. (2011) can be adapted to the present model to further improve the computation of a solution.

For this model, we seek the answers to the following questions.

                        
                           •
                           How does this model of vertical alignment performs in terms of robustness and accuracy compared to model without side-slopes for vertical alignment?

Can we numerically analyze the behavior of the design parameters 
                                 
                                    
                                       k
                                       
                                          i
                                       
                                       +
                                    
                                    ,
                                 
                              
                              
                                 
                                    
                                       k
                                       
                                          i
                                       
                                       −
                                    
                                    ,
                                 
                               and ng
                              , which we believe to be critical to the model, and suggest good values for these parameters?

Since the impact of blocks in the earthmoving model was investigated in Hare et al. (2011) and blocks do not further complicated the vertical alignment model, we do not include blocks in our numerical experiments. The added benefit is to simplify the experiments and focus on the answer to the above two questions. From our numerous experiments, we have not noticed any additional impact on the solution time or the error caused by the introduction of blocks beyond those reported in Hare et al. (2011).

The experiments in this chapter were performed in a workstation with a Intel(R) Core™ i7-860 2.80GHz (6 cores) processor and 16GB of Random Access Memory (RAM). An academic edition of the IBM ILOG CPLEX Optimizer version 12.2 (http://www.cplex.com
) was used to solve the problems.

For our experiments, we used 7 distinct road samples provided by our industrial partner Softree Technical Systems Inc (http://www.softree.com
). It is worth noting that these road samples come from real terrain that our industrial partner has worked with and provided us for testing. As such they are extremely realistic test problems. We denote these roads with letters from A to G. We generated our problem set by changing different parameters for these roads. Table 2
                        shows the basic information. All the experiments have the following parameters,

                           
                              •
                              Relative MIP gap tolerance: 1 percent,

LP feasibility tolerance: 10−6,

Maximum run time: 2 hours for each core of the processor totaling 12 hours,

Upper bound for slope change: 0.5,

Lower bound for slope change: − 0.5,

Maximum fill height: 10 meters,

Maximum cut height: 10 meters.

Other solver and model parameters remain at their default settings.

In this test configuration, we compare the described model to a model that applies rectangular approximations for calculating side-slopes (as was done in Moreb (2009)). Our goal is to determine if there is a notable improvement in robustness and accuracy. A model that applies rectangular approximations for calculating side-slopes can be considered a variant of the model in this work with exactly one slab. Since the height of a section is a variable, the accuracy of the approximation of the volume is highly dependent on the choice of area for the section. If the appropriate area is selected, then the accuracy will be very good. However, as the height changes, so does the appropriate value of area. In other words, a single slab model can be very accurate if we can predict the height for each section before solving the model. However, if the prediction of heights is far from the actual calculated heights, then a single slab model can have significant errors. This behavior makes the model very unstable. We consider two strategies for elevation prediction.

The first strategy assumes that the output road profile will be very close to the input ground profile. Of course, assuming this will bias the optimizer to choose a solution close to the ground profile. While this strategy may perform well for some examples, for other examples it may perform poorly. We call this approach the Near Ground Model (NGM) approach.

The second approach is to predict the height to be the average height. The quality of this approach also depends on the initial guess, but since the initial guess is the average of the extreme guesses, this approach should not perform too poorly, at the same time, we should not expect very good solution from it. We call this approach Average Model (AM) approach.

Unlike a single slab model, our model does not depend on any initial guess. From Figs. 2 and 3, we see that as the number of entries in the lookup table, 
                           
                              k
                              
                                 i
                              
                              +
                           
                         (for a cut section i) and 
                           
                              k
                              
                                 i
                              
                              −
                           
                         (for a fill section i) increase, the approximate volume converges to the actual volume. In addition to comparing with the two single slab variations, we also show the change in accuracy with respect to the change in the values for 
                           
                              k
                              
                                 i
                              
                              +
                           
                         and 
                           
                              k
                              
                                 i
                              
                              −
                           
                        .

The reference solution for the experiments is taken as a model with large values for 
                              
                                 k
                                 
                                    i
                                 
                                 +
                              
                            and 
                              
                                 k
                                 
                                    i
                                 
                                 −
                              
                            for all sections i. For the experiments of this test configuration, we use 
                              
                                 
                                    k
                                    
                                       i
                                    
                                    +
                                 
                                 =
                                 
                                    k
                                    
                                       i
                                    
                                    −
                                 
                                 =
                                 400
                              
                            for all section i, as the reference solution.

For each of the roads of Table 2, we generated 10 problems for 10 different values of 
                              
                                 k
                                 
                                    i
                                 
                                 +
                              
                            and 
                              
                                 
                                    k
                                    
                                       i
                                    
                                    −
                                 
                                 ,
                              
                            as well as 2 problems for the AM and NGM approaches. It should be noted that our model with 
                              
                                 
                                    k
                                    
                                       i
                                    
                                    +
                                 
                                 =
                                 
                                    k
                                    
                                       i
                                    
                                    −
                                 
                                 =
                                 1
                              
                            is the same as a model generated by the AM approach. Therefore, for this test configuration, we generated 11 problems for each of the 7 roads totaling 77 problems with the naming convention R-k, where R is a road from Table 2, and k either represents the value for 
                              
                                 k
                                 
                                    i
                                 
                                 +
                              
                            and 
                              
                                 k
                                 
                                    i
                                 
                                 −
                              
                            for all sections i, or AM or NGM. Table 3
                           summarizes the problem set. For this test configuration, the other parameters are,

                              
                                 •
                                 number of sections per spline segment: ng
                                     = 2 for all 
                                       
                                          g
                                          ∈
                                          G
                                       
                                    ,

number of blocks: nz
                                     = 0,

number of access roads: nr
                                     = 1.

To ensure feasibility, we add an access road to the first section for each of the problems.

We used the following three-steps procedure for each of the problems in Table 3 to calculate the accuracy.

                              
                                 •
                                 In step 1, we solve the given model and save the output vertical alignment and the optimal cost. We denote the optimal cost of this step with C
                                    
                                       R, k
                                    .

In step 2, we generate a model with the same parameters as the given model except 
                                       
                                          
                                             k
                                             
                                                i
                                             
                                             +
                                          
                                          =
                                          
                                             k
                                             
                                                i
                                             
                                             −
                                          
                                          =
                                          400
                                          ,
                                       
                                     then we input the vertical alignment from step 1 to this model, and solve only for the earthwork operations. The optimal cost of this step is the optimal cost with the corrected volume for the vertical alignment of step 1. We denote this cost with 
                                       
                                          C
                                          
                                             R
                                             ,
                                             k
                                          
                                          400
                                       
                                    .

In step 3, we use the formulas 
                                       
                                          
                                             ϵ
                                             
                                                R
                                                ,
                                                k
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   C
                                                   
                                                      R
                                                      ,
                                                      k
                                                   
                                                
                                                −
                                                
                                                   C
                                                   
                                                      R
                                                      ,
                                                      k
                                                   
                                                   400
                                                
                                             
                                             
                                                C
                                                
                                                   R
                                                   ,
                                                   k
                                                
                                                400
                                             
                                          
                                          ×
                                          100
                                       
                                     percent to get the percent relative error.

We normalized the solution time with respect to the solution times with the model with 
                              
                                 
                                    k
                                    
                                       i
                                    
                                    +
                                 
                                 =
                                 
                                    k
                                    
                                       i
                                    
                                    −
                                 
                                 =
                                 400
                              
                            to accommodate all the roads in the same graph. If t
                           
                              R, k
                            is the required time for Road R with 
                              
                                 
                                    k
                                    
                                       i
                                    
                                    +
                                 
                                 =
                                 
                                    k
                                    
                                       i
                                    
                                    −
                                 
                                 =
                                 k
                                 ,
                              
                            then the normalized time is defined as

                              
                                 (5.1)
                                 
                                    
                                       
                                          
                                             t
                                             ¯
                                          
                                          
                                             R
                                             ,
                                             k
                                          
                                       
                                       =
                                       
                                          
                                             t
                                             
                                                R
                                                ,
                                                k
                                             
                                          
                                          
                                             t
                                             
                                                R
                                                ,
                                                400
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           
                        

@&#RESULTS@&#

The raw results of the problem configuration are shown in Tables 5-7
                           
                           
                           . A careful observation of the results reveal that depending on the values of 
                              
                                 k
                                 
                                    i
                                 
                                 +
                              
                            and 
                              
                                 k
                                 
                                    i
                                 
                                 −
                              
                            the model can introduce significant errors. But, we wanted to know how the accuracy of the problems changes as the values of 
                              
                                 k
                                 
                                    i
                                 
                                 +
                              
                            and 
                              
                                 k
                                 
                                    i
                                 
                                 −
                              
                            change, at the same time, we wanted to define a range for 
                              
                                 k
                                 
                                    i
                                 
                                 +
                              
                            and 
                              
                                 k
                                 
                                    i
                                 
                                 −
                              
                            in which the solutions will be reasonably accurate. For this purpose, we define 3 ranges of accuracies of the solutions, i.e.,

                              
                                 •
                                 |ε
                                       R, k
                                    | ≤ 2 percent: accurate solution, since the relative MIP gap tolerance is 1 percent,

2 percent < |ε
                                       R, k
                                    | ≤ 5 percent: acceptable solution, since up to 5 percent error is acceptable to our users, and

|ε
                                       R, k
                                    | > 5 percent: unacceptable solution.

In Fig. 4
                           , we plot the absolute value of the percent relative error for both NGM and AM approaches and our model with different numbers of cut and fill entries in the lookup table. From the plot, we see that both single slab models give unacceptable solutions in all cases with an error ranging from 20 percent to 42 percent. We also see that the error drops very quickly as we increase the number of entries in the lookup table and for all the roads the error stays in the acceptable range if we use more than 5 entries in the lookup table. We conclude that given a reasonable number of entries in the lookup table, this model is robust and accurate.

Similar to Fig. 4, we plot the timing data in Fig. 5
                           . We see that both the NGM and AM approaches require almost the same amount of time, which is expected since both of these approaches have the same number of variables and constraints. For each additional entries in the lookup table, 2n additional constraints are required. So, the timing should increase as we increase the number of entries in the lookup table. Acceptable approximation is achieved with k
                           + = k
                           − = 5.

In this test configuration, we analyzed the behavior of another design parameter of the model called the number of sections per spline segment (ng
                         for all 
                           
                              g
                              ∈
                              G
                           
                        ), which we believed to be critical for the model.

Theoretically, the best value for ng
                           , for all 
                              
                                 g
                                 ∈
                                 G
                                 ,
                              
                            is 1, since it gives the best objective value. The reason is ng
                            = 1, for all 
                              
                                 g
                                 ∈
                                 G
                                 ,
                              
                            gives the model the most flexibility to move the road profile up and down. We set it as the reference solution.

For each of the roads of Table 2, we generated problems for different values of ng
                           . When generating these problems, we made sure that n was divisible by ng
                            so that all the segments have the same number of sections. For this test configuration, we generated 51 problems with the naming convention R-ng
                           , where R is a road from Table 2, and ng
                            is the number of sections per segment, that are shown in Table 4
                           . It should be noted that ng
                            > 10 is rarely used, but we created some problems with higher ng
                            values for demonstration purpose. The other parameters for this test configuration are,

                              
                                 •
                                 number of entries in the lookup table: 
                                       
                                          
                                             k
                                             
                                                i
                                             
                                             +
                                          
                                          =
                                          
                                             k
                                             
                                                i
                                             
                                             −
                                          
                                          =
                                          200
                                       
                                     for all i,

number of blocks: nz
                                     = 0,

number of access roads: nr
                                     = 1.

We want to know how the cost and timing changes with respect to the parameter ng
                           . We normalized the solutions with respect to the reference solution to accommodate all the roads in the same graph. If 
                              
                                 C
                                 
                                    R
                                    ,
                                    
                                       n
                                       g
                                    
                                 
                              
                            is the optimal cost for Road R with ng
                            sections per segment, then the normalized cost is defined as,

                              
                                 (5.2)
                                 
                                    
                                       
                                          
                                             C
                                             ¯
                                          
                                          
                                             R
                                             ,
                                             
                                                n
                                                g
                                             
                                          
                                       
                                       =
                                       
                                          
                                             C
                                             
                                                R
                                                ,
                                                
                                                   n
                                                   g
                                                
                                             
                                          
                                          
                                             C
                                             
                                                R
                                                ,
                                                1
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           If 
                              
                                 t
                                 
                                    R
                                    ,
                                    
                                       n
                                       g
                                    
                                 
                              
                            is the required time for Road R with ng
                            sections per segment, then the normalized time is defined as,

                              
                                 (5.3)
                                 
                                    
                                       
                                          
                                             t
                                             ¯
                                          
                                          
                                             R
                                             ,
                                             
                                                n
                                                g
                                             
                                          
                                       
                                       =
                                       
                                          
                                             t
                                             
                                                R
                                                ,
                                                
                                                   n
                                                   g
                                                
                                             
                                          
                                          
                                             t
                                             
                                                R
                                                ,
                                                1
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           
                        

@&#RESULTS@&#

The raw results of this test configuration, as well as, the calculated normalized cost and timing are shown in Table 8
                           . In Fig. 6
                           , we plot the change of normalized cost with respect to the number of sections per segment for each of the roads. As expected, we see that the cost continues to increase as the value of ng
                            increases. Fig. 7
                           shows the change in normalized time, and we note that there is no reduction in computation time when the number of sections per segment is increased.

We conclude that the number of sections per spline segment should not exceed 2.

We combined Moreb’s vertical alignment model (Moreb, 2009) and Hare, Koch, and Lucet’s earthwork model with blocks (Hare et al., 2011) into a single model. It is the first model in this research area that can compute the vertical alignment considering blocks and access roads.

We have found that the model was generating substantial errors in the volume approximation from not considering the side-slopes of the roads. So we have developed a novel way of implementing side-slopes using lookup tables without significantly increasing the time complexity of the model. Our subsequent model reduces the approximation error from more than 20 percent to less than 5 percent in our numerical experiments.

The described models assume that no stockpiling will occur. One possible extension is to change the models to allow roadside stockpiling. When too much roadside stockpiling occurs in a section, a temporary block may be created that did not previously exist. This type of block is called a dynamic block. One of the important future direction is to handle dynamic blocks in the model.

A multi-material model of vertical alignment is defined as a model where the different types of materials found in the ground, which vary in cost and quality, are taken into account. Considering multiple materials provides a more realistic solution, because the cost of manipulating material depends on the types of materials (dirt is easier to dig than rock), and often some parts of the road require a specific material type for engineering reasons. Extending the model to handle multi-materials is the subject of active research.

Other areas of future improvements include finding the optimal section length, reducing the number of binary variables, considering the cost of land, and incorporating retaining walls.

Eventually, the next step of the research is to model the horizontal alignment and simultaneously optimize the horizontal and vertical alignment of a road. Unlike vertical alignment, the horizontal alignment formulation can have a non-convex or discontinuous objective function. The modeling also involves considering political, socioeconomic, and environmental issues, and is a much more complex problem that will be the subject of future research.

@&#ACKNOWLEDGMENTS@&#

The authors would like to express gratitude to Craig Speirs and David Mills from Softree Technical Systems Inc. for valuable feedback, numerous productive discussions, and the problem set. They would also like to thank NSERC for its support through several grants (Engage and Collaborative Research and Development grants) and MITACS for its support through several Accelerate grants that partially funded the research. Finally, they thank Kasra Bigdeli and Jessica Weeres for their work in the preliminary stages of the project.

The authors also thank an anonymous referee for suggesting several clarification that led to several improvement to the original manuscript.

@&#REFERENCES@&#

