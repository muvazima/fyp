@&#MAIN-TITLE@&#Noninvasive identification of two lesions with local repolarization changes using two dipoles in inverse solution simulation study

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We modeled one or two lesions with repolarization changes in heart ventricle.


                        
                        
                           
                           We computed difference integral body surface potential maps on the torso surface.


                        
                        
                           
                           We suggested the inverse solution for identification of two lesions by two dipoles.


                        
                        
                           
                           Characteristics of solutions were specified for classification of correct solutions.


                        
                        
                           
                           For suggested method no apriori information about the number of lesions is needed.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Inverse solution

Heart model

Two lesions with changed repolarization

Simulation of integral body surface potential maps

Classification of obtained results

@&#ABSTRACT@&#


               
               
                  Background
                  The method for inverse localization and identification of two distinct simultaneous lesions with changed repolarization in the ventricular myocardium (two-vessel disease) is proposed and its robustness to errors in input data is tested in this simulation study.
               
               
                  Method
                  The inverse solution was obtained from the difference between STT integral body surface potential map computed with repolarization changes and the STT integral map from normal activation. In a numerical model of ventricles 48 cases of two simultaneous lesions and 48 cases of a single lesion were modeled. The effect of the lesions was taken to be represented by two dipoles. The input data were disturbed by three types of added noise. Twenty three characteristics of every obtained inverse solution were defined and four of them were used as the features in discriminant analysis task distinguishing the correct inverse solutions identifying two lesions.
               
               
                  Results
                  The mean localization error for identified two lesions was 1.1±0.7cm. The sensitivity and specificity of quadratic discriminant analysis with cross-validation and feature selection was higher than 90%.
               
               
                  Conclusions
                  The combination of the inverse solution with two dipoles and discriminant analysis allows the identification of two simultaneous lesions without a priori information about the number of lesions.
               
            

@&#INTRODUCTION@&#

In patients with ischemic heart disease and atherosclerosis two or more simultaneously occluded coronary arteries can be present [1]. It has been shown that multiple-lead measurements on the thorax give more information about the cardiac electrical generator than traditionally used standard 12-leads ECG [2,3]. Besides the evaluation of the body surface potential map (BSPM) pattern itself [4,5] various inverse methods based on the mathematical modeling of the cardiac electric field have been developed [6,7] to identify processes in the heart. The variety of the used inverse methods stems mainly from the assumed form of the equivalent cardiac generator which should be identified by the inverse computation.

If a spatially distributed equivalent cardiac generator is considered, the inverse solutions are usually in the form of epicardial potentials [8] or transmembrane potentials [9]. In the case of a uniform double layer model of the activation wavefront, the isochrones are computed as a result of inverse solution [10]. New approach to inverse recovery of the cardiac activity (timing of depolarization) was introduced in [11] using the fastest route algorithm.

A simple dipolar source as an equivalent cardiac generator could be used for inverse computations in cases, when the searched pathology is localized in a small area [12]. The equivalent dipole was suggested, for example, for finding the preexcitation sites (accessory pathways) in Wolf-Parkinson-White syndrome [12–14]. It is also possible to use the equivalent cardiac dipole for inverse localization of small regions with changed repolarization that occur because of local occlusion of a coronary artery. Changes of the repolarization phase of the action potential (AP) are reflected in the changes during STT interval in measured ECG signals [15–17] what is well noticeable in the integral maps from the STT interval as it was shown in [18,19]. The inverse localization of small lesions with changed repolarization by the inverse solution to one dipole was suggested in [20].

Two-dipole equivalent generator was used for the first time in order to obtain better description of the potential distribution on the torso surface [21]. Later the problem of finding two moving dipoles by an iterative procedure was studied in [22]. The problem of the existence and inverse reconstruction of dual accessory pathways using two dipoles was outlined and solved, for example, in [23,24].

The inverse solution to two dipoles for identification of two zones with changed repolarization is the follow-up of the previous study [20] and was briefly introduced in [25] and [26]. The assumption of presence of two simultaneous lesions leads to additional problems. One of them is whether we need the a priori information about the number of lesions or we are able to recognize the correct estimation of two lesions from the properties of the obtained solution. Therefore, in this study various characteristics of the inverse solution were suggested and tested as discriminating features for recognition of a correct inverse solution for cases with two lesions.

The aim of the presented article was to suggest the method for localization of two simultaneous lesions with changed repolarization and to study and evaluate its robustness to additional random noise in the input data. Because no a priori information about the number of lesions was assumed, the next aim was to find some discrimination criteria of correct solutions characterizing just two lesions.

In the simulation study the geometrical model of analytically defined heart ventricles was used [27]. The model consists of 1mm3 elements organized into five layers regarding their position between endocardium and epicardium. The experimentally observed action potentials (APs) are assigned to the elements of each layer [28]. The duration of AP is different in each ventricle and varies across the ventricular walls from 240 to 282ms [29]. In each step of activation, the moment of current dipole is computed in each cubic element from the difference between the APs of adjacent elements.

The lesions with changed repolarization were modeled as parts of a sphere or of an ellipsoid located in subendocardial or subepicardial myocardium. Their location was typical for stenosis of one of the three main coronary vessels. Eight types of lesions were defined in each position, giving together 48 types of single lesions. The types differed in shape and size of the affected area. The size of the lesions varied from 0.1 to 6.1% of the modeled ventricular volume with the radius of the lesions from 0.5 to 3.0cm. The changed repolarization was modeled by shortening the AP duration in the affected area by 20%.

Then the combinations of two lesions from different myocardium areas were used to model cases with two lesions simulating the two-vessel disease. In such cases pairs of lesions were created only from the lesions with approximately the same size and shape. Each member of the pair represented the area affected by different coronary artery. According the AHA anatomical nomenclature the lesions were situated in anterior, inferior and lateral segments of the left ventricle. To simulate the supply or demand ischemia both members of the couple of lesions were either subepicardial or subendocardial, respectively. The mean mutual distance between the centers of the lesions was 5.6±1.3cm (from 3.3 to 7.8cm). Three combinations of subepicardial and three combinations of subendocardial lesions were modeled. For each combination eight different types with various sizes and shapes of the lesions were considered, giving 48 pairs of modeled lesions in total. The positions and labels of combinations of lesions are shown in 
                        Fig. 1.

The body surface potentials and corresponding STT integral maps were computed for the normal ventricular activation and for pathological activations affected by the modeled lesions.

To compute the cardiac electric field, the model of heart ventricles in the form of multiple dipole generator was inserted in a realistically shaped torso model, which was a modification of the Dalhousie torso model [30]. Models of lungs with four times lower conductivity than average conductivity of the torso and ventricular cavities with three times higher conductivity representing the main electrical inhomogeneities were inserted into the torso. Body surface potential maps were computed using the boundary element method, proposed in [31] that has been frequently used ever since [32–34].

The difference integral map (DIM) was computed by subtraction of STT integral map obtained during normal activation from STT integral map obtained during activation of the ventricular model with pathology. Such computation of the DIM Δbm is then equivalent to the computation of an integral map for a difference multiple dipole integral generator Δs:
                           
                              (1)
                              
                                 Δ
                                 b
                                 m
                                 =
                                 A
                                 .
                                 
                                    
                                       s
                                    
                                    
                                       p
                                    
                                 
                                 −
                                 A
                                 .
                                 
                                    
                                       s
                                    
                                    
                                       n
                                    
                                 
                                 =
                                 A
                                 .
                                 
                                    (
                                    
                                       
                                          
                                             s
                                          
                                          
                                             p
                                          
                                       
                                       −
                                       
                                          
                                             s
                                          
                                          
                                             n
                                          
                                       
                                    
                                    )
                                 
                                 =
                                 A
                                 .
                                 Δ
                                 s
                              
                           
                        where A is the time independent transfer matrix that represents the properties of inhomogeneous torso as the volume conductor and s
                        n and s
                        p are integral multiple dipole generators representing the normal and pathological activation of the ventricular myocardium, respectively. Δs can be considered as representing integral multiple dipole generator characterizing only the modeled lesions with changed repolarization. In this study the DIM was computed for 48 cases of two simultaneous lesions and also for 48 cases with modeled single lesion. All computed DIMs were used as the input data for the inverse solution with two dipoles to imitate situations without a priori knowledge about the number of lesions and to compare the properties/character of obtained inverse solutions for two lesions and for one-single lesion.

To test the robustness of the inverse method three types of Gaussian random noise with the zero mean were applied to the DIMs. First, the random noise N1 was applied directly on DIMs to simulate the noise in ECG signals. The second type of noise - N2 simulated the noise in positioning of electrodes on the torso. The third type of noise - N3 was applied to components of dipole moments within the lesion and represented the variability of repolarization changes in the modeled pathology.

The SNR in the DIMs was computed using the formula:
                           
                              (2)
                              
                                 S
                                 N
                                 R
                                 =
                                 20
                                 
                                 
                                    
                                       log
                                    
                                    
                                       10
                                    
                                 
                                 
                                    
                                       rms
                                       (
                                       DIM
                                       )
                                    
                                    
                                       rms
                                       (
                                       noise
                                       )
                                    
                                 
                                 
                                 [
                                 d
                                 B
                                 ]
                              
                           
                        
                     

The basic assumption of the inverse method for localization of one lesion was, that the repolarization changes in one lesion can be represented by one integral dipole [20]. Using the same assumption for localization of two lesions the equivalent integral generator in the form of the couple of equivalent integral dipoles was searched in 168 predefined points evenly distributed in the modeled ventricular volume. The mean distance between the adjacent predefined positions was 1.05±0.13cm. All possible pairs of positions were considered for the inverse solution.

First, for each pair of predefined positions the pair of dipoles was computed by the inverse solution [26]. Then the best pair of dipoles was selected from all obtained pairs of dipoles according to the criterion of minimal relative residual error RMSDIF between the input DIM and the map generated by the particular pair of dipoles.

The value of RMSDIF characterized the quality of obtained inverse result. For further analysis of the inverse solution and stability of the results, the group of resulting pairs of dipoles with RMSDIF fulfilling the condition (3) was taken into account.
                           
                              (3)
                              
                                 RMSDIF
                                 ≤
                                 
                                 min
                                 
                                 RMSDIF
                                 +
                                 0.01
                              
                           
                        
                     

Considering the range of RMSDIF (0,1), the quantity 0.01 represents 1% of the range.

Then the modified K-means clustering method based on Euclidean distance between the dipoles was applied to all analyzed dipoles in the group to divide them into two clusters by an iterative algorithm [26]. The gravity center of the cluster and the mean dipole moment of the dipoles in the cluster were considered as the inversely found representatives of the modeled ischemic lesion.

For each modeled pair of lesions the localization errors of the inverse solution were computed as the Euclidean distance between the gravity center of the first lesion and the closer dipole of the inversely found pair of dipoles and the Euclidean distance between the second lesion and the other member of the dipole pair. The localization errors for modeled single lesion were not evaluated.

The modeled ventricles were divided into regions assigned either to the right ventricle or to one of three areas of the left ventricle supplied by three main coronary arteries (LAD-anterior, RCA-inferior or LCx-lateral). The cluster of dipoles was considered a correct representative of the modeled lesion (anterior, inferior or lateral) if more than 2/3 of the cluster׳s members belonged to the corresponding area of the ventricular model. The inverse solution was considered correct, if both clusters correctly denoted the positions of the two modeled lesions.

Visual observations of all obtained solutions revealed different properties/behavior of groups of dipoles in correct solutions for two lesions in comparison with incorrect solutions for two lesions and in solutions for single lesions (
                        Fig. 2). The incorrect solutions and the solutions for single lesions were similarly unstable. Therefore the inversely obtained solutions (clusters of results computed for modeled pairs of lesions and single lesions) were divided into two groups: the first group represented correct solutions for two lesions when both clusters assigned the locations of modeled lesions, the second group comprised incorrect solutions for modeled pairs of lesions as well as the solutions obtained for modeled single lesions. These two groups of solutions were used as classes in the next discriminant analysis. For each solution twenty three characteristics of the clusters of dipoles were specified as possible input features for the two class discrimination task.

The features were based on geometrical and statistical properties of two clusters of dipoles obtained by the inverse solution: number of results in clusters, mutual distance between the centers of clusters, standard deviation (std) of positions of dipoles in each cluster, mutual angle between the summary dipoles in each of both clusters, std of angles of dipoles in each cluster, ratio of the norms of summarized dipoles in each cluster and their combinations. Quadratic variant of Fisher׳s discriminant analysis (QDA) was applied to the data [35]. Where appropriate, some of the features were log-transformed in order to adjust the data distribution towards the Gaussian one.

Discriminant analysis was performed in two consecutive steps. First, the whole set of data was split by 5-fold manner into three sets 60%-20%-20% with five disjunct realizations for the last set. The first two sets were used for model selection, that is, feature reduction together with the choice of relevant features: Cross-validation technique was applied in a form of repeated random sub-sampling validation. In 1000 trials data from the first set was randomly chosen for training and data from the second set for validation. Feature selection was applied in order to reduce data dimensionality and to simplify data evaluation. Greedy forward selection algorithm was used by adding the best feature at each round. [36]. Then the third set was used in each of five trials for testing mode. Classification outcome was obtained as the number of correctly and incorrectly classified solutions. Percentage of true positives and true negatives as the sensitivity and specificity of the QDA was computed as well.

Then the optimal number of features for separation of the correct solutions for two lesions from the other solutions was searched. When the number of features was chosen, set of particular features was selected. With this fixed set of features the final classification was performed: The whole data set was split only into two parts with 80% for training and 20% for testing. Once more cross-validation with repeated random sub-sampling validation in 1000 trials was applied.

@&#RESULTS@&#

For each type of noise three levels of noise were simulated with SNR 20, 30 and 40dB. For each level of noise and each configuration of lesions (48 pairs of lesions and 48 single lesions) thirty realizations of noise were generated.

The inverse solution was computed for each modeled configuration of lesions, for each type of noise and each level of noise, that is, 270 solutions for particular configuration. The percentage of obtained correct solutions decreased for lower SNR as it is shown in 
                        Table 1.

Regarding different combinations of two lesions, the lowest rate of correct inverse solutions was obtained for endocardial lesions as it is shown in 
                        Fig. 3.

The localization error of correct inverse solutions for simulated pairs of lesions is summarized in 
                        Table 2. The localization error for incorrect solutions varied from 2.1±0.9cm (for noise N1, N2 and SNR 40dB) to 2.4±1.2cm (for N2 noise and SNR 20dB).

For classification purposes the results were grouped together only according to the level of noise, that is, the results obtained for all three types of noise were put to one package.

In 
                        Fig. 4 the sensitivity and specificity of the classification of correct results are depicted in dependence on the number of features used in the classification. The sensitivity improved rapidly when two features were used in classification, but remained almost unchanged when more than four features were used. Therefore in the last step specific four features were selected and used for final classification task. The selected features were the ratio of mutual distance between the centers of clusters and mean standard deviation of positions of dipoles in clusters; minimal/smaller value of standard deviations of angles of dipoles from two clusters in solution; mean standard deviation of projections of positions of dipoles to the flowline between centers of clusters and mean standard deviation of positions of dipoles in clusters. The sensitivity and specificity of classification for these four features are shown in 
                        Fig. 5. The values of sensitivity and specificity of classification using the selected four features varied from 90 to 93% and from 91 to 94% respectively.

@&#DISCUSSION@&#

Using the proposed method for identification of two lesions with changed repolarization the two modeled lesions were correctly localized in more than 81% of the solutions with the mean localization error 1.1±0.7cm up to the 20dB noise in the input data. Further classification allowed to distinguish more than 90% of them from the incorrect solutions and solutions obtained for single lesions.

Although the inverse solution to two dipoles is not ill-posed for particular predefined two positions of resulting dipoles, in general it can lead to many different results with similar quality (represented by the value of RMSDIF), because the two dipoles are searched as sources for one DIM (map) which is the sum of the effects of both dipoles. Therefore in each solution the group of results with similar quality was analyzed to study the stability of the solution.

From Fig. 3 it is apparent that the amount of correct inverse solutions identifying two lesions is considerably higher when the lesions are situated on the epicardial surface. One possible reason can be that epicardial lesions were modeled more distinct – the mean mutual distance between the centers of epicardial lesions was 6.1±1.1cm, while the mean mutual distance between the centers of endocardial lesions was 5.1±1.3cm.

Another reason for the existence of incorrect solutions could be the position of the lesion in relation to the measuring electrodes. Although we combined pairs of lesions with approximately the same size in the simulation study, in some cases their effect on the measured electric field was considerably different. Obviously the largest effect had the anterior lesions located closer to the torso surface. This can explain the worst rate of correct results for combination of anterior and lateral endocardial lesions where probably the lateral lesion was “shielded” by anterior one.

The unchanged value of the localization error for correct solutions regardless of the noise level can be explained by the use of the same rule for selection of correct results. The moderate increase of the localization error for incorrect results with bigger noise is probably caused by higher instability of these solutions.

For the cases with single lesion no localization error was evaluated, because for localization of single lesion the inverse solution with one dipole or a group of neighboring dipoles [37] is more suitable. The suggested method in this study is optimized for two distinct lesions and the cases with one lesion were included in this study only for discrimination and confirmation of correct solutions for cases with two lesions without a priori information about the number of lesions.

The suggested method assumes that measured ECG signals, both with and without manifested changed repolarization should be available for each examined patient. In practice the changed repolarization related to ischemia can be induced by the exercise test. That was the reason why various types of the additional noise up to the SNR of 20dB in the input data were studied. For the application of the method on real data the actual torso geometry as well as the position of the heart of the particular patient is needed as it was shown in [26] and [38]. To have such data for a patient admitted with acute myocardial infarction would be extremely difficult. However, such information can be obtained if ischemia is evoked in controlled conditions, for example, during the exercise testing. The patient geometry data can be obtained from CT or MR examination. The method can also be applied in identification of pathologies responsible for transient beat-to-beat changes in ECG, for example, the changes of the nondipolarity index in integral BSPMs reported in [39] or changes responsible for TWA [40].

Fisher׳s linear discriminant analysis is well-established classification method for multivariate normal distributions of each class. In the case of unequal covariance matrices, quadratic variant of Fisher׳s discriminant analysis (QDA) is recommended [36]. The need of the use of the QDA for presented data was supported by inspection of histograms of each single feature for defined two classes. Then the best of them was chosen by feature selection method.

The addition of the second lesion to the first one increased significantly the complexity of the inverse problem. In addition to the search of the positions of the dipoles representing the modeled lesions, the next question was how to recognize, without an a priori information about the number of lesions, that there were really two lesions in the heart and not only one lesion. Therefore the additional processing and analysis of the results of the inverse solution was proposed and twenty three features of the obtained inverse solution were specified to classify the correct solution representing two modeled lesions.

The use of four most informative features of obtained solutions allowed the correct identification of two lesions in more than 90% of correct solutions regardless of the type of noise. Further increase of the number of features included in the QDA analysis led only to moderate increase of the sensitivity of classification, because they were correlated, as it is shown in 
                        Table 3 for selected four features. The first two features were not correlated so that the addition of the second feature improved the sensitivity of the classification considerably.

The best (the most informative) feature was the ratio of the mutual distance between the cluster centers and the mean standard deviation of positions of the dipoles in the clusters. The higher this value was the more distinct were the clusters characterizing the modeled lesions. In cases of incorrect solutions there were usually large numbers of analyzed results spread over the modeled ventricular volume and the clusters overlapped (Fig. 2 middle).

The second best feature was the minimal value of standard deviations of angles of dipoles from two clusters in solution. In correct solutions the directions of the dipoles in clusters were similar and the value of this feature was very small (Fig. 2 left ).

The third and fourth features were the mean standard deviation of positions of dipoles in the clusters and the mean standard deviation of projections of these positions to the flowline between the centers of clusters. Both these features characterize a stability of obtained results, thus the correct inverse solution identifying two lesions is characterized by two distinct clusters of dipoles with similar direction.

@&#CONCLUSION@&#

In this simulation study the method for noninvasive identification and localization of two regions with changed repolarization using the inverse solution of electrocardiography with two dipoles was introduced. The input DIMs for the proposed inverse method were computed from the BSPMs measured from the same subject in situations with and without the manifestation of the repolarization changes.

The method was applied to 96 cases of simulated BSPMs computed for 48 cases with two simultaneous lesions and 48 cases with one lesion. For each case three sources of noise in input data were added, each expressed with SNR 20, 30 and 40dB.

To recognize the correct solutions of the inverse identification of two simultaneous lesions the discrimination method was suggested. Four of twenty three suggested features were selected for final classification of correct solutions. The mean localization error for the inverse solutions correctly identifying two lesions was 1.1±0.7cm. The sensitivity and specificity of the classification was more than 90%.

The proposed inverse method together with the discriminant analysis provide a tool for noninvasive identification of two distinct areas of ventricles with changed repolarization from multiple-leads ECG measurements on the patient׳s thorax, that does not need an a priori knowledge about the number of lesions.

@&#SUMMARY@&#

In the simulation study the method for identification and localization of two simultaneous lesions with changed repolarization in the model of the heart ventricles was proposed.

In a numerical model of ventricles 48 cases of simultaneous two lesions and 48 cases of single lesion were modeled and corresponding integral body surface potential maps (BSPMs) were computed on the surface of the inhomogeneous torso model. The inverse solution was computed to two dipoles, each of them should represent one modeled lesion. The input data for inverse solution were difference integral BSPMs obtained by subtraction of STT integral BSPM computed during normal activation from the STT integral BSPM computed from the model with repolarization changes. The input difference integral BSPMs were disturbed by three types of added noise, simulating the noise in the measured data, imprecision in electrode positioning and variations in repolarization changes. Each type of noise was simulated in three levels reflected in BSPMs with signal-to-noise ratio 20dB, 30dB and 40dB. The best position of inversely found pair of dipoles was chosen from all possible combinations of predefined points spreading regularly in the modeled myocardium according to the criteria of the minimal residual error between the input BSPM and BSPM computed by the inversely reconstructed pair of dipoles. In some cases the inverse method can give qualitatively similar, though ambiguous results. Therefore the stability of the inverse solution was studied using the group of the best resulting pairs of dipoles for each input map. Twenty three characteristics of every obtained inverse solution were specified and tested as the features in discriminant analysis task distinguishing the correct inverse solutions identifying two lesions from incorrect solutions and solutions for single lesion. Then four of them were selected for final classification.

The average amount of correctly identified couples of lesions decreased with decreasing of signal-to-noise ratio in input data from approx. 86% to approx. 81%. The mean localization error for correctly identified two lesions was 1.1±0.7cm regardless of the type or level of the noise. The mean localization error of incorrect solutions was from 2.1±0.9cm to 2.4±1.2cm in dependence of the noise. From twenty three features of every obtained inverse solution the four most informative were selected and used in Quadratic Fisher discrimination analysis to split the inverse solutions to two classes. In the first class there were the inverse solutions correctly representing two modeled lesions, while in the second class there were incorrect solutions for two modeled lesions together with the solutions for single modeled lesions. The sensitivity and specificity of the classification were greater than 90%.

The proposed inverse method together with the discriminant analysis provides a tool for noninvasive identification of two distinct areas of ventricles with changed repolarization from multiple-leads ECG measurements on the patient׳s thorax, that does not need an a priori knowledge about the number of the lesions.

None of the authors has any conflict of interest, financial or otherwise.

@&#ACKNOWLEDGEMENTS@&#

This work was supported by research grant No. 2/0131/13 of the Vega Grant Agency in Slovakia and grant No. APVV-0513–10 from the Slovak Research and Development Agency.

@&#REFERENCES@&#

