@&#MAIN-TITLE@&#A new basis for PHT-splines

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We make analysis of the previously constructed basis functions of PHT-splines and observe a decay phenomenon of the basis functions under certain refinement of T-meshes.


                        
                        
                           
                           We propose a new basis consisting of a set of local tensor product B-splines for PHT-splines which overcomes the decay phenomenon.


                        
                        
                           
                           Some examples are provided for solving numerical PDEs with the new basis, and comparison is made between the new basis and the original basis. Experimental results suggest that the new basis provides better numerical stability in solving numerical PDEs.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

PHT-spline

Basis function

Condition number

Isogeometric analysis

@&#ABSTRACT@&#


               
               
                  PHT-splines (polynomials splines over hierarchical T-meshes) are a generalization of B-splines over hierarchical T-meshes which possess a very efficient local refinement property. This property makes PHT-splines preferable in geometric processing, adaptive finite elements and isogeometric analysis. In this paper, we first make analysis of the previously constructed basis functions of PHT-splines and observe a decay phenomenon of the basis functions under certain refinement of T-meshes, which is not expected in applications. We then propose a new basis consisting of a set of local tensor product B-splines for PHT-splines which overcomes the decay phenomenon. Some examples are provided for solving numerical PDEs with the new basis, and comparison is made between the new basis and the original basis. Experimental results suggest that the new basis provides better numerical stability in solving numerical PDEs.
               
            

@&#INTRODUCTION@&#

In CAD/CAM industry, freeform surfaces are usually represented by tensor product polynomials or rational maps such as tensor-product B-splines or NURBS. For these standard tensor-product representations, a weakness is the lack of local refinement property since the control points must lie topologically on a rectangular grid. In the past decades, several kinds of locally refined splines have been proposed to address the problem.

The pioneering work on this topic is hierarchical splines [1], where the details of a model are identified by means of a hierarchy of tensor product splines. Based on such hierarchical model, complex surfaces can be created from simple NURBS surfaces by hierarchical editing. Later on, related work mainly focuses on constructing basis functions for hierarchical spline spaces, including the linearly independent selection mechanism [2] and the truncated selection mechanism [3]. Another important progress of locally refinable splines is the invention of T-splines [4,5] which permits T-junctions in a control mesh. T-splines overcome the weakness of NURBS and have already shown its potential as a powerful modeling tool for advanced geometric modeling and adaptive isogeometric analysis [6,7]. Analysis-suitable T-splines (AST-splines for short) [8,9] which are defined over restricted T-meshes was proposed to fix the linear dependency problem of T-splines. AST-splines form a subset of T-splines and have desired properties which are suitable for analysis. Other related local refinable splines include LR-splines [10,11] and Modified T-splines [12], which are also suitable in adaptive geometric modeling and isogeometric analysis.

Polynomial splines over hierarchical T-meshes (called PHT-splines) were introduced by two of the present authors in [13]. PHT-splines possess a very efficient local refinement algorithm and inherit many good properties of T-splines such as adaptivity and locality. Owing to these nice properties, PHT-splines have been widely applied in geometric modeling and isogeometric analysis. With PHT-splines, surface models can be reconstructed and simplified efficiently [13]. PHT-splines were also applied in surface reconstruction from a very large set of point clouds in implicit form [14]. In [15], PHT-splines were used in stitching several surface patches to construct complex models. The finite element discretization of elliptic equations based on PHT-splines was discussed in [16], where numerical solutions are refined adaptively and have the optimal convergence rate. PHT-splines are also favored in isogeometric analysis for solving elastic problems, see for example [17–20]. An extension of PHT-splines over general T-meshes is explored in  [21].

In [13], the authors presented a level-by-level strategy to construct basis functions for PHT-splines. The constructed basis functions share some important properties with B-splines, such as nonnegativity, local support and partition of unity. Unfortunately, the basis functions of PHT-splines reveal a decay phenomenon for certain types of refinement of T-meshes. A typical example is shown in Fig. 6, where the basis functions associated with the bottom-right vertex (marked by a yellow circle) at different levels are plotted. As the level increases, the finer basis functions approach zero rapidly. Such a decay is not expected in practical applications since the matrices assembled by these basis functions are likely to be ill-conditioned.

The goal of the current paper is to propose a new basis construction for PHT-splines to avoid the decay. The construction rule is simple, the new basis functions are defined as tensor product B-spline functions without applying truncation mechanism. Comparing to the original basis functions, the new basis functions do not decay for any underlying T-meshes, but at the cost of a little bigger supports and of destroying the partition of unity. From numerical experiments, we notice that the new basis functions have better numerical stability than that of the original basis functions.

The remainder of the current paper is organized as follows. In Section 2, we recall the definition of hierarchical T-meshes and PHT-splines. In Section 3, the decay phenomenon of the original PHT-spline basis functions is analyzed. In Section 4, the proposed new basis construction is presented in detail. Some properties of the new basis functions are also discussed. In Section 5, we compare the performance of the new basis functions and the original basis functions in isogeometric analysis. Section 6 concludes the paper with a summary and future work.

In this section, we recall some preliminary knowledge of PHT-splines, including hierarchical T-meshes and the definition of PHT-splines.

A T-mesh is a rectangular grid that allows T-junctions. It is assumed that the end points of each grid line in the T-mesh must be on two other grid lines and each cell or facet in the grid must be a rectangle. Fig. 1
                        (a) illustrates a T-mesh while the mesh in Fig. 1(b) is not. The rectangles are also called the faces or cells of the T-mesh. A grid point in a T-mesh is called a vertex of the T-mesh. The line segment connecting two adjacent vertices on a grid line is called an edge of the T-mesh.

If the vertex is on the boundary grid line, then it is called a boundary vertex, otherwise it is called an interior vertex. For example, b
                        0, b
                        1, … , b
                        12, b
                        13 in Fig. 1(a) are boundary vertices, while v
                        0, v
                        1, … , v
                        4, v
                        5 are interior vertices. Interior vertices have two types: one is crossing vertices, for example, v
                        0, v
                        1, v
                        3, v
                        5 in Fig. 1(a), and the other one is T-vertices, for example, v
                        2, v
                        4 in Fig. 1(a).

A hierarchical T-mesh is a special type of T-mesh which has a natural level structure. It is defined in a recursive fashion. One generally starts from a tensor-product mesh (level 0). From level k to level 
                           
                              k
                              +
                              1
                              ,
                           
                         one subdivide a cell at level k into four subcells which are cells at level 
                           
                              k
                              +
                              1
                           
                        . For simplicity, we consider dyadic refinement. Fig. 2
                         shows an example of hierarchical T-meshes.

Given a T-mesh 
                           
                              T
                              ,
                           
                        
                        
                           F
                         denotes all the cells in 
                           T
                         and Ω denotes the region occupied by 
                           F
                        . The polynomial spline space over 
                           T
                         is defined as

                           
                              
                                 
                                    
                                       
                                          
                                             S
                                             (
                                             m
                                             ,
                                             n
                                             ,
                                             α
                                             ,
                                             β
                                             ,
                                             T
                                             )
                                             :
                                             =
                                          
                                       
                                       
                                          
                                             {
                                             s
                                             
                                                (
                                                x
                                                ,
                                                y
                                                )
                                             
                                             ∈
                                             
                                                C
                                                
                                                   α
                                                   ,
                                                   β
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      Ω
                                                      )
                                                   
                                                   |
                                                   s
                                                   
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      )
                                                   
                                                   |
                                                
                                                ϕ
                                             
                                             ∈
                                             
                                                P
                                                
                                                   m
                                                   n
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             for
                                             
                                             any
                                             
                                             ϕ
                                             ∈
                                             F
                                             }
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              P
                              
                                 m
                                 n
                              
                           
                         is the space of all the polynomials with bi-degree (m, n), and C
                        
                           α,β
                        (Ω) is the space consisting of all the bivariate functions which are continuous in Ω with order α in the x-direction and with order β in the y-direction.

When 
                           
                              m
                              ≥
                              2
                              α
                              +
                              1
                              ,
                              n
                              ≥
                              2
                              β
                              +
                              1
                              ,
                           
                         the dimension of the spline space 
                           
                              S
                              (
                              m
                              ,
                              n
                              ,
                              α
                              ,
                              β
                              ,
                              T
                              )
                           
                         is given in [22]. For the splines 
                           
                              S
                              (
                              3
                              ,
                              3
                              ,
                              1
                              ,
                              1
                              ,
                              T
                              )
                           
                         with 
                           T
                         being a hierarchical T-mesh, the dimension formula has a concise expression

                           
                              (1)
                              
                                 
                                    S
                                    
                                       (
                                       3
                                       ,
                                       3
                                       ,
                                       1
                                       ,
                                       1
                                       ,
                                       T
                                       )
                                    
                                    =
                                    4
                                    
                                       (
                                       
                                          V
                                          b
                                       
                                       +
                                       
                                          V
                                          +
                                       
                                       )
                                    
                                    ,
                                 
                              
                           
                        where Vb
                         and 
                           
                              V
                              +
                           
                         represent the number of boundary vertices and interior crossing vertices in 
                           T
                         respectively.

As in [13], we call a boundary vertex or an interior crossing vertex a basis vertex. According to the dimension formula (1), each basis vertex associates with four basis functions. So the basis construction of PHT-splines is to construct four bicubic C
                        1 continuous functions for each basis vertex such that the constructed functions span the PHT-spline space and preserve some good properties. Hereafter, the basis functions constructed in [13] are called the original basis functions, and the basis functions constructed in this paper are called the new basis functions.
                        
                     

In this section, we briefly review the basis construction in [13] and illustrate the decay phenomenon of the original basis functions under certain refinement of T-meshes.

In [13], a level-by-level strategy is proposed to construct basis functions for PHT-splines. For the initial level (denoted as 
                           
                              T
                              0
                           
                        ), the standard bicubic C
                        1 continuous tensor-product B-splines are used as basis functions. A hierarchical T-mesh at level k is denoted as 
                           
                              T
                              k
                           
                        . Suppose the basis functions 
                           
                              {
                              
                                 b
                                 j
                                 k
                              
                              }
                              ,
                           
                        
                        
                           
                              j
                              =
                              1
                              ,
                              …
                              ,
                              
                                 d
                                 k
                              
                              ,
                           
                         on 
                           
                              T
                              k
                           
                         have been constructed, and then the basis functions on 
                           
                              T
                              
                                 k
                                 +
                                 1
                              
                           
                         are constructed by two steps: 1) truncating the basis functions 
                           
                              
                                 {
                                 
                                    b
                                    j
                                    k
                                 
                                 }
                              
                              
                                 j
                                 =
                                 1
                              
                              
                                 d
                                 k
                              
                           
                         on 
                           
                              T
                              k
                           
                        ; 2) constructing bicubic C
                        1 continuous B-splines basis functions associated with the new basis vertices in 
                           
                              T
                              
                                 k
                                 +
                                 1
                              
                           
                        .

Now we describe the details of the first step. For brevity, a bicubic basis function is represented in the Bézier form by specifying its 16 Bézier ordinates in every cell within the support of the basis function. Suppose, among all the cells at level k, the cells 
                           
                              
                                 θ
                                 i
                                 k
                              
                              ,
                           
                        
                        
                           
                              i
                              =
                              1
                              ,
                              …
                              ,
                              
                                 C
                                 k
                              
                              ,
                           
                         are subdivided. For each j, if the basis function 
                           
                              b
                              j
                              k
                           
                         does not vanish in some cells of 
                           
                              {
                              
                                 θ
                                 i
                                 k
                              
                              }
                              ,
                           
                         then represent it in Bézier forms on these cells at level 
                           
                              k
                              +
                              1
                           
                        . It should be noted that the function 
                           
                              b
                              j
                              k
                           
                         has not changed, but is now defined over the mesh 
                           
                              T
                              
                                 k
                                 +
                                 1
                              
                           
                        .

From 
                           
                              T
                              k
                           
                         to 
                           
                              T
                              
                                 k
                                 +
                                 1
                              
                           
                        , some new basis vertices appear. Denote them as 
                           
                              ξ
                              i
                              
                                 k
                                 +
                                 1
                              
                           
                        , 
                           
                              i
                              =
                              1
                              ,
                              …
                              ,
                              
                                 V
                                 
                                    k
                                    +
                                    1
                                 
                              
                           
                        . In each cell at level 
                           
                              k
                              +
                              1
                              ,
                           
                         the 16 Bézier ordinates are divided into four parts. Each part is associated with a cell corner vertex as shown in Fig. 3. Then all the basis functions 
                           
                              
                                 {
                                 
                                    b
                                    j
                                    k
                                 
                                 }
                              
                              
                                 j
                                 =
                                 1
                              
                              
                                 d
                                 k
                              
                           
                         at level k are modified to 
                           
                              
                                 {
                                 
                                    
                                       b
                                       ¯
                                    
                                    j
                                    k
                                 
                                 }
                              
                              
                                 j
                                 =
                                 1
                              
                              
                                 d
                                 k
                              
                           
                         in the following fashion: for each j, reset all the associated Bézier ordinates with the new basis vertices to zero. One can show that 
                           
                              
                                 {
                                 
                                    
                                       b
                                       ¯
                                    
                                    j
                                    k
                                 
                                 }
                              
                              
                                 j
                                 =
                                 1
                              
                              
                                 d
                                 k
                              
                           
                         are in 
                           
                              S
                              (
                              3
                              ,
                              3
                              ,
                              1
                              ,
                              1
                              ,
                              
                                 T
                                 
                                    k
                                    +
                                    1
                                 
                              
                              )
                           
                        .


                        Fig. 4 illustrates the above construction process. Suppose the 16 Bézier ordinates of a basis function over a cell are shown in Fig. 4(a), where the yellow circles are basis vertices. In Fig. 4(b), the cell is subdivided into four subcells with two new basis vertices produced and the Bézier ordinates over four subcells of the basis function are also shown. The Bézier ordinates associated with new basis vertices are set to zeros. Fig. 4(c) shows the Bézier ordinates of the basis functions over the four subcells after truncation.

For the second step of the basis construction, for each new basis vertex at level 
                           
                              k
                              +
                              1
                              ,
                           
                         four new basis functions are constructed which are simple tensor product B-splines.

The basis functions constructed as above are nonnegative, linearly independent, form a partition of unity and have local supports.

We take the hierarchical T-meshes in Figs. 6 and 7 as two examples to explain how the decay of a basis function is produced.
                        
                        
                     

The vertex marked by a yellow circle in Fig. 6 is denoted as v, and the four basis functions associated with v at level k are denoted as 
                           
                              
                                 b
                                 0
                                 k
                              
                              ,
                              
                                 b
                                 1
                                 k
                              
                              ,
                              
                                 b
                                 2
                                 k
                              
                              ,
                              
                                 b
                                 3
                                 k
                              
                           
                        . At level 
                           
                              k
                              =
                              0
                              ,
                           
                        
                        
                           
                              
                                 b
                                 0
                                 k
                              
                              ,
                              
                                 b
                                 1
                                 k
                              
                              ,
                              
                                 b
                                 2
                                 k
                              
                              ,
                              
                                 b
                                 3
                                 k
                              
                           
                         are defined as four bicubic B-splines with the following knot vectors respectively:

                           
                              
                                 
                                    
                                       b
                                       0
                                       0
                                    
                                    :
                                    
                                       (
                                       0
                                       ,
                                       0
                                       ,
                                       1
                                       ,
                                       1
                                       ,
                                       1
                                       )
                                    
                                    ×
                                    
                                       (
                                       0
                                       ,
                                       0
                                       ,
                                       0
                                       ,
                                       0
                                       ,
                                       1
                                       )
                                    
                                    ,
                                 
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       b
                                       1
                                       0
                                    
                                    :
                                    
                                       (
                                       0
                                       ,
                                       0
                                       ,
                                       1
                                       ,
                                       1
                                       ,
                                       1
                                       )
                                    
                                    ×
                                    
                                       (
                                       0
                                       ,
                                       0
                                       ,
                                       0
                                       ,
                                       1
                                       ,
                                       1
                                       )
                                    
                                    ,
                                 
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       b
                                       2
                                       0
                                    
                                    :
                                    
                                       (
                                       0
                                       ,
                                       1
                                       ,
                                       1
                                       ,
                                       1
                                       ,
                                       1
                                       )
                                    
                                    ×
                                    
                                       (
                                       0
                                       ,
                                       0
                                       ,
                                       0
                                       ,
                                       0
                                       ,
                                       1
                                       )
                                    
                                    ,
                                 
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       b
                                       3
                                       0
                                    
                                    :
                                    
                                       (
                                       0
                                       ,
                                       1
                                       ,
                                       1
                                       ,
                                       1
                                       ,
                                       1
                                       )
                                    
                                    ×
                                    
                                       (
                                       0
                                       ,
                                       0
                                       ,
                                       0
                                       ,
                                       1
                                       ,
                                       1
                                       )
                                    
                                    .
                                 
                              
                           
                        At level k > 0, for each j, 
                           
                              b
                              j
                              k
                           
                         is constructed by truncating 
                           
                              b
                              j
                              
                                 k
                                 −
                                 1
                              
                           
                         according to the strategy reviewed in Section 3.1. Table 1 shows the maximum value of 
                           
                              
                                 b
                                 0
                                 k
                              
                              ,
                           
                        
                        
                           
                              
                                 b
                                 1
                                 k
                              
                              ,
                           
                        
                        
                           
                              
                                 b
                                 2
                                 k
                              
                              ,
                           
                        
                        
                           
                              b
                              3
                              k
                           
                         at level 
                           
                              k
                              =
                              0
                              ,
                              …
                              ,
                              5
                           
                        . It can be seen that 
                           
                              
                                 b
                                 0
                                 k
                              
                              ,
                           
                        
                        
                           
                              
                                 b
                                 1
                                 k
                              
                              ,
                           
                        
                        
                           
                              b
                              3
                              k
                           
                         all have undesired decay under the refinement of the T-mesh, and their decay rates are 
                           
                              
                                 1
                                 2
                              
                              ,
                           
                        
                        
                           
                              
                                 1
                                 4
                              
                              ,
                           
                        
                        
                           
                              1
                              2
                           
                         respectively.

We take 
                           
                              b
                              1
                              k
                           
                         as an example for detailed analysis. From the Bézier forms of 
                           
                              b
                              1
                              0
                           
                         and 
                           
                              b
                              1
                              1
                           
                         as shown in Fig. 5, we have 
                           
                              
                                 b
                                 1
                                 1
                              
                              =
                              
                                 1
                                 4
                              
                              
                                 b
                                 1
                                 0
                              
                           
                         over the support of 
                           
                              b
                              1
                              1
                           
                        . In general, it is easy to show that 
                           
                              
                                 b
                                 1
                                 k
                              
                              =
                              
                                 1
                                 4
                              
                              
                                 b
                                 1
                                 
                                    k
                                    −
                                    1
                                 
                              
                           
                         over the support of 
                           
                              b
                              1
                              k
                           
                         for any k. This means that after one step of refinement, one of the four basis functions associated with v decays by 1/4. Fig. 6 shows the basis functions 
                           
                              b
                              1
                              k
                           
                         from 
                           
                              k
                              =
                              0
                           
                         to 
                           
                              k
                              =
                              5
                           
                        .

The vertex marked by a yellow circle in Fig. 7(a) is denoted as v. One of the four basis functions associated with v at level k is denoted as bk
                        . Fig. 7(a) shows four hierarchical T-meshes at levels 0, 1, 3, 4. We plot bk
                         and its corresponding contours at levels 
                           
                              k
                              =
                              0
                              ,
                              1
                              ,
                              3
                              ,
                              4
                           
                         in Fig. 7(b) and (c) respectively. For this example, the maximum value of bk
                         does not decrease as the level k increases, but bk
                         decays sharply along the refinement direction. The decay phenomenon of this example is different from that as shown in Fig. 6, but it is still not expected in numerical computation. This example also shows that the decay not only appears at a corner.

The above two examples are two extreme hierarchical T-meshes, where some cells around a vertex are refined heavily. If the vertex is a corner, three of the four basis functions associated with the vertex decay severely with a constant rate; if the vertex is an interior vertex, a part of the basis functions associated with the vertex decay. Actually one can image that for a basis function, the bigger the level difference in the support of the basis function is, the severer the decay of the basis function will be.
                     

From the above analysis, the decay is mainly caused by the truncation mechanism used in basis construction. To address the decay, a simple way is to scale the decayed basis functions such that their maximum values are equal to one. However, such a strategy cannot fix the decay problem as shown in Fig. 7. So in the following section, we introduce a completely new method for constructing basis functions for PHT-splines.

By the dimension formula (1), we need to construct four basis functions for each basis vertex. Then there is a natural way to do this – construct four tensor product B-spline functions associated with the basis vertex. We discuss it in details below.

Consider a 2 × 2 tensor product mesh Tp
                      as shown in Fig. 8
                     , where vc
                      (the yellow solid circle) is the central vertex of Tp
                     , and s
                     0 < s
                     1 < s
                     2 and t
                     0 < t
                     1 < t
                     2 are the knot vectors in the s-direction and t-direction respectively. Then there are four C
                     1 continuous bicubic tensor product B-spline functions associated with the mesh Tp
                     :

                        
                           
                              
                                 
                                    N
                                    3
                                 
                                 
                                    [
                                    
                                       s
                                       0
                                    
                                    ,
                                    
                                       s
                                       0
                                    
                                    ,
                                    
                                       s
                                       1
                                    
                                    ,
                                    
                                       s
                                       1
                                    
                                    ,
                                    
                                       s
                                       2
                                    
                                    ]
                                 
                                 ×
                                 
                                    N
                                    3
                                 
                                 
                                    [
                                    
                                       t
                                       0
                                    
                                    ,
                                    
                                       t
                                       1
                                    
                                    ,
                                    
                                       t
                                       1
                                    
                                    ,
                                    
                                       t
                                       2
                                    
                                    ,
                                    
                                       t
                                       2
                                    
                                    ]
                                 
                                 ,
                              
                           
                        
                     
                     
                        
                           
                              
                                 
                                    N
                                    3
                                 
                                 
                                    [
                                    
                                       s
                                       0
                                    
                                    ,
                                    
                                       s
                                       0
                                    
                                    ,
                                    
                                       s
                                       1
                                    
                                    ,
                                    
                                       s
                                       1
                                    
                                    ,
                                    
                                       s
                                       2
                                    
                                    ]
                                 
                                 ×
                                 
                                    N
                                    3
                                 
                                 
                                    [
                                    
                                       t
                                       0
                                    
                                    ,
                                    
                                       t
                                       0
                                    
                                    ,
                                    
                                       t
                                       1
                                    
                                    ,
                                    
                                       t
                                       1
                                    
                                    ,
                                    
                                       t
                                       2
                                    
                                    ]
                                 
                                 ,
                              
                           
                        
                     
                     
                        
                           
                              
                                 
                                    N
                                    3
                                 
                                 
                                    [
                                    
                                       s
                                       0
                                    
                                    ,
                                    
                                       s
                                       1
                                    
                                    ,
                                    
                                       s
                                       1
                                    
                                    ,
                                    
                                       s
                                       2
                                    
                                    ,
                                    
                                       s
                                       2
                                    
                                    ]
                                 
                                 ×
                                 
                                    N
                                    3
                                 
                                 
                                    [
                                    
                                       t
                                       0
                                    
                                    ,
                                    
                                       t
                                       1
                                    
                                    ,
                                    
                                       t
                                       1
                                    
                                    ,
                                    
                                       t
                                       2
                                    
                                    ,
                                    
                                       t
                                       2
                                    
                                    ]
                                 
                                 ,
                              
                           
                        
                     
                     
                        
                           
                              
                                 
                                    N
                                    3
                                 
                                 
                                    [
                                    
                                       s
                                       0
                                    
                                    ,
                                    
                                       s
                                       1
                                    
                                    ,
                                    
                                       s
                                       1
                                    
                                    ,
                                    
                                       s
                                       2
                                    
                                    ,
                                    
                                       s
                                       2
                                    
                                    ]
                                 
                                 ×
                                 
                                    N
                                    3
                                 
                                 
                                    [
                                    
                                       t
                                       0
                                    
                                    ,
                                    
                                       t
                                       0
                                    
                                    ,
                                    
                                       t
                                       1
                                    
                                    ,
                                    
                                       t
                                       1
                                    
                                    ,
                                    
                                       t
                                       2
                                    
                                    ]
                                 
                                 .
                              
                           
                        
                     These four basis functions are linearly independent and have the same support [s
                     0, s
                     2] × [t
                     0, t
                     2], and their Hermitian information vanish at the vertices in Tp
                      except for vc
                     . Here the Hermitian information of a function is defined as the function value, the first order partial derivatives and the mixed partial derivative of the function.

Our basis construction method depends on the following definition.

                        Definition 1
                        Suppose v is a basis vertex in a T-mesh 
                              T
                           . The support mesh Tv
                            of v is defined as a minimal 2 × 2 tensor product mesh which satisfies a) the central vertex of the mesh is v; and b) the edges of the mesh Tv
                            are composed of the edges in 
                              T
                           .

Note that if v is a boundary vertex, the support mesh is actually a 2 × 1, 1 × 2 or 1 × 1 tensor product mesh satisfying the conditions a) and b) in Definition 1. Fig. 9
                      illustrates the support meshes of five basis vertices including two boundary vertices and three interior crossing vertices, where the five basis vertices are marked by solid circles and the corresponding support meshes are marked by bold lines with the same color as vertices.

                        Remark 1
                        For a general T-mesh, a basis vertex may not necessarily correspond to a support mesh as illustrated in Fig. 18(a). But for any given hierarchical T-mesh, the support mesh of each basis vertex must exist and unique, and can be found efficiently since we always start from a tensor product mesh and make the refinement by subdividing each cell into four equal subcells. In the following discussion, we restrict our discussion to hierarchical T-meshes.

Now we are ready to present the basis construction algorithm for PHT-splines.

                        
                           Input
                           A hierarchical T-mesh 
                                 T
                               in the 2D plane.

A set of basis functions bi
                              (s, t) for the spline space 
                                 
                                    S
                                    (
                                    3
                                    ,
                                    3
                                    ,
                                    1
                                    ,
                                    1
                                    ,
                                    T
                                    )
                                 
                              .

For each basis vertex v in 
                                 
                                    T
                                    ,
                                 
                               find the support mesh Tv
                              .

Output the four tensor product B-spline functions associated with the support mesh Tv
                              , which are treated as the basis functions over 
                                 T
                              .

The basis functions constructed by the above algorithm are a collection of B-splines, but their linear independence is not clear. The following theorem provides a positive answer.

                        Theorem 1
                        
                           Let
                           
                              T
                            
                           be a hierarchical T-mesh with n basis vertices and
                           
                              
                                 
                                    {
                                    
                                       b
                                       i
                                    
                                    }
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    4
                                    n
                                 
                              
                            
                           be the B-splines functions constructed by the above algorithm. Then
                           
                              
                                 
                                    {
                                    
                                       b
                                       i
                                    
                                    }
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    4
                                    n
                                 
                              
                            
                           are linearly independent, and thus span the PHT-spline space
                           
                              
                                 S
                                 (
                                 3
                                 ,
                                 3
                                 ,
                                 1
                                 ,
                                 1
                                 ,
                                 T
                                 )
                              
                           
                           .
                        

We have to prove that

                              
                                 (2)
                                 
                                    
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             4
                                             n
                                          
                                       
                                       
                                          c
                                          i
                                       
                                       
                                          b
                                          i
                                       
                                       
                                          (
                                          s
                                          ,
                                          t
                                          )
                                       
                                       =
                                       0
                                       ⟹
                                       
                                          c
                                          i
                                       
                                       =
                                       0
                                       ,
                                       
                                       i
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       4
                                       n
                                       .
                                    
                                 
                              
                           
                        

Suppose that the maximal subdivision level of 
                              T
                            is N and 
                              
                                 T
                                 k
                              
                            denotes the hierarchical T-mesh at level k, 
                              
                                 k
                                 =
                                 0
                                 ,
                                 …
                                 ,
                                 N
                              
                           . Then we have 
                              
                                 T
                                 =
                                 
                                    T
                                    N
                                 
                              
                           . For a basis vertex v, if 
                              
                                 v
                                 ∈
                                 
                                    T
                                    k
                                 
                              
                            but 
                              
                                 v
                                 ∉
                                 
                                    T
                                    
                                       k
                                       −
                                       1
                                    
                                 
                                 ,
                              
                            then it is called a basis vertex at level k, 
                              
                                 k
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 N
                              
                           . Specially, every vertex in 
                              
                                 T
                                 0
                              
                            is a basis vertex at level 0. The ith basis vertex at level k is denoted by 
                              
                                 v
                                 i
                                 k
                              
                            and the four basis functions associated with 
                              
                                 v
                                 i
                                 k
                              
                            are denoted as 
                              
                                 
                                    b
                                    
                                       4
                                       i
                                       +
                                       j
                                    
                                    k
                                 
                                 ,
                              
                           
                           
                              
                                 j
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 2
                                 ,
                                 3
                              
                           .

Then Eq. (2) can be reformulated as

                              
                                 (3)
                                 
                                    
                                       
                                          ∑
                                          
                                             k
                                             =
                                             0
                                          
                                          N
                                       
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             n
                                             k
                                          
                                       
                                       
                                          ∑
                                          
                                             j
                                             =
                                             0
                                          
                                          3
                                       
                                       
                                          c
                                          
                                             4
                                             i
                                             +
                                             j
                                          
                                          k
                                       
                                       
                                          b
                                          
                                             4
                                             i
                                             +
                                             j
                                          
                                          k
                                       
                                       
                                          (
                                          s
                                          ,
                                          t
                                          )
                                       
                                       =
                                       0
                                       ,
                                    
                                 
                              
                           where nk
                            is the number of basis vertices at level k.

According to the definitions of support meshes and hierarchical T-meshes, a basis vertex at level l can not be in the interior of the support of any basis function at level k > l. Hence when l < k, we have 
                              
                                 
                                    b
                                    
                                       4
                                       i
                                       +
                                       j
                                    
                                    k
                                 
                                 
                                    (
                                    
                                       v
                                       g
                                       l
                                    
                                    )
                                 
                                 =
                                 0
                                 ,
                              
                            for 
                              
                                 j
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 2
                                 ,
                                 3
                                 ,
                              
                           
                           
                              
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 
                                    n
                                    k
                                 
                                 ,
                              
                           
                           
                              
                                 g
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 
                                    n
                                    l
                                 
                              
                           ; when 
                              
                                 l
                                 =
                                 k
                                 ,
                              
                            the support of any two different basis functions do not intersect interiorly, so we have 
                              
                                 
                                    b
                                    
                                       4
                                       i
                                       +
                                       j
                                    
                                    k
                                 
                                 
                                    (
                                    
                                       v
                                       g
                                       l
                                    
                                    )
                                 
                                 =
                                 0
                                 ,
                              
                            for g ≠ i, 
                              
                                 j
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 2
                                 ,
                                 3
                                 ,
                              
                           
                           
                              
                                 k
                                 =
                                 0
                                 ,
                                 …
                                 ,
                                 N
                              
                           .

Based on these equations, we evaluate the sum equation (3) at 
                              
                                 v
                                 g
                                 0
                              
                            that is

                              
                                 
                                    
                                       
                                          ∑
                                          
                                             k
                                             =
                                             0
                                          
                                          N
                                       
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             n
                                             k
                                          
                                       
                                       
                                          ∑
                                          
                                             j
                                             =
                                             0
                                          
                                          3
                                       
                                       
                                          c
                                          
                                             4
                                             i
                                             +
                                             j
                                          
                                          k
                                       
                                       
                                          b
                                          
                                             4
                                             i
                                             +
                                             j
                                          
                                          k
                                       
                                       
                                          (
                                          
                                             v
                                             g
                                             0
                                          
                                          )
                                       
                                       =
                                       0
                                       ,
                                    
                                 
                              
                           then we have 
                              
                                 
                                    ∑
                                    
                                       j
                                       =
                                       0
                                    
                                    3
                                 
                                 
                                    c
                                    
                                       4
                                       g
                                       +
                                       j
                                    
                                    0
                                 
                                 
                                    b
                                    
                                       4
                                       g
                                       +
                                       j
                                    
                                    0
                                 
                                 =
                                 0
                              
                           . According to the local linear independence of B-splines, we have 
                              
                                 
                                    c
                                    
                                       4
                                       g
                                       +
                                       j
                                    
                                    0
                                 
                                 =
                                 0
                                 ,
                              
                           
                           
                              
                                 j
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 2
                                 ,
                                 3
                              
                           . Similarly we can prove 
                              
                                 
                                    c
                                    
                                       4
                                       i
                                       +
                                       j
                                    
                                    0
                                 
                                 =
                                 0
                                 ,
                              
                            for all 
                              
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 
                                    n
                                    0
                                 
                                 ,
                              
                           
                           
                              
                                 j
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 2
                                 ,
                                 3
                              
                           .

Now Eq. (3) can be written as

                              
                                 
                                    
                                       
                                          ∑
                                          
                                             k
                                             =
                                             1
                                          
                                          N
                                       
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             n
                                             k
                                          
                                       
                                       
                                          ∑
                                          
                                             j
                                             =
                                             0
                                          
                                          3
                                       
                                       
                                          c
                                          
                                             4
                                             i
                                             +
                                             j
                                          
                                          k
                                       
                                       
                                          b
                                          
                                             4
                                             i
                                             +
                                             j
                                          
                                          k
                                       
                                       
                                          (
                                          s
                                          ,
                                          t
                                          )
                                       
                                       =
                                       0
                                       .
                                    
                                 
                              
                           Substituting the basis vertices 
                              
                                 v
                                 p
                                 1
                              
                            at level 1 into the above equation, we can similarly obtain 
                              
                                 
                                    c
                                    
                                       4
                                       i
                                       +
                                       j
                                    
                                    1
                                 
                                 =
                                 0
                                 ,
                              
                           
                           
                              
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 
                                    n
                                    1
                                 
                                 ,
                              
                           
                           
                              
                                 j
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 2
                                 ,
                                 3
                              
                           . Continuing the above process, finally we have 
                              
                                 
                                    c
                                    
                                       4
                                       i
                                       +
                                       j
                                    
                                    k
                                 
                                 =
                                 0
                                 ,
                              
                           
                           
                              
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 
                                    n
                                    k
                                 
                                 ,
                              
                           
                           
                              
                                 j
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 2
                                 ,
                                 3
                                 ,
                              
                           
                           
                              
                                 k
                                 =
                                 0
                                 ,
                                 …
                                 ,
                                 N
                              
                           . Thus 
                              
                                 
                                    {
                                    
                                       b
                                       i
                                    
                                    }
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    i
                                    =
                                    4
                                    n
                                 
                              
                            are linearly independent.

Since 
                              
                                 
                                    b
                                    i
                                 
                                 ∈
                                 S
                                 
                                    (
                                    3
                                    ,
                                    3
                                    ,
                                    1
                                    ,
                                    1
                                    ,
                                    T
                                    )
                                 
                                 ,
                              
                           
                           
                              
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 4
                                 n
                              
                            and 
                              
                                 dim
                                 
                                 S
                                 (
                                 3
                                 ,
                                 3
                                 ,
                                 1
                                 ,
                                 1
                                 ,
                                 T
                                 )
                                 =
                                 4
                                 n
                                 ,
                              
                           
                           
                              
                                 
                                    {
                                    
                                       b
                                       i
                                    
                                    }
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    i
                                    =
                                    4
                                    n
                                 
                              
                            span the PHT-spline space defined over 
                              T
                           .□

The above constructed basis functions share the important properties with B-splines, such as nonnegativity and compact support. Above all, these basis functions do not decay under refinement of T-meshes.

For the examples shown in Figs. 6 and 7, the new basis functions corresponding to the basis vertices (marked with yellow circles) do not decay anymore as the level increases (see Fig. 10
                     ), and the maximum values of the basis functions remain the same.

In this section, we are going to compare the original bases and the new bases in two aspects: condition number and sparsity of the matrix assembled in isogeometric analysis.

Suppose the model problem is an elliptic partial differential equation defined as

                        
                           (4)
                           
                              
                                 
                                    
                                       
                                          −
                                          Δ
                                          u
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          f
                                          
                                          in
                                          
                                          Ω
                                          ,
                                       
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       =
                                    
                                    
                                       
                                          0
                                          
                                          on
                                          
                                          
                                             Γ
                                             D
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             ∂
                                             u
                                          
                                          
                                             ∂
                                             n
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          h
                                          
                                          on
                                          
                                          
                                             Γ
                                             N
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           Ω
                           ⊆
                           
                              R
                              2
                           
                        
                      is a connected, bounded domain with a Lipschitz-continuous boundary 
                        
                           Γ
                           =
                           
                              Γ
                              D
                           
                           ∪
                           
                              Γ
                              N
                           
                           ,
                        
                     
                     
                        
                           
                              Γ
                              D
                           
                           ∩
                           
                              Γ
                              N
                           
                           =
                           ∅
                        
                     . n is the outward unit normal to ΓN
                     . We assume that ΓD
                      is closed relative to Γ and has a positive length, while f and h are square-integrable on Ω and ΓN
                     , respectively.

We briefly review the framework of isogeometric analysis based on PHT-splines, more details can be found in [19].

Suppose the physical domain Ω is parameterized by a global geometry function 
                           
                              G
                              :
                              
                                 (
                                 s
                                 ,
                                 t
                                 )
                              
                              ∈
                              
                                 Ω
                                 0
                              
                              =
                              
                                 
                                    [
                                    0
                                    ,
                                    1
                                    ]
                                 
                                 2
                              
                              →
                              
                                 (
                                 x
                                 ,
                                 y
                                 )
                              
                              ∈
                              Ω
                              ,
                           
                         defined as

                           
                              
                                 
                                    
                                       G
                                       
                                          (
                                          s
                                          ,
                                          t
                                          )
                                       
                                       =
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          m
                                       
                                       
                                          P
                                          i
                                       
                                       
                                          
                                             
                                                w
                                                i
                                             
                                             
                                                B
                                                i
                                             
                                             
                                                (
                                                s
                                                ,
                                                t
                                                )
                                             
                                          
                                          
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                m
                                             
                                             
                                                w
                                                i
                                             
                                             
                                                B
                                                i
                                             
                                             
                                                (
                                                s
                                                ,
                                                t
                                                )
                                             
                                          
                                       
                                       ,
                                       
                                       
                                       
                                          (
                                          s
                                          ,
                                          t
                                          )
                                       
                                       ∈
                                       
                                          Ω
                                          0
                                       
                                       ,
                                    
                                 
                              
                           
                        where 
                           
                              
                                 P
                                 i
                              
                              ∈
                              
                                 R
                                 2
                              
                              ,
                           
                         
                        Bi
                        (s, t) is a PHT-splines basis function, 
                           
                              
                                 w
                                 i
                              
                              ∈
                              R
                              ,
                              
                                 w
                                 i
                              
                              >
                              0
                           
                         is a weight, m is the number of basis functions and Ω
                        0 is the parameter domain.

The weak form solution of problem equation (4) is to seek 
                           
                              u
                              ∈
                              V
                              =
                              {
                              v
                              ∈
                              
                                 H
                                 1
                              
                              
                                 (
                                 Ω
                                 )
                              
                              :
                              v
                              
                                 |
                                 
                                    Γ
                                    D
                                 
                              
                              =
                              0
                              }
                           
                         such that

                           
                              (5)
                              
                                 
                                    a
                                    (
                                    u
                                    ,
                                    v
                                    )
                                    =
                                    F
                                    (
                                    v
                                    )
                                    ,
                                    
                                    ∀
                                    v
                                    ∈
                                    V
                                 
                              
                           
                        where a is a bilinear form and F(v) is a linear functional defined by

                           
                              
                                 
                                    
                                       
                                          
                                             a
                                             (
                                             u
                                             ,
                                             v
                                             )
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                ∫
                                                Ω
                                             
                                             ∇
                                             u
                                             ·
                                             ∇
                                             v
                                             
                                             d
                                             Ω
                                             ,
                                          
                                       
                                    
                                    
                                       
                                          
                                             F
                                             (
                                             v
                                             )
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                ∫
                                                Ω
                                             
                                             f
                                             v
                                             
                                             d
                                             Ω
                                             +
                                             
                                                ∫
                                                
                                                   Γ
                                                   N
                                                
                                             
                                             h
                                             v
                                             
                                             d
                                             Γ
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Among all the basis functions, suppose Bi
                        (s, t), 
                           
                              i
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              n
                              (
                              n
                              <
                              m
                              )
                           
                         are PHT-spline basis functions which satisfy 
                           
                              
                                 B
                                 i
                              
                              
                                 
                                    
                                       (
                                       s
                                       ,
                                       t
                                       )
                                    
                                    |
                                 
                                 
                                    
                                       G
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       (
                                       
                                          Γ
                                          D
                                       
                                       )
                                    
                                 
                              
                              =
                              0
                           
                        . Then a finite dimensional subspace Vh
                         ⊆ V is defined as

                           
                              
                                 
                                    
                                       
                                          
                                             
                                                V
                                                h
                                             
                                             =
                                             span
                                             
                                                {
                                                
                                                   G
                                                   i
                                                
                                                
                                                   (
                                                   x
                                                   ,
                                                   y
                                                   )
                                                
                                                |
                                             
                                             
                                             
                                                G
                                                i
                                             
                                             
                                                (
                                                x
                                                ,
                                                y
                                                )
                                             
                                             =
                                             
                                                B
                                                i
                                             
                                             ∘
                                             
                                                G
                                                
                                                   −
                                                   1
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                G
                                                i
                                             
                                             
                                                (
                                                x
                                                ,
                                                y
                                                )
                                             
                                             
                                                
                                                   |
                                                   
                                                      Γ
                                                      D
                                                   
                                                
                                                =
                                                0
                                                ,
                                                i
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                n
                                                .
                                                }
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        The isogeometric approximation of the weak form in Eq. (5) is given as:

Find uh
                         ∈ Vh
                        , such that for all vh
                         ∈ Vh
                        
                        
                           
                              (6)
                              
                                 
                                    a
                                    
                                       (
                                       
                                          u
                                          h
                                       
                                       ,
                                       
                                          v
                                          h
                                       
                                       )
                                    
                                    =
                                    F
                                    
                                       (
                                       
                                          v
                                          h
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        The approximate solution uh
                         can be written as

                           
                              (7)
                              
                                 
                                    
                                       u
                                       h
                                    
                                    
                                       (
                                       x
                                       ,
                                       y
                                       )
                                    
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       n
                                    
                                    
                                       c
                                       i
                                    
                                    
                                       G
                                       i
                                    
                                    
                                       (
                                       x
                                       ,
                                       y
                                       )
                                    
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       n
                                    
                                    
                                       c
                                       i
                                    
                                    
                                       B
                                       i
                                    
                                    ∘
                                    
                                       G
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       (
                                       x
                                       ,
                                       y
                                       )
                                    
                                    ,
                                 
                              
                           
                        with unknown coefficients 
                           
                              
                                 c
                                 i
                              
                              ,
                              i
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              n
                           
                        . Thus the weak form solution of problem (5) is converted into solving the following linear system

                           
                              (8)
                              
                                 
                                    L
                                    C
                                    =
                                    R
                                    ,
                                 
                              
                           
                        where L is a n × n matrix with the element 
                           
                              
                                 L
                                 
                                    i
                                    j
                                 
                              
                              =
                              a
                              
                                 (
                                 
                                    G
                                    i
                                 
                                 ,
                                 
                                    G
                                    j
                                 
                                 )
                              
                              ,
                           
                         
                        R is a n-dimensional column vector with the element 
                           
                              R
                              
                                 (
                                 i
                                 )
                              
                              =
                              F
                              
                                 (
                                 
                                    G
                                    i
                                 
                                 )
                              
                              ,
                           
                        
                        
                           
                              i
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              n
                              ,
                           
                         and 
                           
                              C
                              =
                              
                                 
                                    (
                                    
                                       c
                                       1
                                    
                                    ,
                                    …
                                    ,
                                    
                                       c
                                       n
                                    
                                    )
                                 
                                 T
                              
                           
                        .

The posterior error on a cell is

                           
                              
                                 
                                    
                                       η
                                       K
                                       2
                                    
                                    =
                                    
                                       h
                                       K
                                       2
                                    
                                    
                                    
                                       
                                          ∥
                                          Δ
                                          
                                             u
                                             h
                                          
                                          +
                                          f
                                          ∥
                                       
                                       
                                          
                                             L
                                             2
                                          
                                          
                                             (
                                             K
                                             )
                                          
                                       
                                       2
                                    
                                    ,
                                 
                              
                           
                        where hK
                         is the diameter of cell K and 
                           
                              Δ
                              =
                              
                                 
                                    ∂
                                    2
                                 
                                 
                                    ∂
                                    
                                       x
                                       2
                                    
                                 
                              
                              +
                              
                                 
                                    ∂
                                    2
                                 
                                 
                                    ∂
                                    
                                       y
                                       2
                                    
                                 
                              
                           
                        . By the chain rule, we have

                           
                              (9)
                              
                                 
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   
                                                      ∂
                                                      2
                                                   
                                                   
                                                      ∂
                                                      
                                                         x
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      ∂
                                                      2
                                                   
                                                   
                                                      ∂
                                                      x
                                                      ∂
                                                      y
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      ∂
                                                      2
                                                   
                                                   
                                                      ∂
                                                      
                                                         y
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       )
                                    
                                    
                                    =
                                    
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               ∂
                                                               x
                                                            
                                                            
                                                               ∂
                                                               s
                                                            
                                                         
                                                         )
                                                      
                                                      2
                                                   
                                                
                                                
                                                   
                                                      2
                                                      
                                                         
                                                            ∂
                                                            x
                                                         
                                                         
                                                            ∂
                                                            s
                                                         
                                                      
                                                      
                                                         
                                                            ∂
                                                            y
                                                         
                                                         
                                                            ∂
                                                            s
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               ∂
                                                               y
                                                            
                                                            
                                                               ∂
                                                               s
                                                            
                                                         
                                                         )
                                                      
                                                      2
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                            x
                                                         
                                                         
                                                            ∂
                                                            t
                                                         
                                                      
                                                      
                                                         
                                                            ∂
                                                            x
                                                         
                                                         
                                                            ∂
                                                            s
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                            x
                                                         
                                                         
                                                            ∂
                                                            s
                                                         
                                                      
                                                      
                                                         
                                                            ∂
                                                            y
                                                         
                                                         
                                                            ∂
                                                            t
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            ∂
                                                            x
                                                         
                                                         
                                                            ∂
                                                            t
                                                         
                                                      
                                                      
                                                         
                                                            ∂
                                                            y
                                                         
                                                         
                                                            ∂
                                                            s
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                            y
                                                         
                                                         
                                                            ∂
                                                            s
                                                         
                                                      
                                                      
                                                         
                                                            ∂
                                                            y
                                                         
                                                         
                                                            ∂
                                                            t
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               ∂
                                                               x
                                                            
                                                            
                                                               ∂
                                                               t
                                                            
                                                         
                                                         )
                                                      
                                                      2
                                                   
                                                
                                                
                                                   
                                                      2
                                                      
                                                         
                                                            ∂
                                                            x
                                                         
                                                         
                                                            ∂
                                                            t
                                                         
                                                      
                                                      
                                                         
                                                            ∂
                                                            y
                                                         
                                                         
                                                            ∂
                                                            t
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               ∂
                                                               y
                                                            
                                                            
                                                               ∂
                                                               t
                                                            
                                                         
                                                         )
                                                      
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                          )
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    ·
                                    F
                                    ,
                                 
                              
                           
                        
                        
                           
                              
                                 
                                    F
                                    
                                    =
                                    
                                    
                                       [
                                       
                                       
                                          (
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         ∂
                                                         2
                                                      
                                                      
                                                         ∂
                                                         
                                                            s
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         ∂
                                                         2
                                                      
                                                      
                                                         ∂
                                                         s
                                                         ∂
                                                         t
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         ∂
                                                         2
                                                      
                                                      
                                                         ∂
                                                         
                                                            t
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                          )
                                       
                                       
                                       −
                                       
                                       
                                          (
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                            2
                                                         
                                                         x
                                                      
                                                      
                                                         ∂
                                                         
                                                            s
                                                            2
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                            2
                                                         
                                                         y
                                                      
                                                      
                                                         ∂
                                                         
                                                            s
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                            2
                                                         
                                                         x
                                                      
                                                      
                                                         ∂
                                                         s
                                                         ∂
                                                         t
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                            2
                                                         
                                                         y
                                                      
                                                      
                                                         ∂
                                                         s
                                                         ∂
                                                         t
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                            2
                                                         
                                                         x
                                                      
                                                      
                                                         ∂
                                                         
                                                            t
                                                            2
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                            2
                                                         
                                                         y
                                                      
                                                      
                                                         ∂
                                                         
                                                            t
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                          )
                                       
                                       
                                       
                                          (
                                          
                                          
                                             
                                                
                                                   
                                                      ∂
                                                      
                                                         ∂
                                                         x
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∂
                                                      
                                                         ∂
                                                         y
                                                      
                                                   
                                                
                                             
                                          
                                          
                                          )
                                       
                                       
                                       ]
                                    
                                    ,
                                 
                              
                           
                        and

                           
                              
                                 
                                    
                                       (
                                       
                                       
                                          
                                             
                                                
                                                   ∂
                                                   
                                                      ∂
                                                      x
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∂
                                                   
                                                      ∂
                                                      y
                                                   
                                                
                                             
                                          
                                       
                                       
                                       )
                                    
                                    
                                    =
                                    
                                    
                                       
                                          (
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         ∂
                                                         x
                                                      
                                                      
                                                         ∂
                                                         s
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∂
                                                         y
                                                      
                                                      
                                                         ∂
                                                         s
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         ∂
                                                         x
                                                      
                                                      
                                                         ∂
                                                         t
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∂
                                                         y
                                                      
                                                      
                                                         ∂
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                          
                                          )
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       (
                                       
                                       
                                          
                                             
                                                
                                                   ∂
                                                   
                                                      ∂
                                                      s
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∂
                                                   
                                                      ∂
                                                      t
                                                   
                                                
                                             
                                          
                                       
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        
                     

The posterior error on the hierarchical T-mesh 
                           T
                         is the sum of the posterior errors on all the cells, that is,

                           
                              
                                 
                                    
                                       η
                                       T
                                    
                                    =
                                    
                                       
                                          (
                                          
                                             ∑
                                             
                                                K
                                                ∈
                                                T
                                             
                                          
                                          
                                             η
                                             K
                                             2
                                          
                                          )
                                       
                                       
                                          1
                                          /
                                          2
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

In the following, we provide several numerical examples to illustrate the numerical performance of the new basis functions, together with comparisons with that of the original basis functions.
                        
                     

For convenience, we use DOF as the abbreviation for degree of freedom. Let L
                        org and L
                        new be the matrices in Eq. (8) assembled by the original bases and the new bases respectively. For each example, we compare the condition number and sparsity of L
                        org and L
                        new.

                           Example 1
                           The right-hand side term is defined as

                                 
                                    
                                       
                                          f
                                          
                                             (
                                             r
                                             )
                                          
                                          =
                                          0.01
                                          
                                             (
                                             
                                                
                                                   
                                                      (
                                                      1
                                                      −
                                                      g
                                                      
                                                         
                                                            (
                                                            r
                                                            )
                                                         
                                                         2
                                                      
                                                      )
                                                   
                                                   
                                                      r
                                                      2
                                                   
                                                
                                                
                                                   0.03
                                                   
                                                      r
                                                      3
                                                   
                                                
                                             
                                             −
                                             2
                                             
                                                
                                                   g
                                                   
                                                      (
                                                      r
                                                      )
                                                   
                                                   
                                                      (
                                                      1
                                                      −
                                                      g
                                                      
                                                         
                                                            (
                                                            r
                                                            )
                                                         
                                                         2
                                                      
                                                      )
                                                   
                                                   
                                                      r
                                                      2
                                                   
                                                
                                                
                                                   0
                                                   .
                                                   
                                                      03
                                                      2
                                                   
                                                   
                                                      r
                                                      2
                                                   
                                                
                                             
                                             )
                                          
                                          ,
                                       
                                    
                                 
                              where 
                                 
                                    r
                                    =
                                    
                                       
                                          
                                             
                                                (
                                                x
                                                −
                                                0.5
                                                )
                                             
                                             2
                                          
                                          +
                                          
                                             
                                                (
                                                y
                                                −
                                                0.5
                                                )
                                             
                                             2
                                          
                                       
                                    
                                 
                               and 
                                 
                                    g
                                    (
                                    r
                                    )
                                    =
                                    tanh
                                    (
                                    (
                                    0.25
                                    +
                                    r
                                    )
                                    /
                                    0.03
                                    )
                                 
                              . We solve this problem on two different physical domains as shown in Fig. 11.

We start from a 4 × 2 tensor-product mesh. The numerical solutions and refined meshes on the physical domains Ω
                        1 and Ω
                        2 solved by new bases are shown in Figs. 12 and 13
                         respectively, where the rapid change of the solutions is captured adaptively and effectively. Tables 2
                         and 3
                         show the posterior errors and condition numbers of the stiffness matrices solved by the original basis functions and the new basis functions. From the statistical data in Tables 2 and 3, the condition number of L
                        new is far less than that of L
                        org at each level.


                        Figs. 14
                         and 15
                         show the structure of L
                        org and L
                        new at the forth level together with their reordered versions obtained by the reverse Cuthill–McKee algorithm, where nz represents the number of nonzero elements of L
                        new (L
                        org). The reverse Cuthill–McKee algorithm is used to compute a permutation of a matrix such that the matrix tends to have its nonzero elements closer to the diagonal. It can be seen that L
                        new possesses more nonzero elements and a wider bandwidth than L
                        org.

                           Example 2
                           The domain Ω is chosen as a circle centered at the original with radius 
                                 
                                    r
                                    =
                                    0.5
                                 
                              . The exact solution is unknown and

                                 
                                    
                                       
                                          f
                                          
                                             (
                                             x
                                             ,
                                             y
                                             )
                                          
                                          =
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         4
                                                         (
                                                         x
                                                         −
                                                         2
                                                         y
                                                         +
                                                         3
                                                         x
                                                         y
                                                         −
                                                         
                                                            x
                                                            2
                                                         
                                                         −
                                                         
                                                            y
                                                            2
                                                         
                                                         )
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         x
                                                         >
                                                         y
                                                         ,
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         −
                                                         4
                                                         (
                                                         y
                                                         −
                                                         2
                                                         x
                                                         +
                                                         3
                                                         x
                                                         y
                                                         −
                                                         
                                                            x
                                                            2
                                                         
                                                         −
                                                         
                                                            y
                                                            2
                                                         
                                                         )
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         x
                                                         ≤
                                                         y
                                                         .
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

The initial mesh is a 1 × 1 tensor product mesh. Fig. 16
                         shows the refinement process of the T-mesh in geometric space and the numerical solution solved by the new basis functions. Table 4
                         shows the posterior errors and the condition numbers of the stiffness matrices by the original basis functions and the new basis functions. From the statistical data in Table 4, the condition number of L assembled by the new basis functions is much less than that of the matrix assembled by the original basis functions. Table 4 indicates that the new basis functions reduce the condition number of the stiffness matrix dramatically.

We also compare the sparsity of L
                        org and L
                        new. Fig. 17
                         shows the structure of L
                        org and L
                        new at the last level together with their reordered version obtained by the reverse Cuthill–McKee algorithm. From the comparison in Fig. 17, L
                        new possesses more nonzero elements and a wider bandwidth than L
                        org, which means the sparsity of L
                        new is not good as that of L
                        org.

@&#CONCLUSIONS AND FUTURE WORK@&#

In this paper, we propose a new basis construction for PHT-splines to address the decay problem of the original basis functions of PHT-splines on certain kinds of hierarchical T-meshes. The key idea is to construct four tensor product B-splines as the basis functions for each basis vertex. Thus the new basis functions actually are a collection of linearly independent B-splines, and hence they inherit some good properties of B-splines such as nonnegativity and local support except for the partition of unity. The most important property is that the new basis functions do not decay on any hierarchical T-meshes. We provide several numerical examples to demonstrate that the new basis functions can greatly decrease the condition numbers of the stiffness matrices assembled in isogeometric analysis.

We have to point out that the new basis functions are not guaranteed to vanish at other basis vertices as the original basis functions do. In addition, the support of a new basis function is a little bigger than that of the corresponding original basis function associated with the same basis vertex. In this sense, the new basis functions overcome the decay problem at the cost of bigger support and no partition of unity. Fortunately, this later disadvantages do not influence the performance of the new basis functions, while have a significant improvement on the condition numbers of the stiffness matrices.
                  

The basis construction method in this paper is valid for general T-meshes assuming each basis vertex has a support mesh (such a mesh is called a supportable mesh). Unfortunately, not every T-mesh is supportable. As illustrated in Fig. 18(a), the support mesh of v
                     1 does not exist. But it is possible to make a local modification to the T-mesh to fix the problem. Fig. 18(b) is the T-mesh after extending v
                     2 by one bay in Fig. 18(a), and now the T-mesh after modification is supportable. Finally, we lack a proof for the fact that all the functions associated with all the basis vertices are linearly independent for a supportable T-mesh. These problems resort a future work.

@&#ACKNOWLEDGEMENTS@&#

The authors thank the reviewers for providing useful comments and suggestion. The work is supported by 973 Program 2011CB302400, the NSF of China 
                  No. 11031007.

@&#REFERENCES@&#

