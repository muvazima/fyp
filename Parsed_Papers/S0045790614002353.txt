@&#MAIN-TITLE@&#Dynamic security management for real-time embedded applications in industrial networks

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Introducing security-critical applications based on embedded control server systems for industrial networks.


                        
                        
                           
                           Establishing the security-aware task, security overhead and risk models for aperiodic real-time applications.


                        
                        
                           
                           Combining the soft real-time and security requirements into a unified framework.


                        
                        
                           
                           Deploying proportional controllers to achieve satisfied fine-grained control.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Real-time embedded system

Security management

Risk

Feedback control

Scheduling

@&#ABSTRACT@&#


               
               
                  Widely deployed real-time embedded systems can improve the performance of industrial applications, but these systems also face the critical challenge of providing high quality security in an unpredictable network environment. We measure the time and energy consumptions of commonly used cryptographic algorithms on a real embedded platform and introduce a method to quantify the security risk of real-time applications. We propose a Dynamic Security Risk Management (DSRM) mechanism to manage the aperiodic real-time tasks for networked industrial applications. Inspired by the feedback design philosophy, DSRM is designed as a two-level control mechanism. The upper-level component makes efforts to admit or reject the arrival tasks and assigns the reasonable security level for each admitted task. With three proportional feedback controllers at the lower level, the security level of each ready task can be adjusted adaptively according to the dynamic environments. Simulation results show the superiority of the proposed mechanism.
               
            

@&#INTRODUCTION@&#

Mission-critical industrial systems, composed of interconnected embedded systems, have to function correctly and meet dependable constraints. Typical examples of mission-critical industrial systems are power grid systems [1] and automation control systems [2]. Although digital systems and communication among them have been designed to be very reliable, networked industrial systems are still facing serious security challenges [3]. Industrial systems are generally real-time systems and are increasingly deployed in open environments where operating conditions are dynamic and security threatened. Energy efficiency is also a challenge because the supply of energy is generally inconvenient for many embedded systems. Quick energy consumption or early exhaustion of battery may lead to failure of critical task, which may result in degeneration of security quality. For industrial applications, there is a strong need to meet multiple constraints including real-time, secure and energy efficiency simultaneously. This situation is even worse when the workloads cannot be estimated in advance. Therefore, it is an imperative and significant task to design a suitable management mechanism for security-critical industrial applications operating in dynamic and resource-limited environments.

Adaptive scheduling is essential towards high performance in embedded real-time systems. Incipient real-time scheduling algorithms are designed for static and priority based scheduling situations [4]. Unfortunately, these works are based on the assumption of knowing most information of applications such as the worst case execution time of each task. These mechanisms are designed in an open-loop mode and cannot be adjusted according to unpredicted situations, which will result in poor performance under dynamic working conditions. This situation gets more severer when considering security protection. For example, security-critical embedded control servers generally run in network environments where the potential threats cannot be modeled accurately. To guarantee the system performance in such unpredicted environments, several feedback control-based adaptive QoS scheduling algorithms have been developed [5]. Recently, feedback control methods have been applied in many applications, such as thermal control [6], fault-tolerance management [7] and dynamic voltage scaling [8]. To improve the security quality of real-time systems, several researchers have proposed some effective algorithms and models [9–12]. However, none of these researches considers dynamic security management for real-time embedded applications in industrial networks.

Given these motivations, based on the research already published by the same authors in [13], we are interested in the design of adaptive security risk management mechanisms for the uniprocessor real-time embedded systems running in security-critical industrial networks. Taking features of aperiodic real-time user requests into account, we propose an adaptive and security risk-aware real-time scheduling mechanism. Administrators just need to appoint the desired system performance, and then the proposed design automatically monitors the system status and chooses the most appropriate cryptography algorithms to achieve satisfactory overall performance. In addition, there should be an advanced mechanism to manage tasks, i.e. admitting or rejecting some user requests. Inspired by the automatic control related work in storage system [14], a two-level control scheme is employed in this paper. The upper-level part mainly admits or rejects the newly arrival requests and then initializes the appropriate security protection. At the lower level, our proposal can change the deployed cryptography algorithms to guarantee the real-time and security performance dynamically.

The primary contributions of this paper are:
                        
                           •
                           Introducing security-critical applications based on embedded control server systems for industrial networks.

Establishing the security-aware task model, security overhead model, and security risk model for aperiodic real-time applications.

Combining the soft real-time and security requirements in a unified framework and deploying proportional controllers to achieve satisfied fine-grained control.

The rest of this paper is organized as follows. Section 2 reviews mostly related work. The typical industry network applications and security protection demands are discussed in Section 3. Section 4 presents the system model. The design problem and a motivating example are given in Section 5 and then a dynamic security management mechanism is proposed in Section 6. In Section 7, we conduct simulations and analyze the experimental results. Finally, conclusions are drawn in Section 8.

@&#RELATED WORK@&#

To improve the security protection of mission-critical embedded systems, the research on algorithms and models of security management has become a hot topic. Main security issues are identified and several effective solutions are proposed for real-time peer-to-peer communication [15]. Based on a trust job model, Ref. [12] focused on scheduling algorithms for independent jobs over grid computing environments and proposed a space–time genetic strategy. Combining group-level security model with classic real-time scheduling method, Lin et al. designed two security-aware scheduling schemes based on EDF (Earliest Deadline First) policy [16]. Jiang et al. proposed a hardware/software co-design technique to satisfy the confidentiality requirements of automobile systems with communication security constraints [17]. A dynamic security-aware packet scheduling mechanism for wireless networks was designed in [18], which can obtain high quality of security of messages and satisfy the requirement of soft real-time. Gebotys et al. combined the security performance and energy-efficiency then proposed a static low-power security optimization algorithm [11]. Karakehayov designed a static hierarchical communication model with the focus on routing protocols under the real-time, security and energy requirements [19]. Though these researches are meaningful and instructional to improve the security, they are static and cannot be adaptive to unpredicted security threats. Due to the lack of feedback control loop, these works have no adaptability and are not competent for dynamic industrial real-time embedded systems.

To address the issues of static scheduling algorithms, lots of dynamic and adaptive QoS (Quality of Service) scheduling policies have been proposed. A general survey of feedback performance control in software systems was proposed in [20]. Following the in-depth research of feedback control theory, dynamic scheduling mechanisms have been used in many other applications like dynamic voltage scaling [6,8] and fault-tolerant reliable real-time systems [7]. With the rapid development of feedback control theory, advanced controllers haven been designed. Lu et al. deployed an MPC (Model Predictive Control) controller in distributed real-time system, which was designed to control the utilization of end-to-end tasks [21]. However, due to not taking security factors into consideration, these researches cannot be directly used for security-critical industrial systems.

Industrial systems have become interconnected, e.g., the Supervision Control And Data Acquisition (SCADA) system and the Distributed Control (DC) system. A complete industrial network consists of at least four parts, i.e. the Corporation Network, the Demilitarized Zone, the Process Network, and the Control Network [3]. The typical architecture of an industrial network is shown in Fig. 1
                        .

The interconnection among these digital components accelerates the information interaction, while also increases the potential malicious threats. Traditional coping strategies rely on the firewall technology to isolate each network or system. However, the growing demands of ubiquitous computing and resource sharing challenge those approaches. Hence, it is necessary to design new mechanisms to directly protect the sensitive data. In this research, we emphasize on the security of control networks and make efforts to design Dynamic Security Risk Management mechanisms for the PLC (Programmable Logic Controller) or CNC (Computerized Numerical Control) components.

PLC and CNC work as control servers to manage the data obtained from local sensors or other peer unit and communicate with upper-level servers like SCADA server and Data server. As shown in Fig. 1 for example, PLC/CNC control servers are uniprocessor real-time embedded systems and the applications characteristics on them can be summarized as follows.
                           
                              •
                              User requests are supposed to be responded and served, but in most situations, details of these requests cannot be accurately predicted before their arrival.

Most user requests have their own real-time requirement, which means it is impossible that all requests can be responded. Some of them must be rejected if they fail to meet the real-time requirements before being executed.

The industrial network is not completely secure [3]. In order to reduce the system risk, sensitive data must be encrypted by a cryptography algorithm.

In this paper, we focus on the security risk management for embedded real-time systems running in security-critical industrial networks like the PLC/CNC control servers.

In order to protect the sensitive data or other identities, three security services or functions can be deployed: confidentiality, integrity, and authentication. Corresponding to these three security services, researchers have developed many algorithms which can be divided into three categories, i.e., symmetric, asymmetric, and hash algorithms [14]. But for embedded or industry control systems, the way to deploy all of these algorithms is very complicated, because the energy supply is limited and the computational capacity is weak, while the real-time requirement is still stringent. Taking these factors into consideration, in this paper we consider only confidentiality to protect the sensitive data under the energy and real-time constraints. However, our design mechanism is flexible, and can be utilized for other security protections.

In this section, we will establish the system models of our work.

Confidentiality is one critical requirement in information security, which demands that the secrecy of data expected by communication parties should be maintained. In most situations, symmetric cryptography algorithms are deployed to guarantee the confidentiality. Although several researchers have measured and analyzed energy costs of symmetric algorithms [22], their designs do not suit for embedded systems since they focused on specific protocols and ignored the timing factor. In this paper, we measure the time and energy consumptions of symmetric encryption algorithms on a real embedded platform. Measurements are carried out with the real-time operation system, 
                           
                              μ
                           
                        COS-II, and an open-source cryptographic library, Cryptlib [23]. The measurement instrument is PXI 1024Q associated with an NI 6221 data acquisition card, and the target embedded device is an S3C2440 ARM board with 64MB SDRAM. The execution times of each cryptography algorithm under different data size are listed in Table 1
                        .

We analyze the impact of plaintext size on the algorithms execution time and energy costs. Some researchers have established a linear relation between the time cost and the number of encrypting rounds [17]; while the empirical results obtained from our testing system, which are listed in Table 1, show that there also exists a linear relationship between the time cost and the size of the plaintext. Given DS as the size of plaintext, the execution time of cryptography algorithm of the i-th task, denoted as 
                           
                              
                                 
                                    TC
                                 
                                 
                                    i
                                 
                              
                           
                        , can be described as
                           
                              (1)
                              
                                 
                                    
                                       TC
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       TC
                                    
                                    
                                       i
                                    
                                    
                                       0
                                    
                                 
                                 +
                                 
                                    
                                       TC
                                    
                                    
                                       i
                                    
                                    
                                       1
                                    
                                 
                                 ×
                                 DS
                              
                           
                        where 
                           
                              
                                 
                                    TC
                                 
                                 
                                    i
                                 
                                 
                                    0
                                 
                              
                           
                         and 
                           
                              
                                 
                                    TC
                                 
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                           
                         are two constants depending on the chosen algorithm. Taking RC4 (Rivest Cipher 4) symmetric algorithm as an example, measurement results show that 
                           
                              
                                 
                                    TC
                                 
                                 
                                    RC
                                    4
                                 
                                 
                                    0
                                 
                              
                              =
                              2.24
                              ,
                              
                                 
                                    TC
                                 
                                 
                                    RC
                                    4
                                 
                                 
                                    1
                                 
                              
                              =
                              0.04
                           
                        .

In order to analyze the system security performance, it is necessary to find a method to describe the security strength of each cryptography algorithm. It is still an open and challenging problem for accurate quantification of security strength. For the sake of simplification, we adopt an effective model reported by [18,24] saying that if the execution speed of an algorithm is faster than that of others’, its security strength is the lowest, and the relationship between speed and security strength can be linear. Therefore, the measured execution time can be used to denote the security strength of each algorithm.

Specifically, we calculate the average execution time of each algorithm with plaintext size altering between 16B and 4KB, and the results are listed as the 
                           
                              
                                 
                                    AT
                                 
                                 
                                    i
                                 
                              
                           
                         (ms) column in Table 2
                        . The security strength of the weakest (fastest) cryptography algorithm, RC4, is set to 1.00. The strength of the rest algorithms can be calculated as
                           
                              (2)
                              
                                 
                                    
                                       SS
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       AT
                                    
                                    
                                       i
                                    
                                 
                                 /
                                 5.80
                                 ,
                                 
                                 1
                                 ⩽
                                 i
                                 ⩽
                                 7
                              
                           
                        The security strengths of all these algorithms are listed as the 
                           
                              
                                 
                                    SS
                                 
                                 
                                    i
                                 
                              
                           
                         column in Table 2. Given the relative security strength of each algorithm, we can easily obtain the execution time for any amount of plaintext. For example, if the data size of plaintext is DS, the time cost of AES (Advanced Encryption Standard) can be approximately calculated as
                           
                              (3)
                              
                                 
                                    
                                       TC
                                    
                                    
                                       AES
                                    
                                 
                                 =
                                 
                                    
                                       SS
                                    
                                    
                                       AES
                                    
                                 
                                 ×
                                 (
                                 
                                    
                                       TC
                                    
                                    
                                       RC
                                       4
                                    
                                    
                                       0
                                    
                                 
                                 +
                                 
                                    
                                       TC
                                    
                                    
                                       RC
                                       4
                                    
                                    
                                       1
                                    
                                 
                                 ×
                                 DS
                                 )
                              
                           
                        or
                           
                              
                                 
                                    
                                       TC
                                    
                                    
                                       AES
                                    
                                 
                                 =
                                 
                                    
                                       SS
                                    
                                    
                                       AES
                                    
                                 
                                 ×
                                 (
                                 2.24
                                 +
                                 0.004
                                 ×
                                 DS
                                 )
                              
                           
                        
                     

We also measure the energy consumption of these cryptography algorithms, and the results are shown in Fig. 2
                        . Similar to the analysis on the execution speed, the energy consumption of the i-th algorithm, 
                           
                              
                                 
                                    E
                                 
                                 
                                    i
                                 
                              
                           
                        , can also be linearised with the following function.
                           
                              (4)
                              
                                 
                                    
                                       E
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       EC
                                    
                                    
                                       i
                                    
                                    
                                       0
                                    
                                 
                                 +
                                 
                                    
                                       EC
                                    
                                    
                                       i
                                    
                                    
                                       1
                                    
                                 
                                 ×
                                 DS
                              
                           
                        where 
                           
                              
                                 
                                    EC
                                 
                                 
                                    i
                                 
                                 
                                    0
                                 
                              
                           
                         and 
                           
                              
                                 
                                    EC
                                 
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                           
                         are also two constants.

Based on our measured data, we make the further analysis of each cryptography algorithm by combining the energy and speed performance. We take the Energy/Time (E/T) metric to present the energy cost per millisecond of execution time. In the procedure of calculating this metric of each algorithm, we find an interesting phenomenon that on average, the E/T trade-off values of different algorithms are all close to 0.32μJ/ms (see in Fig. 3
                        ). In other words, no matter which algorithm it is (e.g., RC4, AES or any other), it consumes approximately 0.32μJ energy per millisecond. This phenomenon is expected because the ratio between energy cost and execution time is essentially the power consumption of the embedded processor in the active mode (μJ/ms=mW). Therefore, the demand of high energy efficiency naturally overlaps with the real-time constraint in this case: the optimization for guaranteeing the real-time feature of the system also limits the energy consumption. Hence, we ignore the energy factor in the rest of this paper.

Comparing with encryption operation, establishing a key consumes more energy and time. However, key initialization is much less frequent than encryption and decryption, thus it does not dominate the overall energy profile. Therefore, we assume that the required key has been established and distributed to authenticated clients during the system initialization.

In industrial applications, data requests for embedded devices can be generally recognized as aperiodic tasks. For an uniprocessor embedded server, we consider a set of N preemptive and independent tasks to be scheduled and executed. Each task 
                           
                              
                                 
                                    T
                                 
                                 
                                    i
                                 
                              
                           
                         is characterized by a four-parameter vector 
                           
                              
                                 
                                    T
                                 
                                 
                                    i
                                 
                              
                              =
                              (
                              
                                 
                                    a
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    s
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    e
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    d
                                 
                                 
                                    i
                                 
                              
                              )
                           
                        . 
                           
                              
                                 
                                    a
                                 
                                 
                                    i
                                 
                              
                           
                         is the arrival time of the task; 
                           
                              
                                 
                                    s
                                 
                                 
                                    i
                                 
                              
                           
                         is the start time of task execution; 
                           
                              
                                 
                                    e
                                 
                                 
                                    i
                                 
                              
                           
                         is the actual execution duration of this task and 
                           
                              
                                 
                                    d
                                 
                                 
                                    i
                                 
                              
                           
                         is the deadline. In most situations, a task may not be responded immediately upon its arrival until higher priority tasks have been completed. Hence, there usually exists a gap between 
                           
                              
                                 
                                    a
                                 
                                 
                                    i
                                 
                              
                           
                         and 
                           
                              
                                 
                                    s
                                 
                                 
                                    i
                                 
                              
                           
                         as depicted in Fig. 4
                        .

In this paper, we focus on the security improvement of real-time embedded systems, such as the PLCs in industrial network. The execution time of each task can be divided into two parts including efforts for security protection, denoted as 
                           
                              
                                 
                                    e
                                 
                                 
                                    i
                                 
                                 
                                    s
                                 
                              
                           
                        , and other operations without security concerns, expressed as 
                           
                              
                                 
                                    e
                                 
                                 
                                    i
                                 
                                 
                                    o
                                 
                              
                           
                        . For 
                           
                              
                                 
                                    e
                                 
                                 
                                    i
                                 
                                 
                                    s
                                 
                              
                           
                        , we introduce two security related parameters, the Data Size 
                           
                              
                                 
                                    DS
                                 
                                 
                                    i
                                 
                              
                           
                         and Security Level 
                           
                              
                                 
                                    SL
                                 
                                 
                                    i
                                 
                              
                           
                         of the i-th task. The 
                           
                              
                                 
                                    DS
                                 
                                 
                                    i
                                 
                              
                           
                         represents how many sensitive data needs to be protected; the 
                           
                              
                                 
                                    SL
                                 
                                 
                                    i
                                 
                              
                           
                         identifies the security strength of the task, which equals the security strength of chosen cryptography algorithm. If the security strength of a chosen algorithm is 
                           
                              
                                 
                                    SS
                                 
                                 
                                    c
                                 
                              
                           
                        , the security level of that task, 
                           
                              
                                 
                                    SL
                                 
                                 
                                    i
                                 
                              
                           
                        , equals 
                           
                              
                                 
                                    SS
                                 
                                 
                                    c
                                 
                              
                           
                        . According to this assumption, the maximum security level of tasks is set as 
                           
                              
                                 
                                    SL
                                 
                                 
                                    max
                                 
                              
                              =
                              3.40
                           
                        , and the minimum security level is set as 
                           
                              
                                 
                                    SL
                                 
                                 
                                    min
                                 
                              
                              =
                              1.00
                           
                        . As discussed in Section 3, the execution durations of cryptography algorithms are related with their security strength. Thus, the execution time for security protection can be calculated as
                           
                              (5)
                              
                                 
                                    
                                       e
                                    
                                    
                                       i
                                    
                                    
                                       s
                                    
                                 
                                 =
                                 
                                    
                                       SL
                                    
                                    
                                       i
                                    
                                 
                                 ×
                                 (
                                 
                                    
                                       TC
                                    
                                    
                                       RC
                                       4
                                    
                                    
                                       0
                                    
                                 
                                 +
                                 
                                    
                                       TC
                                    
                                    
                                       RC
                                       4
                                    
                                    
                                       1
                                    
                                 
                                 ×
                                 
                                    
                                       DS
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                           
                        
                     

Then, the total execution time of the i-th task can be describe as
                           
                              (6)
                              
                                 
                                    
                                       e
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       e
                                    
                                    
                                       i
                                    
                                    
                                       o
                                    
                                 
                                 +
                                 
                                    
                                       e
                                    
                                    
                                       i
                                    
                                    
                                       s
                                    
                                 
                                 =
                                 
                                    
                                       e
                                    
                                    
                                       i
                                    
                                    
                                       o
                                    
                                 
                                 +
                                 
                                    
                                       SL
                                    
                                    
                                       i
                                    
                                 
                                 ×
                                 (
                                 
                                    
                                       TC
                                    
                                    
                                       RC
                                       4
                                    
                                    
                                       0
                                    
                                 
                                 +
                                 
                                    
                                       TC
                                    
                                    
                                       RC
                                       4
                                    
                                    
                                       1
                                    
                                 
                                 ×
                                 
                                    
                                       DS
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                           
                        
                     

Comparing with 
                           
                              
                                 
                                    e
                                 
                                 
                                    i
                                 
                                 
                                    s
                                 
                              
                              ,
                              
                                 
                                    e
                                 
                                 
                                    i
                                 
                                 
                                    o
                                 
                              
                           
                         represents the non-security execution part of the i-th task. In a dynamic system, these parameters are hard to predict, which constrains the use of traditional off-line security management policies and motivates us to design an adaptive security management mechanism.

It is necessary to introduce a reasonable metric to quantify the security failure probability of security-critical tasks. The security risk ratio of the i-th task, 
                           
                              
                                 
                                    R
                                 
                                 
                                    i
                                 
                              
                           
                        , is defined as the probability of security protection failure under hostile attacks. According to the job failure model in [12], the security risk ratio can be calculated as
                           
                              (7)
                              
                                 
                                    
                                       R
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                   -
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         λ
                                                         (
                                                         
                                                            
                                                               SL
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         -
                                                         
                                                            
                                                               SL
                                                            
                                                            
                                                               max
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                   ,
                                                
                                                
                                                   1
                                                   ⩽
                                                   
                                                      
                                                         SL
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   <
                                                   
                                                      
                                                         SL
                                                      
                                                      
                                                         max
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   0
                                                   ,
                                                
                                                
                                                   
                                                      
                                                         SL
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ⩾
                                                   
                                                      
                                                         SL
                                                      
                                                      
                                                         max
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              λ
                           
                         is the risk related co-efficient, and 
                           
                              
                                 
                                    SL
                                 
                                 
                                    max
                                 
                              
                              =
                              3.40
                           
                         in this paper according to Table 2.

As implied in Eq. (7), if the assigned security level is greater or equal to the demanded security, we assume no failure will occur when facing attacks. Inversely, the task will fail probably, and larger security demand gap will leads to higher probability of security failure. In this paper we will use this proposed metric to quantify the quality of security-aware tasks, and to assess the system performance.

The goal of this paper is to protect the security-sensitive tasks of aperiodic real-time applications in industrial networks. Each task has explicit soft real-time requirement, and also security guarantee requirement. Moreover, for embedded control server working in industrial networks, it is impossible to serve all the possible requests. Requests or arrival tasks should be rejected in case that they cannot meet their specific real-time constraints.

According to above properties, we use following three metrics to describe the system performance.
                           
                              •
                              
                                 
                                    
                                       
                                          
                                             M
                                          
                                          
                                             1
                                          
                                          
                                             k
                                          
                                       
                                    
                                 : deadline miss ratio at the k-th sampling window.


                                 
                                    
                                       
                                          
                                             M
                                          
                                          
                                             2
                                          
                                          
                                             k
                                          
                                       
                                    
                                 : risk ratio at the k-th sampling window.


                                 
                                    
                                       
                                          
                                             M
                                          
                                          
                                             3
                                          
                                          
                                             k
                                          
                                       
                                    
                                 : rejection ratio at the k-th sampling window. This metric is defined as the ratio of the number of rejected tasks and the number of total arrival tasks within a sampling window.

The overall system performance at the k-th sampling window can be captured as
                           
                              (8)
                              
                                 P
                                 (
                                 k
                                 )
                                 =
                                 
                                    
                                       Σ
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       α
                                    
                                    
                                       i
                                    
                                 
                                 ×
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 k
                                 )
                                 -
                                 
                                    
                                       M
                                    
                                    
                                       i
                                    
                                    
                                       S
                                    
                                 
                                 )
                              
                           
                        where 
                           
                              
                                 
                                    α
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    α
                                 
                                 
                                    2
                                 
                              
                           
                         and 
                           
                              
                                 
                                    α
                                 
                                 
                                    3
                                 
                              
                           
                         are constants to describe the weights of those metrics. 
                           
                              
                                 
                                    M
                                 
                                 
                                    1
                                 
                                 
                                    S
                                 
                              
                              ,
                              
                                 
                                    M
                                 
                                 
                                    2
                                 
                                 
                                    S
                                 
                              
                           
                         and 
                           
                              
                                 
                                    M
                                 
                                 
                                    3
                                 
                                 
                                    S
                                 
                              
                           
                         are the desired values of 
                           
                              
                                 
                                    M
                                 
                                 
                                    1
                                 
                              
                              (
                              k
                              )
                              ,
                              
                                 
                                    M
                                 
                                 
                                    2
                                 
                              
                              (
                              k
                              )
                           
                         and 
                           
                              
                                 
                                    M
                                 
                                 
                                    3
                                 
                              
                              (
                              k
                              )
                           
                        , which can be set by administrators and modified in different application scenarios. The overall system performance 
                           
                              P
                              (
                              k
                              )
                           
                         is the weighted sum of these three deviations, thus our system problem is to find the most appropriate cryptography algorithms to minimize it at each sampling window.

In this section, we use an example to describe the feasibility of security protection, and then analyze the advantages and disadvantages of different policies. The task set 
                           
                              (
                              
                                 
                                    T
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    T
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    T
                                 
                                 
                                    3
                                 
                              
                              ,
                              
                                 
                                    T
                                 
                                 
                                    4
                                 
                              
                              ,
                              
                                 
                                    T
                                 
                                 
                                    5
                                 
                              
                              )
                           
                         we utilized is shown in Table 3
                        , and the scheduling example of these five tasks is depicted in Fig. 5
                        . In this example, different task has different 
                           
                              
                                 
                                    e
                                 
                                 
                                    i
                                 
                                 
                                    o
                                 
                              
                           
                         value which cannot be predicted accurately before its execution.
                           
                              •
                              Case 1: No security protection. In this case, we do not encrypt any sensitive data of all the tasks, seeing Fig. 5(a). As a result, all tasks can be completed before their deadlines, but face the highest security risk due to no security protection.

Case 2: Static off-line security protection. Based on the amount of redundant computation capacity, the cryptography algorithms are assigned statically to protect the sensitive data. In Fig. 5(b) and (c), we statistically deploy the RC4 and RC5 (Rivest Cipher 5) to protect the sensitive data, respectively. Task 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             2
                                          
                                       
                                    
                                  misses its deadline in Fig. 5(b), while two tasks, 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             2
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             5
                                          
                                       
                                    
                                 , experience time violation in Fig. 5(c). We set 
                                    
                                       λ
                                       =
                                       1
                                    
                                  (in Eq. (7)), 
                                    
                                       
                                          
                                             α
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       
                                          
                                             α
                                          
                                          
                                             2
                                          
                                       
                                       =
                                       
                                          
                                             α
                                          
                                          
                                             3
                                          
                                       
                                       =
                                       1
                                    
                                  and 
                                    
                                       
                                          
                                             M
                                          
                                          
                                             1
                                          
                                          
                                             S
                                          
                                       
                                       =
                                       
                                          
                                             M
                                          
                                          
                                             2
                                          
                                          
                                             S
                                          
                                       
                                       =
                                       
                                          
                                             M
                                          
                                          
                                             3
                                          
                                          
                                             S
                                          
                                       
                                       =
                                       0
                                    
                                 . Then the system performance of the strategy in Fig. 5(b) is 
                                    
                                       P
                                       =
                                       4.75
                                    
                                 , and the performance of the strategy in Fig. 5(c) is 
                                    
                                       P
                                       =
                                       4.17
                                    
                                 .

Case 3: Dynamic on-line security protection. This case considers another security protection strategy, which deploys the cryptography algorithms dynamically. Specifically, although 
                                    
                                       
                                          
                                             e
                                          
                                          
                                             i
                                          
                                          
                                             o
                                          
                                       
                                    
                                  of the current task cannot be predicted at a prior, it can be estimated by leveraging results from previous tasks. Such estimation can be effective especially in a continuous system. Fig. 5(d) illustrates a simplified example for this design philosophy, in which 
                                    
                                       
                                          
                                             e
                                          
                                          
                                             i
                                          
                                          
                                             o
                                          
                                       
                                    
                                  is estimated to be 
                                    
                                       
                                          
                                             e
                                          
                                          
                                             i
                                             -
                                             1
                                          
                                          
                                             o
                                          
                                       
                                    
                                  , and the choice of cryptography algorithm depends on this estimation. In this strategy, 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             4
                                          
                                       
                                    
                                  will miss its deadline, but the security level of 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             2
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             4
                                          
                                       
                                    
                                  become 3.07 and 3.40, respectively. If 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             1
                                          
                                       
                                    
                                  is protected by RC4, the system performance 
                                    
                                       P
                                       =
                                       3.32
                                    
                                 , which is lower than 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             RC
                                             4
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             RC
                                             5
                                          
                                       
                                    
                                 . However, the disadvantage of dynamic strategy is also shown in this example. If 
                                    
                                       
                                          
                                             e
                                          
                                          
                                             i
                                          
                                          
                                             o
                                          
                                       
                                    
                                  changes dramatically, for example from 
                                    
                                       
                                          
                                             e
                                          
                                          
                                             3
                                          
                                          
                                             o
                                          
                                       
                                       =
                                       20
                                    
                                  to 
                                    
                                       
                                          
                                             e
                                          
                                          
                                             4
                                          
                                          
                                             o
                                          
                                       
                                       =
                                       30
                                    
                                  and then back to 
                                    
                                       
                                          
                                             e
                                          
                                          
                                             5
                                          
                                          
                                             o
                                          
                                       
                                       =
                                       20
                                    
                                 , the estimation may lose its efficiency, and lead to deadline violation. Hence, it is necessary to analyze the stability of the system which will be discussed in Section 6.5.

In this section, we discuss the proposed DSRM (Dynamic Security Risk Management) mechanism. This mechanism is based on feedback control theory, in which a two-level feedback control structure can help overcome the shortage of traditional dynamic strategies.

According to the formulated system problem, the DSRM is designed to serve mostly aperiodic tasks, and to provide the strongest security protection as well as guarantee the soft real-time requirement of the whole system. At the same time, the DSRM should be aware of the run-time status and dynamically deploy different cryptography algorithms to protect the system. However, the arrival time, the execution duration, and the deadline of each request are unknown and unpredictable. Considering the complicated requirement, DSRM employs a two-level feedback scheduling framework to address the problem, which is shown in Fig. 6
                        .

Five components are deployed in DSRM, where the Waiting Queue and Admission Control are at the upper level and the Runtime Scheduler and Executor are at the lower level. At the upper level, Admission Control decides whether the newly arrival request can be served, and at the lower level, the Runtime Scheduler dynamically selects the most appropriate cryptography algorithm in each sample window. The Performance Monitor locates at the intersection of both levels, which takes in charge of monitoring the run-time status. Run-time status is one of the basic parameters for decision making in both Runtime Scheduler and Admission Control.

To guarantee the soft real-time requirements of most tasks, the system should refuse to serve tasks which cannot meet their deadlines, and this function is achieved by Admission Control. When a task or user request arrives, the first step of Admission Control is to find out the task’s order in the Waiting Queue. DSRM employs a priority-based queuing strategy, in which a task with more urgent deadline has a higher priority and is inserted in the front of Waiting Queue. Without loss of generality, a newly arrived and admitted task gets inserted to the i-th place in the Waiting Queue. DSRM can refuse to serve any new task if it fails to meet its own real-time requirement even with the lowest security level 
                           
                              
                                 
                                    SL
                                 
                                 
                                    min
                                 
                              
                           
                        , i.e.,
                           
                              (9)
                              
                                 
                                    
                                       s
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 
                                    
                                       e
                                    
                                    
                                       i
                                    
                                    
                                       o
                                    
                                 
                                 +
                                 
                                    
                                       SL
                                    
                                    
                                       min
                                    
                                 
                                 ×
                                 (
                                 
                                    
                                       TC
                                    
                                    
                                       RC
                                       4
                                    
                                    
                                       0
                                    
                                 
                                 +
                                 
                                    
                                       TC
                                    
                                    
                                       RC
                                       4
                                    
                                    
                                       1
                                    
                                 
                                 ×
                                 
                                    
                                       DS
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 ⩽
                                 
                                    
                                       d
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        
                     

This is a coarse-grained control, and may lead to the situation that some tasks cannot be served. However, this stringent constraint can help to prevent the system from the DDOS attack, which is a common threat in industrial networks. The start time of a newly arrival task, 
                           
                              
                                 
                                    S
                                 
                                 
                                    i
                                 
                              
                           
                        , is set to be the sum of execution durations of all higher priority tasks and the remaining time required for the current task, namely,
                           
                              (10)
                              
                                 
                                    
                                       s
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 r
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          i
                                          -
                                          1
                                       
                                    
                                 
                                 
                                    
                                       e
                                    
                                    
                                       j
                                    
                                 
                                 +
                                 
                                    
                                       a
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        where r represents the remaining execution time of current running task, and 
                           
                              
                                 
                                    e
                                 
                                 
                                    j
                                 
                              
                           
                         is the execution time of the j-th task in the queue with higher priority than that of the current task.

To reduce the system overhead at run time, the Admission Control should assign a reasonable initial security level for each task. The initial security level of task 
                           
                              
                                 
                                    T
                                 
                                 
                                    i
                                 
                              
                           
                         should be as high as possible while without missing the deadline. Combining with Eq. (10), the constraint in Eq. (9) can be transformed as
                           
                              (11)
                              
                                 
                                    
                                       e
                                    
                                    
                                       i
                                    
                                 
                                 ⩽
                                 
                                    
                                       d
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 r
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          i
                                          -
                                          1
                                       
                                    
                                 
                                 
                                    
                                       e
                                    
                                    
                                       j
                                    
                                 
                              
                           
                        
                     

According to Eq. (6), the task execution time is a function of the security level and the data size, thus Eq. (11) can be expanded as
                           
                              (12)
                              
                                 
                                    
                                       SL
                                    
                                    
                                       i
                                    
                                 
                                 ×
                                 (
                                 
                                    
                                       TC
                                    
                                    
                                       RC
                                       4
                                    
                                    
                                       0
                                    
                                 
                                 +
                                 
                                    
                                       TC
                                    
                                    
                                       RC
                                       4
                                    
                                    
                                       1
                                    
                                 
                                 ×
                                 
                                    
                                       DS
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       e
                                    
                                    
                                       i
                                    
                                    
                                       o
                                    
                                 
                                 ⩽
                                 
                                    
                                       d
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 r
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          i
                                          -
                                          1
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                SL
                                             
                                             
                                                j
                                             
                                          
                                          ×
                                          
                                             
                                                
                                                   
                                                      
                                                         TC
                                                      
                                                      
                                                         RC
                                                         4
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         TC
                                                      
                                                      
                                                         RC
                                                         4
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ×
                                                   
                                                      
                                                         DS
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                e
                                             
                                             
                                                j
                                             
                                             
                                                o
                                             
                                          
                                       
                                    
                                 
                              
                           
                        Hence, initialization of the security level is a process of finding the highest level under the constraint in Eq. (12).

While the final security level of task 
                           
                              
                                 
                                    T
                                 
                                 
                                    j
                                 
                              
                           
                         is determined by the lower-level on-line scheduling, this means that the value of 
                           
                              
                                 
                                    SL
                                 
                                 
                                    j
                                 
                              
                           
                         might be changed before being executed. So we need to do some prediction. Based on the philosophy of feedback control, the system status in the previous window can be used to predict the status of the current window, namely,
                           
                              
                                 
                                    
                                       SL
                                    
                                    
                                       j
                                    
                                 
                                 ≃
                                 
                                    
                                       SL
                                    
                                    
                                       ‾
                                    
                                 
                                 ,
                                 
                                 ∀
                                 1
                                 ⩽
                                 j
                                 ⩽
                                 i
                                 -
                                 1
                              
                           
                        where 
                           
                              
                                 
                                    SL
                                 
                                 
                                    ‾
                                 
                              
                           
                         represents the average security level in the last sampling window. Hence, the constraint in Eq. (12) can be simplified as follows
                           
                              (13)
                              
                                 
                                    
                                       SL
                                    
                                    
                                       i
                                    
                                 
                                 ×
                                 
                                    
                                       
                                          
                                             
                                                TC
                                             
                                             
                                                RC
                                                4
                                             
                                             
                                                0
                                             
                                          
                                          +
                                          
                                             
                                                TC
                                             
                                             
                                                RC
                                                4
                                             
                                             
                                                1
                                             
                                          
                                          ×
                                          
                                             
                                                DS
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       e
                                    
                                    
                                       i
                                    
                                    
                                       o
                                    
                                 
                                 ⩽
                                 
                                    
                                       d
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 r
                                 -
                                 
                                    
                                       SL
                                    
                                    
                                       ‾
                                    
                                 
                                 ×
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          i
                                          -
                                          1
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                TC
                                             
                                             
                                                RC
                                                4
                                             
                                             
                                                0
                                             
                                          
                                          +
                                          
                                             
                                                TC
                                             
                                             
                                                RC
                                                4
                                             
                                             
                                                1
                                             
                                          
                                          ×
                                          
                                             
                                                DS
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                 
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          i
                                          -
                                          1
                                       
                                    
                                 
                                 
                                    
                                       e
                                    
                                    
                                       j
                                    
                                    
                                       o
                                    
                                 
                              
                           
                        which can be rewritten as
                           
                              (14)
                              
                                 
                                    
                                       SL
                                    
                                    
                                       i
                                    
                                 
                                 ⩽
                                 
                                    
                                       
                                          
                                             d
                                          
                                          
                                             i
                                          
                                       
                                       -
                                       r
                                       -
                                       
                                          
                                             SL
                                          
                                          
                                             ‾
                                          
                                       
                                       ×
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             i
                                             -
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             TC
                                          
                                          
                                             RC
                                             4
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       
                                          
                                             TC
                                          
                                          
                                             RC
                                             4
                                          
                                          
                                             1
                                          
                                       
                                       ×
                                       
                                          
                                             DS
                                          
                                          
                                             j
                                          
                                       
                                       )
                                       -
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             i
                                             -
                                             1
                                          
                                       
                                       
                                          
                                             e
                                          
                                          
                                             j
                                          
                                          
                                             o
                                          
                                       
                                    
                                    
                                       
                                          
                                             TC
                                          
                                          
                                             RC
                                             4
                                          
                                          
                                             0
                                          
                                       
                                       +
                                       
                                          
                                             TC
                                          
                                          
                                             RC
                                             4
                                          
                                          
                                             1
                                          
                                       
                                       ×
                                       
                                          
                                             DS
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 -
                                 
                                    
                                       e
                                    
                                    
                                       i
                                    
                                    
                                       o
                                    
                                 
                              
                           
                        The inequality in Eq. (14) gives the upper limit of the security level to satisfy the real-time requirement of task 
                           
                              
                                 
                                    T
                                 
                                 
                                    i
                                 
                              
                           
                        . Note that it is a predicted constraint and cannot ensure the real-time feature strictly. Nevertheless, under this constraint the newly arrived task can meet its real-time requirement with high possibility. Actually, for the system running in unpredictable environments, few methods can guarantee that all the aperiodic tasks meet their real-time requirements.

Upon a new task arriving and being inserted into the Waiting Queue, the start time of lower priority tasks must be changed. We introduce the Slack Ratio (SR) to describe the slack time of the k-th task as
                           
                              
                                 
                                    
                                       SR
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 1
                                 -
                                 (
                                 
                                    
                                       d
                                    
                                    
                                       k
                                    
                                 
                                 -
                                 
                                    
                                       s
                                    
                                    
                                       k
                                    
                                 
                                 -
                                 
                                    
                                       e
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 /
                                 
                                    
                                       d
                                    
                                    
                                       k
                                    
                                 
                              
                           
                        which can be expanded as
                           
                              (15)
                              
                                 
                                    
                                       SR
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 1
                                 -
                                 
                                    
                                       
                                          
                                             
                                                d
                                             
                                             
                                                k
                                             
                                          
                                          -
                                          r
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                
                                                   k
                                                   -
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                e
                                             
                                             
                                                j
                                             
                                          
                                          -
                                          
                                             
                                                e
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                 
                                 /
                                 
                                    
                                       d
                                    
                                    
                                       k
                                    
                                 
                              
                           
                        If the k-th task has a lower priority and is indexed after the newly arrived task (i.e. the i-th task) in the queue, the execution time of all tasks with lower priorities can be calculated as follows:
                           
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          k
                                          -
                                          1
                                       
                                    
                                 
                                 
                                    
                                       e
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            j
                                                            =
                                                            1
                                                         
                                                         
                                                            k
                                                            -
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         j
                                                      
                                                      
                                                         o
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         SL
                                                      
                                                      
                                                         ‾
                                                      
                                                   
                                                   ×
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  j
                                                                  =
                                                                  1
                                                               
                                                               
                                                                  i
                                                                  -
                                                                  1
                                                               
                                                            
                                                            
                                                               
                                                                  e
                                                               
                                                               
                                                                  j
                                                               
                                                               
                                                                  
                                                                     
                                                                        s
                                                                     
                                                                     
                                                                        ′
                                                                     
                                                                  
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  
                                                                     ∑
                                                                  
                                                                  
                                                                     j
                                                                     =
                                                                     i
                                                                     +
                                                                     1
                                                                  
                                                                  
                                                                     k
                                                                     -
                                                                     1
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  e
                                                               
                                                               
                                                                  j
                                                               
                                                               
                                                                  s
                                                                  ′
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         SL
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ×
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         
                                                            
                                                               s
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   k
                                                   >
                                                   i
                                                   +
                                                   1
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            j
                                                            =
                                                            1
                                                         
                                                         
                                                            k
                                                            -
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         j
                                                      
                                                      
                                                         o
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         SL
                                                      
                                                      
                                                         ‾
                                                      
                                                   
                                                   ×
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  j
                                                                  =
                                                                  1
                                                               
                                                               
                                                                  i
                                                                  -
                                                                  1
                                                               
                                                            
                                                            
                                                               
                                                                  e
                                                               
                                                               
                                                                  j
                                                               
                                                               
                                                                  
                                                                     
                                                                        s
                                                                     
                                                                     
                                                                        ′
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         SL
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ×
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         
                                                            
                                                               s
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   k
                                                   =
                                                   i
                                                   +
                                                   1
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            j
                                                            =
                                                            1
                                                         
                                                         
                                                            k
                                                            -
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         j
                                                      
                                                      
                                                         o
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         SL
                                                      
                                                      
                                                         ‾
                                                      
                                                   
                                                   ×
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  j
                                                                  =
                                                                  1
                                                               
                                                               
                                                                  i
                                                                  -
                                                                  1
                                                               
                                                            
                                                            
                                                               
                                                                  e
                                                               
                                                               
                                                                  j
                                                               
                                                               
                                                                  
                                                                     
                                                                        s
                                                                     
                                                                     
                                                                        ′
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   k
                                                   =
                                                   i
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    e
                                 
                                 
                                    j
                                 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    TC
                                 
                                 
                                    RC
                                    4
                                 
                                 
                                    0
                                 
                              
                              +
                              
                                 
                                    TC
                                 
                                 
                                    RC
                                    4
                                 
                                 
                                    1
                                 
                              
                              ×
                              
                                 
                                    DS
                                 
                                 
                                    j
                                 
                              
                           
                        .


                        
                           
                              
                                 
                                    SR
                                 
                                 
                                    k
                                 
                              
                           
                         and 
                           
                              
                                 
                                    SL
                                 
                                 
                                    i
                                 
                              
                           
                         have a negative correlation: when 
                           
                              
                                 
                                    SL
                                 
                                 
                                    i
                                 
                              
                           
                         increases, 
                           
                              
                                 
                                    SR
                                 
                                 
                                    k
                                 
                              
                           
                         gets decreased. In the case of 
                           
                              
                                 
                                    SR
                                 
                                 
                                    k
                                 
                              
                              <
                              0
                           
                        , the deadline gets missed. To prevent this unexpected situation, 
                           
                              
                                 
                                    SR
                                 
                                 
                                    k
                                 
                              
                           
                         is limited to be larger than a threshold 
                           
                              
                                 
                                    SR
                                 
                                 
                                    S
                                 
                              
                           
                         as
                           
                              (16)
                              
                                 
                                    
                                       SR
                                    
                                    
                                       k
                                    
                                 
                                 ⩾
                                 
                                    
                                       SR
                                    
                                    
                                       S
                                    
                                 
                                 ,
                                 
                                 ∀
                                 k
                                 ⩾
                                 i
                              
                           
                        The above Eqs. (14) and (16) set the upper limits of the initial security level.

Given the newly arrived task 
                           
                              
                                 
                                    T
                                 
                                 
                                    i
                                 
                              
                           
                        , the task set TSet composed of all tasks with lower priorities and the desired slack 
                           
                              
                                 
                                    SR
                                 
                                 
                                    S
                                 
                              
                           
                        , Algorithm 1 illustrates the procedure of task admission and security level initialization. In line 1, we assign the lowest security level to the newly arrived task and then decide whether it can satisfy the admission requirement in lines 2–4. Then, we try to increase the security level step-by-step. From lines 6 to 23, we set the security level to be (
                           
                              
                                 
                                    T
                                 
                                 
                                    i
                                 
                              
                              .
                              SL
                              -
                              Δ
                              SL
                           
                        ) if the security level of the i-th task (
                           
                              
                                 
                                    T
                                 
                                 
                                    i
                                 
                              
                              .
                              SL
                           
                        ) does not meet the constraint in Eq. (14) or not all tasks with lower priorities satisfy the constraint in Eq. (16). Note that (
                           
                              
                                 
                                    T
                                 
                                 
                                    i
                                 
                              
                              .
                              SL
                              +
                              Δ
                              SL
                           
                        ) or (
                           
                              
                                 
                                    T
                                 
                                 
                                    i
                                 
                              
                              .
                              SL
                              -
                              Δ
                              SL
                           
                        ) means to increase or decrease the security level to the nearest one, for example, increasing from 2.01 to 2.69, or decreasing from 3.06 to 2.87. The if – then – else statements in line 9 and 18 guarantee that the admitted task will be protected at least by the weakest cryptography algorithm in any possible situation.
                           Algorithm 1
                           Task admission and security initialization
                                 
                                    
                                       
                                       
                                          
                                             1: 
                                                   
                                                      
                                                         
                                                            T
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ·
                                                      SL
                                                      =
                                                      
                                                         
                                                            SL
                                                         
                                                         
                                                            min
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             2: if 
                                                
                                                   
                                                      
                                                         
                                                            T
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ·
                                                      s
                                                      +
                                                      
                                                         
                                                            T
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ·
                                                      e
                                                      <
                                                      
                                                         
                                                            T
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ·
                                                      d
                                                   
                                                 
                                                then
                                             
                                          
                                          
                                             3: reject the newly task 
                                                   
                                                      
                                                         
                                                            T
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             4: end if
                                             
                                          
                                          
                                             5: while 
                                                
                                                   
                                                      
                                                         
                                                            T
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ·
                                                      SL
                                                      ⩽
                                                      
                                                         
                                                            SL
                                                         
                                                         
                                                            max
                                                         
                                                      
                                                   
                                                 
                                                do
                                             
                                          
                                          
                                             6: 
                                                if 
                                                
                                                   
                                                      
                                                         
                                                            T
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ·
                                                      e
                                                      <
                                                      
                                                         
                                                            T
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ·
                                                      d
                                                      -
                                                      
                                                         
                                                            T
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ·
                                                      s
                                                   
                                                 
                                                then
                                             
                                          
                                          
                                             7: 
                                                for 
                                                
                                                   
                                                      ∀
                                                      
                                                         
                                                            T
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      ∈
                                                      TSet
                                                   
                                                 
                                                do
                                             
                                          
                                          
                                             8: 
                                                
                                                if 
                                                
                                                   
                                                      
                                                         
                                                            SR
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      <
                                                      
                                                         
                                                            SR
                                                         
                                                         
                                                            S
                                                         
                                                      
                                                   
                                                 
                                                then
                                             
                                          
                                          
                                             9: 
                                                
                                                if 
                                                
                                                   
                                                      
                                                         
                                                            T
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ·
                                                      SL
                                                      =
                                                      =
                                                      
                                                         
                                                            SL
                                                         
                                                         
                                                            min
                                                         
                                                      
                                                   
                                                 
                                                then
                                             
                                          
                                          
                                             10: 
                                                
                                                return 
                                                   
                                                      
                                                         
                                                            T
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ·
                                                      SL
                                                   
                                                
                                             
                                          
                                          
                                             11: 
                                                
                                                else
                                             
                                          
                                          
                                             12: 
                                                
                                                return 
                                                   
                                                      (
                                                      
                                                         
                                                            T
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ·
                                                      SL
                                                      -
                                                      Δ
                                                      SL
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             13: 
                                                
                                                end if
                                             
                                          
                                          
                                             14: 
                                                
                                                end if
                                             
                                          
                                          
                                             15: 
                                                end for
                                             
                                          
                                          
                                             16: 
                                                
                                                
                                                   
                                                      
                                                         
                                                            T
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ·
                                                      SL
                                                      =
                                                      
                                                         
                                                            T
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ·
                                                      SL
                                                      +
                                                      Δ
                                                      SL
                                                   
                                                
                                             
                                          
                                          
                                             17: 
                                                else
                                             
                                          
                                          
                                             18: 
                                                
                                                if 
                                                
                                                   
                                                      
                                                         
                                                            T
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ·
                                                      SL
                                                      =
                                                      =
                                                      
                                                         
                                                            SL
                                                         
                                                         
                                                            min
                                                         
                                                      
                                                   
                                                 
                                                then
                                             
                                          
                                          
                                             19: 
                                                return 
                                                   
                                                      
                                                         
                                                            T
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ·
                                                      SL
                                                   
                                                
                                             
                                          
                                          
                                             20: 
                                                
                                                else
                                             
                                          
                                          
                                             21: 
                                                return 
                                                   
                                                      (
                                                      
                                                         
                                                            T
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ·
                                                      SL
                                                      -
                                                      Δ
                                                      SL
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             22: 
                                                end if
                                             
                                          
                                          
                                             23: 
                                                end if
                                             
                                          
                                          
                                             24: end while
                                             
                                          
                                          
                                             25: return 
                                                   
                                                      
                                                         
                                                            SL
                                                         
                                                         
                                                            max
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

The main purpose of the lower-level feedback control is to dynamically adjust the security level to minimize the performance function in Eq. (8). The metrics for the feedback controllers are 
                           
                              
                                 
                                    M
                                 
                                 
                                    1
                                 
                              
                              (
                              k
                              )
                              ,
                              
                                 
                                    M
                                 
                                 
                                    2
                                 
                              
                              (
                              k
                              )
                           
                         and 
                           
                              
                                 
                                    M
                                 
                                 
                                    3
                                 
                              
                              (
                              k
                              )
                           
                        , which are defined in Section 4. Correspondingly, the desired values, or set points of these metrics are 
                           
                              
                                 
                                    M
                                 
                                 
                                    1
                                 
                                 
                                    S
                                 
                              
                              ,
                              
                                 
                                    M
                                 
                                 
                                    2
                                 
                                 
                                    S
                                 
                              
                           
                         and 
                           
                              
                                 
                                    M
                                 
                                 
                                    3
                                 
                                 
                                    S
                                 
                              
                           
                        , respectively.

At each sampling window, the component System Performance collects samples of these metrics and feed them back to three independent controllers: Miss Controller, Risk Controller and Rejection Controller, respectively. These controllers calculate a control input 
                           
                              e
                              (
                              k
                              )
                           
                         based on the collected system status. Depending on the control input, the Actuator changes the security level 
                           
                              SL
                              (
                              k
                              )
                           
                         at the k-th sample window. This low-level feedback control architecture is shown in Fig. 7
                        .

We have chosen the proportional controller at the low-level feedback control due to proportional controller has been widely utilized in related areas [5]. The 
                           
                              e
                              (
                              k
                              )
                           
                         can be calculated as
                           
                              (17)
                              
                                 e
                                 (
                                 k
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          3
                                       
                                    
                                 
                                 
                                    
                                       k
                                    
                                    
                                       i
                                    
                                 
                                 ×
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 k
                                 )
                                 -
                                 
                                    
                                       M
                                    
                                    
                                       i
                                    
                                    
                                       S
                                    
                                 
                                 )
                              
                           
                        where 
                           
                              
                                 
                                    k
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    k
                                 
                                 
                                    2
                                 
                              
                           
                        , and 
                           
                              
                                 
                                    k
                                 
                                 
                                    3
                                 
                              
                           
                         are three tunable parameters, corresponding to 
                           
                              
                                 
                                    α
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    α
                                 
                                 
                                    2
                                 
                              
                           
                         and 
                           
                              
                                 
                                    α
                                 
                                 
                                    3
                                 
                              
                           
                         in Eq. (8), respectively. For the convenience of analysis, a matrix is introduced to describe the Eq. (17) as follows.
                           
                              (18)
                              
                                 e
                                 (
                                 k
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ×
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   (
                                                   k
                                                   )
                                                   -
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         S
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   (
                                                   k
                                                   )
                                                   -
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         2
                                                      
                                                      
                                                         S
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   (
                                                   k
                                                   )
                                                   -
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         3
                                                      
                                                      
                                                         S
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

In the next step, we discuss details of the feedback loop. The Actuator changes the level 
                           
                              SL
                              (
                              k
                              +
                              1
                              )
                           
                         according to the 
                           
                              e
                              (
                              k
                              )
                           
                         at each sampling window with
                           
                              (19)
                              
                                 SL
                                 (
                                 k
                                 +
                                 1
                                 )
                                 =
                                 SL
                                 (
                                 k
                                 )
                                 +
                                 
                                    
                                       G
                                    
                                    
                                       ′
                                    
                                 
                                 ×
                                 e
                                 (
                                 k
                                 )
                              
                           
                        where 
                           
                              
                                 
                                    G
                                 
                                 
                                    ′
                                 
                              
                           
                         is called the security-level ratio. Although this 
                           
                              
                                 
                                    G
                                 
                                 
                                    ′
                                 
                              
                           
                         is changeable at different sampling windows, it can be set as a constant value because if an automatic system is proven stable, the change cannot affect the final status according to the control theory.

In following, we use the miss ratio control as an example to show how the security level can be used to control the deadline miss ratio. In [7], authors have proven that the relationship between CPU utilization and 
                           
                              
                                 
                                    M
                                 
                                 
                                    1
                                 
                              
                              (
                              k
                              )
                           
                         can be linearized by taking the derivative at the vicinity of the set point 
                           
                              
                                 
                                    M
                                 
                                 
                                    1
                                 
                                 
                                    S
                                 
                              
                           
                        . Based on our definition, the tasks security level is proportional to the execution times as well as the CPU utilization. Therefore, the relationship between 
                           
                              
                                 
                                    M
                                 
                                 
                                    1
                                 
                              
                              (
                              k
                              )
                           
                         and 
                           
                              SL
                              (
                              k
                              )
                           
                         can be described as 
                           
                              
                                 
                                    G
                                 
                                 
                                    ″
                                 
                              
                              =
                              
                                 
                                    dM
                                 
                                 
                                    1
                                 
                              
                              (
                              k
                              )
                              /
                              dSL
                              (
                              k
                              )
                           
                         and it can be transformed as
                           
                              (20)
                              
                                 
                                    
                                       M
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 k
                                 )
                                 =
                                 
                                    
                                       M
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 k
                                 -
                                 1
                                 )
                                 +
                                 
                                    
                                       G
                                    
                                    
                                       ″
                                    
                                 
                                 ·
                                 (
                                 SL
                                 (
                                 k
                                 )
                                 -
                                 SL
                                 (
                                 k
                                 -
                                 1
                                 )
                                 )
                                 =
                                 
                                    
                                       M
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 k
                                 -
                                 1
                                 )
                                 +
                                 
                                    
                                       G
                                    
                                    
                                       1
                                    
                                 
                                 ·
                                 e
                                 (
                                 k
                                 -
                                 1
                                 )
                              
                           
                        where 
                           
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    G
                                 
                                 
                                    ′
                                 
                              
                              ×
                              
                                 
                                    G
                                 
                                 
                                    ″
                                 
                              
                           
                        . Similarly, we can use the same method to deal with 
                           
                              
                                 
                                    M
                                 
                                 
                                    2
                                 
                              
                              (
                              k
                              )
                           
                         and 
                           
                              
                                 
                                    M
                                 
                                 
                                    3
                                 
                              
                              (
                              k
                              )
                           
                        , and we finally obtain the state equation in the lower-level feedback loop as
                           
                              (21)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   (
                                                   k
                                                   )
                                                   =
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   (
                                                   k
                                                   -
                                                   1
                                                   )
                                                   +
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ·
                                                   e
                                                   (
                                                   k
                                                   -
                                                   1
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   (
                                                   k
                                                   )
                                                   =
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   (
                                                   k
                                                   -
                                                   1
                                                   )
                                                   +
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ·
                                                   e
                                                   (
                                                   k
                                                   -
                                                   1
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   (
                                                   k
                                                   )
                                                   =
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   (
                                                   k
                                                   -
                                                   1
                                                   )
                                                   +
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   ·
                                                   e
                                                   (
                                                   k
                                                   -
                                                   1
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    G
                                 
                                 
                                    2
                                 
                              
                           
                         and 
                           
                              
                                 
                                    G
                                 
                                 
                                    3
                                 
                              
                           
                         are parameters functioning the same way as 
                           
                              
                                 
                                    G
                                 
                                 
                                    1
                                 
                              
                           
                         and correspond to 
                           
                              
                                 
                                    M
                                 
                                 
                                    1
                                 
                              
                              (
                              k
                              )
                           
                         and 
                           
                              
                                 
                                    M
                                 
                                 
                                    2
                                 
                              
                              (
                              k
                              )
                           
                         respectively.


                        Stability Control: according to the definition of a linear time invariant discrete system, we set the standard state equation of our feedback control system as the following equation:
                           
                              (22)
                              
                                 M
                                 (
                                 k
                                 )
                                 =
                                 A
                                 ·
                                 M
                                 (
                                 k
                                 -
                                 1
                                 )
                                 +
                                 C
                              
                           
                        where 
                           
                              M
                              (
                              k
                              )
                              =
                              
                                 
                                    [
                                    
                                       
                                          M
                                       
                                       
                                          1
                                       
                                    
                                    (
                                    k
                                    )
                                    ,
                                    
                                       
                                          M
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    k
                                    )
                                    ,
                                    
                                       
                                          M
                                       
                                       
                                          3
                                       
                                    
                                    (
                                    k
                                    )
                                    ]
                                 
                                 
                                    T
                                 
                              
                           
                         and 
                           
                              C
                           
                         is a 
                           
                              3
                              ×
                              1
                           
                         matrix which has no relationship with 
                           
                              M
                              (
                              k
                              -
                              1
                              )
                           
                         . Given the standard state equation (Eq. (22)), its stability condition is that the eigenvalues of matrix 
                           
                              A
                           
                         locates inside the unit circle in the complex space. Based on Eq. (21), 
                           
                              G
                              =
                              
                                 
                                    [
                                    
                                       
                                          G
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          G
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          G
                                       
                                       
                                          3
                                       
                                    
                                    ]
                                 
                                 
                                    T
                                 
                              
                           
                        , we can have
                           
                              (23)
                              
                                 M
                                 (
                                 k
                                 )
                                 =
                                 M
                                 (
                                 k
                                 -
                                 1
                                 )
                                 +
                                 G
                                 ·
                                 e
                                 (
                                 k
                                 -
                                 1
                                 )
                              
                           
                        
                     

According to Eqs. (17) and (18), (23) can be transformed into
                           
                              (24)
                              
                                 M
                                 (
                                 k
                                 )
                                 =
                                 M
                                 (
                                 k
                                 -
                                 1
                                 )
                                 +
                                 G
                                 ·
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          3
                                       
                                    
                                 
                                 
                                    
                                       k
                                    
                                    
                                       i
                                    
                                 
                                 ×
                                 
                                    
                                       
                                          
                                             
                                                M
                                             
                                             
                                                i
                                             
                                          
                                          (
                                          k
                                          -
                                          1
                                          )
                                          -
                                          
                                             
                                                M
                                             
                                             
                                                i
                                             
                                             
                                                S
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                   -
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   1
                                                   -
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                                
                                                   1
                                                   -
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ·
                                 M
                                 (
                                 k
                                 -
                                 1
                                 )
                                 +
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ·
                                 
                                    
                                       [
                                       
                                          
                                             M
                                          
                                          
                                             1
                                          
                                          
                                             S
                                          
                                       
                                       ,
                                       
                                          
                                             M
                                          
                                          
                                             2
                                          
                                          
                                             S
                                          
                                       
                                       ,
                                       
                                          
                                             M
                                          
                                          
                                             3
                                          
                                          
                                             S
                                          
                                       
                                       ]
                                    
                                    
                                       T
                                    
                                 
                              
                           
                        
                     

Compared with Eq. (22), we obtain the detail of matrix 
                           
                              A
                           
                         from Eq. (24) as,
                           
                              
                                 A
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                   -
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   1
                                                   -
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                                
                                                   1
                                                   -
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   
                                                      
                                                         G
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Thus, we can get the condition to guarantee stability of our method: the eigenvalue of matrix 
                           
                              A
                           
                         locates inside the unit circle in the complex space. Note that this stabilization analysis is theoretical. Since the candidate security levels are discrete and limited, the stability cannot be guaranteed strictly. In addition, it is only applicable for soft real-time systems because it cannot provide zero deadline miss ratio.

In this paper, we conduct a time-driven simulator implemented with C# for experiments. For the convenience of feedback control, we consider the execution of 100 continuous tasks as one sampling window. In all the simulations, we set the number of sampling windows to be 90, thus the total number of aperiodic tasks generated in each simulation is 9000. We set 
                           
                              λ
                              =
                              1
                           
                        in Eq. (7), 
                           
                              
                                 
                                    α
                                 
                                 
                                    1
                                 
                              
                              =
                              100
                              ,
                              
                                 
                                    α
                                 
                                 
                                    2
                                 
                              
                              =
                              200
                              ,
                              
                                 
                                    α
                                 
                                 
                                    3
                                 
                              
                              =
                              200
                           
                         (in Eq. (8)). Other performance related constants are 
                           
                              
                                 
                                    M
                                 
                                 
                                    1
                                 
                                 
                                    S
                                 
                              
                              =
                              2
                              %
                              ,
                              
                                 
                                    M
                                 
                                 
                                    2
                                 
                                 
                                    S
                                 
                              
                              =
                              0.45
                              ,
                              
                                 
                                    M
                                 
                                 
                                    3
                                 
                                 
                                    S
                                 
                              
                              =
                              2
                              %
                              ,
                              
                                 
                                    K
                                 
                                 
                                    1
                                 
                              
                              =
                              -
                              50
                              ,
                              
                                 
                                    K
                                 
                                 
                                    2
                                 
                              
                              =
                              -
                              1
                              ,
                              
                                 
                                    K
                                 
                                 
                                    3
                                 
                              
                              =
                              -
                              50
                           
                        , and 
                           
                              
                                 
                                    SR
                                 
                                 
                                    S
                                 
                              
                              =
                              90
                              %
                           
                        . In order to simulate the randomness of each task, three random variables 
                           
                              
                                 
                                    V
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    V
                                 
                                 
                                    2
                                 
                              
                           
                         and 
                           
                              
                                 
                                    V
                                 
                                 
                                    3
                                 
                              
                           
                         are introduced. 
                           
                              
                                 
                                    V
                                 
                                 
                                    1
                                 
                              
                           
                         is generated by a normal distribution within the range [0,8]. 
                           
                              
                                 
                                    V
                                 
                                 
                                    2
                                 
                              
                           
                         is uniformly distributed between 75 and 125. 
                           
                              
                                 
                                    V
                                 
                                 
                                    3
                                 
                              
                           
                         is also a uniformly distributed variable, but it has two ranges according to two configurations. In the SIMPLE configuration, 
                           
                              
                                 
                                    V
                                 
                                 
                                    3
                                 
                              
                              ∼
                              U
                              (
                              600
                              ,
                              800
                              )
                           
                        , and in the MEDIUM configuration, 
                           
                              
                                 
                                    V
                                 
                                 
                                    3
                                 
                              
                              ∼
                              U
                              (
                              500
                              ,
                              700
                              )
                           
                        . In the SIMPLE configuration, the system workload is light and there exists much more available resources than that in the MEDIUM case. In both configurations, we choose EDF (Earliest Deadline First) as the basic real-time scheduling policy. Based on these mentioned parameters, the deadline of each task can be expressed as
                           
                              
                                 
                                    
                                       d
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       a
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 500
                                 +
                                 
                                    
                                       V
                                    
                                    
                                       1
                                    
                                 
                                 ×
                                 150
                                 
                                 (
                                 ms
                                 )
                              
                           
                        the data size is
                           
                              
                                 
                                    
                                       DS
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       2
                                    
                                    
                                       
                                          
                                             V
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 ×
                                 16
                                 
                                 (
                                 B
                                 )
                              
                           
                        and the arrival time of the i-th task is
                           
                              (25)
                              
                                 
                                    
                                       a
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       a
                                    
                                    
                                       i
                                       -
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       V
                                    
                                    
                                       3
                                    
                                 
                                 
                                 (
                                 ms
                                 )
                                 .
                              
                           
                        
                     

The execution time, 
                           
                              
                                 
                                    e
                                 
                                 
                                    i
                                 
                              
                           
                        , is the sum of 
                           
                              
                                 
                                    e
                                 
                                 
                                    i
                                 
                                 
                                    s
                                 
                              
                           
                         and 
                           
                              
                                 
                                    e
                                 
                                 
                                    i
                                 
                                 
                                    o
                                 
                              
                           
                        . 
                           
                              
                                 
                                    e
                                 
                                 
                                    i
                                 
                                 
                                    s
                                 
                              
                           
                         is the security protection we need to control, and 
                           
                              
                                 
                                    e
                                 
                                 
                                    i
                                 
                                 
                                    o
                                 
                              
                           
                         is a constant and equal to the value of 
                           
                              
                                 
                                    V
                                 
                                 
                                    2
                                 
                              
                           
                        .

We verify the feasibility of our simulation settings in this section. We do not deploy any security protection and then measure the CPU utilization (in Fig. 8
                        ). In SIMPLE configuration, the CPU utilization stabilizes at 60% (in Fig. 8(a)), and in MEDIUM, the utilization keeps around 70% (in Fig. 8(b)). The utilizations of both SIMPLE and MEDIUM cases are much less than the upper bound of EDF (100%), which means CPU resources can be further utilized for the security improvement without violating the schedulability of tasks.

In the first experiment, we test the performance of the proposed design when the system workload is stable. In simulations, the arrival time of each aperiodic task is set by the same rule (in Eq. (25)). For comparison, we introduce OpenSRM (Open Security Risk Management) mechanism, an open-loop scheduling policy based on the scheduling method in [18,24]. OpenSRM does not employ feedback controller to carry out the task scheduling function and ignores security risk management of each task.


                        Fig. 9
                         shows the run-time performances of DSRM and OpenSRM under the SIMPLE configuration. It can be found that when the workload is not heavy, the performances of these two mechanisms are similar, and the advantage of the proposed design is not significant. For both DSRM and OpenSRM, the task rejection ratio keeps at a high level. This is because that the task rejection ratio is controlled by the Admission Control component at the upper level. The low-level control has no direct impact on it. In DSRM, the two level controls are connected by the management of Waiting Queue. The performance of fine-grained control at the lower level is limited when the system workload is light.

We simulate the situation in MEDIUM case and demonstrate the results in Fig. 10
                        . We can find out that the proposed DSRM design can achieve a lower rejection ratio, although with a larger fluctuation range. Controllers in DSRM realize the fine-grained control, and help maintain the rejection ratio at an acceptable level. Due to the complicated relationship between the security level and task rejection ratio, the exact value of 
                           
                              
                                 
                                    G
                                 
                                 
                                    3
                                 
                              
                           
                         (in Eq. (21)) is hard to predict, leading to the phenomenon that the rejection ratio control fails to stabilize at a converge point. Hence, in real applications, measuring and calibrating 
                           
                              
                                 
                                    G
                                 
                                 
                                    3
                                 
                              
                           
                         are still necessary. Moreover, the DSRM obtains around 2% deadline miss ratio, which is much lower than that of OpenSRM. For the risk ratio, these two mechanisms have close results.


                        Fig. 11
                         provides a statistic comparison between OpenSRM and DSRM. The value of each item is the average results of all sampling windows. Based on the results, we can obtain following observations. DSRM has less values in miss ratio, rejection ratio and overall performance. The purpose of this work is to decrease the performance function, in Eq. (8), thus the proposed DSRM can improve the overall performance 33.9% on average comparing with OpenSRM. Although OpenSRM achieves a slightly lower risk ratio than DSRM in both SIMPLE and MEDIUM, it is actually not a major disadvantage as explained in the following. The value of security risk ratio is discrete and has an exponential relationship with the security level. When the security protection reaches certain level, the operation to deploy stronger secure cryptography algorithms does not significantly reduce the security risk faced by the system any more. At the same time, these stronger algorithms consume more time and energy to encrypt sensitive data, which may lead to more deadline violations. In short, we make the conclusion that DSRM is a better mechanism to provide a lower deadline miss ratio, task rejection ratio, and most importantly, to make the overall performance function better, even though the average risk ratio in DSRM is a litter higher than that in OpenSRM.

In this group of simulations, we test the performance of DSRM and OpenSRM when the system workload varies dramatically in a special period. We define the overloaded period to be from the 40-th to the 60-th sampling windows, during which the random variable 
                           
                              
                                 
                                    V
                                 
                                 
                                    3
                                 
                              
                           
                         follows a uniform distribution from 400 to 600. It means that much more tasks arrive during the overloaded period. Other parameters, such as 
                           
                              
                                 
                                    V
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    V
                                 
                                 
                                    2
                                 
                              
                           
                        , are set the same as experiment A. This experiment is conducted to simulate the performance of DSRM when facing DDoS attacks.

The runtime results of DSRM and OpenSRM are demonstrated in Fig. 12
                        . In the overloaded period, the miss ratio and rejection ratio in OpenSRM are at around 5% and 17%, respectively, which are clearly higher than those in DSRM. The reason is that DSRM can choose a relative weak security protection to save the computational resources and guarantee that more tasks can be served and completed before their deadlines. For the same reason, DSRM is less stable than OpenSRM as shown in Fig. 12. Thus if the proposed design needs to be applied in some stable-sensitive applications, it is better to make precise estimations and find more appropriate parameters. Comparing with the results of experiment A, the advantage of DSRM is more obvious when there exist DDoS attacks at the system. In Fig. 13
                        , the deadline miss ratio and rejection ratio of DSRM are 50% and 25% lower than those of OpenSRM, respectively. Although the risk ratio in DSRM is a little higher than that in OpenSRM, the difference is very small. Finally, DSRM can make a much smaller value in the whole performance description function. Specifically, DSRM can improve the overall performance by 39.3% on average. In conclusion, the dynamic mechanism DSRM can achieve better performance than static mechanism OpenSRM when the system workload becomes heavy and changeable.

@&#CONCLUSIONS AND FUTURE WORK@&#

In this paper, we are interested in the protection of security-critical real-time applications in industrial networks. We have proposed a dynamic security management mechanism which aims to reduce security risk, deadline miss ratio and task rejection ratio of aperiodic real-time tasks running on industrial server systems. To make our work more practical, we have measured the time and energy consumptions of widely used cryptographic algorithms and introduced a security risk metric to quantify the security strength of real-time tasks. To address the task scheduling problem, we have designed a two-level feedback control framework. The upper-level component focuses on task admitting and security level initiating. The fine-grained control implemented by three proportional controllers are deployed at the lower-level, which can adjust the security configuration variables and the security level of each running task according to the user requirement and system status. Extensive experiments demonstrate that the proposed mechanism can successfully make the system metrics (deadline miss ratio, security risk ratio and rejection ratio) converged to their desired set points, and achieve up to 39.3% improvement of the overall performance comparing to the existing open-loop control mechanism.

As the future work, we plan to extend our design method for periodic real-time applications with diversified security protections including integrity protection and make efforts on dynamic security management mechanisms for Distributed Control in industrial networks.

@&#ACKNOWLEDGEMENT@&#

This work was partly supported by the National Natural Science Foundation of China under Grant No. 61003032.

@&#REFERENCES@&#

