@&#MAIN-TITLE@&#Symbolically structured database for human whole body motions based on association between motion symbols and motion words

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           This paper proposes a database of human motions and their descriptive words.


                        
                        
                           
                           The stochastic model constructs the mapping between the motions and words.


                        
                        
                           
                           The database can be applied to the retrieval of the motion data from the word.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Motion database

Motion recognition/generation

Hidden Markov Model

Motion symbol

Motion words

@&#ABSTRACT@&#


               
               
                  Motion capture systems have been commonly used to enable humanoid robots or CG characters to perform human-like motions. However, prerecorded motion capture data cannot be reused efficiently because picking a specific motion from a large database and modifying the motion data to fit the desired motion patterns are difficult tasks. We have developed an imitative learning framework based on the symbolization of motion patterns using Hidden Markov Models (HMMs), where each HMM (hereafter referred to as “motion symbol”) abstracts the dynamics of a motion pattern and allows motion recognition and generation. This paper describes a symbolically structured motion database that consists of original motion data, motion symbols, and motion words. Each motion data is labeled with motion symbols and motion words. Moreover, a network is formed between two layers of motion symbols and motion words based on their probability association. This network makes it possible to associate motion symbols with motion words and to search for motion datasets using motion symbols. The motion symbols can also generate motion data. Therefore, the developed framework can provide the desired motion data when only the motion words are input into the database.
               
            

@&#INTRODUCTION@&#

In the fields of robotics and animation, humanoid robots or CG human figures need to perform human-like motions. Thus far, creating realistic motions has remained challenging. One effective solution that has been proposed to solve this problem is the use of human behavioral data measured using motion capture systems  [1–3]. A motion capture system can reliably be used to obtain realistic motion data. However, it remains difficult to efficiently reuse the captured motion data because of the need to search for specific motion data. Doing so in a motion archive is difficult because the search depends on recording date labels or motion pattern labels provided by the designers. Several reuse technologies of prerecorded captured data have been proposed, such as Motion Graph  [4–9] or Motion Warping[10,11]. The Motion Graph measures similarities among motion frames, makes new transitions between similar motion frames, concatenates motion frames according to the transitions, and finally creates human-like motions. The Motion Warping interpolates between two key motion frames spatio-temporally, and creates new motions. These notable reuse technologies presuppose that users have their motion data or motion frames, or special skills of editing CG character motions. Interfaces allowing users to reuse prerecorded motion data in a simple way are necessary.

In the field of robotics, various imitative learning frameworks have been proposed thus far  [12]. These frameworks make it possible to symbolize motion data as a set of model parameters and to recognize and generate motion data through dynamical systems  [13–17] or stochastic models  [18–21]. The motion symbols are expected to be connected to language which is a symbolic system unique to human being, and to lead to a novel interface to reuse motion data. Sugita et al. proposed a method for creating motion from sentences by joining together neural networks for motion and text processing  [22]. One neural network encodes motions into bias parameters, and another neural network encodes sentences into the same bias parameters. Ogata et al. extended this framework to creating sentences from motion  [23]. The computation for generating sentences consists of the process of associating multiple sentences with a motion, and the process of creating motion from the associated sentences and selecting the appropriate sentence by comparison with the original motion. This creates the problem of large computational load for generating sentences. Furthermore, since the framework of this neural network adds the new condition that the motion and sentence are joined by parameters shared by two neural networks for motion and text processing, training using a large number of motions and sentences is difficult.

In computer graphics, research has been conducted into synthesizing a wide variety of motions from the perspectives of motion and language. Arikan et al. proposed a method for synthesizing computer graphics character motion from words. Verb labels are attached to each frame of the motions in a database. New motions that correspond to language can be synthesized by finding a continuous sequence of motions through dynamic programming while satisfying the constraint condition that the motion in the frames corresponds to the entered verb  [24]. Rose et al. introduced a parameter called “adverb” that represents the difference between two motions within a group of similar motions called “verbs” and proposed a new technique that interpolates between two motions by controlling this parameter  [25]. Although this introduced the concept of verbs and adverbs, the sequential relations of motions and words were not dealt.

In this study, we develop a symbolically structured motion database based on an association between symbolized motion patterns and motion words. Motion pattern data are represented by Hidden Markov Models (HMMs), hereafter referred to as motion symbols  [26]. The motion data cannot only be recognized as the motion symbol but also be generated by the motion symbol, as shown in Fig. 1
                     . The designed motion database consists of motion data, motion symbols, motion words which are linguistic representations, and the probability association between the motion symbols and the motion words. The motion symbols are automatically derived from the motion data through a motion recognition process. The motion words are manually assigned to the motion data. The association between the motion symbols and the motion words is hierarchically structured based on the motion data, as shown in Fig. 2
                     . The associative network between the motion symbols and the motion words allows the interpretation of the motion words as the motion symbols, which facilitates the search and generation of motion data corresponding to the motion symbols. Therefore, the proposed motion database solves the problems involved in the search and modification of motion data and provides users with a useful interface.

We propose a simple approach to search for the desired motion data based on motion symbols. In our framework, an HMM, which we refer to as a motion symbol, represents a motion pattern because the parameters of the HMM are optimized with the motion pattern data. The motion symbols can be autonomously acquired through motion segmentation and competitive learning of motion data included in the motion database [27]. The 
                           i
                        th motion data 
                           
                              
                                 
                                    O
                                 
                              
                              
                                 
                                    (
                                    i
                                    )
                                 
                              
                           
                         is segmented into motion pattern data, and each motion pattern data 
                           
                              
                                 
                                    o
                                 
                              
                              
                                 
                                    (
                                    i
                                    )
                                 
                              
                           
                           
                              [
                              k
                              ]
                           
                         is recognized as a motion symbol 
                           
                              
                                 λ
                              
                              
                                 R
                              
                              
                                 
                                    (
                                    i
                                    )
                                 
                              
                           
                           
                              [
                              k
                              ]
                           
                        . 
                           
                              
                                 (1)
                                 
                                    
                                       
                                          
                                             O
                                          
                                       
                                       
                                          
                                             (
                                             i
                                             )
                                          
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                o
                                             
                                          
                                          
                                             
                                                (
                                                i
                                                )
                                             
                                          
                                       
                                       
                                          [
                                          1
                                          ]
                                       
                                       ,
                                       
                                          
                                             
                                                o
                                             
                                          
                                          
                                             
                                                (
                                                i
                                                )
                                             
                                          
                                       
                                       
                                          [
                                          2
                                          ]
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             
                                                o
                                             
                                          
                                          
                                             
                                                (
                                                i
                                                )
                                             
                                          
                                       
                                       
                                          [
                                          l
                                          ]
                                       
                                       }
                                    
                                 
                              
                              
                                 (2)
                                 
                                    
                                       
                                          Λ
                                       
                                       
                                          
                                             (
                                             i
                                             )
                                          
                                       
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             λ
                                          
                                          
                                             R
                                          
                                          
                                             
                                                (
                                                i
                                                )
                                             
                                          
                                       
                                       
                                          [
                                          1
                                          ]
                                       
                                       ,
                                       
                                          
                                             λ
                                          
                                          
                                             R
                                          
                                          
                                             
                                                (
                                                i
                                                )
                                             
                                          
                                       
                                       
                                          [
                                          2
                                          ]
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             λ
                                          
                                          
                                             R
                                          
                                          
                                             
                                                (
                                                i
                                                )
                                             
                                          
                                       
                                       
                                          [
                                          l
                                          ]
                                       
                                       }
                                    
                                 
                              
                              
                                 (3)
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          R
                                       
                                       
                                          
                                             (
                                             i
                                             )
                                          
                                       
                                    
                                    
                                       [
                                       k
                                       ]
                                    
                                    =
                                    arg
                                    
                                       
                                          max
                                       
                                       
                                          
                                             
                                                λ
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    P
                                    
                                       (
                                       
                                          
                                             
                                                o
                                             
                                          
                                          
                                             
                                                (
                                                i
                                                )
                                             
                                          
                                       
                                       
                                          [
                                          k
                                          ]
                                       
                                       |
                                       
                                          
                                             λ
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        
                     

The motion data is expressed by a sequence of motion symbols. Note that the motion symbol 
                           
                              
                                 λ
                              
                              
                                 R
                              
                              
                                 
                                    (
                                    i
                                    )
                                 
                              
                           
                           
                              [
                              k
                              ]
                           
                         outputs the largest likelihood that the motion symbol generates the motion pattern data 
                           
                              
                                 
                                    o
                                 
                              
                              
                                 
                                    (
                                    i
                                    )
                                 
                              
                           
                           
                              [
                              k
                              ]
                           
                        . Motion segmentation and motion recognition allow the motion data 
                           
                              
                                 
                                    O
                                 
                              
                              
                                 
                                    (
                                    i
                                    )
                                 
                              
                           
                         to be interpreted as a sequence of motion symbols 
                           
                              
                                 Λ
                              
                              
                                 
                                    (
                                    i
                                    )
                                 
                              
                           
                        . The sequence of motion symbols 
                           
                              
                                 Λ
                              
                              
                                 
                                    (
                                    i
                                    )
                                 
                              
                           
                         is assigned to the corresponding motion pattern data 
                           
                              
                                 
                                    O
                                 
                              
                              
                                 
                                    (
                                    i
                                    )
                                 
                              
                           
                         in the database.

The database can find motion data similar to the desired motion pattern. The desired sample data 
                           
                              
                                 
                                    O
                                 
                              
                              
                                 ˆ
                              
                           
                         can also be expressed by a sequence of motion symbols 
                           
                              
                                 Λ
                              
                              
                                 ˆ
                              
                           
                           =
                           
                              {
                              
                                 
                                    λ
                                 
                                 
                                    ˆ
                                 
                              
                              
                                 [
                                 1
                                 ]
                              
                              ,
                              
                                 
                                    λ
                                 
                                 
                                    ˆ
                                 
                              
                              
                                 [
                                 2
                                 ]
                              
                              ,
                              …
                              }
                           
                         through automatic segmentation and recognition. The motion data 
                           
                              
                                 
                                    O
                                 
                              
                              
                                 c
                                 a
                                 n
                                 d
                                 i
                                 d
                                 a
                                 t
                                 e
                              
                           
                        , which the symbolic sequence 
                           
                              
                                 Λ
                              
                              
                                 ˆ
                              
                           
                         is assigned to, is detected because the selected motion data should be similar to the desired motion. In this manner, motion data that closely resembles the desired motion can be searched. This approach enables the users to obtain the desired motion data by inputting sample motion data.

In the previous section, users have to input a sample motion to obtain desired motion data. The users do not necessarily have the sample motion. A new approach to the design of a motion database is required such that the database can search for the desired motion data corresponding to the motion words. The users only have to linguistically input the motion words. This provides for a simple interface to reuse prerecorded motion data.

A linguistic interface is founded on interpretation of motion words as motion symbols and search for motion data according to the motion symbols in the same manner as detailed in the previous section. More specifically, the mapping between the motion symbols and motion words is required to establish the linguistic interface. We propose an association model between motion symbols and motion words.

This model represents a stochastic mapping between a sequence of motion symbols and a sequence of motion words through motion data using IBM translation model, as shown in Fig. 3
                        . The designer subjectively segments the motion data 
                           
                              
                                 
                                    O
                                 
                              
                              
                                 
                                    (
                                    i
                                    )
                                 
                              
                           
                         into motion primitives, and assigns a sequence of motion words 
                           
                              
                                 Ω
                              
                              
                                 
                                    (
                                    i
                                    )
                                 
                              
                           
                           =
                           
                              {
                              
                                 
                                    ω
                                 
                                 
                                    
                                       (
                                       i
                                       )
                                    
                                 
                              
                              
                                 [
                                 1
                                 ]
                              
                              ,
                              
                                 
                                    ω
                                 
                                 
                                    
                                       (
                                       i
                                       )
                                    
                                 
                              
                              
                                 [
                                 2
                                 ]
                              
                              ,
                              …
                              ,
                              
                                 
                                    ω
                                 
                                 
                                    
                                       (
                                       i
                                       )
                                    
                                 
                              
                              
                                 [
                                 m
                                 ]
                              
                              }
                           
                         to the motion primitives. The same motion data is also interpreted as a sequence of motion symbols by the motion recognition process described by Eq. (3). Note that the segmentation criterion used by the designer differs from that used in the automatic segmentation method. This means that the boundaries of motion primitives derived by the automatic segmentation are not consistent with those by the manual segmentation. It results in the fact that the number of motion primitives generated by the designer is not always equal to the number of primitives generated by the automatic segmentation method 
                           
                              (
                              l
                              ≠
                              m
                              )
                           
                        .

The stochastic mapping between a sequence of motion symbols 
                           Λ
                         and a sequence of motion words 
                           Ω
                         is represented by the IBM translation model  [28]. Five types of IBM translation models are presented. These models are numbered in order of increasing complexity. In this study, we adopt the second model. This model consists of parameters for translation probabilities and alignment probabilities. The translation probability 
                           t
                           
                              (
                              f
                              |
                              e
                              )
                           
                         denotes the probability that the word 
                           e
                         is translated to the word 
                           f
                        . The alignment probability 
                           a
                           
                              (
                              i
                              |
                              j
                              ,
                              m
                              ,
                              l
                              )
                           
                         denotes the probability that position 
                           i
                         in the source sentence 
                           
                              e
                           
                         can align to position 
                           j
                         in the target sentence 
                           
                              f
                           
                        , where 
                           l
                         and 
                           m
                         are the length of the source and the target sentence, respectively. In this study, a sequence of motion symbols 
                           Λ
                         and a sequence of motion words 
                           Ω
                         are regarded as a source sentence and a target sentence respectively. The translation probability 
                           t
                           
                              (
                              ω
                              |
                              λ
                              )
                           
                         is the probability that the motion symbol 
                           λ
                         is associated with the motion word 
                           ω
                        . Let the translation probability be the association probability. The association model between the motion symbols and motion words is optimized such that the sum of the likelihood that a sequence of motion symbols 
                           
                              
                                 Λ
                              
                              
                                 
                                    (
                                    i
                                    )
                                 
                              
                           
                         generates a sequence of motion words 
                           
                              
                                 Ω
                              
                              
                                 
                                    (
                                    i
                                    )
                                 
                              
                           
                         becomes the largest. 
                           
                              (4)
                              
                                 Ψ
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             
                                                O
                                             
                                          
                                          
                                             
                                                (
                                                i
                                                )
                                             
                                          
                                       
                                    
                                 
                                 P
                                 
                                    (
                                    
                                       
                                          Ω
                                       
                                       
                                          
                                             (
                                             i
                                             )
                                          
                                       
                                    
                                    |
                                    
                                       
                                          Λ
                                       
                                       
                                          
                                             (
                                             i
                                             )
                                          
                                       
                                    
                                    )
                                 
                              
                           
                         where 
                           
                              
                                 Λ
                              
                              
                                 
                                    (
                                    i
                                    )
                                 
                              
                           
                         and 
                           
                              
                                 Ω
                              
                              
                                 
                                    (
                                    i
                                    )
                                 
                              
                           
                         express the motion capture data 
                           
                              
                                 
                                    O
                                 
                              
                              
                                 
                                    (
                                    i
                                    )
                                 
                              
                           
                         symbolically and linguistically, respectively. The optimum solution for the parameters of the association probabilities and the alignment probabilities can be computed by the EM algorithm.

We propose the conversion from a sequence of motion words, 
                           Ω
                        , to a sequence of motion symbols, 
                           
                              
                                 Λ
                              
                              
                                 ˆ
                              
                           
                        , by using the association model described above. Note that 
                           Ω
                         generates 
                           
                              
                                 Λ
                              
                              
                                 ˆ
                              
                           
                         with the largest likelihood. However, computing for a sequence of motion symbols only based on the association model provides us with a sequence of symbols in an inadequate order, because the association model does not impose sufficient constraints on motion symbolic order. We therefore establish a symbol-transition model that stochastically represents transitions among the motion symbols. We adopt an N-gram model based on the assumption that the current motion symbol depends on only 
                           N
                           −
                           1
                         previous motion symbols. Specifically, we use a bigram 
                           
                              (
                              N
                              =
                              2
                              )
                           
                        , as shown in Fig. 4
                        . The probability for a sequence of symbols 
                           Λ
                           =
                           
                              {
                              λ
                              
                                 [
                                 1
                                 ]
                              
                              ,
                              λ
                              
                                 [
                                 2
                                 ]
                              
                              ,
                              …
                              ,
                              λ
                              
                                 [
                                 l
                                 ]
                              
                              }
                           
                         can be expressed by Eq. (5). 
                           
                              (5)
                              
                                 P
                                 
                                    (
                                    Λ
                                    )
                                 
                                 =
                                 
                                    
                                       ∏
                                    
                                    
                                       i
                                       =
                                       2
                                    
                                    
                                       l
                                    
                                 
                                 P
                                 
                                    (
                                    λ
                                    
                                       [
                                       i
                                       ]
                                    
                                    |
                                    λ
                                    
                                       [
                                       i
                                       −
                                       1
                                       ]
                                    
                                    )
                                 
                                 .
                              
                           
                         The conditional probability on the right-hand side of Eq. (5), 
                           P
                           
                              (
                              
                                 
                                    λ
                                 
                                 
                                    i
                                 
                              
                              |
                              
                                 
                                    λ
                                 
                                 
                                    j
                                 
                              
                              )
                           
                        , can be optimized by using the relative frequency as follows. 
                           
                              (6)
                              
                                 P
                                 
                                    (
                                    
                                       
                                          λ
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    
                                       
                                          λ
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       C
                                       
                                          (
                                          
                                             
                                                λ
                                             
                                             
                                                j
                                             
                                          
                                          ,
                                          
                                             
                                                λ
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                    
                                    
                                       C
                                       
                                          (
                                          
                                             
                                                λ
                                             
                                             
                                                j
                                             
                                          
                                          )
                                       
                                    
                                 
                              
                           
                         where 
                           P
                           
                              (
                              
                                 
                                    λ
                                 
                                 
                                    i
                                 
                              
                              |
                              
                                 
                                    λ
                                 
                                 
                                    j
                                 
                              
                              )
                           
                         is the probability that the motion symbol 
                           
                              
                                 λ
                              
                              
                                 i
                              
                           
                         follows the motion symbol 
                           
                              
                                 λ
                              
                              
                                 j
                              
                           
                        . 
                           C
                           
                              (
                              
                                 
                                    λ
                                 
                                 
                                    j
                                 
                              
                              ,
                              
                                 
                                    λ
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         is the number of times that the motion symbol 
                           
                              
                                 λ
                              
                              
                                 i
                              
                           
                         follows the motion symbol 
                           
                              
                                 λ
                              
                              
                                 j
                              
                           
                         in training sequences of motion symbols. 
                           C
                           
                              (
                              
                                 
                                    λ
                                 
                                 
                                    j
                                 
                              
                              )
                           
                         is the number of times the motion symbol 
                           
                              
                                 λ
                              
                              
                                 j
                              
                           
                         is included in the training sequences.

The association model and symbol-transition model are integrated to conversion from a sequence of words 
                           Ω
                         to a sequence of symbols 
                           
                              
                                 Λ
                              
                              
                                 ˆ
                              
                           
                        , as indicated in Eq. (7). 
                           
                              (7)
                              
                                 
                                    
                                       Λ
                                    
                                    
                                       ˆ
                                    
                                 
                                 =
                                 arg
                                 
                                 
                                    
                                       max
                                    
                                    
                                       Λ
                                    
                                 
                                 
                                 P
                                 
                                    (
                                    Λ
                                    |
                                    Ω
                                    )
                                 
                                 =
                                 arg
                                 
                                 
                                    
                                       max
                                    
                                    
                                       Λ
                                    
                                 
                                 
                                 P
                                 
                                    (
                                    Λ
                                    )
                                 
                                 P
                                 
                                    (
                                    Ω
                                    |
                                    Λ
                                    )
                                 
                                 .
                              
                           
                         The symbol-transition model allows us to convert a sequence of motion words to a sequence of motion symbols in an appropriate order.

We describe how a sequence of symbols 
                           
                              
                                 Λ
                              
                              
                                 ˆ
                              
                           
                         is calculated in Eq. (7). The 
                           
                              
                                 A
                              
                              
                                 ∗
                              
                           
                         search algorithm is employed in this calculation  [29]. The 
                           
                              
                                 A
                              
                              
                                 ∗
                              
                           
                         search algorithm is one of the most efficient graph search algorithms in the field of computer science. A graph consists of a tree structure with nodes and edges, and graph search involves finding a path from a given initial node to a given goal node. The 
                           
                              
                                 A
                              
                              
                                 ∗
                              
                           
                         search method employs a heuristic estimation that ranks each node by estimating the best path that passes through that node. The node with the largest heuristic estimate is visited first so that the best path can be found in a short time.

The sequence of motion symbols calculated by Eq. (7) allows the same search for motion data as described in the previous section. Moreover, the sequence of motion symbols 
                           
                              
                                 Λ
                              
                              
                                 ˆ
                              
                           
                           =
                           
                              {
                              
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          1
                                       
                                    
                                 
                                 
                                    ˆ
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    ˆ
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          l
                                       
                                    
                                 
                                 
                                    ˆ
                                 
                              
                              }
                           
                         can generate motion data. Each motion symbol is represented by a left-to-right HMM. The motion symbols in 
                           
                              
                                 Λ
                              
                              
                                 ˆ
                              
                           
                         are concatenated in series by setting the transition probability from the node at the end in the previous HMM 
                           
                              
                                 λ
                              
                              
                                 i
                              
                           
                         to the node at the head in the next HMM 
                           
                              
                                 λ
                              
                              
                                 i
                                 +
                                 1
                              
                           
                         to 1. This concatenation forms one left-to-right HMM. The motion can then be stochastically generated by this HMM through Monte-Carlo algorithm  [30].

The association model and the symbol-transition model described in the previous subsections represent the mapping between motion symbols and words and the stochastic transition of motion symbols in training data, which means that this strategy may not be useful for untrained sequences of motion words or motion symbols, especially if the training dataset is small. This problem is often called poverty of stimulus. However, humans can adapt to unknown situations by using some knowledge and experience that have been acquired in previous situations similar to the current one. This inference based on similarity is called analogy. We believe that analogy is one of the solutions to this problem. Therefore, we extend the symbol-transition model to represent the stochastic transition among clusters of motion symbols. The cluster structure of the motion symbols can support the database’s adaptability to unknown motion. We call this strategy analogy from the viewpoint of the fact that the database can use knowledge about the similarity among motion symbols.

Distance between two motion symbols, 
                           
                              
                                 λ
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 λ
                              
                              
                                 j
                              
                           
                         is measured using Kullback Leibler information 
                           K
                           L
                           
                              (
                              
                                 
                                    λ
                                 
                                 
                                    i
                                 
                              
                              |
                              
                                 
                                    λ
                                 
                                 
                                    j
                                 
                              
                              )
                           
                           [31]. 
                           
                              
                                 
                                    K
                                    L
                                    
                                       (
                                       
                                          
                                             λ
                                          
                                          
                                             i
                                          
                                       
                                       |
                                       
                                          
                                             λ
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                T
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    
                                       [
                                       log
                                       P
                                       
                                          (
                                          
                                             
                                                
                                                   o
                                                
                                             
                                             
                                                i
                                             
                                          
                                          |
                                          
                                             
                                                λ
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                       −
                                       log
                                       P
                                       
                                          (
                                          
                                             
                                                
                                                   o
                                                
                                             
                                             
                                                i
                                             
                                          
                                          |
                                          
                                             
                                                λ
                                             
                                             
                                                j
                                             
                                          
                                          )
                                       
                                       ]
                                    
                                 
                              
                              
                                 (8)
                                 
                                    D
                                    
                                       (
                                       
                                          
                                             λ
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             λ
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          K
                                          L
                                          
                                             (
                                             
                                                
                                                   λ
                                                
                                                
                                                   i
                                                
                                             
                                             |
                                             
                                                
                                                   λ
                                                
                                                
                                                   j
                                                
                                             
                                             )
                                          
                                          +
                                          K
                                          L
                                          
                                             (
                                             
                                                
                                                   λ
                                                
                                                
                                                   j
                                                
                                             
                                             |
                                             
                                                
                                                   λ
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                         where 
                           
                              
                                 
                                    o
                                 
                              
                              
                                 i
                              
                           
                         is motion data generated by the motion symbol 
                           
                              
                                 λ
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 T
                              
                              
                                 i
                              
                           
                         is the length of the motion data. A matrix of the Kullback Leibler information is asymmetric. Eq. (8) converts this matrix to a symmetric one. The motion symbols are located in a multidimensional space such that a distance between two motion symbols in the space can become as close as possible to the distance derived in Eq. (8). The distance in the space can be measured from the locations 
                           
                              
                                 
                                    x
                                 
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 
                                    x
                                 
                              
                              
                                 j
                              
                           
                         corresponding to the motion symbols 
                           
                              
                                 λ
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 λ
                              
                              
                                 j
                              
                           
                        . The locations of the motion symbols are computed by using multidimensional scaling  [32]. Thus, the motion symbol space can be constructed. The distribution of the motion symbols in the motion symbol space is represented by a Gaussian Mixture Model, as shown in Fig. 5
                         Each Gaussian function implies a cluster of the motion symbols. The motion symbol is classified into a cluster according to the probability that each Gaussian function generates the motion symbol. We can then derive transition probability from the motion symbol 
                           
                              
                                 λ
                              
                              
                                 j
                              
                           
                         to 
                           
                              
                                 λ
                              
                              
                                 i
                              
                           
                         for a new symbol-transition model as follows. 
                           
                              (9)
                              
                                 P
                                 
                                    (
                                    
                                       
                                          λ
                                       
                                       
                                          i
                                       
                                    
                                    
                                    |
                                    
                                    
                                       
                                          λ
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       C
                                       
                                          (
                                          S
                                          
                                             (
                                             
                                                
                                                   λ
                                                
                                                
                                                   j
                                                
                                             
                                             )
                                          
                                          ,
                                          S
                                          
                                             (
                                             
                                                
                                                   λ
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                          
                                          )
                                       
                                    
                                    
                                       C
                                       
                                          (
                                          S
                                          
                                             (
                                             
                                                
                                                   λ
                                                
                                                
                                                   j
                                                
                                             
                                             )
                                          
                                          )
                                       
                                    
                                 
                              
                           
                         where each cluster corresponds to each node in the bigram shown in Fig. 4. 
                           S
                           
                              (
                              λ
                              )
                           
                         indicates a cluster where a motion symbol 
                           λ
                         is categorized. In the symbol-transition model without clustering, the transition probability from a motion symbol 
                           
                              
                                 λ
                              
                              
                                 j
                              
                           
                         to 
                           
                              
                                 λ
                              
                              
                                 i
                              
                           
                         becomes zero if the symbolic transitional pattern in which the motion symbol 
                           
                              
                                 λ
                              
                              
                                 i
                              
                           
                         follows the motion symbol 
                           
                              
                                 λ
                              
                              
                                 j
                              
                           
                         is not included in training data. However, in this model, this transition probability can have a nonzero value if a sequence of motion symbol in a cluster 
                           S
                           
                              (
                              
                                 
                                    λ
                                 
                                 
                                    j
                                 
                              
                              )
                           
                         and a motion symbol in a cluster 
                           S
                           
                              (
                              
                                 
                                    λ
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         has been observed in the training data. The similarities modify the transitions among the motion symbols.

@&#EXPERIMENTAL RESULTS@&#

The validity of the motion database was experimentally verified. We used 537 sets of motion data related to a baseball. The total time period of the motion data is 4088 s. The original captured data consist of sequences of Cartesian coordinates for 34 markers attached to players. Inverse kinematics using a 20-DOF human character model converts original captured data into 30-dimensional vectors, elements of which are the two horizontal velocities; height, roll, pitch, and yaw velocity of the body; and Cartesian coordinates of both elbow joints, knee joints, wrist joints, and ankle joints in the body coordinate system. The capture sampling time is set to 30 ms. Motion data 
                           
                              {
                              
                                 
                                    
                                       O
                                    
                                 
                                 
                                    
                                       (
                                       i
                                       )
                                    
                                 
                              
                              :
                              i
                              =
                              1
                              ,
                              2
                              ,
                              3
                              ,
                              …
                              ,
                              537
                              }
                           
                         are expressed by sequences of 30-dimensional data.

99 motion symbols 
                           
                              {
                              
                                 
                                    λ
                                 
                                 
                                    j
                                 
                              
                              :
                              j
                              =
                              1
                              ,
                              2
                              ,
                              3
                              ,
                              …
                              ,
                              99
                              }
                           
                         are acquired automatically by segmentation and competitive learning of 537 motion data  [27]. A sequence of motion symbols is assigned to each motion data 
                           
                              
                                 
                                    O
                                 
                              
                              
                                 
                                    (
                                    i
                                    )
                                 
                              
                           
                         through motion segmentation and recognition. The motion data is stored with the sequence of motion symbols in the database. The database searches for motion data similar to the desired motion by checking for symbolic matching. For example, we need motion data related to “dash”. We only have to input sample motion data that looks like the “dash” motion, following which the database selects several sets of motion data that motion symbols corresponding to the sample motion are assigned to. Fig. 6
                         shows two examples of motion data output by the database when “dash” or “diving” motions are input. Note that the input motions “dash” and “diving” are not used for training the motion symbols. Each set of motion data partially includes the motion patterns of “dash” or “diving”. Therefore, we can confirm that the database can find multiple sets of motion data similar to the desired motion through matching the motion symbols.

Each motion data 
                           
                              
                                 
                                    O
                                 
                              
                              
                                 
                                    (
                                    i
                                    )
                                 
                              
                           
                         is manually given a sequence of words 
                           
                              
                                 Ω
                              
                              
                                 
                                    (
                                    i
                                    )
                                 
                              
                           
                        . For example, motion data for a lefty swinging and then running is labeled with a sequence of two motion words “left_swing run”. In this study, we use 64 words 
                           
                              {
                              
                                 
                                    ω
                                 
                                 
                                    k
                                 
                              
                              
                              :
                              
                              k
                              =
                              1
                              ,
                              2
                              ,
                              3
                              ,
                              …
                              ,
                              64
                              }
                           
                         to express all the motion data. The motion symbols are the same as those detailed in the previous subsection. Each motion data 
                           
                              
                                 
                                    O
                                 
                              
                              
                                 
                                    (
                                    i
                                    )
                                 
                              
                           
                         is labeled with a sequence of motion symbols 
                           
                              
                                 Λ
                              
                              
                                 
                                    (
                                    i
                                    )
                                 
                              
                           
                         and a sequence of motion words 
                           
                              
                                 Ω
                              
                              
                                 
                                    (
                                    i
                                    )
                                 
                              
                           
                        . We calculate the stochastic association between the sequence of motion symbols 
                           
                              
                                 Λ
                              
                              
                                 
                                    (
                                    i
                                    )
                                 
                              
                           
                         and the sequence of motion words 
                           
                              
                                 Ω
                              
                              
                                 
                                    (
                                    i
                                    )
                                 
                              
                           
                        . Fig. 7
                         shows the relationship between the likelihood computed by Eq. (4) and the number of iterative optimizations for an association model. We separate the optimization into two steps. In the first step, the parameters are optimized based on the assumption that the association model is the first type. In the second step, the parameters are optimized by using the second type of model. This separation leads to improvement of the optimization accuracy. Fig. 7 shows that the stochastic associations between sequences of motion symbols and sequences of motion words are optimized.

Motion data corresponding to a sequence of motion words are searched for using the association model and symbol-transition model. We input two sequences of motion words, “left_swing run” and “diving stand_up throw standing”, to the database. Fig. 8
                         shows examples of retrieved motion data. The motion data on the top of Fig. 8 are adequate for the input “left_swing run”. However, the motion data on the third and fourth tops of Fig. 8 reveal that a player swings a bat and then walks. We are sure that the output data “walk” differs from the input data “run”. However, these motion patterns are similar to each other because the body moves forward in both the cases of running and walking motion data. We do not necessarily think that the database makes mistakes in searching for the motion data. The database provides the users with motion data that cannot be found by conventional search methods such as “text matching” but may resemble the desired motion. The motion data on the bottom of Fig. 8 shows the retrieved motion from a sequence of motion words : “diving stand_up throw standing”. In this figure, a player dives, stands up, throws a ball and then stands motionless. This experiment clarifies that we only have to input motion words and that we can easily derive the prerecorded captured motion data corresponding to the motion words.


                        Table 1
                         shows evaluation results of searching for motion data. We adopt True Positive (TP), False Positive (FP), False Negative (FN), True Negative (TN), Recall and Precision as evaluation measures. Retrieved motion data that is labeled with the input sequence of motion words is counted as TP, and retrieved motion data that is not labeled with the input is counted as FP. FN is the motion data that is labeled with the input motion words but is not retrieved, and TN is the motion data that is not labeled with the input motion words and is not retrieved. Recall measures the percentage of TP in all the motion data in the database that the input motion words are assigned to. Precision measures the percentage of TP in all the retrieved motion data. In Table 1, these evaluation results are shown, given ten sequences of motion words as inputs. We chose five sequences of only one motion word and five sequences of two motion words, since the performance of searching for motion data may depend on the length of the sequence. Recall and Precision are 95% and 96% for the input of “left_swing” respectively. Recall and Precision also maintain high percentages of 88% and 76% for the input of “right_swing”. Recalls for the inputs “run” and “dash” are 96% and 100%, however Precisions are 67% and 12% respectively. Because “run” indicates motions similar to “dash”, motions that are labeled with “dash” are retrieved out of the motion dataset when “run” is input, and motions that are labeled with “run” are likewise retrieved out of the motion dataset when “dash” is input. This low Precision means that this framework can retrieve motions that are not labeled with input motion words but that the input motion words may indicate. The retrieval based on association between motion words and motion symbols has an advantage over label-matching based retrieval in this point. Recall and Precision for “left_swing run” which consists of two motion words are 98% and 85%. Both Recall and Precision for “dash banzai_running” and “run sliding” result in range from 88% to 100%, where “banzai” in Japanese means gesture of raising both hands. Although Recalls for “stand_up right_throw_pose” and “run jump” results in 100%, Precisions are 47% and 30% respectively. When “stand_up right_throw_pose” is input, motions that are labeled with “stand_up right_throw” are retrieved out of the motion dataset. These retrieved motions are similar to motions that are labeled with “stand_up right_throw_pose”. When “run jump” is input, the motions that are labeled with “run be_lifted_up” are retrieved. The retrieved motions are also similar to the input because motions of “jump” and “be_lifted_up” share the same features that the body translates upward. These low Precisions result from the retrieval of motions that are similar to inputs but are not labeled with the input motion words.


                        Table 2
                         shows a comparison between the computational times of the 
                           
                              
                                 A
                              
                              
                                 ∗
                              
                           
                         search and the all-search method. The average search time of the 
                           
                              
                                 A
                              
                              
                                 ∗
                              
                           
                         search algorithm is 0.41 s. That of the all-search algorithm is 674.2 s. The rate of coincidence between the solution of the 
                           
                              
                                 A
                              
                              
                                 ∗
                              
                           
                         search algorithm and the all-search algorithm is 74[%].

In addition to searching for the desired motion data, we aim to construct a database that can generate new motion data in response to an input of motion words. The same input “left_swing run” as used in the search experiment was employed for the experiment. The database yields motions through the association of motion symbols with input words and by the generation of motion data by the motion symbols. Fig. 9
                         shows the motion generated by the database. It demonstrates that the lefty swings the bat and then runs. The pictures on the bottom in Fig. 9 show the behavior of a small humanoid with 20 joints using the generated motion data as a motion reference. The database can generate a new motion suitable for the input “left_swing run”. Another input “diving stand_up right_throw_pose” was employed for the motion generation. The generated motion is shown on the right panel in Fig. 9. This framework can be applied to a motion generator for CG characters or real humanoid robots. We verify that the database cannot only retrieve motion data similar to the desired one but also generate appropriate motion data in response to a sequence of words based on the association model and symbol-transition model.


                        Fig. 10
                         shows two motion symbol spaces. One space on the left-hand side of Fig. 10 is established by using distances among motion symbols in Eq. (8). Motion symbols are located in four-dimensional space. Another space is established by using distances that are defined not only from the relations between motion symbols and motion data but also from the association between motion symbols and motion words. This distance between two motion symbols 
                           K
                           
                              
                                 L
                              
                              
                                 ∗
                              
                           
                           
                              (
                              
                                 
                                    λ
                                 
                                 
                                    i
                                 
                              
                              |
                              
                                 
                                    λ
                                 
                                 
                                    j
                                 
                              
                              )
                           
                         can be derived as follows. 
                           
                              
                                 
                                    P
                                    
                                       (
                                       
                                          
                                             
                                                o
                                             
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             ω
                                          
                                          
                                             k
                                          
                                       
                                       |
                                       
                                          
                                             λ
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    =
                                    P
                                    
                                       (
                                       
                                          
                                             
                                                o
                                             
                                          
                                          
                                             i
                                          
                                       
                                       |
                                       
                                          
                                             λ
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    t
                                    
                                       (
                                       
                                          
                                             ω
                                          
                                          
                                             k
                                          
                                       
                                       |
                                       
                                          
                                             λ
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          d
                                       
                                       
                                          ∗
                                       
                                    
                                    
                                       (
                                       
                                          
                                             λ
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             λ
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                T
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                ω
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                    t
                                    
                                       (
                                       
                                          
                                             ω
                                          
                                          
                                             k
                                          
                                       
                                       |
                                       
                                          
                                             λ
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       [
                                       ln
                                       P
                                       
                                          (
                                          
                                             
                                                
                                                   o
                                                
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                ω
                                             
                                             
                                                k
                                             
                                          
                                          |
                                          
                                             
                                                λ
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                       −
                                       ln
                                       P
                                       
                                          (
                                          
                                             
                                                
                                                   o
                                                
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                ω
                                             
                                             
                                                k
                                             
                                          
                                          |
                                          
                                             
                                                λ
                                             
                                             
                                                j
                                             
                                          
                                          )
                                       
                                       ]
                                    
                                 
                              
                              
                                 (10)
                                 
                                    K
                                    
                                       
                                          L
                                       
                                       
                                          ∗
                                       
                                    
                                    
                                       (
                                       
                                          
                                             λ
                                          
                                          
                                             i
                                          
                                       
                                       |
                                       
                                          
                                             λ
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          
                                             
                                                d
                                             
                                             
                                                ∗
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   λ
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   λ
                                                
                                                
                                                   j
                                                
                                             
                                             )
                                          
                                          +
                                          
                                             
                                                d
                                             
                                             
                                                ∗
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   λ
                                                
                                                
                                                   j
                                                
                                             
                                             ,
                                             
                                                
                                                   λ
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                    .
                                 
                              
                           
                         The distance 
                           K
                           
                              
                                 L
                              
                              
                                 ∗
                              
                           
                           
                              (
                              
                                 
                                    λ
                                 
                                 
                                    i
                                 
                              
                              |
                              
                                 
                                    λ
                                 
                                 
                                    j
                                 
                              
                              )
                           
                         measures the dissimilarity between the distributions of motion data and motion words generated by the motion symbols 
                           
                              
                                 λ
                              
                              
                                 i
                              
                           
                         and 
                           
                              
                                 λ
                              
                              
                                 j
                              
                           
                        .

Only based on motion data, the average distance between motion symbols is 0.170 in a motion symbol space. The average distance in a motion symbol space based on both motion data and motion words results in 0.478. Note that the scaling operation is performed such that maximum distance can becomes 1 in each motion symbol space. A small distance between two motion symbols means that these motion symbols are close to each other, and a large distance means that one motion symbol is discriminated from the other. Therefore, the discrimination degree of motion symbols is improved by association probability between the motion symbols and the motion words. The association between the motion symbol and the motion words deforms the motion symbol spaces, and a discriminative topology of the motion symbols is generated.

99 same motion symbols as in previous experiments are located in 10 dimensional motion symbol space, and clustered into 20 groups. The symbol-transitions can be computed according to Eq. (9). Then, we can derive a symbol transition model based on cluster structure of the motion symbols, and apply this model to both computations of motion retrieval and motion generation.

The retrieval of motions corresponding to an untrained sequence of motion words is experimentally investigated. In this study, we give three sequences of motion words, “left_swing dash”, “dash sliding”, and “dash jump”. Note that there is no motion that is labeled with these sequences of motion words in the database, but that there are several motions that are labeled with “left_swing run”, “run sliding”, or “run jump” as shown in Table 1. Retrieved motion labeled with “run” is counted as True Positive (TP). For example, when “left_swing dash” is input, the motion labeled with “left_swing run” is retrieved and is counted as TP. Table 3
                         compares results of motion retrievals by using symbol-transition based on the cluster structure of the motion symbols with results by symbol-transitions which are modified through Back-Off smoothing. The Back-Off smoothing modifies the transition probabilities to the following: 
                           
                              
                                 
                                    
                                       P
                                    
                                    
                                       ˆ
                                    
                                 
                                 
                                    (
                                    
                                       
                                          λ
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    
                                       
                                          λ
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             γ
                                             P
                                             
                                                (
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      i
                                                   
                                                
                                                |
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      j
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             if  
                                             p
                                             
                                                (
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      i
                                                   
                                                
                                                |
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      j
                                                   
                                                
                                                )
                                             
                                             >
                                             0
                                          
                                       
                                       
                                          
                                             α
                                             P
                                             
                                                (
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             otherwise
                                          
                                       
                                    
                                 
                              
                           
                         where 
                           P
                           
                              (
                              
                                 
                                    λ
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         and 
                           P
                           
                              (
                              
                                 
                                    λ
                                 
                                 
                                    i
                                 
                              
                              |
                              
                                 
                                    λ
                                 
                                 
                                    j
                                 
                              
                              )
                           
                         are occurrence probability of the motion symbols 
                           
                              
                                 λ
                              
                              
                                 i
                              
                           
                         and the transition probability from the motion symbol 
                           
                              
                                 λ
                              
                              
                                 j
                              
                           
                         to the motion symbol 
                           
                              
                                 λ
                              
                              
                                 i
                              
                           
                        , that are derived according to conventional unigram and bigram models, respectively. 
                           
                              
                                 P
                              
                              
                                 ˆ
                              
                           
                           
                              (
                              
                                 
                                    λ
                                 
                                 
                                    i
                                 
                              
                              |
                              
                                 
                                    λ
                                 
                                 
                                    j
                                 
                              
                              )
                           
                         is derived transition probability. In this study, we set 
                           γ
                         to 0.90 empirically, and 
                           α
                         is a normalized variable which adjusts the sum of transition probabilities from a motion symbol to one. Recall for “left_swing run” by using the Back-Off smoothing is 10%, and Recall by using the cluster structure of motion symbols results in 33%. Recalls for “dash jump” by using the Back-Off smoothing and the cluster structure are 0% and 33% respectively. The cluster structure improves the Recall of motion retrieval. Precision for “dash jump” by using the Back-Off smoothing is 0%. Precision by using the cluster structure results in 50%. The experiments verify the validity of the cluster structure of the motion symbols for motion retrieval.

The generation of new motions corresponding to an untrained sequence of motion words by using cluster structure of motion symbols is also experimentally investigated. We provide an input “run sliding stand_up dash” to the database. No training sequences of motion words include the sequence “stand_up dash”. However, the sequence “stand_up run” is included in the training sequences of motion words. Fig. 11
                         shows the motion generated by the database based on the symbol-transition model with and without clustering motion symbols. The top figure in Fig. 11 shows that a character swings a bat, bends a little, and then stands still. On the other hand, the bottom figure in Fig. 11 shows that a character runs, slides, stands up and then tries to run. We can confirm that the database with the symbol-transition model established on clusters of motion symbols can generate motions in response to untrained sequences of motion words. This database makes an inference using similarities among motion symbols.

@&#CONCLUSION@&#

The contribution of this study can be summarized as follows. 
                        
                           1.
                           Motion database of captured motion data, motion symbols and motion words is established. The motion symbols are automatically assigned to the motion data through symbolization and classification of motion data. The motion words are manually combined with the motion data. This database makes it possible to retrieve motion data that is similar to input motion data. The input motion data is classified as motion symbols, and the database searches for motion data that are classified as same motion symbols as the input motion data.

The stochastic association between the motion symbols and the motion words, and the stochastic transitions among the motion symbols can be derived separately. The translation model is applied to the stochastic mapping between a sequence of motion symbols and a sequence of motion words. The integration of the association between the motion symbols and the motion words and transitions among the motion symbols provides two functions: motion retrieval and motion generation from motion words. The motion database allows the users to input a sequence of motion words corresponding to their desired motion. It converts the input motion words to multiple sequences of motion symbols. The motion retrieval processing searches for motion data that are recognized as same sequences of motion symbols. The motion generation processing creates a new motion data according to the sequences of motion symbols. Experiments on 537 captured motion data, 99 motion symbols and 64 motion words demonstrated the validities of proposed applications of motion retrieval and motion generation.

A cluster structure of motion symbols is applied to construct stochastic transitions among the motion symbols. The stochastic transitions among the motion symbols based on clusters of similar motion symbols allow to both retrieve and generate motions from input sequence of motion words that are not included in training dataset. Compared with the Back-Off smoothing which relaxes zero frequency of the transitions among motion symbols, experiments demonstrated the advantage of the proposed method based on cluster structure over the Back-Off smoothing. The proposed method improved both Recall and Precision of the motion retrieval.

@&#ACKNOWLEDGMENTS@&#

This research was supported by “The i-Explosion Project” of the Grant-in-Aid for Scientific Research on Priority Areas (19024024), the Ministry of Education, Culture, Sports, Science and Technology, and Grant-in-Aid for Young Scientists (A) (26700021), Japan Society for the Promotion of Science. We would like to thank Atsushi Shiozawa, Toshio Murata, and Sumio Ito of Bandai Namco Corporation for letting us use their motion capture dataset.

Given not only a pair of a sentence 
                        
                           e
                        
                      in a source language and a sentence 
                        
                           f
                        
                      in a target language but also the alignment 
                        
                           a
                        
                      between sentences 
                        
                           e
                        
                      and 
                        
                           f
                        
                     , the likelihood 
                        P
                        
                           (
                           
                              f
                           
                           |
                           
                              e
                           
                           )
                        
                      that 
                        
                           e
                        
                      is translated into 
                        
                           f
                        
                      can be calculated as the sum of the conditional probability 
                        P
                        
                           (
                           
                              f
                           
                           ,
                           
                              a
                           
                           ,
                           |
                           
                              e
                           
                           )
                        
                      that 
                        
                           e
                        
                      is translated into 
                        
                           f
                        
                      and the alignment between 
                        
                           e
                        
                      and 
                        
                           f
                        
                      is 
                        
                           a
                        
                     , as given by Eq. (A.1). The alignment indicates a word in the sentence 
                        
                           e
                        
                      from which each word in the sentence 
                        
                           f
                        
                      arises stochastically. 
                        
                           (A.1)
                           
                              P
                              
                                 (
                                 
                                    f
                                 
                                 |
                                 
                                    e
                                 
                                 )
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    
                                       a
                                    
                                 
                              
                              P
                              
                                 (
                                 
                                    f
                                 
                                 ,
                                 
                                    a
                                 
                                 ,
                                 |
                                 
                                    e
                                 
                                 )
                              
                              .
                           
                        
                      Moreover, the conditional probability 
                        P
                        
                           (
                           
                              f
                           
                           ,
                           
                              a
                           
                           ,
                           |
                           
                              e
                           
                           )
                        
                      can be written as 
                        
                           (A.2)
                           
                              P
                              
                                 (
                                 
                                    f
                                 
                                 ,
                                 
                                    a
                                 
                                 ,
                                 |
                                 
                                    e
                                 
                                 )
                              
                              =
                              P
                              
                                 (
                                 m
                                 |
                                 
                                    e
                                 
                                 )
                              
                              
                                 
                                    ∏
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    m
                                 
                              
                              P
                              
                                 (
                                 
                                    
                                       a
                                    
                                    
                                       j
                                    
                                 
                                 |
                                 
                                    
                                       a
                                    
                                    
                                       1
                                    
                                    
                                       j
                                       −
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                    
                                       j
                                       −
                                       1
                                    
                                 
                                 ,
                                 m
                                 ,
                                 
                                    e
                                 
                                 )
                              
                              P
                              
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       j
                                    
                                 
                                 |
                                 
                                    
                                       a
                                    
                                    
                                       1
                                    
                                    
                                       j
                                    
                                 
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                    
                                       j
                                       −
                                       1
                                    
                                 
                                 ,
                                 m
                                 ,
                                 
                                    e
                                 
                                 )
                              
                           
                        
                      where 
                        
                           
                              a
                           
                           
                              1
                           
                           
                              j
                           
                        
                        =
                        
                           
                              a
                           
                           
                              1
                           
                        
                        
                           
                              a
                           
                           
                              2
                           
                        
                        ⋯
                        
                           
                              a
                           
                           
                              j
                           
                        
                      and 
                        
                           
                              f
                           
                           
                              1
                           
                           
                              j
                           
                        
                        =
                        
                           
                              f
                           
                           
                              1
                           
                        
                        
                           
                              f
                           
                           
                              2
                           
                        
                        ⋯
                        
                           
                              f
                           
                           
                              j
                           
                        
                     . For instance, if the source sentence 
                        
                           e
                        
                        =
                        
                           
                              e
                           
                           
                              1
                           
                        
                        
                           
                              e
                           
                           
                              2
                           
                        
                        ⋯
                        
                           
                              e
                           
                           
                              l
                           
                        
                      has 
                        l
                      words and the target sentence 
                        
                           f
                        
                        =
                        
                           
                              f
                           
                           
                              1
                           
                        
                        
                           
                              f
                           
                           
                              2
                           
                        
                        ⋯
                        
                           
                              f
                           
                           
                              m
                           
                        
                      has 
                        m
                      words, then the alignment 
                        
                           a
                        
                      can be expressed by a series of 
                        m
                      values, 
                        
                           
                              a
                           
                           
                              1
                           
                           
                              m
                           
                        
                        =
                        
                           
                              a
                           
                           
                              1
                           
                        
                        
                           
                              a
                           
                           
                              2
                           
                        
                        ⋯
                        
                           
                              a
                           
                           
                              m
                           
                        
                     , where each value gets the position of a specified word in the source words such that if the word at position 
                        j
                      in the target sentence is connected to the word at position 
                        i
                      in the source sentence, 
                        
                           
                              a
                           
                           
                              j
                           
                        
                        =
                        i
                     . Eq. (A.2) is based on the assumptions (1) that the length of the target sentence depends on the source sentence; (2) that the position in the source sentence, which the word at position 
                        j
                      in the target sentence connects to, depends on a series of words 
                        
                           
                              f
                           
                           
                              1
                           
                           
                              j
                              −
                              1
                           
                        
                      and a series of connections 
                        
                           
                              a
                           
                           
                              1
                           
                           
                              j
                              −
                              1
                           
                        
                     ; and (3) that the word at position 
                        j
                      in the target sentence depends on a series of connections 
                        
                           
                              a
                           
                           
                              1
                           
                           
                              j
                           
                        
                      and a series of words 
                        
                           
                              f
                           
                           
                              1
                           
                           
                              j
                              −
                              1
                           
                        
                     .

In model 1, we assume that 
                        P
                        
                           (
                           m
                           |
                           
                              e
                           
                           )
                        
                      is independent of 
                        m
                      and 
                        
                           e
                        
                     , that 
                        P
                        
                           (
                           
                              
                                 a
                              
                              
                                 j
                              
                           
                           |
                           
                              
                                 a
                              
                              
                                 1
                              
                              
                                 j
                                 −
                                 1
                              
                           
                           ,
                           
                              
                                 f
                              
                              
                                 1
                              
                              
                                 j
                                 −
                                 1
                              
                           
                           ,
                           m
                           ,
                           
                              e
                           
                           )
                        
                      depends only on the length of the source sentence, and that 
                        P
                        
                           (
                           
                              
                                 f
                              
                              
                                 j
                              
                           
                           |
                           
                              
                                 a
                              
                              
                                 1
                              
                              
                                 j
                              
                           
                           ,
                           
                              
                                 f
                              
                              
                                 1
                              
                              
                                 j
                                 −
                                 1
                              
                           
                           ,
                           m
                           ,
                           
                              e
                           
                           )
                        
                      depends only on 
                        
                           
                              f
                           
                           
                              j
                           
                        
                      and 
                        
                           
                              e
                           
                           
                              
                                 
                                    a
                                 
                                 
                                    j
                                 
                              
                           
                        
                     . Therefore, we write Eq. (A.2) as follows: 
                        
                           (A.3)
                           
                              P
                              
                                 (
                                 
                                    f
                                 
                                 ,
                                 
                                    a
                                 
                                 ,
                                 |
                                 
                                    e
                                 
                                 )
                              
                              =
                              
                                 
                                    ϵ
                                 
                                 
                                    
                                       
                                          
                                             (
                                             l
                                             +
                                             1
                                             )
                                          
                                       
                                       
                                          m
                                       
                                    
                                 
                              
                              
                                 
                                    ∏
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    m
                                 
                              
                              t
                              
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       j
                                    
                                 
                                 |
                                 
                                    
                                       e
                                    
                                    
                                       
                                          
                                             a
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                                 )
                              
                           
                        
                      where 
                        t
                        
                           (
                           
                              
                                 f
                              
                              
                                 j
                              
                           
                           |
                           
                              
                                 e
                              
                              
                                 
                                    
                                       a
                                    
                                    
                                       j
                                    
                                 
                              
                           
                           )
                        
                      is called the transition probability. 
                        P
                        
                           (
                           
                              f
                           
                           |
                           
                              e
                           
                           )
                        
                      is transformed into the following form using Eq. (A.1): 
                        
                           
                              (A.4)
                              
                                 P
                                 
                                    (
                                    
                                       f
                                    
                                    |
                                    
                                       e
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       ϵ
                                    
                                    
                                       
                                          
                                             
                                                (
                                                l
                                                +
                                                1
                                                )
                                             
                                          
                                          
                                             m
                                          
                                       
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             a
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       0
                                    
                                    
                                       l
                                    
                                 
                                 ⋯
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             a
                                          
                                          
                                             m
                                          
                                       
                                       =
                                       0
                                    
                                    
                                       l
                                    
                                 
                                 
                                    
                                       ∏
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       m
                                    
                                 
                                 t
                                 
                                    (
                                    
                                       
                                          f
                                       
                                       
                                          j
                                       
                                    
                                    |
                                    
                                       
                                          e
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    )
                                 
                              
                           
                           
                              (A.5)
                              
                                 =
                                 
                                    
                                       ϵ
                                    
                                    
                                       
                                          
                                             
                                                (
                                                l
                                                +
                                                1
                                                )
                                             
                                          
                                          
                                             m
                                          
                                       
                                    
                                 
                                 
                                    
                                       ∏
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       m
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       l
                                    
                                 
                                 t
                                 
                                    (
                                    
                                       
                                          f
                                       
                                       
                                          j
                                       
                                    
                                    |
                                    
                                       
                                          e
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                        
                      From Eq. (A.1), 
                        P
                        
                           (
                           
                              f
                           
                           |
                           
                              e
                           
                           )
                        
                      is represented as follows: 
                        
                           
                              (A.6)
                              
                                 P
                                 
                                    (
                                    
                                       f
                                    
                                    |
                                    
                                       e
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       ϵ
                                    
                                    
                                       
                                          
                                             
                                                (
                                                l
                                                +
                                                1
                                                )
                                             
                                          
                                          
                                             m
                                          
                                       
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             a
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       0
                                    
                                    
                                       l
                                    
                                 
                                 ⋯
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             a
                                          
                                          
                                             m
                                          
                                       
                                       =
                                       0
                                    
                                    
                                       l
                                    
                                 
                                 
                                    
                                       ∏
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       m
                                    
                                 
                                 t
                                 
                                    (
                                    
                                       
                                          f
                                       
                                       
                                          j
                                       
                                    
                                    |
                                    
                                       
                                          e
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    )
                                 
                              
                           
                           
                              (A.7)
                              
                                 =
                                 
                                    
                                       ϵ
                                    
                                    
                                       
                                          
                                             
                                                (
                                                l
                                                +
                                                1
                                                )
                                             
                                          
                                          
                                             m
                                          
                                       
                                    
                                 
                                 
                                    
                                       ∏
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       m
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       l
                                    
                                 
                                 t
                                 
                                    (
                                    
                                       
                                          f
                                       
                                       
                                          j
                                       
                                    
                                    |
                                    
                                       
                                          e
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                        
                      We adjust the translation probabilities so as to maximize 
                        P
                        
                           (
                           
                              f
                           
                           |
                           
                              e
                           
                           )
                        
                      subject to the constraints that 
                        
                           
                              ∑
                           
                           
                              f
                           
                        
                        t
                        
                           (
                           f
                           |
                           e
                           )
                        
                        =
                        1
                      for each 
                        e
                     . We introduce Lagrange multipliers 
                        
                           
                              λ
                           
                           
                              e
                           
                        
                      and find out an unconstrained extremum of the following auxiliary function 
                        
                           (A.8)
                           
                              h
                              
                                 (
                                 t
                                 ,
                                 
                                    λ
                                 
                                 )
                              
                              =
                              
                                 
                                    ϵ
                                 
                                 
                                    
                                       
                                          
                                             (
                                             l
                                             +
                                             1
                                             )
                                          
                                       
                                       
                                          m
                                       
                                    
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    
                                       
                                          a
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    0
                                 
                                 
                                    l
                                 
                              
                              ⋯
                              
                                 
                                    ∑
                                 
                                 
                                    
                                       
                                          a
                                       
                                       
                                          m
                                       
                                    
                                    =
                                    0
                                 
                                 
                                    l
                                 
                              
                              
                                 
                                    ∏
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    m
                                 
                              
                              t
                              
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       j
                                    
                                 
                                 |
                                 
                                    
                                       e
                                    
                                    
                                       
                                          
                                             a
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                                 )
                              
                              −
                              
                                 
                                    ∑
                                 
                                 
                                    e
                                 
                              
                              
                                 
                                    λ
                                 
                                 
                                    e
                                 
                              
                              
                                 (
                                 
                                    
                                       ∑
                                    
                                    
                                       f
                                    
                                 
                                 t
                                 
                                    (
                                    f
                                    |
                                    e
                                    )
                                 
                                 −
                                 1
                                 )
                              
                              .
                           
                        
                     
                  

An extremum occurs when all of the partial derivatives of 
                        h
                      with respect to the components of 
                        t
                        
                           (
                           f
                           |
                           e
                           )
                        
                      are zero. The partial derivative of 
                        h
                      with respect to 
                        t
                        
                           (
                           f
                           |
                           e
                           )
                        
                      is calculated as 
                        
                           (A.9)
                           
                              
                                 
                                    ∂
                                    h
                                 
                                 
                                    ∂
                                    t
                                    
                                       (
                                       f
                                       |
                                       e
                                       )
                                    
                                 
                              
                              =
                              
                                 
                                    ϵ
                                 
                                 
                                    
                                       
                                          
                                             (
                                             l
                                             +
                                             1
                                             )
                                          
                                       
                                       
                                          m
                                       
                                    
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    
                                       
                                          a
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    0
                                 
                                 
                                    l
                                 
                              
                              ⋯
                              
                                 
                                    ∑
                                 
                                 
                                    
                                       
                                          a
                                       
                                       
                                          m
                                       
                                    
                                    =
                                    0
                                 
                                 
                                    l
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    m
                                 
                              
                              δ
                              
                                 (
                                 f
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       j
                                    
                                 
                                 )
                              
                              δ
                              
                                 (
                                 e
                                 ,
                                 
                                    
                                       e
                                    
                                    
                                       
                                          
                                             a
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                                 )
                              
                              
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          m
                                       
                                    
                                    t
                                    
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             k
                                          
                                       
                                       |
                                       
                                          
                                             e
                                          
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                       )
                                    
                                 
                                 
                                    t
                                    
                                       (
                                       f
                                       |
                                       e
                                       )
                                    
                                 
                              
                              −
                              
                                 
                                    λ
                                 
                                 
                                    e
                                 
                              
                              =
                              0
                              .
                           
                        
                      Therefore, the translation probability can be expressed as follows: 
                        
                           
                              (A.10)
                              
                                 t
                                 
                                    (
                                    f
                                    |
                                    e
                                    )
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             e
                                          
                                       
                                    
                                 
                                 
                                    
                                       ϵ
                                    
                                    
                                       
                                          
                                             
                                                (
                                                l
                                                +
                                                1
                                                )
                                             
                                          
                                          
                                             m
                                          
                                       
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             a
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       0
                                    
                                    
                                       l
                                    
                                 
                                 ⋯
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             a
                                          
                                          
                                             m
                                          
                                       
                                       =
                                       0
                                    
                                    
                                       l
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       m
                                    
                                 
                                 δ
                                 
                                    (
                                    f
                                    ,
                                    
                                       
                                          f
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                                 δ
                                 
                                    (
                                    e
                                    ,
                                    
                                       
                                          e
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    )
                                 
                                 
                                    
                                       ∏
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       m
                                    
                                 
                                 t
                                 
                                    (
                                    
                                       
                                          f
                                       
                                       
                                          k
                                       
                                    
                                    |
                                    
                                       
                                          e
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                    )
                                 
                              
                           
                           
                              (A.11)
                              
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             e
                                          
                                       
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       a
                                    
                                 
                                 P
                                 
                                    (
                                    
                                       f
                                    
                                    ,
                                    
                                       a
                                    
                                    |
                                    
                                       e
                                    
                                    )
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       m
                                    
                                 
                                 δ
                                 
                                    (
                                    f
                                    ,
                                    
                                       
                                          f
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                                 δ
                                 
                                    (
                                    e
                                    ,
                                    
                                       
                                          e
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                        
                      Moreover, we calculate the expected number of times that 
                        e
                      connects to 
                        f
                      as 
                        
                           (A.12)
                           
                              C
                              
                                 (
                                 f
                                 |
                                 e
                                 ;
                                 
                                    f
                                 
                                 ,
                                 
                                    e
                                 
                                 )
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    a
                                 
                              
                              P
                              
                                 (
                                 
                                    a
                                 
                                 |
                                 
                                    f
                                 
                                 ,
                                 
                                    e
                                 
                                 )
                              
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    m
                                 
                              
                              δ
                              
                                 (
                                 f
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       j
                                    
                                 
                                 )
                              
                              δ
                              
                                 (
                                 e
                                 ,
                                 
                                    
                                       e
                                    
                                    
                                       
                                          
                                             a
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                                 )
                              
                           
                        
                      where 
                        C
                        
                           (
                           f
                           |
                           e
                           ;
                           
                              f
                           
                           ,
                           
                              e
                           
                           )
                        
                      denotes the expected number.

Eqs. (A.11) and (A.12) provide 
                        t
                        
                           (
                           f
                           |
                           e
                           )
                        
                     : 
                        
                           (A.13)
                           
                              t
                              
                                 (
                                 f
                                 |
                                 e
                                 )
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          e
                                       
                                    
                                 
                              
                              P
                              
                                 (
                                 
                                    f
                                 
                                 |
                                 
                                    e
                                 
                                 )
                              
                              C
                              
                                 (
                                 f
                                 |
                                 e
                                 ;
                                 
                                    f
                                 
                                 ,
                                 
                                    e
                                 
                                 )
                              
                              .
                           
                        
                      We also apply the Lagrange multiplier method to Eq. (A.7). 
                        
                           (A.14)
                           
                              
                                 
                                    ∂
                                    h
                                 
                                 
                                    ∂
                                    t
                                    
                                       (
                                       f
                                       |
                                       e
                                       )
                                    
                                 
                              
                              =
                              
                                 
                                    ϵ
                                 
                                 
                                    
                                       
                                          
                                             (
                                             l
                                             +
                                             1
                                             )
                                          
                                       
                                       
                                          m
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          m
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          l
                                       
                                    
                                    t
                                    
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             j
                                          
                                       
                                       |
                                       
                                          
                                             e
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          l
                                       
                                    
                                    t
                                    
                                       (
                                       f
                                       |
                                       
                                          
                                             e
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    m
                                 
                              
                              δ
                              
                                 (
                                 f
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       j
                                    
                                 
                                 )
                              
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    0
                                 
                                 
                                    l
                                 
                              
                              δ
                              
                                 (
                                 e
                                 ,
                                 
                                    
                                       e
                                    
                                    
                                       j
                                    
                                 
                                 )
                              
                              −
                              
                                 
                                    λ
                                 
                                 
                                    e
                                 
                              
                              =
                              0
                              .
                           
                        
                      This leads to the following equation: 
                        
                           (A.15)
                           
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          e
                                       
                                    
                                 
                              
                              P
                              
                                 (
                                 
                                    f
                                 
                                 |
                                 
                                    e
                                 
                                 )
                              
                              =
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          l
                                       
                                    
                                    t
                                    
                                       (
                                       f
                                       |
                                       
                                          
                                             e
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          m
                                       
                                    
                                    δ
                                    
                                       (
                                       f
                                       ,
                                       
                                          
                                             f
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          l
                                       
                                    
                                    δ
                                    
                                       (
                                       e
                                       ,
                                       
                                          
                                             e
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                 
                              
                              .
                           
                        
                      Eq. (A.13) can be written compactly using Eq. (A.15). 
                        
                           (A.16)
                           
                              C
                              
                                 (
                                 f
                                 |
                                 e
                                 ;
                                 
                                    f
                                 
                                 ,
                                 
                                    e
                                 
                                 )
                              
                              =
                              
                                 
                                    t
                                    
                                       (
                                       f
                                       |
                                       e
                                       )
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          m
                                       
                                    
                                    δ
                                    
                                       (
                                       f
                                       ,
                                       
                                          
                                             f
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          l
                                       
                                    
                                    δ
                                    
                                       (
                                       e
                                       ,
                                       
                                          
                                             e
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          l
                                       
                                    
                                    t
                                    
                                       (
                                       f
                                       |
                                       
                                          
                                             e
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                 
                              
                              .
                           
                        
                      In Eq. (A.11), the condition that the sum of the translation probabilities over every 
                        f
                      is equal to 1 leads to 
                        
                           (A.17)
                           
                              
                                 
                                    λ
                                 
                                 
                                    e
                                 
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    f
                                 
                              
                              C
                              
                                 (
                                 f
                                 |
                                 e
                                 ;
                                 
                                    f
                                 
                                 ,
                                 
                                    e
                                 
                                 )
                              
                           
                        
                      where we replace 
                        
                           
                              
                                 
                                    λ
                                 
                                 
                                    e
                                 
                              
                           
                           
                              P
                              
                                 (
                                 
                                    f
                                 
                                 |
                                 
                                    e
                                 
                                 )
                              
                           
                        
                      with 
                        
                           
                              λ
                           
                           
                              e
                           
                        
                     . Finally, the optimum translation probability can be estimated using Eqs. (A.11) and (A.17). 
                        
                           (A.18)
                           
                              t
                              
                                 (
                                 f
                                 |
                                 e
                                 )
                              
                              =
                              
                                 
                                    C
                                    
                                       (
                                       f
                                       |
                                       e
                                       ;
                                       
                                          f
                                       
                                       ,
                                       
                                          e
                                       
                                       )
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          f
                                       
                                    
                                    C
                                    
                                       (
                                       f
                                       |
                                       e
                                       ;
                                       
                                          f
                                       
                                       ,
                                       
                                          e
                                       
                                       )
                                    
                                 
                              
                              .
                           
                        
                      The successive iteration of these processes optimizes the translation probability.

Although we assume that all the alignment probabilities for a specified length of the source sentence are the same, the position of the word that connects to the word at position 
                        j
                      in the target sentence depends on the position in the source sentence, length of the source sentence, and length of the target sentence. 
                        
                           (B.1)
                           
                              P
                              
                                 (
                                 
                                    
                                       a
                                    
                                    
                                       j
                                    
                                 
                                 |
                                 
                                    
                                       a
                                    
                                    
                                       1
                                    
                                    
                                       j
                                       −
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                    
                                       j
                                       −
                                       1
                                    
                                 
                                 ,
                                 m
                                 ,
                                 
                                    e
                                 
                                 )
                              
                              =
                              a
                              
                                 (
                                 
                                    
                                       a
                                    
                                    
                                       j
                                    
                                 
                                 |
                                 j
                                 ,
                                 m
                                 ,
                                 l
                                 )
                              
                           
                        
                      where 
                        a
                        
                           (
                           
                              
                                 a
                              
                              
                                 j
                              
                           
                           |
                           j
                           ,
                           m
                           ,
                           l
                           )
                        
                      is called the alignment probability. 
                        P
                        
                           (
                           
                              f
                           
                           |
                           
                              e
                           
                           )
                        
                      is represented by using Eq. (B.1). 
                        
                           
                              (B.2)
                              
                                 P
                                 
                                    (
                                    
                                       f
                                    
                                    |
                                    
                                       e
                                    
                                    )
                                 
                                 =
                                 ϵ
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             a
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       0
                                    
                                    
                                       l
                                    
                                 
                                 ⋯
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             a
                                          
                                          
                                             m
                                          
                                       
                                       =
                                       0
                                    
                                    
                                       l
                                    
                                 
                                 
                                    
                                       ∏
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       m
                                    
                                 
                                 t
                                 
                                    (
                                    
                                       
                                          f
                                       
                                       
                                          j
                                       
                                    
                                    |
                                    
                                       
                                          e
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    )
                                 
                                 a
                                 
                                    (
                                    
                                       
                                          a
                                       
                                       
                                          j
                                       
                                    
                                    |
                                    j
                                    ,
                                    m
                                    ,
                                    l
                                    )
                                 
                              
                           
                           
                              (B.3)
                              
                                 =
                                 ϵ
                                 
                                    
                                       ∏
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       m
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       l
                                    
                                 
                                 t
                                 
                                    (
                                    
                                       
                                          f
                                       
                                       
                                          j
                                       
                                    
                                    |
                                    
                                       
                                          e
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    )
                                 
                                 a
                                 
                                    (
                                    
                                       
                                          a
                                       
                                       
                                          j
                                       
                                    
                                    |
                                    j
                                    ,
                                    m
                                    ,
                                    l
                                    )
                                 
                                 .
                              
                           
                        
                      We adjust the translation probabilities and the alignment probabilities so as to maximize 
                        P
                        
                           (
                           
                              f
                           
                           |
                           
                              e
                           
                           )
                        
                      subject to the following two constraints: 
                        
                           
                              ∑
                           
                           
                              f
                           
                        
                        t
                        
                           (
                           f
                           |
                           e
                           )
                        
                        =
                        1
                      and 
                        
                           
                              ∑
                           
                           
                              i
                              =
                              0
                           
                           
                              l
                           
                        
                        a
                        
                           (
                           i
                           |
                           j
                           ,
                           m
                           ,
                           l
                           )
                        
                        =
                        1
                     . We introduce Lagrange multipliers 
                        
                           λ
                        
                      and 
                        
                           μ
                        
                      to seek an unconstrained extremum of the following auxiliary function as well as in model 1: 
                        
                           (B.4)
                           
                              h
                              
                                 (
                                 t
                                 ,
                                 a
                                 ,
                                 
                                    λ
                                 
                                 ,
                                 
                                    μ
                                 
                                 )
                              
                              =
                              P
                              
                                 (
                                 
                                    f
                                 
                                 |
                                 
                                    e
                                 
                                 )
                              
                              −
                              
                                 
                                    ∑
                                 
                                 
                                    e
                                 
                              
                              
                                 
                                    λ
                                 
                                 
                                    e
                                 
                              
                              
                                 (
                                 
                                    
                                       ∑
                                    
                                    
                                       f
                                    
                                 
                                 t
                                 
                                    (
                                    f
                                    |
                                    e
                                    )
                                 
                                 −
                                 1
                                 )
                              
                              −
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                 
                              
                              
                                 
                                    μ
                                 
                                 
                                    j
                                    m
                                    l
                                 
                              
                              
                                 (
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                    
                                 
                                 a
                                 
                                    (
                                    i
                                    |
                                    j
                                    ,
                                    m
                                    ,
                                    l
                                    )
                                 
                                 −
                                 1
                                 )
                              
                              .
                           
                        
                      The partial derivative of 
                        h
                        
                           (
                           t
                           ,
                           a
                           ,
                           
                              λ
                           
                           ,
                           
                              μ
                           
                           )
                        
                      with respect to 
                        t
                        
                           (
                           f
                           |
                           e
                           )
                        
                     , as in model 1, provides the optimum estimated translation probability as follows: 
                        
                           
                              (B.5)
                              
                                 C
                                 
                                    (
                                    f
                                    |
                                    e
                                    ;
                                    
                                       f
                                    
                                    ,
                                    
                                       e
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       m
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       l
                                    
                                 
                                 
                                    
                                       t
                                       
                                          (
                                          f
                                          |
                                          e
                                          )
                                       
                                       a
                                       
                                          (
                                          i
                                          |
                                          j
                                          ,
                                          m
                                          ,
                                          l
                                          )
                                       
                                       δ
                                       
                                          (
                                          f
                                          ,
                                          
                                             
                                                f
                                             
                                             
                                                j
                                             
                                          
                                          )
                                       
                                       δ
                                       
                                          (
                                          e
                                          ,
                                          
                                             
                                                e
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                    
                                    
                                       t
                                       
                                          (
                                          f
                                          |
                                          
                                             
                                                e
                                             
                                             
                                                0
                                             
                                          
                                          )
                                       
                                       a
                                       
                                          (
                                          0
                                          |
                                          j
                                          ,
                                          m
                                          ,
                                          l
                                          )
                                       
                                       +
                                       ⋯
                                       +
                                       t
                                       
                                          (
                                          f
                                          |
                                          
                                             
                                                e
                                             
                                             
                                                l
                                             
                                          
                                          )
                                       
                                       a
                                       
                                          (
                                          l
                                          |
                                          j
                                          ,
                                          m
                                          ,
                                          l
                                          )
                                       
                                    
                                 
                              
                           
                           
                              (B.6)
                              
                                 t
                                 
                                    (
                                    f
                                    |
                                    e
                                    )
                                 
                                 =
                                 
                                    
                                       C
                                       
                                          (
                                          f
                                          |
                                          e
                                          ;
                                          
                                             f
                                          
                                          ,
                                          
                                             e
                                          
                                          )
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             f
                                          
                                       
                                       C
                                       
                                          (
                                          f
                                          |
                                          e
                                          ;
                                          
                                             f
                                          
                                          ,
                                          
                                             e
                                          
                                          )
                                       
                                    
                                 
                                 .
                              
                           
                        
                     
                  

Next, from Eq. (B.2), the partial derivative of 
                        h
                        
                           (
                           t
                           ,
                           a
                           ,
                           
                              λ
                           
                           ,
                           
                              μ
                           
                           )
                        
                      with respect to the alignment probability 
                        a
                        
                           (
                           i
                           |
                           j
                           ,
                           m
                           ,
                           l
                           )
                        
                      will be zero provided that 
                        
                           
                              (B.7)
                              
                                 a
                                 
                                    (
                                    i
                                    |
                                    j
                                    ,
                                    m
                                    ,
                                    l
                                    )
                                 
                                 =
                                 
                                    
                                       P
                                       
                                          (
                                          
                                             f
                                          
                                          |
                                          
                                             e
                                          
                                          )
                                       
                                    
                                    
                                       
                                          
                                             μ
                                          
                                          
                                             j
                                             m
                                             l
                                          
                                       
                                    
                                 
                                 C
                                 
                                    (
                                    i
                                    |
                                    j
                                    ,
                                    m
                                    ,
                                    l
                                    ;
                                    
                                       f
                                    
                                    ,
                                    
                                       e
                                    
                                    )
                                 
                              
                           
                           
                              (B.8)
                              
                                 C
                                 
                                    (
                                    i
                                    |
                                    j
                                    ,
                                    m
                                    ,
                                    l
                                    ;
                                    
                                       f
                                    
                                    ,
                                    
                                       e
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          a
                                       
                                    
                                 
                                 P
                                 
                                    (
                                    
                                       a
                                    
                                    |
                                    
                                       e
                                    
                                    ,
                                    
                                       f
                                    
                                    )
                                 
                                 δ
                                 
                                    (
                                    i
                                    ,
                                    
                                       
                                          a
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                              
                           
                        
                     
                     
                        C
                        
                           (
                           i
                           |
                           j
                           ,
                           m
                           ,
                           l
                           ;
                           
                              f
                           
                           ,
                           
                              e
                           
                           )
                        
                      denotes the expected number of times that the word at position 
                        i
                      in the source sentence connects to the word at position 
                        j
                      in the target sentence.

Moreover, the partial derivative of 
                        h
                        
                           (
                           t
                           ,
                           a
                           ,
                           
                              λ
                           
                           ,
                           
                              μ
                           
                           )
                        
                      in the form of Eq. (B.3) with respect to the alignment probability 
                        a
                        
                           (
                           i
                           |
                           j
                           ,
                           m
                           ,
                           l
                           )
                        
                      gives the following equation under the condition that the partial derivative is zero. 
                        
                           (B.9)
                           
                              
                                 
                                    P
                                    
                                       (
                                       
                                          f
                                       
                                       |
                                       
                                          e
                                       
                                       )
                                    
                                 
                                 
                                    
                                       
                                          μ
                                       
                                       
                                          j
                                          m
                                          l
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          l
                                       
                                    
                                    t
                                    
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             j
                                          
                                       
                                       |
                                       
                                          
                                             e
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    a
                                    
                                       (
                                       i
                                       |
                                       j
                                       ,
                                       m
                                       ,
                                       l
                                       )
                                    
                                 
                                 
                                    t
                                    
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             j
                                          
                                       
                                       |
                                       
                                          
                                             e
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        
                     
                     
                        C
                        
                           (
                           i
                           |
                           j
                           ,
                           m
                           ,
                           l
                           ;
                           
                              f
                           
                           ,
                           
                              e
                           
                           )
                        
                      can be written in the following form from Eqs. (B.7) and (B.9): 
                        
                           (B.10)
                           
                              C
                              
                                 (
                                 i
                                 |
                                 j
                                 ,
                                 m
                                 ,
                                 l
                                 ;
                                 
                                    f
                                 
                                 ,
                                 
                                    e
                                 
                                 )
                              
                              =
                              
                                 
                                    t
                                    
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             j
                                          
                                       
                                       |
                                       
                                          
                                             e
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    a
                                    
                                       (
                                       i
                                       |
                                       j
                                       ,
                                       m
                                       ,
                                       l
                                       )
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          l
                                       
                                    
                                    t
                                    
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             j
                                          
                                       
                                       |
                                       
                                          
                                             e
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    a
                                    
                                       (
                                       i
                                       |
                                       j
                                       ,
                                       m
                                       ,
                                       l
                                       )
                                    
                                 
                              
                              .
                           
                        
                      Based on the condition 
                        
                           
                              ∑
                           
                           
                              i
                              =
                              0
                           
                           
                              l
                           
                        
                        a
                        
                           (
                           i
                           |
                           j
                           ,
                           m
                           ,
                           l
                           )
                        
                        =
                        1
                     , Eq. (B.7) can be used to estimate the optimum alignment probability. 
                        
                           (B.11)
                           
                              a
                              
                                 (
                                 i
                                 |
                                 j
                                 ,
                                 m
                                 ,
                                 l
                                 )
                              
                              =
                              
                                 
                                    C
                                    
                                       (
                                       i
                                       |
                                       j
                                       ,
                                       m
                                       ,
                                       l
                                       ;
                                       
                                          f
                                       
                                       ,
                                       
                                          e
                                       
                                       )
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          l
                                       
                                    
                                    C
                                    
                                       (
                                       i
                                       |
                                       j
                                       ,
                                       m
                                       ,
                                       l
                                       ;
                                       
                                          f
                                       
                                       ,
                                       
                                          e
                                       
                                       )
                                    
                                 
                              
                              .
                           
                        
                      The successive iteration of these processes optimizes the translation probabilities and the alignment probabilities.

@&#REFERENCES@&#

