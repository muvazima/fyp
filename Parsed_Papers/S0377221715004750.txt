@&#MAIN-TITLE@&#Electricity futures price models: Calibration and forecasting

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A new random volatility model is proposed for pricing electricity futures.


                        
                        
                           
                           The new model is far easier to calibrate than two factor models.


                        
                        
                           
                           A new calibration procedure is also suggested for two factor models.


                        
                        
                           
                           Numerical experiments with real data show the utility of the new model.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Electricity derivatives

Jump diffusion models

@&#ABSTRACT@&#


               
               
                  A new one factor model with a random volatility parameter is presented in this paper for pricing of electricity futures contracts. It is shown that the model is more tractable than multi-factor jump diffusion models and yields an approximate closed-form pricing formula for the electricity futures prices. On real market data, it is shown that the performance of the new model compares favourably with two existing models in the literature, viz. a two factor jump diffusion model and its jump free version, i.e., a two factor linear Gaussian model, in terms of ability to predict one day ahead futures prices. Further, a multi-stage procedure is suggested and implemented for calibration of the two factor jump diffusion model, which alleviates the difficulty in calibration due to a large number of parameters and pricing formulae which involve numerical evaluation of integrals. We demonstrate the utility of our new model, as well as the utility of the calibration procedure for the existing two factor jump diffusion model, by model calibration and price forecasting experiments on three different futures price data sets from Nord pool electricity data. For the jump diffusion model, we also investigate empirically whether it performs better in terms of futures price prediction than a corresponding, jump-free linear Gaussian model. Finally, we investigate whether an explicit calibration of jump risk premium in the jump diffusion model adds value to the quality of futures price prediction. Our experiments do not yield any evidence that modelling jumps leads to a better price prediction in electricity markets.
               
            

@&#INTRODUCTION@&#

The modelling of security prices in any de-regulated electricity markets remains a challenge for economists and risk managers due to its specific features. As a non-storable commodity, the spot electricity is traded one day ahead. The spot and forward prices of electricity are quite volatile and their evolution needs to be modelled accurately in order to price electricity derivatives and to manage the risk of portfolios of such derivatives. Two interesting characteristics of the electricity spot price time series are the existence of non-trivial price spikes and a reversion to the mean around a level which relates to the production costs. Various modern approaches to model this behaviour have been suggested. Broadly speaking, there are two different classes of electricity price models. One class deals with the price formation based on the fundamental components of the electricity market (see, e.g. 
                     Harris, 2006) and is relevant in economic planning. The other class of electricity models treats the prices as exogenous and is relevant in financial mathematics, principally for pricing financial derivatives and for short term forecasting of spot and futures prices. The emphasis of this paper is on such exogenous price models. In these types of models, a common way to model price spikes is to use a compound Poisson process coupled with an Ornstein–Ulenbeck process for de-seasonalised spot price, thus giving a jump diffusion model; see Deng (2000), Sáez, Pena, and Villaplana (2002), Villaplana (2003), Weron, Simonsen, and Wilman (2004) and Cartea and Figueroa (2005), among others. In contrast, a jump regime switching model was developed in Huisman and Mahieu (2003), which uses the hypothesis that log spot price switches between multiple linear Gaussian processes with a constant one period transition probability matrix. A regime switching threshold is also used by Geman and Roncoroni (2003, 2006) to force negative jumps if the price exceeds the threshold value. Geman and Roncoroni (2003) claim that this model structure captures both trajectorial and statistical properties of US electricity price data well. More recently, a regime switching model with different regimes for positive and negative spikes has been proposed in Paraschiv, Fleten, and Schrle (2015) for hourly price forward curves. A regime switching model is also used in Date, Mamon, and Tenyakov (2013) for pricing energy commodity futures, where the authors do not use commodity spot price process and model the evolution of arbitrage-free futures price process directly. A numerical algorithm based on approximating the underlying stochastic process by a continuous time Markov chain was proposed in Albanese, Lo, and Tompaidis (2012). Albanese et al. (2012) demonstrate the utility of this algorithm for pricing electricity options under jump diffusion spot price process. Different approaches for modelling the electricity prices have been compared in Möst and Keles (2010).

While jump diffusion type models mentioned above remain popular in the commodity price modelling literature due to reasonable level of tractability in pricing commodity derivatives, a drawback of this class of models is significant complexity of estimating the large number of model parameters from data. Further, the intuitive interpretation of jumps as spikes has been questioned since a jump represents a switch from one level to another while a spike represents a jump followed by a rapid reversion to the original level.

As futures contracts in commodity markets are far more liquid than the spot security, it is common in the literature to use a recursive Bayesian inference procedure (or a Bayesian filter) to estimate the implied spot price from futures prices. Filters are used for both calibration as well as forecasting. In the commodity pricing literature, linear Gaussian filter (or the Kalman filter) has been employed in spot forecasting in Schwartz (1997), Manoliu and Tompaidis (2002) and Lautier and Galli (2004), among others. However, the classical Kalman filter can be applied only to a linear state space model. In Schwartz (1997), Manoliu and Tompaidis (2002) and Lautier and Galli (2004), the linear state space model consists of a linear Gaussian model for log spot price, with the vector of log futures prices being an affine function of the log spot price. Empirical studies in these papers relate either to oil or to natural gas, where price spikes are not dominant. Aiyube, Baidya, and Huarsaya (2008) use a particle filter to estimate a two factor model with jumps and used the maximum likelihood method to obtain the model parameters. Aihara, Bagchi, and Imreizeeq (2011) used a convolution particle filter to estimate parameters for a two factor spot model with jumps on simulated data.

In the electricity markets, there is far less literature on the use of filtering, even though the principle of futures contracts being more liquid – and futures prices providing a lot more information about the future price behaviour – still applies in these markets. Benth, Kallsen, and Meyer-Brandis (2007) analyse jump diffusion models for electricity markets and suggest that one might use filtering for calibration of the model, although no numerical experiments are presented. We are not aware of empirical studies in the literature with real electricity market data to illustrate the efficacy of filtering-based jump diffusion models for forecasting in electricity markets. This could be attributed to two possible reasons: the difficulty of calibrating jump diffusion models using vector-valued time series of futures prices and the relative scarcity of sufficient historical data on futures prices in de-regulated electricity markets, as compared to the availability of data in other commodity markets such as oil.
                        1
                     
                     
                        1
                        Two of the largest de-regulated markets, Nordpool Spot AS in Europe and PJM-AP in the USA, became operational only in 2002.
                     
                  

In this paper, we introduce a new random volatility model for modelling commodity prices. The volatility term in this model is taken to be a random variable to explain the non-Gaussian log spot price behaviour. We derive an approximation to the futures price for this model using the moments of the random volatility. The main advantage of this model, as compared to competing non-Gaussian spot models is that it is more parsimonious, easier to calibrate due to the availability of a closed-form approximation to futures price and is easier to simulate than jump diffusion models. Our numerical experiments with real data on electricity futures prices show that the model performs at least as well as jump diffusion models, which are harder to calibrate and to simulate than our new model, when the model performance is evaluated based on the ability to predict futures prices.

Further, we make two methodological contributions to the existing literature on two factor models of commodity prices. Firstly, we investigate empirically whether an explicit evaluation of jump risk premium makes a difference to accuracy of pricing and short term forecasting for a two factor jump diffusion model. Secondly, we propose a new multi-step calibration procedure to estimate the model parameters for two factor jump diffusion models. These models, which are described in more details in the next section, are difficult to calibrate due to a large number of parameters. This is further complicated by the fact that evaluating the price of each futures contract involves computing an integral numerically. In the literature, parameter estimation for jump-diffusion models is usually based on (scalar) spot price time series, see, e.g. 
                     Villaplana (2003) which estimates all the parameters except the risk premia using spot price time series and the risk premia are then estimated using the prices of traded contracts. Our approach uses a time series of vector-valued futures contracts and hence (arguably) uses a lot more information on the views of the market participants about the behaviour of the underlying spot price. However, this approach complicates parameter estimation due to multiple local minima for the likelihood function, extensive computation involved in computing the vector of futures prices at each time step and for each parameter vector and the difficulty of choosing appropriate initial values for a large number of parameters. We propose to get around this by using a simplified calibration procedure based on the generalized method of moments. We have calibrated the modified two factor model using the simplified multi-step calibration procedure and compared it with our new random volatility model on real electricity futures price data, in terms of accuracy in one step ahead prediction and calibration time. The comparison is based on predicting the futures prices using a particle filter. This work partially addresses the gap in the electricity market literature regarding filtering-based models, as mentioned above.

Our work presented in this paper also makes a contribution to the discussion about risk premia in jump diffusion models, which links futures prices with the spot price. The existence of risk premia in the electricity futures prices has been well established empirically in the literature; see, e.g. 
                     Botterud, Kristiansen, and Ilic (2010) and Lucia and Torr (2011). When it comes to a jump risk premium for electricity spot price models, two ideas exist in the literature. An earlier approach formulated by Merton (1976) and followed by Kou (2000), Bakshi, Cao, and Chen (1997) and Bates (1996) ignores the jump risk premium in general, i.e., treats the jump risk as purely idiosyncratic and assumes that it can be diversified away. The risk premium is applied only to jump size components of the compound Poisson process. More recently, Pan (2002) provides an evidence on an implicit jump risk premium. Finally, Brody, Hughston, and Mackie (2012) formulate a general framework for non-Gaussian processes, introduce a risk aversion in non-Gaussian processes and give an explicit expression for the risk premium in jump processes. In this paper, we calibrate the two factor jump diffusion model with a nonlinear modification of drift by the jump risk premium as in Brody et al. (2012) using the aforementioned multi-step procedure and investigate whether its value being different from zero significantly affects the quality of forecasts of futures prices.

The rest of the paper is structured as follows. Section 2 outlines the existing two factor jump diffusion model, while Section 3 presents our new random volatility model, with a derivation of approximate futures price under this model. In Section 4, the particle filter set-up used in our numerical experiments is discussed briefly. Section 5 which describes our numerical experiments with real Nord pool data is split into several subsections. Section 5.1 outlines the data used for numerical experiments. Sections 5.2 and 5.3 explain the methodology used for experiments and the derivation of moments for the method of moments-based parameter estimation, respectively. Sections 5.4 and 5.5 describe the parameter estimation procedures for two factor model and our new model, respectively. Section 5.6 outlines the procedure for updating some of these parameters as new measurement data arrives. Section 5.7 outlines the measures of comparison used for comparing the forecasting performance of different models. Section 6 discusses the results of these experiments, in terms of quantitative as well as chart-based comparisons of different models. Finally, Section 7 summarises the paper.

To define a jump diffusion model for spot and futures prices of commodities including electricity, we start by modelling the behaviour of the commodity spot price. Assume that in the filtered probability space (Ω, 
                        
                           F
                           ,
                        
                     
                     
                        P
                     ) with 
                        P
                      being the historical measure and 
                        F
                      being the natural filtration. The log commodity price is modelled in this case as:

                        
                           (1)
                           
                              
                                 
                                    
                                       
                                          log
                                          
                                             S
                                             t
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          f
                                          
                                             (
                                             t
                                             )
                                          
                                          +
                                          
                                             x
                                             t
                                          
                                          +
                                          
                                             ζ
                                             t
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (2)
                           
                              
                                 
                                    
                                       
                                          d
                                          
                                             x
                                             t
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             (
                                             
                                                α
                                                ¯
                                             
                                             −
                                             κ
                                             
                                                x
                                                t
                                             
                                             )
                                          
                                          d
                                          t
                                          +
                                          
                                             σ
                                             1
                                          
                                          d
                                          
                                             W
                                             
                                                1
                                                ,
                                                t
                                             
                                             P
                                          
                                          +
                                          d
                                          
                                             J
                                             t
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (3)
                           
                              
                                 
                                    
                                       
                                          d
                                          
                                             ζ
                                             t
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             μ
                                             ¯
                                          
                                          d
                                          t
                                          +
                                          
                                             σ
                                             2
                                          
                                          d
                                          
                                             W
                                             
                                                2
                                                ,
                                                t
                                             
                                             P
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (4)
                           
                              
                                 
                                    
                                       
                                          f
                                          (
                                          t
                                          )
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             c
                                             1
                                          
                                          +
                                          ς
                                          sin
                                          
                                             (
                                             
                                                c
                                                2
                                             
                                             t
                                             +
                                             
                                                c
                                                3
                                             
                                             )
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (5)
                           
                              
                                 
                                    
                                       
                                          ρ
                                          d
                                          t
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          d
                                          
                                             W
                                             
                                                1
                                                ,
                                                t
                                             
                                          
                                          d
                                          
                                             W
                                             
                                                2
                                                ,
                                                t
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                  

The spot price process St
                      consists of three components: xt
                      represents a short-term mean-reversion process with price shocks driven by a Compound Poisson process Jt
                      which has intensity λ and jump sizes 
                        
                           Y
                           =
                           
                              {
                              
                                 Y
                                 1
                              
                              ,
                              …
                              ,
                              
                                 Y
                                 t
                              
                              }
                           
                           ∼
                           N
                           
                              (
                              
                                 μ
                                 J
                              
                              ,
                              
                                 σ
                                 J
                                 2
                              
                              )
                           
                        
                     ; ζt
                      represents a long-term price process; seasonality f(t) is a deterministic function of time. We use a simple, single sinusoid plus a level term to model the seasonality and the trend, which is in keeping with the literature on commodity price modelling. This form of f(t) is used to de-seasonalise data for all the models in our experiments, including the random volatility model described in the next section. The coefficients 
                        
                           λ
                           ,
                           
                              μ
                              J
                           
                           ,
                           
                              σ
                              J
                           
                           ,
                           
                              α
                              ¯
                           
                           ,
                           κ
                           ,
                           
                              σ
                              1
                           
                           ,
                           
                              σ
                              2
                           
                           ,
                           ς
                           ,
                           
                              μ
                              ¯
                           
                           ,
                           
                              c
                              1
                           
                           ,
                           
                              c
                              2
                           
                           ,
                           
                              c
                              3
                           
                        
                      are constants, 
                        
                           
                              W
                              t
                              i
                           
                           ,
                           i
                           =
                           1
                           ,
                           2
                        
                      are Wiener processes with a constant correlation ρ. Note that we refer to a model with two Wiener processes as a ‘two factor model’. If the model has a jump component in addition to two Wiener processes, it is specified separately as a jump diffusion model.

The futures price F(t, T) (t ∈ [0, T)) of a commodity with spot price St
                      is 
                        
                           F
                           
                              (
                              t
                              ,
                              T
                              )
                           
                           =
                           
                              E
                              Q
                           
                           
                              [
                              
                                 e
                                 
                                    log
                                    
                                       S
                                       T
                                    
                                 
                              
                              |
                              
                                 F
                                 t
                              
                              ]
                           
                        
                     . Since the spot price process formulae (1)–(5) are given under a physical measure and the futures price formula is under a risk neutral measure, it is important to specify the change of measure involved. Let xt
                      be a risk-neutral mean-reversion process:

                        
                           (6)
                           
                              
                                 d
                                 
                                    x
                                    t
                                 
                                 =
                                 
                                    (
                                    α
                                    −
                                    κ
                                    
                                       x
                                       t
                                    
                                    )
                                 
                                 d
                                 t
                                 +
                                 
                                    σ
                                    1
                                 
                                 d
                                 
                                    W
                                    
                                       1
                                       ,
                                       t
                                    
                                    Q
                                 
                                 +
                                 d
                                 
                                    J
                                    t
                                 
                                 ,
                              
                           
                        
                     where 
                        
                           d
                           
                              W
                              
                                 1
                                 ,
                                 t
                              
                              Q
                           
                        
                      is a Wiener process under risk-neutral measure and 
                        
                           
                              α
                              ¯
                           
                           −
                           α
                           =
                           
                              h
                              x
                           
                           
                              σ
                              1
                           
                           +
                           R
                           
                              (
                              λ
                              ,
                              
                                 σ
                                 J
                              
                              ,
                              β
                              )
                           
                        
                      where hx
                      is the risk premium of mean-reversion process and β is a risk premium of the jump component. In the former approaches (e.g., see Merton, 1976; Villaplana, 2003) jump risk was treated as an idiosyncratic component, which means that 
                        
                           R
                           (
                           λ
                           ,
                           
                              σ
                              J
                           
                           ,
                           β
                           )
                           =
                           0
                        
                     . We modify the formulae from Villaplana (2003) for the log futures price to account the excess rate of return R(λ, σJ, β):

                        
                           (7)
                           
                              
                                 
                                    
                                       
                                          log
                                          F
                                          (
                                          t
                                          ,
                                          T
                                          )
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          f
                                          
                                             (
                                             T
                                             )
                                          
                                          +
                                          
                                             e
                                             
                                                −
                                                κ
                                                (
                                                T
                                                −
                                                t
                                                )
                                             
                                          
                                          
                                             x
                                             t
                                          
                                          +
                                          
                                             ζ
                                             t
                                          
                                          +
                                          A
                                          
                                             (
                                             T
                                             −
                                             t
                                             )
                                          
                                          +
                                          B
                                          
                                             (
                                             T
                                             −
                                             t
                                             )
                                          
                                          ,
                                          
                                          
                                          where
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (8)
                           
                              
                                 
                                    
                                       
                                          A
                                          (
                                          T
                                          −
                                          t
                                          )
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             (
                                             μ
                                             −
                                             
                                                h
                                                ζ
                                             
                                             )
                                          
                                          
                                             (
                                             T
                                             −
                                             t
                                             )
                                          
                                          −
                                          
                                             
                                                
                                                   h
                                                   x
                                                
                                                
                                                   σ
                                                   1
                                                
                                                +
                                                R
                                                
                                                   (
                                                   λ
                                                   ,
                                                   
                                                      σ
                                                      J
                                                   
                                                   ,
                                                   β
                                                   )
                                                
                                             
                                             κ
                                          
                                          
                                             (
                                             1
                                             −
                                             
                                                e
                                                
                                                   −
                                                   κ
                                                   (
                                                   T
                                                   −
                                                   t
                                                   )
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                          
                                             
                                                σ
                                                1
                                                2
                                             
                                             
                                                4
                                                κ
                                             
                                          
                                          
                                             (
                                             1
                                             −
                                             
                                                e
                                                
                                                   −
                                                   2
                                                   κ
                                                   (
                                                   T
                                                   −
                                                   t
                                                   )
                                                
                                             
                                             )
                                          
                                          +
                                          
                                             
                                                ρ
                                                
                                                   σ
                                                   1
                                                
                                                
                                                   σ
                                                   2
                                                
                                             
                                             κ
                                          
                                          
                                             (
                                             1
                                             −
                                             
                                                e
                                                
                                                   −
                                                   κ
                                                   (
                                                   T
                                                   −
                                                   t
                                                   )
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                          
                                             1
                                             2
                                          
                                          
                                             σ
                                             2
                                             2
                                          
                                          
                                             (
                                             T
                                             −
                                             t
                                             )
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (9)
                           
                              
                                 
                                    
                                       
                                          B
                                          (
                                          T
                                          −
                                          t
                                          )
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          λ
                                          
                                             ∫
                                             t
                                             T
                                          
                                          
                                             (
                                             exp
                                             
                                                {
                                                
                                                   μ
                                                   J
                                                
                                                +
                                                
                                                   1
                                                   2
                                                
                                                
                                                   σ
                                                   J
                                                   2
                                                
                                                
                                                   e
                                                   
                                                      −
                                                      2
                                                      κ
                                                      (
                                                      T
                                                      −
                                                      z
                                                      )
                                                   
                                                
                                                }
                                             
                                             −
                                             1
                                             )
                                          
                                          d
                                          z
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where hζ
                      is a market price of risk for the process ζt
                      and α is set to 0, as before. We use the results from Brody et al. (2012) to introduce jump risk effects to the model, as outlined below.

A standard Poisson process Jt
                      with rate λ and {Yt
                     } i.i.d. copies of a random variable Y has a following property:

                        
                           
                              
                                 ϕ
                                 
                                    (
                                    a
                                    )
                                 
                                 :
                                 =
                                 E
                                 
                                    [
                                    
                                       e
                                       
                                          a
                                          Y
                                       
                                    
                                    ]
                                 
                                 <
                                 ∞
                              
                           
                        
                     for a in some connected interval A containing the origin. Lévy exponent
                        2
                     
                     
                        2
                        If a Lévy process Xt
                            represents the class of general Lévy models and 
                              
                                 E
                                 [
                                 
                                    e
                                    
                                       α
                                       
                                          X
                                          t
                                       
                                    
                                 
                                 ]
                                 <
                                 ∞
                                 ,
                              
                            then there exists a Lévy exponent ψ(α), such that 
                              
                                 E
                                 
                                    [
                                    
                                       e
                                       
                                          α
                                          
                                             X
                                             t
                                          
                                       
                                    
                                    ]
                                 
                                 =
                                 
                                    e
                                    
                                       t
                                       ψ
                                       (
                                       α
                                       )
                                    
                                 
                                 ,
                              
                            for more details see Brody et al. (2012).
                      for compound Poisson process is 
                        
                           ψ
                           (
                           a
                           )
                           =
                           λ
                           (
                           ϕ
                           (
                           a
                           )
                           −
                           1
                           )
                        
                      and the excess rate of return is then given by:

                        
                           (10)
                           
                              
                                 R
                                 
                                    (
                                    λ
                                    ,
                                    
                                       h
                                       1
                                    
                                    ,
                                    
                                       h
                                       2
                                    
                                    )
                                 
                                 =
                                 λ
                                 
                                    (
                                    ϕ
                                    
                                       (
                                       
                                          h
                                          1
                                       
                                       )
                                    
                                    +
                                    ϕ
                                    
                                       (
                                       −
                                       
                                          h
                                          2
                                       
                                       )
                                    
                                    −
                                    ϕ
                                    
                                       (
                                       
                                          h
                                          1
                                       
                                       −
                                       
                                          h
                                          2
                                       
                                       )
                                    
                                    −
                                    1
                                    )
                                 
                                 ,
                              
                           
                        
                     where h
                     1, h
                     2 > 0. In our case, Y is normally distributed with zero mean and variance 
                        
                           σ
                           J
                           2
                        
                     :

                        
                           
                              
                                 ϕ
                                 
                                    (
                                    a
                                    )
                                 
                                 =
                                 exp
                                 
                                    (
                                    
                                       1
                                       2
                                    
                                    
                                       a
                                       2
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     In this example, we assume zero mean for the jump size distribution and let the linear components of the futures price formula take care of the jump size. Substitution of ϕ(a) into the (10) yields:

                        
                           (11)
                           
                              
                                 R
                                 
                                    (
                                    λ
                                    ,
                                    
                                       σ
                                       J
                                    
                                    ,
                                    β
                                    )
                                 
                                 =
                                 λ
                                 
                                    (
                                    
                                       e
                                       
                                          
                                             1
                                             2
                                          
                                          
                                             σ
                                             J
                                             2
                                          
                                       
                                    
                                    +
                                    
                                       e
                                       
                                          
                                             1
                                             2
                                          
                                          
                                             β
                                             2
                                          
                                       
                                    
                                    −
                                    
                                       e
                                       
                                          
                                             1
                                             2
                                          
                                          
                                             
                                                (
                                                
                                                   σ
                                                   J
                                                
                                                −
                                                β
                                                )
                                             
                                             2
                                          
                                       
                                    
                                    −
                                    1
                                    )
                                 
                                 ,
                              
                           
                        
                     where β is the risk aversion of the jump component.

During calibration, we will assume that the futures price data is observed in noise. This measurement noise can be looked upon as a proxy for the approximation error introduced due to truncation of the Taylor series. Specifically, the measurement equation at each time step tk
                      is written as

                        
                           (12)
                           
                              
                                 vec
                                 
                                    {
                                    z
                                    
                                       (
                                       
                                          t
                                          k
                                       
                                       ,
                                       
                                          T
                                          i
                                       
                                       )
                                    
                                    }
                                 
                                 =
                                 vec
                                 
                                    {
                                    log
                                    F
                                    
                                       (
                                       
                                          t
                                          k
                                       
                                       ,
                                       
                                          T
                                          i
                                       
                                       )
                                    
                                    }
                                 
                                 +
                                 
                                    v
                                    
                                       t
                                       k
                                    
                                 
                                 ,
                              
                           
                        
                     where log F(tk, Ti
                     ) is the log futures price for maturity Ti
                      at time tk
                     , as given by (19), and 
                        
                           
                              v
                              
                                 t
                                 k
                              
                           
                           ∼
                           N
                           
                              (
                              0
                              ,
                              Σ
                              )
                           
                        
                      is a measurement noise vector with zero mean and covariance matrix Σ. vec operator is defined as following:

                        
                           
                              
                                 vec
                                 
                                    (
                                    
                                       x
                                       i
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       [
                                       
                                          x
                                          1
                                       
                                       
                                       
                                          x
                                          2
                                       
                                       
                                       ⋯
                                       
                                       
                                          x
                                          N
                                       
                                       ]
                                    
                                    ⊤
                                 
                                 .
                              
                           
                        
                     As a result, we have a system of Eqs. (1)–(5) as the transition equations for the log spot price process, which is treated as an unobserved or latent variable. The measurement equation is given by (12), with log F(t, T) given by (7), (8), (9) and (11). We will use this nonlinear state space model for one step ahead prediction of arbitrage-free futures prices using a particle filter later in numerical experiments.

The jump diffusion model described in the previous section can explain many of the statistical and trajectorial properties of observed spot price time series, especially in the electricity markets, but also for other commodities. However, it is quite cumbersome to calibrate from futures prices, due to a large number of parameters and due to numerical integral evaluation needed for computing the price of each futures contract. We propose a simple alternative model here which takes into account the fat tailed nature of the log spot distribution, with fewer parameters than the jump diffusion model and with an approximate closed-form pricing formula for the futures contracts. The main idea of the model is to allow the volatility of the log spot price to be random and then to use it to model the non-Gaussian price behaviour. This gives a model with two sources of randomness, with a tractability equivalent to a single factor model.

The notation is similar to the previous section. In the filtered probability space (Ω, 
                        
                           F
                           ,
                        
                     
                     
                        Q
                     ) with 
                        Q
                      being the risk-neutral measure and 
                        F
                      being the natural filtration, we model the evolution of de-seasonalised log commodity price by:

                        
                           (13)
                           
                              
                                 
                                    
                                       
                                          d
                                          
                                             x
                                             t
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             (
                                             α
                                             −
                                             κ
                                             
                                                x
                                                t
                                             
                                             )
                                          
                                          d
                                          t
                                          +
                                          
                                             σ
                                             t
                                          
                                          d
                                          
                                             W
                                             
                                                1
                                                ,
                                                t
                                             
                                             Q
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (14)
                           
                              
                                 
                                    
                                       
                                          d
                                          
                                             σ
                                             t
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             
                                                f
                                                ^
                                             
                                             1
                                          
                                          
                                             (
                                             t
                                             ,
                                             
                                                σ
                                                t
                                             
                                             )
                                          
                                          d
                                          t
                                          +
                                          
                                             
                                                f
                                                ^
                                             
                                             2
                                          
                                          
                                             (
                                             t
                                             ,
                                             
                                                σ
                                                t
                                             
                                             )
                                          
                                          d
                                          
                                             W
                                             
                                                2
                                                ,
                                                t
                                             
                                             Q
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where α and κ > 0 are scalar constants, σt
                      is a positive process on the real line, 
                        
                           
                              W
                              
                                 i
                                 ,
                                 t
                              
                           
                           
                           
                              (
                              i
                              =
                              1
                              ,
                              2
                              ,
                              t
                              >
                              0
                              )
                           
                        
                      are Wiener processes such that 
                        
                           〈
                           
                              W
                              
                                 1
                                 ,
                                 t
                              
                           
                           ,
                           
                              W
                              
                                 2
                                 ,
                                 t
                              
                           
                           〉
                           =
                           0
                        
                      and 
                        
                           
                              
                                 f
                                 ^
                              
                              1
                           
                           ,
                           
                           
                              
                                 f
                                 ^
                              
                              2
                           
                        
                      are real valued smooth functions.

Recall that the arbitrage-free futures price F(t, T) at time t with maturity time T is given by:

                        
                           (15)
                           
                              
                                 F
                                 
                                    (
                                    t
                                    ,
                                    T
                                    )
                                 
                                 =
                                 f
                                 
                                    (
                                    T
                                    )
                                 
                                 
                                    E
                                    Q
                                 
                                 
                                    (
                                    
                                       e
                                       
                                          x
                                          T
                                       
                                    
                                    |
                                    
                                       F
                                       t
                                    
                                    )
                                 
                              
                           
                        
                     where T > t is the maturity time. Assume that all the central moments 
                        
                           
                              m
                              i
                           
                           
                           
                              (
                              i
                              =
                              1
                              …
                              ∞
                              )
                           
                        
                      of xt
                      exist ∀t ∈ [0, T]. This allows us to express futures price formulae using a Taylor series expansion around point 
                        
                           
                              m
                              1
                           
                           =
                           
                              E
                              Q
                           
                           
                              (
                              
                                 x
                                 T
                              
                              )
                           
                           ,
                        
                      with 
                        
                           x
                           =
                           
                              x
                              T
                           
                        
                      for brevity:

                        
                           (16)
                           
                              
                                 
                                    E
                                    Q
                                 
                                 
                                    (
                                    
                                       e
                                       x
                                    
                                    |
                                    
                                       F
                                       t
                                    
                                    )
                                 
                                 =
                                 
                                    e
                                    
                                       m
                                       1
                                    
                                 
                                 
                                    E
                                    Q
                                 
                                 
                                    (
                                    
                                       e
                                       
                                          x
                                          −
                                          
                                             m
                                             1
                                          
                                       
                                    
                                    |
                                    
                                       F
                                       t
                                    
                                    )
                                 
                                 =
                                 
                                    e
                                    
                                       m
                                       1
                                    
                                 
                                 
                                    ∑
                                    
                                       i
                                       =
                                       0
                                    
                                    ∞
                                 
                                 
                                    
                                       
                                          E
                                          Q
                                       
                                       
                                          
                                             (
                                             x
                                             −
                                             
                                                m
                                                1
                                             
                                             |
                                             
                                                F
                                                t
                                             
                                             )
                                          
                                          i
                                       
                                    
                                    
                                       i
                                       !
                                    
                                 
                              
                           
                        
                     
                  

In the subsequent discussion, we assume that σt
                      is a log-normally distributed random variable for all t > 0, with a constant mean μ and a constant variance η
                     2. This stationary probability distribution can be obtained at each time t by assuming the following simple stochastic process for log σt
                     :

                        
                           
                              
                                 
                                    
                                       
                                          log
                                          
                                             σ
                                             t
                                          
                                          =
                                          μ
                                          +
                                          
                                             
                                                η
                                                
                                                   W
                                                   
                                                      2
                                                      ,
                                                      t
                                                   
                                                   Q
                                                
                                             
                                             
                                                t
                                             
                                          
                                          ,
                                          t
                                          >
                                          0
                                          ,
                                          log
                                          
                                             (
                                             
                                                σ
                                                0
                                             
                                             )
                                          
                                          =
                                          μ
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     with 
                        
                           〈
                           
                              W
                              
                                 1
                                 ,
                                 t
                              
                              Q
                           
                           ,
                           
                              W
                              
                                 2
                                 ,
                                 t
                              
                              Q
                           
                           〉
                           =
                           0
                        
                     . This provides a theoretical justification for the choice of log-normal distribution for σt
                     , although other distributions may be chosen in practice. Log-normal distribution is suitable from a practical point of view as well to model random volatility, as it is defined on non-negative support and has only two parameters. Since we are interested in pricing futures contracts which are path-independent securities, we can treat σt
                      as a time-independent random variable and we will henceforth omit the time index from the notation for σt
                     .

Under the real world (or physical) measure 
                        
                           P
                           ,
                        
                      let the log spot price process be given by

                        
                           (17)
                           
                              
                                 
                                    
                                       
                                          d
                                          
                                             x
                                             t
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             (
                                             
                                                α
                                                ¯
                                             
                                             −
                                             κ
                                             
                                                x
                                                t
                                             
                                             )
                                          
                                          d
                                          t
                                          +
                                          σ
                                          d
                                          
                                             W
                                             
                                                1
                                                ,
                                                t
                                             
                                             P
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                       σ
                                    
                                    
                                       ∼
                                    
                                    
                                       
                                          L
                                          N
                                          (
                                          μ
                                          ,
                                          
                                             η
                                             2
                                          
                                          )
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           W
                           
                              1
                              ,
                              t
                           
                           P
                        
                      is a Wiener process under a physical measure. Then, assuming absence of arbitrage, there exists a price of risk process hx
                      such that 
                        
                           α
                           −
                           
                              α
                              ¯
                           
                           =
                           
                              h
                              x
                           
                           ,
                        
                      which we assume to be constant. For de-seasonalised data, we set the mean reversion level 
                        
                           α
                           ¯
                        
                      in the real world measure to 0, which is in keeping with the convention (see Manoliu & Tompaidis, 2002, for example). The random variable σ under risk-neutral measure has log normal distribution as described above. By using the fact that

                        
                           
                              
                                 
                                    
                                       
                                          log
                                          E
                                          
                                             (
                                             
                                                e
                                                x
                                             
                                             )
                                          
                                          =
                                          E
                                          
                                             (
                                             x
                                             )
                                          
                                          +
                                          
                                             1
                                             2
                                          
                                          Var
                                          
                                             (
                                             x
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     holds for any Gaussian random variable x and re-arranging the terms in (16), we can show that the logarithm of the futures price is given by

                        
                           (18)
                           
                              
                                 
                                    
                                       
                                          log
                                          F
                                          (
                                          t
                                          ,
                                          T
                                          )
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          log
                                          
                                             (
                                             f
                                             
                                                (
                                                T
                                                )
                                             
                                             )
                                          
                                          +
                                          
                                             x
                                             t
                                          
                                          
                                             e
                                             
                                                −
                                                κ
                                                (
                                                T
                                                −
                                                t
                                                )
                                             
                                          
                                          +
                                          
                                             
                                                h
                                                x
                                             
                                             κ
                                          
                                          
                                             (
                                             1
                                             −
                                             
                                                e
                                                
                                                   −
                                                   κ
                                                   (
                                                   T
                                                   −
                                                   t
                                                   )
                                                
                                             
                                             )
                                          
                                          +
                                          
                                             1
                                             2
                                          
                                          
                                             m
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                          log
                                          
                                             (
                                             1
                                             +
                                             
                                                e
                                                
                                                   −
                                                   
                                                      
                                                         m
                                                         2
                                                      
                                                      2
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      2
                                                   
                                                   ∞
                                                
                                                
                                                   
                                                      
                                                         m
                                                         
                                                            2
                                                            i
                                                         
                                                      
                                                      −
                                                      
                                                         γ
                                                         
                                                            2
                                                            i
                                                         
                                                      
                                                      
                                                         m
                                                         2
                                                         i
                                                      
                                                   
                                                   
                                                      (
                                                      2
                                                      i
                                                      )
                                                      !
                                                   
                                                
                                                )
                                             
                                             )
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where mi
                      is the ith central moment of 
                        
                           x
                           T
                        
                      conditional on xt
                     . Note that 
                        
                           
                              m
                              1
                           
                           =
                           
                              x
                              t
                           
                           
                              e
                              
                                 −
                                 κ
                                 (
                                 T
                                 −
                                 t
                                 )
                              
                           
                           +
                           
                              
                                 h
                                 x
                              
                              κ
                           
                           
                              (
                              1
                              −
                              
                                 e
                                 
                                    −
                                    κ
                                    (
                                    T
                                    −
                                    t
                                    )
                                 
                              
                              )
                           
                        
                     . The difference terms 
                        
                           
                              
                                 m
                                 
                                    2
                                    i
                                 
                              
                              −
                              
                                 γ
                                 
                                    2
                                    i
                                 
                              
                              
                                 m
                                 2
                                 i
                              
                           
                           
                              (
                              2
                              i
                              )
                              !
                           
                        
                      depend on the size of η, i.e. on the uncertainty in the volatility term. In fact, as η → 0, (18) coincides with the expression for log futures price when the log spot price has linear Gaussian dynamics. The first few values of γi
                      are given by 
                        
                           
                              γ
                              4
                           
                           =
                           3
                           ,
                        
                     
                     
                        
                           
                              γ
                              6
                           
                           =
                           15
                        
                      and 
                        
                           
                              γ
                              8
                           
                           =
                           105
                        
                     . The contribution of higher order differences in the above expression tends to be negligible for typical parameter values. One can then use the first few terms of the expansion based on Taylor series (16) as a closed form expression for approximate futures price. We performed calibration experiments on real electricity futures data (described later in Section 5.1) to compare the in-sample and out-of-sample accuracy of the truncated model with 
                        
                           i
                           =
                           2
                           ,
                           3
                           ,
                           4
                           ,
                        
                      
                     i.e. using 4th, 6th and 8th order approximations. Note that odd order moments are 0, and a second order approximation implies a constant volatility. It was found that truncation at 
                        
                           i
                           =
                           3
                        
                      offers the best overall performance in terms of accurate one step ahead prediction of futures prices. Hence this truncation (using moments up to 6th order) is used in the numerical experiments in this paper. The approximate expression with this choice is

                        
                           (19)
                           
                              
                                 
                                    
                                       
                                          log
                                          F
                                          (
                                          t
                                          ,
                                          T
                                          )
                                       
                                    
                                    
                                       ≈
                                    
                                    
                                       
                                          log
                                          
                                             (
                                             f
                                             
                                                (
                                                T
                                                )
                                             
                                             )
                                          
                                          +
                                          
                                             x
                                             t
                                          
                                          
                                             e
                                             
                                                −
                                                κ
                                                (
                                                T
                                                −
                                                t
                                                )
                                             
                                          
                                          +
                                          
                                             
                                                h
                                                x
                                             
                                             κ
                                          
                                          
                                             (
                                             1
                                             −
                                             
                                                e
                                                
                                                   −
                                                   κ
                                                   (
                                                   T
                                                   −
                                                   t
                                                   )
                                                
                                             
                                             )
                                          
                                          +
                                          
                                             1
                                             2
                                          
                                          
                                             m
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                          log
                                          
                                             (
                                             
                                             1
                                             +
                                             
                                                e
                                                
                                                   −
                                                   
                                                      
                                                         m
                                                         2
                                                      
                                                      2
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      
                                                         m
                                                         4
                                                      
                                                      −
                                                      3
                                                      
                                                         m
                                                         2
                                                         2
                                                      
                                                   
                                                   24
                                                
                                                +
                                                
                                                   
                                                      
                                                         m
                                                         6
                                                      
                                                      −
                                                      15
                                                      
                                                         m
                                                         2
                                                         3
                                                      
                                                   
                                                   720
                                                
                                                )
                                             
                                             
                                             )
                                          
                                          ,
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     Eq. (19) defines the log futures price in terms of our model. The vector of actual futures prices at any time tk
                      is assumed to be measured in noise, as in (12). The expressions for the individual terms in (19) are given in Appendix A. When compared to the two factor jump diffusion model described in the previous section, the benefits of the new random volatility model are its parsimony despite having two sources of randomness and its ease of calibration due to approximate closed-form pricing formula. In numerical experiments, we will show that the model is at least comparable, if not better, than two factor models when it comes to one step ahead predictions of electricity futures prices.

For both the models discussed so far (the random volatility model and the two factor jump diffusion model), we will use a particle filter to infer and predict the underlying log spot prices from the vector-valued noisy measurements of futures prices. This is different from the ‘hybrid’ approach advocated in Cartea and Figueroa (2005) where only the risk premium is estimated from forward prices. The mechanism for particle filter is described next, for the sake of completeness.

Consider the following state space system:

                        
                           (20)
                           
                              
                                 
                                    
                                       
                                          x
                                          k
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          f
                                          (
                                          
                                             x
                                             
                                                k
                                                −
                                                1
                                             
                                          
                                          ,
                                          
                                             v
                                             
                                                k
                                                −
                                                1
                                             
                                          
                                          )
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (21)
                           
                              
                                 
                                    
                                       
                                          y
                                          k
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          h
                                          (
                                          
                                             x
                                             k
                                          
                                          ,
                                          
                                             ϵ
                                             k
                                          
                                          )
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where f(·, ·) is a vector valued function of the state 
                        
                           
                              x
                              
                                 k
                                 −
                                 1
                              
                           
                           
                           and
                           
                        
                      i.i.d., zero mean process noise sequence 
                        
                           {
                           
                              v
                              
                                 k
                                 −
                                 1
                              
                           
                           }
                           ,
                        
                      while h(·, ·) is a vector valued function of the state and i.i.d., zero mean measurement noise sequence 
                        
                           {
                           
                              ϵ
                              k
                           
                           }
                        
                     . 
                        
                           k
                           ∈
                           N
                        
                      represents current time-step. xk
                      is unobservable, and the aim is to construct the estimate of xk
                      by combining model prediction with the measurement yk
                     , at each time step k. Eqs. (20) and (21) are referred to as the transition equation and the measurement equation, respectively. The aim is to construct the pdf p(xk
                     |y
                     1: k
                     ). Assume that initial pdf, or prior p(x
                     0, y
                     0) is known. Then as each new measurement yk
                      arrives, p(xk
                     |y
                     1: k
                     ) can be constructed recursively within two steps: prediction and update. The prediction step is based on Chapman–Kolmogorov equation:

                        
                           (22)
                           
                              
                                 p
                                 
                                    (
                                    
                                       x
                                       k
                                    
                                    |
                                    
                                       y
                                       
                                          1
                                          :
                                          k
                                          −
                                          1
                                       
                                    
                                    )
                                 
                                 =
                                 ∫
                                 p
                                 
                                    (
                                    
                                       x
                                       k
                                    
                                    |
                                    
                                       x
                                       
                                          k
                                          −
                                          1
                                       
                                    
                                    )
                                 
                                 p
                                 
                                    (
                                    
                                       x
                                       
                                          k
                                          −
                                          1
                                       
                                    
                                    |
                                    
                                       y
                                       
                                          1
                                          :
                                          k
                                          −
                                          1
                                       
                                    
                                    )
                                 
                                 d
                                 
                                    x
                                    
                                       k
                                       −
                                       1
                                    
                                 
                                 ,
                              
                           
                        
                     where 
                        
                           p
                           (
                           
                              x
                              
                                 k
                                 −
                                 1
                              
                           
                           |
                           
                              y
                              
                                 1
                                 :
                                 k
                                 −
                                 1
                              
                           
                           )
                        
                      assumed to be known and the transition probability 
                        
                           p
                           (
                           
                              x
                              k
                           
                           |
                           
                              x
                              
                                 k
                                 −
                                 1
                              
                           
                           )
                        
                      is defined by (20). After the measurement yk
                      becomes available, it can be used to update the prior using Bayes’ rule:

                        
                           (23)
                           
                              
                                 p
                                 
                                    (
                                    
                                       x
                                       k
                                    
                                    |
                                    
                                       y
                                       
                                          1
                                          :
                                          k
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       p
                                       
                                          (
                                          
                                             y
                                             k
                                          
                                          |
                                          
                                             x
                                             k
                                          
                                          )
                                       
                                       p
                                       
                                          (
                                          
                                             x
                                             k
                                          
                                          |
                                          
                                             y
                                             
                                                1
                                                :
                                                k
                                                −
                                                1
                                             
                                          
                                          )
                                       
                                    
                                    
                                       p
                                       (
                                       
                                          y
                                          k
                                       
                                       |
                                       
                                          x
                                          
                                             1
                                             :
                                             k
                                             −
                                             1
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        
                     where

                        
                           (24)
                           
                              
                                 p
                                 
                                    (
                                    
                                       y
                                       k
                                    
                                    |
                                    
                                       x
                                       
                                          1
                                          :
                                          k
                                          −
                                          1
                                       
                                    
                                    )
                                 
                                 =
                                 ∫
                                 p
                                 
                                    (
                                    
                                       y
                                       k
                                    
                                    |
                                    
                                       x
                                       k
                                    
                                    )
                                 
                                 p
                                 
                                    (
                                    
                                       x
                                       k
                                    
                                    |
                                    
                                       y
                                       
                                          1
                                          :
                                          k
                                          −
                                          1
                                       
                                    
                                    )
                                 
                                 d
                                 
                                    x
                                    k
                                 
                              
                           
                        
                     In case when the posterior density is not available analytically, we can approximate it with a set of random samples (or particles) with associated probability weights. Assume that the underlying process is a Markov process, which will be the case in all the processes considered in this paper. We will provide a short description for the recursion to update the probability measure 
                        
                           {
                           
                              x
                              k
                              i
                           
                           ,
                           
                              w
                              k
                              i
                           
                           }
                        
                      at time tk
                      to the corresponding probability measure at time 
                        
                           t
                           
                              k
                              +
                              1
                           
                        
                      (see, e.g. 
                     Arulampalam, Maskell, Gordon, & Clapp, 2002 for more details).

                        
                           •
                           Sample 
                                 
                                    x
                                    
                                       k
                                       +
                                       1
                                    
                                    i
                                 
                               from 
                                 
                                    q
                                    (
                                    x
                                    |
                                    
                                       x
                                       k
                                    
                                    ,
                                    
                                       y
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                    )
                                 
                              . q is called proposal density and serves as an approximation to posterior density. The choice of q is crucial in terms of the quality of estimates. A common choice is 
                                 
                                    q
                                    
                                       (
                                       x
                                       |
                                       
                                          x
                                          k
                                       
                                       ,
                                       
                                          y
                                          
                                             k
                                             +
                                             1
                                          
                                       
                                       )
                                    
                                    =
                                    p
                                    
                                       (
                                       
                                          x
                                          
                                             k
                                             +
                                             1
                                          
                                       
                                       |
                                       
                                          x
                                          k
                                       
                                       )
                                    
                                    ,
                                 
                               although other choices are possible (e.g. Gaussian density generated using the extended Kalman filter is also frequently employed).

The weight update can be done using the following relation:

                                 
                                    (25)
                                    
                                       
                                          
                                             ω
                                             
                                                k
                                                +
                                                1
                                             
                                             i
                                          
                                          ∝
                                          
                                             ω
                                             
                                                k
                                             
                                             i
                                          
                                          
                                             
                                                p
                                                
                                                   (
                                                   
                                                      y
                                                      
                                                         k
                                                         +
                                                         1
                                                      
                                                   
                                                   |
                                                   
                                                      x
                                                      
                                                         k
                                                         +
                                                         1
                                                      
                                                      i
                                                   
                                                   )
                                                
                                                p
                                                
                                                   (
                                                   
                                                      x
                                                      
                                                         k
                                                         +
                                                         1
                                                      
                                                      i
                                                   
                                                   |
                                                   
                                                      x
                                                      
                                                         k
                                                      
                                                      i
                                                   
                                                   )
                                                
                                             
                                             
                                                q
                                                (
                                                
                                                   x
                                                   
                                                      k
                                                      +
                                                      1
                                                   
                                                   i
                                                
                                                |
                                                
                                                   x
                                                   k
                                                   i
                                                
                                                ,
                                                
                                                   y
                                                   
                                                      k
                                                      +
                                                      1
                                                   
                                                
                                                )
                                             
                                          
                                          ,
                                       
                                    
                                 
                              and the posterior filtered density is given by:

                                 
                                    (26)
                                    
                                       
                                          p
                                          
                                             (
                                             
                                                x
                                                
                                                   k
                                                   +
                                                   1
                                                
                                             
                                             |
                                             
                                                x
                                                k
                                             
                                             )
                                          
                                          ≈
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                N
                                                s
                                             
                                          
                                          
                                             ω
                                             k
                                             i
                                          
                                          δ
                                          
                                             (
                                             
                                                x
                                                
                                                   k
                                                   +
                                                   1
                                                
                                             
                                             −
                                             
                                                x
                                                
                                                   k
                                                   +
                                                   1
                                                
                                                i
                                             
                                             )
                                          
                                          ,
                                       
                                    
                                 
                              where δ is the Dirac-Delta function.

An issue which frequently arises in using a particle filter is degeneracy phenomenon, when after few iterations particle weights might start pinning around one value. However, this can partially be solved by introducing a measure for degeneracy problem:

                        
                           (27)
                           
                              
                                 
                                    N
                                    eff
                                 
                                 =
                                 
                                    
                                       (
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             N
                                             s
                                          
                                       
                                       
                                          
                                             (
                                             
                                                ω
                                                k
                                                i
                                             
                                             )
                                          
                                          2
                                       
                                       )
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 .
                              
                           
                        
                     If N
                     eff falls below some pre-defined threshold, we apply a resampling algorithm. See Arulampalam et al. (2002) for more details on resampling algorithms.

In our numerical experiments, the spot price is considered to be unobservable and an implied spot price is derived using the observed prices of futures contracts using the particle filter. We used the particle filter for one step ahead prediction of futures prices for three different models: two factor jump diffusion model as described in Section 2, a jump-free version of the same model with 
                        
                           σ
                           J
                        
                      and the corresponding jump risk premia set to 0 and the random volatility model described in Section 3. The actual numerical experiments performed with these models are described next.

For our empirical study, we focused on the European electricity market. Nord pool is the largest pool-based market for electrical energy in the world, covers most of the Northern Europe and is traded at NASDAQ. We used three different data sets of futures contracts, with six different maturities in each case. Each data set has 300 daily prices of futures with 22 days, 44 days, 66 days, 88 days, 110 days and 132 days maturity. The dates for the three data sets are as follows:

                           
                              •
                              Data set 1: 19.11.2007–03.02.2009;

Data set 2: 15.12.2009–24.02.2011;

Data set 3: 09.12.2011–19.02.2013.

While the exact choice of data sets is somewhat arbitrary, it is partly motivated by the need to demonstrate that the performance of our model is not specific to data sets with specific statistical features. As seen in Tables 1
                        –3
                        
                        , the three data sets (which are well spaced from each other in time and are all within the last decade) display different types of behaviour when it comes to higher order moments of prices. To be more specific, data sets 1 and 3 display negative skewness and excess kurtosis (ExKurtosis in the Tables 1–3) for most maturities while data set 2 displays positive skewness and positive excess kurtosis for most maturities. In the tables, 0 maturity refers to spot price.

Each data set is further split into two non-overlapping and consecutive subsets:

                           
                              •
                              An ‘in-sample’ data subset consisting of first 150 observations of futures prices and electricity spot price. This is used to estimate the model parameters apart from the risk premia and the measurement noise covariance matrix. In a terminology borrowed from engineering literature, we will refer this set of parameters as ‘offline’ parameters and the calibration stage as the offline stage.

An ‘out-of-sample’ data subset consisting of subsequent 150 observations of futures prices and electricity spot price. This is used to carry out one step ahead prediction with the calibrated models using a particle filter and to update the risk premia and the measurement noise covariance. We will refer to these parameters as ‘online’ model parameters and the calibration stage as the online stage.

In our experiments, changing the relative sizes of data subsets, e.g., using 200 observations as in-sample data and 100 as out-of-sample data made no qualitative difference to the results. Choosing an in-sample data size of 100 or below causes difficulties in the estimation of two factor jump diffusion model due to its large number of parameters.

The subsequent sections describe our methodology including the details of parameter estimation of different models and the error metrics used to compare the models.

@&#METHODOLOGY@&#

Empirical study of the models has the following steps:

                           
                              •
                              De-seasonalisation: as is common in modelling commodity prices, we use a parametrised seasonality function (4) to de-seasonalise the data.

A new multi-step heuristic for parameter estimation in two factor models: two factor jump diffusion model described in Section 2 is highly nonlinear, includes numerical evaluation of integrals for finding each futures price and contains a large number of parameters. To alleviate the difficulty of parameter estimation from futures prices, we introduce a new systematic multi-step algorithm for calibrating this model. The steps are enumerated below:

                                    
                                       –
                                       Note that the de-seasonalised log spot price in the two factor jump diffusion model described earlier has 9 free parameters, excluding the three risk premia. Starting from the characteristic function of the process, we evaluate analytically the first 9 moments of the log spot price at any time t. We then minimize the sum of squared errors between theoretical and observed moments to estimate these 9 parameters of the model in historical measure, from time series data. Note that setting the gradient of this cost function to zero yields 9 equations in 9 unknowns.

With the acquired parameters, we estimate the covariance matrix for the moments.

Using the inverse of the covariance matrix as a weight, we re-estimate the parameters. This reduces the influence of poorly fitted moments on the final parameter estimates.

The above estimation of parameters might be considered as offline estimation since it has to be carried out on in-sample data. In contrast, we estimate the risk premium parameters (assumed to be constant) and the observation noise covariance matrix Σ using the least squares method online, i.e. we update these parameters along with the update of the implied spot price in the particle filtering procedure on out-of-sample data. This is similar in spirit to the calibration procedure in Villaplana (2003), except that we are using vector valued time series of past futures prices (and not simply the spot price data). In practice, we update risk premia and noise covariance every ten time-steps and not at every step. This number of steps for risk premium update is somewhat arbitrary and can be adjusted with trial and error to yield lower prediction errors over in-sample data. One step ahead prediction of the implied spot price – and hence the arbitrage-free futures prices – is achieved through a particle filter. Note that Σ is needed for updating the probability weights in the particle filter at each time-step; please refer to Eq. (25).

We will provide more details on this procedure in Section 5.4.

Testing for in-sample and out-of-sample prediction ability for all the models (two factor models with and without jumps as well as our new random volatility model): We calibrate different models on three different data sets mentioned earlier. For each model and on each data set, we use a particle filter to track the latent spot price and get one step ahead forecasts for the futures prices, using the transition density as the proposal density. Two factor jump diffusion model, two factor diffusion model without jumps and random volatility model are then compared on the basis of the one step ahead prediction errors in futures prices. The exact metrics to compare the errors are described in Section 5.7.

The next section outlines how to obtain the moments for the jump diffusion process.

To derive the characteristic function for the jump diffusion two factor model defined in (1)–(3), a de-seasonalised log price process 
                           
                              
                                 S
                                 t
                                 *
                              
                              =
                              log
                              
                                 S
                                 t
                              
                              −
                              f
                              
                                 (
                                 t
                                 )
                              
                           
                         is considered. Assume that the jump process is uncorrelated with the Brownian motion. First, we want a characteristic function of the following form:

                           
                              
                                 
                                    g
                                    
                                       (
                                       x
                                       ,
                                       ζ
                                       ,
                                       t
                                       )
                                    
                                    =
                                    E
                                    
                                       {
                                       
                                          e
                                          
                                             i
                                             u
                                             (
                                             
                                                x
                                                T
                                             
                                             +
                                             
                                                ζ
                                                T
                                             
                                             )
                                          
                                       
                                       |
                                       
                                          X
                                          t
                                       
                                       =
                                       x
                                       ,
                                       
                                          ζ
                                          t
                                       
                                       =
                                       ζ
                                       }
                                    
                                    .
                                 
                              
                           
                        Applying Ito’s formula to the 
                           
                              
                                 M
                                 t
                              
                              =
                              g
                              
                                 (
                                 x
                                 ,
                                 ζ
                                 ,
                                 t
                                 )
                              
                              ,
                           
                         and assuming that dMt
                         is a martingale, we get a characteristic function of the following form (see, e.g. 
                        Tankov, 2004):

                           
                              (28)
                              
                                 
                                    
                                       
                                          
                                             
                                                ϕ
                                                
                                                   S
                                                   t
                                                   *
                                                
                                             
                                             
                                                (
                                                u
                                                )
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                ϕ
                                                
                                                   
                                                      x
                                                      T
                                                   
                                                   +
                                                   
                                                      ζ
                                                      T
                                                   
                                                
                                             
                                             
                                                (
                                                u
                                                )
                                             
                                             
                                                ϕ
                                                J
                                             
                                             
                                                (
                                                u
                                                )
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (29)
                              
                                 
                                    
                                       
                                          
                                             
                                                ϕ
                                                
                                                   
                                                      x
                                                      T
                                                      C
                                                   
                                                   +
                                                   
                                                      ζ
                                                      T
                                                   
                                                
                                             
                                             
                                                (
                                                u
                                                )
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             exp
                                             {
                                             (
                                             −
                                             
                                                u
                                                2
                                             
                                             (
                                             
                                                
                                                   ρ
                                                   
                                                      σ
                                                      1
                                                   
                                                   
                                                      σ
                                                      2
                                                   
                                                
                                                κ
                                             
                                             
                                                (
                                                1
                                                −
                                                
                                                   e
                                                   
                                                      −
                                                      κ
                                                      T
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             +
                                             
                                             
                                                
                                                   σ
                                                   1
                                                   2
                                                
                                                
                                                   4
                                                   κ
                                                
                                             
                                             
                                                (
                                                1
                                                −
                                                
                                                   e
                                                   
                                                      −
                                                      2
                                                      κ
                                                      T
                                                   
                                                
                                                )
                                             
                                             +
                                             
                                                1
                                                2
                                             
                                             
                                                σ
                                                2
                                                2
                                             
                                             )
                                             +
                                             i
                                             u
                                             
                                                (
                                                
                                                   x
                                                   0
                                                
                                                
                                                   e
                                                   
                                                      −
                                                      κ
                                                      T
                                                   
                                                
                                                +
                                                
                                                   ζ
                                                   0
                                                
                                                +
                                                μ
                                                T
                                                )
                                             
                                             }
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (30)
                              
                                 
                                    
                                       
                                          
                                             
                                                ϕ
                                                J
                                             
                                             
                                                (
                                                u
                                                )
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             exp
                                             
                                                {
                                                
                                                   λ
                                                   J
                                                
                                                t
                                                
                                                   (
                                                   
                                                      e
                                                      
                                                         i
                                                         u
                                                         
                                                            μ
                                                            J
                                                         
                                                         
                                                            e
                                                            
                                                               −
                                                               κ
                                                               t
                                                            
                                                         
                                                         −
                                                         
                                                            1
                                                            2
                                                         
                                                         
                                                            σ
                                                            J
                                                            2
                                                         
                                                         
                                                            e
                                                            
                                                               −
                                                               2
                                                               κ
                                                               t
                                                            
                                                         
                                                         
                                                            u
                                                            2
                                                         
                                                      
                                                   
                                                   −
                                                   1
                                                   )
                                                
                                                }
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        From the definition of the characteristic function, one can evaluate moments of the desired process using following formula:

                           
                              (31)
                              
                                 
                                    
                                       m
                                       n
                                    
                                    =
                                    
                                       1
                                       
                                          i
                                          n
                                       
                                    
                                    
                                       
                                          ∂
                                          n
                                       
                                       
                                          ∂
                                          
                                             u
                                             n
                                          
                                       
                                    
                                    
                                       ϕ
                                       
                                          S
                                          t
                                          *
                                       
                                    
                                    
                                       (
                                       u
                                       )
                                    
                                    .
                                 
                              
                           
                        These moments can be calculated analytically using any symbolic computation software such as Mathematica, Matcad, Matlab, etc. The exact (and lengthy) expressions for moments are omitted for brevity. The method of moments is used to estimate the parameters of the model (1) from sample moments based on data. However, this will not allow us to find the parameters for the risk premium. As mentioned in the previous subsection, we use a simple multi-step heuristic, where most of the parameters are estimated offline (or on the in-sample data subset) in the historical measure using the method of moments and then the risk premia (which are assumed to be constant) are estimated online by least squares. This is explained in more details in the next section.

For parameter estimation, we use analytically derived first n moments using (31), where n is equal to the number of unknown parameters after de-seasonalisation. Let Θ be a vector of unknown parameters. Let mn
                        (Θ) be the parameterised nth central moment of the in-sample, or offline electricity spot price data set and let 
                           
                              m
                              n
                              o
                           
                         be the sample nth central moment computed from the observed data. Then we minimise the following cost function:

                           
                              (32)
                              
                                 
                                    
                                       min
                                       Θ
                                    
                                    
                                    
                                       
                                          (
                                          
                                             m
                                             n
                                             o
                                          
                                          −
                                          
                                             m
                                             n
                                          
                                          
                                             (
                                             Θ
                                             )
                                          
                                          )
                                       
                                       T
                                    
                                    
                                       Λ
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       (
                                       
                                          m
                                          n
                                          o
                                       
                                       −
                                       
                                          m
                                          n
                                       
                                       
                                          (
                                          Θ
                                          )
                                       
                                       )
                                    
                                    ,
                                 
                              
                           
                        where Λ is a weighting matrix. We do optimisation in three steps:

                           
                              •
                              Firstly, we assume that Λ is identity matrix and minimize the cost function over parameter vector Θ. Let 
                                    
                                       Θ
                                       =
                                       
                                          Θ
                                          ☆
                                       
                                    
                                  be the parameter vector which achieves this optimum.

Next, we set the diagonal entries of Λ as free variables, with a condition that |Λ| ≥ 0 and minimize the cost function with fixed 
                                    
                                       Θ
                                       =
                                       
                                          Θ
                                          ☆
                                       
                                    
                                 . Let Λ
                                 ⋆ be the matrix which achieves this optimum.

Finally, we solve (32) over Θ again, with the weighting matrix set to Λ
                                 ⋆.

After we obtain the vector of optimal parameters offline using the above procedure, we can set up the particle filter. At each time (or each day) ti
                        , The one day ahead prediction of the price of each futures contract is based on the arithmetical average of the predicted prices of the corresponding contract over all the particles generated. The risk premia viz. {hx, hζ, β} as well as the noise covariance matrix Σ can be updated online, along with the price predictions made by the particle filter. See Section 5.6 for more details on this filtering and online calibration stage.

For de-seasonalised spot price and including the risk premia, the random volatility model described in Section 2 has far fewer parameters in comparison to the jump diffusion model (4 instead of 9) and a closed-form (approximate) measurement equation which does not include numerical evaluation of integral. This allows us to use the maximum likelihood method directly. We estimate the parameter vector 
                           
                              
                                 Θ
                                 ^
                              
                              =
                              
                                 {
                                 κ
                                 ,
                                 μ
                                 ,
                                 η
                                 ,
                                 
                                    h
                                    x
                                 
                                 }
                              
                           
                         and a diagonal covariance matrix Σ of the measurement noise. From the assumption that log futures price observations are available under additive Gaussian noise, we can minimize the log likelihood function of measurements which is given by

                           
                              (33)
                              
                                 
                                    
                                       
                                          
                                             L
                                             (
                                             Θ
                                             )
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             −
                                             
                                                N
                                                log
                                                |
                                                Σ
                                                |
                                             
                                             −
                                             
                                                1
                                                2
                                             
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   0
                                                
                                                N
                                             
                                             
                                                
                                                   (
                                                   
                                                      y
                                                      i
                                                   
                                                   −
                                                   vec
                                                   
                                                      (
                                                      log
                                                      F
                                                      
                                                         (
                                                         
                                                            t
                                                            i
                                                         
                                                         ,
                                                         
                                                            T
                                                            k
                                                         
                                                         )
                                                      
                                                      )
                                                   
                                                   )
                                                
                                                ⊤
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                                Σ
                                                
                                                   −
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   y
                                                   i
                                                
                                                
                                                   −
                                                   vec
                                                   (
                                                   log
                                                   F
                                                
                                                
                                                   (
                                                   
                                                      t
                                                      i
                                                   
                                                   ,
                                                   
                                                      T
                                                      k
                                                   
                                                   )
                                                
                                                )
                                             
                                             
                                                )
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where yi
                         are observed futures price vectors at time ti
                         and the vec operator is as defined in Section 2, with respect to the futures maturities Tk
                        , 
                           
                              k
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              n
                           
                        . Σ is assumed to be identity matrix in the absence of more information, although a different choice can be made relative to uncertainty about the futures prices. Once the parameters are obtained, we can use a particle filter for prediction of futures prices, as we do for the two factor models.

The next section describes an online calibration procedure for risk premium parameters and the measurement noise covariance matrix. This procedure is common for our random volatility model as well as for the two factor models with and without jumps.

Here, ‘online’ calibration refers to updating some of the parameters periodically as new data arrives. Along with the latent spot price itself, two different quantities are estimated online: the covariance matrix of measurement noise and the parameters reflecting the risk premia.

To estimate the covariance matrix of measurement noise, we initialise Σ
                        0 as an identity matrix and use the following update for each time step k:

                           
                              
                                 
                                    
                                       
                                          
                                             
                                                Σ
                                                
                                                   i
                                                   ,
                                                   i
                                                
                                                k
                                             
                                             =
                                             
                                                
                                                   (
                                                   
                                                      
                                                         v
                                                         ^
                                                      
                                                      i
                                                      k
                                                   
                                                   )
                                                
                                                2
                                             
                                             ,
                                             k
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             N
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where

                           
                              (34)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   v
                                                   ^
                                                
                                                i
                                                k
                                             
                                             =
                                             
                                                (
                                                log
                                                
                                                   F
                                                   
                                                      (
                                                      market
                                                      )
                                                   
                                                
                                                
                                                   (
                                                   
                                                      T
                                                      k
                                                   
                                                   ,
                                                   
                                                      t
                                                      i
                                                   
                                                   )
                                                
                                                −
                                                log
                                                
                                                   
                                                      F
                                                      ^
                                                   
                                                   
                                                      (
                                                      theoretical
                                                      )
                                                   
                                                
                                                
                                                   (
                                                   
                                                      T
                                                      k
                                                   
                                                   ,
                                                   
                                                      t
                                                      i
                                                   
                                                   )
                                                
                                                )
                                             
                                             ,
                                             
                                             k
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             n
                                          
                                       
                                    
                                 
                              
                           
                        and 
                           
                              
                                 
                                    F
                                    ^
                                 
                                 
                                    (
                                    theoretical
                                    )
                                 
                              
                              
                                 (
                                 
                                    T
                                    k
                                 
                                 ,
                                 
                                    t
                                    i
                                 
                                 )
                              
                              
                                 )
                              
                           
                         represents the average theoretical price using the particle filter iteration.

To estimate the risk premia, we define a vector ri
                        , whose entries are the risk premia for the relevant model (e.g.
                        
                           
                              
                                 r
                                 i
                              
                              =
                              
                                 
                                    
                                       [
                                       
                                          h
                                          x
                                       
                                       
                                       
                                          h
                                          ζ
                                       
                                       
                                       β
                                       ]
                                    
                                 
                                 ⊤
                              
                           
                         for the two factor model with jumps).

We set 
                           
                              
                                 r
                                 0
                              
                              =
                              0
                           
                         (here 0 is a zero vector with dim(r) rows). After obtaining Σi
                         at step i, we can solve a non-linear least squares problem:

                           
                              
                                 
                                    
                                       min
                                       
                                          r
                                          i
                                       
                                    
                                    
                                       
                                          (
                                          log
                                          
                                             F
                                             
                                                (
                                                market
                                                )
                                             
                                          
                                          
                                             (
                                             
                                                T
                                                k
                                             
                                             ,
                                             
                                                t
                                                i
                                             
                                             )
                                          
                                          −
                                          log
                                          
                                             
                                                F
                                                ^
                                             
                                             
                                                (
                                                theoretical
                                                )
                                             
                                          
                                          
                                             (
                                             
                                                T
                                                k
                                             
                                             ,
                                             
                                                t
                                                i
                                             
                                             )
                                          
                                          )
                                       
                                       2
                                    
                                    .
                                 
                              
                           
                        
                     

As mentioned in Section 5.1, this problem is solved after each ten time-steps to update the risk premia.

For comparison of the performance of models in terms of forecasting, we consider the sample mean of the relative absolute error (MRAE) and root mean square error (RMSE) as our measures of prediction error for the futures price data. For a futures contract with maturity T, these are defined as follows:

                           
                              
                                 
                                    
                                       
                                          
                                             MRAE
                                             T
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                1
                                                N
                                             
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                N
                                             
                                             
                                                
                                                   
                                                      |
                                                   
                                                   
                                                      F
                                                      
                                                         i
                                                         ,
                                                         T
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         F
                                                         ^
                                                      
                                                      
                                                         i
                                                         ,
                                                         T
                                                      
                                                   
                                                   
                                                      |
                                                   
                                                
                                                
                                                   F
                                                   
                                                      i
                                                      ,
                                                      T
                                                   
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                          
                                             RMSE
                                             T
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      N
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               F
                                                               
                                                                  i
                                                                  ,
                                                                  T
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  F
                                                                  ^
                                                               
                                                               
                                                                  i
                                                                  ,
                                                                  T
                                                               
                                                            
                                                            )
                                                         
                                                         2
                                                      
                                                      N
                                                   
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 F
                                 ^
                              
                              
                                 i
                                 ,
                                 T
                              
                           
                         is the average values of one step ahead predicted futures prices evaluated for each particle drawn on the ith time step of a particle filter with a corresponding maturity T, and F
                        
                           i, T
                         is the observed futures price with maturity T, at ith time step. These measures are evaluated for each of the six futures contracts, for each of the three data sets and for both in-sample and out-of-sample data.

Besides computing the above error metrics, an alternative comparison of the three models can be based on computing similar measures of error on cross-sectional data, i.e. computing the average prediction errors over the prices of six futures contracts:

                           
                              
                                 
                                    
                                       
                                          
                                             MRAE
                                             i
                                             ☆
                                          
                                       
                                       
                                          
                                             :
                                             =
                                          
                                       
                                       
                                          
                                             
                                                1
                                                6
                                             
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                6
                                             
                                             
                                                
                                                   
                                                      |
                                                   
                                                   
                                                      F
                                                      
                                                         i
                                                         ,
                                                         
                                                            T
                                                            j
                                                         
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         F
                                                         ^
                                                      
                                                      
                                                         i
                                                         ,
                                                         
                                                            T
                                                            j
                                                         
                                                      
                                                   
                                                   
                                                      |
                                                   
                                                
                                                
                                                   F
                                                   
                                                      i
                                                      ,
                                                      
                                                         T
                                                         j
                                                      
                                                   
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                          
                                             RMSE
                                             i
                                             ☆
                                          
                                       
                                       
                                          
                                             :
                                             =
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      6
                                                   
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               F
                                                               
                                                                  i
                                                                  ,
                                                                  
                                                                     T
                                                                     j
                                                                  
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  F
                                                                  ^
                                                               
                                                               
                                                                  i
                                                                  ,
                                                                  
                                                                     T
                                                                     j
                                                                  
                                                               
                                                            
                                                            )
                                                         
                                                         2
                                                      
                                                      6
                                                   
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        at each time ti, i.e., on each day. This is relevant, for example, when we are forecasting the value at risk of a portfolio of futures contracts. These errors are computed and plotted over both in-sample and out-of-sample data.

@&#RESULTS AND DISCUSSION@&#

We compare the two factor model without jumps (TF), the two factor model with jumps (TFJ) and our new random volatility model (RVM) using the above two error metrics, over in-sample and out-of-sample data subsets for each of the three data sets.

Since there are two different error metrics over six data sets (three in-sample and three out-of-sample), and since each data set has six futures contracts, we have a total of 72 columns of errors to compare the three models with. In our tables of results, we have indicated by bold font the worst (or the highest) error metric in each column (i.e. for each data set 
                        +
                      futures contract 
                        +
                      error metric).


                     Tables 4
                      and 5
                      present the in-sample errors (MRAE and RMSE) for all the three models. As one can see, RVM has the worst performance (i.e., yields the worst value for an error metric) among the three models 2 out of 18 times according to MRAE and 4 out of 18 times according to RMSE, while TFJ has the worst performance 12 out of 18 times for both the error metrics. TF has the worst error 4 out of 18 times according to MRAE and 2 out of 18 according to RMSE. Tables 6
                      and 7
                      present out-of-sample error metrics. When it comes to MRAE, RVM has the worst performance error only 2 out of 18 times, while TFJ and TF have the worst errors 9 times and 7 times respectively. For RMSE, RVM is the worst model out-of-sample only once, while TFJ gives the worst RMSE error 8 times and TF gives the worst error 4 times. The out-of-sample RMSE errors given by at least two of three models are almost indistinguishable in five cases.

In summary, out of a total of 72 error comparisons, RVM is the worst model only in 9 cases, with ‘ties’ declared in five cases and one of the other two models being the worst model in the remaining 58 cases.

As mentioned in the previous section, we also carried out a comparison of cross-sectional forecasting errors, where the errors are computed over all the predicted and actual futures prices, each day. These error metrics are plotted in Figs. 1
                     –4
                     
                     
                      for data set 1. Again, we can see that RVM is performed better than the two competing models on majority of days, both in-sample and out-of-sample. The results for the other two data sets are qualitatively similar and are omitted for brevity.

These results support our modest claim that our newly proposed RVM (with a single, scalar stochastic process and one random variable) performs at least equally well as more involved models discussed in the literature (with two or more scalar stochastic processes), when the comparison involves predictive ability in terms of one step ahead prediction of the prices of futures contracts. The advantage of RVM over the other two models is its simplicity of calibration and parsimony in terms of parameters. To be more specific, TFJ model has 9 parameters which are calibrated offline and 3 parameters (risk premia) are calibrated or updated online. RVM has only 4 parameters calibrated offline and a single risk premium parameter is updated online. These numbers exclude 4 seasonality parameters and the measurement noise variances, which have to be calibrated for both the types of models. Further, pricing using TFJ involves a numerical evaluation of an integral while RVM gives an approximate closed-form pricing formula, which seems to work well in practice as illustrated by our results.

It is also interesting to compare the prediction results between TF model and TFJ model, in order to see whether jumps add any value when it comes to prediction. The answer seems to be negative for these particular data sets, since TF model is the worst model out of 72 error columns only 17 times, while TFJ model is the worst model 41 times.

When it comes to pricing European style securities, RVM contains a single random variable σ and one stochastic process. Hence it is easier to simulate from, than the two other models considered here (TF has two correlated random processes, while TFJ has two correlated random processes and one compound Poisson process). This indicates that pricing of any exotic, European style options or their hedging parameters via Monte Carlo simulation is computationally cheaper with RVM, when compared to TF or TFJ.

In addition to the above analysis on predictive ability of models, we have carried out an empirical analysis of two cases for two factor model with jumps: when the jump risk premium is set to zero and when jump risk premium is given with formulae (11). Tables 8
                      and 9
                      show this comparison for out-of-sample data sets for MRAE and RMSE errors. We provide a comparison only for out-of-sample data since the risk premium was updated online using particle filter in our experiments, as outlined earlier. It can be seen that using explicitly parameterized jump risk premium does not improve the predictive ability, at least for the data sets used, with an improvement in one of the error metrics observed only 17 out of 36 times. This modest set of numerical experiments does not provide any evidence of practical utility of assuming the jump risk to be non-idiosyncratic in electricity markets. However, it is quite conceivable that contrary empirical evidence may be found with pricing other securities with jump diffusion models.

More details about these numerical experiments, including further graphical comparisons and analytical expressions for the moments of the jump diffusion model can be found in Islyaev (2015).

@&#CONCLUSION@&#

To summarise, the paper makes three main contributions:

                        
                           •
                           We have proposed a new random volatility model for log spot price in the electricity market, which might be useful in modelling other commodities as well. The model is easier to calibrate and to simulate from, as compared to the two factor jump diffusion model, due to a simple approximate pricing formula and fewer model parameters. Further, it performs at least as well as these models in our comprehensive numerical experiments from real electricity market data when it comes to predicting the futures prices. This model has potential to be practically useful in pricing and risk measurement applications for the electricity market.

We have proposed a new systematic multi-step procedure for calibrating two factor models with jumps, which alleviates some of the difficulties in calibrating models with a large number of parameters and numerically involved measurement equations. The use of this new procedure has also been tested through numerical experiments.

We have provided empirical evidence on the use of jump diffusion models in electricity markets. Our empirical results, using three data sets and two error metrics, provide no conclusive evidence that the use of jumps in modelling adds value in terms of prediction, especially in out-of-sample prediction. Further, we found no evidence that modelling explicitly parameterised jump risk premium adds value in terms of out-of-sample prediction.

An investigation into the use of the new random volatility model for pricing commodity derivatives other than vanilla futures contracts is a topic of current research.

@&#ACKNOWLEDGEMENTS@&#

The authors are grateful to the anonymous reviewers whose constructive suggestions improved the quality of this paper.

The equations for the first few terms based on 
                        
                           
                              m
                              i
                           
                           =
                           
                              E
                              Q
                           
                           
                              
                                 (
                                 
                                    x
                                    T
                                 
                                 −
                                 
                                    E
                                    Q
                                 
                                 
                                    (
                                    
                                       x
                                       T
                                    
                                    |
                                    
                                       x
                                       t
                                    
                                    )
                                 
                                 )
                              
                              i
                           
                           ,
                        
                      
                     i > 1, in the random volatility model in Section 3 are given in terms of the model parameters as follows:

                        
                           
                              
                                 
                                    
                                       
                                          m
                                          2
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          ν
                                          
                                             
                                                (
                                                1
                                                −
                                                
                                                   e
                                                   
                                                      −
                                                      2
                                                      κ
                                                      Δ
                                                   
                                                
                                                )
                                             
                                             
                                                2
                                                κ
                                             
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                m
                                                4
                                             
                                             −
                                             3
                                             
                                                m
                                                2
                                                2
                                             
                                          
                                          24
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      e
                                                      
                                                         4
                                                         
                                                            η
                                                            2
                                                         
                                                      
                                                   
                                                   −
                                                   1
                                                   )
                                                
                                                
                                                   ν
                                                   2
                                                
                                             
                                             8
                                          
                                          
                                             
                                                
                                                   (
                                                   1
                                                   −
                                                   
                                                      e
                                                      
                                                         −
                                                         2
                                                         κ
                                                         Δ
                                                      
                                                   
                                                   )
                                                
                                                2
                                             
                                             
                                                4
                                                
                                                   κ
                                                   2
                                                
                                             
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             m
                                             6
                                          
                                          −
                                          15
                                          
                                             m
                                             2
                                             3
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      e
                                                      
                                                         12
                                                         
                                                            η
                                                            2
                                                         
                                                      
                                                   
                                                   −
                                                   1
                                                   )
                                                
                                                
                                                   ν
                                                   3
                                                
                                             
                                             48
                                          
                                          
                                             
                                                
                                                   (
                                                   1
                                                   −
                                                   
                                                      e
                                                      
                                                         −
                                                         2
                                                         κ
                                                         Δ
                                                      
                                                   
                                                   )
                                                
                                                3
                                             
                                             
                                                8
                                                
                                                   κ
                                                   3
                                                
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           Δ
                           =
                           T
                           −
                           t
                        
                      and 
                        
                           ν
                           =
                           
                              e
                              
                                 2
                                 (
                                 μ
                                 +
                                 
                                    η
                                    2
                                 
                                 )
                              
                           
                        
                     .

@&#REFERENCES@&#

