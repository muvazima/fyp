@&#MAIN-TITLE@&#Distortion correction and calibration of intra-operative spine X-ray images using a constrained DLT algorithm

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           Automatic method for distortion correction and calibration of intraoperative spine X-ray images.


                        
                        
                           
                           Constrained version of the well-known Direct Linear Transform (DLT) algorithm, reducing its degrees of freedom from 11 to 3.


                        
                        
                           
                           Experimental evaluation to ensure that the method is fast and more accurate than other existing methods.


                        
                        
                           
                           The low segmentation error level also ensures accurate calibration of the c-arm.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Calibration

X-ray

Intra-operative imaging

Direct Linear Transform

@&#ABSTRACT@&#


               
               
                  This work presents an automatic method for distortion correction and calibration of intra-operative spine X-ray images, a fundamental step for the use of this modality in computer and robotic assisted surgeries. Our method is based on a prototype calibration drum, attached to the c-arm intensifier during the intervention. The projections of its embedded fiducial beads onto the X-ray images are segmented by the proposed method, which uses its calculated centroids to undo the distortion and, afterwards, calibrate the c-arm. For the latter purpose, we propose the use of a constrained version of the well known Direct Linear Transform (DLT) algorithm, reducing its degrees of freedom from 11 to 3. Experimental evaluation of our method is included in this work, showing that it is fast and more accurate than other existing methods. The low segmentation error level also ensures accurate calibration of the c-arm, with an expected error of 4% in the computation of its focal distance.
               
            

Most modern hospitals have intra-operative fluoroscopic devices – known as ‘c-arms’ – which makes X-ray imaging a natural choice for the implementation of computer and robotic assisted surgeries. These procedures require registration of the pre and intra operative images, which requires an accurate knowledge of the X-ray image formation process’ parameters. This makes c-arm's calibration and distortion correction necessary requisites for which reliable solutions must be developed.

It is well accepted that c-arms can be modelled as pinhole cameras, borrowing terms from computer vision [1]. Calibration of this type of cameras consists in the estimation of its intrinsic (i.e. invariant to the c-arm's location) and extrinsic (i.e. variable with the c-arm's location) parameters. Intrinsic parameters are, mainly, the pixel's dimensions and the focal point location, whereas extrinsic parameters correspond to the c-arm's location with respect to a given frame of reference. Unfortunately, most c-arm's do not provide any of these: they normally lack from encoders to measure their angulation (extrinsic parameters) nor provide information about pixel size or focal point. To make matters worse, c-arm's intensifiers are affected by distortion, which is dependent on the curvature of its phosphorous panel and its surrounding electromagnetic field, influenced in turn by nearby metallic objects and the device's orientation [2]. This problem has been solved on more modern c-arms replacing image intensifiers by flat panel detectors with negligible distortion [3]. However, this technology is quite recent and the majority of hospital do not have access to it yet.

Most c-arm calibration and distortion correction systems require use of a special device, known as ‘drums’, ‘cages’ or ‘rings’, which are attached to the intensifier before or during the intervention. Calibration drums normally consist of parallel plastic plates with embedded metallic fiducials, which are projected onto the X-ray images and segmented by specialised image processing algorithms. Their detected locations are then used to correct the effects of distortion and estimate the c-arm's parameters. According to Zheng and Zhang, algorithms for these problems can be divided in two groups: off-line and on-line methods. Off-line approaches acquire a set of images with the attached calibration drum before intervention on some predefined positions. Calculation of intrinsic parameters and distortion corrections are performed for each position and saved. Then, the calibration device is removed and operation begins. Off-line approaches are simpler to implement, as no objects are present on the images used for calibration and, therefore, fiducial segmentation is greatly simplified. Their main drawback is that results are only valid for a reduced set of positions, and no others can be used during intervention. On the other hand, on-line approaches perform calibrations for each acquired X-ray image and, therefore, never remove the calibration drum during surgery. On-line approaches are inherently more reliable (they provide results adjusted to each image) and cope better with additional factors that may vary the intrinsic parameters, such as the c-arm's mechanical flexion produced by the intensifier's weight which may displace the focal point between consecutive X-rays [9]. The choice between off-line and on-line approaches also affects the calibration drum's design: off-line methods can use drums with denser fiducial grids, which produce more precise results (but only for a reduced set of positions), whereas on-line methods must use sparser grids, otherwise X-ray images would suffer from excessive occlusion. As we consider that limiting the calibration to a small set of positions is too restrictive, we opted for the flexibility of an on-line approach. This, however, has the trade-off of increased complexity of implementation, which we considered an acceptable price to pay to obtain higher precision and increased safety for the patient and clinical staff.

Multiple on-line calibration algorithms have been proposed in the recent years, such as the ones proposed by Foley et al. [4], Tate et al. [5], Livyatan et al. [6], Merloz et al. [7], Sadowsky [8] and Zheng and Zhang [9]. These studies have proposed multiple calibration drum designs, sometimes arranging the fiducial objects on a symmetrical arrangement [4,7,8]. This approach, although valid, has an inconvenience: it impedes detection of image reflection. If the uncalibrated image is reflected – for any reason – an algorithm based on a symmetrical pattern would not detect it, giving a wrongly oriented image as result. In surgery, ensuring correct orientation of images is of critical importance, as a reflected image could lead surgeons to operate on the wrong side of the patient with terrible consequences. Therefore, asymmetrical designs of calibration drums are preferred, an approach followed by Tate et al. [5], Livyatan et al. [6] and Zheng and Zhang [9]. One of the most known on-line algorithms was published by Livyatan et al. in 2002, who proposed a method which performed distortion correction first followed by estimation of the c-arm parameters [6]. The authors used the FluoroTrax calibration drum – previously used by Tate et al. [5] – consisting of two parallel plates with embedded fiducial beads arranged on an asymmetrical pattern. The beads’ projections were segmented from the X-ray using standard image processing techniques and, then, the drum's centre and rotation were calculated and used to generate a ground-truth pattern of the proximal plate fiducials, which differed from the segmented ones due to distortion. The subtraction between both patterns generated a vector field, used to warp the X-ray image and correct the distortion effects [10]. Finally, the corrected beads’ locations were used as input for a calibration algorithm which estimated the c-arm's intrisic and extrinsic parameters [11,12].

A different approach was presented by Zheng and Zhang in 2009, who also used a 2-plate drum, but with a less dense bead pattern [9]. After segmentation of the fiducials – using a more sophisticated template matching algorithm – their method performed the correction and calibration steps in the opposite order: it first calibrated the c-arm using information taken from the central portion of the image and then generated a vector field used to undistort the X-ray. Zheng and Zhang used the Direct Linear Transform (DLT) algorithm for the c-arm calibration step, which is well known and widely used by computer vision researchers [1].

Currently, image-guided spinal surgery applications struggle to obtain sub-millimetre precision, which is a clinically relevant goal. Required error levels for the safe prevention of nerve damage and bone fracture fall well below the sub-millimetrical level in many spinal sections, particularly in some vertabrae of the thoracic and cervical levels [13]. Attainment of this goal requires high levels of precision in all elements comprising the surgical application's chain. Calibration and registration are critical parts of it, as errors introduced in these fundamental processes will be propagated into the following stages in which correction becomes increasingly difficult. In addition, surgical application are expected to be fast enough to produce results in a few seconds, otherwise their use in the operating room becomes impractical. To attain these goals, we propose a new calibration method which combines the strengths of previously published methods, aiming to produce an algorithm which is simultaneously fast and accurate.

As we have said, we present a new method for the problem of distortion correction and calibration. In the following subsections we describe our approach.

We built a custom calibration drum – shown in Figs. 1 and 2
                        
                         – based on the design proposed by Zheng and Zhang [9], which has two parallel plastic plates with embedded fiducial beads of two different diameters, arranged on a not too dense pattern. The proximal plate has beads of 3mm arranged on a cartesian grid with a separation of 20mm, which are projected on each acquired X-ray image. In the latter, the small beads will not appear arranged exactly as in the cartesian grid, due to the distortion effects. However, as the grid's shape is known in advance, its undistorted positions can be inferred and used to warp the image undoing the effects of distortion. In addition to the small beads, the calibration drum has an asymmetrical pattern of seven 5mm beads, three of them placed on the proximal plate D
                        1, D
                        2 and D
                        3) and four on the distal plate (D
                        4, D
                        5, D
                        6 and D
                        7) on the coordinates given in Table 1
                        . The large beads’ configuration was chosen to ensure that no symmetries were present in both axes, permitting the unambiguous determination of the drum's pose undoing the effects of displacements, rotations and reflections. In addition, it was intentionally placed close to the image intensifier's centre, as this area of the images is less affected by distortion and, therefore, permits a more accurate determination of the drum's pose.

A specialised image processing algorithm, described in Fig. 3
                        , is executed to segment the projected beads on each acquired X-ray image. This algorithm first searches for the large beads by applying a median filter to the image and subtracting the result to the original one. This gives a difference image which has pixel values close to zero everywhere except on the beads’ locations, which have large negative values. The difference image is binarised using a threshold and a connected component analysis is performed to identify all objects in it. This binary image contains both beads and other spurious objects, so a morphological opening followed by three additional filtering operations are performed to discard objects which are too small, too large or not round enough to be considered beads. This gives as a binary image as result which only contains the large beads. Finally, each bead centroid is calculated with sub-pixel accuracy using the following formulae


                        
                           
                              (1)
                              
                                 
                                    
                                       
                                          x
                                       
                                    
                                    P
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                          
                                             
                                                
                                                   x
                                                
                                             
                                             ∈
                                             Ω
                                          
                                       
                                       
                                          
                                             x
                                          
                                       
                                       F
                                       (
                                       
                                          
                                             x
                                          
                                       
                                       )
                                    
                                    
                                       
                                          ∑
                                          
                                             
                                                
                                                   x
                                                
                                             
                                             ∈
                                             Ω
                                          
                                       
                                       F
                                       (
                                       
                                          
                                             x
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        
                        
                           
                              (2)
                              
                                 F
                                 (
                                 
                                    
                                       x
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   I
                                                   (
                                                   
                                                      
                                                         x
                                                      
                                                   
                                                   )
                                                   −
                                                   T
                                                
                                                
                                                   if
                                                   I
                                                   (
                                                   
                                                      
                                                         x
                                                      
                                                   
                                                   )
                                                   ≤
                                                   T
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   if
                                                   I
                                                   (
                                                   
                                                      
                                                         x
                                                      
                                                   
                                                   )
                                                   >
                                                   T
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

In Eq. (1) Ω is a small neighbourhood around the detected bead, 
                           I
                           (
                           
                              
                                 x
                              
                           
                           )
                         is the original image's value for pixel x and 
                           T
                         is the Otsu's threshold calculated in the Ω neighbourhood of the original image [14].

In the morphological operations, roundness R is defined as R
                        =Π(r)/p, where p is the perimeter of the segmented figure, r is the radius of a disc with area equal to the one enclosed by segmented figure and Π(r) is the perimeter of a disc of radius r. Values of R are defined from 0 to 1, with 1 corresponding to a perfect circle.

In all experiments described in this document, segmentation of the large beads was performed using a median filter with radius of 9pix and a threshold of the subtracted image equal to −10. Morphological operations were performed using a circular kernel with a radius of 4pix. Minimum and maximum areas were defined between 90 and 200pix, whereas the minimum roundness threshold was set at 0.95. Segmentation of the small beads was performed using the same pipeline with a different set of parameters: the median filter radius of 6pix and the subtracted image's threshold of −10. Morphological filtering was carried out using a kernel with a radius of 4pix and admitted areas where defined between 30 and 70pix. Roundness cutoff value was kept at 0.95. All these values were chosen emprirically. In addition, a 4th order polynomial interpolation was appended to locate the small beads missing due to occlusions.

The seven large beads are identified using a set of geometrical rules similar to the ones proposed by Zheng and Zhang, determining which belong to the distal plate and which to the proximal one [9]. These are listed in Table 2
                        .

As the distance between the proximal plate and the c-arm's intensifier is negligible in comparison with the focal distance, we can assume that the proximal plate's beads are directly overlayed on the image and, thus, no perspective effects are present. In fact, the separation between beads and the image intensifier is 5mm and c-arms’ focal distances are, normally, around 1000mm. Assuming this, we can describe the transform to the proximal plate's beads from their projections as an affine transform composed of a scaling followed by a rotation and then an offsetting. Mathematically, this can be expressed as follows


                        
                           
                              (3)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            c
                                                            φ
                                                         
                                                         
                                                            −
                                                            s
                                                            φ
                                                         
                                                      
                                                      
                                                         
                                                            s
                                                            φ
                                                         
                                                         
                                                            c
                                                            φ
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                      
                                                         
                                                            0
                                                         
                                                         
                                                            −
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       ︸
                                    
                                    Rotation
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            Δ
                                                            x
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         
                                                            Δ
                                                            y
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       ︸
                                    
                                    Scaling
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                      P
                                                      i
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      y
                                                      P
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            x
                                                            D
                                                            0
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            y
                                                            D
                                                            0
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       ︸
                                    
                                    Offset
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                      D
                                                      i
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      y
                                                      D
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

In Eq. (3) terms Δ
                           x
                         and Δ
                           y
                         are the c-arm's detector pixel sizes in mm. Terms cφ and sφ are the cosine and sine of angle φ, which measures the relative rotation between the calibration drum and the image intensifier. Terms 
                           
                              x
                              D
                              0
                           
                         and 
                           
                              y
                              D
                              0
                           
                         are the coordinates – in mm – of the image corner with respect to the drum's (D) coordinate system. The subscript P denotes the X-ray image's coordinate system. Multiplication of the matrices of Eq. (3) followed by a rearrangement of its terms, leaving Δ
                           x
                        , Δ
                           y
                        , φ, 
                           
                              x
                              D
                              0
                           
                         and 
                           
                              y
                              D
                              0
                           
                         as variables leads to the following linear system


                        
                           
                              (4)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                      P
                                                      i
                                                   
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   
                                                      y
                                                      P
                                                      i
                                                   
                                                
                                                
                                                   1
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   
                                                      x
                                                      P
                                                      i
                                                   
                                                
                                                
                                                   −
                                                   
                                                      y
                                                      P
                                                      i
                                                   
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      Δ
                                                      x
                                                   
                                                   c
                                                   φ
                                                
                                             
                                             
                                                
                                                   
                                                      Δ
                                                      x
                                                   
                                                   s
                                                   φ
                                                
                                             
                                             
                                                
                                                   
                                                      Δ
                                                      y
                                                   
                                                   c
                                                   φ
                                                
                                             
                                             
                                                
                                                   
                                                      Δ
                                                      y
                                                   
                                                   s
                                                   φ
                                                
                                             
                                             
                                                
                                                   
                                                      x
                                                      D
                                                      0
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      y
                                                      D
                                                      0
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                      D
                                                      i
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      y
                                                      D
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Stacking the equation system above for the three proximal beads yields the following system of 6 variables and 6 equations, which can be solved using any suitable algorithm.


                        
                           
                              (5)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                      P
                                                      1
                                                   
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   
                                                      y
                                                      P
                                                      1
                                                   
                                                
                                                
                                                   1
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   
                                                      x
                                                      P
                                                      1
                                                   
                                                
                                                
                                                   −
                                                   
                                                      y
                                                      P
                                                      1
                                                   
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   
                                                      x
                                                      P
                                                      2
                                                   
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   
                                                      y
                                                      P
                                                      2
                                                   
                                                
                                                
                                                   1
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   
                                                      x
                                                      P
                                                      2
                                                   
                                                
                                                
                                                   −
                                                   
                                                      y
                                                      P
                                                      2
                                                   
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   
                                                      x
                                                      P
                                                      3
                                                   
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   
                                                      y
                                                      P
                                                      3
                                                   
                                                
                                                
                                                   1
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   
                                                      x
                                                      P
                                                      3
                                                   
                                                
                                                
                                                   −
                                                   
                                                      y
                                                      P
                                                      3
                                                   
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                
                                                
                                                
                                                
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      Δ
                                                      x
                                                   
                                                   c
                                                   ϕ
                                                
                                             
                                             
                                                
                                                   
                                                      Δ
                                                      x
                                                   
                                                   s
                                                   ϕ
                                                
                                             
                                             
                                                
                                                   
                                                      Δ
                                                      y
                                                   
                                                   c
                                                   ϕ
                                                
                                             
                                             
                                                
                                                   
                                                      Δ
                                                      y
                                                   
                                                   s
                                                   ϕ
                                                
                                             
                                             
                                                
                                                   
                                                      x
                                                      D
                                                      0
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      y
                                                      D
                                                      0
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   30
                                                
                                             
                                             
                                                
                                                   10
                                                
                                             
                                             
                                                
                                                   −
                                                   10
                                                
                                             
                                             
                                                
                                                   30
                                                
                                             
                                             
                                                
                                                   −
                                                   30
                                                
                                             
                                             
                                                
                                                   −
                                                   10
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The solution of Eq. (5) is used to generate the distortion-free pattern of the small beads, which is subtracted from the segmented beads locations generating a vector field. The latter is used in conjunction with a thin-plate spline interpolation algorithm to warp the image undoing the effects of distortion [15], as shown in Fig. 4
                        .

The vector field is also used to update the large beads’ centroids, aiming to improve the following calibration calculations. For the latter, we adhere to the convention that c-arms can be modelled as linear projective cameras [1]. These are fully described by a projection matrix P of the form


                        
                           
                              (6)
                              
                                 
                                    
                                       P
                                    
                                 
                                 =
                                 
                                    
                                       K
                                    
                                 
                                 
                                    
                                       R
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                I
                                             
                                          
                                          |
                                          −
                                          C
                                       
                                    
                                 
                              
                           
                        
                     

In Eq. (6) matrix K represents the intrinsic parameters whereas the extrinsic parameters are described by matrix R and point C. Following the convention of this thesis, extrinsic parameters correspond to the relative displacement and rotation between the calibration drum and the image plane or, in other words, between the coordinate systems D and P.

Matrix K, containing the c-arm's intrinsic parameters, has the following form


                        
                           
                              (7)
                              
                                 
                                    
                                       K
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   −
                                                   f
                                                   /
                                                   
                                                      Δ
                                                      x
                                                   
                                                
                                                
                                                   0
                                                
                                                
                                                   
                                                      x
                                                      P
                                                      C
                                                   
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   −
                                                   f
                                                   /
                                                   
                                                      Δ
                                                      y
                                                   
                                                
                                                
                                                   
                                                      y
                                                      P
                                                      C
                                                   
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Parameters f/Δ
                           x
                         and f/Δ
                           y
                         are the focal distances measured in pixels with f being the focal distance in mm whereas Δ
                           x
                         and Δ
                           y
                         are the already calculated pixel sizes. Parameters 
                           
                              x
                              P
                              C
                           
                         and 
                           
                              y
                              P
                              C
                           
                         are the coordinates, in pixels, of the principal point, that is, the intersection of the normal ray that goes from the imaging plane to the focal point. It has been assumed that skewing is null (i.e. pixels are rectangular and K's top element of its second column is zero). As pixel sizes are fixed, this model for K has only 3 degrees of freedom, which correspond to 
                           
                              x
                              P
                              C
                           
                        , 
                           
                              y
                              P
                              C
                           
                         and f.

As said previously, matrix R represents the rotation between the drum and the c-arm's intensifier, which correspond to the already calculated φ angle. Assuming that no rotation around x and y are present, R can be expressed as follows


                        
                           
                              
                                 
                                    
                                       R
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   c
                                                   φ
                                                
                                                
                                                   −
                                                   s
                                                   φ
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   s
                                                   φ
                                                
                                                
                                                   c
                                                   φ
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   −
                                                   1
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   c
                                                   φ
                                                
                                                
                                                   s
                                                   φ
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   s
                                                   φ
                                                
                                                
                                                   −
                                                   c
                                                   φ
                                                
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Point C corresponds to the focal point position with respect to the drum's (D) frame of reference. As the drum and the intensifier – and thus the image plane – form a rigid body, it is sufficient to know the principal point and focal distance to obtain C, using the solution of Eq. 5.


                        
                           
                              (8)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   C
                                                
                                             
                                             
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         c
                                                         φ
                                                      
                                                      
                                                         s
                                                         φ
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         
                                                            x
                                                            D
                                                            0
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         s
                                                         φ
                                                      
                                                      
                                                         −
                                                         c
                                                         φ
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         
                                                            y
                                                            D
                                                            0
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         −
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       ︸
                                    
                                    
                                       
                                          
                                             
                                                T
                                             
                                          
                                          P
                                          D
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      Δ
                                                      x
                                                   
                                                   
                                                      x
                                                      P
                                                      C
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      Δ
                                                      y
                                                   
                                                   
                                                      y
                                                      P
                                                      C
                                                   
                                                
                                             
                                             
                                                
                                                   f
                                                
                                             
                                             
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Please note that the 4-by-4 right-side matrix of Eq. 8 corresponds to transform 
                           
                              
                                 
                                    T
                                 
                              
                              P
                              D
                           
                        , which takes points from the image's frame to the drum's coordinates. This transform will be used again in Section 4.4.

To estimate P we used a customised version of the widely used DLT algorithm, which obtains the optimal projection matrix between a set of points and their corresponding projections [1]. However, the standard DLT algorithm has 11 degrees of freedom, so its use is not appropriate for the model described by Eqs. (6)–(8), which has only 3. Therefore, a constrained version of the DLT algorithm was used, which iteratively minimises the distance between the segmented points and the projected ones using an estimation of matrix P parametrised by 
                           
                              x
                              P
                              C
                           
                        , 
                           
                              y
                              P
                              C
                           
                         and f.


                        
                           
                              (9)
                              
                                 
                                    
                                       
                                          
                                             
                                                P
                                             
                                          
                                       
                                       ˙
                                    
                                 
                                 =
                                 
                                    
                                       arg
                                       min
                                    
                                    
                                       (
                                       
                                          x
                                          P
                                          C
                                       
                                       ,
                                       
                                          y
                                          P
                                          C
                                       
                                       ,
                                       f
                                       )
                                    
                                 
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    7
                                 
                                 
                                    
                                       |
                                       
                                          
                                             
                                                x
                                             
                                          
                                          P
                                          i
                                       
                                       −
                                       
                                          
                                             
                                                P
                                             
                                          
                                       
                                       (
                                       
                                          x
                                          P
                                          C
                                       
                                       ,
                                       
                                          y
                                          P
                                          C
                                       
                                       ,
                                       f
                                       )
                                       
                                          
                                             
                                                x
                                             
                                          
                                          D
                                          i
                                       
                                       |
                                    
                                    2
                                 
                              
                           
                        
                     

Still, the standard algebraic DLT is used to obtain the starting values of 
                           
                              x
                              P
                              C
                           
                        , 
                           
                              y
                              P
                              C
                           
                         and f before minimisation of Equation 9. Resolution of the latter completes the calibration step.

@&#EVALUATION@&#

We ran a series of experiments to evaluate the proposed algorithm, checking the accuracy of its segmentation and calibration stages, as well as its ability to reconstruct positions of 3D points from their projections. Results are presented in the following subsections.

Segmentation is a crucial step for the algorithm's correct execution, as the correction and calibration stages depend on the centroids found by the segmentation. Therefore, a poor segmentation will inevitably lead to a poor distortion correction and an inaccurate calibration.

To evaluate the segmentation's performance we imaged a radio-opaque human spine model (Sawbones, Vashon, USA) using a Siemens Powermobil c-arm on 12 different angles. Reference segmentations were generated for all X-ray images by averaging the segmentations of 4 raters and, aftwerdars, the algorithm's results were compared with this gold-standard data. Results, shown in Tables 3 and 4
                        
                        , show that the algorithm has sub-pixel accuracy and average errors of 0.45±0.12 pix (0.27±0.07mm) and 0.41±0.05pix (0.16±0.02mm) for the large and small beads respectively (note that, as pixels are not square, smaller pixel error does not necessarily lead to smaller errors in mm). These results are remarkable as they are lower than the average errors reported by Livyatan et al. (0.84±0.48pix/0.36±0.21mm) and also by Zheng and Zhang (0.5±0.3pix/0.18±0.11mm). The average maximum error for the large and small beads was found to be 0.90 pix (0.55mm) and 1.28pix (0.49mm) respectively. Average execution time per image was 3s on an Intel Core Quad Q9550 computer with 4GB of RAM running Windows 7.

We made an additional experiment to evaluate the impact of segmentation noise on the calibration stage. For this, we simulated an image with a pixel size of 0.4 by 0.3636mm (11/10 aspect ratio) with the principal point on (255.5, 255.5) pix and the focal point on (0, 0, −950) mm. Then, we calculated the true projection matrix and obtained the true projections of the drum's large beads onto the image plane. Afterwards, we added noise to the projections and re-calculated the focal point to observe the deviation from the true one. We run the experiments adding uniform noise of [−0.5, 0.5] pix and [−1.0, 1.0] pix, which are reasonable assumptions considering the maximum values observed for the large beads segmentation results shown in Table 3. For each noise level, we used 1000 samples.

The distribution of noise for each coordinate of the focal point were analysed using the Lilliefors test, checking whether it could be considered Gaussian, followed by a one-sample t-test. Results for the 0.5pix noise are shown in Table 5
                        , which shows that the focal point's x and y can be estimated with sub-millimetre precision and that the true mean for z is contained within the confidence interval. The z-coordinate deviation was found to be 18.7704mm, which is 2% of the true focal distance of 950mm. All these results ensure that, at the current noise level, a very accurate estimation of the focal point can be obtained.

Results for the 1.0pix noise are shown in Table 6
                        . The z coordinate is not shown as it null hypothesis of the Lilliefors test was rejected with p
                        =0.00083 and, therefore, its distribution could not be considered Gaussian, as shown also in Fig. 5
                        . The observed distribution had a mean of −954.6648mm and a deviation of 40.2108mm, which is 4% of the true focal distance. The true values for x and y can be estimated at the current noise level although with slightly higher deviations – 1.3442 and 1.4285mm, respectively – which still is a good result. Average execution time was found to be 3.6s on the same machine used for the experiments of the previous section (Intel Core Quad Q9550, 4GB of RAM and Windows 7). Therefore, the c-arm's callibration adds a short execution time to the segmentation procedure (approximately 0.6s) and, overall, the methods fits very well into the requirements expected in a surgical application.

To verify the validity of the proposed method we ran two final experiment to evaluate its capability to find locations of real-world points from their projections on the X-ray images.

For this purpose, we fabricated a calibration phantom object visible to the motion capture cameras and the c-arm, similar to the accuracy checker used by Zheng and Zhang [9]. The phantom, shown in Fig. 6
                        , consists of a plastic structure built using rapid-prototyping techniques with seven embedded 1-mm steel spheres, distributed in an asymmetrical pattern. The latter was carefully chosen to permit the calculation of the relative pose between the c-arm and phantom by localisation of their projections. In addition, the phantom had three reflective markers to permit its tracking by the motion capture cameras. In the first experiment, described in this section, we obtained the real-world position of the phantom by back-projection of the beads segmented on the X-ray images. In the second experiment, we obtained the phantom's pose using the motion capture system.

A total of 19 X-ray images of the phantom were acquired using a Siemens Powermobil c-arm, with the calibration drum mounted on its intensifier. The phantom's centre was placed at an approximate distance of 350mm, which a 36.08% of the c-arm's nominal focal distance of 970mm. The c-arm was rotated around the phantom's long axis in steps of 5°, from 0° (LAT view, image number 0) to 90° (AP view, image number 18). Unfortunately, the operating room's table was not fully radiolucent and its metallic structure occluded large parts of images 3–10, making their calibration impossible. At the end, we were forced to discard these images from the experiment. Distortion was corrected from the remaining images using the proposed algorithm, calculating their corresponding projection matrices as well. The images’ main calibration parameters – that is pixel size and focal point – are given in Table 7
                        . Inspection of the table's data show that pixel sizes are estimated consistently and their theoretical aspect ratio of 11/10 – taken from the c-arm's manuals – is kept at all times. Focal points’ coordinates are given in frame D, meaning that their magnitude in z corresponds to the focal distance, which has an expected value of 970.6±17.85mm. This fits very well with the simulated bounds given on Section 4.2, but these results must be taken with some caution as the focal point is displaced due to the mechanical flexion of the c-arm. In fact, its x coordinate – corresponding to the operating room's vertical axis – goes down as the c-arm approaches its lateral position. The mean value for the y coordinate, less affected by flexion, is 2.199mm and its observed deviation is 0.5695mm, which is even lower than the simulated limits derived on Section 4.2. All this confirms the accuracy of the proposed method.

To calculate the relative pose between the phantom and drum – which means calculation of transform 
                           
                              
                                 
                                    T
                                 
                              
                              F
                              D
                           
                         – we first segmented the phantom beads’ projection on each image, denoted as 
                           
                              
                                 
                                    x
                                 
                              
                              P
                              i
                           
                        , with i
                        =1…7. Then, we defined a set of ground-truth points 
                           
                              
                                 
                                    x
                                 
                              
                              F
                              i
                           
                        , which could be measured accurately from the fabrication blueprints. Transform 
                           
                              
                                 
                                    T
                                 
                              
                              F
                              D
                           
                         was parametrised with vector θ, composed of its Euler angles and offset. Then, we iteratively minimised the sum of squared projection errors, defined as the distances between the segmented points 
                           
                              
                                 
                                    x
                                 
                              
                              P
                              i
                           
                         and the projections of x
                        
                           F
                        . This translates into the following optimisation problem


                        
                           
                              (10)
                              
                                 
                                    
                                       
                                          
                                             
                                                P
                                             
                                          
                                       
                                       ˙
                                    
                                 
                                 =
                                 
                                    
                                       arg
                                       min
                                    
                                    
                                       (
                                       
                                          x
                                          P
                                          C
                                       
                                       ,
                                       
                                          y
                                          P
                                          C
                                       
                                       ,
                                       f
                                       )
                                    
                                 
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    7
                                 
                                 
                                    
                                       |
                                       
                                          
                                             
                                                x
                                             
                                          
                                          P
                                          i
                                       
                                       −
                                       
                                          
                                             
                                                P
                                             
                                          
                                       
                                       (
                                       
                                          x
                                          P
                                          C
                                       
                                       ,
                                       
                                          y
                                          P
                                          C
                                       
                                       ,
                                       f
                                       )
                                       
                                          
                                             
                                                x
                                             
                                          
                                          D
                                          i
                                       
                                       |
                                    
                                    2
                                 
                              
                           
                        
                     

with P being the projection matrix estimated with the calibration algorithm proposed in this work, which remains fixed during the optimisation. Transform 
                           
                              
                                 
                                    
                                       
                                          T
                                       
                                    
                                    F
                                    D
                                 
                              
                              ˙
                           
                         should be the one that registers the phantom's points to the projection geometry defined by matrix P. Note that it is possible to find the transform using a subset of points 
                           
                              
                                 
                                    x
                                 
                              
                              P
                              i
                           
                         and 
                           
                              
                                 
                                    x
                                 
                              
                              F
                              i
                           
                        , although the number of included point pairs must never fall below 3. In fact, it is advisable not to include all point pairs for registration, as doing so may over-fit available data and produce a transform unable to predict the location of points not included for its estimation. In our experiment, we used a subset of 4 point pairs for registration (corresponding to beads 1, 3, 5 and 7 counting from bottom to top in Fig. 6) and the remaining 3 for the calculation of the Target Registration Error (TRE) [16]. The Fiducial Registration Error (FRE) was also calculated using the 4 point pairs used for estimation.

We registered the 11 X-ray images and measured their FRE and TRE, shown in Tables 8 and 9
                        
                        . From the tables’ data it can be seen that FRE has an expected value of 0.40±0.18pix (0.15±0.07mm) whereas TRE has an expected value of 1.40±0.48pix (0.53±0.18mm). Thus, sub-millimetre accuracy is obtained for FRE and TRE, ensuring that the method is capable to predict the location of real-world points which an accuracy level acceptable to surgical standards. These error levels are also good in comparison with other proposed methods. Livyatan et al. reported projection TRE with a mean of 0.92mm and a deviation of 0.26mm [6]. Zheng and Zhang reported a projection TRE of 1.0±0.4 pix which, using their reported pixel dimension of 0.355mm, translates into a mean of 0.355mm and a deviation of 0.142mm [9]. These authors, however, give very few details about their experimental methods, not even citing the used number of images used for their calculations, which casts some doubts about their remarkably low results.

Projection inherently loses information about a point's location along the X-ray's direction. Therefore, a minimum of 2 images acquired in different positions are needed to reconstruct a 3D point. To evaluate our method's capability for reconstruction, we defined all possible image pairs and reconstructed the positions of all phantom's beads which minimised their back-projection errors. Then, we measured the errors between the reconstructed points’ locations and the ground-truth ones taken from the phantom's design. Results for FRE and TRE on all image pairs are shown in Tables 10 and 11
                        
                        , respectively. Mean values for FRE and TRE were estimated to be 0.18±0.12mm and 0.77±0.60mm. These results demonstrate that the method is capable of accurate point reconstruction. In fact, 52 out of the total 55 image pairs have a TRE of less than 2mm and 41 out of 55 pairs have sub-millimetre accuracy. Errors has a tendency to increase if the angular separation between images decreases. In fact, the worst error levels are found on image pairs with a separation of 5°. Removing these image pairs lowers the FRE to 0.15±0.04mm and the TRE to 0.59±0.33mm. Furthermore, removing all image pairs with separation of 10° or less reduced FRE to 0.14±0.02mm and TRE to 0.52±0.26mm. Our algorithm fares well compared with the one proposed by Livyatan et al. The authors evaluated their method using single images – therefore, without point reconstruction – although they reported a back-projection error of 0.59±0.23mm, defined as the minimum distance between the ground-truth point and the ray back-projected from the image plane to the focal point [6]. This error measure, although not equivalent to reconstruction error, should have similar values to the latter. Zheng and Zhang reported a back-projection error of 0.3±0.1mm only [9], although we have already written that we have doubts about their results due to the lack of experimental details given in their publication.

As written on Section 1, calibration drums are normally equipped with reflective markers to enable localisation of the c-arm in the operating room. Ultimately, this is used to detect the locations on which each X-ray image is acquired.

However, use of optical markers brings an additional problem: motion capture systems detect the centre of mass of the attached marker, not the drum's centre. In other words, this means that the optical tracker does not detect system D, instead it detects a new coordinate system denoted by letter X. Therefore, finding transform 
                           
                              
                                 
                                    T
                                 
                              
                              P
                              F
                           
                         requires passing first by frame X
                     


                        
                           
                              (11)
                              
                                 
                                    
                                       
                                          T
                                       
                                    
                                    P
                                    F
                                 
                                 =
                                 
                                    
                                       
                                          T
                                       
                                    
                                    X
                                    F
                                 
                                 
                                    
                                       
                                          T
                                       
                                    
                                    D
                                    X
                                 
                                 
                                    
                                       
                                          T
                                       
                                    
                                    P
                                    D
                                 
                              
                           
                        
                     

In the equation above, 
                           
                              
                                 
                                    T
                                 
                              
                              X
                              F
                           
                         is given by the optical tracker and 
                           
                              
                                 
                                    T
                                 
                              
                              P
                              D
                           
                         was alculated In Eq. 8. Only matrix 
                           
                              
                                 
                                    T
                                 
                              
                              D
                              X
                           
                         is needed to complete the calculation.

Transform 
                           
                              
                                 
                                    T
                                 
                              
                              D
                              X
                           
                         relates the coordinates of the drum's reflective spheres and its fiducial pattern, which remains invariant during the whole procedure. Therefore, calculation of this matrix is required only once and can be performed before the surgery. To do this, we followed the procedure shown in Fig. 7
                        . First, we identify eight screws on the drum's proximal plate, counted in counter-clockwise direction starting from the drum's x axis. These are placed in accurate positions, with respect to frame D, due to the high precision of the machining process. Their z coordinates of the screws’ are measured using a calliper, taking into account that the xy plane lies 5mm below the plate's surface. Afterwards, we measure the screws’ coordinates in frame X with the help of a tracked pointer, also shown in Fig. 7. The tool, previously calibrated using a procedure that is described on [17], is detected by the motion capture system, which calculates its tip's positions with respect to frame X. After this, two sets of corresponding points are obtained, one measured in frame D and the other in frame X. Finally, transform 
                           
                              
                                 
                                    T
                                 
                              
                              D
                              X
                           
                         is computed using Horn's algorithm for registration of point sets [18]. The described procedure is able to compute the transform with a Fiducial Registration Error (FRE) between 0.6 and 1.0mm.

After completion of the calibration procedure described previously, we made a second imaging experiment following the protocol used on Section 4.3. Again, the calibration phantom was placed on the operating table and 19 images separated by 5° were acquired. For each image, its corresponding transform 
                           
                              
                                 
                                    T
                                 
                              
                              D
                              F
                           
                         was measured using the motion capture cameras to locate the X-ray imaging plane with respect to the operating room's coordinate F. Then, all images were calibrated and corrected using the algorithm described in the main sections of this work. Of the total 19 images, 6 had to be discarded due to obstruction of the operating room metallic structure or by failure to identify the drum's large beads. The images’ pixel sizes and focal point are shown in Table 12
                        . Again, it can be observed that pixel sizes are estimated with high consistency as well as the y and z coordinates of the focal point. The latter's displacement along x due to the c-arm's flexion can be observed once again.


                        Table 13
                         shows the TRE for projections of real-world points x
                        
                           F
                         onto the planes of each X-ray image. Note that, as projections were not used for registration in this experiment (pose was determined with the motion capture cameras), it does not make sense to divide errors between FRE and TRE. As all phantom beads are considered target points, only TRE can be defined. Expected value for TRE was 2.63±0.65pix (1.00±0.25mm) and is, thus, higher than the ones shown in Tables 8 and 9 although still remains at acceptable levels. This increment is not surprising, as the use of motion capture adds additional sources of error such cameras’ inaccuracies and the drum's calibration procedure described in the beginning of this section. In fact, the latter's error varies between 0.6 and 1.0mm, which is much higher than the projection errors obtained in the first experiment.

Following the first experiment's protocol, we also measured the TRE between the phantom beads’ true locations and the virtual points reconstructed from their projections on two X-ray images. Results for all possible image pairs are given in Table 14
                        . The expected TRE was found to be 2.50±3.56mm, which is high and has an unacceptable deviation. However, as in the first experiment, it is evident that image pairs formed by radiographs with little angular separation have worse TRE. In fact all elements in the table's diagonal are greater than 2mm (expect for the pair formed by images 2 and 8, which have an actual separation of 30°). Removing image pairs with 5° of separation lowers the expected value to 1.48±1.12mm, whereas removing the ones with 10° or less further reduces the expected TRE to 1.26±0.91mm. Once again, clinically acceptable error levels are attained if a sufficient angular separation is set between the image pair. These results, however, are higher than the ones obtained in the first experiment, in which motion capture was not used. Once again, it must be considered that the latter adds more sources of error, the most important being the calibration inaccuracies of the method for determination of Transform 
                           
                              
                                 
                                    T
                                 
                              
                              D
                              X
                           
                        .

Comparison of results between the first and second experiment show clearly that registration of the c-arm to the reference coordinate frame is more accurate if direct back-projection is used, rather than relying on an motion capture system (although there is still room for improvement with the second). This, however, requires the use of special markers with a radio-opaque section, which should have a set of distinguishable features (such as beads of wires) so they could be easily segmented from the X-ray images. To be clinically acceptable, they should have a reduced size to fit into the c-arms field of view (typical values are in the order of 10cm, which is not very large) and their mounting should have a minimal level of invasiveness, which is not easy in the human spine. Currently, researchers are working markers of this kind, such as the FTRAC originally developed by Jain et al. [19] and later used by Otake et al. for 2D–3D registration of phantom and femur images [20]. Adaptation of these type of markers for spinal interventions raises new challenges which should be addressed in future research.

We have presented a new automatic method for c-arm distortion correction and calibration, based on the use of an attachable drum consisting of parallel plastic plates with embedded radio-opaque beads. The proposed algorithm is fast and accurate. Experimental results have shown that it has a segmentation error of 0.45±0.12pix (0.27±0.07mm) and 0.41±0.05pix (0.16±0.02mm) for the 5mm and 3mm drum's beads. These results are more accurate than other existing methods and permit accurate estimations of the c-arm's focal point with an expected deviation of 4% from the true focal distance.

The proposed method is also capable to accurately estimate the positions of points in space. We made a set of experiments using a phantom with embedded steel beads, of which a subset was used to register each radiograph position with respect to the phantom while the rest was used to asses the registration accuracy. In this scenario, a projection error of 0.53±0.18mm was obtained. Reconstruction of 3D points from their 2D projections was also possible with an observed error of 0.77±0.60mm, which can be effectively lowered to 0.52±0.26mm if a separation of 15° or more was kept between the images used for reconstruction. In all cases, sub-millimetre precision was attained. We also carried out a second experiment on which a motion capture system was used to determine the relative position between the image and phantom, rather than direct back-projection. In this case, we obtained projection errors of 1.00±0.25mm and reconstruction errors of 1.26±0.91mm. These results, although not completely contained in the sub-millimetric range, are acceptable for a surgical application. It is hypothesised that these values could be lowered if a more accurate calibration procedure between the drum and its attached optical markers was implemented.

Present results demonstrate that the proposed method complies with surgical standards and could be effectively used as part of a CAS system. For this goal, the proposed method's integration with a 2D–3D registration algorithm is envisaged for future work. To attain the maximum levels of precision, intensity or gradient based methods will be preferred over feature based ones, as the former use all the images’ pixels to drive the registration [21]. To compensate these methods low speed and reduced capture range (i.e. registration must be started quite close to the optimum solution to converge) a feature-based method is considered as a preliminary manual step. In this way, the radiologist could locate a reduced set of anatomical landmarks and their corresponding projections on the radiographs – a task which is much easier for humans than for machines – and quickly obtain a preliminary solution. Then, and automated intensity-based method could be appended, taking the registration closer to its optimum solution. Improvements on a developed 2D–3D registration framework and integration with the presented calibration methods will be addressed in the immediatefuture.

@&#REFERENCES@&#

