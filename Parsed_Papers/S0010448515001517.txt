@&#MAIN-TITLE@&#A decade of progress on anisotropic mesh adaptation for computational fluid dynamics

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Steady and unsteady error estimates.


                        
                        
                           
                           Adaptive mesh adaptation techniques.


                        
                        
                           
                           Adjoint-based error estimates for Euler equations.


                        
                        
                           
                           Remaining potential challenges for mesh generation.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Metric

Anisotropic mesh adaptation

Continuous mesh framework

Computational fluid dynamic

Inviscid flows

@&#ABSTRACT@&#


               
               
                  In the context of scientific computing, the mesh is used as a discrete support for the considered numerical methods. As a consequence, the mesh greatly impacts the efficiency, the stability and the accuracy of numerical methods. The goal of anisotropic mesh adaptation is to generate a mesh which fits the application and the numerical scheme in order to achieve the best possible solution. It is thus an active field of research which is progressing continuously. This review article proposes a synthesis of the research activity of the INRIA Gamma3 team in the field of anisotropic mesh adaptation applied to inviscid flows in computational fluid dynamics since 2000. It shows the evolution of the theoretical and numerical results during this period. Finally, challenges for the next decade are discussed.
               
            

@&#INTRODUCTION@&#

In the field of computational fluid dynamics (CFD), being able to predict numerically all the features of complex flows around or inside complex geometries remains an unachieved goal. However, such an ability would bring opportunities in a better understanding of complex physical phenomena such as turbulence, vorticity, cavitation, etc. From a rational point of view, a lot of engineering, fundamental, and societal problems could then become completely tractable. Indeed, applications range from aerodynamics, aeroacoustics, bio-engineering, and structure design (dam, turbine, oil platform) to citizen safety with blast mitigations. Consequently, numerical simulation, which is now mature, has become an integral part of the design process in science and engineering. The below computational pipeline emphasizes the central role of meshing in scientific computing: 
                           
                              
                                 CAD
                                 ⟶
                                 MESH
                                 ⟶
                                 SOLVER
                                 ⟶
                                 VISUALIZATION/ANALYSIS  .
                              
                           
                         A simple observation of this chart shows: 
                           
                              no mesh
                           
                           =
                           
                              no simulation
                           
                        . This is why during the late 80’s and the 90’s a considerable amount of effort was devoted to automatic mesh generation. The state-of-the-art of all the meshing technologies is wide  [1], but at present, the main approaches for generality and ease of use in CFD are: multiblock grids  [2], adaptive Cartesian grids  [3] and unstructured mono-element meshes  [4–9]. This first issue is clear, but a second one is more malicious: a “bad” mesh implies a wrong or inaccurate solution. Let us develop this critical issue in scientific computing.

Nowadays, numerical simulations tend to address ever increasing geometrical and physical complexities. The accuracy of geometric models keeps on increasing: if a 10 cm accuracy in the 80’s for a business jet was the standard, 1 mm for the geometry and 1 μm in the boundary layer is now commonplace  [10,11]. As shown in Fig. 1
                        , the considered geometries become more and more complex with a lot of tiny details impacting the flows. For instance, for a military aircraft, all major components of the geometry are modeled such as the empennage, rails, missiles, wings with their leading edge expansions, engine inlet including boundary layer vents, pylons, etc. To illustrate this point, ONERA (the French aerospace lab) flow solver elsA historically used block structured hexahedral meshes, and has recently moved to hybrid meshes to be able to handle tiny details in complex geometries  [12]. The mesh must indeed be adapted to the geometry.

The other major difficulty arises from the underlying non-linear equations governing the physics, for instance, the Navier–Stokes equations. When the difficulty of the meshing process is overcome, the great complexity of the physics often requires tailored meshes for which numerical results can be certified   [12,13]. Such meshes should guarantee the full potential of numerical schemes. However, non-automatic generation of application-fitted meshes leads to time-consuming human intervention. Besides, huge meshes are needed to rely on the numerical solution. In both cases, the CPU time required to run the simulation is prohibitive. Another problem is the certification of industrial simulations. It necessitates at least to perform convergence studies, which require computations on several meshes of different accuracies. Hence, certifying a computation becomes very expensive. Indeed, starting from a 3D mesh of average size 
                           h
                         having 
                           N
                         vertices, a new mesh with 
                           8
                           N
                         vertices is obtained when the mesh size 
                           h
                         is divided by a factor 2. The flow solver time step on this new mesh is also divided by 2 as it is proportional to 
                           h
                        . Therefore, the CPU time to run the simulation on the new mesh is at least multiplied by 16. If, the mesh size is again divided by two, then the CPU time will be multiplied by a factor 256 as compared to the initial one. If the first simulation has run during 1 day, then it will take almost 9 months to get the result of the last one. High performance computing is a possible answer but, we cannot scale indefinitely. Complementary approaches are needed to reduce the complexity of numerical simulations. Mesh adaptation is certainly one of the most powerful tools for this.


                        Why anisotropic mesh adaptation in CFD? The observation of flows patterns and the analyze of their characteristics provides a first answer to this question, see Fig. 2
                        . In CFD, we notice that physical phenomena of interest (boundary layers, shock waves, contact discontinuities, wake, vortices, etc.) are generally concentrated in small regions of the computational domain. Therefore, uniform meshes are not optimal in terms of size. These phenomena are anisotropic by nature, hence uniform meshes are not optimal in terms of direction. Thus, it seems natural to take into account the physical phenomena properties inside the mesh in order to improve their representation.

Mathematically speaking, mesh adaptation aims at generating the optimal mesh to control the accuracy of the numerical solution. Optimal signifies that the best possible accuracy is achieved for a given mesh size, or equivalently, a mesh of minimal size is generated to reach a given accuracy. Thus, it enables substantial gains in CPU time, memory requirement, and storage space. The visualization of the results is also facilitated. Furthermore, error estimates have the capability to detect physical phenomena and capture their behavior. Thus, meshes are automatically adapted in critical regions without any a priori knowledge of the problem.

In this paper, we will show that mesh adaptation is about more than just improving CPU time. Mesh adaptation enhances flow solver numerical methods because meshes are well suited to the physics. It also enables that ability to certify the quality of the mesh used to compute the desired solution, providing more confidence in the numerical result.

The idea of adapting a mesh is very old. A rather large number of papers have been published dealing with mesh adaptation for numerical simulations. In most of these works, the adaptation is isotropic and done by splitting elements based on predefined patterns. The most powerful idea of anisotropic mesh adaptation emerged later at the end of the 80’s thanks to substantial research on error estimates and mesh generation.

In 1987, Peraire et al. proposed a first attempt in 2D by providing error measures involving directions  [14]. They pointed out the directional property of the interpolation error and the idea to generate elements with aspect ratios. They considered a local mapping procedure to generate elongated elements. They coupled this with an advancing front technique to generate slightly anisotropic meshes, i.e., a 1:5 ratio.

Similar approaches have been considered by Löhner  [15], Selmin and Formaggia  [16]. The first attempts in 3D were proposed in the early 90’s by Löhner  [15] and Peraire et al.  [17], but numerical results were almost isotropic and the mesh anisotropy was not clearly visible. In 1994, Zienkiewicz and Wu  [18] gave a qualified status on the subject. Despite some great success with this new approach, they emphasized that: “Unfortunately the amount of elongation which can be used in a typical mesh generation by such mapping is small…”.

Almost at the same time on the meshing side, Mavriplis proposed to generate stretched elements with a Delaunay approach in 2D in order to obtain high-aspect ratio triangles in boundary layers and wake regions required by aeronautic numerical simulations  [19]. In this work, the Delaunay triangulation is performed in a locally stretched space: the idea of the metric has almost emerged. The year after, George, Hecht, and Vallet  [20] introduced the use of metrics in a 2D Delaunay mesh generator to handle anisotropic adapted meshes. This idea generalized all the previous works. They exhibited that the absolute value of the Hessian is a metric. The edge lengths and element volumes inside the mesh generator were computed in the Riemannian metric space defined by the given metric field. They proposed to generate a unit uniform mesh in the Riemannian metric space, this mesh being adapted and anisotropic in the physical space.

The fruitful idea of a metric was widely exploited for 2D anisotropic mesh adaptation in the 90’s and even more today. For instance, among many others, see the works of  [21–25]. In 1997, Baker gave a state-of-the-art  [26] and wrote: “Mesh generation in three dimensions is difficult enough task in the absence of mesh adaptation and it is only recently that satisfactory three-dimensional mesh generators have become available. […]. Mesh alteration in three dimensions is therefore a rather perilous procedure that should be under taken with care”. Indeed, 3D meshing is much more complicated as new pathologies occur. Moreover, the bare existence of such 3D meshes is not guaranteed. Doing 3D anisotropic mesh adaptation is even more complicated.

Meshing blocking points have been partly solved by proposing a local remeshing approach to adapt the mesh. These approaches start from an existing mesh and modify the mesh to adapt. Therefore, there is no more existence problem. At the beginning of the 2000’s, the first results with truly 3D anisotropic mesh adaptation for applications were published  [27–33].

In the meantime, new more accurate anisotropic error estimates had been proposed: a posteriori estimates  [34–36], a priori estimates  [37–40], and goal-oriented estimates for functional outputs  [41–44].

Nowadays, this technology can be considered mature, and impressive results can be obtained. For instance in  [45], a mean anisotropic ratio of 400 and a mean anisotropic quotient of 50,000 are reported for adapted meshes containing more than 50 million tetrahedra.

Thanks to its generality, mesh adaptation has been applied to various fields of investigation and also used with a large panel of numerical methods. In all cases, it has brought large improvements in terms of accuracy and CPU performances. Just to give some 3D examples, it has been applied successfully to the sonic boom simulation  [45], multi-fluid flows  [46,47], blast problems  [48], Stefan problems  [30], and metal forming processes  [49]. Numerical schemes and mesh adaptation have been coupled with Finite Volume  [45], Finite Element  [47], Stabilized Finite Element  [49], and Discontinuous Finite Element  [50] methods, to name a few.

Nowadays, there are a lot of meshing softwares based on the metric concept. Let us cite Bamg   [51] and BL2D   [52] in 2D, Yams   [53] for discrete surface mesh adaptation and EPIC   [54], Feflo.a   [55], Forge3d   [4], Fun3d   [42], Gamanic3d   [56], MAdLib   [57], MeshAdap   [32], Mmg3d   [58], Mom3d   [27], Tango   [29], and Libadaptivity   [28] in 3D. It is worth mentioning that all these softwares have arisen from different mesh generation methods. The method in  [56,51] is based on a global constrained Delaunay kernel. In  [52], the Delaunay method and the frontal approaches are coupled. [53,55,57,58] are based on local mesh modifications, and [4] is based on the minimal volume principle.

Many groups were able to obtain highly anisotropic adapted meshes of high quality for analytical functions. However, when the solution 
                           u
                         becomes a numerical solution 
                           
                              
                                 u
                              
                              
                                 h
                              
                           
                         provided by a flow solver, additional problems arise. We list below all the problems we identified for CFD at the beginning of 2000.


                        Loss of anisotropy when turning to numerical solutions. To illustrate this issue, we consider the standard metric-based error estimate (see Relation (8)), which is a control of the interpolation error in 
                           
                              
                                 L
                              
                              
                                 ∞
                              
                           
                         norm, for the accurate capturing of shock-waves inside a scramjet. This is done by considering a recovered Hessian of one variable of the flow field (Mach, pressure,…). The final result from  [22] is shown in Fig. 3
                        . If the final adapted mesh seems perfectly anisotropic (left), a closer view around a shock reveals a complete loss of the anisotropy (right) for this non-regular solution. In fact, the prescribed minimal size is reached in almost every singularity, leading to an isotropic mesh refinement. This problem arises due to several causes: 
                           
                              •
                              an 
                                    
                                       
                                          L
                                       
                                       
                                          ∞
                                       
                                    
                                  norm error estimate has been used. Indeed, let us consider the Heaviside function with a 
                                    δ
                                    >
                                    0
                                  step: 
                                    u
                                    
                                       (
                                       x
                                       )
                                    
                                    =
                                    δ
                                      if  
                                    x
                                    >
                                    0
                                  and 
                                    u
                                    
                                       (
                                       x
                                       )
                                    
                                    =
                                    0
                                  if 
                                    x
                                    ≤
                                    0
                                 , on the segment 
                                    
                                       [
                                       −
                                       1
                                       ,
                                       1
                                       ]
                                    
                                 . Given a uniform mesh of this domain with size parameter 
                                    h
                                 , then we easily demonstrate that the interpolation error in 
                                    
                                       
                                          L
                                       
                                       
                                          p
                                       
                                    
                                  norm converges at order 
                                    O
                                    
                                       (
                                       
                                          
                                             h
                                          
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   p
                                                
                                             
                                          
                                       
                                       )
                                    
                                 . Therefore, the spatial convergence order is 
                                    O
                                    
                                       (
                                       
                                          
                                             h
                                          
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   p
                                                
                                             
                                          
                                       
                                       )
                                    
                                 . When 
                                    p
                                  tends to infinity, the expected convergence order is 
                                    O
                                    
                                       (
                                       1
                                       )
                                    
                                 . In other words, the 
                                    
                                       
                                          L
                                       
                                       
                                          ∞
                                       
                                    
                                  norm will never converge in presence of discontinuities. The algorithm does not diverge due to the prescription of a minimal size. Thus, an 
                                    
                                       
                                          L
                                       
                                       
                                          ∞
                                       
                                    
                                  error estimate is not suitable for flows with discontinuities. Consequently, 
                                    
                                       
                                          L
                                       
                                       
                                          p
                                       
                                    
                                  strategies become of main interest in the case of discontinuous solutions

we have no guarantee that the recovery techniques used to compute the Hessians provide a smooth metric field, even more for a non-regular flow field. Then, it becomes difficult for the adaptive mesher to work in this irregular metric space which diminishes the resulting anisotropy of the mesh

a non-oscillatory flow solver is required on anisotropic adapted meshes. If the numerical methods present oscillations in shocks (no TVD property), then variations are captured in the direction parallel to the shock wave, which leads to a drastic reduction of the mesh anisotropy. The solver stabilization must therefore be efficient on anisotropic meshes.


                        Capturing all scales of the flow field. A second problem is that a control of the interpolation error in 
                           
                              
                                 L
                              
                              
                                 ∞
                              
                           
                         does not capture the small-scale features of the flow. Several modifications of the 
                           
                              
                                 L
                              
                              
                                 ∞
                              
                           
                         interpolation error estimate have been considered  [22,59,60] to overcome this issue (see Relation (9)). However, such local normalizations are only slightly more sensitive and the control of the interpolation error remains in 
                           
                              
                                 L
                              
                              
                                 ∞
                              
                           
                         norm.


                        Solution accuracy spoiled by interpolations. Solution interpolation is also a key stage in the context of mesh adaptation. Indeed, it links the mesh generation and the numerical flow solver allowing the simulation to be restarted from the previous state. This recurrent stage in adaptive simulations is crucial for time-dependent problems (at least for problems with advection) as the errors introduced by this procedure accumulate throughout the computations. The impact of such errors on the solution accuracy was pointed out with standard linear interpolation. Consequently, interpolation schemes taking into account the properties of the modeled flows need to be found.


                        Adaptive meshers robustness. When a global strategy is employed, the problem of existence of the mesh has to be solved at each remeshing phase. If this procedure fails, then the whole adaptive loop stops, leaving the user without any solution. Knowing that this issue is even more complex when adapted anisotropic surface meshes are considered, different remeshing strategies have to be considered.


                        Some conclusions. These issues illustrate that each step of the mesh adaptation loop must be up-to-date to avoid failure and to achieve the best efficiency. None of these stages can be neglected. If one stage of the adaptation loop fails then all adaptive processes collapse.

This review paper is organized as follows. We first succinctly recall the metric-based mesh generation in Section  2, then Section  3 gives the theoretical framework of anisotropic mesh adaptation which is based on the continuous mesh concept. Section  4describes the application of anisotropic mesh adaptation to steady inviscid flow computations in Computational Fluid Dynamics (CFD), and Section  5, its extension to time-dependent problems. We conclude this article with some remaining challenges for the next decade in Section  6.

The basics of metric-based mesh adaptation such as metric notion, Riemannian metric space, computation of geometric quantities in metric space, and operations on metrics can be found in  [61–63]. Here, we just give an overview of the metric-based mesh generation.

To generate anisotropic meshes, one must be able to prescribe at each point of the domain privileged sizes and orientations for the elements. The use of Riemannian metric spaces is an elegant and efficient way to achieve this goal. The main idea of metric-based mesh adaptation, initially introduced in  [20], is to generate a unit mesh in a prescribed Riemannian metric space.

A tetrahedron 
                        K
                     , defined by its list of edges 
                        
                           
                              
                                 (
                                 
                                    
                                       
                                          e
                                       
                                    
                                    
                                       
                                          i
                                       
                                    
                                 
                                 )
                              
                           
                           
                              i
                              =
                              1
                              .
                              .
                              6
                           
                        
                     , is unit with respect to a metric tensor 
                        M
                      if the length of all its edges is unit in metric 
                        M
                     : 
                        
                           (1)
                           
                              ∀
                              i
                              =
                              1
                              ,
                              …
                              ,
                              6
                              ,
                              
                              
                                 
                                    ℓ
                                 
                                 
                                    M
                                 
                              
                              
                                 (
                                 
                                    
                                       
                                          e
                                       
                                    
                                    
                                       
                                          i
                                       
                                    
                                 
                                 )
                              
                              =
                              1
                                with
                              
                              
                                 
                                    ℓ
                                 
                                 
                                    M
                                 
                              
                              
                                 (
                                 
                                    
                                       
                                          e
                                       
                                    
                                    
                                       
                                          i
                                       
                                    
                                 
                                 )
                              
                              =
                              
                                 
                                    
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          
                                             e
                                          
                                       
                                       
                                          
                                             i
                                          
                                       
                                    
                                    
                                    M
                                    
                                    
                                       
                                          
                                             e
                                          
                                       
                                       
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                              .
                           
                        
                      If all edges of 
                        K
                      are of unit length, then its volume 
                        
                           
                              
                                 |
                                 K
                                 |
                              
                           
                           
                              M
                           
                        
                      in 
                        M
                      is constant equal to: 
                        
                           (2)
                           
                              
                                 
                                    
                                       |
                                       K
                                       |
                                    
                                 
                                 
                                    M
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          2
                                       
                                    
                                 
                                 
                                    12
                                 
                              
                              
                              and
                              
                              
                                 |
                                 K
                                 |
                              
                              =
                              
                                 
                                    
                                       
                                          2
                                       
                                    
                                 
                                 
                                    12
                                 
                              
                              
                                 
                                    
                                       (
                                       det
                                       
                                          (
                                          M
                                          )
                                       
                                       )
                                    
                                 
                                 
                                    −
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              ,
                           
                        
                      where 
                        
                           |
                           K
                           |
                        
                      is its Euclidean volume.

The notion of unit mesh is far more complicated than the notion of unit element as the existence of a mesh composed only of unit regular simplices with respect to a given Riemannian metric space is not guaranteed. Therefore, the notion of unit mesh has to be relaxed. A discrete mesh 
                        H
                      of a domain 
                        Ω
                        ⊂
                        
                           
                              R
                           
                           
                              n
                           
                        
                      is a unit mesh with respect to Riemannian metric space 
                        
                           M
                        
                        =
                        
                           
                              
                                 (
                                 M
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                                 )
                              
                           
                           
                              
                                 x
                              
                              ∈
                              Ω
                           
                        
                      if all its elements are quasi-unit. The definition of unity for an element is relaxed by taking into account technical constraints imposed by mesh generators. For instance, to avoid cycling while analyzing edges lengths in a local remesher, a tetrahedron 
                        K
                      defined by its list of edges 
                        
                           
                              
                                 (
                                 
                                    
                                       
                                          e
                                       
                                    
                                    
                                       
                                          i
                                       
                                    
                                 
                                 )
                              
                           
                           
                              i
                              =
                              1
                              …
                              6
                           
                        
                      is said to be quasi-unit if, 
                        ∀
                        i
                        ,
                        
                        
                           
                              ℓ
                           
                           
                              M
                           
                        
                        
                           (
                           
                              
                                 
                                    e
                                 
                              
                              
                                 
                                    i
                                 
                              
                           
                           )
                        
                        ∈
                        
                           [
                           
                              
                                 1
                              
                              
                                 
                                    
                                       2
                                    
                                 
                              
                           
                           ,
                           
                              
                                 2
                              
                           
                           ]
                        
                      and it has a unit volume.

Using the previous notions, the problem of mesh generation can be considerably simplified. Indeed, whatever the kind of desired mesh (uniform, adapted isotropic, adapted anisotropic), the mesh generator will always generate a unit mesh in the prescribed Riemannian metric space  [20]. Consequently, the generated mesh is uniform and isotropic in the Riemannian metric space while it is adapted and anisotropic in the Euclidean space. This is illustrated in Fig. 4
                     . This idea has turned out to be a huge breakthrough in the generation of anisotropic adapted meshes.

The previous section has emphasized the role of metric tensors and Riemannian metric spaces as useful mathematical tools to prescribe sizes and directions to adaptive meshers. Additionally, these differential geometry notions are more than just a simple tool for mesh generation. In this section, we go further in this analysis and we demonstrate that there is a comprehensive duality between meshes and Riemannian metric spaces. More precisely, Riemannian metric spaces can be seen as continuous models representing meshes. The fundamental consequence is that all kind of mathematical analysis can be performed using such spaces for which powerful mathematical tools are available. Even mathematical problems which could not even be considered on discrete meshes can be addressed in this new framework. More details can be found in  [64,62,65,39].

@&#MOTIVATION@&#

As the use of Riemannian metric fields is well-suited for the generation of anisotropic adapted meshes, we must be able to design suitable metric tensor fields from error estimates. When the solution is assumed to be smooth, a straightforward solution consists in controlling the linear interpolation error. As the linear interpolation error involves the Hessian of the solution, a metric-based estimate is easily derived, see  [14,21,22,38,60]. When solutions are of low regularity, a priori or a posteriori error estimates need to be modified to come up with a metric tensor field, as in  [37,34]. However, both approaches generally involve successive bounds to end up with a metric-based estimate. There are neither specific study on the importance of these approximations nor any guarantee of the veracity of the provided upper bound. In this context, we can still wonder if using metric tensor fields to control such error estimates is a relevant choice. For the linear interpolation error, a lot of numerical examples for real life problems  [29,24,35,28,66,27,60,65] tend to answer affirmatively to this question. In this section, this question is theoretically addressed and the pertinence of the use of metric tensor fields for anisotropic mesh adaptation is assessed.

The following points out the strong duality between discrete entities, e.g. elements and meshes, and continuous mathematical objects, e.g. metric tensors and Riemannian metric spaces. 
                           Proposition 3.1
                           
                              Let 
                              
                                 M
                               
                              be a metric tensor, there exists a non-empty infinite set of unit elements with respect to 
                              
                                 M
                              
                              . Conversely, given an element 
                              
                                 K
                               
                              such that 
                              
                                 
                                    |
                                    K
                                    |
                                 
                                 ≠
                                 0
                              
                              , there is a unique metric tensor 
                              
                                 M
                               
                              for which element 
                              
                                 K
                               
                              is unit with respect to 
                              
                                 M
                              
                              .
                           

The consequence of this proposition is that the function unit with respect to defines classes of equivalences of discrete elements. Thus, in the continuous mesh framework, a metric tensor 
                           M
                         is called continuous element. It is used to model all discrete elements that are unit for 
                           M
                        . Geometric quantities associated with a continuous element can be computed. For instance, according to Relation (2), the volume of a continuous element is given by 
                           
                              
                                 
                                    
                                       2
                                    
                                 
                              
                              
                                 12
                              
                           
                           
                              
                                 
                                    (
                                    det
                                    
                                       (
                                       M
                                       )
                                    
                                    )
                                 
                              
                              
                                 −
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        . Other geometric properties are given in  [62].

Similarly, in the continuous mesh framework, a continuous mesh of a domain 
                           Ω
                         is defined by a collection of continuous elements 
                           
                              M
                           
                           =
                           
                              
                                 
                                    (
                                    M
                                    
                                       (
                                       
                                          x
                                       
                                       )
                                    
                                    )
                                 
                              
                              
                                 
                                    x
                                 
                                 ∈
                                 Ω
                              
                           
                        , i.e., a Riemannian metric space. It is used to model all meshes that are unit for 
                           
                              M
                           
                        . The properties of the continuous mesh can be exhibited by rewriting 
                           
                              M
                           
                         in order to distinguish local properties from global ones: 
                           Proposition 3.2
                           
                              A Riemannian metric space 
                              
                                 
                                    M
                                 
                                 =
                                 
                                    
                                       
                                          (
                                          M
                                          
                                             (
                                             
                                                x
                                             
                                             )
                                          
                                          )
                                       
                                    
                                    
                                       
                                          x
                                       
                                       ∈
                                       Ω
                                    
                                 
                               
                              locally writes:
                              
                                 
                                    
                                       ∀
                                       
                                          x
                                       
                                       ∈
                                       Ω
                                       ,
                                       
                                       M
                                       
                                          (
                                          
                                             x
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             d
                                          
                                          
                                             
                                                
                                                   2
                                                
                                                
                                                   3
                                                
                                             
                                          
                                       
                                       
                                          (
                                          
                                             x
                                          
                                          )
                                       
                                       
                                       R
                                       
                                          (
                                          
                                             x
                                          
                                          )
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         −
                                                         
                                                            
                                                               2
                                                            
                                                            
                                                               3
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         2
                                                      
                                                      
                                                         −
                                                         
                                                            
                                                               2
                                                            
                                                            
                                                               3
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                      
                                                      )
                                                   
                                                
                                                
                                             
                                             
                                                
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         3
                                                      
                                                      
                                                         −
                                                         
                                                            
                                                               2
                                                            
                                                            
                                                               3
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          )
                                       
                                       
                                          
                                          
                                             t
                                          
                                       
                                       R
                                       
                                          (
                                          
                                             x
                                          
                                          )
                                       
                                       ,
                                    
                                 
                              
                              where
                              
                                 
                                    •
                                    
                                       density 
                                       
                                          d
                                        
                                       is equal to: 
                                       
                                          d
                                          =
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                −
                                                1
                                             
                                          
                                       
                                       , with 
                                       
                                          
                                             
                                                λ
                                             
                                             
                                                i
                                             
                                          
                                       
                                       the eigenvalues of 
                                       
                                          M
                                       
                                    


                                       anisotropic quotients 
                                       
                                          
                                             
                                                r
                                             
                                             
                                                i
                                             
                                          
                                        
                                       are equal to: 
                                       
                                          
                                             
                                                r
                                             
                                             
                                                i
                                             
                                          
                                          =
                                          
                                             
                                                h
                                             
                                             
                                                i
                                             
                                             
                                                3
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                −
                                                1
                                             
                                          
                                       
                                    


                                       
                                          R
                                        
                                       is the eigenvectors matrix of 
                                       
                                          M
                                        
                                       representing the orientation.
                                    

The density 
                           d
                         controls only the local level of accuracy of 
                           
                              M
                           
                        . Increasing or decreasing 
                           d
                         does not change the anisotropic properties nor the orientation. The anisotropy property is given by the anisotropic quotients 
                           
                              
                                 r
                              
                              
                                 i
                              
                           
                         and the orientation by matrix 
                           R
                        . We also define the complexity 
                           C
                         of 
                           
                              M
                           
                        : 
                           
                              
                                 C
                                 
                                    (
                                    
                                       M
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       Ω
                                    
                                 
                                 d
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                                 
                                 
                                    d
                                 
                                 
                                    x
                                 
                                 =
                                 
                                    
                                       ∫
                                    
                                    
                                       Ω
                                    
                                 
                                 
                                    
                                       det
                                       
                                          (
                                          M
                                          
                                             (
                                             
                                                x
                                             
                                             )
                                          
                                          )
                                       
                                    
                                 
                                 
                                 
                                    d
                                 
                                 
                                    x
                                 
                                 .
                              
                           
                         This real-value parameter is useful to quantify the global level of accuracy of 
                           
                              
                                 
                                    (
                                    M
                                    
                                       (
                                       
                                          x
                                       
                                       )
                                    
                                    )
                                 
                              
                              
                                 
                                    x
                                 
                                 ∈
                                 Ω
                              
                           
                        . It can also be interpreted as the continuous counterpart of the number of vertices of a discrete mesh.

Now, we aim at applying this framework in the context of error estimation. However, as our intent is to propose a fully discrete–continuous duality, it is not enough to derive only the optimal mesh arising from an interpolation error bound as in classical studies on interpolation error. Instead, we want to evaluate the interpolation error for any function on any continuous mesh without imposing any optimality condition as alignment or equi-distribution, ….

Let 
                           
                              M
                           
                           =
                           
                              
                                 
                                    (
                                    M
                                    
                                       (
                                       
                                          x
                                       
                                       )
                                    
                                    )
                                 
                              
                              
                                 
                                    x
                                 
                                 ∈
                                 Ω
                              
                           
                         be a continuous mesh of a domain 
                           Ω
                         and let 
                           u
                         be a non-linear function which is assumed to be twice continuously differentiable. We seek a well-posed definition of the continuous linear interpolation error 
                           
                              
                                 
                                    ‖
                                    u
                                    −
                                    
                                       
                                          π
                                       
                                       
                                          M
                                       
                                    
                                    u
                                    ‖
                                 
                              
                              
                                 
                                    
                                       L
                                    
                                    
                                       1
                                    
                                 
                                 
                                    (
                                    Ω
                                    )
                                 
                              
                           
                         related to a continuous mesh 
                           
                              
                                 
                                    (
                                    M
                                    
                                       (
                                       
                                          x
                                       
                                       )
                                    
                                    )
                                 
                              
                              
                                 
                                    x
                                 
                                 ∈
                                 Ω
                              
                           
                         which implies a well-posed definition of a linear continuous interpolate 
                           
                              
                                 π
                              
                              
                                 M
                              
                           
                           u
                        . More precisely, we would like the continuous linear interpolation error to be a reliable mathematical model of 
                           
                              
                                 
                                    ‖
                                    u
                                    −
                                    
                                       
                                          Π
                                       
                                       
                                          h
                                       
                                    
                                    u
                                    ‖
                                 
                              
                              
                                 
                                    
                                       L
                                    
                                    
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       
                                          Ω
                                       
                                       
                                          h
                                       
                                    
                                    )
                                 
                              
                           
                         where 
                           
                              
                                 Π
                              
                              
                                 h
                              
                           
                         is defined by a mesh 
                           H
                         of a discretized domain 
                           
                              
                                 Ω
                              
                              
                                 h
                              
                           
                         which is a unit mesh with respect to 
                           
                              
                                 
                                    (
                                    M
                                    
                                       (
                                       
                                          x
                                       
                                       )
                                    
                                    )
                                 
                              
                              
                                 
                                    x
                                 
                                 ∈
                                 Ω
                              
                           
                        . This means that considering 
                           
                              
                                 
                                    ‖
                                    u
                                    −
                                    
                                       
                                          π
                                       
                                       
                                          M
                                       
                                    
                                    u
                                    ‖
                                 
                              
                              
                                 
                                    
                                       L
                                    
                                    
                                       1
                                    
                                 
                                 
                                    (
                                    Ω
                                    )
                                 
                              
                           
                         is equivalent to consider 
                           
                              
                                 
                                    ‖
                                    u
                                    −
                                    
                                       
                                          Π
                                       
                                       
                                          h
                                       
                                    
                                    u
                                    ‖
                                 
                              
                              
                                 
                                    
                                       L
                                    
                                    
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       
                                          Ω
                                       
                                       
                                          h
                                       
                                    
                                    )
                                 
                              
                           
                        .


                        Local interpolation error duality. We consider a quadratic function 
                           u
                         defined on a domain 
                           Ω
                           ⊂
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                        . The function is given by its matrix representation: 
                           
                              
                                 ∀
                                 
                                    x
                                 
                                 ∈
                                 Ω
                                 ,
                                 
                                 u
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                 
                                    
                                    
                                       t
                                    
                                 
                                 
                                    x
                                 
                                 
                                 H
                                 
                                 
                                    x
                                 
                                 ,
                              
                           
                         where 
                           H
                         is a symmetric matrix representing the Hessian of 
                           u
                        . For any symmetric matrix 
                           H
                        , 
                           
                              |
                              H
                              |
                           
                         denotes the positive symmetric matrix deduced from 
                           H
                         by taking the absolute values of its eigenvalues. The function 
                           u
                         is linearly interpolated on a tetrahedron 
                           K
                        . We denote by 
                           
                              
                                 Π
                              
                              
                                 h
                              
                           
                           u
                         the linear interpolate of 
                           u
                         on 
                           K
                        . If 
                           K
                         is now assumed to be unit with respect to 
                           M
                        , we can state the following result: 
                           Theorem 3.1
                           
                              For all unit elements 
                              
                                 K
                               
                              with respect to 
                              
                                 M
                              
                              , the interpolation error of 
                              
                                 u
                               
                              in 
                              
                                 
                                    
                                       L
                                    
                                    
                                       1
                                    
                                 
                               
                              norm does not depend on the element shape and is only a function of the Hessian 
                              
                                 H
                               
                              of 
                              
                                 u
                               
                              and of 
                              
                                 M
                              
                              . In  3D, for all unit tetrahedra 
                              
                                 K
                               
                              with respect to 
                              
                                 M
                              
                              , the following equality holds:
                              
                                 
                                    (3)
                                    
                                       
                                          
                                             
                                                ‖
                                                u
                                                −
                                                
                                                   
                                                      Π
                                                   
                                                   
                                                      h
                                                   
                                                
                                                u
                                                ‖
                                             
                                          
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                K
                                                )
                                             
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             240
                                          
                                       
                                       
                                       det
                                       
                                          (
                                          
                                             
                                                M
                                             
                                             
                                                −
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          )
                                       
                                       
                                       
                                          trace
                                       
                                       
                                          (
                                          
                                             
                                                M
                                             
                                             
                                                −
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                          H
                                          
                                          
                                             
                                                M
                                             
                                             
                                                −
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          )
                                       
                                       .
                                    
                                 
                              
                           

Relation  (3) shows that the infinite set of discrete elements that are unit for a given continuous element 
                           M
                         achieves the same interpolation error. Moreover, it shows that this interpolation error is only expressed with continuous quantities: the continuous element 
                           M
                         and the Hessian of the function 
                           u
                        . Consequently, Theorem 3.1 points out that the metric alone contains enough information to describe completely the linear interpolation error in 
                           
                              
                                 L
                              
                              
                                 1
                              
                           
                         norm. In other words, this theorem confirms that the use of metric-based mesh adaptation is particularly well suited to control anisotropically the interpolation error.


                        Continuous linear interpolate. The main difficulty in defining the continuous linear interpolate is to connect a discrete error computed on an element to a local continuous error model that is defined point-wise. Indeed, the discrete interpolation error in norm 
                           
                              
                                 L
                              
                              
                                 1
                              
                           
                         is integrated on the element 
                           K
                        , whereas a continuous mesh is a function 
                           
                              x
                           
                           ↦
                           M
                           
                              (
                              
                                 x
                              
                              )
                           
                         defined at each point 
                           
                              x
                           
                         of 
                           Ω
                        .

Suppose now that the continuous mesh 
                           
                              
                                 
                                    (
                                    M
                                    
                                       (
                                       
                                          x
                                       
                                       )
                                    
                                    )
                                 
                              
                              
                                 
                                    x
                                 
                                 ∈
                                 Ω
                              
                           
                         is varying and that the function 
                           u
                         is no more quadratic but only twice continuously differentiable. If Equality  (3) of Theorem 3.1 does not hold anymore, all the terms of the right-hand-side 
                           M
                         and 
                           H
                         are well defined continuously. The definition of a continuous interpolate follows up from this consideration.

In the vicinity of 
                           
                              a
                           
                        , 
                           
                              
                                 u
                              
                              
                                 Q
                              
                           
                         is the quadratic approximation of smooth function 
                           u
                         and 
                           
                              
                                 
                                    (
                                    M
                                    
                                       (
                                       
                                          x
                                       
                                       )
                                    
                                    )
                                 
                              
                              
                                 
                                    x
                                 
                                 ∈
                                 Ω
                              
                           
                         reduces to 
                           M
                           
                              (
                              
                                 a
                              
                              )
                           
                         in the tangent space. We can now state the main result providing an equivalence formula between discrete and continuous views locally around a point 
                           
                              a
                           
                         of the domain: 
                           Theorem 3.2
                           
                              Let 
                              
                                 u
                               
                              be a twice continuously differentiable function of a domain 
                              
                                 Ω
                               
                              and 
                              
                                 
                                    
                                       
                                          (
                                          M
                                          
                                             (
                                             
                                                x
                                             
                                             )
                                          
                                          )
                                       
                                    
                                    
                                       
                                          x
                                       
                                       ∈
                                       Ω
                                    
                                 
                               
                              be a continuous mesh of 
                              
                                 Ω
                              
                              . Then, there exists a unique function 
                              
                                 
                                    
                                       π
                                    
                                    
                                       M
                                    
                                 
                               
                              such that:
                              
                                 
                                    
                                       ∀
                                       
                                          a
                                       
                                       ∈
                                       Ω
                                       ,
                                       
                                       
                                          |
                                          u
                                          −
                                          
                                             
                                                π
                                             
                                             
                                                M
                                             
                                          
                                          u
                                          |
                                       
                                       
                                          (
                                          
                                             a
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      ‖
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            Q
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            Π
                                                         
                                                         
                                                            h
                                                         
                                                      
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            Q
                                                         
                                                      
                                                      ‖
                                                   
                                                
                                                
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      (
                                                      K
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                                |
                                                K
                                                |
                                             
                                          
                                       
                                       =
                                       
                                          
                                             1
                                          
                                          
                                             20
                                          
                                       
                                       
                                       
                                          trace
                                       
                                       
                                          (
                                          M
                                          
                                             
                                                
                                                   (
                                                   
                                                      a
                                                   
                                                   )
                                                
                                             
                                             
                                                −
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                          
                                             |
                                             H
                                             
                                                (
                                                
                                                   a
                                                
                                                )
                                             
                                             |
                                          
                                          
                                          M
                                          
                                             
                                                
                                                   (
                                                   
                                                      a
                                                   
                                                   )
                                                
                                             
                                             
                                                −
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          )
                                       
                                       ,
                                    
                                 
                              
                              for every 
                              
                                 K
                               
                              unit element with respect to 
                              
                                 M
                                 
                                    (
                                    
                                       a
                                    
                                    )
                                 
                               
                              and where 
                              
                                 
                                    
                                       u
                                    
                                    
                                       Q
                                    
                                 
                               
                              is the quadratic model of 
                              
                                 u
                               
                              at 
                              
                                 
                                    a
                                 
                              
                              .
                           

This theorem underlines another discrete–continuous duality by pointing out a continuous counterpart of the interpolation error. For this reason, we propose the following formalism: 
                           
                              
                                 π
                              
                              
                                 M
                              
                           
                         is called continuous linear interpolate and 
                           
                              |
                              u
                              −
                              
                                 
                                    π
                                 
                                 
                                    M
                                 
                              
                              u
                              |
                           
                         represents the continuous dual of the interpolation error.

The local interpolation error duality becomes global when the mesh is unit with respect to a constant metric tensor (this does not necessary imply that the mesh is uniform) and when the function is quadratic. In this specific case, by neglecting errors due to the boundary discretization, we have the equality: 
                           
                              
                                 
                                    
                                       
                                          ‖
                                          u
                                          −
                                          
                                             
                                                Π
                                             
                                             
                                                h
                                             
                                          
                                          u
                                          ‖
                                       
                                    
                                    
                                       
                                          
                                             L
                                          
                                          
                                             1
                                          
                                       
                                       
                                          (
                                          
                                             
                                                Ω
                                             
                                             
                                                h
                                             
                                          
                                          )
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ‖
                                          u
                                          −
                                          
                                             
                                                π
                                             
                                             
                                                M
                                             
                                          
                                          u
                                          ‖
                                       
                                    
                                    
                                       
                                          
                                             L
                                          
                                          
                                             1
                                          
                                       
                                       
                                          (
                                          Ω
                                          )
                                       
                                    
                                 
                                 ,
                              
                           
                         for all meshes 
                           H
                         which are unit with respect to 
                           
                              
                                 
                                    (
                                    M
                                    
                                       (
                                       
                                          x
                                       
                                       )
                                    
                                    )
                                 
                              
                              
                                 
                                    x
                                 
                                 ∈
                                 Ω
                              
                           
                        .

Theoretically, the use of a discrete support is no more mandatory to compute the interpolation error. The example below shows that the computation of the discrete interpolation error on a unit mesh 
                           H
                         with respect to 
                           
                              M
                           
                         is an accurate approximation of the continuous interpolation error calculated on 
                           
                              M
                           
                        , even for non quadratic functions and non-constant continuous meshes.


                        Continuous example. The set of 2D continuous meshes 
                           
                              M
                           
                           
                              (
                              α
                              )
                           
                           =
                           
                              
                                 
                                    (
                                    
                                       
                                          M
                                       
                                       
                                          α
                                       
                                    
                                    
                                       (
                                       
                                          x
                                       
                                       )
                                    
                                    )
                                 
                              
                              
                                 
                                    x
                                 
                                 ∈
                                 Ω
                              
                           
                         is defined on square domain 
                           Ω
                           =
                           
                              [
                              0
                              ,
                              1
                              ]
                           
                           ×
                           
                              [
                              0
                              ,
                              1
                              ]
                           
                         by: 
                           
                              
                                 
                                    
                                       M
                                    
                                    
                                       α
                                    
                                 
                                 
                                    (
                                    x
                                    ,
                                    y
                                    )
                                 
                                 =
                                 α
                                 
                                 
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   1
                                                
                                                
                                                   −
                                                   2
                                                
                                             
                                             
                                                (
                                                x
                                                ,
                                                y
                                                )
                                             
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   2
                                                
                                                
                                                   −
                                                   2
                                                
                                             
                                             
                                                (
                                                x
                                                ,
                                                y
                                                )
                                             
                                          
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 h
                              
                              
                                 1
                              
                           
                           
                              (
                              x
                              ,
                              y
                              )
                           
                           =
                           0.1
                           
                              (
                              x
                              +
                              1
                              )
                           
                           +
                           0.05
                           
                              (
                              x
                              −
                              1
                              )
                           
                         and 
                           
                              
                                 h
                              
                              
                                 2
                              
                           
                           
                              (
                              x
                              ,
                              y
                              )
                           
                           =
                           0.2
                        . Parameter 
                           α
                         is used to control the level of accuracy of the mesh. The continuous mesh becomes coarser when 
                           α
                         decreases but anisotropic quotients and orientations remain constant. This trend is given by the computation of complexity 
                           C
                           
                              (
                              
                                 M
                              
                              
                                 (
                                 α
                                 )
                              
                              )
                           
                        : 
                           
                              
                                 C
                                 
                                    (
                                    
                                       M
                                    
                                    
                                       (
                                       α
                                       )
                                    
                                    )
                                 
                                 =
                                 N
                                 
                                    (
                                    α
                                    )
                                 
                                 =
                                 
                                    
                                       ∬
                                    
                                    
                                       Ω
                                    
                                 
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             h
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             h
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    (
                                    x
                                    ,
                                    y
                                    )
                                 
                                 
                                 d
                                 x
                                 d
                                 y
                                 =
                                 
                                    
                                       200
                                    
                                    
                                       3
                                    
                                 
                                 ln
                                 
                                    (
                                    2
                                    )
                                 
                                 α
                                 .
                              
                           
                         The continuous interpolation error on 
                           
                              M
                           
                           
                              (
                              α
                              )
                           
                         is computed for two analytical functions: 
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                           
                              (
                              x
                              ,
                              y
                              )
                           
                           =
                           6
                           
                              
                                 x
                              
                              
                                 2
                              
                           
                           +
                           2
                           x
                           y
                           +
                           4
                           
                              
                                 y
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 u
                              
                              
                                 2
                              
                           
                           
                              (
                              x
                              ,
                              y
                              )
                           
                           =
                           
                              
                                 e
                              
                              
                                 
                                    (
                                    2
                                    
                                       
                                          x
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    y
                                    )
                                 
                              
                           
                        . As regards function 
                           
                              
                                 u
                              
                              
                                 1
                              
                           
                        , the point-wise continuous interpolation error on 
                           
                              M
                           
                           
                              (
                              α
                              )
                           
                         is 
                           
                              
                                 
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          1
                                       
                                    
                                    −
                                    
                                       
                                          π
                                       
                                       
                                          M
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                                 
                                    (
                                    x
                                    ,
                                    y
                                    )
                                 
                                 =
                                 
                                    
                                       27
                                       
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       18
                                       
                                       x
                                       +
                                       35
                                    
                                    
                                       800
                                       
                                       α
                                    
                                 
                                 .
                              
                           
                         The previous expression is then integrated over 
                           Ω
                        : 
                           
                              
                                 
                                    
                                       ∬
                                    
                                    
                                       Ω
                                    
                                 
                                 
                                    |
                                    
                                       
                                          u
                                       
                                       
                                          1
                                       
                                    
                                    −
                                    
                                       
                                          π
                                       
                                       
                                          M
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          1
                                       
                                    
                                    |
                                 
                                 
                                    (
                                    x
                                    ,
                                    y
                                    )
                                 
                                 
                                 d
                                 x
                                 d
                                 y
                                 =
                                 
                                    
                                       53
                                    
                                    
                                       800
                                       
                                       α
                                    
                                 
                                 =
                                 
                                    
                                       53
                                    
                                    
                                       12
                                    
                                 
                                 
                                    
                                       ln
                                       
                                          (
                                          2
                                          )
                                       
                                    
                                    
                                       N
                                       
                                          (
                                          α
                                          )
                                       
                                    
                                 
                                 .
                              
                           
                         For function 
                           
                              
                                 u
                              
                              
                                 2
                              
                           
                        , the point-wise continuous interpolation error on 
                           
                              M
                           
                           
                              (
                              α
                              )
                           
                         is: 
                           
                              
                                 
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          π
                                       
                                       
                                          M
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 
                                    (
                                    x
                                    ,
                                    y
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          
                                             e
                                          
                                          
                                             4
                                             
                                                
                                                   x
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             y
                                          
                                       
                                    
                                    
                                       8
                                       
                                       α
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             (
                                             0.15
                                             x
                                             +
                                             0.05
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                    
                                    
                                       (
                                       4
                                       +
                                       16
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       )
                                    
                                    +
                                    0.05
                                    )
                                 
                                 .
                              
                           
                         By direct integration over 
                           Ω
                        , it comes: 
                           
                              
                                 
                                    
                                       ∬
                                    
                                    
                                       Ω
                                    
                                 
                                 
                                    |
                                    
                                       
                                          u
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          π
                                       
                                       
                                          M
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          2
                                       
                                    
                                    |
                                 
                                 
                                    (
                                    x
                                    ,
                                    y
                                    )
                                 
                                 
                                 d
                                 x
                                 d
                                 y
                                 ≈
                                 
                                    
                                       0.2050950191
                                    
                                    
                                       α
                                    
                                 
                                 ≈
                                 
                                    
                                       13.673
                                       
                                       ln
                                       
                                          (
                                          2
                                          )
                                       
                                    
                                    
                                       N
                                       
                                          (
                                          α
                                          )
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

These analytical evaluations of the continuous interpolation error are compared to the evaluation of the discrete interpolation error on a set of a unit meshes with respect to 
                           
                              M
                           
                           
                              (
                              α
                              )
                           
                         for several values of 
                           α
                        . These evaluations are plotted in Fig. 5
                         where a perfect correlation is observed. The black-plain lines represent the extremal bound of the interpolation error due to the relaxed notion of quasi-unit elements while considering uniform meshes in 
                           
                              M
                           
                           
                              (
                              α
                              )
                           
                         with edges length equal to 
                           
                              
                                 2
                              
                           
                           /
                           2
                         (lower line) and 2 (upper line).

A study with several other continuous examples is presented in  [64].

In its more general form, the problem of mesh adaptation consists in finding the mesh 
                           H
                         of a domain 
                           Ω
                         that minimizes a given error for a given function 
                           u
                        . For the sake of simplicity, we consider here the linear interpolation error 
                           u
                           −
                           
                              
                                 Π
                              
                              
                                 h
                              
                           
                           u
                         controlled in 
                           
                              
                                 L
                              
                              
                                 p
                              
                           
                         norm. Note that considering other norms also works  [38]. The problem is thus stated in an a priori way: 
                           
                              (
                                    P
                                 )
                              
                                 Find  
                                 
                                    
                                       H
                                    
                                    
                                       
                                          opt
                                       
                                    
                                 
                                   having  
                                 N
                                   vertices such that  
                                 
                                    
                                       
                                          E
                                       
                                    
                                    
                                       
                                          
                                             L
                                          
                                          
                                             p
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          H
                                       
                                       
                                          
                                             opt
                                          
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       min
                                    
                                    
                                       H
                                    
                                 
                                 
                                 
                                    
                                       
                                          ‖
                                          u
                                          −
                                          
                                             
                                                Π
                                             
                                             
                                                h
                                             
                                          
                                          u
                                          ‖
                                       
                                    
                                    
                                       
                                          
                                             L
                                          
                                          
                                             p
                                          
                                       
                                       
                                          (
                                          
                                             
                                                Ω
                                             
                                             
                                                h
                                             
                                          
                                          )
                                       
                                    
                                 
                                 .
                              
                           
                        
                        
                           
                              
                                 (
                                 P
                                 )
                              
                           
                         is a global combinatorial problem which turns out to be intractable practically. Indeed, this would require the simultaneous optimization of both the mesh topology and the vertices location. Consequently, simpler problems are considered to approximate the solution. A common simplification is to perform a local analysis of the error instead of considering the global problem. A first set of methods consists in deriving the optimal element shape [67,68]. A second set consists in deriving a local bound of the interpolation error. This bound is then transformed into a metric-based estimate  [37,38,34,60]. Direct minimization of the error can also be considered by using directly the interpolation error as a cost function in the mesh generator  [69]. All these strategies have in common the resolution of a local problem as they act in the vicinity of an element. Consequently, such error minimizations are equivalent to a steepest descent algorithm that converges only to a local minimum with poor convergence properties. This drawback arises because a minimization on a discrete mesh is directly considered.

We propose to address the resolution of 
                           
                              
                                 (
                                 P
                                 )
                              
                           
                         in a continuous setting. Consequently, 
                           
                              
                                 (
                                 P
                                 )
                              
                           
                         is recast as a continuous optimization problem where the discrete interpolation error is replaced by the continuous one: 
                           
                              
                                 Find  
                                 
                                    
                                       
                                          M
                                       
                                    
                                    
                                       
                                          opt
                                       
                                    
                                 
                                   having a complexity of  
                                 N
                                   such that  
                                 
                                    
                                       
                                          E
                                       
                                    
                                    
                                       
                                          
                                             L
                                          
                                          
                                             p
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             M
                                          
                                       
                                       
                                          
                                             opt
                                          
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       min
                                    
                                    
                                       
                                          M
                                       
                                    
                                 
                                 
                                 
                                    
                                       
                                          ‖
                                          u
                                          −
                                          
                                             
                                                π
                                             
                                             
                                                M
                                             
                                          
                                          u
                                          ‖
                                       
                                    
                                    
                                       
                                          
                                             L
                                          
                                          
                                             p
                                          
                                       
                                       
                                          (
                                          Ω
                                          )
                                       
                                    
                                 
                                 .
                              
                           
                         Contrary to discrete-based studies, the continuous formulation succeeds in solving globally the optimal interpolation error problem by using powerful mathematical tools such as calculus of variations.


                        Optimal continuous mesh. Using the definition of the linear continuous interpolate 
                           
                              
                                 π
                              
                              
                                 M
                              
                           
                        , it is then possible to set the well-posed global optimization problem of finding the optimal continuous mesh minimizing the continuous interpolation error in 
                           
                              
                                 L
                              
                              
                                 p
                              
                           
                         norm: 
                           
                              (4)
                              
                                 Find  
                                 
                                    
                                       
                                          M
                                       
                                    
                                    
                                       
                                          
                                             L
                                          
                                          
                                             p
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       min
                                    
                                    
                                       
                                          M
                                       
                                    
                                 
                                 
                                    
                                       
                                          E
                                       
                                    
                                    
                                       
                                          
                                             L
                                          
                                          
                                             p
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       M
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          (
                                          
                                             
                                                ∫
                                             
                                             
                                                Ω
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   u
                                                   
                                                      (
                                                      
                                                         x
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      
                                                         π
                                                      
                                                      
                                                         M
                                                      
                                                   
                                                   u
                                                   
                                                      (
                                                      
                                                         x
                                                      
                                                      )
                                                   
                                                   )
                                                
                                             
                                             
                                                p
                                             
                                          
                                          
                                          
                                             d
                                          
                                          
                                             x
                                          
                                          )
                                       
                                    
                                    
                                       
                                          
                                             1
                                          
                                          
                                             p
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          (
                                          
                                             
                                                ∫
                                             
                                             
                                                Ω
                                             
                                          
                                          
                                             trace
                                          
                                          
                                             
                                                
                                                   (
                                                   M
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               x
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         −
                                                         
                                                            
                                                               1
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      |
                                                      
                                                         
                                                            H
                                                         
                                                         
                                                            u
                                                         
                                                      
                                                      
                                                         (
                                                         
                                                            x
                                                         
                                                         )
                                                      
                                                      |
                                                   
                                                   M
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               x
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         −
                                                         
                                                            
                                                               1
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                p
                                             
                                          
                                          
                                          
                                             d
                                          
                                          
                                             x
                                          
                                          )
                                       
                                    
                                    
                                       
                                          
                                             1
                                          
                                          
                                             p
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                         under the constraint 
                           C
                           
                              (
                              
                                 M
                              
                              )
                           
                           =
                           
                              
                                 ∫
                              
                              
                                 Ω
                              
                           
                           d
                           
                              (
                              
                                 x
                              
                              )
                           
                           
                           
                              d
                           
                           
                              x
                           
                           =
                           N
                        .

The constraint on the complexity is added to avoid the trivial solution where all 
                           
                              
                                 
                                    (
                                    
                                       
                                          h
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                              
                              
                                 i
                                 =
                                 1
                                 ,
                                 3
                              
                           
                         are zero which provides a null error. Contrary to a discrete analysis, this problem can be solved globally by using calculus of variations that is well-defined on the space of continuous meshes. In  [64], it is proved that Problem  (4) admits a unique solution. In addition, the following properties hold: 
                           Theorem 3.3
                           
                              Let 
                              
                                 u
                               
                              be a twice continuously differentiable function defined on 
                              
                                 Ω
                                 ⊂
                                 
                                    
                                       R
                                    
                                    
                                       3
                                    
                                 
                              
                              , 
                              
                                 
                                    
                                       H
                                    
                                    
                                       u
                                    
                                 
                               
                              its Hessian, the optimal continuous mesh 
                              
                                 
                                    
                                       
                                          M
                                       
                                    
                                    
                                       
                                          
                                             L
                                          
                                          
                                             p
                                          
                                       
                                    
                                 
                                 
                                    (
                                    u
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          (
                                          
                                             
                                                M
                                             
                                             
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      p
                                                   
                                                
                                             
                                          
                                          
                                             (
                                             x
                                             )
                                          
                                          )
                                       
                                    
                                    
                                       x
                                       ∈
                                       Ω
                                    
                                 
                               
                              minimizing Problem   (4)   locally reads:
                              
                                 
                                    (5)
                                    
                                       
                                          
                                             M
                                          
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   p
                                                
                                             
                                          
                                       
                                       
                                          (
                                          
                                             x
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             N
                                          
                                          
                                             
                                                
                                                   2
                                                
                                                
                                                   3
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      ∫
                                                   
                                                   
                                                      Ω
                                                   
                                                
                                                
                                                det
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            |
                                                            
                                                               
                                                                  H
                                                               
                                                               
                                                                  u
                                                               
                                                            
                                                            
                                                               (
                                                               
                                                                  
                                                                     
                                                                        x
                                                                     
                                                                  
                                                                  
                                                                     ̄
                                                                  
                                                               
                                                               )
                                                            
                                                            |
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            2
                                                            p
                                                            +
                                                            3
                                                         
                                                      
                                                   
                                                
                                                
                                                
                                                   d
                                                
                                                
                                                   
                                                      
                                                         x
                                                      
                                                   
                                                   
                                                      ̄
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             −
                                             
                                                
                                                   2
                                                
                                                
                                                   3
                                                
                                             
                                          
                                       
                                       det
                                       
                                          
                                             
                                                (
                                                
                                                   |
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                      
                                                      )
                                                   
                                                   |
                                                
                                                )
                                             
                                          
                                          
                                             
                                                
                                                   −
                                                   1
                                                
                                                
                                                   2
                                                   p
                                                   +
                                                   3
                                                
                                             
                                          
                                       
                                       
                                       
                                          |
                                          
                                             
                                                H
                                             
                                             
                                                u
                                             
                                          
                                          
                                             (
                                             
                                                x
                                             
                                             )
                                          
                                          |
                                       
                                       .
                                    
                                 
                              
                              It verifies the following properties:
                              
                                 
                                    •
                                    
                                       
                                          
                                             
                                                
                                                   M
                                                
                                             
                                             
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      p
                                                   
                                                
                                             
                                          
                                          
                                             (
                                             u
                                             )
                                          
                                        
                                       is unique
                                    


                                       
                                          
                                             
                                                
                                                   M
                                                
                                             
                                             
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      p
                                                   
                                                
                                             
                                          
                                          
                                             (
                                             u
                                             )
                                          
                                        
                                       is locally aligned with the eigenvectors basis of 
                                       
                                          
                                             
                                                H
                                             
                                             
                                                u
                                             
                                          
                                        
                                       and has the same anisotropic quotients as 
                                       
                                          
                                             
                                                H
                                             
                                             
                                                u
                                             
                                          
                                       
                                    


                                       
                                          
                                             
                                                
                                                   M
                                                
                                             
                                             
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      p
                                                   
                                                
                                             
                                          
                                          
                                             (
                                             u
                                             )
                                          
                                        
                                       provides an optimal explicit bound of the interpolation error in 
                                       
                                          
                                             
                                                L
                                             
                                             
                                                p
                                             
                                          
                                        
                                       norm:
                                       
                                          
                                             (6)
                                             
                                                
                                                   
                                                      
                                                         ‖
                                                         u
                                                         −
                                                         
                                                            
                                                               π
                                                            
                                                            
                                                               
                                                                  
                                                                     M
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           L
                                                                        
                                                                        
                                                                           p
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         u
                                                         ‖
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            L
                                                         
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         (
                                                         Ω
                                                         )
                                                      
                                                   
                                                
                                                =
                                                3
                                                
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      −
                                                      
                                                         
                                                            2
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               ∫
                                                            
                                                            
                                                               Ω
                                                            
                                                         
                                                         det
                                                         
                                                            
                                                               
                                                                  (
                                                                  
                                                                     |
                                                                     
                                                                        
                                                                           H
                                                                        
                                                                        
                                                                           u
                                                                        
                                                                     
                                                                     |
                                                                  
                                                                  )
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                                  
                                                                     2
                                                                     p
                                                                     +
                                                                     3
                                                                  
                                                               
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            2
                                                            p
                                                            +
                                                            3
                                                         
                                                         
                                                            3
                                                            p
                                                         
                                                      
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    


                                       For a sequence of continuous meshes having an increasing complexity with the same orientation and anisotropic quotients 
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            M
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               L
                                                            
                                                            
                                                               p
                                                            
                                                         
                                                      
                                                      
                                                         N
                                                      
                                                   
                                                   
                                                      (
                                                      u
                                                      )
                                                   
                                                   )
                                                
                                             
                                             
                                                N
                                                =
                                                1
                                                …
                                                ∞
                                             
                                          
                                       
                                       , the asymptotic order of convergence verifies:
                                       
                                          
                                             (7)
                                             
                                                
                                                   
                                                      
                                                         ‖
                                                         u
                                                         −
                                                         
                                                            
                                                               π
                                                            
                                                            
                                                               
                                                                  
                                                                     M
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           L
                                                                        
                                                                        
                                                                           p
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     N
                                                                  
                                                               
                                                            
                                                         
                                                         u
                                                         ‖
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            L
                                                         
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         (
                                                         Ω
                                                         )
                                                      
                                                   
                                                
                                                ≤
                                                
                                                   
                                                      C
                                                      s
                                                      t
                                                   
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            2
                                                            /
                                                            3
                                                         
                                                      
                                                   
                                                
                                                .
                                             
                                          
                                       
                                       Relation   (7)   points out a global second order of mesh convergence.
                                    

Note that passing to the limit for 
                           p
                           →
                           ∞
                         leads to the classical metric given by Relation  (8) that controls the interpolation error in 
                           
                              
                                 L
                              
                              
                                 ∞
                              
                           
                         norm as used in  [22,60].


                        Analytical example. For analytic functions, the mesh adaptation algorithm is the following:


                        
                           
                              
                           
                        
                     

This example aims at exemplifying the second order mesh convergence as well as illustrating the different behaviors of the 
                           
                              
                                 L
                              
                              
                                 p
                              
                           
                         norms by quantifying the impact of the local normalization term 
                           
                              
                                 
                                    (
                                    det
                                    
                                       |
                                       
                                          
                                             H
                                          
                                          
                                             u
                                          
                                       
                                       |
                                    
                                    )
                                 
                              
                              
                                 
                                    
                                       2
                                       p
                                       +
                                       3
                                    
                                    
                                       p
                                    
                                 
                              
                           
                        . We consider the smooth function 
                           f
                         defined on 
                           
                              [
                              −
                              1
                              ,
                              1
                              ]
                           
                           ×
                           
                              [
                              −
                              1
                              ,
                              1
                              ]
                           
                        : 
                           
                              
                                 f
                                 
                                    (
                                    x
                                    ,
                                    y
                                    )
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             0.01
                                             sin
                                             
                                                (
                                                x
                                                y
                                                )
                                             
                                          
                                          
                                             if  
                                             x
                                             y
                                             <
                                             
                                                
                                                   π
                                                
                                                
                                                   50
                                                
                                             
                                          
                                       
                                       
                                          
                                             sin
                                             
                                                (
                                                50
                                                x
                                                y
                                                )
                                             
                                          
                                          
                                             if  
                                             
                                                
                                                   π
                                                
                                                
                                                   50
                                                
                                             
                                             ≤
                                             x
                                             y
                                             ≤
                                             2
                                             
                                                
                                                   π
                                                
                                                
                                                   50
                                                
                                             
                                          
                                       
                                       
                                          
                                             0.01
                                             sin
                                             
                                                (
                                                50
                                                x
                                                y
                                                )
                                             
                                          
                                          
                                             if  
                                             x
                                             y
                                             >
                                             2
                                             
                                                
                                                   π
                                                
                                                
                                                   50
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           f
                         is composed of small and large scales with an amplitude of 0.01 and 1, Fig. 6
                        . Mesh adaptations based on 
                           
                              
                                 L
                              
                              
                                 1
                              
                           
                        , 
                           
                              
                                 L
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 L
                              
                              
                                 4
                              
                           
                         norms are performed. As predicted by the theory, the second order mesh convergence is reached for all norms. More than 10,000 vertices are required to reach this asymptotic order of convergence. The convergence plot, Fig. 6, can be decomposed into three parts: 
                           
                              (i)
                              a second order mesh convergence part (from 100 to 2000 vertices). In this region, only the main sinusoidal variations are accurately captured whereas small scales are ignored. Consequently, a second order mesh convergence arises from these main scales

a first order mesh convergence part (from 2000 to 10,000 vertices) where the mesh size is small enough to capture small variations of the function. At this time, the error committed on these small fluctuations becomes preponderant

the final asymptotic second order convergence part (from 10,000 to 100,000 vertices) when all scales of the function are captured by the mesh.

As 
                           p
                         increases, the second part is shifted to the right, or equivalently, the number of nodes increases. Consequently, the 
                           
                              
                                 L
                              
                              
                                 1
                              
                           
                         norm captures these small scales earlier. For instance, if we look at adapted meshes containing 7000 vertices, small scales are well refined with 
                           
                              
                                 L
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 L
                              
                              
                                 2
                              
                           
                         norms whereas they are ignored by the 
                           
                              
                                 L
                              
                              
                                 4
                              
                           
                         norm, see Fig. 7
                        .

We can quickly recall the evolution of the interpolation error estimate. Initially, the optimal metric was defined to equally distribute the interpolation error over the mesh  [20] and given by: 
                           
                              (8)
                              
                                 
                                    
                                       M
                                    
                                    
                                       
                                          
                                             L
                                          
                                          
                                             ∞
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             c
                                          
                                          
                                             d
                                          
                                       
                                    
                                    
                                       ε
                                    
                                 
                                 
                                    |
                                    
                                       
                                          H
                                       
                                       
                                          u
                                       
                                    
                                    |
                                 
                              
                           
                         where 
                           
                              
                                 c
                              
                              
                                 d
                              
                           
                         is a constant depending on the dimension and 
                           ε
                         is the error threshold. The problem is that such estimate was not able to accurately capture all the scales of the solution as large amplitude phenomena (like shock waves and boundary layer) tend to mask weaker phenomena (like vortices and recirculation). Several modifications of this Hessian-based estimate have been considered to overcome this issue. For instance, the following local normalizations: 
                           
                              (9)
                              
                                 
                                    
                                       M
                                    
                                    
                                       
                                          
                                             L
                                          
                                          
                                             ∞
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          |
                                          H
                                          |
                                       
                                    
                                    
                                       
                                          |
                                          u
                                          |
                                       
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       M
                                    
                                    
                                       
                                          
                                             L
                                          
                                          
                                             ∞
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          |
                                          H
                                          |
                                       
                                    
                                    
                                       
                                          |
                                          u
                                          |
                                       
                                       +
                                       h
                                       
                                       
                                          
                                             
                                                ‖
                                                ∇
                                                u
                                                ‖
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       M
                                    
                                    
                                       
                                          
                                             L
                                          
                                          
                                             ∞
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          |
                                          H
                                          |
                                       
                                    
                                    
                                       γ
                                       
                                          |
                                          u
                                          |
                                       
                                       +
                                       
                                          (
                                          1
                                          −
                                          γ
                                          )
                                       
                                       h
                                       
                                          
                                             
                                                ‖
                                                ∇
                                                u
                                                ‖
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                         were introduced in  [22,59,60], respectively, as an attempt to capture all the scales of the solution. However, such local normalizations are only slightly more sensitive and the control of the interpolation error remains in 
                           
                              
                                 L
                              
                              
                                 ∞
                              
                           
                         norm.

Moreover, a control of the interpolation error in 
                           
                              
                                 L
                              
                              
                                 ∞
                              
                           
                         norm does not converge in discontinuities and thus leads to a loss of anisotropy in such regions  [65]. All the benefits of anisotropic mesh adaptation are lost.

A control of the interpolation error in 
                           
                              
                                 L
                              
                              
                                 p
                              
                           
                         norm solves all these issues and is of main interest in the case of multiscale or discontinuous solutions. The optimal metric is given by Relation (5): 
                           
                              
                                 
                                    
                                       M
                                    
                                    
                                       
                                          
                                             L
                                          
                                          
                                             p
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       D
                                    
                                    
                                       
                                          
                                             L
                                          
                                          
                                             p
                                          
                                       
                                    
                                 
                                 
                                 det
                                 
                                    
                                       
                                          (
                                          
                                             |
                                             
                                                
                                                   H
                                                
                                                
                                                   u
                                                
                                             
                                             |
                                          
                                          )
                                       
                                    
                                    
                                       
                                          
                                             −
                                             1
                                          
                                          
                                             2
                                             p
                                             +
                                             3
                                          
                                       
                                    
                                 
                                 
                                 
                                    |
                                    
                                       
                                          H
                                       
                                       
                                          u
                                       
                                    
                                    |
                                 
                                 .
                              
                           
                        
                     

This section presents two metric-based anisotropic mesh adaptation approaches for steady problems in CFD: 
                        
                           •
                           The first method is the feature-based anisotropic mesh adaptation (Section  4.3). The goal is to derive the best mesh to compute the characteristics of a given sensor 
                              
                                 w
                              . Many works have been done on this topic, among them  [27,28,34,35,29,32,60,31,46] ….

The second method is the goal-oriented anisotropic mesh adaptation (Section  4.4). It aims at deriving the best mesh to observe a given scalar functional 
                              
                                 j
                                 
                                    (
                                    w
                                    )
                                 
                                 =
                                 
                                    (
                                    g
                                    ,
                                    w
                                    )
                                 
                              . Less work are available in the literature as the anisotropy is hard to prescribe in such framework  [41,42,70–73].

At the end of the 90’s, a lot of successful examples on real-life problems have proved the efficiency of metric-based anisotropic mesh adaptation to improve the ratio between solution accuracy and the number of degrees of freedom. Nevertheless, several issues remain in order to attain efficient adaptive methods for numerical computations and to assess adaptive computations. They are mainly related to the fact that we are now working with numerical solutions. For instance, several questions remain on the optimality of the mesh, the assessment of the numerical solution, the convergence of the computation according to the expected theoretical order, the automatic detection and capturing of all the scales of the solution, … Consequently, answering positively to these questions is not straightforward as we face both theoretical and practical difficulties. We briefly recall all the difficulties and the way to cope with them.


                        Approximation error. In the context of numerical simulations, we seek for the best mesh approximating the smooth solution 
                           u
                         of a steady scalar PDE over a domain 
                           Ω
                         of 
                           
                              
                                 R
                              
                              
                                 d
                              
                           
                        . The considered problem of mesh adaptation consists in finding the mesh 
                           H
                         of 
                           Ω
                         that minimizes the approximation error 
                           u
                           −
                           
                              
                                 u
                              
                              
                                 h
                              
                           
                         in 
                           
                              
                                 L
                              
                              
                                 p
                              
                           
                         norm. The problem is thus stated in an a priori way: 
                           
                              (10)
                              
                                 Find  
                                 
                                    
                                       H
                                    
                                    
                                       
                                          
                                             L
                                          
                                          
                                             p
                                          
                                       
                                    
                                 
                                   having  
                                 N
                                   vertices such that  
                                 
                                    
                                       E
                                    
                                    
                                       
                                          
                                             L
                                          
                                          
                                             p
                                          
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          H
                                       
                                       
                                          
                                             
                                                L
                                             
                                             
                                                p
                                             
                                          
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       min
                                    
                                    
                                       H
                                    
                                 
                                 
                                    
                                       
                                          (
                                          
                                             
                                                ∫
                                             
                                             
                                                
                                                   
                                                      Ω
                                                   
                                                   
                                                      h
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   u
                                                   
                                                      (
                                                      
                                                         x
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                      
                                                      )
                                                   
                                                   )
                                                
                                             
                                             
                                                p
                                             
                                          
                                          
                                             d
                                          
                                          
                                             x
                                          
                                          )
                                       
                                    
                                    
                                       
                                          
                                             1
                                          
                                          
                                             p
                                          
                                       
                                    
                                 
                                 .
                              
                           
                         As compared to the previous section, the solution 
                           u
                         is unknown and we need to control the error between the solution and its numerical approximation 
                           
                              
                                 u
                              
                              
                                 h
                              
                           
                         provided by a numerical flow solver. We have to specify the link between the approximation error and the interpolation error.


                        Efficient anisotropic mesh adaptation for numerical simulations. We have seen in Section  1.3 two main problems which considerably limit the efficiency of anisotropic mesh adaptation: (i) loss of anisotropy and (ii) capture of all scales of the flow.

As already observed in the previous section, considering a control of the interpolation error in 
                           
                              
                                 L
                              
                              
                                 p
                              
                           
                         norm enables the ability to capture all the scales of analytical functions. The same behavior for numerical solutions involving multiscale physical phenomena is therefore expected. Indeed, numerical experiments show that solution scales that have an amplitude 1000 times lower than the largest one are still captured and refined. The use of 
                           
                              
                                 L
                              
                              
                                 p
                              
                           
                         norm instead of 
                           
                              
                                 L
                              
                              
                                 ∞
                              
                           
                         one also enables the ability to achieve convergence in singularities. From a practical point of view, prescribing a minimal size is no longer required. This results in the generation of highly anisotropic meshes.

However, canceling out loss of anisotropy in singularities also requires a stable numerical method on anisotropic meshes and a metric gradation to regularize and control the variation of the prescribed metric field. Indeed, metric fields are computed from a numerical solution which may contain steep gradients and discontinuities. Hence, non-smooth metric fields can be obtained.


                        Early asymptotic convergence. If the previous features of unstructured mesh adaptation are quite classical, we insist here that mesh adaptation has further consequences impacting directly numerical schemes used to approximate the flow. Indeed, a loss of convergence order generally occurs due to the presence of steep gradients (Navier–Stokes equations) or genuine discontinuities (Euler equations) in the flow, despite the use of a provably spatially high order method. The computed mesh convergence order on uniformly refined meshes is not the theoretical expected one. In the previous section, we have demonstrated that an asymptotic second order mesh convergence is easily obtained for smooth functions thanks to mesh adaptation in 
                           
                              
                                 L
                              
                              
                                 p
                              
                           
                         norm. Here, we show that the theoretical convergence order of numerical schemes (here a modern second-order shock capturing solver) is also recovered thanks to anisotropic mesh adaptation, even if discontinuities are present in the flow field. Verifying numerically this second order of convergence can be considered as a first assessment of computations.

Anisotropic mesh adaptation is a non-linear problem, therefore an iterative procedure is required to solve this problem. For stationary simulations, an adaptive computation is carried out via a mesh adaptation loop inside which an algorithmic convergence of the mesh-solution couple is sought. This mesh adaptation loop is schematized in Algorithm 2 where 
                           H
                        , 
                           S
                         and 
                           M
                         denote respectively meshes, solutions and metrics.


                        
                           
                              
                           
                        
                     

The metric field gradation (step 3) is discussed in  [61] and the interpolation stage (step 5) is detailed in  [74,75]. Steps 1, 2 and 4 are described below.


                        The flow solver
                        Wolf. All the numerical simulations of this review article are concerned with the compressible Euler equations. Results on Navier–Stokes equation such as  [76] are not discussed. Assuming that the gas is perfect, inviscid and that there is no thermal diffusion, the 3D compressible Euler equations for mass, momentum and energy conservation read: 
                           
                              (11)
                              
                                 
                                    
                                       ∂
                                       W
                                    
                                    
                                       ∂
                                       t
                                    
                                 
                                 +
                                 ∇
                                 ⋅
                                 F
                                 
                                    (
                                    W
                                    )
                                 
                                 =
                                 0
                                 ,
                              
                           
                         where 
                           W
                         is the vector of conservative variables and 
                           F
                         is the convection operator 
                           F
                           
                              (
                              W
                              )
                           
                           =
                           
                              (
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                              
                              
                                 (
                                 W
                                 )
                              
                              ,
                              
                                 
                                    F
                                 
                                 
                                    2
                                 
                              
                              
                                 (
                                 W
                                 )
                              
                              ,
                              
                                 
                                    F
                                 
                                 
                                    3
                                 
                              
                              
                                 (
                                 W
                                 )
                              
                              )
                           
                         with: 
                           
                              
                                 W
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             ρ
                                          
                                       
                                       
                                          
                                             ρ
                                             u
                                          
                                       
                                       
                                          
                                             ρ
                                             v
                                          
                                       
                                       
                                          
                                             ρ
                                             w
                                          
                                       
                                       
                                          
                                             ρ
                                             E
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                 
                                    
                                       F
                                    
                                    
                                       1
                                    
                                 
                                 
                                    (
                                    W
                                    )
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             ρ
                                             u
                                          
                                       
                                       
                                          
                                             ρ
                                             
                                                
                                                   u
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             p
                                          
                                       
                                       
                                          
                                             ρ
                                             u
                                             v
                                          
                                       
                                       
                                          
                                             ρ
                                             u
                                             w
                                          
                                       
                                       
                                          
                                             
                                                (
                                                ρ
                                                E
                                                +
                                                p
                                                )
                                             
                                             u
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                 
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    W
                                    )
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             ρ
                                             v
                                          
                                       
                                       
                                          
                                             ρ
                                             u
                                             v
                                          
                                       
                                       
                                          
                                             ρ
                                             
                                                
                                                   v
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             p
                                          
                                       
                                       
                                          
                                             ρ
                                             v
                                             w
                                          
                                       
                                       
                                          
                                             
                                                (
                                                ρ
                                                E
                                                +
                                                p
                                                )
                                             
                                             v
                                          
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                 
                                    
                                       F
                                    
                                    
                                       3
                                    
                                 
                                 
                                    (
                                    W
                                    )
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          
                                             ρ
                                             w
                                          
                                       
                                       
                                          
                                             ρ
                                             u
                                             w
                                          
                                       
                                       
                                          
                                             ρ
                                             v
                                             w
                                          
                                       
                                       
                                          
                                             ρ
                                             
                                                
                                                   w
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             p
                                          
                                       
                                       
                                          
                                             
                                                (
                                                ρ
                                                E
                                                +
                                                p
                                                )
                                             
                                             w
                                          
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                         We have denoted by 
                           ρ
                         the density, 
                           
                              u
                           
                           =
                           
                              (
                              u
                              ,
                              v
                              ,
                              w
                              )
                           
                         the Cartesian velocity vector, 
                           E
                           =
                           T
                           +
                           
                              
                                 
                                    
                                       
                                          ‖
                                          
                                             u
                                          
                                          ‖
                                       
                                    
                                    
                                       2
                                    
                                 
                              
                              
                                 2
                              
                           
                         the total energy and 
                           p
                           =
                           
                              (
                              γ
                              −
                              1
                              )
                           
                           ρ
                           T
                         the pressure with 
                           γ
                           =
                           1.4
                         the ratio of specific heats and 
                           T
                         the temperature.

To discretize convective terms, Wolf uses the mixed-element-volume (MEV) approach initiated by Dervieux et al. in numerous papers  [77–80]. It is a vertex-centered finite volume scheme applied to tetrahedral unstructured meshes. This scheme uses a particular edge-based formulation with upwind elements. Detailed descriptions are given in  [45].

This flow solver proposes several approximate Riemann solvers to compute numerical fluxes, among which Roe  [81] and HLLC  [82] solvers. The spatial high-order scheme is derived according to a MUSCL (Monotone Upwind Schemes for Conservation Laws) type method using downstream and upstream tetrahedra  [79]. This approach is compatible with vertex-centered and edge-based formulations. Consequently, an inexpensive high-order extension of monotone upwind schemes is easily derived. The flux integration based on the edges and their corresponding upwind elements is a key-feature in order to preserve the positivity of the density for vertex-centered formulation. The MUSCL type method is combined with the Dervieux limiter  [80], which is a generalization of the Superbee limiter with three entries, to guarantee the TVD (Total Variation Diminishing) property of the scheme. Several boundary conditions are available: body slip, inflow, outflow, free-stream, engine, transmitting, …. They are generally weakly imposed by solving a Riemann problem on the boundary.

As regards time advancing, several temporal scheme have been implemented. Explicit time stepping algorithm can be used by means of a strong-stability-preserving (SSP) Runge–Kutta schemes  [83,84]. Explicit temporal schemes go up to order 4. Implicit schemes are also available, such as standard backward differencing method BDF1 and BDF2 with or without Defect Correction  [85] or matrix-free approach coupling the GMRES algorithm with a LU-SGS pre-conditioner  [86].

To improve Wolf’s efficiency, a mesh entities renumbering based on space-filling curves has been implemented together with a shared-memory parallelization based on the pthreads paradigm  [87].

One of the main specificities of the selected methodology is how the numerical dissipation is applied to stabilize the numerical scheme. This approach is well-suited for anisotropic adapted meshes. More precisely, the numerical dissipation is directional (edge by edge) and uses the mesh topology. This means that, for each vertex, each edge numerical flux computes its own directional dissipation. In this scheme, the stabilization term varies directionally, as compared to standard methods where the dissipation at each vertex is the same in all directions. This leads to a less dissipative second order scheme. Moreover, the dissipation term is computed according to the mesh topology, thus no parameter needs to be tuned. We observe that anisotropic meshes enhance considerably the numerical method because it provides the optimal dissipation in each direction.


                        The local remesher
                        Feflo.a. Generating a valid tetrahedral mesh for a given domain of 
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                         of arbitrary complexity was the main problem at the end of the 90’s. Different methods have demonstrated a good efficiency and reliability: advancing front method [6,88], constrained global Delaunay  [89–91], or a combination of both  [92]. Based on the unit-mesh concept (Relations (1)–(2)), their extension to generate 3D anisotropic mesh may seem straightforward. Indeed, from a theoretical point of view, it consists in computing all relevant geometric information with respect to the provided metric field: volume, length, angle, or the Delaunay cavity. However, from a practical point of view, their implementation in 3D is far more complex and tedious due to the huge variation in terms of size and orientation (as required in an anisotropic context) which are difficult to handle properly for all the aforementioned methods. When dealing with anisotropic surface meshes, the frontal methods generally do not succeed to close the front, while the Delaunay-based will fail during the boundary recovery phase. Consequently, being able to certify that during an adaptive procedure that any of these methods will succeed to produce an adapted mesh is not at all guaranteed. Consequently, it is of great interest to develop techniques that modify a mesh locally [29,58,42,55,54] while always keeping a valid 3D mesh. Several techniques have been developed in that direction.

The extension of the Delaunay kernel to follow an anisotropic metric is studied in  [58,93]. The main difficulty is to take into account the variation of the metric in the domain. In that case, only the volume mesh is adapted and the surface mesh is kept as is and adapted independently, thus limiting its use when strong anisotropic phenomena impact the boundary. Another set of methods consists of using several simple local operators: point insertion on edge, point collapse, and edge and face swapping. If these standard operators are monitored by an adequate metric-based quality function, then unit-meshes are generated. One main advantage is that a very high level of anisotropy is reached 
                           O
                           
                              (
                              1
                              :
                              
                                 
                                    10
                                 
                                 
                                    6
                                 
                              
                              )
                           
                           [55,94] and that the surface mesh is adapted conjointly with the volume mesh  [95,54]. A typical quality function gathers the control of length and volume in the metric: 
                           
                              (12)
                              
                                 
                                    
                                       Q
                                    
                                    
                                       M
                                    
                                 
                                 
                                    (
                                    K
                                    )
                                 
                                 =
                                 
                                    
                                       36
                                    
                                    
                                       
                                          
                                             3
                                          
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   3
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                |
                                                K
                                                |
                                             
                                          
                                          
                                             M
                                          
                                          
                                             
                                                
                                                   2
                                                
                                                
                                                   3
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             6
                                          
                                       
                                       
                                          
                                             ℓ
                                          
                                          
                                             M
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   e
                                                
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                    
                                 
                                 ∈
                                 
                                    [
                                    0
                                    ,
                                    1
                                    ]
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 e
                              
                              
                                 i
                              
                           
                         are the edges of element 
                           K
                        . Elements having a quality greater than 0.8 are declared to be unit with respect to 
                           M
                        . If the previous operators are well suited to generate anisotropic meshes, they do not encompass all the kinds of meshes required in CFD like hybrid entities or quasi-structured meshes for boundary layers. In addition, adding one feature to the local remesher requires an update to all the local operators. This makes the code more complicated to maintain or may impact its robustness unfavorably. To this end, a new cavity-based operator was introduced in  [96]. The idea is to use a unique operator. Only its initialization defines the scope of the underlying local mesh modification. Each operator is equivalent to a node insertion or reinsertion. This operator consists in the definition of a cavity 
                           C
                         (set of elements to be removed) and a reconnection 
                           R
                         (set of new elements to be added), so that the updated mesh 
                           
                              
                                 H
                              
                              
                                 k
                                 +
                                 1
                              
                           
                         writes: 
                           
                              
                                 
                                    
                                       H
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 ≡
                                 
                                    
                                       H
                                    
                                    
                                       k
                                    
                                 
                                 −
                                 C
                                 +
                                 R
                                 .
                              
                           
                         In Fig. 8
                        , several choices of 
                           C
                         and 
                           R
                         are given in order to recover the standard simple operators: a point insertion or a collapse or an edge swap. Starting from an initial choice of 
                           C
                        , the validity of 
                           
                              
                                 H
                              
                              
                                 k
                                 +
                                 1
                              
                           
                         is monitored through cavity optimizations (enlargement or reduction). In that case, one cavity operation is equivalent to the combination of multiple simple operators at once (collapse and swap, many swaps, split and collapse, etc.). This operator was derived also to adapt a surface mesh, generate a boundary layer mesh with hybrid entities  [94] and to generate quasi-structured meshes  [97,98].

Two major difficulties occurring when applying mesh adaptation to numerical simulations are: 
                           
                              •
                              the solution of the problem is not known, only the numerical approximation is available

a control of the approximation error is expected.

We describe how the interpolation theory is applied when only 
                              
                                 
                                    u
                                 
                                 
                                    h
                                 
                              
                           , a piecewise linear approximation of the solution, is known. Indeed, in this particular case, the interpolation error estimate is not applied directly to 
                              u
                            nor to 
                              
                                 
                                    u
                                 
                                 
                                    h
                                 
                              
                           .

Let 
                              
                                 
                                    
                                       
                                          V
                                       
                                       
                                          ̄
                                       
                                    
                                 
                                 
                                    h
                                 
                                 
                                    k
                                 
                              
                            be the space of piecewise polynomials of degree 
                              k
                            (possibly discontinuous) and 
                              
                                 
                                    V
                                 
                                 
                                    h
                                 
                                 
                                    k
                                 
                              
                            be the space of continuous piecewise polynomials of degree 
                              k
                            associated with a given mesh 
                              H
                            of domain 
                              
                                 
                                    Ω
                                 
                                 
                                    h
                                 
                              
                           . We denote by 
                              
                                 
                                    R
                                 
                                 
                                    h
                                 
                              
                            a reconstruction operator applied to numerical approximation 
                              
                                 
                                    u
                                 
                                 
                                    h
                                 
                              
                           . This reconstruction operator can be either a recovery process  [99], a hierarchical basis  [100], or an operator connected to an a posteriori estimate  [101]. We assume that the reconstruction 
                              
                                 
                                    R
                                 
                                 
                                    h
                                 
                              
                              
                                 
                                    u
                                 
                                 
                                    h
                                 
                              
                            is better than 
                              
                                 
                                    u
                                 
                                 
                                    h
                                 
                              
                            for a given norm 
                              
                                 ‖
                                 ⋅
                                 ‖
                              
                            in the sense that: 
                              
                                 
                                    
                                       ‖
                                       u
                                       −
                                       
                                          
                                             R
                                          
                                          
                                             h
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             h
                                          
                                       
                                       ‖
                                    
                                    ≤
                                    α
                                    
                                       ‖
                                       u
                                       −
                                       
                                          
                                             u
                                          
                                          
                                             h
                                          
                                       
                                       ‖
                                    
                                    
                                    where  
                                    0
                                    ≤
                                    α
                                    <
                                    1
                                    .
                                 
                              
                            From the triangle inequality, we deduce: 
                              
                                 
                                    
                                       ‖
                                       u
                                       −
                                       
                                          
                                             u
                                          
                                          
                                             h
                                          
                                       
                                       ‖
                                    
                                    ≤
                                    
                                       
                                          1
                                       
                                       
                                          1
                                          −
                                          α
                                       
                                    
                                    
                                       ‖
                                       
                                          
                                             R
                                          
                                          
                                             h
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             h
                                          
                                       
                                       −
                                       
                                          
                                             u
                                          
                                          
                                             h
                                          
                                       
                                       ‖
                                    
                                    .
                                 
                              
                            If reconstruction operator 
                              
                                 
                                    R
                                 
                                 
                                    h
                                 
                              
                            has the property: 
                              
                                 
                                    Π
                                 
                                 
                                    h
                                 
                              
                              
                                 
                                    R
                                 
                                 
                                    h
                                 
                              
                              
                                 
                                    ϕ
                                 
                                 
                                    h
                                 
                              
                              =
                              
                                 
                                    ϕ
                                 
                                 
                                    h
                                 
                              
                              ,
                              ∀
                              
                                 
                                    ϕ
                                 
                                 
                                    h
                                 
                              
                              ∈
                              
                                 
                                    V
                                 
                                 
                                    h
                                 
                                 
                                    1
                                 
                              
                           , the approximation error of the solution can be bounded by the interpolation error of reconstructed function 
                              
                                 
                                    R
                                 
                                 
                                    h
                                 
                              
                              
                                 
                                    u
                                 
                                 
                                    h
                                 
                              
                           : 
                              
                                 
                                    
                                       ‖
                                       u
                                       −
                                       
                                          
                                             u
                                          
                                          
                                             h
                                          
                                       
                                       ‖
                                    
                                    ≤
                                    
                                       
                                          1
                                       
                                       
                                          1
                                          −
                                          α
                                       
                                    
                                    
                                       ‖
                                       
                                          
                                             R
                                          
                                          
                                             h
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             h
                                          
                                       
                                       −
                                       
                                          
                                             Π
                                          
                                          
                                             h
                                          
                                       
                                       
                                          
                                             R
                                          
                                          
                                             h
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             h
                                          
                                       
                                       ‖
                                    
                                    .
                                 
                              
                            From previous section, if 
                              
                                 
                                    H
                                 
                                 
                                    
                                       
                                          L
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                            is an optimal mesh to control the interpolation error in 
                              
                                 
                                    L
                                 
                                 
                                    p
                                 
                              
                            norm of 
                              
                                 
                                    R
                                 
                                 
                                    h
                                 
                              
                              
                                 
                                    u
                                 
                                 
                                    h
                                 
                              
                           , then the following upper bound of the approximation error can be exhibited: 
                              
                                 
                                    
                                       
                                          
                                             ‖
                                             u
                                             −
                                             
                                                
                                                   u
                                                
                                                
                                                   h
                                                
                                             
                                             ‖
                                          
                                       
                                       
                                          
                                             
                                                L
                                             
                                             
                                                p
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   Ω
                                                
                                                
                                                   h
                                                
                                             
                                             )
                                          
                                       
                                    
                                    ≤
                                    
                                       
                                          3
                                          
                                          
                                             
                                                N
                                             
                                             
                                                −
                                                
                                                   
                                                      2
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                          
                                       
                                       
                                          1
                                          −
                                          α
                                       
                                    
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   ∫
                                                
                                                
                                                   Ω
                                                
                                             
                                             det
                                             
                                                
                                                   
                                                      (
                                                      
                                                         |
                                                         
                                                            
                                                               H
                                                            
                                                            
                                                               
                                                                  
                                                                     R
                                                                  
                                                                  
                                                                     h
                                                                  
                                                               
                                                               
                                                                  
                                                                     u
                                                                  
                                                                  
                                                                     h
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            (
                                                            
                                                               x
                                                            
                                                            )
                                                         
                                                         |
                                                      
                                                      )
                                                   
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         2
                                                         p
                                                         +
                                                         3
                                                      
                                                   
                                                
                                             
                                             
                                                d
                                             
                                             
                                                x
                                             
                                             )
                                          
                                       
                                       
                                          
                                             
                                                2
                                                p
                                                +
                                                3
                                             
                                             
                                                3
                                                p
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        


                           
                              Remark 4.1
                              It is important to note that 
                                    
                                       
                                          M
                                       
                                       
                                          
                                             
                                                L
                                             
                                             
                                                p
                                             
                                          
                                       
                                    
                                  defined by Relation  (5) applied to 
                                    
                                       
                                          R
                                       
                                       
                                          h
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          h
                                       
                                    
                                  does not allow us to generate an optimal adapted mesh to control the approximation error 
                                    
                                       ‖
                                       u
                                       −
                                       
                                          
                                             u
                                          
                                          
                                             h
                                          
                                       
                                       ‖
                                    
                                 . If all assumptions are verified, this analysis states that such generated adapted meshes controls (we have only an upper bound) the approximation error.

In the context of numerical simulations, 
                              
                                 
                                    u
                                 
                                 
                                    h
                                 
                              
                            lies in 
                              
                                 
                                    V
                                 
                                 
                                    h
                                 
                                 
                                    1
                                 
                              
                            and its derivatives 
                              ∇
                              
                                 
                                    u
                                 
                                 
                                    h
                                 
                              
                            in 
                              
                                 
                                    
                                       
                                          V
                                       
                                       
                                          ̄
                                       
                                    
                                 
                                 
                                    h
                                 
                                 
                                    0
                                 
                              
                           . We propose a reconstruction operator from 
                              
                                 
                                    V
                                 
                                 
                                    h
                                 
                                 
                                    1
                                 
                              
                            into 
                              
                                 
                                    V
                                 
                                 
                                    h
                                 
                                 
                                    2
                                 
                              
                            based on 
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                            Lagrange finite element test functions. As approximate solution 
                              
                                 
                                    u
                                 
                                 
                                    h
                                 
                              
                            is only known at mesh vertices, we need to reconstruct mid-edge values. To this end, we consider the 
                              
                                 
                                    L
                                 
                                 
                                    2
                                 
                              
                           -projection operator 
                              P
                              :
                              
                                 
                                    
                                       
                                          V
                                       
                                       
                                          ̄
                                       
                                    
                                 
                                 
                                    h
                                 
                                 
                                    0
                                 
                              
                              →
                              
                                 
                                    V
                                 
                                 
                                    h
                                 
                                 
                                    1
                                 
                              
                            defined by  [102]: 
                              
                                 
                                    
                                       
                                          ∇
                                       
                                       
                                          R
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          h
                                       
                                    
                                    =
                                    P
                                    
                                       (
                                       ∇
                                       
                                          
                                             u
                                          
                                          
                                             h
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                
                                                   p
                                                
                                             
                                             
                                                i
                                             
                                          
                                          ∈
                                          H
                                       
                                    
                                    
                                       
                                          ∇
                                       
                                       
                                          R
                                       
                                    
                                    
                                    
                                       
                                          u
                                       
                                       
                                          h
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       
                                          ϕ
                                       
                                       
                                          i
                                       
                                    
                                    
                                    where  
                                    
                                       
                                          ∇
                                       
                                       
                                          R
                                       
                                    
                                    
                                    
                                       
                                          u
                                       
                                       
                                          h
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      j
                                                   
                                                
                                                ∈
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          
                                             |
                                             
                                                
                                                   K
                                                
                                                
                                                   j
                                                
                                             
                                             |
                                          
                                          ∇
                                          
                                             (
                                             
                                                
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                                
                                                   |
                                                   
                                                      
                                                         K
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      j
                                                   
                                                
                                                ∈
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          
                                             |
                                             
                                                
                                                   K
                                                
                                                
                                                   j
                                                
                                             
                                             |
                                          
                                       
                                    
                                    ,
                                 
                              
                            where 
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    i
                                 
                              
                            denotes the 
                              i
                           th vertex of mesh 
                              H
                           , 
                              
                                 
                                    S
                                 
                                 
                                    i
                                 
                              
                            is the stencil of 
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    i
                                 
                              
                           , 
                              ϕ
                            the basis function of 
                              
                                 
                                    V
                                 
                                 
                                    h
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 |
                                 
                                    
                                       K
                                    
                                    
                                       j
                                    
                                 
                                 |
                              
                            denotes the volume of element 
                              
                                 
                                    K
                                 
                                 
                                    j
                                 
                              
                           . These nodal recovered gradients are used to evaluate mid-edge values. For edge 
                              
                                 e
                              
                              =
                              
                                 pq
                              
                           , the mid-edge value 
                              
                                 
                                    u
                                 
                                 
                                    h
                                 
                              
                              
                                 (
                                 
                                    e
                                 
                                 )
                              
                            is given by: 
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          h
                                       
                                    
                                    
                                       (
                                       
                                          e
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          
                                             
                                                u
                                             
                                             
                                                h
                                             
                                          
                                          
                                             (
                                             
                                                p
                                             
                                             )
                                          
                                          +
                                          
                                             
                                                u
                                             
                                             
                                                h
                                             
                                          
                                          
                                             (
                                             
                                                q
                                             
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                ∇
                                             
                                             
                                                R
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                h
                                             
                                          
                                          
                                             (
                                             
                                                p
                                             
                                             )
                                          
                                          −
                                          
                                             
                                                ∇
                                             
                                             
                                                R
                                             
                                          
                                          
                                             
                                                u
                                             
                                             
                                                h
                                             
                                          
                                          
                                             (
                                             
                                                q
                                             
                                             )
                                          
                                       
                                       
                                          8
                                       
                                    
                                    ⋅
                                    
                                       pq
                                    
                                    ,
                                 
                              
                            which corresponds to a cubic reconstruction. The reconstructed function 
                              
                                 
                                    R
                                 
                                 
                                    h
                                 
                              
                              
                                 
                                    u
                                 
                                 
                                    h
                                 
                              
                            of 
                              
                                 
                                    V
                                 
                                 
                                    h
                                 
                                 
                                    2
                                 
                              
                            writes: 
                              
                                 
                                    
                                       
                                          R
                                       
                                       
                                          h
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          h
                                       
                                    
                                    =
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                
                                                   p
                                                
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          h
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       
                                          ψ
                                       
                                       
                                          
                                             
                                                
                                                   p
                                                
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                
                                                   e
                                                
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          h
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                e
                                             
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                    
                                       
                                          ψ
                                       
                                       
                                          
                                             
                                                
                                                   e
                                                
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                            where 
                              
                                 
                                    ψ
                                 
                                 
                                    
                                       p
                                    
                                 
                              
                              =
                              
                                 
                                    ϕ
                                 
                                 
                                    
                                       p
                                    
                                 
                              
                              
                              
                                 (
                                 2
                                 
                                 
                                    
                                       ϕ
                                    
                                    
                                       
                                          p
                                       
                                    
                                 
                                 −
                                 1
                                 )
                              
                            and 
                              
                                 
                                    ψ
                                 
                                 
                                    
                                       e
                                    
                                 
                              
                              =
                              4
                              
                              
                                 
                                    ϕ
                                 
                                 
                                    
                                       p
                                    
                                 
                              
                              
                              
                                 
                                    ϕ
                                 
                                 
                                    
                                       q
                                    
                                 
                              
                            are the 
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                            Lagrange test functions. This reconstructed function can be rewritten 
                              
                                 
                                    R
                                 
                                 
                                    h
                                 
                              
                              
                                 
                                    u
                                 
                                 
                                    h
                                 
                              
                              =
                              
                                 
                                    u
                                 
                                 
                                    h
                                 
                              
                              +
                              
                                 
                                    z
                                 
                                 
                                    h
                                 
                              
                            and by definition verifies: 
                              
                                 
                                    
                                       
                                          Π
                                       
                                       
                                          h
                                       
                                    
                                    
                                       
                                          R
                                       
                                       
                                          h
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          h
                                       
                                    
                                    =
                                    
                                       
                                          u
                                       
                                       
                                          h
                                       
                                    
                                    
                                    thus  
                                    
                                       
                                          Π
                                       
                                       
                                          h
                                       
                                    
                                    
                                       
                                          z
                                       
                                       
                                          h
                                       
                                    
                                    =
                                    0
                                    .
                                 
                              
                            Therefore, we deduce: 
                              
                                 
                                    
                                       ‖
                                       
                                          
                                             R
                                          
                                          
                                             h
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             h
                                          
                                       
                                       −
                                       
                                          
                                             Π
                                          
                                          
                                             h
                                          
                                       
                                       
                                          
                                             R
                                          
                                          
                                             h
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             h
                                          
                                       
                                       ‖
                                    
                                    =
                                    
                                       ‖
                                       
                                          
                                             u
                                          
                                          
                                             h
                                          
                                       
                                       +
                                       
                                          
                                             z
                                          
                                          
                                             h
                                          
                                       
                                       −
                                       
                                          
                                             u
                                          
                                          
                                             h
                                          
                                       
                                       ‖
                                    
                                    =
                                    
                                       ‖
                                       
                                          
                                             z
                                          
                                          
                                             h
                                          
                                       
                                       −
                                       
                                          
                                             Π
                                          
                                          
                                             h
                                          
                                       
                                       
                                          
                                             z
                                          
                                          
                                             h
                                          
                                       
                                       ‖
                                    
                                    .
                                 
                              
                            Finally, the approximation error can be estimated by evaluating the interpolation error of 
                              
                                 
                                    z
                                 
                                 
                                    h
                                 
                              
                           : 
                              
                                 
                                    
                                       ‖
                                       u
                                       −
                                       
                                          
                                             u
                                          
                                          
                                             h
                                          
                                       
                                       ‖
                                    
                                    ≤
                                    
                                       
                                          1
                                       
                                       
                                          1
                                          −
                                          α
                                       
                                    
                                    
                                       ‖
                                       
                                          
                                             z
                                          
                                          
                                             h
                                          
                                       
                                       −
                                       
                                          
                                             Π
                                          
                                          
                                             h
                                          
                                       
                                       
                                          
                                             z
                                          
                                          
                                             h
                                          
                                       
                                       ‖
                                    
                                    ≤
                                    
                                       
                                          3
                                          
                                          
                                             
                                                N
                                             
                                             
                                                −
                                                
                                                   
                                                      2
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                          
                                       
                                       
                                          1
                                          −
                                          α
                                       
                                    
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   ∫
                                                
                                                
                                                   Ω
                                                
                                             
                                             det
                                             
                                                
                                                   
                                                      (
                                                      
                                                         |
                                                         
                                                            
                                                               H
                                                            
                                                            
                                                               
                                                                  
                                                                     z
                                                                  
                                                                  
                                                                     h
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            (
                                                            
                                                               x
                                                            
                                                            )
                                                         
                                                         |
                                                      
                                                      )
                                                   
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         2
                                                         p
                                                         +
                                                         3
                                                      
                                                   
                                                
                                             
                                             
                                                d
                                             
                                             
                                                x
                                             
                                             )
                                          
                                       
                                       
                                          
                                             
                                                2
                                                p
                                                +
                                                3
                                             
                                             
                                                3
                                                p
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                            Note that the Hessian of 
                              
                                 
                                    z
                                 
                                 
                                    h
                                 
                              
                            lies in 
                              
                                 
                                    
                                       
                                          V
                                       
                                       
                                          ̄
                                       
                                    
                                 
                                 
                                    h
                                 
                                 
                                    0
                                 
                              
                           . If nodal values are needed to build 
                              
                                 
                                    M
                                 
                                 
                                    
                                       
                                          L
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                           , then the 
                              
                                 
                                    L
                                 
                                 
                                    2
                                 
                              
                           -projection operator can be applied to these Hessians  [102]. This recovery procedure is similar to the ones of  [99,103]. Other reconstruction operators can be applied such as the double 
                              
                                 
                                    L
                                 
                                 
                                    2
                                 
                              
                           -projection, the least square method, or eventually the Green formula based approach  [60].


                           Some conclusions. Based on previous theoretical results, Theorem 3.3, and what has been observed on analytical functions in Section  3.4, we may expect the following properties for mesh adaptive numerical simulations: 
                              
                                 •
                                 highly anisotropic adapted meshes

ability to capture all scales of the flow, i.e., being able to capture at the same time strong phenomena (shocks, boundary layer, etc.) and weak ones (vortices, contact discontinuities, etc.)

an asymptotic second order convergence for smooth flows or flows with steep gradients

a higher order convergence for flows with genuine discontinuities, at best second order.

The achievement of second order convergence for discontinuous flows has been presented in  [65] and the comparison with experiments in  [45]. Here, we present a real-life sonic boom application to show the efficiency of the proposed methodology.

We simulate a supersonic flow of a low-boom-shaped supersonic business jet geometry (SSBJ) provided by Dassault-Aviation during the HISAC european project  [104]. This is a complex geometry with an integrated engine over the fuselage to minimize the impact of the nacelles on the sonic boom. Moreover, the wing has a double dihedral angle. The first dihedral angle is at the junction of the wing and the fuselage. The second one is where the wing swept angle changes. The aircraft length is 42 m and it has a wing span of 20 m. The surface mesh size on the aircraft geometry ranges between 0.2 mm and 12 cm, Fig. 9
                           . This already represents a size variation of five orders of magnitude with respect to the aircraft size. The SSBJ geometry is considered inside a cylindrical computational domain of 2.25 km length and 1.5 km diameter. This represents a scale factor of 107 if the size of the domain is compared to the maximal accuracy of the low boom jet surface mesh.

The jet is flying at cruise with Mach number 1.6, an angle of attack of 3°, and an altitude of 45,000 feet. Such supersonic flows involve highly anisotropic physical features. Indeed, as for a body flying at a supersonic speed, each geometric singularity generates a cone-shaped shock wave; a multitude of conic shock waves are emitted by the aircraft geometry. They generally coalesce around the aircraft and propagate to the ground.

In regards to mesh adaptation, we choose to control the interpolation error on the local Mach number in 
                              
                                 
                                    L
                                 
                                 
                                    2
                                 
                              
                            norm. 32 mesh adaptation iterations are performed. We split the adaptation loop in 4 steps with an increasing complexity specification at each step. Within each step, an adapted mesh of fixed complexity is converged. Final step meshes are used for the computation of the global mesh convergence order. Starting from a coarse uniform mesh containing 772,572 vertices and 3,768,534 tetrahedra, the final adapted mesh contains 9.1 million vertices and 53.9 million tetrahedra. This mesh is illustrated in Fig. 11
                           . The obtained adapted meshes are highly anisotropic. For the last one, the mean anisotropic ratio is 372 and the mean anisotropic quotient is 49,051. The last quantity signifies that the anisotropy leads to a mesh complexity reduction by more than four orders of magnitude as compared to an isotropic adapted mesh.

Such adapted meshes considerably enhance the efficiency of the flow solver. We first notice the multitude of shock waves (Mach cones) that have been accurately computed in the SSBJ near-field, Fig. 11 (right). All the details and scale of the solution have been captured and are represented inside the mesh. Second, mesh refinements along Mach cones have been propagated in the whole computational domain with high accuracy (small size elements) allowing the flow solver to achieve an accurate flow prediction everywhere, Figs. 10 (left) and 11 (left). This result points out that the numerical dissipation of the flow solver is drastically reduced with the aid of anisotropic mesh refinement. Finally, we observe that the global spatial second order of convergence is asymptotically reached for the local Mach number on the sequence of adapted meshes, see Fig. 10 (right).


                           Fig. 12
                           
                            displays the evolution of the results on the SSBJ simulation. To evaluate the efficiency of the adaptive method, we analyze the distance of the propagation of the shock wave from the aircraft: the further away the better. It quantifies the reduction of the numerical dissipation of the flow solver. This distance is evaluated by the ratio 
                              R
                              /
                              L
                            where 
                              L
                            is the aircraft length and 
                              R
                            the distance of propagation. Left, an isotropic mesh adaptation in 
                              
                                 
                                    L
                                 
                                 
                                    ∞
                                 
                              
                            norm done in 2003 where 
                              R
                              /
                              L
                              =
                              1.25
                            is reached  [105]. Middle, an anisotropic mesh adaptation in 
                              
                                 
                                    L
                                 
                                 
                                    ∞
                                 
                              
                            norm done in 2006 where 
                              R
                              /
                              L
                              =
                              3
                            is reached  [106]. Right, an anisotropic mesh adaptation in 
                              
                                 
                                    L
                                 
                                 
                                    p
                                 
                              
                            norm done in 2007 where 
                              R
                              /
                              L
                              =
                              40
                            is reached  [65].

In the previous sections, metric-based anisotropic mesh adaptation methods are limited to the minimization of some interpolation errors for some solution fields, the “sensors”, and did not take into account the PDE under consideration. If, for many applications, this simplifying standpoint is an advantage, there are also many applications where Hessian-based adaptation is far from optimal regarding the way the degrees of freedom are distributed in the computational domain. Indeed, Hessian-based methods aim at controlling the interpolation error but this purpose is not often so close to the objective that consists in obtaining the best solution of a PDE. This is particularly true in many engineering applications where a specific function needs to be accurately evaluated: lift, drag, heat flux, pressure field, etc. Hessian-based adaptation has not been especially designed to address this issue.

In contrast with the previous set of methods, the objective of goal-oriented mesh adaptation is to derive the optimal mesh to observe a given scalar-output functional 
                           j
                         depending on solution 
                           w
                        . To this end, the control of the approximation error on the output functional, 
                           j
                           
                              (
                              w
                              )
                           
                           −
                           j
                           
                              (
                              
                                 
                                    w
                                 
                                 
                                    h
                                 
                              
                              )
                           
                        , is examined. Goal-oriented methods result from a series of papers dealing with a posteriori estimates (e.g.  [107,108,72,70,41,109,71]). But, extracting information concerning anisotropy from an a posteriori estimate is a difficult task.

In our point of view, metric analysis and goal-oriented analysis are complementary. Indeed, a metric-based method specifies the object of our search through an accurate description of the ideal mesh while a goal-oriented method specifies precisely the purpose of the search in terms of which error will be reduced. It is then very motivating to seek a combination of both methods, with the hope of obtaining a metric-based specification of the best mesh to reduce the error committed on a target output functional. This will be achieved from some considerations: a reliable continuous mesh model, an a priori estimate, and specific numerical schemes allowing accurate approximations of 
                           
                              
                                 Ψ
                              
                              
                                 h
                              
                           
                           
                              (
                              w
                              )
                           
                           −
                           Ψ
                           
                              (
                              w
                              )
                           
                        . These three items differ from classical approaches of goal-oriented mesh adaptation.


                           Assumptions and definitions. Let 
                              V
                            be a space of functions (at least a Banach space). We write the state equation under a variational statement: 
                              
                                 (13)
                                 
                                    w
                                    ∈
                                    V
                                    ,
                                    
                                    ∀
                                    φ
                                    ∈
                                    V
                                    ,
                                    
                                    
                                       (
                                       Ψ
                                       
                                          (
                                          w
                                          )
                                       
                                       ,
                                       φ
                                       )
                                    
                                    =
                                    0
                                    ,
                                 
                              
                            where operator 
                              
                                 (
                                 ,
                                 )
                              
                            holds for a 
                              
                                 
                                    V
                                 
                                 
                                    ′
                                 
                              
                              ×
                              V
                            product, 
                              
                                 
                                    V
                                 
                                 
                                    ′
                                 
                              
                            is the topological dual of 
                              V
                            and 
                              w
                            is the solution of this equation. Symbol 
                              Ψ
                            holds for a functional that is linear with respect to test function 
                              φ
                            but a priori non linear with respect to 
                              w
                           . Let 
                              
                                 
                                    V
                                 
                                 
                                    h
                                 
                              
                            be a subspace of 
                              V
                              =
                              V
                              ∩
                              
                                 
                                    C
                                 
                                 
                                    0
                                 
                              
                            of finite dimension 
                              N
                           . The discrete state equation is written as follows: 
                              
                                 (14)
                                 
                                    
                                       
                                          w
                                       
                                       
                                          h
                                       
                                    
                                    ∈
                                    
                                       
                                          V
                                       
                                       
                                          h
                                       
                                    
                                    ,
                                    
                                    ∀
                                    
                                       
                                          φ
                                       
                                       
                                          h
                                       
                                    
                                    ∈
                                    
                                       
                                          V
                                       
                                       
                                          h
                                       
                                    
                                    ,
                                    
                                    
                                       (
                                       
                                          
                                             Ψ
                                          
                                          
                                             h
                                          
                                       
                                       
                                          (
                                          
                                             
                                                w
                                             
                                             
                                                h
                                             
                                          
                                          )
                                       
                                       ,
                                       
                                          
                                             φ
                                          
                                          
                                             h
                                          
                                       
                                       )
                                    
                                    =
                                    0
                                    .
                                 
                              
                            For a solution 
                              w
                            of state system  (13), we define a functional output as: 
                              
                                 
                                    j
                                    ∈
                                    R
                                    ;
                                    
                                    j
                                    
                                       (
                                       w
                                       )
                                    
                                    =
                                    
                                       (
                                       g
                                       ,
                                       w
                                       )
                                    
                                    ,
                                 
                              
                            where 
                              g
                            is a function of 
                              V
                           . We introduce the continuous adjoint 
                              
                                 
                                    w
                                 
                                 
                                    ∗
                                 
                              
                           , solution of the system: 
                              
                                 (15)
                                 
                                    
                                       
                                          w
                                       
                                       
                                          ∗
                                       
                                    
                                    ∈
                                    V
                                    ,
                                    
                                    ∀
                                    ψ
                                    ∈
                                    V
                                    ,
                                    
                                    
                                       (
                                       
                                          
                                             ∂
                                             Ψ
                                          
                                          
                                             ∂
                                             w
                                          
                                       
                                       
                                          (
                                          w
                                          )
                                       
                                       ψ
                                       ,
                                       
                                          
                                             w
                                          
                                          
                                             ∗
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       (
                                       g
                                       ,
                                       ψ
                                       )
                                    
                                    ,
                                 
                              
                            and the discrete adjoint state 
                              
                                 
                                    w
                                 
                                 
                                    h
                                 
                                 
                                    ∗
                                 
                              
                            which is solution of: 
                              
                                 (16)
                                 
                                    
                                       
                                          w
                                       
                                       
                                          h
                                       
                                       
                                          ∗
                                       
                                    
                                    ∈
                                    
                                       
                                          V
                                       
                                       
                                          h
                                       
                                    
                                    ,
                                    ∀
                                    
                                       
                                          ψ
                                       
                                       
                                          h
                                       
                                    
                                    ∈
                                    
                                       
                                          V
                                       
                                       
                                          h
                                       
                                    
                                    ,
                                    
                                    
                                       (
                                       
                                          
                                             ∂
                                             
                                                
                                                   Ψ
                                                
                                                
                                                   h
                                                
                                             
                                          
                                          
                                             ∂
                                             w
                                          
                                       
                                       
                                          (
                                          
                                             
                                                Π
                                             
                                             
                                                h
                                             
                                          
                                          w
                                          )
                                       
                                       
                                          
                                             ψ
                                          
                                          
                                             h
                                          
                                       
                                       ,
                                       
                                          
                                             w
                                          
                                          
                                             h
                                          
                                          
                                             ∗
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       (
                                       g
                                       ,
                                       
                                          
                                             ψ
                                          
                                          
                                             h
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                           A priori estimation The objective is to estimate the approximation error made on the output functional: 
                              
                                 
                                    δ
                                    j
                                    =
                                    j
                                    
                                       (
                                       w
                                       )
                                    
                                    −
                                    j
                                    
                                       (
                                       
                                          
                                             w
                                          
                                          
                                             h
                                          
                                       
                                       )
                                    
                                    ,
                                 
                              
                            as a function of continuous solutions, of continuous residuals, and of discrete residuals. For the a priori analysis, we assume that solutions 
                              w
                            and 
                              
                                 
                                    w
                                 
                                 
                                    ∗
                                 
                              
                            are sufficiently regular: 
                              w
                              ∈
                              V
                            and 
                              
                                 
                                    w
                                 
                                 
                                    ∗
                                 
                              
                              ∈
                              V
                           , and that we have an interpolation operator: 
                              
                                 
                                    Π
                                 
                                 
                                    h
                                 
                              
                              :
                              V
                              →
                              
                                 
                                    V
                                 
                                 
                                    h
                                 
                              
                           . Error 
                              δ
                              j
                            is split as follows: 
                              
                                 
                                    δ
                                    j
                                    =
                                    j
                                    
                                       (
                                       w
                                       )
                                    
                                    −
                                    j
                                    
                                       (
                                       
                                          
                                             w
                                          
                                          
                                             h
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       (
                                       g
                                       ,
                                       w
                                       −
                                       
                                          
                                             Π
                                          
                                          
                                             h
                                          
                                       
                                       w
                                       )
                                    
                                    +
                                    
                                       (
                                       g
                                       ,
                                       
                                          
                                             Π
                                          
                                          
                                             h
                                          
                                       
                                       w
                                       −
                                       
                                          
                                             w
                                          
                                          
                                             h
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                           
                              δ
                              j
                            is now composed of an interpolation error and of an implicit error which involves only discrete terms. The implicit error term has been thoroughly analyzed in  [43], and can be approximated as: 
                              
                                 
                                    
                                       (
                                       g
                                       ,
                                       
                                          
                                             Π
                                          
                                          
                                             h
                                          
                                       
                                       w
                                       −
                                       
                                          
                                             w
                                          
                                          
                                             h
                                          
                                       
                                       )
                                    
                                    ≈
                                    
                                       (
                                       
                                          
                                             ∂
                                             Ψ
                                          
                                          
                                             ∂
                                             w
                                          
                                       
                                       
                                          (
                                          w
                                          )
                                       
                                       
                                          (
                                          
                                             
                                                Π
                                             
                                             
                                                h
                                             
                                          
                                          w
                                          −
                                          w
                                          )
                                       
                                       ,
                                       
                                          
                                             w
                                          
                                          
                                             ∗
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       (
                                       
                                          (
                                          
                                             
                                                Ψ
                                             
                                             
                                                h
                                             
                                          
                                          −
                                          Ψ
                                          )
                                       
                                       
                                          (
                                          w
                                          )
                                       
                                       ,
                                       
                                          
                                             w
                                          
                                          
                                             ∗
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                            Thus, thanks to the continuous adjoint of Eq. (15), we finally obtain: 
                              
                                 (17)
                                 
                                    δ
                                    j
                                    ≈
                                    
                                       (
                                       
                                          (
                                          
                                             
                                                Ψ
                                             
                                             
                                                h
                                             
                                          
                                          −
                                          Ψ
                                          )
                                       
                                       
                                          (
                                          w
                                          )
                                       
                                       ,
                                       
                                          
                                             w
                                          
                                          
                                             ∗
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                            It remains to precise the context of the study and to exhibit from (17) a formulation specifying the optimal mesh.


                           The case of the steady compressible Euler equations. We study how Eq. (17) can be applied in the context of the steady compressible Euler equations. In  [43], we restrict ourselves to a particular discretization of these equations (equivalent to the one presented in Section  4.2) and we consider a variational analysis. If we neglect the boundary terms, the final estimate reads: 
                              
                                 (18)
                                 
                                    
                                       |
                                       j
                                       
                                          (
                                          W
                                          )
                                       
                                       −
                                       j
                                       
                                          (
                                          
                                             
                                                W
                                             
                                             
                                                h
                                             
                                          
                                          )
                                       
                                       |
                                    
                                    ≈
                                    
                                       
                                          
                                             ‖
                                             
                                             
                                                |
                                                ∇
                                                
                                                   
                                                      W
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                                |
                                             
                                             ⋅
                                             
                                                |
                                                F
                                                
                                                   (
                                                   W
                                                   )
                                                
                                                −
                                                
                                                   
                                                      Π
                                                   
                                                   
                                                      h
                                                   
                                                
                                                F
                                                
                                                   (
                                                   W
                                                   )
                                                
                                                |
                                             
                                             
                                             ‖
                                          
                                       
                                       
                                          
                                             
                                                L
                                             
                                             
                                                1
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   Ω
                                                
                                                
                                                   h
                                                
                                             
                                             )
                                          
                                       
                                    
                                    .
                                 
                              
                            We observe that this estimate of 
                              δ
                              j
                            is expressed in term of the interpolation error in 
                              
                                 
                                    L
                                 
                                 
                                    1
                                 
                              
                            norm of the Euler fluxes applied to the continuous solution 
                              W
                            weighted by the gradient of the continuous adjoint state 
                              
                                 
                                    W
                                 
                                 
                                    ∗
                                 
                              
                           .

In order to derive an optimal mesh for the observed output functional, we work in the continuous mesh framework which is made easier thanks to the a priori estimate. Estimate (18) is rewritten in a continuous form (boundary terms are still neglected to simplify the analysis, see  [43] for their analysis and a discussion of their influence): 
                              
                                 (19)
                                 
                                    
                                       (
                                       g
                                       ,
                                       
                                          
                                             W
                                          
                                          
                                             h
                                          
                                       
                                       −
                                       W
                                       )
                                    
                                    ≈
                                    
                                       
                                          E
                                       
                                       
                                          
                                             go
                                          
                                       
                                    
                                    
                                       (
                                       
                                          M
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          ∫
                                       
                                       
                                          Ω
                                       
                                    
                                    
                                       |
                                       ∇
                                       
                                          
                                             W
                                          
                                          
                                             ∗
                                          
                                       
                                       |
                                    
                                    ⋅
                                    
                                       |
                                       F
                                       
                                          (
                                          W
                                          )
                                       
                                       −
                                       
                                          
                                             π
                                          
                                          
                                             M
                                          
                                       
                                       F
                                       
                                          (
                                          W
                                          )
                                       
                                       |
                                    
                                    
                                    
                                       d
                                    
                                    Ω
                                    ,
                                 
                              
                            where 
                              
                                 M
                              
                              =
                              
                                 
                                    
                                       (
                                       M
                                       
                                          (
                                          
                                             x
                                          
                                          )
                                       
                                       )
                                    
                                 
                                 
                                    
                                       x
                                    
                                    ∈
                                    Ω
                                 
                              
                            is a continuous mesh and 
                              
                                 
                                    π
                                 
                                 
                                    M
                                 
                              
                            is the continuous linear interpolate. We are now focusing on the following (continuous) mesh optimization problem: 
                              
                                 (20)
                                 
                                    Find  
                                    
                                       
                                          
                                             M
                                          
                                       
                                       
                                          
                                             go
                                          
                                       
                                    
                                    =
                                    
                                       
                                          Argmin
                                       
                                       
                                          
                                             M
                                          
                                       
                                    
                                    
                                    
                                       
                                          E
                                       
                                       
                                          
                                             go
                                          
                                       
                                    
                                    
                                       (
                                       
                                          M
                                       
                                       )
                                    
                                    ,
                                    
                                    such that  
                                    C
                                    
                                       (
                                       
                                          M
                                       
                                       )
                                    
                                    =
                                    N
                                    .
                                 
                              
                            Then, introducing the continuous interpolation error, we can write the simplified error model as follows: 
                              
                                 
                                    
                                       
                                          E
                                       
                                       
                                          (
                                          
                                             M
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             ∫
                                          
                                          
                                             Ω
                                          
                                       
                                       trace
                                       
                                          (
                                          
                                             
                                                M
                                             
                                             
                                                −
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             (
                                             
                                                x
                                             
                                             )
                                          
                                          
                                          
                                             H
                                          
                                          
                                             (
                                             
                                                x
                                             
                                             )
                                          
                                          
                                          
                                             
                                                M
                                             
                                             
                                                −
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             (
                                             
                                                x
                                             
                                             )
                                          
                                          )
                                       
                                       
                                       
                                          d
                                       
                                       
                                          x
                                       
                                    
                                 
                                 
                                    (21)
                                    
                                       in which  
                                       
                                          H
                                       
                                       
                                          (
                                          
                                             x
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             5
                                          
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   [
                                                   
                                                      Δ
                                                   
                                                   x
                                                   ]
                                                
                                             
                                             
                                                j
                                             
                                          
                                          
                                             (
                                             
                                                x
                                             
                                             )
                                          
                                          +
                                          
                                             
                                                
                                                   [
                                                   
                                                      Δ
                                                   
                                                   y
                                                   ]
                                                
                                             
                                             
                                                j
                                             
                                          
                                          
                                             (
                                             
                                                x
                                             
                                             )
                                          
                                          +
                                          
                                             
                                                
                                                   [
                                                   
                                                      Δ
                                                   
                                                   z
                                                   ]
                                                
                                             
                                             
                                                j
                                             
                                          
                                          
                                             (
                                             
                                                x
                                             
                                             )
                                          
                                          )
                                       
                                       ,
                                    
                                 
                              
                            with 
                              
                                 
                                    
                                       [
                                       
                                          Δ
                                       
                                       x
                                       ]
                                    
                                 
                                 
                                    j
                                 
                              
                              =
                              
                                 |
                                 
                                    
                                       ∂
                                       
                                          
                                             W
                                          
                                          
                                             j
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                    
                                       ∂
                                       x
                                    
                                 
                                 |
                              
                              
                              
                                 |
                                 H
                                 
                                    (
                                    
                                       
                                          F
                                       
                                       
                                          1
                                       
                                    
                                    
                                       (
                                       
                                          
                                             W
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                    )
                                 
                                 |
                              
                              ,
                              
                              
                                 
                                    
                                       [
                                       
                                          Δ
                                       
                                       y
                                       ]
                                    
                                 
                                 
                                    j
                                 
                              
                              =
                              
                                 |
                                 
                                    
                                       ∂
                                       
                                          
                                             W
                                          
                                          
                                             j
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                    
                                       ∂
                                       y
                                    
                                 
                                 |
                              
                              
                              
                                 |
                                 H
                                 
                                    (
                                    
                                       
                                          F
                                       
                                       
                                          2
                                       
                                    
                                    
                                       (
                                       
                                          
                                             W
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                    )
                                 
                                 |
                              
                              ,
                              
                                 
                                    
                                       [
                                       
                                          Δ
                                       
                                       z
                                       ]
                                    
                                 
                                 
                                    j
                                 
                              
                              =
                              
                                 |
                                 
                                    
                                       ∂
                                       
                                          
                                             W
                                          
                                          
                                             j
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                    
                                       ∂
                                       z
                                    
                                 
                                 |
                              
                              
                              
                                 |
                                 H
                                 
                                    (
                                    
                                       
                                          F
                                       
                                       
                                          3
                                       
                                    
                                    
                                       (
                                       
                                          
                                             W
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                    )
                                 
                                 |
                              
                           . Here, 
                              
                                 
                                    W
                                 
                                 
                                    j
                                 
                                 
                                    ∗
                                 
                              
                            denotes the 
                              j
                           th component of adjoint vector 
                              
                                 
                                    W
                                 
                                 
                                    ∗
                                 
                              
                            and 
                              H
                              
                                 (
                                 
                                    
                                       F
                                    
                                    
                                       i
                                    
                                 
                                 
                                    (
                                    
                                       
                                          W
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                                 )
                              
                            the Hessian of the 
                              j
                           th component of vector 
                              
                                 
                                    F
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 W
                                 )
                              
                           . Solving the optimality condition provides the optimal goal-oriented continuous mesh 
                           
                              
                                 
                                    
                                       M
                                    
                                 
                                 
                                    
                                       go
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       (
                                       
                                          
                                             M
                                          
                                          
                                             
                                                go
                                             
                                          
                                       
                                       
                                          (
                                          
                                             x
                                          
                                          )
                                       
                                       )
                                    
                                 
                                 
                                    
                                       x
                                    
                                    ∈
                                    Ω
                                 
                              
                           : 
                              
                                 (22)
                                 
                                    
                                       
                                          M
                                       
                                       
                                          
                                             go
                                          
                                       
                                    
                                    
                                       (
                                       
                                          x
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          M
                                       
                                       
                                          
                                             
                                                L
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    
                                       (
                                       
                                          H
                                       
                                       
                                          (
                                          
                                             x
                                          
                                          )
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          N
                                       
                                       
                                          
                                             
                                                2
                                             
                                             
                                                3
                                             
                                          
                                       
                                    
                                    
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   ∫
                                                
                                                
                                                   Ω
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      det
                                                      
                                                         H
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                            
                                                            
                                                               ̄
                                                            
                                                         
                                                         )
                                                      
                                                      )
                                                   
                                                
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         5
                                                      
                                                   
                                                
                                             
                                             d
                                             
                                                
                                                   
                                                      x
                                                   
                                                
                                                
                                                   ̄
                                                
                                             
                                             )
                                          
                                       
                                       
                                          −
                                          
                                             
                                                2
                                             
                                             
                                                3
                                             
                                          
                                       
                                    
                                    
                                    
                                       
                                          
                                             (
                                             det
                                             
                                                H
                                             
                                             
                                                (
                                                
                                                   x
                                                
                                                )
                                             
                                             )
                                          
                                       
                                       
                                          −
                                          
                                             
                                                1
                                             
                                             
                                                5
                                             
                                          
                                       
                                    
                                    
                                    
                                       H
                                    
                                    
                                       (
                                       
                                          x
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        

Comparison with experiments and numerous numerical examples are presented in  [65]. Here, we compare the result using the feature-based and the goal-oriented error estimates on the supersonic business jet simulation presented above.

The goal is to accurately compute the pressure signature only on a plane located 100 m below the aircraft. The observation plane 
                              γ
                            has a length of 40 m and a width of 2 m while the wing span is about 17 m. The objective of this test case is to evaluate the ability of the adjoint to prescribe refinements only in areas that impact the observation region. The function is given by: 
                              
                                 
                                    j
                                    
                                       (
                                       W
                                       )
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                    
                                       
                                          ∫
                                       
                                       
                                          γ
                                       
                                    
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   p
                                                   −
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         ∞
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         ∞
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                    
                                    d
                                    γ
                                    .
                                 
                              
                            For the feature-based mesh adaptation, the sensor is again the local Mach number and the interpolation error is controlled in 
                              
                                 
                                    L
                                 
                                 
                                    2
                                 
                              
                            norm.

The adaptive loop is divided into 5 steps of increasing complexity, each step is composed of 6 sub-iterations having a constant complexity for a total of 30 adaptations. Hessian-based and adjoint-based final adapted meshes are both composed of almost 800,000 vertices. They are represented in Fig. 14
                           , where several cuts in the final adapted meshes for the adjoint-based (left) and Hessian-based (right) adaptations are displayed.

For the Hessian-based adaptation, the mesh is adapted in the whole computational domain along the Mach cones and in the wake providing an accurate solution everywhere in the domain, cf. Fig. 13 (top right). However, if the aim is only to compute an accurate pressure signature on surface 
                              γ
                           , then we clearly notice that a large amount of degrees of freedom is wasted in the upper part of the domain and in the wake where accuracy is not needed. In regards to adjoint-based adaptation, the mesh is mainly adapted below the aircraft in order to accurately capture all of the shock waves that impact the observation plane while areas that do not impact the output functional are ignored with this new approach (cf. Fig. 14).

Another point of interest, which is more technical, is that the Hessian-based adaptation norm prescribes a mesh size that depends on the shock intensity. A stronger shock is then more refined than a weaker one. In this simulation, shocks directly below the aircraft have a lower intensity than lateral or upper shocks emitted by the wings, see Fig. 14 (bottom). Consequently, the adapted meshes obtained with the Hessian-based method are less accurate in regions that directly affect the observation plane than the adapted meshes obtained with the adjoint-based method. Indeed, with the adjoint-based strategy, the shock waves that have the most influence on the computation of the output functional are more refined, and this independently of their amplitudes.

This has a direct consequence on the accuracy of the observed output functional, see Fig. 13 (bottom). At the same level of complexity, the pressure signature is clearly more accurate with adjoint-based mesh adaptation. It also demonstrates that the adjoint defines an optimal distribution of the degrees of freedom for the specific target.

This section presents the extension of the feature-based and goal-oriented anisotropic mesh adaptation to time-dependent simulations.

The 3D simulation of unsteady flows, which is actually the typical situation for real-life problems, still remains a challenge. Indeed, these computations are very time consuming. To reduce the CPU time of these simulations while preserving their accuracy, anisotropic metric-based mesh adaptation, which has already proved its efficiency for steady problems, appears as a salutary perspective. However, its extension to the unsteady case is far from being straightforward as such simulations cumulate the difficulties arising from unsteadiness. To achieve an efficient time-accurate mesh adaptation scheme for unsteady flow, we have to overcome the following issues.

First of all, we have to remedy the problem of the lateness of the mesh with respect to the solution, i.e., the mesh is lagging behind the solution in time. Indeed, if a mesh is adapted for a solution at time 
                           t
                        , once the solution progresses in time it is clear that this mesh is no longer adapted for the subsequent time steps.

Theoretically, the previous estimates introduced in Section  4.2 need to be extended to the unsteady case. In other words, for time-dependent simulations, the temporal error is also controlled. A space–time error analysis is required.

Additionally, at each remeshing, the solution has to be interpolated on the new adapted mesh. This stage becomes crucial in the context of unsteady problems and even more if a large number of interpolations is performed, as the error due to this solution transfer accumulates throughout the simulation. Therefore, the error introduced by this stage can spoil the overall accuracy of the solution.

In regards to the meshing phase, a difficulty arises from the definition of the solver time step 
                           d
                           t
                         (omitting CFL factor) which is homogeneous to the smallest height of the mesh 
                           
                              
                                 h
                              
                              
                                 
                                    min
                                 
                              
                           
                        . Consequently, a single small-height element in the whole mesh is sufficient to considerably reduce the time step and thus increase the CPU time of the simulation. This is a serious problem, especially in the context of highly anisotropic mesh adaptation, which involves highly stretched elements. The only remedy is to reduce this constraint as far as possible by generating anisotropic meshes controlling the highest 
                           
                              
                                 h
                              
                              
                                 
                                    min
                                 
                              
                           
                         value. This implies a substantial effort on the anisotropic mesh generator as the quality of the mesh must be perfect. For example, if the mesh generator fails to generate the minimal height element for which a size of 
                           
                              
                                 h
                              
                              
                                 
                                    target
                                 
                              
                           
                         had been prescribed, and instead builds an element of height 
                           
                              
                                 h
                              
                              
                                 
                                    min
                                 
                              
                           
                           =
                           0.01
                           ×
                           
                              
                                 h
                              
                              
                                 
                                    target
                                 
                              
                           
                        , then the number of solver iterations is multiplied by 100. Consequently, not a single meshing mistake is allowed even if millions of tetrahedra are generated.

Over the past few years, a rather large number of papers have been published dealing with mesh adaptation for steady numerical simulations, whereas only a small number have addressed time-dependent problems  [59,110,28,111,50,112–114]. All these approaches involve a large number of adaptations while introducing unquantified errors due to the transfer of the solution from the old mesh to the new one. This is especially problematic for hyperbolic problems. Moreover, they generally do not explicitly control the error made on the solution as they perform an arbitrary large and a priori number of adaptations. Some of them authorize the error to grow through the simulation and others cannot be extended to the case of anisotropic mesh adaptation. Finally, none of them considers the intrinsic non-linear nature of the mesh adaptation problem: the convergence of the mesh adaptation process is never addressed and therefore the obtention of the optimal mesh cannot be expected.

In order to remedy all of the problems relative to mesh adaptation for time-dependent simulations, an innovative strategy based on a fixed-point algorithm has been developed. The main goals are to guarantee a control of the spatial and temporal interpolation errors during the whole simulation and to control (reduce) the number of mesh adaptations in order to master (diminish) the error introduced by solution transfers. This new strategy starts with the observation that direct extension of steady adaptation algorithms to unsteady problems is not appropriate: specific algorithms must be developed, which truly take into account the transient nature of the solution. It relies on the assumption that the temporal error is always controlled by the spatial one, which is indeed the case when solving a linear advection problem under a CFL condition  [48]. To this end, it has been proposed: 
                           
                              •
                              a global fixed-point mesh adaptation algorithm to converge the mesh adaptation non-linear problem

the extension of the multiscale error estimate to unsteady problems by proposing a 
                                    
                                       
                                          L
                                       
                                       
                                          p
                                       
                                    
                                  space–time error analysis

the extension of the adjoint-based mesh adaptation to unsteady problems by proposing a goal-oriented space–time error analysis. This requires the computation of the unsteady adjoint state backward in time

a conservative solution transfer to considerably diminish the error introduced by this stage of the algorithm

a high-quality anisotropic local remeshing controlling the heights of the elements to guarantee acceptable solver time steps and to ensure maximal robustness in the meshing process. This issue has been handled with care inside feflo.a which is described in Section  4.2.

At each remeshing, the solution needs to be transferred from the previous mesh to the next one to pursue the computation. This stage becomes crucial in the context of unsteady problems and even more if a large number of transfers is performed, as the error introduced by this stage can spoil the overall accuracy of the solution. In the context of the resolution by a second order numerical scheme of a PDE system of conservation laws, as the compressible Euler system, it seems mandatory for the interpolation method to satisfy the following properties in order to obtain a consistent mesh adaptation scheme: mass conservation, 
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                         exactness preserving the second order of the adaptive strategy, and verify the maximum principle.

The mass conservation property of the interpolation operator is achieved by local mesh intersections, i.e., intersections are performed at the element level. The use of mesh intersection to build a conservative interpolation process seems natural for unconnected meshes. The locality is primordial for efficiency and robustness. The idea is to find, for each element of the new mesh, its geometric intersection with all the elements of the background mesh it overlaps and to mesh this geometric intersection with simplices. We are then able to use a Gauss quadrature formula to exactly compute the mass which has been locally transferred.

High-order accuracy is obtained through the reconstruction of the gradient of the solution from the discrete data and the use of some Taylor formulae. Unfortunately, this high-order interpolation can lead to a loss of monotonicity. The maximum principle is recovered by correcting the interpolated solution in a conservative manner. Finally, the solution values at vertices are reconstructed from this piecewise linear by element discontinuous representation of the solution. More details can be found in  [74,75].

The algorithm can be summarized as follow:


                        
                           
                              
                           
                        
                     


                        Fig. 15
                         points out the superiority of the 
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                        -conservative solution transfer (right) with respect to the classic 
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                         interpolation (left) on an adaptive blast simulation in two dimensions. For both simulations, all parameters are the same except for the solution transfer stage. This figure shows the final solution obtained with 70 mesh adaptations, i.e., a total of 70 solution transfers. The diffusion and the error introduced by the classic 
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                         solution transfer clearly spoils the solution accuracy while the solution remains very accurate with the 
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                        -conservative operator.

For the optimal space–time mesh, we seek to control the space–time spatial discretization error. The following assumption is made (it has been demonstrated under specific conditions in  [48]): as an explicit time scheme is used for time advancing, then the error in time is controlled by the error in space under CFL condition. As far as the above hypothesis is true, the spatial interpolation error is a good measure of the total space–time error of the discretized unsteady system.

Our goal is to solve an unsteady PDE which is set in the computational space–time domain 
                              Q
                              =
                              Ω
                              ×
                              
                                 [
                                 0
                                 ,
                                 T
                                 ]
                              
                            where 
                              T
                            is the (positive) maximal time and 
                              Ω
                              ⊂
                              
                                 
                                    R
                                 
                                 
                                    3
                                 
                              
                            is the spatial domain. Let 
                              
                                 
                                    Π
                                 
                                 
                                    h
                                 
                              
                            be the usual 
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                              
                            projector. Its extension to time-dependent functions reads: 
                              
                                 
                                    
                                       (
                                       
                                          
                                             Π
                                          
                                          
                                             h
                                          
                                       
                                       φ
                                       )
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    =
                                    
                                       
                                          Π
                                       
                                       
                                          h
                                       
                                    
                                    
                                       (
                                       φ
                                       
                                          (
                                          t
                                          )
                                       
                                       )
                                    
                                    ,
                                    
                                    ∀
                                    
                                    t
                                    ∈
                                    
                                       [
                                       0
                                       ,
                                       T
                                       ]
                                    
                                    .
                                 
                              
                            The considered problem of mesh adaptation consists in finding the space–time mesh 
                              H
                            of 
                              Q
                            that minimizes the space–time linear interpolation error 
                              u
                              −
                              
                                 
                                    Π
                                 
                                 
                                    h
                                 
                              
                              u
                            in 
                              
                                 
                                    L
                                 
                                 
                                    p
                                 
                              
                            norm. The problem is thus stated in an a priori way: 
                              
                                 
                                    Find  
                                    
                                       
                                          H
                                       
                                       
                                          
                                             opt
                                          
                                       
                                    
                                      having  
                                    
                                       
                                          N
                                       
                                       
                                          
                                             st
                                          
                                       
                                    
                                      space–time vertices such that  
                                    
                                       
                                          
                                             E
                                          
                                       
                                       
                                          
                                             
                                                L
                                             
                                             
                                                p
                                             
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             H
                                          
                                          
                                             
                                                opt
                                             
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          min
                                       
                                       
                                          H
                                       
                                    
                                    
                                       
                                          
                                             ‖
                                             u
                                             −
                                             
                                                
                                                   Π
                                                
                                                
                                                   h
                                                
                                             
                                             u
                                             ‖
                                          
                                       
                                       
                                          
                                             
                                                L
                                             
                                             
                                                p
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   Ω
                                                
                                                
                                                   h
                                                
                                             
                                             ×
                                             
                                                [
                                                0
                                                ,
                                                T
                                                ]
                                             
                                             )
                                          
                                       
                                    
                                    .
                                 
                              
                            In the continuous mesh framework, we rewrite this problem under the continuous form: 
                              
                                 (23)
                                 
                                    Find  
                                    
                                       
                                          
                                             M
                                          
                                       
                                       
                                          
                                             
                                                L
                                             
                                             
                                                p
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   M
                                                
                                                
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         p
                                                      
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   x
                                                
                                                ,
                                                t
                                                )
                                             
                                             )
                                          
                                       
                                       
                                          
                                             (
                                             
                                                x
                                             
                                             ,
                                             t
                                             )
                                          
                                          ∈
                                          Q
                                       
                                    
                                    
                                    such that  
                                    
                                       
                                          
                                             E
                                          
                                       
                                       
                                          
                                             
                                                L
                                             
                                             
                                                p
                                             
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                M
                                             
                                          
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   p
                                                
                                             
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          min
                                       
                                       
                                          
                                             M
                                          
                                       
                                    
                                    
                                       
                                          
                                             ‖
                                             u
                                             −
                                             
                                                
                                                   π
                                                
                                                
                                                   M
                                                
                                             
                                             u
                                             ‖
                                          
                                       
                                       
                                          
                                             
                                                L
                                             
                                             
                                                p
                                             
                                          
                                          
                                             (
                                             Ω
                                             ×
                                             
                                                [
                                                0
                                                ,
                                                T
                                                ]
                                             
                                             )
                                          
                                       
                                    
                                    ,
                                 
                              
                            under the space–time constraint: 
                              
                                 (24)
                                 
                                    
                                       
                                          C
                                       
                                       
                                          
                                             st
                                          
                                       
                                    
                                    
                                       (
                                       
                                          M
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          ∫
                                       
                                       
                                          0
                                       
                                       
                                          T
                                       
                                    
                                    τ
                                    
                                       
                                          
                                             (
                                             t
                                             )
                                          
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       (
                                       
                                          
                                             ∫
                                          
                                          
                                             Ω
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             M
                                          
                                       
                                       
                                          (
                                          
                                             x
                                          
                                          ,
                                          t
                                          )
                                       
                                       
                                       
                                          d
                                       
                                       
                                          x
                                       
                                       )
                                    
                                    
                                    
                                       d
                                    
                                    t
                                    =
                                    
                                       
                                          N
                                       
                                       
                                          
                                             st
                                          
                                       
                                    
                                 
                              
                            where 
                              τ
                              
                                 (
                                 t
                                 )
                              
                            is the time step used at time 
                              t
                            of interval 
                              
                                 [
                                 0
                                 ,
                                 T
                                 ]
                              
                           . Introducing the continuous interpolation error, we recall that we can write the continuous error model as follows: 
                              
                                 
                                    
                                       
                                          
                                             E
                                          
                                       
                                       
                                          
                                             
                                                L
                                             
                                             
                                                p
                                             
                                          
                                       
                                    
                                    
                                       (
                                       
                                          M
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   ∫
                                                
                                                
                                                   0
                                                
                                                
                                                   T
                                                
                                             
                                             
                                                
                                                   ∫
                                                
                                                
                                                   Ω
                                                
                                             
                                             trace
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            M
                                                         
                                                         
                                                            −
                                                            
                                                               
                                                                  1
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         (
                                                         
                                                            x
                                                         
                                                         ,
                                                         t
                                                         )
                                                      
                                                      
                                                         |
                                                         
                                                            
                                                               H
                                                            
                                                            
                                                               u
                                                            
                                                         
                                                         
                                                            (
                                                            
                                                               x
                                                            
                                                            ,
                                                            t
                                                            )
                                                         
                                                         |
                                                      
                                                      
                                                         
                                                            M
                                                         
                                                         
                                                            −
                                                            
                                                               
                                                                  1
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         (
                                                         
                                                            x
                                                         
                                                         ,
                                                         t
                                                         )
                                                      
                                                      )
                                                   
                                                
                                                
                                                   p
                                                
                                             
                                             
                                             
                                                d
                                             
                                             
                                                x
                                             
                                             
                                             
                                                d
                                             
                                             t
                                             )
                                          
                                       
                                       
                                          
                                             
                                                1
                                             
                                             
                                                p
                                             
                                          
                                       
                                    
                                 
                              
                            where 
                              
                                 
                                    H
                                 
                                 
                                    u
                                 
                              
                            is the Hessian of sensor 
                              u
                           . To find the optimal space–time continuous mesh, Problem (23)–(24) is solved in two steps. First, a spatial minimization is done for a fixed 
                              t
                           . Second, a temporal minimization is performed. Here, we consider the case where the time step 
                              τ
                            is specified by the user as a function of time 
                              t
                              →
                              τ
                              
                                 (
                                 t
                                 )
                              
                           . A similar analysis can be done to deal with the case of an explicit time advancing solver subject to Courant time step condition. It leads to the expression of the optimal space–time metric 
                              
                                 
                                    
                                       M
                                    
                                 
                                 
                                    
                                       
                                          L
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                            for a prescribed time step 
                              τ
                              
                                 (
                                 t
                                 )
                              
                           : 
                              
                                 (25)
                                 
                                    
                                       
                                          M
                                       
                                       
                                          
                                             
                                                L
                                             
                                             
                                                p
                                             
                                          
                                       
                                    
                                    
                                       (
                                       
                                          x
                                       
                                       ,
                                       t
                                       )
                                    
                                    =
                                    
                                       
                                          N
                                       
                                       
                                          
                                             st
                                          
                                       
                                       
                                          
                                             
                                                2
                                             
                                             
                                                3
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   ∫
                                                
                                                
                                                   0
                                                
                                                
                                                   T
                                                
                                             
                                             τ
                                             
                                                
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                
                                                
                                                   −
                                                   
                                                      
                                                         2
                                                         p
                                                      
                                                      
                                                         2
                                                         p
                                                         +
                                                         3
                                                      
                                                   
                                                
                                             
                                             
                                             K
                                             
                                                (
                                                t
                                                )
                                             
                                             
                                                d
                                             
                                             t
                                             )
                                          
                                       
                                       
                                          −
                                          
                                             
                                                2
                                             
                                             
                                                3
                                             
                                          
                                       
                                    
                                    τ
                                    
                                       
                                          
                                             (
                                             t
                                             )
                                          
                                       
                                       
                                          
                                             
                                                2
                                             
                                             
                                                2
                                                p
                                                +
                                                3
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             (
                                             det
                                             
                                                |
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      u
                                                   
                                                
                                                
                                                   (
                                                   
                                                      x
                                                   
                                                   ,
                                                   t
                                                   )
                                                
                                                |
                                             
                                             )
                                          
                                       
                                       
                                          −
                                          
                                             
                                                1
                                             
                                             
                                                2
                                                p
                                                +
                                                3
                                             
                                          
                                       
                                    
                                    
                                       |
                                       
                                          
                                             H
                                          
                                          
                                             u
                                          
                                       
                                       
                                          (
                                          
                                             x
                                          
                                          ,
                                          t
                                          )
                                       
                                       |
                                    
                                    ,
                                 
                              
                            where 
                              K
                              
                                 (
                                 t
                                 )
                              
                              =
                              
                                 (
                                 
                                    
                                       ∫
                                    
                                    
                                       Ω
                                    
                                 
                                 
                                    
                                       
                                          (
                                          det
                                          
                                             |
                                             
                                                
                                                   H
                                                
                                                
                                                   u
                                                
                                             
                                             
                                                (
                                                
                                                   x
                                                
                                                ,
                                                t
                                                )
                                             
                                             |
                                          
                                          )
                                       
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             2
                                             p
                                             +
                                             3
                                          
                                       
                                    
                                 
                                 
                                    d
                                 
                                 
                                    x
                                 
                                 )
                              
                           . The following optimal error is finally obtained: 
                              
                                 (26)
                                 
                                    
                                       
                                          
                                             E
                                          
                                       
                                       
                                          
                                             
                                                L
                                             
                                             
                                                p
                                             
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                M
                                             
                                          
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   p
                                                
                                             
                                          
                                       
                                       )
                                    
                                    =
                                    3
                                    
                                    
                                       
                                          N
                                       
                                       
                                          
                                             st
                                          
                                       
                                       
                                          −
                                          
                                             
                                                2
                                             
                                             
                                                3
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   ∫
                                                
                                                
                                                   0
                                                
                                                
                                                   T
                                                
                                             
                                             τ
                                             
                                                
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                
                                                
                                                   −
                                                   
                                                      
                                                         2
                                                         p
                                                      
                                                      
                                                         2
                                                         p
                                                         +
                                                         3
                                                      
                                                   
                                                
                                             
                                             
                                             K
                                             
                                                (
                                                t
                                                )
                                             
                                             
                                                d
                                             
                                             t
                                             )
                                          
                                       
                                       
                                          
                                             
                                                2
                                                p
                                                +
                                                3
                                             
                                             
                                                3
                                                p
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        

The computation of the optimal instantaneous continuous mesh given by Relation  (25) involves a global normalization term which requires the knowledge of quantities over the whole simulation time frame. Thus, the complete simulation must be performed before evaluating any space–time continuous mesh. To solve this issue, we suggest to consider a global fixed-point mesh adaptation algorithm covering the whole time frame 
                              
                                 [
                                 0
                                 ,
                                 T
                                 ]
                              
                           . This iterative algorithm is used to converge the non-linear mesh adaptation problem, i.e., converging the mesh-solution couple. This is also a way to predict the solution evolution and to adapt the mesh accordingly.

Moreover, the previous analysis provides the optimal size of the adapted meshes for each time level. Hence, this analysis requires the mesh to be adapted at each flow solver time step which is inconceivable in practical applications. We propose to use a coarse adapted discretization of the time axis. The basic idea consists in splitting the simulation time frame 
                              
                                 [
                                 0
                                 ,
                                 
                                 T
                                 ]
                              
                            into 
                              
                                 
                                    n
                                 
                                 
                                    
                                       adap
                                    
                                 
                              
                            adaptation sub-intervals: 
                              
                                 
                                    
                                       [
                                       0
                                       ,
                                       
                                       T
                                       ]
                                    
                                    =
                                    
                                       [
                                       0
                                       =
                                       
                                          
                                             t
                                          
                                          
                                             0
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             t
                                          
                                          
                                             1
                                          
                                       
                                       ]
                                    
                                    ∪
                                    ⋯
                                    ∪
                                    
                                       [
                                       
                                          
                                             t
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             t
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                       ]
                                    
                                    ∪
                                    ⋯
                                    ∪
                                    
                                       [
                                       
                                          
                                             t
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   
                                                      adap
                                                   
                                                
                                             
                                             −
                                             1
                                          
                                       
                                       ,
                                       
                                       
                                          
                                             t
                                          
                                          
                                             
                                                
                                                   n
                                                
                                                
                                                   
                                                      adap
                                                   
                                                
                                             
                                          
                                       
                                       =
                                       T
                                       ]
                                    
                                    ,
                                 
                              
                            and to keep the same adapted spatial mesh for each time sub-interval. On each sub-interval, the mesh is adapted to control the solution accuracy from 
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                            to 
                              
                                 
                                    t
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                           . Consequently, the time-dependent simulation is performed with 
                              
                                 
                                    n
                                 
                                 
                                    
                                       adap
                                    
                                 
                              
                            different adapted meshes. This drastically reduces the number of remeshings during the simulation, hence the number of solution transfers. This provides a first answer to the adaptation of the whole space–time mesh, the spatial mesh being kept constant for each sub-interval when the global space–time mesh is visualized,

Now, we want to extend the previous analysis to the fixed-point mesh adaptation algorithm context where the simulation time interval [0,T] is split into 
                              
                                 
                                    n
                                 
                                 
                                    
                                       adap
                                    
                                 
                              
                            
                           sub-intervals 
                           
                              
                                 [
                                 
                                    
                                       t
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                                 ]
                              
                            for 
                              i
                              =
                              1
                              ,
                              .
                              .
                              ,
                              
                                 
                                    n
                                 
                                 
                                    
                                       adap
                                    
                                 
                              
                           . Each spatial mesh 
                              
                                 
                                    
                                       M
                                    
                                 
                                 
                                    i
                                 
                              
                            is then kept constant during each sub-interval 
                              
                                 [
                                 
                                    
                                       t
                                    
                                    
                                       i
                                       −
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                                 ]
                              
                           . We could consider this partition as a time discretization of the mesh adaptation problem. Following the previous section analysis, we deduce the optimal continuous mesh 
                              
                                 
                                    
                                       M
                                    
                                 
                                 
                                    
                                       
                                          L
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       {
                                       
                                          
                                             
                                                M
                                             
                                          
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   p
                                                
                                             
                                          
                                          
                                             i
                                          
                                       
                                       }
                                    
                                 
                                 
                                    i
                                    =
                                    1
                                    ,
                                    .
                                    .
                                    ,
                                    
                                       
                                          n
                                       
                                       
                                          
                                             adap
                                          
                                       
                                    
                                 
                              
                            and error: 
                              
                                 
                                    (27)
                                    
                                       
                                          
                                             M
                                          
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   p
                                                
                                             
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          
                                             x
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             N
                                          
                                          
                                             
                                                st
                                             
                                          
                                          
                                             
                                                
                                                   2
                                                
                                                
                                                   3
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      j
                                                      =
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            
                                                               adap
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      j
                                                   
                                                
                                                
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               ∫
                                                            
                                                            
                                                               
                                                                  
                                                                     t
                                                                  
                                                                  
                                                                     j
                                                                     −
                                                                     1
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     t
                                                                  
                                                                  
                                                                     j
                                                                  
                                                               
                                                            
                                                         
                                                         τ
                                                         
                                                            
                                                               
                                                                  (
                                                                  t
                                                                  )
                                                               
                                                            
                                                            
                                                               −
                                                               1
                                                            
                                                         
                                                         
                                                            d
                                                         
                                                         t
                                                         )
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            2
                                                            p
                                                         
                                                         
                                                            2
                                                            p
                                                            +
                                                            3
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             −
                                             
                                                
                                                   2
                                                
                                                
                                                   3
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      ∫
                                                   
                                                   
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            i
                                                            −
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                                τ
                                                
                                                   
                                                      
                                                         (
                                                         t
                                                         )
                                                      
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   d
                                                
                                                t
                                                )
                                             
                                          
                                          
                                             −
                                             
                                                
                                                   2
                                                
                                                
                                                   2
                                                   p
                                                   +
                                                   3
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                (
                                                det
                                                
                                                   
                                                      
                                                         H
                                                      
                                                   
                                                   
                                                      u
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   (
                                                   
                                                      x
                                                   
                                                   )
                                                
                                                )
                                             
                                          
                                          
                                             −
                                             
                                                
                                                   1
                                                
                                                
                                                   2
                                                   p
                                                   +
                                                   3
                                                
                                             
                                          
                                       
                                       
                                       
                                          
                                             
                                                H
                                             
                                          
                                          
                                             u
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          
                                             x
                                          
                                          )
                                       
                                    
                                 
                                 
                                    (28)
                                    
                                       
                                          
                                             
                                                E
                                             
                                          
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   p
                                                
                                             
                                          
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   M
                                                
                                             
                                             
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      p
                                                   
                                                
                                             
                                          
                                          )
                                       
                                       =
                                       3
                                       
                                       
                                          
                                             N
                                          
                                          
                                             
                                                st
                                             
                                          
                                          
                                             −
                                             
                                                
                                                   2
                                                
                                                
                                                   3
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            
                                                               adap
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               ∫
                                                            
                                                            
                                                               
                                                                  
                                                                     t
                                                                  
                                                                  
                                                                     i
                                                                     −
                                                                     1
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     t
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                            
                                                         
                                                         τ
                                                         
                                                            
                                                               
                                                                  (
                                                                  t
                                                                  )
                                                               
                                                            
                                                            
                                                               −
                                                               1
                                                            
                                                         
                                                         
                                                            d
                                                         
                                                         t
                                                         )
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            2
                                                            p
                                                         
                                                         
                                                            2
                                                            p
                                                            +
                                                            3
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             
                                                
                                                   2
                                                   p
                                                   +
                                                   3
                                                
                                                
                                                   3
                                                   p
                                                
                                             
                                          
                                       
                                       ,
                                    
                                 
                              
                            where 
                              
                                 
                                    K
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 (
                                 
                                    
                                       ∫
                                    
                                    
                                       Ω
                                    
                                 
                                 
                                    
                                       
                                          (
                                          det
                                          
                                             
                                                
                                                   H
                                                
                                             
                                             
                                                u
                                             
                                             
                                                i
                                             
                                          
                                          
                                             (
                                             
                                                x
                                             
                                             )
                                          
                                          )
                                       
                                    
                                    
                                       
                                          
                                             p
                                          
                                          
                                             2
                                             p
                                             +
                                             3
                                          
                                       
                                    
                                 
                                 
                                    d
                                 
                                 
                                    x
                                 
                                 )
                              
                            and matrix 
                              
                                 
                                    
                                       H
                                    
                                 
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                            on sub-interval 
                              i
                            can be defined by either using an 
                              
                                 
                                    L
                                 
                                 
                                    1
                                 
                              
                            or an 
                              
                                 
                                    L
                                 
                                 
                                    ∞
                                 
                              
                            norm: 
                              
                                 (29)
                                 
                                    
                                       
                                          
                                             H
                                          
                                       
                                       
                                          
                                             
                                                L
                                             
                                             
                                                1
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       
                                          x
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          ∫
                                       
                                       
                                          
                                             
                                                t
                                             
                                             
                                                i
                                                −
                                                1
                                             
                                          
                                       
                                       
                                          
                                             
                                                t
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    
                                       |
                                       
                                          
                                             H
                                          
                                          
                                             u
                                          
                                       
                                       
                                          (
                                          
                                             x
                                          
                                          ,
                                          t
                                          )
                                       
                                       |
                                    
                                    
                                    
                                       d
                                    
                                    t
                                    
                                    or
                                    
                                    
                                       
                                          
                                             H
                                          
                                       
                                       
                                          
                                             
                                                L
                                             
                                             
                                                ∞
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       
                                          x
                                       
                                       )
                                    
                                    =
                                    
                                       Δ
                                    
                                    
                                       
                                          t
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          max
                                       
                                       
                                          t
                                          ∈
                                          
                                             [
                                             
                                                
                                                   t
                                                
                                                
                                                   i
                                                   −
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   i
                                                
                                             
                                             ]
                                          
                                       
                                    
                                    
                                       |
                                       
                                          
                                             H
                                          
                                          
                                             u
                                          
                                       
                                       
                                          (
                                          
                                             x
                                          
                                          ,
                                          t
                                          )
                                       
                                       |
                                    
                                    
                                    with  
                                    
                                       Δ
                                    
                                    
                                       
                                          t
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    
                                       
                                          t
                                       
                                       
                                          i
                                       
                                    
                                    −
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                    .
                                 
                              
                           
                        

The global fixed-point mesh adaptation algorithm is schematized in Algorithm 4 where 
                              H
                           , 
                              S
                            and 
                              M
                            denote respectively meshes, solutions and metrics. And, 
                              
                                 H
                              
                            is the Hessian-metric given by Relation  (29).


                           
                              
                                 
                              
                           
                        


                           Choice of the optimal continuous mesh. For the numerical results presented below, the following particular choice has been made to compute the optimal mesh given by Relation  (27): 
                              
                                 •
                                 the Hessian-metric for sub-interval 
                                       i
                                     is discretized in time in 
                                       
                                          
                                             L
                                          
                                          
                                             1
                                          
                                       
                                     norm: 
                                       
                                          
                                             
                                                H
                                             
                                          
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          
                                             i
                                          
                                       
                                    
                                 

all sub-intervals have the same time length 
                                       
                                          Δ
                                       
                                       t
                                       =
                                       T
                                       /
                                       
                                          
                                             n
                                          
                                          
                                             
                                                adap
                                             
                                          
                                       
                                    .

Practically, it remains to know how to compute the Hessian-metric 
                              
                                 
                                    
                                       H
                                    
                                 
                                 
                                    
                                       
                                          L
                                       
                                       
                                          1
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                            on sub-interval 
                              i
                            given by Relations  (29), i.e., how it is discretized. The strategy adopted in  [48] is to sample the solution on the time sub-interval. More precisely, 
                              
                                 
                                    n
                                 
                                 
                                    k
                                 
                              
                            solutions equally distributed on the sub-interval time frame are saved, including the initial solution at 
                              
                                 
                                    t
                                 
                                 
                                    i
                                    −
                                    1
                                 
                              
                            and the final solution at 
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                           . Positive Hessian 
                              
                                 |
                                 
                                    
                                       H
                                    
                                    
                                       u
                                    
                                 
                                 
                                    (
                                    
                                       x
                                    
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 |
                              
                            is evaluated for each sample. We consider the Hessian-metric 
                              
                                 
                                    
                                       H
                                    
                                 
                                 
                                    
                                       
                                          L
                                       
                                       
                                          1
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                            which is evaluated as follows: 
                              
                                 
                                    
                                       
                                          
                                             H
                                          
                                       
                                       
                                          
                                             
                                                L
                                             
                                             
                                                1
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       
                                          x
                                       
                                       )
                                    
                                    ≈
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             Δ
                                          
                                          
                                             
                                                t
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                k
                                             
                                          
                                          −
                                          1
                                       
                                    
                                    
                                       |
                                       
                                          
                                             H
                                          
                                          
                                             u
                                          
                                       
                                       
                                          (
                                          
                                             x
                                          
                                          ,
                                          
                                             
                                                t
                                             
                                             
                                                i
                                                −
                                                1
                                             
                                          
                                          )
                                       
                                       |
                                    
                                    +
                                    
                                       
                                          
                                             Δ
                                          
                                          
                                             
                                                t
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                k
                                             
                                          
                                          −
                                          1
                                       
                                    
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          2
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                k
                                             
                                          
                                          −
                                          1
                                       
                                    
                                    
                                       |
                                       
                                          
                                             H
                                          
                                          
                                             u
                                          
                                       
                                       
                                          (
                                          
                                             x
                                          
                                          ,
                                          
                                             
                                                t
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                       |
                                    
                                    +
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             Δ
                                          
                                          
                                             
                                                t
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                k
                                             
                                          
                                          −
                                          1
                                       
                                    
                                    
                                       |
                                       
                                          
                                             H
                                          
                                          
                                             u
                                          
                                       
                                       
                                          (
                                          
                                             x
                                          
                                          ,
                                          
                                             
                                                t
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                       |
                                    
                                    =
                                    
                                       Δ
                                    
                                    
                                       
                                          t
                                       
                                       
                                          i
                                       
                                    
                                    
                                    
                                       |
                                       
                                          
                                             H
                                          
                                          
                                             
                                                avg
                                             
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          
                                             x
                                          
                                          )
                                       
                                       |
                                    
                                    ,
                                 
                              
                            where 
                              
                                 Δ
                              
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              −
                              
                                 
                                    t
                                 
                                 
                                    i
                                    −
                                    1
                                 
                              
                            is the sub-interval time length and 
                              
                                 
                                    t
                                 
                                 
                                    k
                                 
                              
                              =
                              
                                 
                                    t
                                 
                                 
                                    i
                                    −
                                    1
                                 
                              
                              +
                              
                                 
                                    k
                                    −
                                    1
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          k
                                       
                                    
                                    −
                                    1
                                 
                              
                              
                                 Δ
                              
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                           .

Moreover, it is clear that the integral 
                              
                                 
                                    ∫
                                 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              τ
                              
                                 
                                    
                                       (
                                       t
                                       )
                                    
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 d
                              
                              t
                            corresponds to the number of time steps (iterations) performed by the flow solver during the 
                              i
                           th sub-interval. In practice using the flow solver number of iterations of each sub-interval to define the continuous mesh may cause trouble because it highly depends on the discrete representation of the continuous mesh, i.e., the generated discrete mesh. Thus, the number of iterations of a sub-interval may substantially vary between two fixed-point iterations. To avoid this issue, one may prefer considering the flow solver time step constant on each sub-interval. In that case, we can just consider the time step 
                              τ
                              
                                 (
                                 t
                                 )
                              
                            constant and equal to 
                              
                                 Δ
                              
                              t
                            (because of the global normalization term) so the integral 
                              
                                 
                                    ∫
                                 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          i
                                          −
                                          1
                                       
                                    
                                 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              τ
                              
                                 
                                    
                                       (
                                       t
                                       )
                                    
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 d
                              
                              t
                            reduces to 1. Another approach is to compute the continuous time step by means of the CFL condition associated with the continuous mesh. This will cancel any issue due to the discretization. Here, we chose the first approach by considering the time step constant.

With these choices, the optimal continuous mesh 
                              
                                 
                                    
                                       M
                                    
                                 
                                 
                                    
                                       
                                          L
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       {
                                       
                                          
                                             
                                                M
                                             
                                          
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   p
                                                
                                             
                                          
                                          
                                             i
                                          
                                       
                                       }
                                    
                                 
                                 
                                    i
                                    =
                                    1
                                    ,
                                    .
                                    .
                                    ,
                                    
                                       
                                          n
                                       
                                       
                                          
                                             adap
                                          
                                       
                                    
                                 
                              
                            simplifies to: 
                              
                                 
                                    
                                       
                                          M
                                       
                                       
                                          
                                             
                                                L
                                             
                                             
                                                p
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       
                                          x
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          N
                                       
                                       
                                          
                                             st
                                          
                                       
                                       
                                          
                                             
                                                2
                                             
                                             
                                                3
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         
                                                            adap
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      ∫
                                                   
                                                   
                                                      Ω
                                                   
                                                
                                                
                                                   
                                                      
                                                         (
                                                         det
                                                         
                                                            |
                                                            
                                                               
                                                                  H
                                                               
                                                               
                                                                  
                                                                     avg
                                                                  
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                            
                                                               (
                                                               
                                                                  x
                                                               
                                                               )
                                                            
                                                            |
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            2
                                                            p
                                                            +
                                                            3
                                                         
                                                      
                                                   
                                                
                                                
                                                   d
                                                
                                                
                                                   x
                                                
                                                )
                                             
                                             )
                                          
                                       
                                       
                                          −
                                          
                                             
                                                2
                                             
                                             
                                                3
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             (
                                             det
                                             
                                                |
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      
                                                         avg
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   (
                                                   
                                                      x
                                                   
                                                   )
                                                
                                                |
                                             
                                             )
                                          
                                       
                                       
                                          −
                                          
                                             
                                                1
                                             
                                             
                                                2
                                                p
                                                +
                                                3
                                             
                                          
                                       
                                    
                                    
                                    
                                       |
                                       
                                          
                                             H
                                          
                                          
                                             
                                                avg
                                             
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          
                                             x
                                          
                                          )
                                       
                                       |
                                    
                                    .
                                 
                              
                           
                           A city blast
                        

This example is a purely three-dimensional blast problem in a complex geometry representing a city. In this simulation, shock waves interact with each other and are reflected by the buildings. The city geometry is the same as in  [48] with a domain size of 
                              85
                              
                              
                                 m
                              
                              ×
                              70
                              
                              
                                 m
                              
                              ×
                              70
                              
                              
                                 m
                              
                           . Initially, the ambient air is at rest 
                              
                                 
                                    ρ
                                 
                                 
                                    
                                       out
                                    
                                 
                              
                              =
                              1
                            and 
                              
                                 
                                    p
                                 
                                 
                                    
                                       out
                                    
                                 
                              
                              =
                              1
                           . To simulate the blast, a high pressure and density region is introduced in a half-sphere of radius 2.5 m. In this region, the relevant parameters are 
                              
                                 
                                    ρ
                                 
                                 
                                    
                                       in
                                    
                                 
                              
                              =
                              10
                           , 
                              
                                 
                                    p
                                 
                                 
                                    
                                       in
                                    
                                 
                              
                              =
                              25
                            and 
                              
                                 
                                    
                                       u
                                    
                                 
                                 
                                    
                                       in
                                    
                                 
                              
                              =
                              
                                 0
                              
                           . For both regions, we have 
                              γ
                              =
                              1.4
                           . The solution is computed until a-dimensioned time 
                              T
                              =
                              15
                           .

The density of the flow is chosen as the sensor variable for our mesh adaptation process. The space–time interpolation error on the sensor is controlled in 
                              
                                 
                                    L
                                 
                                 
                                    2
                                 
                              
                            norm. The time frame was split into 128 adaptation sub-intervals and 5 fixed-point iterations were used to converge the non-linear mesh adaptation problem. For each sub-interval, we consider 21 samples of the solution to build the Hessian-metric in 
                              
                                 
                                    L
                                 
                                 
                                    1
                                 
                              
                            norm. The desired accuracy was set to reach a theoretical space–time complexity 
                              
                                 
                                    N
                                 
                                 
                                    
                                       st
                                    
                                 
                              
                            equal to 
                              128
                              ×
                              800
                              ,
                              000
                              =
                              102.4
                            million. We start from an initial uniform mesh containing 99,255 vertices and 549,128 tetrahedra with a mean accuracy of 35 cm.


                           Figs. 16 and 17
                           
                            show the adapted surface and volume meshes with the corresponding iso-values of the density at the end of sub-interval 43, 86, and 128. It points out the complexity and the unpredictable behavior of the physical phenomena with a large number of shock waves interacting with the geometry. Thanks to the feature-based mesh adaptation, all shock waves are automatically captured by the adaptation process and properly refined. In the adapted meshes pictures, the mesh adaptation for a sub-interval is clearly illustrated. Additionally, the mesh refinement along band-shaped regions, which corresponds to the zone in which physical phenomena evolves during an adaptation sub-interval, are visible. At the end of the simulation, the final adapted mesh for the last sub-interval contains 4,187,548 vertices and 25,249,618 tetrahedra. Its maximal accuracy is about 4 mm. In Table 1
                           , statistics of five meshes, at sub-intervals 1, 32, 64, 92, and 128, are given. We notice that the mesh accuracy is 100 times more accurate than the initial mesh allowing us to accurately capture the solution. As regards the amount of anisotropy for this simulation, an average anisotropic ratio between 12 and 18 and a mean anisotropic quotient between 106 and 270 are obtained. The anisotropic quotient measures the overall gain as compared an isotropic mesh adaptation, here more than 250 for a large part of the simulation. The gain is of course even greater when compared to a uniform mesh.


                           Fig. 18
                            displays the evolution of the results on the city blast simulation. Left, an isotropic mesh adaptation based on a 
                              
                                 
                                    L
                                 
                                 
                                    ∞
                                 
                              
                              −
                              
                                 
                                    L
                                 
                                 
                                    ∞
                                 
                              
                            norm space–time error estimate done in 2003  [115]. Middle, an anisotropic mesh adaptation based on a 
                              
                                 
                                    L
                                 
                                 
                                    ∞
                                 
                              
                              −
                              
                                 
                                    L
                                 
                                 
                                    p
                                 
                              
                            norm space–time error estimate done in 2011  [116]. Right, an anisotropic mesh adaptation based on the 
                              
                                 
                                    L
                                 
                                 
                                    p
                                 
                              
                              −
                              
                                 
                                    L
                                 
                                 
                                    p
                                 
                              
                            norm space–time error estimate presented in this article done in 2014. We clearly see the progress of the results with a lot more physics captured in the later simulations. The quality of the adapted anisotropic meshes has also been especially improved. This is due to the simultaneous advances in the error estimate, the interpolation stage, the flow solver, and the adaptive local remesher.

In the previous section, the extension of the feature-based anisotropic mesh adaptation to time-dependent problems has been detailed. It requires: a space–time 
                           
                              
                                 L
                              
                              
                                 p
                              
                           
                         error analysis and a global fixed-point algorithm to converge the mesh adaptation. Now, the goal is to extend the goal-oriented mesh adaptation to transient simulations by combining the anisotropic goal-oriented error estimate and the fixed-point advances for time-accurate mesh adaptation.

To this end, several methodological issues need to be addressed. First, we propose a global fixed-point algorithm for solving the coupled system made, this time of three fields, the unsteady state, the unsteady adjoint state, and the adapted meshes. Second, this algorithm needs to be a priori analyzed and its convergence rate to a continuous solution needs to be optimized. Third, at the computer algorithmic level, it is also necessary to master the computational (memory and time) cost of the new system, which couples a time-forward state, a time-backward adjoint, and a mesh update influenced by global statistics.

The continuous and discrete state systems and the continuous and discrete adjoint systems are thoroughly detailed in  [117]. For conciseness, we just recall the semi-discrete models. Consider the following semi-discrete unsteady compressible Euler model (explicit RK1 time integration): 
                              
                                 
                                    
                                       
                                          Ψ
                                       
                                       
                                          h
                                       
                                       
                                          n
                                       
                                    
                                    
                                       (
                                       
                                          
                                             W
                                          
                                          
                                             h
                                          
                                          
                                             n
                                          
                                       
                                       ,
                                       
                                          
                                             W
                                          
                                          
                                             h
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          
                                             
                                                W
                                             
                                             
                                                h
                                             
                                             
                                                n
                                             
                                          
                                          −
                                          
                                             
                                                W
                                             
                                             
                                                h
                                             
                                             
                                                n
                                                −
                                                1
                                             
                                          
                                       
                                       
                                          δ
                                          
                                             
                                                t
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          Φ
                                       
                                       
                                          h
                                       
                                    
                                    
                                       (
                                       
                                          
                                             W
                                          
                                          
                                             h
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                       )
                                    
                                    =
                                    0
                                    
                                    for  
                                    n
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    N
                                    .
                                 
                              
                            The problem of minimizing the error committed on the target functional 
                              j
                              
                                 (
                                 
                                    
                                       W
                                    
                                    
                                       h
                                    
                                 
                                 )
                              
                              =
                              
                                 (
                                 g
                                 ,
                                 
                                    
                                       W
                                    
                                    
                                       h
                                    
                                 
                                 )
                              
                           , subject to the previous Euler system, can be transformed into an unconstrained optimization problem for a given Lagrangian functional  [118]. Solving this optimality problem leads to the semi-discrete unsteady adjoint model: 
                              
                                 
                                    
                                       
                                          
                                             Ψ
                                          
                                          
                                             h
                                          
                                          
                                             ∗
                                             ,
                                             n
                                          
                                       
                                       
                                          (
                                          
                                             
                                                W
                                             
                                             
                                                h
                                             
                                             
                                                ∗
                                                ,
                                                n
                                             
                                          
                                          ,
                                          
                                             
                                                W
                                             
                                             
                                                h
                                             
                                             
                                                ∗
                                                ,
                                                n
                                                −
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                W
                                             
                                             
                                                h
                                             
                                             
                                                n
                                                −
                                                1
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   W
                                                
                                                
                                                   h
                                                
                                                
                                                   ∗
                                                   ,
                                                   n
                                                   −
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   W
                                                
                                                
                                                   h
                                                
                                                
                                                   ∗
                                                   ,
                                                   n
                                                
                                             
                                          
                                          
                                             −
                                             δ
                                             
                                                
                                                   t
                                                
                                                
                                                   n
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             Φ
                                          
                                          
                                             h
                                          
                                          
                                             ∗
                                          
                                       
                                       
                                          (
                                          
                                             
                                                W
                                             
                                             
                                                h
                                             
                                             
                                                ∗
                                                ,
                                                n
                                             
                                          
                                          ,
                                          
                                             
                                                W
                                             
                                             
                                                h
                                             
                                             
                                                n
                                                −
                                                1
                                             
                                          
                                          )
                                       
                                       =
                                       0
                                       
                                       for  
                                       n
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       N
                                    
                                 
                                 
                                    
                                       with  
                                       
                                          
                                             Φ
                                          
                                          
                                             h
                                          
                                          
                                             ∗
                                          
                                       
                                       
                                          (
                                          
                                             
                                                W
                                             
                                             
                                                h
                                             
                                             
                                                ∗
                                                ,
                                                n
                                             
                                          
                                          ,
                                          
                                             
                                                W
                                             
                                             
                                                h
                                             
                                             
                                                n
                                                −
                                                1
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             ∂
                                             
                                                
                                                   j
                                                
                                                
                                                   h
                                                
                                                
                                                   n
                                                   −
                                                   1
                                                
                                             
                                          
                                          
                                             ∂
                                             
                                                
                                                   W
                                                
                                                
                                                   h
                                                
                                                
                                                   n
                                                   −
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          (
                                          
                                             
                                                W
                                             
                                             
                                                h
                                             
                                             
                                                n
                                                −
                                                1
                                             
                                          
                                          )
                                       
                                       −
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      W
                                                   
                                                   
                                                      h
                                                   
                                                   
                                                      ∗
                                                      ,
                                                      n
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             ∂
                                             
                                                
                                                   Φ
                                                
                                                
                                                   h
                                                
                                             
                                          
                                          
                                             ∂
                                             
                                                
                                                   W
                                                
                                                
                                                   h
                                                
                                                
                                                   n
                                                   −
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          (
                                          
                                             
                                                W
                                             
                                             
                                                h
                                             
                                             
                                                n
                                                −
                                                1
                                             
                                          
                                          )
                                       
                                       .
                                    
                                 
                              
                            The adjoint system runs in reverse time: computing 
                              
                                 
                                    W
                                 
                                 
                                    h
                                 
                                 
                                    ∗
                                    ,
                                    n
                                    −
                                    1
                                 
                              
                            at time 
                              
                                 
                                    t
                                 
                                 
                                    n
                                    −
                                    1
                                 
                              
                            requires the knowledge of state 
                              
                                 
                                    W
                                 
                                 
                                    h
                                 
                                 
                                    n
                                    −
                                    1
                                 
                              
                            and adjoint state 
                              
                                 
                                    W
                                 
                                 
                                    h
                                 
                                 
                                    ∗
                                    ,
                                    n
                                 
                              
                           .


                           
                              
                                 
                              
                           
                        

Therefore, the knowledge of all states 
                              
                                 
                                    
                                       {
                                       
                                          
                                             W
                                          
                                          
                                             h
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                       }
                                    
                                 
                                 
                                    n
                                    =
                                    1
                                    ,
                                    N
                                 
                              
                            is needed to compute backwards the adjoint state from time 
                              T
                            to 0 which involves large memory storage effort. For instance, if we consider a 3D simulation with a mesh composed of one million vertices then we need to store at each iteration five million solution data (we have five conservative variables). If we perform 1000 iterations, then the memory effort to store all states is 37.25 Gb for double-type data storage (or 18.62 Gb for float-type data storage). Two strategies are employed to reduce this drawback: checkpoints and interpolation.

The memory effort can be reduced by out-of-core storage of checkpoints as shown in the picture below. First the state-simulation is performed to store checkpoints. Second, when computing backwards the adjoint, we first recompute all states from the checkpoint and store them in memory, and then we compute the unsteady adjoint until the checkpoint physical time. This method implies a recomputing effort of the state 
                              W
                           .

The other strategy consists of storing solution states in memory for each 
                              m
                            solver iterations only. When the unsteady adjoint is solved, solution states between two savings are linearly interpolated. This method leads to a loss of accuracy for the unsteady adjoint computation.


                           
                              
                                 
                              
                           
                        

We follow the analysis of the previous sections, by neglecting boundary condition contributions and working in the continuous mesh framework, the error model for the approximation error on the functional becomes: 
                              
                                 
                                    (30)
                                    
                                       
                                          |
                                          j
                                          
                                             (
                                             W
                                             )
                                          
                                          −
                                          j
                                          
                                             (
                                             
                                                
                                                   W
                                                
                                                
                                                   h
                                                
                                             
                                             )
                                          
                                          |
                                       
                                       ≈
                                       
                                          
                                             ∫
                                          
                                          
                                             0
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             ∫
                                          
                                          
                                             Ω
                                          
                                       
                                       
                                          |
                                          
                                             
                                                W
                                             
                                             
                                                ∗
                                             
                                          
                                          |
                                       
                                       
                                       
                                          |
                                          
                                             
                                                
                                                   (
                                                   W
                                                   −
                                                   
                                                      
                                                         π
                                                      
                                                      
                                                         M
                                                      
                                                   
                                                   W
                                                   )
                                                
                                             
                                             
                                                t
                                             
                                          
                                          |
                                       
                                       
                                       
                                          d
                                       
                                       Ω
                                       
                                       
                                          d
                                       
                                       t
                                       +
                                       
                                          
                                             ∫
                                          
                                          
                                             0
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             ∫
                                          
                                          
                                             Ω
                                          
                                       
                                       
                                          |
                                          ∇
                                          
                                             
                                                W
                                             
                                             
                                                ∗
                                             
                                          
                                          |
                                       
                                       
                                       
                                          |
                                          F
                                          
                                             (
                                             W
                                             )
                                          
                                          −
                                          
                                             
                                                π
                                             
                                             
                                                M
                                             
                                          
                                          F
                                          
                                             (
                                             W
                                             )
                                          
                                          |
                                       
                                       
                                       
                                          d
                                       
                                       Ω
                                       
                                       
                                          d
                                       
                                       t
                                       =
                                       
                                          
                                             ∫
                                          
                                          
                                             0
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             ∫
                                          
                                          
                                             Ω
                                          
                                       
                                       trace
                                       
                                          (
                                          
                                             
                                                M
                                             
                                             
                                                −
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             (
                                             
                                                x
                                             
                                             ,
                                             t
                                             )
                                          
                                          
                                          
                                             
                                                H
                                             
                                             
                                                
                                                   go
                                                
                                             
                                          
                                          
                                             (
                                             
                                                x
                                             
                                             ,
                                             t
                                             )
                                          
                                          
                                          
                                             
                                                M
                                             
                                             
                                                −
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             (
                                             
                                                x
                                             
                                             ,
                                             t
                                             )
                                          
                                          )
                                       
                                       
                                       
                                          d
                                       
                                       Ω
                                       
                                       
                                          d
                                       
                                       t
                                       =
                                       
                                          
                                             
                                                E
                                             
                                          
                                          
                                             
                                                go
                                             
                                          
                                       
                                       
                                          (
                                          
                                             M
                                          
                                          )
                                       
                                    
                                 
                                 
                                    
                                       where  
                                       
                                          
                                             H
                                          
                                          
                                             
                                                go
                                             
                                          
                                       
                                       
                                          (
                                          
                                             x
                                          
                                          ,
                                          t
                                          )
                                       
                                       =
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             5
                                          
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   [
                                                   
                                                      Δ
                                                   
                                                   t
                                                   ]
                                                
                                             
                                             
                                                j
                                             
                                          
                                          
                                             (
                                             
                                                x
                                             
                                             ,
                                             t
                                             )
                                          
                                          +
                                          
                                             
                                                
                                                   [
                                                   
                                                      Δ
                                                   
                                                   x
                                                   ]
                                                
                                             
                                             
                                                j
                                             
                                          
                                          
                                             (
                                             
                                                x
                                             
                                             ,
                                             t
                                             )
                                          
                                          +
                                          
                                             
                                                
                                                   [
                                                   
                                                      Δ
                                                   
                                                   y
                                                   ]
                                                
                                             
                                             
                                                j
                                             
                                          
                                          
                                             (
                                             
                                                x
                                             
                                             ,
                                             t
                                             )
                                          
                                          +
                                          
                                             
                                                
                                                   [
                                                   
                                                      Δ
                                                   
                                                   z
                                                   ]
                                                
                                             
                                             
                                                j
                                             
                                          
                                          
                                             (
                                             
                                                x
                                             
                                             ,
                                             t
                                             )
                                          
                                          )
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       with  
                                       
                                          
                                             
                                                [
                                                
                                                   Δ
                                                
                                                t
                                                ]
                                             
                                          
                                          
                                             j
                                          
                                       
                                       
                                          (
                                          
                                             x
                                          
                                          ,
                                          t
                                          )
                                       
                                       =
                                       
                                          |
                                          
                                             
                                                ∂
                                                
                                                   
                                                      W
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                             
                                                ∂
                                                t
                                             
                                          
                                          
                                             (
                                             
                                                x
                                             
                                             ,
                                             t
                                             )
                                          
                                          |
                                       
                                       ⋅
                                       
                                          |
                                          H
                                          
                                             (
                                             
                                                
                                                   W
                                                
                                                
                                                   j
                                                
                                             
                                             )
                                          
                                          
                                             (
                                             
                                                x
                                             
                                             ,
                                             t
                                             )
                                          
                                          |
                                       
                                       ,
                                       
                                       
                                          
                                             
                                                [
                                                
                                                   Δ
                                                
                                                x
                                                ]
                                             
                                          
                                          
                                             j
                                          
                                       
                                       
                                          (
                                          
                                             x
                                          
                                          ,
                                          t
                                          )
                                       
                                       =
                                       
                                          |
                                          
                                             
                                                ∂
                                                
                                                   
                                                      W
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                             
                                                ∂
                                                x
                                             
                                          
                                          
                                             (
                                             
                                                x
                                             
                                             ,
                                             t
                                             )
                                          
                                          |
                                       
                                       ⋅
                                       
                                          |
                                          H
                                          
                                             (
                                             
                                                
                                                   F
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      W
                                                   
                                                   
                                                      j
                                                   
                                                
                                                )
                                             
                                             )
                                          
                                          
                                             (
                                             
                                                x
                                             
                                             ,
                                             t
                                             )
                                          
                                          |
                                       
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                [
                                                
                                                   Δ
                                                
                                                y
                                                ]
                                             
                                          
                                          
                                             j
                                          
                                       
                                       
                                          (
                                          
                                             x
                                          
                                          ,
                                          t
                                          )
                                       
                                       =
                                       
                                          |
                                          
                                             
                                                ∂
                                                
                                                   
                                                      W
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                             
                                                ∂
                                                y
                                             
                                          
                                          
                                             (
                                             
                                                x
                                             
                                             ,
                                             t
                                             )
                                          
                                          |
                                       
                                       ⋅
                                       
                                          |
                                          H
                                          
                                             (
                                             
                                                
                                                   F
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      W
                                                   
                                                   
                                                      j
                                                   
                                                
                                                )
                                             
                                             )
                                          
                                          
                                             (
                                             
                                                x
                                             
                                             ,
                                             t
                                             )
                                          
                                          |
                                       
                                       ,
                                       
                                       
                                          
                                             
                                                [
                                                
                                                   Δ
                                                
                                                z
                                                ]
                                             
                                          
                                          
                                             j
                                          
                                       
                                       
                                          (
                                          
                                             x
                                          
                                          ,
                                          t
                                          )
                                       
                                       =
                                       
                                          |
                                          
                                             
                                                ∂
                                                
                                                   
                                                      W
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                             
                                                ∂
                                                z
                                             
                                          
                                          
                                             (
                                             
                                                x
                                             
                                             ,
                                             t
                                             )
                                          
                                          |
                                       
                                       ⋅
                                       
                                          |
                                          H
                                          
                                             (
                                             
                                                
                                                   F
                                                
                                                
                                                   3
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      W
                                                   
                                                   
                                                      j
                                                   
                                                
                                                )
                                             
                                             )
                                          
                                          
                                             (
                                             
                                                x
                                             
                                             ,
                                             t
                                             )
                                          
                                          |
                                       
                                       .
                                    
                                 
                              
                            The optimal unsteady goal-oriented continuous mesh is obtained by minimizing the space–time error model: 
                              
                                 (31)
                                 
                                    Find  
                                    
                                       
                                          
                                             M
                                          
                                       
                                       
                                          
                                             go
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   M
                                                
                                                
                                                   
                                                      go
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   x
                                                
                                                ,
                                                t
                                                )
                                             
                                             )
                                          
                                       
                                       
                                          
                                             (
                                             
                                                x
                                             
                                             ,
                                             t
                                             )
                                          
                                          ∈
                                          
                                             (
                                             Ω
                                             ×
                                             
                                                [
                                                0
                                                ,
                                                T
                                                ]
                                             
                                             )
                                          
                                       
                                    
                                    
                                    such that  
                                    
                                       
                                          
                                             E
                                          
                                       
                                       
                                          
                                             go
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                M
                                             
                                          
                                          
                                             
                                                go
                                             
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          min
                                       
                                       
                                          
                                             M
                                          
                                       
                                    
                                    
                                       
                                          
                                             E
                                          
                                       
                                       
                                          
                                             go
                                          
                                       
                                    
                                    
                                       (
                                       
                                          M
                                       
                                       )
                                    
                                 
                              
                            under the space–time constraint: 
                              
                                 (32)
                                 
                                    
                                       
                                          C
                                       
                                       
                                          
                                             st
                                          
                                       
                                    
                                    
                                       (
                                       
                                          M
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          ∫
                                       
                                       
                                          0
                                       
                                       
                                          T
                                       
                                    
                                    τ
                                    
                                       
                                          
                                             (
                                             t
                                             )
                                          
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       (
                                       
                                          
                                             ∫
                                          
                                          
                                             Ω
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             M
                                          
                                       
                                       
                                          (
                                          
                                             x
                                          
                                          ,
                                          t
                                          )
                                       
                                       
                                       
                                          d
                                       
                                       
                                          x
                                       
                                       )
                                    
                                    
                                    
                                       d
                                    
                                    t
                                    =
                                    
                                       
                                          N
                                       
                                       
                                          
                                             st
                                          
                                       
                                    
                                 
                              
                            where 
                              τ
                              
                                 (
                                 t
                                 )
                              
                            is the time step used at time 
                              t
                            of interval 
                              
                                 [
                                 0
                                 ,
                                 T
                                 ]
                              
                           . Similarly to Section  5.3, after a spatial and a temporal minimization, we get the optimal continuous mesh given by Relations (27) and (29) where 
                              
                                 
                                    H
                                 
                                 
                                    u
                                 
                              
                            is substituted by 
                              
                                 
                                    H
                                 
                                 
                                    
                                       go
                                    
                                 
                              
                            and the norm 
                              p
                            is set to 1.

To converge the non-linear mesh adaptation problem and to compute the unsteady goal-oriented continuous meshes, the global fixed-point algorithm of Section  5.3.3 is generalized in Algorithm 5. Let us describe this algorithm. It consists of splitting the time interval 
                              
                                 [
                                 0
                                 ,
                                 T
                                 ]
                              
                            into the 
                              
                                 
                                    n
                                 
                                 
                                    
                                       adap
                                    
                                 
                              
                            mesh-adaptation time sub-intervals: 
                              
                                 
                                    
                                       {
                                       
                                          [
                                          
                                             
                                                t
                                             
                                             
                                                i
                                                −
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                t
                                             
                                             
                                                i
                                             
                                          
                                          ]
                                       
                                       }
                                    
                                 
                                 
                                    i
                                    =
                                    1
                                    ,
                                    .
                                    .
                                    ,
                                    
                                       
                                          n
                                       
                                       
                                          
                                             adap
                                          
                                       
                                    
                                 
                              
                            with 
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              =
                              0
                            and 
                              
                                 
                                    t
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          
                                             adap
                                          
                                       
                                    
                                 
                              
                              =
                              T
                           . On each sub-interval a different mesh is used. A time-forward computation of the state solution is first performed with an out-of-core storage of all checkpoints, which are taken to be 
                              
                                 
                                    
                                       {
                                       
                                          
                                             W
                                          
                                          
                                             h
                                          
                                       
                                       
                                          (
                                          
                                             
                                                t
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                       }
                                    
                                 
                                 
                                    i
                                    =
                                    1
                                    ,
                                    .
                                    .
                                    ,
                                    
                                       
                                          n
                                       
                                       
                                          
                                             adap
                                          
                                       
                                    
                                 
                              
                           . Between each sub-interval, the solution is interpolated on the new mesh using the conservative interpolation. Then, starting from the last sub-interval and proceeding until the first one, we recompute and store in memory all solution states of the sub-interval from the previously stored checkpoint in order to evaluate time-backward the adjoint state throughout the sub-interval. At the same time, we evaluate the Hessian-metrics 
                              
                                 
                                    
                                       H
                                    
                                 
                                 
                                    
                                       go
                                    
                                 
                                 
                                    i
                                 
                              
                            required to generate new adapted meshes for each sub-interval. To this end, 
                              
                                 
                                    n
                                 
                                 
                                    k
                                 
                              
                            Hessian-metric sample are computed on each sub-interval. At the end of the computation, the global space–time mesh complexity is evaluated, producing weights for the goal-oriented metric fields for each sub-interval. Finally, all new adapted meshes are generated according to the prescribed metrics. The time-forward, time-backward, and mesh update steps are repeated into the 
                              j
                              =
                              1
                              ,
                              .
                              .
                              ,
                              
                                 
                                    n
                                 
                                 
                                    p
                                    t
                                    f
                                    x
                                 
                              
                            global fixed-point loop. Convergence of the fixed-point is obtained in typically five global iterations.


                           
                              
                                 
                              
                           
                        

We consider again the city blast wave propagation problem. Cost function 
                              j
                            is the quadratic deviation from ambient pressure on target surface 
                              Γ
                            which is composed of two buildings, see Fig. 19
                           : 
                              
                                 
                                    j
                                    
                                       (
                                       W
                                       )
                                    
                                    =
                                    
                                       
                                          ∫
                                       
                                       
                                          0
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          ∫
                                       
                                       
                                          Γ
                                       
                                    
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             (
                                             p
                                             
                                                (
                                                
                                                   x
                                                
                                                ,
                                                t
                                                )
                                             
                                             −
                                             
                                                
                                                   p
                                                
                                                
                                                   
                                                      air
                                                   
                                                
                                             
                                             )
                                          
                                       
                                       
                                          2
                                       
                                    
                                    
                                       d
                                    
                                    Γ
                                    
                                       d
                                    
                                    t
                                    .
                                 
                              
                            The simulation time frame is split into 40 time sub-intervals, i.e., 40 different adapted meshes are used to perform the simulation. 6 fixed-point iterations are performed to converge the mesh adaptation problem. For each sub-interval, 16 samples of the solution and adjoint states are considered to build the goal-oriented metric. We consider a space–time complexity equal to 1.2 million.

The resulting adjoint-based anisotropic adapted meshes (surface and volume) at sub-interval 10, 15, and 20 are shown in Fig. 20
                           . It is very interesting to see that we are not restricted to just one target surface. Despite the complexity and the unpredictable behavior of the physical phenomena with a large number of shock waves interactions with the geometry, the goal-oriented fixed-point mesh adaptation algorithm was automatically able to capture all shock waves which impact the targeted buildings and to set appropriate weights for the refinement of these physical phenomena. Other waves are neglected thus leading to a drastic reduction of the mesh size.

To illustrate this point, we provide meshes size for sub-intervals 1, 5, 10, and 20 in Table 2
                           , respectively. If, for sub-interval 1, one million vertices are needed, only 40,000 vertices are used for sub-interval 20. The required mesh size has been reduced by a factor of 25 between the 1st and the 20th sub-interval. On average, almost 200,000 vertices are required to perform both adaptive computations with a maximal accuracy between 1 and 5 cm. These numbers have to be compared with uniform meshes characteristics given in Table 3
                            where dozens of millions of vertices are required to reach an accuracy of 30 cm.

A large number of open problems still remain on advanced meshing methods for scientific computing. New contributions are mandatory for mesh adaptation to handle most of the industrial applications. We briefly describe three major issues: mesh adaptation for the Navier–Stokes equations and turbulence models, mesh adaptation for 3D problems involving moving geometries, and mesh adaptation for very-high-order numerical schemes and curved meshes.

The main conclusions of the Drag Prediction Workshop  [13] and High-Lift Prediction Workshop  [119] emphasized that the accuracy and convergence of high-Reynolds compressible Navier–Stokes flows rely on mesh quality. According to the results presented in this review, anisotropic mesh adaptation seems to be a good candidate to control the solution accuracy and assess the solution convergence in order to certify such numerical simulations. To this end, additional progress is needed in terms of error estimates dedicated to the Navier–Stokes equations along with specific adaptive mesh generation techniques for boundary layers.

As regards the error estimates, preliminary results regarding mesh adaptation for the laminar Navier–Stokes equations have been obtained in  [120]. Other error analyses for Navier–Stokes have been introduced. In  [121] an adjoint-free approach is introduced based on specific entropy variables. In  [122], an extension of error estimates for elliptic problems was derived for Navier–Stokes equations. In  [72,123,41], an approach coupling isotropic adjoint-based estimates and interpolation error is proposed. In  [73], a surrogate model is used to derive anisotropic estimates. Nevertheless, turbulence models are not yet fully represented in the analysis. Future works will be directed at deriving new error estimates taking into account the considered turbulence model (RANS Spalart-Almaras, RANS 
                           k
                           −
                           ε
                        , LES, LES-VMS, …).

In regards to mesh adaptation techniques, a lot of work is still required to reach the same maturity as the one obtained for inviscid flows on industrial configurations. In particular, handling high Reynolds number (several millions) compressible flow simulations require suitable adaptation of the boundary layer mesh which remains a crucial open problem as it influences all the downstream flow. Indeed, most of the previous approaches keep a frozen boundary layer mesh while adapting only the far field  [122,123]. Other approaches rely on a completely unstructured boundary layer  [54,73,94,76]. However, in this case, additional constraints are reported on the flow solver to reduce the numerical dissipation in the boundary layer region. A few works have been conducted to adapt the boundary layer mesh. For instance, in  [124], specific hybrid operators have been derived to refine the boundary layer mesh. This aspect is of crucial interest for transonic flows, where shocks may interact with the boundary layer.

Despite the great results obtained so far, adaptive meshing methods can be improved further. To efficiently solve the compressible Navier–Stokes equations, several studies point out that it is mandatory to consider structured mesh regions, in particular in the boundary layer. Recent approaches have been devoted to generate metric-aligned and metric-orthogonal meshes. It consists in taking into account the natural alignment and orthogonality of the provided input metric field during the mesh generation process. Using this supplementary information enables unstructured adaptive local remesher to automatically produce anisotropic adapted quasi-structured meshes of high-quality  [97,98,125], see Fig. 21
                        . It is a first step in the automatic adaptation of structured boundary layer meshes.

More complex industrial unsteady problems involve moving geometries. These simulations are time consuming, so using mesh adaptation is a way to enhance the accuracy  [59]. Immersed boundary method coupled with mesh adaptation has been proposed  [126,31,127]. But, it is hard to extend these approaches to high Reynolds number flows because of the boundary layer. Important progress has been achieved for the robustness of body-fitted moving mesh methods by using local remeshing in order to ease the displacement of the geometry  [128,129,58,130]. A changing-connectivity moving mesh method has been proposed to get rid of any remeshing during the process  [116,131].

Extending mesh adaptation to this context requires to take into account the dynamic of the mesh inside the error estimate, the adapted mesh generation process, and to take into account the metric in the mesh motion. First works have been done in this direction as  [116] in 2D and  [132] in 3D where a specific moving mesh metric is designed, see Fig. 22
                        . Unfortunately, a lot of work remains to be done.

Numerous works focus on the design of very-high-order numerical schemes. However, all of the reviewed error estimates only consider second-order schemes. Thus, it is mandatory to extend all of our developments to higher-order estimates. The key point is to be able to efficiently reduce the multi-linear form that occurs in such a formulation into a bilinear one in order to apply the continuous mesh framework. With straight elements, a metric-based control of the interpolation error is studied in  [133,134] in 2D. In 3D, only a few works exist. For instance, Yano and Darmofal  [73] introduce a Riemannian-based optimization to deduce an error estimate for Discontinuous Galerkin numerical schemes of any order on unstructured meshes. For non-confirming block-structured adapted meshes, 3D error estimates exist, see  [121,135].

The second major problematic concerns the generation of high-order curved meshes. Indeed, very-high-order numerical schemes require high-order curved meshes to represent domain boundaries in order to preserve their very-high order of accuracy. Without adaptivity, the generation of high-order curved mesh is already challenging. Recently, several works have focused on the validity and the generation of 3D meshes to comply to complex curved boundaries  [136–141].

@&#CONCLUSION@&#

In order to reach an optimal level of anisotropy and thus to enjoy the full benefit of unstructured anisotropic mesh adaptation (as the optimal distribution of the degrees of freedom, the improvement of the ratio accuracy with respect to the CPU time), it is necessary to control the complex interaction between the main components involved in the adaptive loop: the flow solver, the error estimate, the solution interpolation, and the mesh generator. In this paper, we show on various steady and unsteady numerical examples how the improvement of one component implies an improvement on the whole adaptive loop. From a practical point of view, the quality of the final numerical solution is also increased. Equivalently, a weakness or a wrong choice in one component may ruin the complete gain of adaptivity. This leads to the loss of mesh convergence, the loss of anisotropy, or the inability to capture all of the scales of the phenomena. Most of the improvements reviewed in this paper concern the error estimate and the adaptive mesh generator.

To derive new error estimates, we have proposed a continuous framework to model a mesh and its elements. This continuous mesh framework enforces the duality between Riemannian metric spaces and discrete meshes. This also demonstrates that metric-based mesh adaptation is well-founded.

This continuous framework is applied to feature-based anisotropic mesh adaptation. In this case, optimal meshes minimizing the interpolation error in 
                        
                           
                              L
                           
                           
                              p
                           
                        
                      norm have been derived to control a specific field of the flow called sensor. We demonstrate that the choice of the 
                        
                           
                              L
                           
                           
                              p
                           
                        
                      norm is primordial as it defines the sensitivity of the error estimate to the solution scales. In regards to the mesh convergence order, the theoretical second order mesh convergence is reached regardless of the chosen norm with smooth functions. However, when dealing with sharp gradients, this convergence is asymptotic and requires a number of nodes directly correlated to the amplitude of the gradient. To simulate unsteady phenomena, we have designed a new mesh adaptation algorithm which prescribes the spatial mesh of an unsteady simulation as the optimum of an error analysis. Accounting for unsteadiness is applied in a time-implicit mesh-solution coupling which needs a non-linear iteration, the fixed point. Several important issues for the mesh adaptive space–time computation have been addressed. Among them, the strategies for choosing the splitting in time sub-intervals and the accurate integration of time errors in the mesh adaptation process have been proposed, together with a more general formulation of the mesh optimization problem in the continuous mesh framework.

This continuous framework is also used for goal-oriented anisotropic mesh adaptation to control the approximation error on a scalar-output functional. It has been derived for steady and unsteady cases. This analysis depends on the underlying numerical schemes and on the minimization of an a priori error estimate that is then recast in the continuous mesh framework.

Future work aims at improving the optimality of adapted meshes for time-dependent problems. Indeed, in the presented approaches, spatial and temporal domains are treated in a decoupled manner leading to a separate adaptation of the spatial and temporal meshes. Eventually, to envision a more optimal adaptation of the space–time mesh, without resorting to very frequent remeshing, the proposed idea is to consider dynamic meshes. An adequate prescribed motion of the mesh for each sub-interval may provide a more optimal answer.

For the adaptive mesh generation process, we have proposed a robust and generic cavity-based operator. Both volume and surface meshes are adapted in a coupled way in order to guarantee that a valid mesh is always provided on output. This operator handles the generation of various kind of meshes: anisotropic, quasi-structured, and hybrid. First examples of extending the standard unit-mesh approach to metric-aligned or metric-orthogonal mesh generation have been illustrated. In addition to being unit with respect to a metric, metric-orthogonal or metric-aligned meshes are composed of elements that are aligned with the eigenvectors of the metric field. This allows the recovery of locally structured meshes while keeping the same level of anisotropy. Dihedral angles are also optimized. This approach is a first step in considering fully adaptive boundary layer mesh generation.

@&#REFERENCES@&#

