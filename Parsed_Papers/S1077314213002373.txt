@&#MAIN-TITLE@&#Visual estimation of pointed targets for robot guidance via fusion of face pose and hand orientation

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Problem formulation: given a number of possible pointed targets, compute the target that the user points to.


                        
                        
                           
                           Estimate head pose by visually tracking the off-plane rotations of the face.


                        
                        
                           
                           Recognize two different hand pointing gestures (point left and point right).


                        
                        
                           
                           Model the problem using the Dempster–Shafer theory of evidence.


                        
                        
                           
                           Use Demspster’s rule of combination to fuse information and derive the pointed target.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Human–robot interaction

Computer vision

Gesture recognition

Pointing gestures

Head pose estimation

@&#ABSTRACT@&#


               
               
                  In this paper we address an important issue in human–robot interaction, that of accurately deriving pointing information from a corresponding gesture. Based on the fact that in most applications it is the pointed object rather than the actual pointing direction which is important, we formulate a novel approach which takes into account prior information about the location of possible pointed targets. To decide about the pointed object, the proposed approach uses the Dempster–Shafer theory of evidence to fuse information from two different input streams: head pose, estimated by visually tracking the off-plane rotations of the face, and hand pointing orientation. Detailed experimental results are presented that validate the effectiveness of the method in realistic application setups.
               
            

@&#INTRODUCTION@&#

In the emergent field of social robotics, human–robot interaction via gestures is an important research topic. Among the communicative gestures performed by humans, pointing gestures are especially interesting for interaction with robots. They open up the possibility of intuitively indicating objects and locations and are particularly useful as commands to the robot. Pointing gestures can also be used in combination with speech recognition to specify parameters of location in verbal statements and also provide a clear input when speech recognition ambiguities occur. An example scenario of this type is the use of pointing gestures to direct the robot to a specific object or location. The robot must be able to detect the pointing gesture and estimate the pointed target location, thus major issues arise that have concerned recent vision research in this field [1–4,8]. Some of the most important challenges are related to the requirement for real time computations, the obtained accuracy and the operation in difficult cluttered environments with possible occlusions, variable illumination and varying background. Another common requirement is that pointing gestures must be recognized regardless of scale, referring to large pointing gestures performed with full arm extend and small pointing gestures reduced to forearm and hand movement only [3,4].

Based on the fact that, for most applications, it is the pointed target rather than the actual pointing direction which is important, we formulate a novel approach which, in contrast to existing pointing gesture recognition approaches, also takes into account prior information about the location of possible pointed targets. Assuming the most common type of deictic gesture, i.e., the one that involves the index finger pointing at the object of interest and the user’s gaze directed at the same target [5,6], we formulate our approach using a monocular setup to track off-plane head rotations with high accuracy and at the same time recognize hand pointing gestures. These two input streams are combined together to derive the pointed target using a formulation which is based on the Dempster–Shafer theory of evidence [7]. Employment of a single camera differentiates substantially our approach from the majority of existing methods that use stereo or multi-camera setups. However, the main contribution of the paper relies in the combination of the input streams based on the Dempster–Shafer theory of evidence, allowing the approach to elegantly handle situations where one or both of the input streams are missing (e.g. the hand pointing direction is not visible due to self-occlusions); namely, use the lack of input as evidence, achieving impressive results which could not have been derived with contemporary probabilistic fusion approaches [1,8]. Moreover, with the proposed formulation beliefs are assigned to set of pointed targets rather than individual pointed targets. Demster’s rule of combination facilitates the combination of these beliefs without the need to “split” them to individual pointed targets, if the observations do not explicitly suggest so.

In the following sections the related work (Section 2) and proposed methodology (Section 3) are discussed. The algorithm for hand pointing gesture recognition is briefly discussed in Section 4 and the face pose estimation is explained in Section 5. The fusion of face pose and hand pointing, being a main focus of the paper, is analyzed in Section 6. Experimental results in a simulated environment as well as results using ground truth data are provided in Section 7. The paper concludes with a discussion in Section 8.

@&#RELATED WORK@&#

Gesture recognition is receiving increasing attention in recent research, also in areas beyond human–robot interaction, for example as in affective computing and immersive game technology. First attempts to solve the interpretation of gestures resulted in mechanical devices that directly measure hand and/or arm joint angles and spatial position, the so-called glove-based devices 
                     [9,10]. With the recent advances in computer vision techniques and the availability of faster processors, the interest in vision-based non-contact interfaces increased, overcoming the drawbacks of wearable devices that hinder the ease in interaction. Recent vision-based techniques for gesture recognition have been comprehensively reviewed [11] and most efforts have focused on hand gesture recognition [12,6] as well as sign language interpretation [13,14].

With respect to vision-based pointing gesture research, there are several approaches using stereo or multi-camera systems and which focus only on the hands/arms or both hands/arms and head. Most of them estimate pointing in the horizontal direction, while some other both in the horizontal and vertical direction. Among those that utilized hands and/or arms, Cipolla et al. [15] used stereo vision with active contours to track the position and pointing direction on the robot’s two dimensional workspace. Hosoya et al. [16] derived the 3D position of shoulders and arms by depth and stereo color images to estimate the 3D pointing direction. More recently, Hu et al. [17] used an adapted Adaboost cascade detector [18] for hand gesture detection and an Active Appearance Model to estimate the pointing direction from stereo views, but with a cost in detection time.

Other authors have used information regarding the 3D position of face and pointing hand, to derive the line of sight and to estimate the pointing direction. Jojic et al. [19] recognized the pointing gesture based on dense disparity maps and a statistical model to distinguish the body from the arm and estimated the pointing direction from the extremal points of head and hand. In their work Stiefelhangen and Nickel [1,2,20] used neural networks for head pose estimation and an HMM-based approach to recognize the pointing gesture. However, their method suffers from delayed recognition as it searches three feature sequences to detect the pointing gesture. Kelh and van Gool [21], as well as Watanabe et al. [22] use multi camera systems to detect face and hands. The first paper extracts the body silhouettes and the extremal points for head and hands, solves the 3D correspondences and derives the pointing direction. The quality of the segmentation has a strong influence on the accuracy of the method, which in [21] is not quantitatively assessed. The latter estimate the face direction in eight available cameras with discrete face direction feature classes and use it together with the 3D hand position for pointing estimation. More recently, Park and Lee [4], based on a stereo camera, used similarly to [2] an HMM-based approach in two stages to recognize the pointing gesture, but with a different definition of the phases in the pointing gesture. This paper was the first to consider the scale of gesture, however, the accuracy of the method mainly depends on the number of HMM states in the first stage, thus requiring more training data and processing time. Some of these approaches suffer from delayed recognition, e.g. [2,17], limited accuracy assessment, e.g. [21,17] and most (with an exception here [4]) do not support the scale of gesture.

Unlike the above approaches we use a single camera that can be placed on a moving robotic platform. Single camera systems were examined by Kolesnik and Kulessa [23] for controlling the motion of virtual objects using an overhead view camera and by Černeková et al. [24] for video-based interaction. The employment of the overhead camera in [23] gives rise to an experimental setup that significantly deviates from the one employed in the current work and, therefore, no further attention is given to [23]. The later work focuses on recognizing the cell of a grid on a screen that is pointed by a user, by detecting the pointed hand via a gradient vector flow (GVF) snake. The user initializes the boundary of the screen area, mapped on the 2D image, by pointing the upper right and lower left corners of the screen. Subsequently, pointing sub-areas are computed via a linear transformation. Although good initial results were reported for this method, the field of view for the specific application was very narrow, limiting the generalizability of the method in other contexts. Richarz et al. [25] presented a neural architecture that is capable of estimating a referred target point on the floor from a pointing pose, thus enabling a user to command a mobile robot by means of pointing. Results indicated that the neural estimator was quite sensitive to deviations from the pose it was trained for. In the case of two test subjects, acceptable results have been reported only when manual head detection has been applied, whereas replacement of the manual detection by the Viola–Jones algorithm [18] resulted in a notable degradation of the overall performance [25].


                     Table 1
                      summarizes the above reviewed approaches. As already mentioned, most of these approaches use two or more cameras and are able to derive good results in terms of pointing accuracy. Only multicamera systems, as in [21], can support detection of pointing gestures in 
                        
                           360
                           °
                        
                     . Scale of gesture, referring to large pointing gestures performed with full arm extend and small pointing gestures reduced to forearm and hand movement only, is only supported by Park and Lee [4], but only in the range of 
                        
                           [
                           -
                           90
                           °
                           ,
                           90
                           °
                           ]
                        
                     .

The method presented in this paper employs a monocular camera setup and supports scale of gesture, as well as obtuse angle of pointing gesture beyond the range of 
                        
                           [
                           -
                           90
                           °
                           ,
                           90
                           °
                           ]
                        
                      in horizontal direction. At the same time, increased pointing accuracy is achieved and the method implementation operates in real-time, taking care of occlusions, variable illumination and dynamic background.

The main novelty of this work regards the effective fusion of face orientation with recognized hand pointing gesture, to accurately estimate a pointed target. The Dempster–Shafer theory [7] is utilized to formulate fusion as a belief estimation problem in the space of possible pointing directions. Even in cases that the system is not able to recognize hand pointing gestures or face orientation (or neither), this (lack of) information provides a piece of evidence which in most cases is adequate to significantly limit the number of possible solutions. It is this very feature that renders Dempster–Shafer theory of combination most appropriate for the task at hand, since such errors from face trackers and/or gesture recognizers are not uncommon in real-world interactions.

The target scenario we address is a robot operating in a public space, such as an exhibition or a museum, interacting with humans and providing information about specific Points Of Interest (“POIs”, e.g. exhibits). The set of POIs specifies the targets that the user can point at, in other words the “pointed targets”. As already mentioned in previous sections, it is exactly the pointed targets that are estimated in our work and not arbitrary pointing directions that may result from unrestricted deictic gestures in the user’s environment.

The robot has a 2D map of the environment and, additionally, knows the location of all POIs within the map. A localization module provides the robot’s pose (2D location and orientation) with respect to the map and, hence, the robot can always compute the relative location of all POIs with respect to its own coordinate frame. The user who interacts with the robot is standing in front of the robot, and his/her location w.r.t. the robot and the map is determined using the robot’s laser range finder.

All human–robot interaction is handled by the robot’s Dialog and Action Manager (DAM) which is responsible to prompt the user for input, to analyze the users’ response (speech and gestures) and to produce the robot’s response. Most parts of the dialogue are robot-initiated so the DAM knows when to expect a gesture from the user and what gestures are expected each time.

Especially for pointing gestures, the robot only expects this kind of gestures after a relevant question (e.g. the robot asks the user, which exhibit (i.e. POI) he/she would like to visit next). Hence it is reasonable to assume that we know when to expect a pointing gesture and our algorithm only needs to find (a) when exactly this pointing gesture takes place and (b) what is the POI that the user points to.

A significant assumption here is that all pointing gestures refer to POIs. Hence, the task at hand regards the accurate estimation of the POI that the user points to. Another assumption that we can easily make is that when the user points to a POI, this POI must be “visible” by both the user and the robot. Here, the term “visible” means that line of sight between the user (or the robot) and the POI is not occluded by some obstacle. In other words the robot expects that the user will never point to a POI which is behind a wall. However, the user can still point to a POI which is behind the robot or behind the user as long as there is no obstacle between the POI and the user or the robot.

An overview of the proposed approach is depicted in Fig. 1
                     . The first step is to track the blobs of the user’s face and hands. These are tracked on the image plane using a skin-color blob tracker [29]. An incremental Bayes classifier [30] is used to classify the tracks of the detected skin-colored blobs into left hands, right hands and faces. Then two independent modules are used for hands and faces. Hand blobs are fed to the hand gesture recognition module which is used to identify hand pointing gestures [31] while, facial blobs are fed to a Least-Squares Matching (LSM) module [37] which is used to derive differential rotations via patch deformations across image frames.

The output of the hand gesture recognition module can take three values: ‘point left’, ‘point right’ and ‘invisible’, if no pointing gesture could be recognized. The output of the face orientation estimation module is either a scalar variable, if face orientation can be computed, or “NaN” if face orientation cannot be computed.

Finally, our approach estimates the pointed gesture (computes the pointed POI) by integrating information of face orientation with information from hand gesture recognition using Dempster’s rule of combination.

To be able to recognize pointing gestures one needs information about the location and posture of a person interacting with the robot. Therefore, we track the position of the person’s face and hands, as these are important features in the recognition of pointing gestures.

The first step of our approach is to detect skin-colored regions in the input images. For this purpose we use a technique similar to the one described in [26,27]. Initially, the foreground area of the image is extracted by the use of a background subtraction algorithm [28]. Then, foreground pixels are characterized according to their probability to depict human skin and then grouped together into solid skin color blobs using hysteresis thresholding and connected components labeling. The location and the speed of each blob is modeled as a discrete time, linear dynamical system which is tracked using the Kalman filter equations and the propagated pixel hypotheses algorithm [29]. According to this algorithm information about the spatial distribution of the pixels of each tracked object (i.e. its shape) is propagated from frame to frame using the object’s current dynamics, as estimated by the Kalman filter. The density of the propagated pixel hypotheses provides the metric, which is used in order to associate observed skin-colored pixels with existing object tracks in a way that is aware of each object’s shape and the uncertainty associated with its track.

It is to be noted at this point that the tracking results greatly depend on the quality of the background model as well as the lighting conditions which are expected to change as the robot moves. For this purpose, the robot is set to auto adjust the camera’s white balance and shutter speed parameters in order to reset the background model each time it arrives to a new location.

The second step is to further classify blobs as left hand, right hand and face, as well as maintain and continuously update the belief about the class of each tracked blob. For this purpose we employ an incremental probabilistic classifier, as in [30], using as input the speed, orientation, location and contour shape of the tracked skin-colored blobs. This classifier permits identification of hands and faces of multiple people and is able to maintain hypotheses of left and right hands, even in cases of partial occlusions.

For the actual hand pointing recognition, an important aspect is the detection of the effective time a pointing gesture occurs. According to [6], the temporal structure of hand gestures can be divided in three phases: preparation, stroke and retraction, with an exception to this rule the so called “beats” (gestures related to the rhythmic structure of the speech). “Preparation” and “retraction” are characterized by the rapid change in position of the hand, while in the “stroke”, the hand remains, in general, motionless. Taking into account the trajectory of the moving hand and a number of relevant criteria, described in [31], we detect the “stroke” phase, i.e. the phase at which the pointing gesture takes place. In order to recognize hand pointing gestures among the set of gestures that comprise the gesture vocabulary of the robot, and, additionally, to classify them as “point left” and “point right” gestures, we employ a rule-based technique [32,31]. According to this technique, gesture recognition is performed based on the number and the posture of the distinguishable fingers of the hand performing the gesture, i.e., the number of visible fingertips and their relative location with respect to the centroid of the hand’s blob. Therefore, it is possible to recognize the hand pointing gesture for small and large angles from the frontal position, where the fingertips can be distinguished in the hand blob, except the case the person is pointing directly to the camera for angles close to 0°, as it is shown in Fig. 2
                     .

To estimate the POI that the user is looking at while performing a pointing gesture in a non-intrusive way, we employ a technique that tracks the orientation of the user’s head. This is achieved by tracking off-plane facial rotations in horizontal direction around the head’s y-axis (Section 5.2) via a feature-based face tracking approach based on Least-Squares Matching (LSM).

Area- or template-based approaches have been explored in a variety of contexts including stereo matching [33], visual motion analysis [34], surface reconstruction [35] and object tracking [36]. LSM [37] is a matching technique able to model effectively radiometric and geometric differences between image patches, also considered as a generalization of cross-correlation, since, in its general form, it can compensate geometric differences in rotation, scale and shearing, whereas cross-correlation can model geometric differences only by translation and radiometric differences only due to variations in brightness and contrast. Thus, its precision is limited, decreases rapidly if the geometric model is violated (rotations greater than 
                           
                              20
                              °
                           
                         and scale differences between images greater than 30%), whereas LSM, in its general form, can compensate geometric differences in rotation, scale and shearing. In our context LSM is used for inter-frame calculations, over a long time span in tracking, to derive the rotation of the user’s face while performing the pointing gesture.

The formulation of the general estimation model is based on the assumption that there are two (or more) image windows (called image patches). These image patches are given as discrete functions 
                           
                              f
                              (
                              x
                              ,
                              y
                              )
                              ,
                              g
                              (
                              x
                              ,
                              y
                              )
                           
                        , wherein f is the template and g the search image patch in the template and search image respectively. The problem statement is finding the corresponding part of the template image patch 
                           
                              f
                              (
                              x
                              ,
                              y
                              )
                           
                         in the search image 
                           
                              g
                              (
                              x
                              ,
                              y
                              )
                           
                        . Matching is ideally established if:
                           
                              (1)
                              
                                 f
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 =
                                 g
                                 (
                                 x
                                 ,
                                 y
                                 )
                              
                           
                        and the true error vector 
                           
                              e
                              (
                              x
                              ,
                              y
                              )
                           
                         in (2) is included to model errors that arise from radiometric and geometric differences in the images.
                           
                              (2)
                              
                                 f
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 -
                                 e
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 =
                                 g
                                 (
                                 x
                                 ,
                                 y
                                 )
                              
                           
                        
                     

The location of the function values 
                           
                              g
                              (
                              x
                              ,
                              y
                              )
                           
                         must be determined in order to provide for the match. This is achieved by minimizing a goal function which measures the distances between the gray levels in template and the patch. The goal function to be minimized is the 
                           
                              
                                 
                                    L
                                 
                                 
                                    2
                                 
                              
                              -
                              norm
                           
                         of the residuals of least squares estimation. In the least squares context, Eq. (2) can be considered as a nonlinear observation equation which models the vector of observations 
                           
                              f
                              (
                              x
                              ,
                              y
                              )
                           
                         with a function 
                           
                              g
                              (
                              x
                              ,
                              y
                              )
                           
                        , whose location in the search image needs to be estimated. Assuming we have two consecutive frames, to account for image deformations and to obtain a better match, image shaping parameters are introduced beside shift parameters. Therefore, a set of transformation parameters need to be estimated from (2) and as nonlinear, (2) is linearized by expanding it into a Taylor series and keeping only zero and first order terms according to (3):
                           
                              (3)
                              
                                 
                                    
                                       
                                       
                                          
                                             f
                                             (
                                             x
                                             ,
                                             y
                                             )
                                             -
                                             e
                                             (
                                             x
                                             ,
                                             y
                                             )
                                             =
                                             g
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   0
                                                
                                             
                                             ,
                                             
                                                
                                                   y
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                             +
                                             
                                                
                                                   ∂
                                                   g
                                                   (
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   )
                                                
                                                
                                                   ∂
                                                   x
                                                
                                             
                                             ·
                                             dx
                                             +
                                             
                                                
                                                   ∂
                                                   g
                                                   (
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   )
                                                
                                                
                                                   ∂
                                                   y
                                                
                                             
                                             ·
                                             dy
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             dx
                                             =
                                             
                                                
                                                   ∂
                                                   dx
                                                
                                                
                                                   ∂
                                                   
                                                      
                                                         dp
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                             ·
                                             
                                                
                                                   dp
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             
                                             
                                             
                                             
                                                
                                                   dp
                                                
                                                
                                                   i
                                                
                                             
                                             …
                                             i
                                             th
                                             
                                             trasformation
                                             
                                             parameter
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             dy
                                             =
                                             
                                                
                                                   ∂
                                                   dy
                                                
                                                
                                                   ∂
                                                   
                                                      
                                                         dp
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                             ·
                                             
                                                
                                                   dp
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The number of parameters is derived from the following considerations. The estimation model should accommodate enough parameters in order to be able to model completely the underlying image formation process. Parameters that are non-determinable and high correlations among parameters have an impairing effect on the estimation model and deteriorate the quality of the match. Similar efforts in modeling a region include Hager and Belhumeur’s work [38] that explicitly modeled the geometry and illumination changes with low parametric models. In the model only geometric parameters are included and radiometric corrections, e.g. equalization, for the compensation of different lighting conditions are applied prior to LSM in template and image. Assuming that the local surface patch of the face area is a plane to sufficient approximation, as depth variation exhibited by facial features are small enough, an affine transformation is used to model geometric differences between template or image frame n and search image or image frame 
                           
                              n
                              +
                              1
                           
                        . Instead of a conformal set of parameters [39], we utilize an affine transformation to track the face patch during off-plane head rotations. The affine compared to the conformal set of parameters is more suitable in the case of off-plane head rotations, as they can better approximate the patch deformation, in two consecutive image frames, whereas in the case of in-plane rotations a conformal set may suffice. The affine transformation (4) is applied with respect to an initial position 
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    0
                                 
                              
                              )
                           
                        :
                           
                              (4)
                              
                                 
                                    
                                       
                                       
                                          
                                             x
                                             =
                                             
                                                
                                                   a
                                                
                                                
                                                   0
                                                
                                             
                                             +
                                             
                                                
                                                   a
                                                
                                                
                                                   1
                                                
                                             
                                             ·
                                             
                                                
                                                   x
                                                
                                                
                                                   0
                                                
                                             
                                             +
                                             
                                                
                                                   a
                                                
                                                
                                                   2
                                                
                                             
                                             ·
                                             
                                                
                                                   y
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             y
                                             =
                                             
                                                
                                                   b
                                                
                                                
                                                   0
                                                
                                             
                                             +
                                             
                                                
                                                   b
                                                
                                                
                                                   1
                                                
                                             
                                             ·
                                             
                                                
                                                   x
                                                
                                                
                                                   0
                                                
                                             
                                             +
                                             
                                                
                                                   b
                                                
                                                
                                                   2
                                                
                                             
                                             ·
                                             
                                                
                                                   y
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        and by differentiating (4) and using the simplified notation of (5)
                        
                           
                              (5)
                              
                                 
                                    
                                       g
                                    
                                    
                                       x
                                    
                                 
                                 =
                                 
                                    
                                       ∂
                                       g
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             0
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             0
                                          
                                       
                                       )
                                    
                                    
                                       ∂
                                       x
                                    
                                 
                                 ,
                                 
                                    
                                       g
                                    
                                    
                                       y
                                    
                                 
                                 =
                                 
                                    
                                       ∂
                                       g
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             0
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             0
                                          
                                       
                                       )
                                    
                                    
                                       ∂
                                       y
                                    
                                 
                              
                           
                        then (3) results in (6):
                           
                              (6)
                              
                                 f
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 -
                                 e
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 =
                                 g
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       g
                                    
                                    
                                       x
                                    
                                 
                                 
                                    
                                       da
                                    
                                    
                                       0
                                    
                                 
                                 +
                                 
                                    
                                       g
                                    
                                    
                                       x
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       da
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       g
                                    
                                    
                                       x
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       da
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       g
                                    
                                    
                                       y
                                    
                                 
                                 
                                    
                                       db
                                    
                                    
                                       0
                                    
                                 
                                 +
                                 
                                    
                                       g
                                    
                                    
                                       y
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       db
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       g
                                    
                                    
                                       y
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       0
                                    
                                 
                                 
                                    
                                       db
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        Combining the parameters in (6) in the parameter vector 
                           
                              x
                           
                        
                        
                           
                              (7)
                              
                                 
                                    
                                       x
                                    
                                    
                                       T
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       da
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       da
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       da
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       db
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       db
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       db
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                           
                        their coefficients in the design matrix 
                           
                              A
                           
                        , and the discrepancy vector of the observations 
                           
                              f
                              (
                              x
                              ,
                              y
                              )
                              -
                              g
                              (
                              
                                 
                                    x
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    0
                                 
                              
                              )
                           
                         in 
                           
                              l
                           
                        , the observation equations are obtained in classical notations (
                           
                              e
                              =
                              e
                              (
                              x
                              ,
                              y
                              )
                           
                        ):
                           
                              (8)
                              
                                 l
                                 -
                                 e
                                 =
                                 Ax
                              
                           
                        
                     

The least squares solution of the system is given by (9):
                           
                              (9)
                              
                                 
                                    
                                       x
                                    
                                    
                                       ˆ
                                    
                                 
                                 =
                                 
                                    
                                       (
                                       
                                          
                                             A
                                          
                                          
                                             T
                                          
                                       
                                       PA
                                       )
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       A
                                    
                                    
                                       T
                                    
                                 
                                 Pl
                                 )
                              
                           
                        where 
                           
                              P
                           
                         is the weight matrix. The number of gray level observations relates to the number of pixels in the template. Assuming a template size 
                           
                              m
                              ·
                              n
                           
                         pixels, the number of observation equations is 
                           
                              
                                 
                                    n
                                 
                                 
                                    g
                                 
                              
                              =
                              m
                              ·
                              n
                           
                        , the number of unknowns 
                           
                              
                                 
                                    n
                                 
                                 
                                    u
                                 
                              
                              =
                              6
                           
                        , the design matrix 
                           
                              A
                           
                         is of size 
                           
                              
                                 
                                    n
                                 
                                 
                                    g
                                 
                              
                              ·
                              
                                 
                                    n
                                 
                                 
                                    u
                                 
                              
                              ,
                              P
                           
                         is a diagonal matrix with 
                           
                              
                                 
                                    n
                                 
                                 
                                    g
                                 
                              
                           
                         non-zero elements and 
                           
                              l
                           
                         is a vector of 
                           
                              
                                 
                                    n
                                 
                                 
                                    g
                                 
                              
                           
                         elements. A weighting scheme is adopted, to reduce contribution for gray level observation equations that correspond to pixels close to the border by receiving much smaller weights (i.e. 0.1) than others (i.e unity).

The method requires that the change from frame to frame is small, considering the speed of the object and the frame rate of the acquired image sequence, for the solution to converge. The camera in our system operates at 30–40fps, thus enabling us to handle fast head motions. To improve performance of LSM at high frame rates, we operate the algorithm for head orientation estimation in a lower resolution level (i.e. half image size). Since the template decreases in size, the number of observation equations decreases leading to faster implementation.

Considering the human head as a rigid body in a three-dimensional space, head orientation can be derived by analyzing the transformations of the facial patch (frontal part of the head) since face rotations are equivalent to head rotations. More specifically, rotations of the head can be computed as in-plane rotations around the head’s z-axis, off-plane rotation in vertical direction around the head’s x-axis and off-plane rotation in horizontal direction around the head’s y-axis (see Fig. 3
                        ). The latter, which corresponds to an off-plane rotation of the face towards the pointing direction, mainly deforms the facial patch in x-shift and x-scale.

To derive the above-mentioned face rotations we employ LSM by initializing the template patch, at the center of the detected blob ellipse at the occurrence of the preparation phase of gesture at image frame n and assuming frontal view of the face. In practice the initial position of the frontal view of the face can be derived also via available face detectors as [18]. The template is updated in image frame 
                           
                              n
                              +
                              1
                           
                         based on the estimated affine parameters and matched to the next image frame. With respect to the quality, the criteria used to evaluate the matching results are the number of iterations (assuming fast convergence should be achieved), the alteration of the size of the parameters in each iteration and the size of parameters. In parallel, variations in the parameter values (magnitude and sign) in each iteration have to be observed for the stability of the solution.

After convergence of the solution the transformation parameters provide the new patch shape and centroid. The rotation between the initial position of the template and the final matched position is computed by accumulating the differential rotation angles derived by matching each consecutive template and patch. In Fig. 4
                        , 
                           
                              
                                 
                                    p
                                 
                                 
                                    x
                                 
                              
                           
                         denotes the “initial” patch width and 
                           
                              
                                 
                                    p
                                 
                                 
                                    x
                                 
                                 
                                    ′
                                 
                              
                           
                         is the “deformed” patch width in two consecutive image frames (middle and right image of Fig. 4). At the occurrence of an off-plane rotation around the y-axis, the facial patch shifts to a new position and deforms to a patch of smaller x-scale with 
                           
                              
                                 
                                    p
                                 
                                 
                                    x
                                 
                                 
                                    ′
                                 
                              
                              <
                              
                                 
                                    p
                                 
                                 
                                    x
                                 
                              
                           
                        . 
                           
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              
                              and
                              
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                                 
                                    ′
                                 
                              
                           
                         are the minimum and maximum x image coordinates of “initial” patch, assuming frontal view of the face with respect to the camera, such that 
                           
                              
                                 
                                    p
                                 
                                 
                                    x
                                 
                              
                              =
                              |
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                                 
                                    ′
                                 
                              
                              -
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              |
                           
                        . Similarly 
                           
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                              
                              and
                              
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                                 
                                    ′
                                 
                              
                           
                         are the minimum and maximum x image coordinates of the “deformed” patch, such that 
                           
                              
                                 
                                    p
                                 
                                 
                                    x
                                 
                                 
                                    ′
                                 
                              
                              =
                              |
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                                 
                                    ′
                                 
                              
                              -
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                              |
                           
                        .

To compute the rotation angle, assuming that the head approximates a spherical body, we utilize a spherical coordinate system (
                           
                              R
                              ,
                              ϕ
                              ,
                              λ
                           
                        ), where R is the sphere radius, 
                           
                              ϕ
                           
                         is the angle from the horizontal plane (vertical angle) and 
                           
                              λ
                           
                         the azimouth angle (horizontal angle). The mapping equations of the vertical perspective projection, i.e. a map projection that corresponds to the appearance of a sphere or globe when directly viewed from some distance away with the z-axis of the viewer aligned parallel to the positive z-axis of the globe, is given by the transformation equations
                           
                              (10)
                              
                                 x
                                 =
                                 
                                    
                                       k
                                    
                                    
                                       ′
                                    
                                 
                                 cos
                                 ϕ
                                 ·
                                 sin
                                 (
                                 λ
                                 -
                                 
                                    
                                       λ
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 y
                                 =
                                 
                                    
                                       k
                                    
                                    
                                       ′
                                    
                                 
                                 [
                                 cos
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                                 ·
                                 sin
                                 ϕ
                                 -
                                 sin
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                                 ·
                                 cos
                                 ϕ
                                 ·
                                 cos
                                 (
                                 λ
                                 -
                                 
                                    
                                       λ
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 ]
                              
                           
                        where (
                           
                              
                                 
                                    ϕ
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    λ
                                 
                                 
                                    0
                                 
                              
                           
                        ) are the coordinates of the projection center used in the vertical perspective projection and origin and P is the distance of the point of perspective in units of sphere radii
                           
                              (11)
                              
                                 
                                    
                                       k
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 (
                                 P
                                 -
                                 1
                                 )
                                 /
                                 (
                                 P
                                 -
                                 cosc
                                 )
                              
                           
                        and
                           
                              (12)
                              
                                 cosc
                                 =
                                 sin
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                                 ·
                                 sin
                                 ϕ
                                 +
                                 cos
                                 
                                    
                                       ϕ
                                    
                                    
                                       1
                                    
                                 
                                 ·
                                 cos
                                 ϕ
                                 ·
                                 cos
                                 (
                                 λ
                                 -
                                 
                                    
                                       λ
                                    
                                    
                                       0
                                    
                                 
                                 )
                              
                           
                        We compute the horizontal angle 
                           
                              λ
                           
                         from reference 
                           
                              
                                 
                                    λ
                                 
                                 
                                    0
                                 
                              
                              =
                              0
                              °
                           
                         with 
                           
                              ϕ
                              =
                              0
                              °
                           
                         and reference 
                           
                              
                                 
                                    ϕ
                                 
                                 
                                    1
                                 
                              
                              =
                              0
                              °
                           
                        . Accordingly (10) reduces to
                           
                              (13)
                              
                                 x
                                 =
                                 
                                    
                                       k
                                    
                                    
                                       ′
                                    
                                 
                                 sin
                                 (
                                 λ
                                 )
                              
                           
                        and the horizontal rotation 
                           
                              
                                 
                                    λ
                                 
                                 
                                    h
                                 
                              
                           
                         from 
                           
                              
                                 
                                    μ
                                 
                                 
                                    x
                                 
                              
                           
                         position is computed according to (14) and (15), where 
                           
                              
                                 
                                    μ
                                 
                                 
                                    x
                                 
                              
                           
                         position corresponds to the x coordinate of the patch center at initialization
                           
                              (14)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   λ
                                                
                                                
                                                   2
                                                
                                             
                                             =
                                             arcsin
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            -
                                                            
                                                               
                                                                  μ
                                                               
                                                               
                                                                  x
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  ′
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   λ
                                                
                                                
                                                   2
                                                
                                                
                                                   ′
                                                
                                             
                                             =
                                             arcsin
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  2
                                                               
                                                               
                                                                  ′
                                                               
                                                            
                                                            -
                                                            
                                                               
                                                                  μ
                                                               
                                                               
                                                                  x
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  ′
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (15)
                              
                                 
                                    
                                       λ
                                    
                                    
                                       h
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             λ
                                          
                                          
                                             2
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        
                        Fig. 5
                         illustrates temporal matching results with LSM, tracking the face’s off-plane horizontal rotation.

Assume the setup depicted in Fig. 6
                     . The user (at the center of the figure) and the robot stand in a scene which contains N visible (by both the robot and the user) points of interest 
                        
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 P
                              
                              
                                 N
                              
                           
                        
                     , (
                        
                           N
                           =
                           8
                        
                      in this specific example) surrounding the user and the robot. We assume that we know that the user points to one of the N POIs (e.g. the dialog manager provides this information) but we do not know which exactly is this POI. Each POI constitutes a possible pointing direction.

Let X be the universal set: This is the set that contains all visible POIs, also called the frame of discernment 
                     (16).
                        
                           (16)
                           
                              X
                              =
                              {
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    P
                                 
                                 
                                    N
                                 
                              
                              }
                           
                        
                     The power set 
                        
                           
                              
                                 2
                              
                              
                                 X
                              
                           
                        
                      is the set that comprises of all subsets of X, including the empty set 
                        
                           ∅
                        
                      and the whole set X. The elements of the power set can be taken to represent propositions about the pointing direction. Each proposition contains the POIs for which the proposition holds true and it is assigned a mass (an amount of belief) by means of a function 
                        
                           m
                           :
                           
                              
                                 2
                              
                              
                                 X
                              
                           
                           →
                           [
                           0
                           ,
                           1
                           ]
                        
                      which is called a basic belief assignment and it has two properties:
                        
                           •
                           The mass (amount of belief) of the empty set is zero:
                                 
                                    (17)
                                    
                                       m
                                       (
                                       ∅
                                       )
                                       =
                                       0
                                    
                                 
                              
                           

The masses of all the members of the power set add up to a total of 1:
                                 
                                    (18)
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                A
                                                ∈
                                                
                                                   
                                                      2
                                                   
                                                   
                                                      X
                                                   
                                                
                                             
                                          
                                       
                                       m
                                       (
                                       A
                                       )
                                       =
                                       1
                                    
                                 
                              
                           

In the task at hand, the user raises his hand to point to an exhibit 
                        
                           
                              
                                 P
                              
                              
                                 i
                              
                           
                           ,
                           1
                           ⩽
                           i
                           ⩽
                           N
                        
                      and simultaneously rotates his/her face to look at the direction of the exhibit, as described in Section 3. Hence, two sources of information exist: information from the hand pointing gesture and information from the face orientation. Each of the two sources of information has an independent basic belief assignment. Let 
                        
                           
                              
                                 m
                              
                              
                                 f
                              
                           
                        
                      represent the belief from face pose estimation and 
                        
                           
                              
                                 m
                              
                              
                                 h
                              
                           
                        
                      represent the belief from the hand pointing direction. To combine evidence from these two sources of information we make use of Dempster’s rule of combination.

It is to be noted at this point that the proposed formulation allows us to assign masses to propositions that contain more than one POIs. For example, lets assume that the hand gesture recognizer recognizes that the user points leftwards but cannot distinguish whether the user points to exhibit 
                        
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                        
                     , 
                        
                           
                              
                                 P
                              
                              
                                 3
                              
                           
                        
                      or 
                        
                           
                              
                                 P
                              
                              
                                 4
                              
                           
                        
                     . Demster-Shaffer theory allows us to assign a belief (e.g. 
                        
                           
                              
                                 m
                              
                              
                                 h
                              
                           
                        
                     ) to the proposition “The user points to one of 
                        
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 P
                              
                              
                                 3
                              
                           
                        
                      or 
                        
                           
                              
                                 P
                              
                              
                                 4
                              
                           
                        
                     ” and then work with this belief without having to equally “split” this belief to each of 
                        
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 P
                              
                              
                                 3
                              
                           
                           
                           and
                           
                           
                              
                                 P
                              
                              
                                 4
                              
                           
                        
                      as we would have had to do if we were working with probabilities (e.g. we would have to assign a probability of 0.33 to each of 
                        
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 P
                              
                              
                                 3
                              
                           
                           ,
                           
                              
                                 P
                              
                              
                                 4
                              
                           
                        
                     , which is an assumption that goes beyond what our observations suggest).

According to the Dempster’s rule of combination, the joint mass 
                        
                           
                              
                                 m
                              
                              
                                 f
                                 ,
                                 h
                              
                           
                        
                      can be computed as the orthogonal sum (commutative and associative) of the two masses, as follows:
                        
                           (19)
                           
                              
                                 
                                    m
                                 
                                 
                                    f
                                    ,
                                    h
                                 
                              
                              (
                              ∅
                              )
                              =
                              0
                           
                        
                     
                     
                        
                           (20)
                           
                              
                                 
                                    m
                                 
                                 
                                    f
                                    ,
                                    h
                                 
                              
                              (
                              
                                 
                                    A
                                 
                                 
                                    1
                                 
                              
                              )
                              =
                              (
                              
                                 
                                    m
                                 
                                 
                                    f
                                 
                              
                              ⊕
                              
                                 
                                    m
                                 
                                 
                                    2
                                 
                              
                              )
                              (
                              
                                 
                                    A
                                 
                                 
                                    1
                                 
                              
                              )
                              =
                              
                                 
                                    1
                                 
                                 
                                    K
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             A
                                          
                                          
                                             2
                                          
                                       
                                       ∩
                                       
                                          
                                             A
                                          
                                          
                                             3
                                          
                                       
                                       =
                                       
                                          
                                             A
                                          
                                          
                                             1
                                          
                                       
                                       ≠
                                       ∅
                                    
                                 
                              
                              
                                 
                                    m
                                 
                                 
                                    f
                                 
                              
                              (
                              
                                 
                                    A
                                 
                                 
                                    2
                                 
                              
                              )
                              
                                 
                                    m
                                 
                                 
                                    h
                                 
                              
                              (
                              
                                 
                                    A
                                 
                                 
                                    3
                                 
                              
                              )
                           
                        
                     where K is a normalization coefficient which is used to evaluate the amount of conflict between the two mass sets, given by:
                        
                           (21)
                           
                              K
                              =
                              1
                              -
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             A
                                          
                                          
                                             2
                                          
                                       
                                       ∩
                                       
                                          
                                             A
                                          
                                          
                                             3
                                          
                                       
                                       =
                                       ∅
                                    
                                 
                              
                              
                                 
                                    m
                                 
                                 
                                    f
                                 
                              
                              (
                              
                                 
                                    A
                                 
                                 
                                    2
                                 
                              
                              )
                              
                                 
                                    m
                                 
                                 
                                    h
                                 
                              
                              (
                              
                                 
                                    A
                                 
                                 
                                    3
                                 
                              
                              )
                           
                        
                     Eq. (20) provides a combined belief mass for every POI 
                        
                           
                              
                                 A
                              
                              
                                 1
                              
                           
                        
                      as a function of all pieces of evidence 
                        
                           
                              
                                 m
                              
                              
                                 f
                              
                           
                           (
                           
                              
                                 A
                              
                              
                                 2
                              
                           
                           )
                           
                           and
                           
                           
                              
                                 m
                              
                              
                                 h
                              
                           
                           (
                           
                              
                                 A
                              
                              
                                 3
                              
                           
                           )
                        
                      that agree on 
                        
                           
                              
                                 A
                              
                              
                                 1
                              
                           
                        
                     . 
                        
                           
                              
                                 A
                              
                              
                                 2
                              
                           
                           
                           and
                           
                           
                              
                                 A
                              
                              
                                 3
                              
                           
                        
                      are subsets of the universal set X such that 
                        
                           
                              
                                 A
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 A
                              
                              
                                 2
                              
                           
                           ∩
                           
                              
                                 A
                              
                              
                                 3
                              
                           
                        
                     . The POI with the larger combined mass is selected as the one pointed by the user.

It is to be noted at this point that the assumption behind this work that the user is simultaneously looking and pointing at the same exhibit eliminates the cases of conflicting evidence which, according to Zadeh’s criticism [40] for Dempster’s rule of combination, may lead (20) to produce counter intuitive results. In the next two sections we will elaborate on the actual calculation of 
                        
                           
                              
                                 m
                              
                              
                                 h
                              
                           
                           
                           and
                           
                           
                              
                                 m
                              
                              
                                 f
                              
                           
                        
                     .

For hand pointing gesture recognition, we assume that the system knows when a gesture takes place but can only recognize the pointing direction if it is within the intervals 
                           
                              [
                              
                                 
                                    ϕ
                                 
                                 
                                    h
                                    -
                                    min
                                 
                              
                              ,
                              
                                 
                                    ϕ
                                 
                                 
                                    h
                                    -
                                    max
                                 
                              
                              ]
                              ∪
                              [
                              -
                              
                                 
                                    ϕ
                                 
                                 
                                    h
                                    -
                                    max
                                 
                              
                              ,
                              -
                              
                                 
                                    ϕ
                                 
                                 
                                    h
                                    -
                                    min
                                 
                              
                              ]
                           
                        . If a “point left” gesture is recognized, we assume that the user is pointing to a POI within 
                           
                              [
                              -
                              
                                 
                                    ϕ
                                 
                                 
                                    h
                                    -
                                    max
                                 
                              
                              ,
                              -
                              
                                 
                                    ϕ
                                 
                                 
                                    h
                                    -
                                    min
                                 
                              
                              ]
                              (
                              
                                 
                                    P
                                 
                                 
                                    6
                                 
                              
                              
                              or
                              
                              
                                 
                                    P
                                 
                                 
                                    7
                                 
                              
                           
                         in the example of Fig. 6). Similarly, if a “point right” gesture is recognized, we assume that the user is pointing to a POI within 
                           
                              [
                              
                                 
                                    ϕ
                                 
                                 
                                    h
                                    -
                                    min
                                 
                              
                              ,
                              
                                 
                                    ϕ
                                 
                                 
                                    h
                                    -
                                    max
                                 
                              
                              ]
                              (
                              either
                              
                              
                                 
                                    P
                                 
                                 
                                    3
                                 
                              
                              
                              or
                              
                              
                                 
                                    P
                                 
                                 
                                    4
                                 
                              
                           
                        ). If there is no recognized gesture, we assume that the user pointed to a POI outside these two intervals (“point center”) with a belief mass of 
                           
                              
                                 
                                    m
                                 
                                 
                                    h
                                    -
                                    0
                                 
                              
                              =
                              
                                 
                                    m
                                 
                                 
                                    h
                                 
                              
                              (
                              {
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    P
                                 
                                 
                                    5
                                 
                              
                              ,
                              
                                 
                                    P
                                 
                                 
                                    8
                                 
                              
                              }
                              )
                           
                        . For the “point center” case, in the example of Fig. 6, the user might have pointed to any of 
                           
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    P
                                 
                                 
                                    5
                                 
                              
                              
                              or
                              
                              
                                 
                                    P
                                 
                                 
                                    8
                                 
                              
                           
                        . Depending on the recognized hand pointing gesture (“point left”, “point right”) or the fact that the gesture is “invisible”, different belief masses are assigned for the exhibits on the left, the exhibits on the right and the exhibits in the front and in the back of the user for which a pointing gesture cannot be recognized.

For the example of Fig. 6, the above belief masses are defined as follows:
                           
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   h
                                                   -
                                                   L
                                                
                                             
                                             =
                                             
                                                
                                                   m
                                                
                                                
                                                   h
                                                
                                             
                                             (
                                             {
                                             
                                                
                                                   P
                                                
                                                
                                                   6
                                                
                                             
                                             ,
                                             
                                                
                                                   P
                                                
                                                
                                                   7
                                                
                                             
                                             }
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   h
                                                   -
                                                   R
                                                
                                             
                                             =
                                             
                                                
                                                   m
                                                
                                                
                                                   h
                                                
                                             
                                             (
                                             {
                                             
                                                
                                                   P
                                                
                                                
                                                   3
                                                
                                             
                                             ,
                                             
                                                
                                                   P
                                                
                                                
                                                   4
                                                
                                             
                                             }
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   m
                                                
                                                
                                                   h
                                                   -
                                                   C
                                                
                                             
                                             =
                                             
                                                
                                                   m
                                                
                                                
                                                   h
                                                
                                             
                                             (
                                             {
                                             
                                                
                                                   P
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   P
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             
                                                
                                                   P
                                                
                                                
                                                   5
                                                
                                             
                                             ,
                                             
                                                
                                                   P
                                                
                                                
                                                   8
                                                
                                             
                                             }
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        with 
                           
                              
                                 
                                    m
                                 
                                 
                                    h
                                    -
                                    L
                                 
                              
                              +
                              
                                 
                                    m
                                 
                                 
                                    h
                                    -
                                    R
                                 
                              
                              +
                              
                                 
                                    m
                                 
                                 
                                    h
                                    -
                                    C
                                 
                              
                              =
                              1
                           
                        .

To appoint the sets that correspond to “point left”, “point right” and “point center” directions and define the masses 
                           
                              
                                 
                                    m
                                 
                                 
                                    h
                                    -
                                    L
                                 
                              
                              ,
                              
                                 
                                    m
                                 
                                 
                                    h
                                    -
                                    R
                                 
                              
                              
                              and
                              
                              
                                 
                                    m
                                 
                                 
                                    h
                                    -
                                    C
                                 
                              
                           
                         accordingly, we use specific values for 
                           
                              
                                 
                                    ϕ
                                 
                                 
                                    h
                                    -
                                    min
                                 
                              
                              
                              and
                              
                              
                                 
                                    ϕ
                                 
                                 
                                    h
                                    -
                                    max
                                 
                              
                           
                        . These values have been experimentally calculated as 
                           
                              
                                 
                                    ϕ
                                 
                                 
                                    h
                                    -
                                    min
                                 
                              
                              =
                              
                                 
                                    140
                                 
                                 
                                    o
                                 
                              
                              
                              and
                              
                              
                                 
                                    ϕ
                                 
                                 
                                    h
                                    -
                                    max
                                 
                              
                              =
                              
                                 
                                    40
                                 
                                 
                                    o
                                 
                              
                           
                         and roughly correspond to the angle limits beyond which the hand pointing gesture is not recognizable.

Let G be the actual gesture performed by the user and let 
                           
                              
                                 
                                    G
                                 
                                 
                                    O
                                 
                              
                           
                         be the gesture recognized (or not recognized) by the system. G takes values in H
                        
                           G
                        
                        ={“pointleft”, “point right”,“point center”} and G
                        
                           O
                         takes values in H
                        
                           O
                        
                        ={“pointleft”, “point right”,“invisible”}.

To assign masses to 
                           
                              
                                 
                                    m
                                 
                                 
                                    h
                                    -
                                    L
                                 
                              
                           
                         
                        
                           
                              
                                 
                                    m
                                 
                                 
                                    h
                                    -
                                    R
                                 
                              
                              
                              and
                              
                              
                                 
                                    m
                                 
                                 
                                    h
                                    -
                                    C
                                 
                              
                           
                        , we calculate the probabilities P(G
                        =“pointleft”∣G
                        
                           O
                        ), P(G
                        =“pointright”∣G
                        
                           O
                        ) and P(G
                        =“pointcenter”∣G
                        
                           O
                        ), respectively which are computed using the Bayess rule as:
                           
                              (22)
                              
                                 P
                                 (
                                 G
                                 |
                                 
                                    
                                       G
                                    
                                    
                                       O
                                    
                                 
                                 )
                                 =
                                 P
                                 (
                                 
                                    
                                       G
                                    
                                    
                                       O
                                    
                                 
                                 |
                                 G
                                 )
                                 
                                    
                                       P
                                       (
                                       G
                                       )
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             h
                                             ∈
                                             
                                                
                                                   H
                                                
                                                
                                                   O
                                                
                                             
                                          
                                       
                                       P
                                       (
                                       
                                          
                                             G
                                          
                                          
                                             O
                                          
                                       
                                       |
                                       G
                                       =
                                       h
                                       )
                                       P
                                       (
                                       G
                                       =
                                       h
                                       )
                                    
                                 
                              
                           
                        In the above equation 
                           
                              P
                              (
                              G
                              )
                           
                         is computed as the number of visible POIs that fall within G divided by the total number of visible POIs. The likelihoods 
                           
                              P
                              (
                              
                                 
                                    G
                                 
                                 
                                    O
                                 
                              
                              |
                              G
                              )
                           
                         are obtained off-line and correspond to the percentage of times a pointing gesture was recognized as 
                           
                              
                                 
                                    G
                                 
                                 
                                    O
                                 
                              
                           
                         given that the actual gesture was G. The actual values computed during our experiments are summarized in the confusion matrix in Table 2
                        .

For face orientation, we assume that it is recognizable only within the range 
                           
                              [
                              -
                              
                                 
                                    ϕ
                                 
                                 
                                    f
                                    -
                                    max
                                 
                              
                              ,
                              
                                 
                                    ϕ
                                 
                                 
                                    f
                                    -
                                    max
                                 
                              
                              ]
                           
                        . If the user is looking at a POI which lays within this range then the face orientation can be computed using the algorithm described in Section 5.2 and, additionally, this information can be employed to identify the target exhibit 
                           
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                           
                        , with a belief 
                           
                              
                                 
                                    m
                                 
                                 
                                    f
                                 
                              
                              (
                              {
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              }
                              )
                           
                        . If the face orientation cannot be computed, we assume with a belief 
                           
                              
                                 
                                    m
                                 
                                 
                                    f
                                    -
                                    O
                                 
                              
                              =
                              
                                 
                                    m
                                 
                                 
                                    f
                                 
                              
                              (
                              {
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    P
                                 
                                 
                                    8
                                 
                              
                              }
                              )
                           
                         that the face is looking at a POI outside 
                           
                              [
                              -
                              
                                 
                                    ϕ
                                 
                                 
                                    f
                                    -
                                    max
                                 
                              
                              ,
                              -
                              
                                 
                                    ϕ
                                 
                                 
                                    f
                                    -
                                    max
                                 
                              
                              ]
                           
                        . Since 
                           
                              
                                 
                                    m
                                 
                                 
                                    f
                                 
                              
                           
                         is a basic belief assignment, we make sure that the following equation holds.
                           
                              (23)
                              
                                 
                                    
                                       m
                                    
                                    
                                       f
                                       -
                                       O
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                    
                                       m
                                    
                                    
                                       f
                                    
                                 
                                 (
                                 {
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                 
                                 }
                                 )
                                 =
                                 1
                              
                           
                        Similarly to the hand pointing gestures, to assign masses to 
                           
                              
                                 
                                    m
                                 
                                 
                                    f
                                 
                              
                           
                        , we use the conditional probabilities for the user looking at each POI 
                           
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                           
                         given the perceived face orientation 
                           
                              
                                 
                                    ϕ
                                 
                                 
                                    O
                                 
                              
                           
                        , calculated as:
                           
                              (24)
                              
                                 P
                                 (
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                 
                                 |
                                 
                                    
                                       ϕ
                                    
                                    
                                       O
                                    
                                 
                                 )
                                 =
                                 P
                                 (
                                 
                                    
                                       ϕ
                                    
                                    
                                       O
                                    
                                 
                                 |
                                 
                                    
                                       P
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 
                                    
                                       P
                                       (
                                       
                                          
                                             P
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             =
                                             1
                                          
                                          
                                             N
                                          
                                       
                                       P
                                       (
                                       
                                          
                                             ϕ
                                          
                                          
                                             O
                                          
                                       
                                       |
                                       
                                          
                                             P
                                          
                                          
                                             k
                                          
                                       
                                       )
                                       P
                                       (
                                       
                                          
                                             P
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        In the absence of any prior information, 
                           
                              P
                              (
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         are assigned equal values for all 
                           
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                           
                        . The likelihood 
                           
                              P
                              (
                              
                                 
                                    ϕ
                                 
                                 
                                    O
                                 
                              
                              |
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         is computed according to the relative angle of 
                           
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                           
                         with respect to the user. The exact values are found by interpolation to data gathered off-line, stored as a confusion matrix (Fig. 7
                        ).

@&#EXPERIMENTAL RESULTS@&#

Quantitative evaluation of pointing direction results is difficult because of the lack of dependable ground truth. To overcome this difficulty, we performed quantitative evaluation by setting up a series of experiments which involved the user performing in a scripted scenario. According to the scenario, the user stands in front of the robot and points in predefined directions (specified POIs) using both his hand and face. The POIs are defined in the range of 
                           
                              0
                              °
                              ±
                              180
                              °
                           
                         at angular distances of 
                           
                              10
                              °
                           
                        .

For each pointing gesture, the system identifies the orientation of the face and additionally it classifies the hand gesture as a left pointing gesture or a right pointing gesture. Sample recognition results for face orientation are shown in Fig. 8
                        . The confusion matrix of Fig. 7 relates the absolute (both left and right) estimated head orientations to the intended head orientations in the range of 
                           
                              0
                              °
                              ±
                              180
                              °
                           
                        . The percentages were derived from image sequences of a total of 7000 image frames. As can be easily seen, the algorithm achieves high success rates for small angles (user looks in directions close to the direction of the camera) which are decreased for larger angles (the user looks away from the camera). The algorithm is able to maintain significant success rates (more than 
                           
                              50
                              %
                           
                        ) even for angles up to 
                           
                              120
                              °
                           
                        , where only a small part of the facial patch is visible. The hand pointing gesture has always been recognized correctly for pointing orientations within the range 
                           
                              [
                              30
                              °
                              ,
                              130
                              °
                              ]
                              
                              and
                              
                              [
                              -
                              130
                              °
                              ,
                              -
                              30
                              °
                              ]
                           
                        .

Evidently the performance of an algorithm that identifies pointed POIs instead of pointing directions depends on the structure of the environment and the distribution of the POIs within it. To evaluate the performance of the proposed methodology under different environment arrangements, we have conducted a series of experiments in three different simulated environments, depicted in Figs. 9 and 10
                        
                        . The first environment, shown in Fig. 9(a), consists of a single rectangular room with four POIs positioned on its walls. The second environment, depicted in Fig. 9(b), is similar to the first but contains eight POIs instead of four. Finally, the last environment, depicted in Fig. 10, contains five rooms connected together via a corridor. Within the rooms there are eight exhibits in total but they are arranged in a way that no more than three exhibits are simultaneously visible by both the robot and the user, for any user-robot arrangement.

To run the simulated experiments we randomly selected a large number of human–robot arrangements within each of these environments (1000). Each arrangement included a randomly selected POI that was visible by both the user and the robot and was assumed as pointed by the user. Fig. 10 depicts two such arrangements. In the first arrangement there are three visible POIs (
                           
                              
                                 
                                    P
                                 
                                 
                                    3
                                 
                              
                              ,
                              
                                 
                                    P
                                 
                                 
                                    4
                                 
                              
                              
                              and
                              
                              
                                 
                                    P
                                 
                                 
                                    7
                                 
                              
                           
                        , marked with green color) and the user points to 
                           
                              
                                 
                                    P
                                 
                                 
                                    4
                                 
                              
                           
                        . The second arrangement involves two visible POIs (
                           
                              
                                 
                                    P
                                 
                                 
                                    5
                                 
                              
                              
                              and
                              
                              
                                 
                                    P
                                 
                                 
                                    6
                                 
                              
                           
                        , marked with green color), with 
                           
                              
                                 
                                    P
                                 
                                 
                                    5
                                 
                              
                           
                         being pointed by the user.

During the simulation experiments the output of the face orientation and hand pointing gesture recognition modules was simulated as well. The output of the modules was assumed imperfect, simulating the distributions shown in the confusion matrices depicted in Table 2 and Fig. 7, respectively.

The results obtained are shown in Table 3
                        . The total number of arrangements (N) for each environment was 1000. In the vast majority of cases, the fusion algorithm returned a single result. In cases that there were ambiguities regarding the pointed POI (e.g., there were more than one POI outside the angular regions defined in Fig. 6), the algorithm returned more than one results with the same mass. The average number of returned results with the same, maximum, mass is indicted as 
                           
                              
                                 
                                    n
                                 
                                 
                                    av
                                 
                              
                           
                        . The row labeled “
                           
                              
                                 
                                    Cor
                                 
                                 
                                    m
                                 
                              
                           
                        ” provides the number of times that the correct result was within the returned results, even if the number of results with the maximum mass was more than one. The row labeled “
                           
                              
                                 
                                    Cor
                                 
                                 
                                    s
                                 
                              
                           
                        ” provides the figures for the cases that the algorithm returned a single, correct result. Finally, the row labeled “False” corresponds to the cases that the algorithm failed to provide the correct POI within the returned results.

It is to be noted at this point that many of the above arrangements correspond to cases that the robot is not able to recognize neither the hand pointing direction nor the face orientation (e.g., when the user points to an exhibit behind him/her). In these cases, the lack of input is a piece of evidence by itself, which is correctly utilized by our algorithm to limit the number of possible solutions. As can be easily seen from the results of Table 3, this is especially successful for environments like the ones depicted in Figs. 9a and 10 where the spatial arrangements of POIs and the topology of the environment (walls, doors, etc.) help distinguish between different possible solutions.


                        Table 4
                         shows the results obtained for the same configurations when a single source of information was only available: either face orientation or hand pointing direction. 
                           
                              
                                 
                                    V
                                 
                                 
                                    h
                                 
                              
                           
                         corresponds to the number of cases that the pointed POI was either within 
                           
                              [
                              
                                 
                                    ϕ
                                 
                                 
                                    h
                                    -
                                    min
                                 
                              
                              ,
                              
                                 
                                    ϕ
                                 
                                 
                                    h
                                    -
                                    max
                                 
                              
                              ]
                           
                         or within 
                           
                              [
                              -
                              
                                 
                                    ϕ
                                 
                                 
                                    h
                                    -
                                    max
                                 
                              
                              ,
                              -
                              
                                 
                                    ϕ
                                 
                                 
                                    h
                                    -
                                    min
                                 
                              
                              ]
                           
                        , i.e., within one of the two ranges that the pointing gesture is recognizable (see Fig. 6). 
                           
                              
                                 
                                    C
                                 
                                 
                                    h
                                 
                              
                           
                         corresponds to the correct classification results that would have been obtained if the recognition of a pointing gesture in either of the ranges was the only information available to the classifier. The assumption used to derive the obtained results were that we had a correct classification if the gesture was correctly recognized (recognition rates were assumed according to the percentages shown in Table 2) and, additionally, a single POI existed within the pointed region. Similarly, 
                           
                              
                                 
                                    V
                                 
                                 
                                    f
                                 
                              
                           
                         corresponds to the number of cases that the pointed POI was within 
                           
                              [
                              -
                              
                                 
                                    ϕ
                                 
                                 
                                    f
                                    -
                                    max
                                 
                              
                              ,
                              
                                 
                                    ϕ
                                 
                                 
                                    f
                                    -
                                    max
                                 
                              
                              ]
                              
                              and
                              
                              
                                 
                                    C
                                 
                                 
                                    f
                                 
                              
                           
                         corresponds to the correct classification results that would have been obtained if we were using a classifier which could achieve the results depicted in Fig. 7.

By comparing the results from Tables 3 and 4, one arrives at the conclusion that the proposed approach clearly outperforms both “single-evidence” classifiers describe above. In all three environments, the algorithms successfully combines evidence from both information streams, achieving recognition rates that could not have been obtained by any of the two information streams alone.

To further test the performance of the system under real conditions we have setup two human–robot interaction experiments. The first experiment took place in a corridor structure (Fig. 11
                        (a)) which contained 28 POIs, each one assigned to a door leading to a different room. The second experiment took place in a large public structure (Fig. 11(b)), also within our building complex. In this case, POIs were assigned to doors leading to different parts of the complex, elevators, the cafeteria, as well as various posters on the walls of the foyer. Images during the second experiment are shown in Fig. 12
                        , indicating the difficulties of the environment due to varying illumination and varying background.

Both experiments involve an autonomously navigating robot which interacts with a human user. The human is at a distance of two meters from the robot, so that his/her fingers are recognizable and uses his hand and head to point to one of the predefined target points (POIs). The robot uses the proposed approach in order to recognize the pointed target. If there are ambiguities about the pointed target (e.g. the algorithm returns more than one result with the same mass) the robot randomly picks one of the possible targets. The robot moves to the picked target and the human notes whether the robot correctly recognized the target or not. The procedure is repeated for a number of times and the results are summarized in Table 5
                        . Correctly recognized refers to a single correct result and correctly selected includes both the single result and the random correct selection.

As can be easily observed the simulated results are equivalent to the ones obtained for the simulated environments. Moreover, the system is able to operate in real-time at 30 fps on a conventional computer located on the robot. At this frame rate blob tracking, gesture recognition, head orientation estimation and fusion take place.

@&#CONCLUSIONS@&#

In this paper we have presented a novel method for estimating a pointed target by fusing information regarding hand pointing gestures and the pose of the user’s head. The proposed method is able to achieve surprisingly good performance by considering prior knowledge about the location of possible pointing targets which reduces the problem to deciding which is the pointed target rather than calculating the actual pointing direction.

Unlike most other contemporary methods, our approach operates with a monocular vision system and we have demonstrated its ability to achieve significant recognition rates even in cases that either of the two or both input streams are missing. For the reviewed monocular methods [25,23,24] a direct comparative evaluation is not justified since they address different variants of the pointing problem, under different experimental setups and assumptions.

The proposed method is readily applicable in a large variety of human–robot interaction scenarios. Future work will involve its enhancement by fusing additional sources of information, such as arm pose, body orientation and a priori probabilities of POI selection. Moreover, apart from extending the interaction scenario to simultaneously handle multiple users, it is of interest to extract additional information on vertical pointing directions.

@&#ACKNOWLEDGMENTS@&#

This work was partially supported by the European Commission under contract numbers FP7-248258 (First-MM project) and FP7-270435 (JAMES project).

@&#REFERENCES@&#

