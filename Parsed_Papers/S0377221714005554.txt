@&#MAIN-TITLE@&#Scheduling a hybrid assembly-differentiation flowshop to minimize total flow time

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Hybrid assembly-differentiation flowshop scheduling problem with total flow time.


                        
                        
                           
                           A mixed integer programming model for the HADFSP-TFT.


                        
                        
                           
                           Some properties of the optimal solutions for the HADFSP-TFT.


                        
                        
                           
                           Two fast heuristics and three hybrid meta-heuristics for the HADFSP-TFT.


                        
                        
                           
                           A lower bound for the HADFSP-TFT to evaluate the proposed algorithms.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Scheduling

Hybrid assembly-differentiation flowshop

Hybrid meta-heuristics

Total flow time

@&#ABSTRACT@&#


               
               
                  This study considers a hybrid assembly-differentiation flowshop scheduling problem (HADFSP), in which there are three production stages, including components manufacturing, assembly, and differentiation. All the components of a job are processed on different machines at the first stage. Subsequently, they are assembled together on a common single machine at the second stage. At the third stage, each job of a particular type is processed on a dedicated machine. The objective is to find a job schedule to minimize total flow time (TFT). At first, a mixed integer programming (MIP) model is formulated and then some properties of the optimal solution are presented. Since the NP-hardness of the problem, two fast heuristics (SPT-based heuristic and NEH-based heuristic) and three hybrid meta-heuristics (HGA-VNS, HDDE-VNS and HEDA-VNS) are developed for solving medium- and large-size problems. In order to evaluate the performances of the proposed algorithms, a lower bound for the HADFSP with TFT criteria (HADFSP-TFT) is established. The MIP model and the proposed algorithms are compared on randomly generated problems. Computational results show the effectiveness of the MIP model and the proposed algorithms. The computational analysis indicates that, in average, the HDDE-VNS performs better and more robustly than the other two meta-heuristics, whereas the NEH heuristic consume little time and could reach reasonable solutions.
               
            

@&#INTRODUCTION@&#

In a two-stage assembly flowshop, there is a finite set J of n jobs to be processed. Each job requires m different components which are processed on m parallel machines at the first stage. At the second stage, a single assembly machine is used to assemble the components which are produced at the first stage. It has widely industrial applications such as fire engine assembly plant (Lee, Cheng, & Lin, 1993), distributed database systems (Allahverdi & Al-Anzi, 2006a, 2006b) and personal computer manufacturing (Potts, Sevastjanov, Strusevich, Wassenhove, & Zwaneveld, 1995).

The two-stage assembly flowshop scheduling problem (TSAFSP) with makespan criteria has been proved to be strongly NP-hard by Lee et al. (1993) and Potts et al. (1995), respectively. Some recent efforts are made to schedule jobs with different objectives in the two stage assembly production environment. Lee et al. (1993), Potts et al. (1995), Koulamas and Kyparisis (2001), and Allahverdi and Al-Anzi (2006a, 2006b) considered the TSAFSP to minimize makespan. Tozkapan, Kirca, and Chung (2003) studied the problem with objective of minimizing the total weighted flow time. Allahverdi and Al-Anzi (2006a, 2006b) addressed the problem to minimize lateness. Al-Anzi and Allahverdi (2007) also studied the TSAFSP with lateness criteria considering setup times. Mozdgir, Fatemi Ghomi, Jolai, and Navaei (2013) discussed the problem to optimize makespan and mean flow time simultaneously.

However, all the above research neglected the differentiation operations, which arise from various industrial applications (Herrmann & Lee, 1992; Riane, Artiba, & Elmaghraby, 2002; Cheng, Lin, & Tian, 2009; Lin & Hwang, 2011; Liu, Fang, & Lin, 2012; Wang & Liu, 2013). For example, in a PC manufacturing plant, components are assembled on a common stage station, no matter which kind of computers is to be processed. After the assembly stage, the computers will be transported to the differentiation stage where different types of computers are packaged on several package machines. Another example is car manufacturing (Wang & Liu, 2013), when a car model is finished assembly, it will be sent to the paint shop where several parallel paint machines are installed for painting different colors. In the aspect of differentiation flowshop scheduling problem (DFSP), Herrmann and Lee (1992) show that the DFSP is NP-hard even if there are only two dedicated machines at stage two. Riane et al. (2002) studied the DFSP in which there are two dedicated machines in the second stage. Its objective is to minimize the makespan. They proved that the problem is strongly NP-complete and presented three heuristics and a dynamic programming algorithm. Cheng et al. (2009) considered the DFSP to minimize the weighted sum of machine completion times (WMT). They proved that the problem is strongly NP-hard and gave an O(n
                     3) polynomial time algorithm to solve the special case where the sequences of jobs per type are fixed. Also, they developed an approximation algorithm with a tight performance ratio for the general case. Lin and Hwang (2011) presented a dynamic programming algorithm for the DFSP with fixed sequences per job type. Liu et al. (2012) proposed a branch and bound algorithm for DFSP to minimize the makespan. Computational results show that their algorithm can substantially reduce the computing efforts to find optimal solutions. Wang and Liu (2013) considered the same problem with makespan criteria. They proposed a heuristic method based on branch and bound algorithm and given some lower bounds, upper bounds and dominance properties. Experimental results showed the effectiveness of their algorithm. Although there are some research works on the DFSP as above, the process of components manufacturing for assembly operation is neglected. In this situation, comprehensively considering the DFSP and the TSAFSP, we address a novel three-stage production scheduling problem which we called the hybrid assembly-differentiation flowshop scheduling problem (HADFSP). At the first stage, m different components required by a job are processed on m different machines in parallel. When all of the components are completed, a common single machine at the second stage assembles the components together into a model. Subsequently, the model is processed on one of several dedicated machines at the last stage. The first two stages (stage 1 and stage 2) and the last two stages (stage 2 and stage 3) can be regarded as a two-stage assembly flowshop (TSAF) and a differentiation flowshop, respectively. Our objective is to find an optimal or near-optimal permutation schedule for the HADFSP to minimize the total flow time (HADFSP-TFT). To the best of our knowledge, there are no published papers for dealing with this problem.

Obviously, the HADFSP-TFT is strongly NP-hard since its special cases (TSAFSP (Allahverdi & Al-Anzi, 2009), DFSP (Cheng et al., 2009), and three machine flowshop scheduling problem (Pinedo, 2002) are all strongly NP-hard). It is unlikely to find a polynomial time algorithm to obtain the optimal solution for the HADFSP-TFT. Recently, many meta-heuristics have been developed to provide optimal or near-optimal solutions for NP-hard problems in a reasonable execution time. The meta-heuristics include simulated annealing algorithm (SA, Eglese, 1990), genetic algorithm (GA, Holland, 1975), differential evolution (DE, (Storn & Price, 1997)), estimation of distribution algorithm (EDA, Muhlenbein & Paass, 1996), ant colony optimization (ACO, Dorigo & Gambardella, 1997), iterated greedy algorithm (IGA, Ruiz & Stutzle, 2007, 2008), variable neighborhood search (VNS, Mladenovic & Hansen, 1997) and tabu search (TS, Glover, 1996), etc. As an NP-hard problem, it is difficult to know the optimal solution of HADFSP-TFT and hence, to verify the effectiveness and preference of a meta-heuristic algorithm against others meta-heuristics if there are no other meta-heuristics for comparison. Since a skilled combination of different meta-heuristics can improve the performances of many combinatorial problems (Allahverdi & Aydilek, 2014; Chen, Pan, & Lin, 2008; Figielska, 2014; Li, Ong, & Nee, 2004; Murata, Ishibuchi, & Tanaka, 1996; Naderi & Ruiz, 2014; Tseng & Lin, 2009; Wang, Wang, Xu, Zhou, & Liu, 2012), we proposed three hybrid meta-heuristics (HGA-VNS, HEDA-VNS and HDDE-VNS) and compared them with each other for this novel scheduling problem.

The remainder of this paper is organized as follows. Section 2 describes and formulates the HADFSP-TFT under consideration. Subsequently, some properties of the optimal solutions are given. Two constructive heuristics (a SPT-based heuristic and a NEH-based heuristic), three hybrid meta-heuristics (HGA-VNS, HEDA-VNS and HDDE-VNS) and a lower bound for the problem are presented in Section 3. Section 4 shows computational results for the problem. Section 5 concludes the paper and gives suggestions for future research.

The problem studied here can be defined as follows. There are n jobs to be processed. They can be divided into g disjoint sets of jobs 
                        
                           
                              
                                 N
                              
                              
                                 1
                              
                           
                           =
                           {
                           
                              
                                 J
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 J
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 J
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           }
                           ,
                           
                              
                                 N
                              
                              
                                 2
                              
                           
                           =
                           {
                           
                              
                                 J
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 1
                              
                           
                           ,
                           
                              
                                 J
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 J
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       n
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           }
                           ,
                           …
                        
                     , and 
                        
                           
                              
                                 N
                              
                              
                                 g
                              
                           
                           =
                           {
                           
                              
                                 J
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       n
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 ⋯
                                 +
                                 
                                    
                                       n
                                    
                                    
                                       g
                                       -
                                       1
                                    
                                 
                                 +
                                 1
                              
                           
                           ,
                           
                              
                                 J
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       n
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 ⋯
                                 +
                                 
                                    
                                       n
                                    
                                    
                                       g
                                       -
                                       1
                                    
                                 
                                 +
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 J
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       n
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 ⋯
                                 +
                                 
                                    
                                       n
                                    
                                    
                                       g
                                       -
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       n
                                    
                                    
                                       g
                                    
                                 
                              
                           
                           }
                        
                     . Each set consists of a specific type of jobs and Nh
                      contains nh
                      type h jobs. Let N
                     =
                     N
                     1
                     ∪
                     N
                     2
                     ∪⋯∪
                     Ng
                      be the set of all jobs. All jobs must be processed in three stages. Each job Jj
                      has m components to be processed on m different machines in parallel at the first stage. When all of these m components are completed, they are assembled into Job Jj
                      on the same machine at the second stage. At the third stage, there are g dedicated machines M
                     3,1,
                     M
                     3,2,…,
                     M
                     3,
                     
                        g
                     . If a job Jj
                      belongs to type h, then it will be processed on machine M
                     3,
                     
                        h
                     .

In this paper, we only discuss permutation schedules. That is, job components are to be processed on each machine at the first stage in the same order. Under the same order, jobs are assembled at the second stage while the job sequence on the dedicated machine at the third stage can be determined by the first-come, first-served (FCFS) rule.

Several assumptions are done as follows.
                        
                           •
                           All machines are available at time zero.

Each machine can process at most one job at a time.

Each job can be processed on at most one machine at a time.

Setup times and transportation times are neglected.

The processing time on both machines in three stages are known constants.

Job processing cannot be preempted before it is finished.

There are unlimited buffers between the machines of the stage one and two and the stage two and three.


                     Fig. 1
                      shows a simple HADFSP example with m
                     =3 and g
                     =2. At the first stage, three different components required by a job are processed on M
                     1,1, M
                     1,2, and M
                     1,3, respectively. At the second stage, all of three components are assembled into a job on the assembly machine. At the last stage, there are two dedicated machines M
                     3,1 and M
                     3,2, each of which processes a special type job.

Suppose that there are n
                     =4 jobs J
                     1, J
                     2, J
                     3, and J
                     4 to be processed. Jobs J
                     1 and J
                     2 belong to type 1 whereas Jobs J
                     3 and J
                     4 belong to type 2. Table 1
                      lists the processing time of jobs in all three stages. For a given a permutation schedule S
                     =(J
                     1,
                     J
                     4,
                     J
                     2,
                     J
                     3), its Gantt chart is shown in Fig. 2
                     .

For convenience and readability, some additional notation for HADFSP-TFT is introduced below:
                        
                           
                              
                              
                              
                                 
                                    Model indices and input parameters
                                 
                                 
                                    
                                       k
                                    
                                    machine index at the first stage, k
                                       =1,2,…,
                                       m;
                                 
                                 
                                    
                                       M
                                       1,
                                       
                                          k
                                       
                                    
                                    machine for processing component k of all the jobs in the first stage, k
                                       =1,2,…,
                                       m;
                                 
                                 
                                    
                                       M
                                       2
                                    
                                    assembly machine in the second stage;
                                 
                                 
                                    
                                       i, i′
                                    job position indices, i, i′=1,2,…,
                                       n;
                                 
                                 
                                    
                                       Φ
                                    
                                    a large number;
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   j
                                                   ,
                                                   k
                                                
                                                
                                                   (
                                                   1
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    processing time of job Jj
                                        on machine M
                                       1,
                                       
                                          k
                                        at the first stage;
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   j
                                                
                                                
                                                   (
                                                   2
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    assembly time of job Jj
                                        on assembly machine;
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   j
                                                   ,
                                                   h
                                                
                                                
                                                   (
                                                   3
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    processing time of job Jj
                                        on machine M
                                       3,
                                       
                                          h
                                        at the third stage. 
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   j
                                                   ,
                                                   h
                                                
                                                
                                                   (
                                                   3
                                                   )
                                                
                                             
                                             >
                                             0
                                          
                                        if 
                                          
                                             
                                                
                                                   J
                                                
                                                
                                                   j
                                                
                                             
                                             ∈
                                             
                                                
                                                   N
                                                
                                                
                                                   h
                                                
                                             
                                          
                                       ; 0, otherwise.
                                 
                                 
                                    
                                       
                                    
                                 
                                 
                                    Decision variables
                                 
                                 
                                    
                                       xj,[i]
                                       
                                    
                                    binary variable. xj
                                       
                                       ,[
                                       
                                          i
                                       
                                       ]
                                       =1 if job Jj
                                        is assigned in position i at the first two stages; 0, otherwise;
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   [
                                                   i
                                                   ]
                                                   ,
                                                   k
                                                
                                                
                                                   (
                                                   1
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    completion time of the job in position i on machine M
                                       1,
                                       
                                          k
                                        at the first stage;
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   [
                                                   i
                                                   ]
                                                
                                                
                                                   (
                                                   2
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    completion time of the job in position i on assembly machine M
                                       2 at the second stage;
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   [
                                                   i
                                                   ]
                                                   ,
                                                   h
                                                
                                                
                                                   (
                                                   3
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    completion time of the job, which is in position i at the first two stages, on machine M
                                       3,
                                       
                                          h
                                        at the third stage, i
                                       =1,2,…,
                                       n;
                                 
                                 
                                    TFT
                                    total flow time, 
                                          
                                             TFT
                                             =
                                             
                                                
                                                   ∑
                                                
                                                
                                                   h
                                                   =
                                                   1
                                                
                                                
                                                   g
                                                
                                             
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   n
                                                
                                             
                                             
                                                
                                                   C
                                                
                                                
                                                   [
                                                   i
                                                   ]
                                                   ,
                                                   h
                                                
                                                
                                                   (
                                                   3
                                                   )
                                                
                                             
                                          
                                       .
                                 
                              
                           
                        
                     
                  

According to the above-mentioned notations and assumptions, the HADFSP-TFT can be formulated as follows.
                        
                           (1)
                           
                              minimize
                              TFT
                           
                        
                     
                     
                        
                           (2)
                           
                              
                                 
                                    
                                       
                                          Subject to
                                       
                                    
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                
                                                   n
                                                
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                j
                                                ,
                                                [
                                                i
                                                ]
                                             
                                          
                                          =
                                          1
                                          
                                          ∀
                                          
                                          i
                                          =
                                          1
                                          ,
                                          2
                                          ,
                                          …
                                          ,
                                          n
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (3)
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    j
                                    ,
                                    [
                                    i
                                    ]
                                 
                              
                              =
                              1
                              
                              ∀
                              
                              j
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              n
                           
                        
                     
                     
                        
                           (4)
                           
                              TFT
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       h
                                       =
                                       1
                                    
                                    
                                       g
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                              
                              
                                 
                                    C
                                 
                                 
                                    [
                                    i
                                    ]
                                    ,
                                    h
                                 
                                 
                                    (
                                    3
                                    )
                                 
                              
                           
                        
                     
                     
                        
                           (5)
                           
                              
                                 
                                    C
                                 
                                 
                                    [
                                    1
                                    ]
                                    ,
                                    k
                                 
                                 
                                    (
                                    1
                                    )
                                 
                              
                              ⩾
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    j
                                    ,
                                    [
                                    1
                                    ]
                                 
                              
                              ·
                              
                                 
                                    p
                                 
                                 
                                    j
                                    ,
                                    k
                                 
                                 
                                    (
                                    1
                                    )
                                 
                              
                              
                              ∀
                              
                              k
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              m
                           
                        
                     
                     
                        
                           (6)
                           
                              
                                 
                                    C
                                 
                                 
                                    [
                                    i
                                    +
                                    1
                                    ]
                                    ,
                                    k
                                 
                                 
                                    (
                                    1
                                    )
                                 
                              
                              ⩾
                              
                                 
                                    C
                                 
                                 
                                    [
                                    i
                                    ]
                                    ,
                                    k
                                 
                                 
                                    (
                                    1
                                    )
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    j
                                    ,
                                    [
                                    i
                                    +
                                    1
                                    ]
                                 
                              
                              ·
                              
                                 
                                    p
                                 
                                 
                                    j
                                    ,
                                    k
                                 
                                 
                                    (
                                    1
                                    )
                                 
                              
                              
                              ∀
                              
                              i
                              =
                              1
                              ,
                              2
                              ,
                              …
                              n
                              -
                              1
                              ;
                              
                              k
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              m
                           
                        
                     
                     
                        
                           (7)
                           
                              
                                 
                                    C
                                 
                                 
                                    [
                                    1
                                    ]
                                 
                                 
                                    (
                                    2
                                    )
                                 
                              
                              ⩾
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    j
                                    ,
                                    [
                                    1
                                    ]
                                 
                              
                              ·
                              
                                 
                                    p
                                 
                                 
                                    j
                                 
                                 
                                    (
                                    2
                                    )
                                 
                              
                           
                        
                     
                     
                        
                           (8)
                           
                              
                                 
                                    C
                                 
                                 
                                    [
                                    i
                                    +
                                    1
                                    ]
                                 
                                 
                                    (
                                    2
                                    )
                                 
                              
                              ⩾
                              
                                 
                                    C
                                 
                                 
                                    [
                                    i
                                    ]
                                 
                                 
                                    (
                                    2
                                    )
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    j
                                    ,
                                    [
                                    i
                                    +
                                    1
                                    ]
                                 
                              
                              ·
                              
                                 
                                    p
                                 
                                 
                                    j
                                 
                                 
                                    (
                                    2
                                    )
                                 
                              
                              
                              ∀
                              
                              i
                              =
                              1
                              ,
                              2
                              ,
                              …
                              n
                              -
                              1
                           
                        
                     
                     
                        
                           (9)
                           
                              
                                 
                                    C
                                 
                                 
                                    [
                                    i
                                    ]
                                 
                                 
                                    (
                                    2
                                    )
                                 
                              
                              ⩾
                              
                                 
                                    C
                                 
                                 
                                    [
                                    i
                                    ]
                                    ,
                                    k
                                 
                                 
                                    (
                                    1
                                    )
                                 
                              
                              +
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    j
                                    ,
                                    [
                                    i
                                    ]
                                 
                              
                              ·
                              
                                 
                                    p
                                 
                                 
                                    j
                                 
                                 
                                    (
                                    2
                                    )
                                 
                              
                              
                              ∀
                              
                              i
                              =
                              1
                              ,
                              2
                              ,
                              …
                              n
                              ;
                              
                              k
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              m
                           
                        
                     
                     
                        
                           (10)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                C
                                             
                                             
                                                [
                                                i
                                                ]
                                                ,
                                                h
                                             
                                             
                                                (
                                                3
                                                )
                                             
                                          
                                          ⩾
                                          
                                             
                                                C
                                             
                                             
                                                [
                                                i
                                                ]
                                             
                                             
                                                (
                                                2
                                                )
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   ∈
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                j
                                                ,
                                                [
                                                i
                                                ]
                                             
                                          
                                          ·
                                          
                                             
                                                p
                                             
                                             
                                                j
                                                ,
                                                h
                                             
                                             
                                                (
                                                3
                                                )
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            j
                                                            ∈
                                                            
                                                               
                                                                  N
                                                               
                                                               
                                                                  h
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         j
                                                         ,
                                                         [
                                                         i
                                                         ]
                                                      
                                                   
                                                   -
                                                   1
                                                
                                             
                                          
                                          ·
                                          Φ
                                          
                                          ∀
                                          
                                          i
                                          =
                                          1
                                          ,
                                          2
                                          ,
                                          …
                                          ,
                                          n
                                          ;
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                          h
                                          =
                                          1
                                          ,
                                          2
                                          ,
                                          …
                                          ,
                                          g
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (11)
                           
                              
                                 
                                    C
                                 
                                 
                                    [
                                    i
                                    ]
                                    ,
                                    h
                                 
                                 
                                    (
                                    3
                                    )
                                 
                              
                              ⩽
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      j
                                                   
                                                
                                                ∈
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      h
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             j
                                             ,
                                             [
                                             i
                                             ]
                                          
                                       
                                    
                                 
                              
                              ·
                              Φ
                              
                              ∀
                              
                              i
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              n
                              ;
                              
                              h
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              g
                           
                        
                     
                     
                        
                           (12)
                           
                              
                                 
                                    C
                                 
                                 
                                    [
                                    1
                                    ]
                                    ,
                                    h
                                 
                                 
                                    (
                                    3
                                    )
                                 
                              
                              ⩾
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             J
                                          
                                          
                                             j
                                          
                                       
                                       ∈
                                       
                                          
                                             N
                                          
                                          
                                             h
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    p
                                 
                                 
                                    j
                                    ,
                                    h
                                 
                                 
                                    (
                                    3
                                    )
                                 
                              
                              ·
                              
                                 
                                    x
                                 
                                 
                                    j
                                    ,
                                    [
                                    1
                                    ]
                                 
                              
                              +
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      j
                                                   
                                                
                                                ∈
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      h
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             j
                                             ,
                                             [
                                             1
                                             ]
                                          
                                       
                                       -
                                       1
                                    
                                 
                              
                              ·
                              Φ
                              
                              ∀
                              
                              h
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              g
                           
                        
                     
                     
                        
                           (13)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                C
                                             
                                             
                                                [
                                                i
                                                ]
                                                ,
                                                h
                                             
                                             
                                                (
                                                3
                                                )
                                             
                                          
                                          ⩾
                                          
                                             
                                                C
                                             
                                             
                                                [
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                ]
                                                ,
                                                h
                                             
                                             
                                                (
                                                3
                                                )
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   
                                                      
                                                         J
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   ∈
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                p
                                             
                                             
                                                j
                                                ,
                                                h
                                             
                                             
                                                (
                                                3
                                                )
                                             
                                          
                                          ·
                                          
                                             
                                                x
                                             
                                             
                                                j
                                                ,
                                                [
                                                i
                                                ]
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            
                                                               
                                                                  J
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                            ∈
                                                            
                                                               
                                                                  N
                                                               
                                                               
                                                                  h
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         j
                                                         ,
                                                         [
                                                         i
                                                         ]
                                                      
                                                   
                                                   -
                                                   1
                                                
                                             
                                          
                                          ·
                                          Φ
                                          
                                          ∀
                                          
                                          i
                                          =
                                          2
                                          ,
                                          3
                                          ,
                                          …
                                          ,
                                          n
                                          ;
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                          
                                             
                                                i
                                             
                                             
                                                ′
                                             
                                          
                                          <
                                          i
                                          ;
                                          
                                          h
                                          =
                                          1
                                          ,
                                          2
                                          ,
                                          …
                                          ,
                                          g
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (14)
                           
                              
                                 
                                    x
                                 
                                 
                                    j
                                    ,
                                    [
                                    i
                                    ]
                                 
                              
                              ∈
                              {
                              0
                              ,
                              1
                              }
                           
                        
                     
                     
                        
                           (15)
                           
                              
                                 
                                    C
                                 
                                 
                                    [
                                    i
                                    ]
                                    ,
                                    k
                                 
                                 
                                    (
                                    1
                                    )
                                 
                              
                              ,
                              
                                 
                                    C
                                 
                                 
                                    [
                                    i
                                    ]
                                 
                                 
                                    (
                                    2
                                    )
                                 
                              
                              ,
                              
                                 
                                    C
                                 
                                 
                                    [
                                    i
                                    ]
                                    ,
                                    h
                                 
                                 
                                    (
                                    3
                                    )
                                 
                              
                              ⩾
                              0
                           
                        
                     
                  

The objective function (1) shows the total flow time. Constraints (2) ensure that each position in the sequence of jobs is assigned to only one job. Constraints (3) indicate that each job is assigned only to one position in the sequence of jobs. Constraints (4) calculate the value of total flow time. Constraints (9) state that the assembly of a job in position at the second stage can only start when all the components of the same job are finished. Constraints (10) ensure that the processing of a job in position i at the third stage can only start when the same job on the second stage is finished. As each job can only be process on its dedicated machine, it has no processing time and completion time on other machines. Thus, in order to calculate TFT conveniently, constraints (11) ensure that 
                        
                           
                              
                                 C
                              
                              
                                 [
                                 i
                                 ]
                                 ,
                                 h
                              
                              
                                 (
                                 3
                                 )
                              
                           
                           =
                           0
                        
                     , 
                        
                           if
                           
                           
                              
                                 J
                              
                              
                                 [
                                 i
                                 ]
                              
                           
                           ∉
                           
                              
                                 N
                              
                              
                                 h
                              
                           
                        
                     . Constraints (12) calculate the completion time of the job, which is in the first position at the first two stages, on dedicated machine M
                     3,
                     
                        h
                     . Constraints (5) and (7) calculate the job in the first position at the first two stages, respectively. (6), (8), and (13) control that, for each production stage, each job can start only after the previous job assigned to the same machine is finished. Constraints (14) and (15) define the domain of the decision variables.

If no third stage, HADFSP-TFT is TSAFSP-TFT. If the first stage is neglected, the problem is a DFSP-TFT. If there is only one machine at both the first and third stages, the problem HADFSP-TFT is a flow shop scheduling problem with three machines to minimize TFT. Since the latter three problems are all strongly NP-hard (Allahverdi & Al-Anzi, 2009; Cheng et al., 2009; Pinedo, 2002), the HADFSP-TFT is also strongly NP-hard.

Let S be a job sequence, job j in position i, and 
                        
                           
                              
                                 C
                              
                              
                                 j
                              
                              
                                 (
                                 1
                                 )
                              
                           
                           (
                           S
                           )
                           =
                           
                              
                                 C
                              
                              
                                 [
                                 i
                                 ]
                              
                              
                                 (
                                 1
                                 )
                              
                           
                           (
                           S
                           )
                           =
                           
                              
                                 max
                              
                              
                                 k
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 m
                              
                           
                           
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          r
                                          =
                                          1
                                       
                                       
                                          i
                                          -
                                          1
                                       
                                    
                                    
                                       
                                          p
                                       
                                       
                                          [
                                          r
                                          ]
                                          ,
                                          k
                                       
                                       
                                          (
                                          1
                                          )
                                       
                                    
                                    +
                                    
                                       
                                          p
                                       
                                       
                                          j
                                          ,
                                          k
                                       
                                       
                                          (
                                          1
                                          )
                                       
                                    
                                 
                              
                           
                        
                     . Then we have Lemma 1 as follows.
                        Lemma 1
                        
                           Let Ja and Jb be two jobs which satisfy 
                           
                              
                                 
                                    
                                       p
                                    
                                    
                                       b
                                       ,
                                       k
                                    
                                    
                                       (
                                       1
                                       )
                                    
                                 
                                 ⩽
                                 
                                    
                                       p
                                    
                                    
                                       a
                                       ,
                                       k
                                    
                                    
                                       (
                                       1
                                       )
                                    
                                 
                                 ,
                                 
                                 ∀
                                 k
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 m
                              
                           
                           , and S1 and S2 be job sequences. In S1, Ja immediately precedes Jb. S2 is generated from S1 by interchanging Ja and Jb. Then, 
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       C
                                    
                                    
                                       j
                                    
                                    
                                       (
                                       1
                                       )
                                    
                                 
                                 (
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 ⩽
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       C
                                    
                                    
                                       j
                                    
                                    
                                       (
                                       1
                                       )
                                    
                                 
                                 (
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                           .

Suppose that, for sequence S
                           1, the jobs in positions τ and τ
                           +1 are Ja
                            and Jb
                           , respectively. We have
                              
                                 (16)
                                 
                                    
                                       
                                          C
                                       
                                       
                                          a
                                       
                                       
                                          (
                                          1
                                          )
                                       
                                    
                                    (
                                    
                                       
                                          S
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          C
                                       
                                       
                                          [
                                          τ
                                          ]
                                       
                                       
                                          (
                                          1
                                          )
                                       
                                    
                                    (
                                    
                                       
                                          S
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          
                                             max
                                          
                                          
                                             k
                                             =
                                             1
                                             ,
                                             2
                                             ,
                                             …
                                             ,
                                             m
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      r
                                                      =
                                                      1
                                                   
                                                   
                                                      τ
                                                      -
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   p
                                                
                                                
                                                   [
                                                   r
                                                   ]
                                                   ,
                                                   k
                                                
                                                
                                                   (
                                                   1
                                                   )
                                                
                                             
                                             +
                                             
                                                
                                                   p
                                                
                                                
                                                   a
                                                   ,
                                                   k
                                                
                                                
                                                   (
                                                   1
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                           
                              
                                 (17)
                                 
                                    
                                       
                                          C
                                       
                                       
                                          b
                                       
                                       
                                          (
                                          1
                                          )
                                       
                                    
                                    (
                                    
                                       
                                          S
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          C
                                       
                                       
                                          [
                                          τ
                                          +
                                          1
                                          ]
                                       
                                       
                                          (
                                          1
                                          )
                                       
                                    
                                    (
                                    
                                       
                                          S
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          
                                             max
                                          
                                          
                                             k
                                             =
                                             1
                                             ,
                                             2
                                             ,
                                             …
                                             ,
                                             m
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      r
                                                      =
                                                      1
                                                   
                                                   
                                                      τ
                                                      -
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   p
                                                
                                                
                                                   [
                                                   r
                                                   ]
                                                   ,
                                                   k
                                                
                                                
                                                   (
                                                   1
                                                   )
                                                
                                             
                                             +
                                             
                                                
                                                   p
                                                
                                                
                                                   a
                                                   ,
                                                   k
                                                
                                                
                                                   (
                                                   1
                                                   )
                                                
                                             
                                             +
                                             
                                                
                                                   p
                                                
                                                
                                                   b
                                                   ,
                                                   k
                                                
                                                
                                                   (
                                                   1
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                           
                              
                                 (18)
                                 
                                    
                                       
                                          C
                                       
                                       
                                          b
                                       
                                       
                                          (
                                          1
                                          )
                                       
                                    
                                    (
                                    
                                       
                                          S
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          C
                                       
                                       
                                          [
                                          τ
                                          ]
                                       
                                       
                                          (
                                          1
                                          )
                                       
                                    
                                    (
                                    
                                       
                                          S
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          
                                             max
                                          
                                          
                                             k
                                             =
                                             1
                                             ,
                                             2
                                             ,
                                             …
                                             ,
                                             m
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      r
                                                      =
                                                      1
                                                   
                                                   
                                                      τ
                                                      -
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   p
                                                
                                                
                                                   [
                                                   r
                                                   ]
                                                   ,
                                                   k
                                                
                                                
                                                   (
                                                   1
                                                   )
                                                
                                             
                                             +
                                             
                                                
                                                   p
                                                
                                                
                                                   b
                                                   ,
                                                   k
                                                
                                                
                                                   (
                                                   1
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                           
                              
                                 (19)
                                 
                                    
                                       
                                          C
                                       
                                       
                                          a
                                       
                                       
                                          (
                                          1
                                          )
                                       
                                    
                                    (
                                    
                                       
                                          S
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          C
                                       
                                       
                                          [
                                          τ
                                          +
                                          1
                                          ]
                                       
                                       
                                          (
                                          1
                                          )
                                       
                                    
                                    (
                                    
                                       
                                          S
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          
                                             max
                                          
                                          
                                             k
                                             =
                                             1
                                             ,
                                             2
                                             ,
                                             …
                                             ,
                                             m
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      r
                                                      =
                                                      1
                                                   
                                                   
                                                      τ
                                                      -
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   p
                                                
                                                
                                                   [
                                                   r
                                                   ]
                                                   ,
                                                   k
                                                
                                                
                                                   (
                                                   1
                                                   )
                                                
                                             
                                             +
                                             
                                                
                                                   p
                                                
                                                
                                                   b
                                                   ,
                                                   k
                                                
                                                
                                                   (
                                                   1
                                                   )
                                                
                                             
                                             +
                                             
                                                
                                                   p
                                                
                                                
                                                   a
                                                   ,
                                                   k
                                                
                                                
                                                   (
                                                   1
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        

It can be seen from Eqs. (17) and (19) that, 
                              
                                 
                                    
                                       C
                                    
                                    
                                       [
                                       τ
                                       +
                                       1
                                       ]
                                    
                                    
                                       (
                                       1
                                       )
                                    
                                 
                                 (
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       C
                                    
                                    
                                       [
                                       τ
                                       +
                                       1
                                       ]
                                    
                                    
                                       (
                                       1
                                       )
                                    
                                 
                                 (
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                           . Since S
                           2 is generated from S
                           1 by interchanging Ja
                            and Jb
                           , we have
                              
                                 (20)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             n
                                          
                                       
                                    
                                    
                                       
                                          C
                                       
                                       
                                          j
                                       
                                       
                                          (
                                          1
                                          )
                                       
                                    
                                    (
                                    
                                       
                                          S
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    -
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             n
                                          
                                       
                                    
                                    
                                       
                                          C
                                       
                                       
                                          j
                                       
                                       
                                          (
                                          1
                                          )
                                       
                                    
                                    (
                                    
                                       
                                          S
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          C
                                       
                                       
                                          [
                                          τ
                                          ]
                                       
                                       
                                          (
                                          1
                                          )
                                       
                                    
                                    (
                                    
                                       
                                          S
                                       
                                       
                                          1
                                       
                                    
                                    )
                                    -
                                    
                                       
                                          C
                                       
                                       
                                          [
                                          τ
                                          ]
                                       
                                       
                                          (
                                          1
                                          )
                                       
                                    
                                    (
                                    
                                       
                                          S
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          
                                             max
                                          
                                          
                                             k
                                             =
                                             1
                                             ,
                                             2
                                             ,
                                             …
                                             ,
                                             m
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      r
                                                      =
                                                      1
                                                   
                                                   
                                                      τ
                                                      -
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   p
                                                
                                                
                                                   [
                                                   r
                                                   ]
                                                   ,
                                                   k
                                                
                                                
                                                   (
                                                   1
                                                   )
                                                
                                             
                                             +
                                             
                                                
                                                   p
                                                
                                                
                                                   a
                                                   ,
                                                   k
                                                
                                                
                                                   (
                                                   1
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    -
                                    
                                       
                                          
                                             max
                                          
                                          
                                             k
                                             =
                                             1
                                             ,
                                             2
                                             ,
                                             …
                                             ,
                                             m
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      r
                                                      =
                                                      1
                                                   
                                                   
                                                      τ
                                                      -
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   p
                                                
                                                
                                                   [
                                                   r
                                                   ]
                                                   ,
                                                   k
                                                
                                                
                                                   (
                                                   1
                                                   )
                                                
                                             
                                             +
                                             
                                                
                                                   p
                                                
                                                
                                                   b
                                                   ,
                                                   k
                                                
                                                
                                                   (
                                                   1
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    ⩾
                                    0
                                    ,
                                 
                              
                           if 
                              
                                 
                                    
                                       p
                                    
                                    
                                       b
                                       ,
                                       k
                                    
                                    
                                       (
                                       1
                                       )
                                    
                                 
                                 ⩽
                                 
                                    
                                       p
                                    
                                    
                                       a
                                       ,
                                       k
                                    
                                    
                                       (
                                       1
                                       )
                                    
                                 
                                 ,
                                 
                                 ∀
                                 
                                 k
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 m
                              
                           . Thus, 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       C
                                    
                                    
                                       j
                                    
                                    
                                       (
                                       1
                                       )
                                    
                                 
                                 (
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 ⩽
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       C
                                    
                                    
                                       j
                                    
                                    
                                       (
                                       1
                                       )
                                    
                                 
                                 (
                                 
                                    
                                       S
                                    
                                    
                                       1
                                    
                                 
                                 )
                              
                            and hence Lemma 1 is proved.□

Although the HADFSP-TFT is NP-hardness, in some special cases, some properties of the optimal solution can be obtained as follows.
                        Lemma 2
                        
                           For HADFSP-TFT, if one of the following two conditions holds (i) 
                           
                              
                                 
                                    
                                       min
                                    
                                    
                                       
                                          
                                             J
                                          
                                          
                                             j
                                          
                                       
                                       ∈
                                       
                                          
                                             N
                                          
                                          
                                             h
                                          
                                       
                                    
                                 
                                 {
                                 
                                    
                                       p
                                    
                                    
                                       j
                                    
                                    
                                       (
                                       2
                                       )
                                    
                                 
                                 }
                                 ⩾
                                 
                                    
                                       max
                                    
                                    
                                       
                                          
                                             J
                                          
                                          
                                             j
                                          
                                       
                                       ∈
                                       
                                          
                                             N
                                          
                                          
                                             h
                                          
                                       
                                    
                                 
                                 {
                                 
                                    
                                       p
                                    
                                    
                                       j
                                       ,
                                       h
                                    
                                    
                                       (
                                       3
                                       )
                                    
                                 
                                 }
                                 ,
                                 
                                 ∀
                                 h
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 g
                              
                            
                           or (ii) n = g then the minimization of TFT is equivalent to the minimization of 
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       C
                                    
                                    
                                       j
                                    
                                    
                                       (
                                       2
                                       )
                                    
                                 
                              
                           .

With condition (i) or (ii), a job can be processed on its dedicated machine immediately after it is finished at the second stage. Thus, we have 
                              
                                 
                                    
                                       C
                                    
                                    
                                       j
                                       ,
                                       h
                                    
                                    
                                       (
                                       3
                                       )
                                    
                                 
                                 =
                                 
                                    
                                       C
                                    
                                    
                                       j
                                    
                                    
                                       (
                                       2
                                       )
                                    
                                 
                                 +
                                 
                                    
                                       p
                                    
                                    
                                       j
                                       ,
                                       h
                                    
                                    
                                       (
                                       3
                                       )
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       ifJ
                                    
                                    
                                       j
                                    
                                 
                                 ∈
                                 
                                    
                                       N
                                    
                                    
                                       h
                                    
                                 
                              
                           . Therefore, 
                              
                                 TFT
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       h
                                       =
                                       1
                                    
                                    
                                       g
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             J
                                          
                                          
                                             j
                                          
                                       
                                       ∈
                                       
                                          
                                             N
                                          
                                          
                                             h
                                          
                                       
                                    
                                 
                                 
                                    
                                       C
                                    
                                    
                                       j
                                       ,
                                       h
                                    
                                    
                                       (
                                       3
                                       )
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       C
                                    
                                    
                                       j
                                    
                                    
                                       (
                                       2
                                       )
                                    
                                 
                                 +
                                 
                                    
                                       ∑
                                    
                                    
                                       h
                                       =
                                       1
                                    
                                    
                                       g
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             J
                                          
                                          
                                             j
                                          
                                       
                                       ∈
                                       
                                          
                                             N
                                          
                                          
                                             h
                                          
                                       
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       j
                                       ,
                                       h
                                    
                                    
                                       (
                                       3
                                       )
                                    
                                 
                              
                           . Note that the term 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       h
                                       =
                                       1
                                    
                                    
                                       g
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             J
                                          
                                          
                                             j
                                          
                                       
                                       ∈
                                       
                                          
                                             N
                                          
                                          
                                             h
                                          
                                       
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       j
                                       ,
                                       h
                                    
                                    
                                       (
                                       3
                                       )
                                    
                                 
                              
                            is a constant. Thus, for a HADFSP, the minimization of TFT is equivalent to the minimization of 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       C
                                    
                                    
                                       j
                                    
                                    
                                       (
                                       2
                                       )
                                    
                                 
                              
                           . The proof is completed.□


                           For HADFSP-TFT, if 
                           
                              
                                 
                                    
                                       p
                                    
                                    
                                       1
                                       ,
                                       k
                                    
                                    
                                       (
                                       1
                                       )
                                    
                                 
                                 ⩽
                                 
                                    
                                       p
                                    
                                    
                                       2
                                       ,
                                       k
                                    
                                    
                                       (
                                       1
                                       )
                                    
                                 
                                 ⩽
                                 …
                                 ⩽
                                 
                                    
                                       p
                                    
                                    
                                       n
                                       ,
                                       k
                                    
                                    
                                       (
                                       1
                                       )
                                    
                                 
                                 ,
                                 
                                 ∀
                                 
                                 k
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 m
                                 ,
                                 
                                    
                                       min
                                    
                                    
                                       j
                                       =
                                       1
                                       ,
                                       2
                                       ,
                                       …
                                       ,
                                       n
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                max
                                             
                                             
                                                k
                                                =
                                                1
                                                ,
                                                2
                                                ,
                                                …
                                                ,
                                                m
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         j
                                                         ,
                                                         k
                                                      
                                                      
                                                         (
                                                         1
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ⩾
                                 
                                    
                                       max
                                    
                                    
                                       j
                                       =
                                       1
                                       ,
                                       2
                                       ,
                                       …
                                       ,
                                       n
                                    
                                 
                                 {
                                 
                                    
                                       p
                                    
                                    
                                       j
                                    
                                    
                                       (
                                       2
                                       )
                                    
                                 
                                 }
                              
                           
                           , and 
                           
                              
                                 
                                    
                                       min
                                    
                                    
                                       
                                          
                                             J
                                          
                                          
                                             j
                                          
                                       
                                       ∈
                                       
                                          
                                             N
                                          
                                          
                                             h
                                          
                                       
                                    
                                 
                                 {
                                 
                                    
                                       p
                                    
                                    
                                       j
                                    
                                    
                                       (
                                       2
                                       )
                                    
                                 
                                 }
                                 ⩾
                                 
                                    
                                       max
                                    
                                    
                                       
                                          
                                             J
                                          
                                          
                                             j
                                          
                                       
                                       ∈
                                       
                                          
                                             N
                                          
                                          
                                             h
                                          
                                       
                                    
                                 
                                 {
                                 
                                    
                                       p
                                    
                                    
                                       j
                                       ,
                                       h
                                    
                                    
                                       (
                                       3
                                       )
                                    
                                 
                                 }
                                 ,
                                 
                                 ∀
                                 h
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 g
                              
                            
                           or n=g hold, then the job sequence (J1,J2,…,Jn) is optimal.
                        

Since 
                              
                                 
                                    
                                       min
                                    
                                    
                                       
                                          
                                             J
                                          
                                          
                                             j
                                          
                                       
                                       ∈
                                       
                                          
                                             N
                                          
                                          
                                             h
                                          
                                       
                                    
                                 
                                 {
                                 
                                    
                                       p
                                    
                                    
                                       j
                                    
                                    
                                       (
                                       2
                                       )
                                    
                                 
                                 }
                                 ⩾
                                 
                                    
                                       max
                                    
                                    
                                       
                                          
                                             J
                                          
                                          
                                             j
                                          
                                       
                                       ∈
                                       
                                          
                                             N
                                          
                                          
                                             h
                                          
                                       
                                    
                                 
                                 {
                                 
                                    
                                       p
                                    
                                    
                                       j
                                       ,
                                       h
                                    
                                    
                                       (
                                       3
                                       )
                                    
                                 
                                 }
                                 ,
                                 
                                 ∀
                                 h
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 g
                              
                            or n
                           =
                           g, with Lemma 2, it is enough to consider the minimization of 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       C
                                    
                                    
                                       j
                                    
                                    
                                       (
                                       2
                                       )
                                    
                                 
                              
                           . Since 
                              
                                 
                                    
                                       min
                                    
                                    
                                       j
                                       =
                                       1
                                       ,
                                       2
                                       ,
                                       …
                                       ,
                                       n
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                max
                                             
                                             
                                                k
                                                =
                                                1
                                                ,
                                                2
                                                ,
                                                …
                                                ,
                                                m
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         j
                                                         ,
                                                         k
                                                      
                                                      
                                                         (
                                                         1
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ⩾
                                 
                                    
                                       max
                                    
                                    
                                       j
                                       =
                                       1
                                       ,
                                       2
                                       ,
                                       …
                                       ,
                                       n
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                j
                                             
                                             
                                                (
                                                2
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           , the jobs at the second stage always have idle time. Then, we have 
                              
                                 
                                    
                                       C
                                    
                                    
                                       j
                                    
                                    
                                       (
                                       2
                                       )
                                    
                                 
                                 =
                                 
                                    
                                       C
                                    
                                    
                                       j
                                    
                                    
                                       (
                                       1
                                       )
                                    
                                 
                                 +
                                 
                                    
                                       p
                                    
                                    
                                       j
                                    
                                    
                                       (
                                       2
                                       )
                                    
                                 
                              
                           . Thus, 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       C
                                    
                                    
                                       j
                                    
                                    
                                       (
                                       2
                                       )
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       C
                                    
                                    
                                       j
                                    
                                    
                                       (
                                       1
                                       )
                                    
                                 
                                 +
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       j
                                    
                                    
                                       (
                                       2
                                       )
                                    
                                 
                              
                           . Note that 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       j
                                    
                                    
                                       (
                                       2
                                       )
                                    
                                 
                              
                            is a constant, it is enough to consider only the first stage schedule. The results of Lemma 1 will be hold for any two adjacent jobs in the job sequence (J
                           1,
                           J
                           2,…,
                           Jn
                           ), if 
                              
                                 
                                    
                                       p
                                    
                                    
                                       1
                                       ,
                                       k
                                    
                                    
                                       (
                                       1
                                       )
                                    
                                 
                                 ⩽
                                 
                                    
                                       p
                                    
                                    
                                       2
                                       ,
                                       k
                                    
                                    
                                       (
                                       1
                                       )
                                    
                                 
                                 ⩽
                                 …
                                 ⩽
                                 
                                    
                                       p
                                    
                                    
                                       n
                                       ,
                                       k
                                    
                                    
                                       (
                                       1
                                       )
                                    
                                 
                                 ,
                                 
                                 ∀
                                 k
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 m
                              
                           . Thus, the job sequence (J
                           1,
                           J
                           2,…,
                           Jn
                           ) is optimal.□


                           For HADFSP-TFT, if relations 
                           
                              
                                 
                                    
                                       p
                                    
                                    
                                       1
                                    
                                    
                                       (
                                       2
                                       )
                                    
                                 
                                 ⩽
                                 
                                    
                                       p
                                    
                                    
                                       2
                                    
                                    
                                       (
                                       2
                                       )
                                    
                                 
                                 ⩽
                                 ⋯
                                 ⩽
                                 
                                    
                                       p
                                    
                                    
                                       n
                                    
                                    
                                       (
                                       2
                                       )
                                    
                                 
                                 ,
                                 
                                    
                                       max
                                    
                                    
                                       k
                                       =
                                       1
                                       ,
                                       2
                                       ,
                                       …
                                       ,
                                       m
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       1
                                       ,
                                       k
                                    
                                    
                                       (
                                       1
                                       )
                                    
                                 
                                 =
                                 
                                    
                                       min
                                    
                                    
                                       j
                                       =
                                       1
                                       ,
                                       2
                                       ,
                                       …
                                       ,
                                       n
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                max
                                             
                                             
                                                k
                                                =
                                                1
                                                ,
                                                2
                                                ,
                                                …
                                                ,
                                                m
                                             
                                          
                                          (
                                          
                                             
                                                p
                                             
                                             
                                                j
                                                ,
                                                k
                                             
                                             
                                                (
                                                1
                                                )
                                             
                                          
                                          )
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       max
                                    
                                    
                                       j
                                       =
                                       1
                                       ,
                                       2
                                       ,
                                       …
                                       ,
                                       n
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                max
                                             
                                             
                                                k
                                                =
                                                1
                                                ,
                                                2
                                                ,
                                                …
                                                ,
                                                m
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         j
                                                         ,
                                                         k
                                                      
                                                      
                                                         (
                                                         1
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ⩽
                                 
                                    
                                       min
                                    
                                    
                                       j
                                       =
                                       1
                                       ,
                                       2
                                       ,
                                       …
                                       ,
                                       n
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                j
                                             
                                             
                                                (
                                                2
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                           , and 
                           
                              
                                 
                                    
                                       min
                                    
                                    
                                       
                                          
                                             J
                                          
                                          
                                             j
                                          
                                       
                                       ∈
                                       
                                          
                                             N
                                          
                                          
                                             h
                                          
                                       
                                    
                                 
                                 {
                                 
                                    
                                       p
                                    
                                    
                                       j
                                    
                                    
                                       (
                                       2
                                       )
                                    
                                 
                                 }
                                 ⩾
                                 
                                    
                                       max
                                    
                                    
                                       
                                          
                                             J
                                          
                                          
                                             j
                                          
                                       
                                       ∈
                                       
                                          
                                             N
                                          
                                          
                                             h
                                          
                                       
                                    
                                 
                                 {
                                 
                                    
                                       p
                                    
                                    
                                       j
                                       ,
                                       h
                                    
                                    
                                       (
                                       3
                                       )
                                    
                                 
                                 }
                              
                            
                           or n=g hold, then the job sequence (J1,J2,…,Jn) is optimal.
                        

If 
                              
                                 
                                    
                                       max
                                    
                                    
                                       j
                                       =
                                       1
                                       ,
                                       2
                                       ,
                                       …
                                       ,
                                       n
                                    
                                 
                                 {
                                 
                                    
                                       max
                                    
                                    
                                       k
                                       =
                                       1
                                       ,
                                       2
                                       ,
                                       …
                                       ,
                                       m
                                    
                                 
                                 {
                                 
                                    
                                       p
                                    
                                    
                                       j
                                       ,
                                       k
                                    
                                    
                                       (
                                       1
                                       )
                                    
                                 
                                 }
                                 }
                                 ⩽
                                 
                                    
                                       min
                                    
                                    
                                       j
                                       =
                                       1
                                       ,
                                       2
                                       ,
                                       …
                                       ,
                                       n
                                    
                                 
                                 {
                                 
                                    
                                       p
                                    
                                    
                                       j
                                    
                                    
                                       (
                                       2
                                       )
                                    
                                 
                                 }
                              
                           , and 
                              
                                 
                                    
                                       min
                                    
                                    
                                       
                                          
                                             J
                                          
                                          
                                             j
                                          
                                       
                                       ∈
                                       
                                          
                                             N
                                          
                                          
                                             h
                                          
                                       
                                    
                                 
                                 {
                                 
                                    
                                       p
                                    
                                    
                                       j
                                    
                                    
                                       (
                                       2
                                       )
                                    
                                 
                                 }
                                 ⩾
                                 
                                    
                                       max
                                    
                                    
                                       
                                          
                                             J
                                          
                                          
                                             j
                                          
                                       
                                       ∈
                                       
                                          
                                             N
                                          
                                          
                                             h
                                          
                                       
                                    
                                 
                                 {
                                 
                                    
                                       p
                                    
                                    
                                       j
                                       ,
                                       h
                                    
                                    
                                       (
                                       3
                                       )
                                    
                                 
                                 }
                              
                            or n
                           =
                           g hold, then 
                              
                                 
                                    
                                       C
                                    
                                    
                                       [
                                       i
                                       ]
                                       ,
                                       h
                                    
                                    
                                       (
                                       3
                                       )
                                    
                                 
                                 =
                                 
                                    
                                       C
                                    
                                    
                                       [
                                       1
                                       ]
                                       ,
                                       h
                                    
                                    
                                       (
                                       1
                                       )
                                    
                                 
                                 +
                                 
                                    
                                       ∑
                                    
                                    
                                       s
                                       =
                                       1
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       [
                                       s
                                       ]
                                    
                                    
                                       (
                                       2
                                       )
                                    
                                 
                                 +
                                 
                                    
                                       p
                                    
                                    
                                       [
                                       i
                                       ]
                                       ,
                                       h
                                    
                                    
                                       (
                                       3
                                       )
                                    
                                 
                              
                           . Therefore,
                              
                                 (21)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             h
                                             =
                                             1
                                          
                                          
                                             g
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   J
                                                
                                                
                                                   [
                                                   i
                                                   ]
                                                
                                             
                                             ∈
                                             
                                                
                                                   N
                                                
                                                
                                                   h
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          C
                                       
                                       
                                          [
                                          i
                                          ]
                                          ,
                                          h
                                       
                                       
                                          (
                                          3
                                          )
                                       
                                    
                                    =
                                    
                                       
                                          nC
                                       
                                       
                                          [
                                          1
                                          ]
                                          ,
                                          k
                                       
                                       
                                          (
                                          1
                                          )
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             n
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             s
                                             =
                                             1
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       
                                          p
                                       
                                       
                                          [
                                          i
                                          ]
                                       
                                       
                                          (
                                          2
                                          )
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             h
                                             =
                                             1
                                          
                                          
                                             g
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   J
                                                
                                                
                                                   [
                                                   i
                                                   ]
                                                
                                             
                                             ∈
                                             
                                                
                                                   N
                                                
                                                
                                                   h
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          p
                                       
                                       
                                          [
                                          i
                                          ]
                                          ,
                                          h
                                       
                                       
                                          (
                                          3
                                          )
                                       
                                    
                                    =
                                    
                                       
                                          nC
                                       
                                       
                                          [
                                          1
                                          ]
                                          ,
                                          k
                                       
                                       
                                          (
                                          1
                                          )
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             n
                                          
                                       
                                    
                                    (
                                    n
                                    -
                                    i
                                    +
                                    1
                                    )
                                    ·
                                    
                                       
                                          p
                                       
                                       
                                          [
                                          i
                                          ]
                                       
                                       
                                          (
                                          2
                                          )
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             h
                                             =
                                             1
                                          
                                          
                                             g
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   J
                                                
                                                
                                                   [
                                                   i
                                                   ]
                                                
                                             
                                             ∈
                                             
                                                
                                                   N
                                                
                                                
                                                   h
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          p
                                       
                                       
                                          [
                                          i
                                          ]
                                          ,
                                          h
                                       
                                       
                                          (
                                          3
                                          )
                                       
                                    
                                    =
                                    
                                       
                                          np
                                       
                                       
                                          [
                                          1
                                          ]
                                          ,
                                          k
                                       
                                       
                                          (
                                          1
                                          )
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             n
                                          
                                       
                                    
                                    (
                                    n
                                    -
                                    i
                                    +
                                    1
                                    )
                                    ·
                                    
                                       
                                          p
                                       
                                       
                                          [
                                          i
                                          ]
                                       
                                       
                                          (
                                          2
                                          )
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             h
                                             =
                                             1
                                          
                                          
                                             g
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   J
                                                
                                                
                                                   [
                                                   i
                                                   ]
                                                
                                             
                                             ∈
                                             
                                                
                                                   N
                                                
                                                
                                                   h
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          p
                                       
                                       
                                          [
                                          i
                                          ]
                                          ,
                                          h
                                       
                                       
                                          (
                                          3
                                          )
                                       
                                    
                                    .
                                 
                              
                           Note that 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       h
                                       =
                                       1
                                    
                                    
                                       g
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             J
                                          
                                          
                                             [
                                             i
                                             ]
                                          
                                       
                                       ∈
                                       
                                          
                                             N
                                          
                                          
                                             h
                                          
                                       
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       [
                                       i
                                       ]
                                       ,
                                       h
                                    
                                    
                                       (
                                       3
                                       )
                                    
                                 
                              
                            is a constant, the minimization of 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       h
                                       =
                                       1
                                    
                                    
                                       g
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             J
                                          
                                          
                                             [
                                             i
                                             ]
                                          
                                       
                                       ∈
                                       
                                          
                                             N
                                          
                                          
                                             h
                                          
                                       
                                    
                                 
                                 
                                    
                                       C
                                    
                                    
                                       [
                                       i
                                       ]
                                       ,
                                       h
                                    
                                    
                                       (
                                       3
                                       )
                                    
                                 
                              
                            is equivalent to the minimization of 
                              
                                 
                                    
                                       np
                                    
                                    
                                       [
                                       1
                                       ]
                                       ,
                                       k
                                    
                                    
                                       (
                                       1
                                       )
                                    
                                 
                                 +
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 (
                                 n
                                 -
                                 i
                                 +
                                 1
                                 )
                                 ·
                                 
                                    
                                       p
                                    
                                    
                                       [
                                       i
                                       ]
                                    
                                    
                                       (
                                       2
                                       )
                                    
                                 
                              
                           . The term 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 (
                                 n
                                 -
                                 i
                                 +
                                 1
                                 )
                                 ·
                                 
                                    
                                       p
                                    
                                    
                                       [
                                       i
                                       ]
                                    
                                    
                                       (
                                       2
                                       )
                                    
                                 
                              
                            can be optimized by using the SPT rule. Since 
                              
                                 
                                    
                                       max
                                    
                                    
                                       k
                                       =
                                       1
                                       ,
                                       2
                                       ,
                                       …
                                       ,
                                       m
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       1
                                       ,
                                       k
                                    
                                    
                                       (
                                       1
                                       )
                                    
                                 
                                 =
                                 
                                    
                                       min
                                    
                                    
                                       j
                                       =
                                       1
                                       ,
                                       2
                                       ,
                                       …
                                       ,
                                       n
                                    
                                 
                                 {
                                 
                                    
                                       max
                                    
                                    
                                       k
                                       =
                                       1
                                       ,
                                       2
                                       ,
                                       …
                                       ,
                                       m
                                    
                                 
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       j
                                       ,
                                       k
                                    
                                    
                                       (
                                       1
                                       )
                                    
                                 
                                 )
                                 }
                              
                            and 
                              
                                 
                                    
                                       p
                                    
                                    
                                       1
                                    
                                    
                                       (
                                       2
                                       )
                                    
                                 
                                 ⩽
                                 
                                    
                                       p
                                    
                                    
                                       2
                                    
                                    
                                       (
                                       2
                                       )
                                    
                                 
                                 ⩽
                                 …
                                 ⩽
                                 
                                    
                                       p
                                    
                                    
                                       n
                                    
                                    
                                       (
                                       2
                                       )
                                    
                                 
                              
                           , the terms 
                              
                                 
                                    
                                       np
                                    
                                    
                                       [
                                       1
                                       ]
                                       ,
                                       k
                                    
                                    
                                       (
                                       1
                                       )
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 (
                                 n
                                 -
                                 i
                                 +
                                 1
                                 )
                                 ·
                                 
                                    
                                       p
                                    
                                    
                                       [
                                       i
                                       ]
                                    
                                    
                                       (
                                       2
                                       )
                                    
                                 
                              
                            can be optimized simultaneously. The proof is completed.□


                     Theorems 1 and 2 show that, in some special cases, the optimal solution of the HADFSP-TFT can be obtained by the SPT rules.

For small size instances of the HADFSP-TFT, the optimal solutions can be obtained by solving the MIP model. However, it is difficult to obtain an optimal or near-optimal solution within a reasonable computational time by the proposed MIP model for the medium and large size instances of the HADFSP. Therefore, in the next section, we proposed two fast heuristics (SPT-based algorithm and NEH-based algorithm) and three hybrid meta-heuristics (HGA-VNS, HEDA-VNS and HDDE-VNS) for solving the medium- and large size instances of the problem.

In this section, we present two fast heuristics, three meta-heuristics and a lower bound for the HADFSP-TFT. At first, two fast heuristics (SPT-based algorithm and NEH-based algorithm), are presented in Section 3.1. Then, three meta-heuristics are developed in Sections 3.2–3.4. The first one is a hybrid genetic algorithm-variable neighborhood search (HGA-VNS) algorithm which is presented in Section 3.2. The second one proposed in Section 3.3 is a hybrid differential evolution algorithm with VNS local search (HDDE-VNS). In Section 3.4, a hybrid estimation of distributed algorithm with VNS-based local search (HEDA-VNS) is designed. Finally, in order to evaluate the proposed algorithms, a lower bound for the HADFSP-TFT is developed in Section 3.5.

Inspired by the fact that SPT rules guarantees the optimum for the single machine case (Pinedo, 2002), combining with the hybrid assembly-differentiation flow shop environments, we proposed a SPT-based heuristic for the HADFSP-TFT as follows.


                        SPT-based heuristic:
                           
                              
                                 Step 1: Generate six job sequences S
                                 1, S
                                 2, S
                                 3, S
                                 4, S
                                 5 and S
                                 6 in increasing orders of 
                                    
                                       
                                          
                                             max
                                          
                                          
                                             k
                                             =
                                             1
                                             ,
                                             2
                                             ,
                                             …
                                             ,
                                             m
                                          
                                       
                                       {
                                       
                                          
                                             p
                                          
                                          
                                             j
                                             ,
                                             k
                                          
                                          
                                             (
                                             1
                                             )
                                          
                                       
                                       }
                                       ,
                                       
                                          
                                             p
                                          
                                          
                                             j
                                          
                                          
                                             (
                                             2
                                             )
                                          
                                       
                                       ,
                                       
                                          
                                             p
                                          
                                          
                                             j
                                             ,
                                             h
                                          
                                          
                                             (
                                             3
                                             )
                                          
                                       
                                       ,
                                       
                                          
                                             max
                                          
                                          
                                             k
                                             =
                                             1
                                             ,
                                             2
                                             ,
                                             …
                                             ,
                                             m
                                          
                                       
                                       {
                                       
                                          
                                             p
                                          
                                          
                                             j
                                             ,
                                             k
                                          
                                          
                                             (
                                             1
                                             )
                                          
                                       
                                       }
                                       +
                                       
                                          
                                             p
                                          
                                          
                                             j
                                          
                                          
                                             (
                                             2
                                             )
                                          
                                       
                                       ,
                                       
                                          
                                             p
                                          
                                          
                                             j
                                          
                                          
                                             (
                                             2
                                             )
                                          
                                       
                                       +
                                       
                                          
                                             p
                                          
                                          
                                             j
                                             ,
                                             h
                                          
                                          
                                             (
                                             3
                                             )
                                          
                                       
                                    
                                 , and 
                                    
                                       
                                          
                                             max
                                          
                                          
                                             k
                                             =
                                             1
                                             ,
                                             2
                                             ,
                                             …
                                             ,
                                             m
                                          
                                       
                                       {
                                       
                                          
                                             p
                                          
                                          
                                             j
                                             ,
                                             k
                                          
                                          
                                             (
                                             1
                                             )
                                          
                                       
                                       }
                                       +
                                       
                                          
                                             p
                                          
                                          
                                             j
                                          
                                          
                                             (
                                             2
                                             )
                                          
                                       
                                       +
                                       
                                          
                                             p
                                          
                                          
                                             j
                                             ,
                                             h
                                          
                                          
                                             (
                                             3
                                             )
                                          
                                       
                                    
                                 , respectively.


                                 Step 2: Select the best one of the six job sequences as the solution. Then output it and its TFT value.

For multi-stage permutation flow shop scheduling problem, the NEH heuristic can be adapted to solve not just for the makespan objective but also for the TFT objective (Brah & Loo, 1999; Framian, Leistenb, & Ruiz-Usanoa, 2002; Nawz, Enscore, & Ham, 1983). Thus, in order to get a fast solution for our problem, we also designed a NEH-based heuristics. The basic steps of the NEH-based heuristic are as follows.


                        NEH-based heuristic:
                           
                              
                                 
                                 
                                    
                                       
                                          Step 1: Obtain a job sequence S
                                          0 in ascending order of 
                                             
                                                
                                                   
                                                      max
                                                   
                                                   
                                                      k
                                                      =
                                                      1
                                                      ,
                                                      2
                                                      ,
                                                      …
                                                      ,
                                                      m
                                                   
                                                
                                                {
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      j
                                                      ,
                                                      k
                                                   
                                                   
                                                      (
                                                      1
                                                      )
                                                   
                                                
                                                }
                                                +
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      (
                                                      2
                                                      )
                                                   
                                                
                                                +
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      j
                                                      ,
                                                      h
                                                   
                                                   
                                                      (
                                                      3
                                                      )
                                                   
                                                
                                                ,
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      j
                                                   
                                                
                                                ∈
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      h
                                                   
                                                
                                             
                                          , j
                                          =1,2,…,
                                          n.
                                    
                                    
                                       
                                          Step 2: Set r
                                          =2. Select the first two jobs from S
                                          0 and schedule them to minimize the total flow time as if there are only two jobs. Set the best one as a current solution S
                                          1.
                                    
                                    
                                       
                                          Step 3: While r
                                          <
                                          n
                                          +1 do
                                    
                                    
                                       
                                          
                                          Set r
                                          ←
                                          r
                                          +1. Generate r candidate sequences by inserting the rth job in the job sequence S
                                          0 in each slot of the current solution. Select the best one with the least partial total flow time. Update the best one as a current solution S
                                          1.
                                    
                                    
                                       
                                          End while
                                    
                                    
                                       
                                          Step 4: Output the current solution S
                                          1 and its TFT value.
                                    
                                 
                              
                           
                        
                     

The two heuristics (SPT-based algorithm and NEH-based algorithm) serves not only the base for performance comparisons but also the initial solution for the meta-heuristics.

Genetic algorithm (GA) is a population-based optimization method which has been proved to be effective for many combinatorial optimization problems (Murata et al., 1996; Ruiz, Maroto, & Alcaraz, 2006; Giovanni & Pezzella, 2010; Jia, Fuh, Nee, & Zhang, 2007; Xing, Han, Zhou, & Wang, 2012). At first, genetic algorithms generate initial population of individuals that will be evaluated. When the evolution of individuals is performed, the operations such as selection, crossover and mutation are carried out to generate a new generation of individuals. For the solution to escape from the local optima, a VNS-based local search procedure is performed on each individual with a probability PM, and then another one is performed on the best individual. The main part of the HGA-VNS is comprised of chromosome representation and population initialization, selection, VNS-based local search, crossover, and mutation, etc. These parts will be introduced in the following subsections.

In our HGA-VNS algorithm, a chromosome is encoded as a permutation sequence of n jobs.


                           Fig. 3
                            shows an example of solution representation of the HADFSP-TFT with 10 jobs. Assume that the jobs belong to three different types: N
                           1
                           ={J
                           1,
                           J
                           2,
                           J
                           3}, N
                           2
                           ={J
                           4,
                           J
                           5,
                           J
                           6,
                           J
                           7}, and N
                           3
                           ={J
                           8,
                           J
                           9,
                           J
                           10}. The job sequence on each machine at the first stage is the same as that at the second stage. At the third stage, the jobs belong to the same type will be processed on a special dedicated machine. Fig. 4
                            shows an example of the decoding process. It can be seen from Fig. 4 that at the last stage the jobs (1, 2 and 3) belongs to type 1 are assigned to M
                           3,1; The jobs (4, 5, 6, and 7) belongs to type 2 are assigned to M
                           3,2; The jobs (8, 9, and 10) belongs to type 3 are assigned to M
                           3,3. It also can be seen from Fig. 4 that the job sequences on machine M
                           3,1, M
                           3,2 and M
                           3,3 are (123), (4576), and (1098), respectively.

Let 
                              
                                 PS
                              
                            denote the population size. In our experiments, we construct two permutation sequences by using the SPT-based algorithm and the NEH-based algorithm, respectively, and then select the better one as an initial solution. Subsequently, the remaining PS
                           −1 solutions of the population are randomly generated.

In the developed HGA-VNS algorithm, we evaluate the chromosome’s fitness value by the following equations:
                              
                                 (22)
                                 
                                    fit
                                    (
                                    
                                       
                                          chm
                                       
                                       
                                          j
                                       
                                    
                                    )
                                    =
                                    
                                       
                                          Max
                                          {
                                          TFT
                                          (
                                          
                                             
                                                chm
                                             
                                             
                                                j
                                             
                                          
                                          )
                                          }
                                          -
                                          TFT
                                          (
                                          
                                             
                                                chm
                                             
                                             
                                                j
                                             
                                          
                                          )
                                          +
                                          1
                                       
                                       
                                          Max
                                          {
                                          TFT
                                          (
                                          
                                             
                                                chm
                                             
                                             
                                                j
                                             
                                          
                                          )
                                          }
                                          -
                                          Min
                                          {
                                          TFT
                                          (
                                          
                                             
                                                chm
                                             
                                             
                                                j
                                             
                                          
                                          )
                                          }
                                          +
                                          1
                                       
                                    
                                    ,
                                    
                                    j
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    PS
                                 
                              
                           where TFT(⋅) is the objective function of chromosome chmj
                           ; TFT(chmj
                           ) is the objective function value of chromosome chmj
                           ; fit(chmj
                           ) is the fitness value of chromosome chmj
                           ; Max{TFT(chmj
                           )} and Min{TFT(chmj
                           )} denote the maximum and minimum objective function values of the population in current generation, respectively.

Variable neighborhood search (VNS) is a meta-heuristic for solving global and combinatorial optimization problems whose basic idea is to enhance the performance of a local search method by systematic changing the neighborhood structure (Mladenovic & Hansen, 1997). Applications of VNS are rapidly increasing in many combinatorial optimization fields (Hansen & Mladenovic, 2001; Lejeune, 2006; Liao & Cheng, 2007; Roshanaei, Naderi, Jolai, & Khalili, 2009; Yazdani, Amiri, & Zandieh, 2010). Aiming at achieving a well balance between local search and global search, two kinds of VNS-based local search methods (VNSL-I and VNSL-II) are used in our hybrid GA algorithm. In VNSL-I, two neighborhood operators (Insert and Swap) are applied alternately on each individual with a probability PM, whereas in VNSL-II, four neighborhood operators alternately (Insert, Swap, Inverse and Or-Opt) are used alternately on the best individual of the current generation.

Let x
                           =[x
                           1,
                           x
                           2,…,
                           xn
                           ] denote a solution for an instance of the HADFSP-TFT, where xi
                            is job index in position i. The four neighborhood operators (Insert, Swap, Inverse, and Or-Opt) are defined as follows:
                              
                                 (1)
                                 
                                    Insert(x,
                                    u,
                                    v): Insert move.

The process of insert move is as follows. Move the job in position u to position v, whereas all jobs in position k, with k
                           =
                           u
                           +1,…,
                           v, are shifted one position forward along solution x. Fig. 5
                            shows an example of insert operation. u
                           =3 and v
                           =8 are two positions which are chosen in a solution x
                           =[41571069283]. Move the job in position 3 (job 5) to position 8, whereas all jobs in position k, with k
                           =4, 5, 6, 7, 8, are shifted one position forward along the solution. Then a new solution x′=[41710692583] is obtained.
                              
                                 (2)
                                 
                                    Swap(x,
                                    u,
                                    v): Swap move.

The swap move is to swap the job in position u and the job in position v of solution x. Fig. 6
                            illustrates an example of the swap operation. In Fig. 6, u
                           =3 and v
                           =8 are two positions which are chosen in a solution x
                           =[41571069283]. Move the job in position 3 (job 5) to position 8. Simultaneously, move the job in position 7 (job 2) to position 3. Then a new solution x′=[41271069583] is obtained.
                              
                                 (3)
                                 
                                    Inverse(x,
                                    u,
                                    v): Inverse move.

The inverse move is to inverse the jobs between positions u and v of solution x. Fig. 7
                            shows an example of inverse operation. u
                           =3 and v
                           =8 are two positions which are chosen in a solution x
                           =[41571069283]. At first, the jobs between positions 3 and 8 are inversed. Then a new solution x′=[41296107583] is obtained.
                              
                                 (4)
                                 
                                    Or-opt(x,
                                    u,
                                    v): Or-opt move.

The process of Or-opt move is as follows. Insert the job in position u and the job in position u
                           +1 between position v and v
                           +1, whereas all jobs in position k, with k
                           =
                           u
                           +2,…,
                           v, are shifted two positions forward along solution x. Fig. 8
                            shows an example of or-opt operation. u
                           =3 and v
                           =8 are two positions which are chosen in a solution x
                           =[41571069283]. Move jobs in position 3 and 4 to positions 7 and 8, respectively, whereas all jobs in position k, with k
                           =5, 6, 7, 8 are shifted two positions forward along the solution. Then a new solution x
                           =[41106925783] is obtained.

The procedure of VNSL-I is as follows.
                              
                                 
                                    
                                    
                                       
                                          
                                             Step 1: Input initial solution x and set maximum iteration number Iter1.
                                       
                                       
                                          
                                             Step 2: Set loop
                                             ←0 and flag
                                             ←0.
                                       
                                       
                                          
                                             Step 3: While loop
                                             <
                                             Iter1 do
                                       
                                       
                                          
                                             
                                             
                                             Step 3.1: Randomly choose two positions u and v, where u
                                             <
                                             v.
                                       
                                       
                                          
                                             
                                             
                                             Step 3.2: If flag
                                             ==0, then x′←
                                             Insert(x,
                                             u,
                                             v);
                                       
                                       
                                          
                                             
                                             
                                             Else x′←
                                             Swap(x,
                                             u,
                                             v);
                                       
                                       
                                          
                                             
                                             
                                             End If
                                       
                                       
                                          
                                             
                                             
                                             Step 3.3: If TFT(x′)<TFT(x), then x
                                             ←
                                             x′, flag
                                             ←0;
                                       
                                       
                                          
                                             
                                             
                                             Else flag
                                             ←(flag
                                             +1) mod 2;
                                       
                                       
                                          
                                             
                                             
                                             End If
                                       
                                       
                                          
                                             
                                             
                                             Step 3.4: loop
                                             ←
                                             loop
                                             +1.
                                       
                                       
                                          
                                             End While
                                       
                                    
                                 
                              
                           
                        

The procedure of VNSL-II is as follows.
                              
                                 
                                    
                                    
                                       
                                          
                                             Step 1: Input initial solution x and set maximum iteration number Iter2.
                                       
                                       
                                          
                                             Step 2: Set loop
                                             ←0 and flag
                                             ←0.
                                       
                                       
                                          
                                             Step 3: While loop
                                             <
                                             Iter2 do
                                       
                                       
                                          
                                             
                                             
                                             Step 3.1: Randomly choose two positions u and v, where u
                                             <
                                             v.
                                       
                                       
                                          
                                             
                                             
                                             Step 3.2: If flag
                                             ==0, then x′←
                                             Insert(x,
                                             u,
                                             v);
                                       
                                       
                                          
                                             
                                             
                                             Elseif flag
                                             ==1 then x′←
                                             Swap(x,
                                             u,
                                             v);
                                       
                                       
                                          
                                             
                                             
                                             Elseif flag
                                             ==2 then x′←
                                             Inverse(x,
                                             u,
                                             v);
                                       
                                       
                                          
                                             
                                             
                                             Else x′←
                                             Or-opt(x,
                                             u,
                                             v);
                                       
                                       
                                          
                                             
                                             
                                             End If
                                       
                                       
                                          
                                             
                                             
                                             Step 3.3: If TFT(x′)<TFT(x), then x
                                             ←
                                             x′, flag
                                             ←0;
                                       
                                       
                                          
                                             
                                             
                                             Else flag
                                             ←(flag
                                             +1) mod 4;
                                       
                                       
                                          
                                             
                                             
                                             End If
                                       
                                       
                                          
                                             
                                             
                                             Step 3.4: loop
                                             ←
                                             loop
                                             +1.
                                       
                                       
                                          
                                             End While
                                       
                                    
                                 
                              
                           
                        

The selection phase is to choose the chromosome for reproduction. In our approach, the roulette-wheel method is applied to select the chromosome. It uses a probability distribution for selection in which the selection probability of a given schedule is proportional to its fitness.

When the chromosomes for reproduction have been selected, the crossover and mutation operators are used to produce the offspring. Crossover operator is applied to generate offspring by exchanging some genes of two parents, while mutation operator is performed on single individuals.

Many crossover operators had been proposed in recent years. In this paper, the two-point crossover methods are used since its effectiveness on the permutation-based scheduling problem (Murata et al., 1996). Fig. 9
                            shows an example of the two-point crossover method. It can be seen from the figure that the jobs between two randomly selected positions u
                           =4 and v=
                           7 are always inherited from one parent to a child, and the other jobs are placed in the order of their appearance in the other parent.

Mutation operation can be seen as a perturbation to the individual during the evolution process and it is essential to avoid falling into local optimum. In our method, mutation operation is randomly chosen from three kinds of operators (insert, swap and inverse) for each individual.


                           Fig. 10
                            shows the flowchart of the proposed HGA-VNS algorithm.

In this section, at first basic differential evolution algorithm (DE) is introduced in Section 3.3.1. Subsequently, a hybrid discrete DE with VNS-based local search is presented in Section 3.3.2.

The differential evolution algorithm (DE), proposed by Storn and Price (1995), is a stochastic population-based meta-heuristic which operates in continuous search spaces. It is mainly comprised of four steps: initialization, mutation, crossover and selection. In a DE, a real-valued encoding method is developed for each individual. At first, PS target individuals are randomly generated as a population. Secondly, mutation and crossover operators are performed on them and then PS new individuals are generated. Finally, the new target individuals are selected to the next generation by selection operators. These steps continue until a stop criterion is met. Let Xi
                           
                           ,
                           
                              ge
                           
                           =[xi
                           
                           ,1,
                           
                              ge
                           ,
                           xi
                           
                           ,2,
                           
                              ge
                           ,…,
                           xi
                           
                           ,
                           
                              n
                           
                           ,
                           
                              ge
                           ], Vi
                           
                           ,
                           
                              ge
                           
                           =[vi
                           
                           ,1,
                           
                              ge
                           ,
                           vi
                           
                           ,2,
                           
                              ge
                           ,…,
                           vi
                           
                           ,
                           
                              n
                           
                           ,
                           
                              ge
                           ] and Ui
                           
                           ,
                           
                              ge
                           
                           =[ui
                           
                           ,1,
                           
                              ge
                           ,
                           ui
                           
                           ,2,
                           
                              ge
                           ,…,
                           ui
                           
                           ,
                           
                              n
                           
                           ,
                           
                              ge
                           ] represent the ith target individual, the ith mutant individual and the ith trial individual at iteration ge, respectively. The procedure of the basic DE algorithm is as follows.
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             Step 1:
                                          
                                          Initialization. Set the population size (PS), scale factor (F), crossover probability (CR), and the maximum iterations g_max. Randomly generate PS individuals of a population. Let bestit be the best individual found so far, and ge
                                             ←0.
                                       
                                       
                                          
                                             Step 2:
                                          
                                          While ge
                                             <
                                             g_max do
                                       
                                       
                                          
                                          
                                             
                                             Step 2.1: Mutation phase. Mutant individual Vi,ge
                                             , is generated as follows:
                                       
                                       
                                          
                                          
                                             
                                                
                                                   (23)
                                                   
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            i
                                                            ,
                                                            ge
                                                         
                                                      
                                                      ←
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            a
                                                            ,
                                                            ge
                                                         
                                                      
                                                      +
                                                      F
                                                      ×
                                                      (
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            b
                                                            ,
                                                            ge
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            c
                                                            ,
                                                            ge
                                                         
                                                      
                                                      )
                                                      ,
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                             where i
                                             =1,2,…,
                                             PS, a, b and c are three different integers randomly selected between [1,
                                             PS].
                                       
                                       
                                          
                                          
                                             
                                             Step 2.2: Crossover phase. Trial individual Ui
                                             
                                             ,
                                             
                                                ge
                                              is generated as follows:
                                       
                                       
                                          
                                          
                                             
                                                
                                                   (24)
                                                   
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            i
                                                            ,
                                                            j
                                                            ,
                                                            ge
                                                            +
                                                            1
                                                         
                                                      
                                                      ←
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              v
                                                                           
                                                                           
                                                                              i
                                                                              ,
                                                                              j
                                                                              ,
                                                                              ge
                                                                              +
                                                                              1
                                                                           
                                                                        
                                                                        ,
                                                                     
                                                                     
                                                                        if
                                                                        
                                                                        (
                                                                        rand
                                                                        ⩽
                                                                        CR
                                                                        )
                                                                        
                                                                        or
                                                                        
                                                                        j
                                                                        =
                                                                        
                                                                           
                                                                              E
                                                                           
                                                                           
                                                                              j
                                                                           
                                                                        
                                                                        ,
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              x
                                                                           
                                                                           
                                                                              i
                                                                              ,
                                                                              j
                                                                              ,
                                                                              ge
                                                                           
                                                                        
                                                                        ,
                                                                     
                                                                     
                                                                        otherwise.
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                             where i
                                             =1,2,…,
                                             PS, 
                                                
                                                   CR
                                                   ∈
                                                   (
                                                   0
                                                   ,
                                                   1
                                                   )
                                                
                                              is a crossover probability, rand is a uniform random number between [0,1), and Ej
                                              denotes an integer randomly chosen between [1,
                                             n].
                                       
                                       
                                          
                                          
                                             
                                             Step 2.3: Selection phase. Each new target individual is selected as follows:
                                       
                                       
                                          
                                          
                                             
                                                
                                                   (25)
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            i
                                                            ,
                                                            ge
                                                            +
                                                            1
                                                         
                                                      
                                                      ←
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              U
                                                                           
                                                                           
                                                                              i
                                                                              ,
                                                                              ge
                                                                              +
                                                                              1
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        if
                                                                        
                                                                        f
                                                                        (
                                                                        
                                                                           
                                                                              U
                                                                           
                                                                           
                                                                              i
                                                                              ,
                                                                              ge
                                                                              +
                                                                              1
                                                                           
                                                                        
                                                                        )
                                                                        <
                                                                        f
                                                                        (
                                                                        
                                                                           
                                                                              X
                                                                           
                                                                           
                                                                              i
                                                                              ,
                                                                              ge
                                                                           
                                                                        
                                                                        )
                                                                        ,
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              X
                                                                           
                                                                           
                                                                              i
                                                                              ,
                                                                              ge
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        otherwise
                                                                        ,
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                             where f (⋅) is the objective function.
                                       
                                       
                                          
                                          
                                             
                                             Step 2.4: update bestit and f(bestit).
                                       
                                       
                                          
                                          
                                             
                                             Step 2.5: Set ge
                                             ←
                                             ge
                                             +1.
                                       
                                       
                                          
                                          End While
                                       
                                       
                                          
                                             Step 3:
                                          
                                          Output bestit and f (bestit).
                                       
                                    
                                 
                              
                           
                        

Since permutation job sequence cannot be generated by the basic DE algorithm which is originally designed for continuous optimization problems, we proposed a hybrid discrete differential evolution algorithm combined with VNS-based local search (HDDE-VNS) for the HADFSP-TFT. In our approach, solution representation, initialization, and VNS-based local search are the same as those in HGA-VNS. Mutation, crossover, selection and flowchart of the HDDE-VNS will be presented in detail as follows.
                              
                                 (1)
                                 Mutation operator

In our HDDE-VNS, mutation operator is adopted as follows.
                              
                                 (26)
                                 
                                    
                                       
                                          V
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    
                                       
                                          X
                                       
                                       
                                          a
                                       
                                    
                                    ⊕
                                    F
                                    ⊗
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          b
                                       
                                    
                                    ⊖
                                    
                                       
                                          X
                                       
                                       
                                          c
                                       
                                    
                                    )
                                    ,
                                 
                              
                           where 
                              
                                 ⊖
                              
                           , 
                              
                                 ⊗
                              
                            and 
                              
                                 ⊕
                              
                            denote three operators, namely subtraction, multiplication, and addition operators, respectively, and they are defined as follows.
                              Definition 1
                              Subtraction operator 
                                    
                                       ⊖
                                    
                                 
                              


                              Let X
                                 1
                                 =[x
                                 1,1,
                                 x
                                 1,2,…,x
                                 1,
                                 
                                    n
                                 ] and X
                                 2
                                 =[x
                                 2,1,
                                 x
                                 2,2,…,
                                 x
                                 2,
                                 
                                    n
                                 ] be two n dimension vectors where 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             1
                                             ,
                                             j
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             2
                                             ,
                                             j
                                          
                                       
                                       ∈
                                       {
                                       1
                                       ,
                                       2
                                       ,
                                       …
                                       ,
                                       n
                                       }
                                    
                                 . Define X
                                 1
                                 
                                 
                                    
                                       ⊖
                                    
                                 
                                 
                                 X
                                 2 to be an n dimension vector Ω
                                 =[ω
                                 1,
                                 ω
                                 2,…,
                                 ωn
                                 ], where ωj
                                 
                                 =
                                 x
                                 1,
                                 
                                    j
                                  if x
                                 1,
                                 
                                    j
                                 
                                 ≠
                                 x
                                 2,
                                 
                                    j
                                 ; ωj
                                 
                                 =0, otherwise.

Let X
                                 =(x
                                 1,
                                 x
                                 2,…,
                                 xn
                                 ) be an n dimension vector where 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             j
                                          
                                       
                                       ∈
                                       {
                                       0
                                       ,
                                       1
                                       ,
                                       2
                                       ,
                                       …
                                       ,
                                       n
                                       }
                                    
                                 , c
                                 =(c
                                 1,
                                 c
                                 2,…,
                                 cn
                                 ) be an n dimension vector where cj
                                  is a uniform random number generated between [0,1] and z be a real number between (0,1). Define 
                                    
                                       z
                                       ⊗
                                       X
                                    
                                  to be an n dimension vector Δ
                                 =(δ
                                 1,
                                 δ
                                 2,…,
                                 δn
                                 ) where δj
                                 
                                 =
                                 xj
                                  if z
                                 >
                                 cj
                                 ; δj
                                 
                                 =0, otherwise.

Let X
                                 1
                                 =(x
                                 1,1,
                                 x
                                 1,2,…,
                                 x
                                 1,
                                 
                                    n
                                 ) and Δ
                                 =(δ
                                 1,
                                 δ
                                 2,…,
                                 δn
                                 ) be two n dimension vectors where 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             1
                                             ,
                                             j
                                          
                                       
                                       ∈
                                       {
                                       1
                                       ,
                                       2
                                       ,
                                       …
                                       ,
                                       n
                                       }
                                    
                                  and 
                                    
                                       
                                          
                                             δ
                                          
                                          
                                             j
                                          
                                       
                                       ∈
                                       {
                                       0
                                       ,
                                       1
                                       ,
                                       2
                                       ,
                                       …
                                       ,
                                       n
                                       }
                                    
                                 , j
                                 =1,2,…,
                                 n. Define 
                                    
                                       
                                          
                                             X
                                          
                                          
                                             1
                                          
                                       
                                       ⊕
                                       Δ
                                    
                                  to be an n dimension vector V
                                 =(v
                                 1,
                                 v
                                 2,…,
                                 vn
                                 ), where 
                                    
                                       
                                          
                                             v
                                          
                                          
                                             j
                                          
                                       
                                       ∈
                                       {
                                       1
                                       ,
                                       2
                                       ,
                                       …
                                       ,
                                       n
                                       }
                                    
                                 . V is computed as follows. At first, set vj
                                 
                                 =
                                 x
                                 1,
                                 
                                    j
                                 , j
                                 =1,2,…,
                                 n. Then compare vj
                                  and δj
                                  for each 
                                    
                                       j
                                       ∈
                                       {
                                       1
                                       ,
                                       2
                                       ,
                                       …
                                       ,
                                       n
                                       }
                                    
                                 . If δj
                                 
                                 ≠0, find the position j′ in which vj
                                 
                                 ′
                                 =
                                 δj
                                 , and then swap vj
                                  and vj
                                 
                                 ′; otherwise, vj
                                  remains unchanged.

Therefore, the mutation operator can be performed on the proposed individual by Definitions 1–3 and formula (26). For easy understanding, a simple example for the mutation operation is illustrated as follows. Suppose that n
                           =5, F
                           =0.5, X
                           1
                           =[2,4,3,5,1], X
                           2
                           =[3,5,2,1,4] and X
                           3
                           =[5,1,2,4,3]. Let Ω
                           =
                           X
                           2
                           
                           
                           X
                           3
                           =(ω
                           1,
                           ω
                           2,
                           ω
                           3,
                           ω
                           4,
                           ω
                           5), Δ
                           =
                           F
                           
                           
                              
                                 ⊗
                              
                           
                           
                           Ω
                           =(δ
                           1,
                           δ
                           2,
                           δ
                           3,
                           δ
                           4,
                           δ
                           5), and V
                           =
                           X
                           1
                           
                           
                              
                                 ⊕
                              
                           
                           
                           Δ
                           =(v
                           1,
                           v
                           2,
                           v
                           3,
                           v
                           4,
                           v
                           5).

At first, Ω
                           =
                           X
                           2
                           
                           
                           X
                           3 can be calculated by comparing each position of X
                           2 and X
                           3 from left to right. If x
                           2,
                           
                              j
                           
                           ==
                           x
                           3,
                           
                              j
                           , ωj
                              
                           =0; otherwise, ωj
                              
                           =
                           x
                           2,
                           
                              j
                           . For example, at the first position, x
                           2,1
                           =3≠
                           x
                           3,1
                           =5. Thus, we have ω
                           1
                           =
                           x
                           2,1
                           =3. At the second position, x
                           2,2
                           =5≠
                           x
                           3,2
                           =1, we have ω
                           2
                           =
                           x
                           2,2
                           =5. At the third position, x
                           2,3
                           =
                           x
                           3,3
                           =2, we have ω
                           3
                           =0. The other positions of Ω can be determined by the same approach. After comparing all the positions, we derive Ω
                           =[3,5,0,1,4].

Secondly, we calculate Δ. Suppose that F
                           =0.5 and randomly generated a vector c
                           =[c
                           1,
                           c
                           2,
                           c
                           3,
                           c
                           4,
                           c
                           5]=[0.4067,0.9355,0.8169,0.4103,0.6936]. Δ can be obtained by Definition 2. For example, at the first position, F
                           >
                           c
                           1, we have δ
                           1
                           =3; at the second position, F
                           <
                           c
                           1, we have δ
                           2
                           =0. After computing all the positions, we obtain Δ
                           =[3,0,0,0,4].

Finally, we calculate V
                           =
                           X
                           1
                           
                           
                              
                                 ⊕
                              
                           
                           
                           Δ. At the first position, since x
                           1,1
                           =2 and δ
                           1
                           =3, find the position j in which xj
                              
                           =3. Obviously, the position j
                           =3. Then swap jobs in position 1 and 3, we have a new vector [3,4,2,5,1]. At the second position, since x
                           1,2
                           =4, and δ
                           2
                           =0, the job in the second position of the new vector will not be changed. The jobs in other positions can be determined by the same approach as above. After determining all positions, we have V
                           =[3,1,2,5,4].
                              
                                 (1)
                                 Crossover operator

In our HDDE-VNS, the similar crossover operator as that of in HGA-VNS is adopted and the crossover points are selected with a probability CR. An example of the crossover operation for HDDE-VNS is shown in Fig. 11
                           , where CR is set to 0.5. It can be seen that the jobs in position 2, 3, 6 and 9, which are randomly chosen with the crossover probability CR, are always inherited from one target individual Vi
                            to a trial individual, and the other jobs are placed in according with the order of their appearance in the mutant individual Xi
                           .
                              
                                 (3)
                                 Flowchart of the proposed HDDE-VNS algorithm


                           Fig. 12
                            illustrates the flowchart of the proposed HDDE-VNS algorithm for the HADFSP-TFT. In the algorithm, each new target individual is selected according to formula (25).

EDA is a stochastic population-based heuristic for global optimization that explores the space of potential solutions by building and sample explicit probabilistic models of promising candidate solutions (Muhlenbein & Paass, 1996). EDA has been successfully applied to many combinatorial optimization problems (Chen & Chen, 2013; Hauschild & Pelikan, 2011; Jarboui, Eddaly, & Siarry, 2009; Pan & Ruiz, 2012; Wang et al., 2012). The Framework of the basic EDA can be presented as follows (Muhlenbein & Paass, 1996). Repeat the following steps until a stopping criterion is met. Starting with a randomly generated initial population which including PS individuals. Subsequently, subpopulation of Sub_PS parent individuals are selected through a selection method based on the fitness function. Next, a probabilistic model is established by estimating the probability of distribution of the selected parents. Then, new individuals are generated by sampling the probabilistic model. Finally, some individuals in the current population are replaced with newly generated offspring.

Recently, Wang, Wang, Liu, and Xu (2013) proposed a simple and effective probability model for solving permutation-based scheduling problems such as hybrid flowshop scheduling and distributed permutation flowshop scheduling. They designed the probability model as a probability matrix PR. The element pri
                        
                        ,
                        
                           j
                         of the probability matrix PR represents the probability that job j appears in or before position i of the solution sequence at generation ge. The value of prij
                         implies the importance of a job when deciding the job order. For all i and j, pri
                        
                        ,
                        
                           j
                         is initialized to pri
                        
                        ,
                        
                           j
                        (0)=1/n.

For each generation, the probability matrix PR is updated as follows (Wang et al., 2013).
                           
                              (27)
                              
                                 
                                    
                                       pr
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 (
                                 ge
                                 +
                                 1
                                 )
                                 =
                                 (
                                 1
                                 -
                                 θ
                                 )
                                 
                                    
                                       pr
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 (
                                 ge
                                 )
                                 +
                                 
                                    
                                       θ
                                    
                                    
                                       i
                                       ×
                                       Sub
                                       _
                                       PS
                                    
                                 
                                 ×
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          Sub
                                          _
                                          PS
                                       
                                    
                                 
                                 
                                    
                                       ρ
                                    
                                    
                                       i
                                       ,
                                       j
                                       ,
                                       k
                                    
                                 
                                 (
                                 ge
                                 +
                                 1
                                 )
                                 ,
                                 
                                 ∀
                                 
                                 i
                                 ,
                                 j
                                 ,
                              
                           
                        where ρi
                        
                        ,
                        
                           j
                        
                        ,
                        
                           k
                         is the indicator function of the kth individual in the sub-population. ρi
                        
                        ,
                        
                           j
                        
                        ,
                        
                           k
                         is 1 if job j appear in or before position i; 0, otherwise. θ is the learning rate of PR.

In this paper, we designed a hybrid EDA combined with VNS-based local search method (HEDA-VNS). In our approach, solution representation and initialization are the same as those in HGA-VNS and HDDE-VNS. We applied the same probability model as that in Wang et al. (2013) owing to its effectiveness for solving permutation-based scheduling problems. In each generation of our HEDA-VNS, VNSL-II is performed on the best individual. Fig. 13
                         shows the flowchart of HEDA-VNS.

In this section, we develop a lower bound for the HADFSP-TFT. The lower bound is used for evaluating the performances of the proposed heuristics or meta-heuristics when the exact solution cannot be obtained within a reasonable computation time. The lower bound is based on the condition that there is no wait for differentiation machines at the third stage.
                           Lemma 3
                           
                              Consider a hybrid assembly-differentiation flowshop scheduling problem. The value 
                              
                                 
                                    
                                       
                                          LB
                                       
                                       
                                          3
                                       
                                       
                                          (
                                          2
                                          )
                                       
                                    
                                 
                               
                              is a lower bound of the term 
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          C
                                       
                                       
                                          j
                                       
                                       
                                          (
                                          2
                                          )
                                       
                                    
                                 
                              
                              , where, 
                              
                                 
                                    
                                       
                                          LB
                                       
                                       
                                          3
                                       
                                       
                                          (
                                          2
                                          )
                                       
                                    
                                    =
                                    max
                                    {
                                    
                                       
                                          LB
                                       
                                       
                                          1
                                       
                                       
                                          (
                                          2
                                          )
                                       
                                    
                                    ,
                                    
                                       
                                          LB
                                       
                                       
                                          2
                                       
                                       
                                          (
                                          2
                                          )
                                       
                                    
                                    }
                                    ,
                                    
                                       
                                          LB
                                       
                                       
                                          1
                                       
                                       
                                          (
                                          2
                                          )
                                       
                                    
                                    =
                                    n
                                    ·
                                    
                                       
                                          r
                                       
                                       
                                          (
                                          1
                                          )
                                          ,
                                          k
                                       
                                       
                                          (
                                          1
                                          )
                                       
                                    
                                    +
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    (
                                    n
                                    -
                                    t
                                    +
                                    1
                                    )
                                    ·
                                    
                                       
                                          p
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       
                                          (
                                          2
                                          )
                                       
                                    
                                 
                               
                              and 
                              
                                 
                                    
                                       
                                          LB
                                       
                                       
                                          2
                                       
                                       
                                          (
                                          2
                                          )
                                       
                                    
                                    =
                                    
                                       
                                          max
                                       
                                       
                                          k
                                          =
                                          1
                                          ,
                                          2
                                          ,
                                          …
                                          ,
                                          m
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   s
                                                   =
                                                   1
                                                
                                                
                                                   n
                                                
                                             
                                             (
                                             n
                                             -
                                             s
                                             +
                                             1
                                             )
                                             ·
                                             
                                                
                                                   p
                                                
                                                
                                                   (
                                                   s
                                                   )
                                                   ,
                                                   k
                                                
                                                
                                                   (
                                                   1
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          p
                                       
                                       
                                          j
                                       
                                       
                                          (
                                          2
                                          )
                                       
                                    
                                    .
                                    
                                       
                                          p
                                       
                                       
                                          (
                                          s
                                          )
                                          ,
                                          k
                                       
                                       
                                          (
                                          1
                                          )
                                       
                                    
                                    ,
                                    
                                       
                                          p
                                       
                                       
                                          (
                                          s
                                          )
                                       
                                       
                                          (
                                          2
                                          )
                                       
                                    
                                 
                               
                              and 
                              
                                 
                                    
                                       
                                          r
                                       
                                       
                                          (
                                          s
                                          )
                                          ,
                                          k
                                       
                                       
                                          (
                                          1
                                          )
                                       
                                    
                                 
                               
                              are the s-th smallest processing times in 
                              
                                 
                                    {
                                    
                                       
                                          p
                                       
                                       
                                          1
                                          ,
                                          k
                                       
                                       
                                          (
                                          1
                                          )
                                       
                                    
                                    ,
                                    
                                       
                                          p
                                       
                                       
                                          2
                                          ,
                                          k
                                       
                                       
                                          (
                                          1
                                          )
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          p
                                       
                                       
                                          n
                                          ,
                                          k
                                       
                                       
                                          (
                                          1
                                          )
                                       
                                    
                                    }
                                    ,
                                    {
                                    
                                       
                                          p
                                       
                                       
                                          1
                                       
                                       
                                          (
                                          2
                                          )
                                       
                                    
                                    ,
                                    
                                       
                                          p
                                       
                                       
                                          2
                                       
                                       
                                          (
                                          2
                                          )
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          p
                                       
                                       
                                          n
                                       
                                       
                                          (
                                          2
                                          )
                                       
                                    
                                    }
                                 
                               
                              and 
                              
                                 
                                    {
                                    
                                       
                                          max
                                       
                                       
                                          k
                                          =
                                          1
                                          ,
                                          2
                                          ,
                                          …
                                          ,
                                          m
                                       
                                    
                                    {
                                    
                                       
                                          p
                                       
                                       
                                          1
                                          ,
                                          k
                                       
                                       
                                          (
                                          1
                                          )
                                       
                                    
                                    }
                                    ,
                                    
                                       
                                          max
                                       
                                       
                                          k
                                          =
                                          1
                                          ,
                                          2
                                          ,
                                          …
                                          ,
                                          m
                                       
                                    
                                    {
                                    
                                       
                                          p
                                       
                                       
                                          2
                                          ,
                                          k
                                       
                                       
                                          (
                                          1
                                          )
                                       
                                    
                                    }
                                    ,
                                    …
                                    ,
                                    
                                       
                                          max
                                       
                                       
                                          k
                                          =
                                          1
                                          ,
                                          2
                                          ,
                                          …
                                          ,
                                          m
                                       
                                    
                                    {
                                    
                                       
                                          p
                                       
                                       
                                          n
                                          ,
                                          k
                                       
                                       
                                          (
                                          1
                                          )
                                       
                                    
                                    }
                                    }
                                 
                              
                              , respectively, where, 1⩽s⩽n.

In the hybrid assembly-differentiation system, the first two stages can be seen as a two stage assembly flow shop system. The completion time of the job in position i at the second stage can be calculated as follows (Potts et al., 1995).
                                 
                                    (28)
                                    
                                       
                                          
                                             C
                                          
                                          
                                             [
                                             i
                                             ]
                                          
                                          
                                             (
                                             2
                                             )
                                          
                                       
                                       =
                                       
                                          
                                             
                                                max
                                             
                                             
                                                u
                                                =
                                                1
                                                ,
                                                2
                                                ,
                                                …
                                                ,
                                                i
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         max
                                                      
                                                      
                                                         k
                                                         =
                                                         1
                                                         ,
                                                         2
                                                         ,
                                                         …
                                                         ,
                                                         m
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  t
                                                                  =
                                                                  1
                                                               
                                                               
                                                                  u
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               [
                                                               t
                                                               ]
                                                               ,
                                                               k
                                                            
                                                            
                                                               (
                                                               1
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                
                                                +
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         t
                                                         =
                                                         u
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      [
                                                      t
                                                      ]
                                                   
                                                   
                                                      (
                                                      2
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                       .
                                    
                                 
                              It follows that
                                 
                                    (29)
                                    
                                       
                                          
                                             C
                                          
                                          
                                             [
                                             i
                                             ]
                                          
                                          
                                             (
                                             2
                                             )
                                          
                                       
                                       ⩾
                                       
                                          
                                             
                                                max
                                             
                                             
                                                k
                                                =
                                                1
                                                ,
                                                2
                                                ,
                                                …
                                                ,
                                                m
                                             
                                          
                                       
                                       {
                                       
                                          
                                             p
                                          
                                          
                                             [
                                             1
                                             ]
                                             ,
                                             k
                                          
                                          
                                             (
                                             1
                                             )
                                          
                                       
                                       }
                                       +
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                t
                                                =
                                                1
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          
                                             p
                                          
                                          
                                             [
                                             t
                                             ]
                                          
                                          
                                             (
                                             2
                                             )
                                          
                                       
                                       ,
                                       
                                       ∀
                                       
                                       i
                                       =
                                       1
                                       ,
                                       2
                                       ,
                                       …
                                       ,
                                       n
                                       .
                                    
                                 
                              Therefore,
                                 
                                    (30)
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                n
                                             
                                          
                                       
                                       
                                          
                                             C
                                          
                                          
                                             [
                                             i
                                             ]
                                          
                                          
                                             (
                                             2
                                             )
                                          
                                       
                                       ⩾
                                       n
                                       ·
                                       
                                          
                                             
                                                max
                                             
                                             
                                                k
                                                =
                                                1
                                                ,
                                                2
                                                ,
                                                …
                                                ,
                                                m
                                             
                                          
                                       
                                       {
                                       
                                          
                                             p
                                          
                                          
                                             [
                                             1
                                             ]
                                             ,
                                             k
                                          
                                          
                                             (
                                             1
                                             )
                                          
                                       
                                       }
                                       +
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                t
                                                =
                                                1
                                             
                                             
                                                n
                                             
                                          
                                       
                                       (
                                       n
                                       -
                                       t
                                       +
                                       1
                                       )
                                       ·
                                       
                                          
                                             p
                                          
                                          
                                             [
                                             t
                                             ]
                                          
                                          
                                             (
                                             2
                                             )
                                          
                                       
                                       .
                                    
                                 
                              From Eq. (30), it follows that 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          C
                                       
                                       
                                          [
                                          i
                                          ]
                                       
                                       
                                          (
                                          2
                                          )
                                       
                                    
                                    ⩾
                                    n
                                    ·
                                    
                                       
                                          r
                                       
                                       
                                          (
                                          1
                                          )
                                          ,
                                          k
                                       
                                       
                                          (
                                          1
                                          )
                                       
                                    
                                    +
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    (
                                    n
                                    -
                                    t
                                    +
                                    1
                                    )
                                    ·
                                    
                                       
                                          p
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       
                                          (
                                          2
                                          )
                                       
                                    
                                 
                              , where 
                                 
                                    
                                       
                                          p
                                       
                                       
                                          (
                                          s
                                          )
                                       
                                       
                                          (
                                          2
                                          )
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          r
                                       
                                       
                                          (
                                          s
                                          )
                                          ,
                                          k
                                       
                                       
                                          (
                                          1
                                          )
                                       
                                    
                                 
                               are the s-th smallest processing times in 
                                 
                                    {
                                    
                                       
                                          p
                                       
                                       
                                          1
                                       
                                       
                                          (
                                          2
                                          )
                                       
                                    
                                    ,
                                    
                                       
                                          p
                                       
                                       
                                          2
                                       
                                       
                                          (
                                          2
                                          )
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          p
                                       
                                       
                                          n
                                       
                                       
                                          (
                                          2
                                          )
                                       
                                    
                                    }
                                 
                               and 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   max
                                                
                                                
                                                   k
                                                   =
                                                   1
                                                   ,
                                                   2
                                                   ,
                                                   …
                                                   ,
                                                   m
                                                
                                             
                                             {
                                             
                                                
                                                   p
                                                
                                                
                                                   1
                                                   ,
                                                   k
                                                
                                                
                                                   (
                                                   1
                                                   )
                                                
                                             
                                             }
                                             ,
                                             
                                                
                                                   max
                                                
                                                
                                                   k
                                                   =
                                                   1
                                                   ,
                                                   2
                                                   ,
                                                   …
                                                   ,
                                                   m
                                                
                                             
                                             {
                                             
                                                
                                                   p
                                                
                                                
                                                   2
                                                   ,
                                                   k
                                                
                                                
                                                   (
                                                   1
                                                   )
                                                
                                             
                                             }
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   max
                                                
                                                
                                                   k
                                                   =
                                                   1
                                                   ,
                                                   2
                                                   ,
                                                   …
                                                   ,
                                                   m
                                                
                                             
                                             {
                                             
                                                
                                                   p
                                                
                                                
                                                   n
                                                   ,
                                                   k
                                                
                                                
                                                   (
                                                   1
                                                   )
                                                
                                             
                                             }
                                          
                                       
                                    
                                 
                              , respectively. Thus, the 
                                 
                                    
                                       
                                          LB
                                       
                                       
                                          1
                                       
                                       
                                          (
                                          2
                                          )
                                       
                                    
                                 
                               value is a lower bound of the term 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          C
                                       
                                       
                                          j
                                       
                                       
                                          (
                                          2
                                          )
                                       
                                    
                                 
                              , where 
                                 
                                    
                                       
                                          LB
                                       
                                       
                                          1
                                       
                                       
                                          (
                                          2
                                          )
                                       
                                    
                                    =
                                    n
                                    ·
                                    
                                       
                                          r
                                       
                                       
                                          (
                                          1
                                          )
                                          ,
                                          k
                                       
                                       
                                          (
                                          1
                                          )
                                       
                                    
                                    +
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    (
                                    n
                                    -
                                    t
                                    +
                                    1
                                    )
                                    ·
                                    
                                       
                                          p
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       
                                          (
                                          2
                                          )
                                       
                                    
                                 
                              .

From Eq. (28), it also follows that
                                 
                                    (31)
                                    
                                       
                                          
                                             C
                                          
                                          
                                             [
                                             i
                                             ]
                                          
                                          
                                             (
                                             2
                                             )
                                          
                                       
                                       ⩾
                                       
                                          
                                             
                                                max
                                             
                                             
                                                k
                                                =
                                                1
                                                ,
                                                2
                                                ,
                                                …
                                                ,
                                                m
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         t
                                                         =
                                                         1
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      [
                                                      t
                                                      ]
                                                      ,
                                                      k
                                                   
                                                   
                                                      (
                                                      1
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             p
                                          
                                          
                                             [
                                             i
                                             ]
                                          
                                          
                                             (
                                             2
                                             )
                                          
                                       
                                       ,
                                       
                                       ∀
                                       
                                       i
                                       =
                                       1
                                       ,
                                       2
                                       ,
                                       …
                                       ,
                                       n
                                       .
                                    
                                 
                              
                           

Thus, we have
                                 
                                    (32)
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                n
                                             
                                          
                                       
                                       
                                          
                                             C
                                          
                                          
                                             [
                                             i
                                             ]
                                          
                                          
                                             (
                                             2
                                             )
                                          
                                       
                                       ⩾
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                n
                                             
                                          
                                       
                                       
                                          
                                             
                                                max
                                             
                                             
                                                k
                                                =
                                                1
                                                ,
                                                2
                                                ,
                                                …
                                                ,
                                                m
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         t
                                                         =
                                                         1
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      [
                                                      t
                                                      ]
                                                      ,
                                                      k
                                                   
                                                   
                                                      (
                                                      1
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                n
                                             
                                          
                                       
                                       
                                          
                                             p
                                          
                                          
                                             [
                                             i
                                             ]
                                          
                                          
                                             (
                                             2
                                             )
                                          
                                       
                                       ⩾
                                       
                                          
                                             
                                                max
                                             
                                             
                                                k
                                                =
                                                1
                                                ,
                                                2
                                                ,
                                                …
                                                ,
                                                m
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         t
                                                         =
                                                         1
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      [
                                                      t
                                                      ]
                                                      ,
                                                      k
                                                   
                                                   
                                                      (
                                                      1
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                n
                                             
                                          
                                       
                                       
                                          
                                             p
                                          
                                          
                                             [
                                             i
                                             ]
                                          
                                          
                                             (
                                             2
                                             )
                                          
                                       
                                       =
                                       
                                          
                                             
                                                max
                                             
                                             
                                                k
                                                =
                                                1
                                                ,
                                                2
                                                ,
                                                …
                                                ,
                                                m
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         t
                                                         =
                                                         1
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                
                                                (
                                                n
                                                -
                                                t
                                                +
                                                1
                                                )
                                                ·
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      [
                                                      t
                                                      ]
                                                      ,
                                                      k
                                                   
                                                   
                                                      (
                                                      1
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                n
                                             
                                          
                                       
                                       
                                          
                                             p
                                          
                                          
                                             [
                                             i
                                             ]
                                          
                                          
                                             (
                                             2
                                             )
                                          
                                       
                                       .
                                    
                                 
                              
                           

From Eq. (32), it follows that
                                 
                                    (33)
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                n
                                             
                                          
                                       
                                       
                                          
                                             C
                                          
                                          
                                             [
                                             i
                                             ]
                                          
                                          
                                             (
                                             2
                                             )
                                          
                                       
                                       ⩾
                                       
                                          
                                             
                                                max
                                             
                                             
                                                k
                                                =
                                                1
                                                ,
                                                2
                                                ,
                                                …
                                                ,
                                                m
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         t
                                                         =
                                                         1
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                
                                                (
                                                n
                                                -
                                                t
                                                +
                                                1
                                                )
                                                ·
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      (
                                                      t
                                                      )
                                                      ,
                                                      k
                                                   
                                                   
                                                      (
                                                      1
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                                =
                                                1
                                             
                                             
                                                n
                                             
                                          
                                       
                                       
                                          
                                             p
                                          
                                          
                                             j
                                          
                                          
                                             (
                                             2
                                             )
                                          
                                       
                                       ,
                                    
                                 
                              where 
                                 
                                    
                                       
                                          p
                                       
                                       
                                          (
                                          t
                                          )
                                          ,
                                          k
                                       
                                       
                                          (
                                          1
                                          )
                                       
                                    
                                 
                               is the t-th smallest processing times in 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   1
                                                   ,
                                                   k
                                                
                                                
                                                   (
                                                   1
                                                   )
                                                
                                             
                                             ,
                                             
                                                
                                                   p
                                                
                                                
                                                   2
                                                   ,
                                                   k
                                                
                                                
                                                   (
                                                   1
                                                   )
                                                
                                             
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   p
                                                
                                                
                                                   n
                                                   ,
                                                   k
                                                
                                                
                                                   (
                                                   1
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    ,
                                    1
                                    ⩽
                                    t
                                    ⩽
                                    n
                                 
                              .

Therefore, the 
                                 
                                    
                                       
                                          LB
                                       
                                       
                                          2
                                       
                                       
                                          (
                                          2
                                          )
                                       
                                    
                                 
                               value is also a lower bound of the term 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          C
                                       
                                       
                                          j
                                       
                                       
                                          (
                                          2
                                          )
                                       
                                    
                                 
                              , where
                                 
                                    (34)
                                    
                                       
                                          
                                             LB
                                          
                                          
                                             2
                                          
                                          
                                             (
                                             2
                                             )
                                          
                                       
                                       =
                                       
                                          
                                             
                                                max
                                             
                                             
                                                k
                                                =
                                                1
                                                ,
                                                2
                                                ,
                                                …
                                                ,
                                                m
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         t
                                                         =
                                                         1
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                
                                                (
                                                n
                                                -
                                                t
                                                +
                                                1
                                                )
                                                ·
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      (
                                                      t
                                                      )
                                                      ,
                                                      k
                                                   
                                                   
                                                      (
                                                      1
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                                =
                                                1
                                             
                                             
                                                n
                                             
                                          
                                       
                                       
                                          
                                             p
                                          
                                          
                                             j
                                          
                                          
                                             (
                                             2
                                             )
                                          
                                       
                                       .
                                    
                                 
                              Let 
                                 
                                    
                                       
                                          LB
                                       
                                       
                                          3
                                       
                                       
                                          (
                                          2
                                          )
                                       
                                    
                                    =
                                    max
                                    {
                                    
                                       
                                          LB
                                       
                                       
                                          1
                                       
                                       
                                          (
                                          2
                                          )
                                       
                                    
                                    ,
                                    
                                       
                                          LB
                                       
                                       
                                          2
                                       
                                       
                                          (
                                          2
                                          )
                                       
                                    
                                    }
                                 
                              . Then the value 
                                 
                                    
                                       
                                          LB
                                       
                                       
                                          3
                                       
                                       
                                          (
                                          2
                                          )
                                       
                                    
                                 
                               is a lower bound of the term 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          C
                                       
                                       
                                          j
                                       
                                       
                                          (
                                          2
                                          )
                                       
                                    
                                 
                              . The proof is completed.□


                              The value 
                              
                                 
                                    
                                       
                                          LB
                                       
                                       
                                          (
                                          3
                                          )
                                       
                                    
                                 
                               
                              is a lower bound for the HADFSP-TFT, where 
                              
                                 
                                    
                                       
                                          LB
                                       
                                       
                                          (
                                          3
                                          )
                                       
                                    
                                    =
                                    
                                       
                                          LB
                                       
                                       
                                          3
                                       
                                       
                                          (
                                          2
                                          )
                                       
                                    
                                    +
                                    
                                       
                                          ∑
                                       
                                       
                                          h
                                          =
                                          1
                                       
                                       
                                          g
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                J
                                             
                                             
                                                j
                                             
                                          
                                          ∈
                                          
                                             
                                                N
                                             
                                             
                                                h
                                             
                                          
                                       
                                    
                                    
                                       
                                          p
                                       
                                       
                                          j
                                          ,
                                          h
                                       
                                       
                                          (
                                          3
                                          )
                                       
                                    
                                 
                              .

If 
                                 
                                    
                                       
                                          J
                                       
                                       
                                          j
                                       
                                    
                                    ∈
                                    
                                       
                                          N
                                       
                                       
                                          h
                                       
                                    
                                 
                              , then 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          j
                                          ,
                                          h
                                       
                                       
                                          (
                                          3
                                          )
                                       
                                    
                                    ⩾
                                    
                                       
                                          C
                                       
                                       
                                          j
                                       
                                       
                                          (
                                          2
                                          )
                                       
                                    
                                    +
                                    
                                       
                                          p
                                       
                                       
                                          j
                                          ,
                                          h
                                       
                                       
                                          (
                                          3
                                          )
                                       
                                    
                                 
                              . Thus, from Lemma 3, it follows that
                                 
                                    
                                       TFT
                                       =
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                h
                                                =
                                                1
                                             
                                             
                                                g
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      j
                                                   
                                                
                                                ∈
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      h
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             C
                                          
                                          
                                             j
                                             ,
                                             h
                                          
                                          
                                             (
                                             3
                                             )
                                          
                                       
                                       ⩾
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                                =
                                                1
                                             
                                             
                                                n
                                             
                                          
                                       
                                       
                                          
                                             C
                                          
                                          
                                             j
                                          
                                          
                                             (
                                             2
                                             )
                                          
                                       
                                       +
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                h
                                                =
                                                1
                                             
                                             
                                                g
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      j
                                                   
                                                
                                                ∈
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      h
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             p
                                          
                                          
                                             j
                                             ,
                                             h
                                          
                                          
                                             (
                                             3
                                             )
                                          
                                       
                                       ⩾
                                       
                                          
                                             LB
                                          
                                          
                                             3
                                          
                                          
                                             (
                                             2
                                             )
                                          
                                       
                                       +
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                h
                                                =
                                                1
                                             
                                             
                                                g
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      j
                                                   
                                                
                                                ∈
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      h
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             p
                                          
                                          
                                             j
                                             ,
                                             h
                                          
                                          
                                             (
                                             3
                                             )
                                          
                                       
                                       .
                                    
                                 
                              Therefore, the value, 
                                 
                                    
                                       
                                          LB
                                       
                                       
                                          3
                                       
                                       
                                          (
                                          2
                                          )
                                       
                                    
                                    +
                                    
                                       
                                          ∑
                                       
                                       
                                          h
                                          =
                                          1
                                       
                                       
                                          g
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          
                                             
                                                J
                                             
                                             
                                                j
                                             
                                          
                                          ∈
                                          
                                             
                                                N
                                             
                                             
                                                h
                                             
                                          
                                       
                                    
                                    
                                       
                                          p
                                       
                                       
                                          j
                                          ,
                                          h
                                       
                                       
                                          (
                                          3
                                          )
                                       
                                    
                                 
                              , provides a lower bound for the HADFSP-TFT. Theorem 3 is proved.□

@&#EXPERIMENTAL DESIGN@&#

The MIP model has been solved with CPLEX12.2 and the proposed algorithms were implemented in Matlab 7.0, respectively. All experiments were run on a PC with Intel Core i7-3770 CPU, Windows 7, 3.4GHz and 4GB RAM. To validate the effectiveness of the local search steps, HGA, HDDE, and HEDA without local search steps (HGA-NOL, HDDE-NOL, and HEDA-NOL) were also implemented in Matlab 7.0 and run on the same PC. Computational experiments were performed on randomly generated problems to evaluate performances of the MIP models and the proposed algorithms. For the purpose of fair comparison, the maximum computational times of all the meta-heuristics for the same instance are set as 500×
                        n
                        ms, where n is the total job number.

The processing time of each job at each stage are generated from Unidrnd(1,100), where Unidrnd(1,100) is the discrete uniform distribution with range [1,100]. Aimed at verifying the MIP model and proposed algorithms, two sets of problems are generated. The first one includes small-size instances in order to evaluate the effectiveness of the MIP model and also the proposed algorithm against the optimal solution obtained by the model (or the lower bound obtained by Theorem 3). In the second set, we further investigate the performances of the proposed algorithms against lower bounds of the large-size instances. For small-size problems, 24 problem sizes with the combinations of 4 job sizes (n
                        =8, 10, 12, 16), 2 machine sizes at the first stage (m
                        =2 and 4) and 3 machine sizes at the third stage (g
                        =2, 3, and 4) are tested. Two different instances of the HADFSP-TFT are randomly generated for each combination of n, m and g. Therefore, we have 48 instances for small-size problems. For medium- and large-size problems, 96 problem sizes with the combinations of 6 job sizes (n
                        =20, 40, 60, 80, 100 and 120), 4 machine sizes at the first stage (m
                        =2, 4, 6, and 8) and 4 machine sizes at the third stage (g
                        =2, 3, 4, and 5) are tested. 10 different instances of the HADFSP-TFT are randomly generated for each combination of n, m and g. Thus, there are totally 960 instances for the medium- and large-size problems. The proposed heuristics and meta-heuristics are tested on 960 instances, each of which is run 20 independent replications.

For small-size instances that optimal solutions can be obtained by CPLEX solver, we evaluate the performances of the proposed algorithms by using the relative error (RE), which is defined as follows.
                           
                              (35)
                              
                                 RE
                                 =
                                 
                                    
                                       
                                          
                                             TFT
                                          
                                          
                                             alg
                                          
                                       
                                       -
                                       
                                          
                                             TFT
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                    
                                       
                                          
                                             TFT
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                 
                                 ×
                                 100
                                 ,
                              
                           
                        where TFT
                           alg
                         is the objective value obtained by a given algorithm and TFT∗ is the optimal solution value.

Since the NP-hardness of the problem, it is unlikely to find the optimal solutions for medium- and large-size problems within a reasonable time. Hence, for instances that are incapable to reach optimal solutions by CPLEX solver, we define the relative error as the performance measure
                           
                              (36)
                              
                                 RE
                                 =
                                 
                                    
                                       
                                          
                                             TFT
                                          
                                          
                                             alg
                                          
                                       
                                       -
                                       
                                          
                                             LB
                                          
                                          
                                             (
                                             3
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                             LB
                                          
                                          
                                             (
                                             3
                                             )
                                          
                                       
                                    
                                 
                                 ×
                                 100
                                 ,
                              
                           
                        where LB
                        (3) is the lower bound obtained by Theorem 3.

In this paper, the Taguchi method, which is an effective design of experiment approach (Montgomery, 2005), is applied to tuning the parameters of the proposed meta-heuristics. Then the parameters for the six algorithms are determined as follows.
                           
                              (1)
                              HGA-VNS: P
                                 c
                                 =0.8, P
                                 m
                                 =0.2, PS
                                 =40, PM
                                 =0.2 and Iter1=
                                 Iter2=100.

HDDE-VNS: CR
                                 =0.1, F
                                 =0.7, PS
                                 =20, PM
                                 =0.2 and Iter1=
                                 Iter2=100.

HEDA-VNS: PS
                                 =100, Sub_PS
                                 =20, α
                                 =0.4 and Iter2=100.

HGA-NOL: P
                                 c
                                 =0.8, P
                                 m
                                 =0.2, PS
                                 =40.

HDDE-NOL: CR
                                 =0.1, F
                                 =0.7, PS
                                 =20.

HEDA-NOL: PS
                                 =100, Sub_PS
                                 =20, α
                                 =0.4,

where P
                        c and P
                        m are the crossover probability and the mutation probability for HGA-VNS or HGA-NOL, respectively.

In this section, we evaluate the performances of the MIP model, the proposed heuristics, and meta-heuristics. 48 small-sized instances are generated as mentioned in above. The mathematical model is solved in CPLEX 12.2 and run with a time limit of 3600s.

The computational results for the 48 instances are listed in Table 2
                           . In column 4, the values with “∗” are the optimal solutions obtained by CPLEX, and the others are the lower bounds obtained by Theorem 3. In column 5, “OS or LB” means that optimal solution or lower bound.

For the proposed meta-heuristics, the statistical performances, including their best relative error BRE and average relative error ARE of 20 independent runs are listed in Table 2.


                           Table 2 shows that both the mathematical model and proposed meta-heuristics (HGA-VNS, HEDA-VNS and HDDE-VNS) reach the optimum results for 43 out of 48 instances, whereas the proposed heuristics (SPT-based heuristic and NEH-based heuristic) cannot obtain the optimal solutions for the most of instances. It can be seen from the table that the calculation time of CPLEX to reach the optimum solution grows suddenly when there are ten jobs in generated instances. The computation time of the proposed meta-heuristics grows either in the number of jobs. However, it is still enough to solve the instances within 0.5
                           *
                           
                           n seconds. It also shows that the NEH-based algorithm obtains better RE values than the SPT-based algorithm for 46 out of 48 instances. For instances 12_4_4_1 (n
                           =12, m
                           =4, g
                           =4 and No.=1), 16_4_2_1, 16_4_3_1, 16_4_3_2, and 16_4_4_2, CPLEX is running “out of memory” and incapable to reach the optimal solutions in a reasonable computation time, whereas the proposed meta-heuristics performs better than the mathematic model and the two heuristics. As can be seen from Table 2, the performances of the proposed meta-heuristics are very close and all of them can obtain optimal or near-optimal solutions within a reasonable time.

For the medium- and large size instances, we compared the performances of the two heuristics and the three proposed meta-heuristics against each other at first. We run the proposed algorithms 20 times for each instance. The computational results of 960 instances for different combinations of n, m and g were summarized in Tables 3–5
                           
                           
                           . The results include the average BRE (
                              
                                 
                                    
                                       BRE
                                    
                                    
                                       ‾
                                    
                                 
                              
                           ), the average ARE (
                              
                                 
                                    
                                       ARE
                                    
                                    
                                       ‾
                                    
                                 
                              
                           ), and the average standard deviation (
                              
                                 
                                    
                                       Std
                                    
                                    
                                       ‾
                                    
                                 
                              
                           ) of ten different instances for each combination n
                           ×
                           m
                           ×
                           g. Best results of 
                              
                                 
                                    
                                       BRE
                                    
                                    
                                       ‾
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       ARE
                                    
                                    
                                       ‾
                                    
                                 
                              
                            for each combination of n
                           ×
                           m
                           ×
                           g are in bold and italics face, respectively.


                           Tables 3–5 shows that, with the same computational time limit, HDDE-VNS obtains the best or equal 
                              
                                 
                                    
                                       BRE
                                    
                                    
                                       ‾
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       ARE
                                    
                                    
                                       ‾
                                    
                                 
                              
                            of the proposed algorithms for 92 out of 96 problem sizes, 92 out of 96 problem sizes, respectively. It indicates that HDDE-VNS performs more effectively and efficiently than other proposed algorithms for most of the test instances. Tables 3–5 also show that all the proposed meta-heuristics perform better than the proposed heuristics for all the test instances, and the NEH-based heuristic outperform the SPT-based heuristic for most of test instances.

The performances of the proposed algorithms for different numbers of jobs are shown in Fig. 14
                           . By comparing the three meta-heuristics, it is shown that, in average, HDDE-VNS performs better than HGA-VNS and HEDA-VNS for all size of job numbers. As seen in Fig. 14, the overall ARE value of the three meta-heuristic appear in an increasing trend as n increases; while HDDE-VNS and HGA-VNS is apparently superior to HEDA-VNS when n is larger than 60. Note that the lower bound is obtained by Lemma 3 and Theorem 3, so the relative error will be accumulated after the two approximation steps as mentioned in Section 3.5. Thus, this is maybe one reason why the overall ARE values of the three meta-heuristics increases with the increase of n. It is observed from Fig. 14 that the maximum overall ARE values of HDDE-VNS and HGA-VNS are no more than 23%, which indicate the reliability and stability of these two algorithms.


                           Fig. 15
                            illustrates the overall Std of the three hybrid meta-heuristics with respect to the number of jobs. It can be seen from the figure that the overall Std values of HDDE-VNS are smaller than HGA-VNS except the case n
                           =80. These two algorithms are very close for n
                           =20, 60, 80 and 100. For most of the cases, the overall Std values of HDDE-VNS and HGA-VNS are apparently smaller than those of HEDA-VNS. Thus, it can be concluded that, with respect to different numbers of jobs, in average, HDDE-VNS is more robustly than HGA-VNS, whereas the HGA-VNS is more robustly than HEDA-VNS.


                           Fig. 16
                            illustrates the performances of the proposed algorithms with respect to the number of machines at the first stage. It can be seen from the figure that the performances of the proposed algorithms are not much affected by m.


                           Fig. 17
                            shows the performances of the proposed algorithms with respect to the number of machines at the third stage. As shown in the figure, the overall ARE values obtains by all the proposed algorithms appear a decreasing trend as g increases (especially in the case that g is larger than 3). Note that the lower bound is established based on the assumption that there is no waiting time on the machines at the third stage. Therefore, with the increase of g, the assumption will be much closer to the reality, which is maybe one reason why the overall ARE values of the three meta-heuristics appears a decreasing trend with g increases.


                           Table 6
                            lists the 
                              
                                 
                                    
                                       BRE
                                    
                                    
                                       ‾
                                    
                                 
                              
                            values of the six algorithms including HGA-NOL, HGA-VNS, HEDA-NOL, HEDA-VNS, HDDE-NOL and HDDE-VNS with n
                           =60. The results with other n values are similar and not reported in this paper owing to space limitation. It can be seen that all the proposed algorithms yield much better 
                              
                                 
                                    
                                       BRE
                                    
                                    
                                       ‾
                                    
                                 
                              
                            values than those without local search steps for each combination of n
                           ×
                           m
                           ×
                           g. Therefore, it confirms the effectiveness of the VNS-based local search steps in the three proposed meta-heuristics. It is clear that these hybrid algorithms achieve a well balance between global search and local search.

It can be seen from Tables 2–5 that, both the NEH and the SPT run very quickly. They take no more than 0.08s and 2.23s for each instance, respectively. For the most of test instances, the NEH heuristic obtains much better results than the SPT heuristic. Thus, in the two heuristics, we recommend using the NEH to solve HADFSP-TFT. Tables 2–5 also show that, the HDDE-VNS algorithm outperforms the other two meta-heuristics.

In this study, the maximum running time for each meta-heuristic is set to be 500
                           *
                           
                           n
                           ms. Thus, the CPU time is in the range between 4s and 60s. For solving the same instances of HADFSP-TFT, since the initial steps of all the proposed meta-heuristics are implemented by the NEH algorithm, the proposed meta-heuristics consume more computing times than the NEH. Computing results reveal that the HDDE-VNS and the NEH have the overall AREs of 15.58–22.23 and 19.79–27.14 with respect to different job numbers as shown in Fig. 14. The significant improvement of the HDDE-VNS versus the NEH can be analyzed as follows.
                              
                                 (1)
                                 The little improvement in the relative error (HDDE-VNS versus NEH) means a great improvement of solutions within the giving running time. For example, let RE and ΔRE denote the relative error over lower bound and the improvement rate of the HDDE-VNS versus NEH, respectively, where ΔRE=RE(NEH)−
                                    RE(HDDE-VNS). It can be seen from Table 7
                                     that all the values of ΔRE are in the range of between 2.21 and 4.39. It seems the improvement in the relative error is not very large. However, all the instances have obtained optimal or near optimal solutions by using the HDDE-VNS. On the other hand, the little improvement in the relative error also shows the effectiveness of the NEH. That is to say, the NEH algorithm could generate a reasonable solution within a short time.

The little improvement in the relative error (HDDE-VNS versus NEH) means a great shortening of the total production time. It can be seen from Table 7 that the relative improvement rate ΔRE
                                    =
                                    RE (NEH)−
                                    ARE (HDDE-VNS)=4.39 and the relative improvement value ΔZ
                                    =
                                    Z(NEH)−
                                    AveZ(HDDE-VNS)=172 (unit times) for instance 10_4_3_1. The running time of the HDDE-VNS for this instance is 5s. That is to say, the total production time is shortened ΔZ
                                    =172 (unit times) by consuming 5s computing time. If unit time is minute, then ΔZ
                                    =172 is about 3h, which is a considerable improvement in production effectiveness. Similarly, for instance 12_4_2_1, we can see that, it consumes 6s computing time to shorten about 11h in production.

All in all, if we put more emphasis on the quality of the solution than on CPU time consumption, the HDDE-VNS is recommended for solving the HADFSP-TFT. Otherwise, the NEH heuristic is a good choice when computing time is very limited. However, it is usually worth consuming little additional computing time to obtain a better solution.

@&#CONCLUSIONS@&#

This paper studies a novel hybrid assembly-differentiation flowshop scheduling problem to minimize the TFT. Some properties of the problem are presented. In order to deal with this problem, an effective MIP model is formulated and several algorithms including two heuristics and three hybrid meta-heuristics (HGA-VNS, HDDE-VNS, and HEDA-VNS) are proposed. A lower bound is developed for evaluating the performances of the proposed algorithms. For the best of our knowledge, this study is the first attempt to deal with the problem.

Computational experiments are conducted to test the performances of the MIP model, the proposed heuristics and meta-heuristics. Experimental results show that the MIP model is effective for small-size instances. The obtained results indicate that HDDE-VNS performs more efficiently and robustly than HGA-VNS and HEDA-VNS. Statistically results show that HDDE-VNS and HGA-VNS are not much affected by n and m. The effectiveness of the local search steps in HGA-VNS, HEDA-VNS and HDDE-VNS have been examined. Experimental results also reveal that all the proposed algorithms combined with VNS-based local search obtain much better performances than those without local search.

It is hard to know which algorithm is better before compared and tested. Thus, based on three classical meta-heuristics (GA, DEA and EDA), we proposed three hybrid meta-heuristics and compared them each other for determining their preferences. By simulation and comparison, we know that the performance of HDDE-VNS is best, while both HGA-VNS and HEDA-VNS can solve HADFSP-TFT effectively. For small-size instances, all three meta-heuristics can reach the optimum for 43 of 48 instances. For the medium-size instances, the performances of all the proposed meta-heuristics are very close. Moreover, the performances of the HGA-VNS and the HDDE-VNS are very close for the large-size instances.

It also demonstrates that, the results obtained by the proposed meta-heuristics are apparently better than those by the NEH heuristic. However, the NEH can generate reasonable solutions within a very little computing time. That is to say, the meta-heuristics reach better solutions than the NEH, whereas, the NEH consume much less computing time than the proposed meta-heuristics. Therefore, in the real industry environment, the meta-heuristics or the NEH can be selected to meet diverse demands.

In future work, we will focus on developing more efficient constructive heuristics and meta-heuristics for the HADFSP-TFT. In order to balance out the often encountered conflict objectives, we will consider a multi-objective approach for HADFSP. Also, it is promising to apply our proposed algorithms for other permutation-based optimization problems. Finally, it is also worth developing a more efficient lower bound for evaluating the proposed algorithms.

@&#ACKNOWLEDGEMENTS@&#

We own much to Editor in Chief and Professor Slowinski, an Associate Editor and the three anonymous referees for their valuable comments and suggestions on our manuscript. This work is supported in part by the National Natural Science Foundation of China under Grant 50975224, Scientific Research Foundation for Talents (Xi’an University of Architecture and Technology, RC1408), Basic Research Foundation (Xi’an University of Architecture and Technology, JC1414), China Postdoctoral Science Foundation Funded Project (2012M521783), and Open Research Foundation from State Key Laboratory for Manufacturing Systems Engineering (Xi’an Jiaotong University, SKLMS2012008).

@&#REFERENCES@&#

