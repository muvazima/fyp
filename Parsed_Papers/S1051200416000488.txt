@&#MAIN-TITLE@&#Chain code compression using string transformation techniques

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           String transformation techniques for lossless chain code compression are examined.


                        
                        
                           
                           Burrows–Wheeler transform and Move-to-front transform are applied.


                        
                        
                           
                           We examine the effects of using simplified run-length encoding.


                        
                        
                           
                           The proposed method outperforms state-of-the-art chain code compression methods.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Chain codes

Lossless compression

Burrows–Wheeler transform

Move-to-front transform

@&#ABSTRACT@&#


               
               
                  This paper considers the suitability of string transformation techniques for lossless chain codes' compression. The more popular chain codes are compressed including the Freeman chain code in four and eight directions, the vertex chain code, the three orthogonal chain code, and the normalised directional chain code. A testing environment consisting of the constant 0-symbol Run-Length Encoding (
                        
                           
                              RLE
                           
                           
                              0
                           
                           
                              L
                           
                        
                     ), Move-To-Front Transformation (MTFT), and Burrows–Wheeler Transform (BWT) is proposed in order to develop a more suitable configuration of these techniques for each type of the considered chain code. Finally, a simple yet efficient entropy coding is proposed consisting of MTFT, followed by the chain code symbols' binarisation and the run-length encoding. PAQ8L compressor is also an option that can be considered in the final compression stage. Comparisons were done between the state-of-the-art including the Universal Chain Code Compression algorithm, Move-To-Front based algorithm, and an algorithm, based on the Markov model. Interesting conclusions were obtained from the experiments: the sequential uses of MTFT, 
                        
                           
                              RLE
                           
                           
                              0
                           
                           
                              L
                           
                        
                     , and BWT are reasonable only in the cases of shorter chain codes' alphabets as with the vertex chain code and the three orthogonal chain code. For the remaining chain codes, BWT alone provided the best results. The experiments confirm that the proposed approach is comparable against other lossless chain code compression methods, while in total achieving higher compression rates.
               
            

@&#INTRODUCTION@&#

Efficient representation of information has remained a challenge since the earliest days of computing. During those times, Freeman [1] invented a method (known as a chain code) for representing the borders of rasterised geometric shapes. Since then the chain codes have become the popular representation methods within various scientific and engineering disciplines [2–11].

The chain code consists of a small number of instructions, which determine the boundary of a rasterised shape. The original Freeman chain code (in the continuation denoted as F8) contains 8 symbols describing a pixel's neighbourhood with 8-connectivity. This connectivity is coded with 8 codes from the alphabet 
                        
                           
                              Σ
                           
                           
                              F
                              8
                           
                        
                        =
                        {
                        0
                        ,
                        1
                        ,
                        2
                        ,
                        3
                        ,
                        4
                        ,
                        5
                        ,
                        6
                        ,
                        7
                        }
                     . Also a pixel's 4-connectivity neighbourhood can be used leading to the Freeman chain code in four directions (F4) having the alphabet 
                        
                           
                              Σ
                           
                           
                              F
                              4
                           
                        
                        =
                        {
                        0
                        ,
                        1
                        ,
                        2
                        ,
                        3
                        }
                     . Instead of pixels, the sequence of boundary edges can be described as proposed by Nunes et al. [12]. The alphabet of their Differential Chain Code (DCC) contains only three elements, 
                        
                           
                              Σ
                           
                           
                              DCC
                           
                        
                        =
                        {
                        R
                        ,
                        L
                        ,
                        S
                        }
                     , where 
                        R
                        ,
                        L
                     , and S stand for right, left, and straight, respectively. Another chain code with only three symbols in the alphabet, 
                        
                           
                              Σ
                           
                           
                              VCC
                           
                        
                        =
                        {
                        1
                        ,
                        2
                        ,
                        3
                        }
                     , is the Vertex Chain Code (VCC) proposed by Bribiesca [13]. The elements of VCC represent the number of a shape's boundary pixels meeting within the considered raster vertex. In 2005 Sánchez-Cruz and Rodríguez-Dagnino [14] introduced another three-symbol chain code known as the Three OrThogonal (3OT) chain code with alphabet 
                        
                           
                              Σ
                           
                           
                              3
                              
                                 OT
                              
                           
                        
                        =
                        {
                        0
                        ,
                        1
                        ,
                        2
                        }
                     . Its codes are determined as follows:
                        
                           •
                           if the current coding direction is the same as the coding direction of its predecessor, the code is 0;

if the current coding direction is equal to its first predecessor coding direction, which is different than the direction of its predecessor, the code is 1;

otherwise the code is 2.

Graphical representations of the chain codes can be found at many places in the literature (e.g. [15–17]). Although chain codes provide compact representations of shapes' boundaries, some redundancies still remain. This is the reason for developing the domain-specific chain code compression methods. In 1997 Nunes et al. proposed a near-lossless method with Huffman codes on their differential chain code DCC [12]. Liu and Žalik [15] derived the Directional Difference Chain Code (DDCC) by encoding the angular differences of F8 by Huffman codes. A few years later, Liu et al. [16] proposed three simple compression methods for VCC: E_VCC (Extended VCC), V_VCC (Variable VCC), and C_VCC (Compressible VCC). In order to achieve a more compact code, a modified (M_3OT) chain code was proposed by Sánchez-Cruz et al. [18]. They introduced additional symbols 3, 4, and 5 to encode frequent combinations of 3OT symbols 0 and 1. Instead of static Huffman codes, arithmetic coding was later applied for 3OT and DDCC [19]. However, the arithmetic coding as a part of chain code compression was firstly introduced in 2007 [20]. A context tree for describing the Freeman chain codes' context model followed by arithmetic coding had been proposed in [21] for compressing contour lines. In this case the geometric shapes are not necessarily closed. One of the more efficient methods was proposed by Alcaraz-Corona and Rodríguez-Dagnino [22]. Actually, the method was designed for bi-level image compression. At first, image objects are described by the chain codes. After that the symbol dependences are determined in order to calculate the conditional probability of a Markov model. The selection between various Markov orders is done by Bayesian information criterion – BIC. Finally, the Markov order with the minimal BIC is selected and used by the arithmetic coder. However, the number of probability combinations in the Markov model grows exponentially, which is computationally demanding, and even more importantly, it requires memory space to store the information about the used symbol dependences' probabilities. This is why the authors use a small Markov order (i.e. up to 5). A quasi-lossless chain code compression method was proposed in [23], where the less frequent angular differences (i.e. 135° and 180°) in the DDCC were replaced by the more frequent ones. Žalik and Lukač [17] developed a new lossless chain code compression approach for the more popular chain codes (F8, F4, VCC, 3OT, and NAD – a normalisation of DDC). In order to reduce the information entropy, the Move-To-Front transform was applied followed by the adaptive RLE. Very recently a Universal Chain Code Compression (UCCC) algorithm has been proposed in [24]. The chain codes have been binarised and then compressed, regardless of the chain code type, by a combination of three modes: RLE, LZ77 and COPY. The equivalence between the chain codes was formally proven in [25]. The chain codes can also be used in 3D [26,27].

This paper introduces a new lossless chain code compression approach, which combines different string transformation techniques. A testing environment was set-up consisting of Move-To-Front Transform (MTFT), constant 0-symbol Run-Length Encoding (
                        
                           
                              RLE
                           
                           
                              0
                           
                           
                              L
                           
                        
                     ) (where runs of L 0-symbols are replaced by a new symbol L), and Burrows–Wheeler Transform (BWT). In the next section, these techniques are briefly explained. In Section 3 the structure of the testing environment is given together with the entropy coder. Section 4 contains the conducted experiments using 24 benchmark shapes, where the comparisons were performed using various lossless chain code algorithms. The last section concludes the paper.

This section briefly introduces the string transformation techniques used in this paper: Move-To-Front Transform (MTFT), Burrows–Wheeler Transform (BWT), and two variations of the Run-Length Encoding (RLE).

MTFT [28,29] is a technique originally developed for memory paging and more efficient access to the elements of a list [30,31]. The elements, which have been accessed recently are located nearer to the top of the list. In data compression, MTFT is frequently used during the pre-processing stage, as it may reduce the information entropy [17]. Let 
                           
                              
                                 Σ
                              
                              
                                 S
                              
                           
                           =
                           {
                           
                              
                                 σ
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 σ
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 σ
                              
                              
                                 k
                                 −
                                 1
                              
                           
                           }
                         be the alphabet consisting of k symbols, and 
                           S
                           =
                           {
                           
                              
                                 σ
                              
                              
                                 i
                              
                           
                           }
                           ,
                           
                              
                                 σ
                              
                              
                                 i
                              
                           
                           ∈
                           
                              
                                 Σ
                              
                              
                                 S
                              
                           
                           ,
                           i
                           ∈
                           [
                           0
                           ,
                           n
                           −
                           1
                           ]
                         the sequence of 
                           n
                           =
                           |
                           S
                           |
                         input symbols. The list T contains an arrangement of all 
                           
                              
                                 σ
                              
                              
                                 i
                              
                           
                           ∈
                           
                              
                                 Σ
                              
                              
                                 S
                              
                           
                        .

MTFT incrementally takes symbol 
                           
                              
                                 σ
                              
                              
                                 i
                              
                           
                         from S, finds its position (index) within T, stores the index in the output array O, moves 
                           
                              
                                 σ
                              
                              
                                 i
                              
                           
                         to the first position in T and shift all others elements from T up to index for one position (see Pseudo-code 1
                         for details).

Let us consider an example. 
                           
                              
                                 Σ
                              
                              
                                 S
                              
                           
                           =
                           {
                           a
                           ,
                           b
                           ,
                           c
                           }
                        , 
                           S
                           =
                           [
                           c
                           ,
                           a
                           ,
                           a
                           ,
                           a
                           ,
                           a
                           ,
                           a
                           ,
                           a
                           ,
                           b
                           ,
                           a
                           ,
                           b
                           ,
                           a
                           ,
                           b
                           ,
                           a
                           ]
                         and 
                           T
                           =
                           [
                           c
                           ,
                           b
                           ,
                           a
                           ]
                        . Running MTFT results in 
                           O
                           =
                           [
                           0
                           ,
                           2
                           ,
                           0
                           ,
                           0
                           ,
                           0
                           ,
                           0
                           ,
                           0
                           ,
                           2
                           ,
                           1
                           ,
                           1
                           ,
                           1
                           ,
                           1
                           ,
                           1
                           ]
                        . As can be seen, the sequence of the same symbol results in runs of 0's, whilst the sequence of alternating symbols produces runs of 1's.

In the next example, a less favourable case is shown: 
                           S
                           =
                           [
                           c
                           ,
                           a
                           ,
                           b
                           ,
                           a
                           ,
                           a
                           ,
                           b
                           ,
                           a
                           ,
                           c
                           ,
                           a
                           ,
                           b
                           ,
                           c
                           ,
                           b
                           ,
                           a
                           ]
                         gives 
                           O
                           =
                           [
                           0
                           ,
                           2
                           ,
                           2
                           ,
                           1
                           ,
                           0
                           ,
                           1
                           ,
                           1
                           ,
                           2
                           ,
                           1
                           ,
                           2
                           ,
                           2
                           ,
                           1
                           ,
                           2
                           ]
                        , where runs of the same symbols do not exist. Such streams can be rearranged in, hopefully, a more suitable form for compression by the Burrows–Wheeler Transform, which is described next.

Burrows–Wheeler Transform (BWT) is one of the more fascinating algorithms in computer science, being discovered in 1978 and published in 1994 [32]. A detailed explanation with various applications can be found in [33,34]. BWT transforms the input string S to the output string O such that symbols with a similar context are grouped closely together. It works over three steps:
                           
                              •
                              generate n rows by left-shifting S n times;

lexicographically sort the rows;

read the characters from the last column, which represent BWT.

The position of the initial string S should be stored in order to reconstruct the input string S from 
                           
                              BWT
                           
                           (
                           S
                           )
                        . A short example follows, where 
                           S
                           =
                           [
                           c
                           a
                           b
                           c
                           a
                           b
                           c
                           d
                           ]
                        :


                        
                           
                              
                           
                        
                     

BWT(S) = [ccaadbbc] and the BWT-index for the reconstruction is 4. As can be seen, after BWT the same character tends to form runs and therefore, BWT(S) is more compressible. The procedure for the inverse BWT can be found in the literature (e.g. [33]). The main problem of BWT is its time complexity. A naive implementation works in 
                           O
                           (
                           
                              
                                 n
                              
                              
                                 2
                              
                           
                           log
                           ⁡
                           (
                           n
                           )
                           )
                         time, which represented a serious obstacle for its usage in the past. Fortunately, BWT can be obtained in the linear time from a suffix array of the considered string. The suffix array, proposed by Manber and Myers [35], is the lexicographically sorted array of the suffixes of a string. Unfortunately, the naive implementation for constructing the suffix array also works in 
                           O
                           (
                           
                              
                                 n
                              
                              
                                 2
                              
                           
                           log
                           ⁡
                           (
                           n
                           )
                           )
                        . Therefore, the more frequent approaches for obtaining the suffix array have been by the lexicographic traversal of a suffix tree, which can be done in linear time, whilst the suffix tree itself can be constructed in 
                           O
                           (
                           n
                           log
                           ⁡
                           (
                           n
                           )
                           )
                         time [33]. The algorithms for direct construction of the suffix array in time 
                           O
                           (
                           n
                           )
                         have been known for a while [36,37], too. A scalable parallel suffix array construction as proposed by Kulla and Sanders [38] has been used in our case.

Run-length encoding (RLE) is a well-known and very simple compression technique, which replaces the runs of the same symbol in S by the symbol itself and the number of its repetitions [34]. However, at chain code compression RLE should be applied carefully. Namely, the chain codes have very small alphabets and coding the number of repetition dramatically increases the number of symbols. To avoid this, two versions of RLE are used in this paper – the first can be applied before BWT and the second is part of the entropy coder:
                           
                              •
                              Constant 
                                    
                                       
                                          RLE
                                       
                                       
                                          0
                                       
                                       
                                          L
                                       
                                    
                                  replaces the fixed runs of 0-symbols having the length L. Let 
                                    S
                                    =
                                    [
                                    0
                                    ,
                                    0
                                    ,
                                    0
                                    ,
                                    0
                                    ,
                                    0
                                    ,
                                    0
                                    ,
                                    2
                                    ,
                                    2
                                    ,
                                    0
                                    ,
                                    0
                                    ,
                                    0
                                    ,
                                    0
                                    ,
                                    2
                                    ,
                                    2
                                    ]
                                  and 
                                    L
                                    =
                                    4
                                 , then 
                                    
                                       
                                          RLE
                                       
                                       
                                          0
                                       
                                       
                                          L
                                       
                                    
                                    (
                                    
                                       MTFT
                                    
                                    (
                                    S
                                    )
                                    )
                                    =
                                    [
                                    L
                                    ,
                                    0
                                    ,
                                    0
                                    ,
                                    2
                                    ,
                                    2
                                    ,
                                    L
                                    ,
                                    2
                                    ,
                                    2
                                    ]
                                 . A more elaborate approach for reducing the number of symbols in S was proposed in [39], where the new, extended alphabet was constructed by combining two or more chain code symbols.


                                 
                                    
                                       
                                          RLE
                                       
                                       
                                          0
                                       
                                    
                                  is used in the entropy coding. It encodes the runs of 0-symbols with length N, where N is coded with the variable-length coding (VLC) scheme. The first two bits specify the number of bits used for determining the range of N. Then the number N is coded with 2 to 5 bits according to Table 1
                                 .

Parameter R specifies, how long the runs of 0-symbols should be that it is worth encoding it by 
                                    
                                       
                                          RLE
                                       
                                       
                                          0
                                       
                                    
                                    (
                                    N
                                    )
                                 . R is determined as follows:
                                    
                                       (1)
                                       
                                          R
                                          =
                                          |
                                          
                                             
                                                RLE
                                             
                                             
                                                0
                                             
                                          
                                          _
                                          
                                             Code
                                          
                                          |
                                          +
                                          2
                                          +
                                          2
                                          =
                                          |
                                          
                                             
                                                RLE
                                             
                                             
                                                0
                                             
                                          
                                          _
                                          
                                             Code
                                          
                                          |
                                          +
                                          4
                                          ,
                                          
                                          
                                          N
                                          ≥
                                          R
                                       
                                    
                                  where the 
                                    
                                       
                                          RLE
                                       
                                       
                                          0
                                       
                                    
                                    _
                                    
                                       Code
                                    
                                  is the length of the code indicating 
                                    
                                       
                                          RLE
                                       
                                       
                                          0
                                       
                                    
                                    (
                                    N
                                    )
                                  mode (see explanation later in Section 3, Tables 2–6
                                 
                                 
                                 
                                 
                                 ). If, for example, the 
                                    |
                                    
                                       
                                          RLE
                                       
                                       
                                          0
                                       
                                    
                                    _
                                    
                                       Code
                                    
                                    |
                                    =
                                    3
                                 , the interval 
                                    [
                                    7
                                    ,
                                    65
                                    ]
                                  of 0-symbols can be encoded.

A testing environment (see Fig. 1
                     ) was constructed for evaluating the effects of various sequences of string transformation techniques applied on different chain codes in order to study their impacts on their compressions. As seen, BWT is always applied whilst the remaining transformations can be turned-on or off by the switch W. Only BWT is applied when 
                        W
                        =
                        1
                     . By setting 
                        W
                        =
                        2
                     , MTFT is applied before BWT. When 
                        W
                        =
                        3
                     , 
                        
                           
                              RLE
                           
                           
                              0
                           
                           
                              L
                           
                        
                      is applied after MTFT.

The effects of possible transformations are demonstrated by an example of the fish shape (Fig. 2
                     ) using F4 chain code, when switch 
                        W
                        =
                        3
                     .

The input F4 chain code data stream is:
                        
                           
                              
                                 
                                    
                                       
                                          S
                                          =
                                          00303033000300030303030333333232323223222232323323211111221221112
                                       
                                    
                                    
                                       
                                          212232332231333111111011111121111113330300330300111010001011111
                                       
                                    
                                 
                              
                           
                        
                      According to Fig. 1, the input stream is transformed by MTFT, where the initial state of the list 
                        T
                        =
                        [
                        0
                        ,
                        1
                        ,
                        2
                        ,
                        3
                        ]
                     . The following stream of symbols is then obtained:
                        
                           
                              
                                 
                                    
                                       
                                          
                                             MTFT
                                          
                                          (
                                          S
                                          )
                                          =
                                          003111101001100111111111000003111111011000111110111300001011
                                       
                                    
                                    
                                       
                                          01001011021101012100100000310000031000003003110101110200111001110000
                                       
                                    
                                 
                              
                           
                        
                      The 
                        
                           
                              RLE
                           
                           
                              0
                           
                           
                              L
                           
                        
                      follows. For this small example 
                        L
                        =
                        4
                      yields:
                        
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                RLE
                                             
                                             
                                                0
                                             
                                             
                                                L
                                             
                                          
                                          (
                                          
                                             MTFT
                                          
                                          (
                                          S
                                          )
                                          )
                                          =
                                          003111101001100111111111
                                          L
                                          
                                          03111111011000111110111300001
                                       
                                    
                                    
                                       
                                          011010010110211010121001
                                          L
                                          
                                          031
                                          L
                                          
                                          031
                                          L
                                          
                                          0300311010111020011100111
                                          L
                                       
                                    
                                 
                              
                           
                        
                      The BWT is applied on the obtained stream. The index, which should be stored for the reconstruction, is 12.
                        
                           
                              
                                 
                                    
                                       
                                          
                                             BWT
                                          
                                          (
                                          
                                             
                                                RLE
                                             
                                             
                                                0
                                             
                                             
                                                L
                                             
                                          
                                          (
                                          
                                             MTFT
                                          
                                          (
                                          S
                                          )
                                          )
                                          )
                                          =
                                          301011201113
                                          L
                                          
                                          11001110110100101011
                                          L
                                          
                                          00
                                          L
                                          
                                          L
                                          
                                          L
                                          
                                          1001121111
                                       
                                    
                                    
                                       
                                          1000101100101321110011103111030111110011110113130010100000011111
                                       
                                    
                                 
                              
                           
                        
                      Finally, MTFT is applied (with the initial state of the 
                        T
                        =
                        [
                        0
                        ,
                        1
                        ,
                        2
                        ,
                        3
                        ,
                        L
                        ]
                     ) to obtain the following stream:
                        
                           
                              
                                 
                                    
                                       
                                          
                                             MTFT
                                          
                                          (
                                          
                                             BWT
                                          
                                          (
                                          
                                             
                                                RLE
                                             
                                             
                                                0
                                             
                                             
                                                L
                                             
                                          
                                          (
                                          
                                             MTFT
                                          
                                          (
                                          S
                                          )
                                          )
                                          )
                                          )
                                          =
                                          3121103220034203010011011101111102201002201
                                       
                                    
                                    
                                       
                                          04100002001110101114320030100132002212000010100011021120211100000100
                                       
                                    
                                    
                                       
                                          00
                                          ,
                                       
                                    
                                 
                              
                           
                        
                      which is encoded as described in the next subsection. It should be noted that BWT groups the same symbols much better in the cases of longer streams than the very short stream used in this example [33].

There are several possibilities for lossless entropy encoding of which Huffman and arithmetic coding are amongst the more popular [34]. However, due to the simplicity we apply a binarisation model combined with the 
                           
                              
                                 RLE
                              
                              
                                 0
                              
                           
                         in this paper.

Let 
                           S
                           =
                           {
                           
                              
                                 σ
                              
                              
                                 i
                              
                           
                           }
                           ,
                           
                              
                                 σ
                              
                              
                                 i
                              
                           
                           ∈
                           Σ
                           ,
                           0
                           ≤
                           i
                           <
                           n
                           ,
                           n
                           =
                           |
                           S
                           |
                        , be the input stream, and B the output stream of the bits, where B is empty at the beginning. The binarisation depends on the number of symbols in the alphabet Σ as explained below.

VCC and 3OT are chain codes with three symbols. For simplicity reasons both chain codes are encoded in the same way by rearranging VCC codes as follows: symbol 2 becomes symbol 0 and symbol 3 becomes symbol 2. After that 
                              
                                 
                                    Σ
                                 
                                 
                                    VCC
                                 
                              
                              =
                              
                                 
                                    Σ
                                 
                                 
                                    3
                                    
                                       OT
                                    
                                 
                              
                              =
                              {
                              0
                              ,
                              1
                              ,
                              2
                              }
                           . Two cases should be considered according to the position of switch W (see Fig. 1).
                              
                                 1.
                                 
                                    
                                       W
                                       =
                                       3
                                    : In this case the alphabet is extended with an additional symbol denoting the sequence of L 0-symbols. Therefore, 
                                       
                                          
                                             Σ
                                          
                                          
                                             
                                                
                                                   VCC
                                                
                                                
                                                   L
                                                
                                             
                                          
                                       
                                       =
                                       
                                          
                                             Σ
                                          
                                          
                                             3
                                             
                                                
                                                   OT
                                                
                                                
                                                   L
                                                
                                             
                                          
                                       
                                       =
                                       {
                                       0
                                       ,
                                       1
                                       ,
                                       2
                                       ,
                                       3
                                       }
                                    . The first symbol 
                                       
                                          
                                             σ
                                          
                                          
                                             0
                                          
                                       
                                     is coded as follows:
                                       
                                          •
                                          If 
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      0
                                                   
                                                
                                                =
                                                0
                                              then it is checked as to whether it starts the 0-symbols run. If it does, 
                                                B
                                                =
                                                1
                                                ⊕
                                                
                                                   
                                                      RLE
                                                   
                                                   
                                                      0
                                                   
                                                
                                                (
                                                N
                                                )
                                             , where bit 1 indicates that the following bits represent 
                                                
                                                   
                                                      RLE
                                                   
                                                   
                                                      0
                                                   
                                                
                                              encoded number N (see subsection 2.3) and ‘⊕’ denotes the concatenation operation.

If 
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      0
                                                   
                                                
                                              does not start 0-symbols run, 
                                                B
                                                =
                                                0
                                                ⊕
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      0
                                                      (
                                                      2
                                                      )
                                                   
                                                
                                             , where 
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      0
                                                      (
                                                      2
                                                      )
                                                   
                                                
                                              is a two-bit binary code of 
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      0
                                                   
                                                
                                             .

For all remaining symbols 
                                       
                                          
                                             σ
                                          
                                          
                                             i
                                          
                                       
                                    , 
                                       0
                                       <
                                       i
                                       <
                                       n
                                    , an auxiliary variable p is needed. p stores the value of the previously compressed symbol, i.e. 
                                       p
                                       =
                                       
                                          
                                             σ
                                          
                                          
                                             i
                                             −
                                             1
                                          
                                       
                                    , initially, 
                                       p
                                       =
                                       
                                          
                                             σ
                                          
                                          
                                             0
                                          
                                       
                                    . The domain of 
                                       p
                                       ∈
                                       {
                                       
                                          
                                             Σ
                                          
                                          
                                             
                                                
                                                   VCC
                                                
                                                
                                                   L
                                                
                                             
                                          
                                       
                                       =
                                       
                                          
                                             Σ
                                          
                                          
                                             3
                                             
                                                
                                                   OT
                                                
                                                
                                                   L
                                                
                                             
                                          
                                       
                                       ∪
                                       R
                                       }
                                     is extended with the symbol R, which denotes that the run of 0-symbols was previously encoded. The encoding of symbols 
                                       
                                          
                                             σ
                                          
                                          
                                             i
                                          
                                       
                                     into bits is performed according to Table 2. It is worth mentioning that if 
                                       p
                                       =
                                       0
                                    , runs of 0's cannot appear as this would have already been detected.


                                    
                                       W
                                       ∈
                                       {
                                       1
                                       ,
                                       2
                                       }
                                    : 
                                       
                                          
                                             Σ
                                          
                                          
                                             VCC
                                          
                                       
                                       =
                                       
                                          
                                             Σ
                                          
                                          
                                             3
                                             
                                                OT
                                             
                                          
                                       
                                       =
                                       {
                                       0
                                       ,
                                       1
                                       ,
                                       2
                                       }
                                    . Similarly as before, 
                                       
                                          
                                             σ
                                          
                                          
                                             0
                                          
                                       
                                     is coded independently. Firstly, it is checked, if 
                                       
                                          
                                             σ
                                          
                                          
                                             0
                                          
                                       
                                       =
                                       0
                                     and whether it starts the 0-symbol runs in other case, the first symbol is coded with a two-bits binary code. The remaining symbols are coded according to Table 3.

F4 and NAD are codes with four symbols. The alphabet of both codes are the same 
                              
                                 
                                    Σ
                                 
                                 
                                    F
                                    4
                                 
                              
                              =
                              
                                 
                                    Σ
                                 
                                 
                                    NAD
                                 
                              
                              =
                              {
                              0
                              ,
                              1
                              ,
                              2
                              ,
                              3
                              }
                           . As in the previous case, if the switch 
                              W
                              =
                              3
                           , an additional symbol denoting runs of L 0-symbols should be coded giving 
                              
                                 
                                    Σ
                                 
                                 
                                    F
                                    
                                       
                                          4
                                       
                                       
                                          L
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    Σ
                                 
                                 
                                    
                                       
                                          NAD
                                       
                                       
                                          L
                                       
                                    
                                 
                              
                              =
                              {
                              0
                              ,
                              1
                              ,
                              2
                              ,
                              3
                              ,
                              4
                              }
                           . The first symbol 
                              
                                 
                                    σ
                                 
                                 
                                    0
                                 
                              
                            is coded independently as described in the previous subsection. The remaining symbols are encoded as shown in Table 4. When 
                              W
                              ∈
                              {
                              1
                              ,
                              2
                              }
                           , the alphabet is 
                              
                                 
                                    Σ
                                 
                                 
                                    F
                                    4
                                 
                              
                              =
                              
                                 
                                    Σ
                                 
                                 
                                    NAD
                                 
                              
                            and the coding summarises Table 5.

The first symbol 
                              
                                 
                                    σ
                                 
                                 
                                    0
                                 
                              
                              ∈
                              
                                 
                                    Σ
                                 
                                 
                                    F
                                    8
                                 
                              
                            is coded with three bits. However, if the switch 
                              W
                              =
                              3
                           , 
                              
                                 
                                    Σ
                                 
                                 
                                    F
                                    
                                       
                                          8
                                       
                                       
                                          L
                                       
                                    
                                 
                              
                            has even 9 symbols. 
                              
                                 
                                    σ
                                 
                                 
                                    0
                                 
                              
                              =
                              7
                            and 
                              
                                 
                                    σ
                                 
                                 
                                    0
                                 
                              
                              =
                              8
                            are in this case coded with 4 bits (7 as 1110 and 8 as 1111). The remaining 
                              
                                 
                                    σ
                                 
                                 
                                    i
                                 
                              
                           , 
                              0
                              <
                              i
                              <
                              n
                            are coded as given in Table 6. The codes are the same for 
                              
                                 
                                    Σ
                                 
                                 
                                    F
                                    8
                                 
                              
                            and 
                              
                                 
                                    Σ
                                 
                                 
                                    F
                                    
                                       
                                          8
                                       
                                       
                                          L
                                       
                                    
                                 
                              
                            with the exception of encoding symbols 8 and 9 as described above.

@&#RESULTS@&#

The proposed lossless chain code compression algorithm was tested on various benchmark shapes obtained from
                        1
                     
                     
                        1
                        
                           http://www.mty.itesm.mx/dtie/proyectos/bilevel_chains/.
                      and.
                        2
                     
                     
                        2
                        
                           http://gemma.feri.um.si/chaincodes/.
                      Four shapes (i.e. fire, spider, thunder and tiger) of the latter are available in two versions. Both of them are used in the experiments and distinguished by superscript 1 and 2, respectively. All results of the compressions with the proposed methods given in the continuation also include the bits spent by the header, as described later in this section.

The left part of Table 7
                      shows the obtained compression results when switch 
                        W
                        =
                        1
                      (see Fig. 1). The best compression for each shape is highlighted in bold. As can be seen, NAD was the best, F4 next, followed by 3OT. The worst results were obtained by VCC and F8 chain codes. F4 gave the best results when 
                        W
                        =
                        2
                     . However, with F4 practically the same result was obtained as when 
                        W
                        =
                        1
                     , while considerably worse compressions were achieved for all other chain codes.

Various values of L were tried when 
                        W
                        =
                        3
                     . However, in all cases the best results were obtained when 
                        L
                        ∈
                        {
                        5
                        ,
                        6
                        ,
                        7
                        }
                     . The results of the compression are given in Table 8
                     .

A closer look at the results leads to these interesting conclusions:
                        
                           •
                           In the cases of F8 and NAD the convincing better results were achieved by direct application of BWT (when 
                                 W
                                 =
                                 1
                              ).

Using MTFT in front of BWT is inefficient for chain codes. Slightly better results were obtained only in the case of F4.


                              
                                 
                                    
                                       RLE
                                    
                                    
                                       0
                                    
                                    
                                       L
                                    
                                 
                               introduces a new symbol. Obviously, the smaller the number of symbols in the chain code's alphabet, the more reasonable the application of MTFT and 
                                 
                                    
                                       RLE
                                    
                                    
                                       0
                                    
                                    
                                       L
                                    
                                 
                               before BWT. Indeed, VCC and 3OT had the alphabets with 
                                 |
                                 Σ
                                 |
                                 =
                                 3
                               symbols and considerably better compression results were achieved when 
                                 W
                                 =
                                 3
                              . For other chain codes with 
                                 |
                                 Σ
                                 |
                                 ≥
                                 4
                               the use of the MTFT and 
                                 
                                    
                                       RLE
                                    
                                    
                                       0
                                    
                                    
                                       L
                                    
                                 
                               gave worse results with the exceptions of those shapes with the long straight edges (e.g., the shape square in our experiments).

According to these observations, the block scheme for chain codes compressions based on BWT is given in Fig. 3
                     .

The compressed chain codes are stored within a common file regardless of the chain code type. The file consists of a header and a body. Five different chain codes are considered. For this we reserved the first 4 bits at beginning of the header. After that the length L of 
                        
                           
                              RLE
                           
                           
                              0
                           
                           
                              L
                           
                        
                      is coded with three bits. The offset 3 is used. In this way, 
                        L
                        =
                        3
                      is coded with bits 000, 
                        L
                        =
                        6
                      with 011, and 
                        L
                        =
                        9
                      as 111. Storing of BWT-index follows. We provide two possibilities, i.e. the BWT-index can be stored in one or two bytes, which are indicated with an additional bit. If it is set to 1, the BWT-index is smaller than 256, and it is stored in one byte, otherwise two bytes are needed. In this way a stream of up to 216 codes can be encoded. Longer chain codes should be arranged in blocks and coded independently. In the worst case, the header takes 24 bits, and in the best case 16 bits.

Finally, the proposed lossless chain code compression algorithm from Fig. 3 was compared with other lossless chain code compression algorithms.

Before going into detailed analysis, the results obtained by the compression algorithm based on Markov order of dependencies (MO) proposed by Alcaraz-Corona and Rodríguez-Dagnino [22] requires additional explanation. As explained in the Introduction, the number of probability combinations in the Markov order grows exponentially as the order increases, where the basis is the number of codes in the alphabet Σ. To perform decompression these probabilities should be stored. If this information were to be stored in the header of each shape, the header would in many cases be larger that the information about the shape. Therefore, we have calculated the probability information for 5 different Markov sizes of chain code symbols for all shapes and determined its size. Then, the compression of all shapes was done with the probability information of all 5 Markov models. Finally, the Markov model giving the minimal sum of the compressed shape and the probability information has been selected. MO(3) in Table 10 means that the sum of the probability table size and the sum of all compressed shapes was the smallest when Markov order 3 was used. Table 9
                      gives the results for all five chain codes. Therefore, this approach is very suitable in the case, when a large number of shapes should be compressed as a unit.

Furthermore, the well-known lossless compression algorithm PAQ8L (accessible at http://mattmahoney.net/dc/paq.html) has been used, too (the first level of compression gave the best results in our experiments). We used PAQ8L in two ways: firstly, it was applied directly on the chain code stream, and secondly, we applied it after our simple entropy encoder described in Section 3.

The results of compression algorithms are collated in Table 10
                     . Firstly, F8 chain code is compressed. The first row shows the number of bits when each F8 code was encoded with three bits without any further compression. On this stream of bits PAQ8L is applied next. The Directional Difference Chain Code – DDCC [15], based on Huffman coding is presented next. The F8 compression with the Universal Chain Code Compressor [24] follows. Markov order of dependencies with the order 2, MO(2), is the next. The BWT-base algorithm as proposed in this paper follows. Finally, the obtained stream from the BWT-based algorithm is additionally compressed with the PAQ8L, denoted as 
                        
                           
                              BWT
                           
                           
                              P
                           
                        
                     . The last column in Table 10 gives the total number of spent bits for all 24 chain code data sets.

The compression results for F4 are shown after that in the same fashion. The widest variety of algorithms were available for VCC. The first VCC row in Table 10 shows the number of bits when each VCC code was encoded by 2 bits. On this sequence of bits PAQ8L is applied. E_VCC, V_VCC, and C_VCC were proposed in [15]. E_VCC (Extended VCC) applies the unused bit combination of VCC codes to encode frequent symbol combinations 
                        {
                        1
                        ,
                        3
                        }
                      (or 
                        {
                        3
                        ,
                        1
                        }
                     ); V_VCC (Variable VCC) encodes the more frequent code 2 by a single bit, whilst the remaining codes 1 and 3 use two bits. C_VCC uses Huffman coding for the more frequent combinations of VCC, which were obtained by examining the huge number of images. The next row represents the used bits when MTFT-based compression was applied [17], followed by the number of bits obtained by UCCC. MM(3), BWT-based, and BWT-based followed by PAQ8L. Also in this case the BWT-based algorithms were the best, MO(3) was third and PAQ8L fourth. The remaining algorithms are considerably worse. Results were similarly obtained at 3OT chain codes, too.

Finally, the compressions are shown for the NAD chain code. The first row gives the number of bits spent by encoding each NAD code by two bits. PAQ8L, MTFT, UCCC, MO(3) and both BWT-based approaches follow. In this case 
                        
                           
                              BWT
                           
                           
                              P
                           
                        
                      is again the best, while the second is PAQ8L. BWT-based with the 
                        
                           
                              RLE
                           
                           
                              0
                           
                        
                      encoding is third and MM(3) follows. UCCC and MTFT are the worse.

In Table 10 the best cumulative results are marked in bold-italic, while the second best in bold. As can be seen, the proposed BWT-based algorithm followed with the PAQ8L entropy coder yields in general the best results. Moreover, it can be concluded that even if PAQ8L is not used and only the simple 
                        
                           
                              RLE
                           
                           
                              0
                           
                        
                     -based entropy coder is applied, the proposed BWT-based chain code compression algorithm achieves the best compression. The algorithm based on Markov order of dependencies is efficient as well. However, it is suitable only when the larger number of shapes are compressed, as for compressing only an individual shape, the header needed for storing the probability model is too large.

@&#CONCLUSION@&#

This paper presented a new lossless chain code compression algorithm based on various string transformation techniques including Burrows–Wheeler Transform (BWT), Move-To-Front Transform (MTFT), and the constant 0-symbol Run-Length Encoding (
                        
                           
                              RLE
                           
                           
                              0
                           
                           
                              L
                           
                        
                     ). A testing environment was made as their mutual effect on the final compression efficiency is difficult to predict. The more popular chain codes were used including Freeman chain code in eight and four directions (i.e. F8 and F4), the Vertex Chain Code (VCC), the Three orthogonal chain code (3OT), and the Normalised Directional chain code (NAD). It has been shown that applying all transformation techniques in a sequence (MTFT, 
                        
                           
                              RLE
                           
                           
                              0
                           
                           
                              L
                           
                        
                     , BWT) provides in general the best results only in the cases of the chain codes with the shortest alphabets (i.e. when 
                        |
                        Σ
                        |
                        =
                        3
                     ). In other cases it is more suitable to apply only BWT before entropy coding. According to the performed experiments, the more compressible chain code is 3OT, while F8 is the least. In general, all chain codes are compressed better with the proposed lossless algorithm in comparison with the state-of-the-art methods.

@&#ACKNOWLEDGEMENTS@&#

This work was supported by the Slovenian Research Agency under grants J2-5479, J2-6764, and 1000-13-0552.

In this Appendix all steps of the proposed algorithm are given for the VCC represented shape of butterfly.
                        
                           
                              
                                 
                                    
                                       
                                          
                                             The input:
                                          
                                       
                                    
                                    
                                       
                                          22132131313123131231313123123123123131313132231313221321321313122132
                                       
                                    
                                    
                                       
                                          13123131231231313132231313131313123113213213131231231313131313131313
                                       
                                    
                                    
                                       
                                          13131313123131231313132132213213213131313131313123123131231312312312
                                       
                                    
                                    
                                       
                                          31231231231231231223122231231222313123131231313232222222222222312222
                                       
                                    
                                    
                                       
                                          31222222312222222312132222222222222222222132213213131231213213213131
                                       
                                    
                                    
                                       
                                          23122312222222222222222222312132222222132222221322221322222222222223
                                       
                                    
                                    
                                       
                                          23131321313213132221321322213221321321321321321321321321313213132132
                                       
                                    
                                    
                                       
                                          13131313131313123123122312313131321313213131313131313131313131313213
                                       
                                    
                                    
                                       
                                          21313123123113213131313131322313131321321313213123122131312312312231
                                       
                                    
                                    
                                       
                                          31322313131313213213213213131321313213131312312221321231222213221322
                                       
                                    
                                    
                                       
                                          13213222132221331223132213231213222213212312213132131313131313131313
                                       
                                    
                                    
                                       
                                          22312322222222222132122222132131321313222223122312231222222221321321
                                       
                                    
                                    
                                       
                                          32131313132131231323223122222213222221321321313131313123131223131231
                                       
                                    
                                    
                                       
                                          23123123131231231312312312312313123123123123123123123123123123123123
                                       
                                    
                                    
                                       
                                          12312312312231231223123122312312231231223122312231222222222222213221
                                       
                                    
                                    
                                       
                                          32221321313132131313131231231231223122222222222222222132222132222132
                                       
                                    
                                    
                                       
                                          21322132213221321321321322132132132132132131321321313213213132132131
                                       
                                    
                                    
                                       
                                          32132131321313213213132132131321313213132132131321313213131321313213
                                       
                                    
                                    
                                       
                                          13213213132131321321313213132132131321313213213132132132131321321322
                                       
                                    
                                    
                                       
                                          13213223132132131321321321321322213221321312131223122312223123123123
                                       
                                    
                                    
                                       
                                          12313123123132231231223123123131231231231312312313123131231231312313
                                       
                                    
                                    
                                       
                                          12312313123131231231312313123131312313123131231231312313123131231231
                                       
                                    
                                    
                                       
                                          31231231312313123123131231231312312313123123131231231231231231223123
                                       
                                    
                                    
                                       
                                          12312312231223122312231222231222231222222222222222221322132132132131
                                       
                                    
                                    
                                       
                                          31313123131312312223122312222222222222132213221322132132213213221321
                                       
                                    
                                    
                                       
                                          32213213221321321321321321321321321321321321321321321321313213213213
                                       
                                    
                                    
                                       
                                          21313213213132132132132131322131321313131313123123122222312222221322
                                       
                                    
                                    
                                       
                                          32313213123131313123123123122222222132213221322222313123131231222221
                                       
                                    
                                    
                                       
                                          23122222222222321322313131313131313131231312213212312222312132312231
                                       
                                    
                                    
                                       
                                          32213312223122231231223122312222132123122
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           
                              
                                 
                                    
                                       
                                          
                                             Transforming
                                          
                                          
                                          
                                             
                                                Σ
                                             
                                             
                                                VCC
                                             
                                          
                                          =
                                          {
                                          1
                                          ,
                                          2
                                          ,
                                          3
                                          }
                                           to 
                                          
                                             
                                                Σ
                                             
                                             
                                                VCC
                                             
                                          
                                          =
                                          {
                                          0
                                          ,
                                          1
                                          ,
                                          2
                                          }
                                          :
                                       
                                    
                                    
                                       
                                          00120121212102121021212102102102102121212120021212001201201212100120
                                       
                                    
                                    
                                       
                                          12102121021021212120021212121212102112012012121021021212121212121212
                                       
                                    
                                    
                                       
                                          12121212102121021212120120012012012121212121212102102121021210210210
                                       
                                    
                                    
                                       
                                          21021021021021021002100021021000212102121021212020000000000000210000
                                       
                                    
                                    
                                       
                                          21000000210000000210120000000000000000000120012012121021012012012121
                                       
                                    
                                    
                                       
                                          02100210000000000000000000210120000000120000001200001200000000000002
                                       
                                    
                                    
                                       
                                          02121201212012120001201200012001201201201201201201201201212012120120
                                       
                                    
                                    
                                       
                                          12121212121212102102100210212121201212012121212121212121212121212012
                                       
                                    
                                    
                                       
                                          01212102102112012121212121200212121201201212012102100121210210210021
                                       
                                    
                                    
                                       
                                          21200212121212012012012012121201212012121210210001201021000012001200
                                       
                                    
                                    
                                       
                                          12012000120001221002120012021012000012010210012120121212121212121212
                                       
                                    
                                    
                                       
                                          00210200000000000120100000120121201212000002100210021000000001201201
                                       
                                    
                                    
                                       
                                          20121212120121021202002100000012000001201201212121212102121002121021
                                       
                                    
                                    
                                       
                                          02102102121021021210210210210212102102102102102102102102102102102102
                                       
                                    
                                    
                                       
                                          10210210210021021002102100210210021021002100210021000000000000012001
                                       
                                    
                                    
                                       
                                          20001201212120121212121021021021002100000000000000000120000120000120
                                       
                                    
                                    
                                       
                                          01200120012001201201201200120120120120120121201201212012012120120121
                                       
                                    
                                    
                                       
                                          20120121201212012012120120121201212012120120121201212012121201212012
                                       
                                    
                                    
                                       
                                          12012012120121201201212012120120121201212012012120120120121201201200
                                       
                                    
                                    
                                       
                                          12012002120120121201201201201200012001201210121002100210002102102102
                                       
                                    
                                    
                                       
                                          10212102102120021021002102102121021021021210210212102121021021210212
                                       
                                    
                                    
                                       
                                          10210212102121021021210212102121210212102121021021210212102121021021
                                       
                                    
                                    
                                       
                                          21021021210212102102121021021210210212102102121021021021021021002102
                                       
                                    
                                    
                                       
                                          10210210021002100210021000021000021000000000000000001200120120120121
                                       
                                    
                                    
                                       
                                          21212102121210210002100210000000000000120012001200120120012012001201
                                       
                                    
                                    
                                       
                                          20012012001201201201201201201201201201201201201201201201212012012012
                                       
                                    
                                    
                                       
                                          01212012012120120120120121200121201212121212102102100000210000001200
                                       
                                    
                                    
                                       
                                          20212012102121212102102102100000000120012001200000212102121021000001
                                       
                                    
                                    
                                       
                                          02100000000000201200212121212121212121021210012010210000210120210021
                                       
                                    
                                    
                                       
                                          20012210002100021021002100210000120102100
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           
                              
                                 
                                    
                                       
                                          
                                             After MTFT
                                          
                                          ,
                                          
                                          where 
                                          T
                                          =
                                          [
                                          0
                                          ,
                                          1
                                          ,
                                          2
                                          ]
                                          :
                                       
                                    
                                    
                                       
                                          00122221111122211222111122222222222211111112012111202222222211120122
                                       
                                    
                                    
                                       
                                          22122211222222111112012111111111122201222222111222222111111111111111
                                       
                                    
                                    
                                       
                                          11111111122211222111112222022222222111111111111122222211222112222222
                                       
                                    
                                    
                                       
                                          22222222222222222202220022222200221122211222111211000000000000122000
                                       
                                    
                                    
                                       
                                          22200000222000000222122000000000000000000222022222111222212222222111
                                       
                                    
                                    
                                       
                                          22220222000000000000000000222122000000222000002220002220000000000001
                                       
                                    
                                    
                                       
                                          11211122211222112002222220022202222222222222222222222222211222112222
                                       
                                    
                                    
                                       
                                          22111111111111122222220222221111122211222111111111111111111111111222
                                       
                                    
                                    
                                       
                                          22211122222201222111111111120121111122222211222122220121112222222022
                                       
                                    
                                    
                                       
                                          11120121111111222222222222111122211222111112222001222122200012202220
                                       
                                    
                                    
                                       
                                          22222200222002201202212022212212200022221222012112221111111111111111
                                       
                                    
                                    
                                       
                                          20122210000000000222210000122221122211200001220222022200000001222222
                                       
                                    
                                    
                                       
                                          22221111112221222121101220000012200002222222211111111122211202211222
                                       
                                    
                                    
                                       
                                          22222222211222222112222222222221122222222222222222222222222222222222
                                       
                                    
                                    
                                       
                                          22222222222022222202222220222222022222202220222022200000000000012202
                                       
                                    
                                    
                                       
                                          22002222211112221111111222222222202220000000000000000122000222000222
                                       
                                    
                                    
                                       
                                          02220222022202222222222220222222222222222221122222211222222112222221
                                       
                                    
                                    
                                       
                                          12222221122211222222112222221122211222112222221122211222111122211222
                                       
                                    
                                    
                                       
                                          11222222112221122222211222112222221122211222222112222222221122222220
                                       
                                    
                                    
                                       
                                          22222201212222221122222222222220022202222212121202220222002222222222
                                       
                                    
                                    
                                       
                                          22221122222212012222202222222211222222222112222221122211222222112221
                                       
                                    
                                    
                                       
                                          12222221122211222222112221122211112221122211222222112221122211222222
                                       
                                    
                                    
                                       
                                          11222222112221122222211222222112222221122222211222222222222222202222
                                       
                                    
                                    
                                       
                                          22222222022202220222022200022200022200000000000000001220222222222221
                                       
                                    
                                    
                                       
                                          11111122211112222002220222000000000000122022202220222222022222202222
                                       
                                    
                                    
                                       
                                          22022222202222222222222222222222222222222222222222222222211222222222
                                       
                                    
                                    
                                       
                                          22211222222112222222222221120221122211111111122222220000222000001220
                                       
                                    
                                    
                                       
                                          11121222122211111122222222220000000122022202220000121122211222200001
                                       
                                    
                                    
                                       
                                          12220000000000212220121111111111111111222112012221222000222122122022
                                       
                                    
                                    
                                       
                                          12022012002220022222202220222000122212220
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           
                              
                                 
                                    
                                       
                                          
                                             After 
                                          
                                             
                                                RLE
                                             
                                             
                                                0
                                             
                                             
                                                L
                                             
                                          
                                          ,
                                          
                                          where 
                                          L
                                          =
                                          6
                                       
                                    
                                    
                                       
                                          00122221111122211222111122222222222211111112012111202222222211120122
                                       
                                    
                                    
                                       
                                          22122211222222111112012111111111122201222222111222222111111111111111
                                       
                                    
                                    
                                       
                                          11111111122211222111112222022222222111111111111122222211222112222222
                                       
                                    
                                    
                                       
                                          22222222222222222202220022222200221122211222111211
                                          L
                                          
                                          00000012200022200
                                       
                                    
                                    
                                       
                                          000222000000222122
                                          L
                                          
                                          L
                                          
                                          00000022202222211122221222222211122220222
                                          L
                                          
                                          L
                                          
                                          00000
                                       
                                    
                                    
                                       
                                          022212200000022200000222000222
                                          L
                                          
                                          0000001112111222112221120022222200222
                                       
                                    
                                    
                                       
                                          02222222222222222222222222211222112222221111111111111222222202222211
                                       
                                    
                                    
                                       
                                          11122211222111111111111111111111111222222111222222012221111111111201
                                       
                                    
                                    
                                       
                                          21111122222211222122220121112222222022111201211111112222222222221111
                                       
                                    
                                    
                                       
                                          22211222111112222001222122200012202220222222002220022012022120222122
                                       
                                    
                                    
                                       
                                          122000222212220121122211111111111111112012221
                                          L
                                          
                                          0000222210000122221122
                                       
                                    
                                    
                                       
                                          2112000012202220222
                                          L
                                          
                                          012222222222111111222122212110122000001220000222
                                       
                                    
                                    
                                       
                                          22222111111111222112022112222222222221122222211222222222222112222222
                                       
                                    
                                    
                                       
                                          22222222222222222222222222222222222222202222220222222022222202222220
                                       
                                    
                                    
                                       
                                          22202220222
                                          L
                                          
                                          000000122022200222221111222111111122222222220222
                                          L
                                          
                                          L
                                          
                                          000012
                                       
                                    
                                    
                                       
                                          20002220002220222022202220222222222222022222222222222222112222221122
                                       
                                    
                                    
                                       
                                          22221122222211222222112221122222211222222112221122211222222112221122
                                       
                                    
                                    
                                       
                                          21111222112221122222211222112222221122211222222112221122222211222222
                                       
                                    
                                    
                                       
                                          22211222222202222220121222222112222222222222002220222221212120222022
                                       
                                    
                                    
                                       
                                          20022222222222222112222221201222220222222221122222222211222222112221
                                       
                                    
                                    
                                       
                                          12222221122211222222112221122222211222112221111222112221122222211222
                                       
                                    
                                    
                                       
                                          11222112222221122222211222112222221122222211222222112222221122222222
                                       
                                    
                                    
                                       
                                          2222222202222222222220222022202220222000222000222
                                          L
                                          
                                          L
                                          
                                          00001220222222222
                                       
                                    
                                    
                                       
                                          22111111122211112222002220222
                                          L
                                          
                                          00000012202220222022222202222220222222
                                       
                                    
                                    
                                       
                                          02222220222222222222222222222222222222222222222222222221122222222222
                                       
                                    
                                    
                                       
                                          21122222211222222222222112022112221111111112222222000022200000122011
                                       
                                    
                                    
                                       
                                          12122212221111112222222222
                                          L
                                          
                                          01220222022200001211222112222000011222
                                          L
                                          
                                          00
                                       
                                    
                                    
                                       
                                          00212220121111111111111111222112012221222000222122122022120220120022
                                       
                                    
                                    
                                       
                                          20022222202220222000122212220
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           
                              
                                 
                                    
                                       
                                          
                                             After BWT
                                          
                                          ;
                                          
                                          the obtained BWT-Index 
                                          
                                             =
                                          
                                           90
                                       
                                    
                                    
                                       
                                          02
                                          L
                                          
                                          L
                                          
                                          L
                                          
                                          L
                                          
                                          2
                                          L
                                          
                                          L
                                          
                                          202020020200002200
                                          L
                                          
                                          0002
                                          L
                                          
                                          1
                                          L
                                          
                                          0200000
                                          L
                                          
                                          2000000000200200002020220
                                       
                                    
                                    
                                       
                                          02002022000000000000020022000000022002220000022220200020222222222021
                                       
                                    
                                    
                                       
                                          00000
                                          L
                                          
                                          00002002200222
                                          L
                                          
                                          02022022200002220000220222222202222002220202020
                                       
                                    
                                    
                                       
                                          00020220202022222222202222202220222220212221111111111111122111111111
                                       
                                    
                                    
                                       
                                          11111221111111111112121111111112111211111111111121121111111221111111
                                       
                                    
                                    
                                       
                                          12111111221111111212122112111111111121111211221121111111211121112202
                                       
                                    
                                    
                                       
                                          01111111112111111222211112111112211112112211111222122221222211111221
                                       
                                    
                                    
                                       
                                          21211222222222222222212211111112212222222222221122222222222221112221
                                       
                                    
                                    
                                       
                                          11222222221021011111111221102212000001000122102000020200000022222221
                                       
                                    
                                    
                                       
                                          11011211111111111111111111111112111111111111120002110111211000101111
                                       
                                    
                                    
                                       
                                          10111111111111111111111111121111112111011111111111121222222222212222
                                       
                                    
                                    
                                       
                                          22222222222212222212222221111222211112121121222222222122222222222122
                                       
                                    
                                    
                                       
                                          22222222222212222222222222122212221222221222222212222222212122221222
                                       
                                    
                                    
                                       
                                          22212222222222222212222222222222222222222222222222222222222222222222
                                       
                                    
                                    
                                       
                                          22222122122122222222202222121222212122222212211222122222222222221002
                                       
                                    
                                    
                                       
                                          22222212221221222221221222122222222222222212222222222222222222222222
                                       
                                    
                                    
                                       
                                          22222222220222222222222022222222220222222222222222222222222222222222
                                       
                                    
                                    
                                       
                                          22222222222222222022222200222112222222222222100002021000100202222200
                                       
                                    
                                    
                                       
                                          00121221200020200200200020002222202222220202000222211221212212122211
                                       
                                    
                                    
                                       
                                          22111121222211121111111121222222112212221222211111211121122112122122
                                       
                                    
                                    
                                       
                                          12222222222221221200011121211201121222211222222222222222212222120222
                                       
                                    
                                    
                                       
                                          22222212222222212222222222222222222222222222222222222220112222222222
                                       
                                    
                                    
                                       
                                          22222222222122222222222200222022222222222222222222222222222222222222
                                       
                                    
                                    
                                       
                                          22202002001220202200020002202121222212221121111211111111111211112112
                                       
                                    
                                    
                                       
                                          21222112111211212211222222222221222222222222222222002222022222222022
                                       
                                    
                                    
                                       
                                          22222222222221222212222222212212222222222222222022222222222022011122
                                       
                                    
                                    
                                       
                                          11221122222222222202222222221222222022222222222222222222222222222122
                                       
                                    
                                    
                                       
                                          22022222222222222222222222222222222222222212012222220001200002222221
                                       
                                    
                                    
                                       
                                          22222222222222122
                                          L
                                          
                                          L
                                          
                                          L
                                          
                                          L
                                          
                                          21222222
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           
                              
                                 
                                    
                                       
                                          
                                             After MTFT in the entropy coding
                                          
                                          ;
                                          
                                          MTFT is initialised as 
                                          T
                                          =
                                          [
                                          0
                                          ,
                                          1
                                          ,
                                          2
                                          ,
                                          3
                                          ]
                                          :
                                       
                                    
                                    
                                       
                                          02300011012111101111000101021002231331000022200000000110110001111101
                                       
                                    
                                    
                                       
                                          01101110100000000000011010100000010101001000010001110011100000000113
                                       
                                    
                                    
                                       
                                          20000310003101010100222110110010001001000101100000011000101001111111
                                       
                                    
                                    
                                       
                                          00011101111110000000011000011001100001131001000000000000010100000000
                                       
                                    
                                    
                                       
                                          00000101000000000001111000000001100110000000000011011000000101000000
                                       
                                    
                                    
                                       
                                          01100000101000000111110101100000000011000110101011000000110011001021
                                       
                                    
                                    
                                       
                                          12000000002100000100010001100001010001101010000100110001100010000101
                                       
                                    
                                    
                                       
                                          11110100000000000000011010000001011000000000001010000000000001001001
                                       
                                    
                                    
                                       
                                          00100000001222210000000201022021200002100120122100011110000010000002
                                       
                                    
                                    
                                       
                                          00210210000000000000000000000001100000000000012001202100210200111000
                                       
                                    
                                    
                                       
                                          01100000000000000000000000021000001100210000000000021100000000011000
                                       
                                    
                                    
                                       
                                          00000000000011000011000001000100010001111011100000000110000000000110
                                       
                                    
                                    
                                       
                                          00000000000011000000000000110011001100001100000011000000011110001100
                                       
                                    
                                    
                                       
                                          00011000000000000011000000000000000000000000000000000000000000000000
                                       
                                    
                                    
                                       
                                          00000110110110000000021000211100011110000011010100110000000000001202
                                       
                                    
                                    
                                       
                                          00000021001101100001101100110000000000000011000000000000000000000000
                                       
                                    
                                    
                                       
                                          00000000002100000000000110000000001100000000000000000000000000000000
                                       
                                    
                                    
                                       
                                          00000000000000000110000010100201000000000000120002112200110211000010
                                       
                                    
                                    
                                       
                                          00221101120011110110110011001000011000001111100100020101111011110010
                                       
                                    
                                    
                                       
                                          10100011100010011000000011100000101011001100010000110011010101110110
                                       
                                    
                                    
                                       
                                          11000000000001101120020021110122021100010100000000000000011000112100
                                       
                                    
                                    
                                       
                                          00000021000000011000000000000000000000000000000000000002202000000000
                                       
                                    
                                    
                                       
                                          00000000000110000000000020100110000000000000000000000000000000000000
                                       
                                    
                                    
                                       
                                          00011101102202111010011001011211100011001011000110000000000110001101
                                       
                                    
                                    
                                       
                                          01100101100110111010100000000001100000000000000000201000110000000110
                                       
                                    
                                    
                                       
                                          00000000000002100011000000011011000000000000000210000000000110120020
                                       
                                    
                                    
                                       
                                          10101010000000000021000000002100000210000000000000000000000000000210
                                       
                                    
                                    
                                       
                                          00210000000000000000000000000000000000000021222000002002220001000002
                                       
                                    
                                    
                                       
                                          10000000000000110300012100000
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   Final bit-stream
                                                
                                                ;
                                                
                                                header consists of 16 bits as follows
                                                
                                             
                                          
                                          
                                             
                                                0111
                                                
                                             
                                             
                                                code for VCC
                                             
                                          
                                          
                                             
                                                011
                                                
                                             
                                             
                                                L
                                                =
                                                6
                                             
                                          
                                          
                                             
                                                0
                                                
                                             
                                             
                                                BWT-index
                                                <
                                                256
                                             
                                          
                                          
                                             
                                                01011010
                                                
                                             
                                             
                                                stored BWT-index
                                                =
                                                90
                                             
                                          
                                          
                                             
                                                
                                             
                                             
                                                end of the header – coding of the symbols follows
                                             
                                          
                                          
                                             
                                                0
                                                
                                             
                                             
                                                there is no 0-symbols run at the beginning
                                             
                                          
                                          
                                             
                                                00
                                                
                                             
                                             
                                                the first symbol is 0 coded with two bits
                                             
                                          
                                          
                                             
                                                110
                                                
                                             
                                             
                                                symbol 2 coded according to Table 2
                                                
                                             
                                          
                                          
                                             
                                                1111
                                                
                                             
                                             
                                                symbol 2 coded according to Table 2
                                                
                                             
                                          
                                          
                                             
                                                
                                             
                                             
                                                all remaining symbols are coded in the same way using Table 2 
                                             
                                          
                                          
                                             
                                                
                                             
                                             
                                                and 
                                                
                                                   
                                                      RLE
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      L
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                10001001010111000001010000100010101010110010011011101111011111111010
                                             
                                          
                                          
                                             
                                                00011011101110110001100101001000100000101010100101000101011001110001
                                             
                                          
                                          
                                             
                                                01010101100010010101010100101000010100010001001000110001100111111101
                                             
                                          
                                          
                                             
                                                00001110100011101010101010101001101110111000101001001010001010010100
                                             
                                          
                                          
                                             
                                                01010100110001000100010101010010000000100010001010000001100011001000
                                             
                                          
                                          
                                             
                                                01001001001000010011110100101100100101010110010010101011001010000011
                                             
                                          
                                          
                                             
                                                00011001001001100101000101001100010010101100001001000001010101100010
                                             
                                          
                                          
                                             
                                                00000101010100110010000010001001010101010100110001000100100100101011
                                             
                                          
                                          
                                             
                                                00011101100011100100000101000101000100100001010101000100101010101000
                                             
                                          
                                          
                                             
                                                01010010010001001000101000010101000001010110010110010101100010010100
                                             
                                          
                                          
                                             
                                                11001010010101100111001001010010100101100001011101110111011100110000
                                             
                                          
                                          
                                             
                                                11010101011011101011001110100001100100101110101011101110010001000010
                                             
                                          
                                          
                                             
                                                00001011000101010011001011001101011100011001110011101001011101011001
                                             
                                          
                                          
                                             
                                                00110010110100100010000100110101110100100000100100110011001010100011
                                             
                                          
                                          
                                             
                                                00100000110010110010000100100000101000101000101000100001010001100011
                                             
                                          
                                          
                                             
                                                00110011000011001001001100111000100100100100100001001100010001100001
                                             
                                          
                                          
                                             
                                                00001000100100000100110010010011011001010010100101001100011100100011
                                             
                                          
                                          
                                             
                                                00001000100001000001001010101010010011001110011101011011000101001001
                                             
                                          
                                          
                                             
                                                00101001000010010100100100110011010011011100001001100101000110010000
                                             
                                          
                                          
                                             
                                                01101100001001000001010101001101010110011100111010001100011101110100
                                             
                                          
                                          
                                             
                                                10010110001000010100011011100010100111010010000101001010010010010010
                                             
                                          
                                          
                                             
                                                10000100100000100000100101000110101010100001010000100101010101010001
                                             
                                          
                                          
                                             
                                                00010001010010011000010001000001010101010010010010001010000100100100
                                             
                                          
                                          
                                             
                                                10101010101000101001010011001010001010011101001101001100001010111011
                                             
                                          
                                          
                                             
                                                10101100010001010101100101100100010011100110001110011000010011011101
                                             
                                          
                                          
                                             
                                                00101110101101101011000011001010101010100100110111110000010100101101
                                             
                                          
                                          
                                             
                                                11010110000101010010010010101001110000100010010010101001000100110011
                                             
                                          
                                          
                                             
                                                00001000100101010100100101010010010010100010101010110011000011010000
                                             
                                          
                                          
                                             
                                                01010101000100110000100110011011001000100110000100101001100101110011
                                             
                                          
                                          
                                             
                                                00110000101011101001101010101010101010110010101001100011100100000110
                                             
                                          
                                          
                                             
                                                01101011011001000110011011101001001110111011101000001101001101110111
                                             
                                          
                                          
                                             
                                                0100010100000110011001001001011110001011100100000
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

@&#REFERENCES@&#

