@&#MAIN-TITLE@&#A speed and departure time optimization algorithm for the pollution-routing problem

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We present a speed and departure time optimization algorithm.


                        
                        
                           
                           A proof of optimality for the proposed speed and departure time optimization algorithm is provided.


                        
                        
                           
                           Computational experiments on the pollution-routing problem are performed.


                        
                        
                           
                           The impact on distance, fuel consumption, and labor costs are investigated.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Routing

Speed optimization

Departure optimization

Green logistics

@&#ABSTRACT@&#


               
               
                  We propose a new speed and departure time optimization algorithm for the pollution-routing problem (PRP), which runs in quadratic time and returns an optimal schedule. This algorithm is embedded into an iterated local search-based metaheuristic to achieve a combined speed, scheduling and routing optimization. The start of the working day is set as a decision variable for individual routes, thus enabling a better assignment of human resources to required demands. Some routes that were evaluated as unprofitable can now appear as viable candidates later in the day, leading to a larger search space and further opportunities of distance optimization via better service consolidation. Extensive computational experiments on available PRP benchmark instances demonstrate the good performance of the algorithm. The flexible departure times from the depot contribute to reduce the operational costs by 8.36% on the considered instances.
               
            

@&#INTRODUCTION@&#

The pollution-routing problem (PRP) is a variant of the vehicle routing problem with environmental considerations, introduced in Bektaş and Laporte (2011), and aiming to minimize operational and environmental costs subject to vehicle capacity and hard time-window constraints. The costs are based on driver wages and fuel consumption, evaluated as a non-linear function of the distance traveled, vehicle load, and vehicle speed. Some recent articles have proposed heuristics for the PRP: an adaptive large neighborhood search in Demir, Bektaş and Laporte (2012), and an ILS with a set-partitioning matheuristic in Kramer, Subramanian, Vidal and Cabral (2015). Other contributions (Bektaş & Laporte, 2011; Franceschetti, Honhon, Van Woensel, Bektaş & Laporte, 2013; Dabia, Demir & Van Woensel, 2014) focused on mathematical formulations and integer programming algorithms based on branch-and-price.

Vehicle-speed decisions play an important role in the PRP, since they do not only affect the total cost, but also the travel times between the locations, with a large impact on time-window feasibility. For this reason, most algorithms for the PRP perform – at regular times during the search – an optimization of vehicle speeds for the current routes. The resulting speed optimization subproblem (SOP), seeks to find the most cost-efficient arc speeds on a given route while respecting arrival-time constraints at each customer.

Some algorithms for the SOP have been recently proposed (Demir et al., 2012; Kramer et al., 2015; Norstad, Fagerholt & Laporte, 2011; Hvattum, Norstad, Fagerholt & Laporte, 2013). These algorithms run in quadratic time, consider identical cost/speed functions for each arc, and assume that the departure time is fixed. Now, considering that the start of the working day (the departure time from the depot) is a decision variable leads to different optimality conditions and speed decisions. This may open the way to significant cost reductions, but also increases resolution complexity. Fewer articles have addressed this aspect. In Dabia et al. (2014), the departure time from the first customer is optimized by means of a golden section search, within a pricing algorithm. Franceschetti et al. (2013) model and solve the PRP with time-dependent travel times, a generalization of the problem considered in this paper. The resulting speed optimization algorithm is, however, more complex due to the presence of three time intervals with different speed/cost functions, involving 24 rules for speed choices. The solution is also not guaranteed to be optimal. Finally, Vidal, Jaillet and Maculan (2014) showed that the optimal SOP solution with deadlines and arc-dependent speed/cost functions can be achieved by solving a hierarchy of resource allocation problems.

This article contributes to the resolution of difficult vehicle routing variants with speed and departure time optimization. We consider the case where driver wages are computed from the departure time, hence allowing to better assign human resources to needed deliveries. Note that a fixed departure time can still be obtained by reducing the departure time window to a point. Some routes that were evaluated as unprofitable with a fixed departure time policy can now appear as viable candidates, leading to a larger search space and further opportunities of routing optimization via better service clustering.

We introduce a simple quadratic time algorithm for the speed and departure time optimization (Section 3). Moreover, we demonstrate the optimality of this algorithm (Section 4). The speed optimization algorithm is embedded into a vehicle routing matheuristic to produce high-quality routing plans. We conduct computational experiments on the classic PRP instances to evaluate the performance of the method, and assess the impact of departure time optimization on cost and pollution emissions (Section 5). The results highlight very significant routing cost reduction, of 8.36% on average. The CPU time of the new metaheuristic remains comparable to current state-of-the-art methods despite the fact that it deals with a more general problem.

The PRP with flexible departure times can be defined as follows. Let 
                        
                           G
                           =
                           (
                           V
                           ,
                           A
                           )
                        
                      be a complete and directed graph with a set 
                        
                           V
                           =
                           {
                           0
                           ,
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           n
                           }
                        
                      of vertices and a set 
                        
                           A
                           =
                           {
                           (
                           i
                           ,
                           j
                           )
                           :
                           i
                           ,
                           j
                           ∈
                           V
                           ,
                           i
                           ≠
                           j
                           }
                        
                      of arcs. Vertex 0 represents the depot while the remaining vertices are customers. A set of m vehicles with capacity Q is available to service the customers. Each customer i has a non-negative demand qi
                     , a time window [ai, bi
                     ] during which service must start, and a service time τi
                     . By convention, 
                        
                           
                              q
                              0
                           
                           =
                           
                              τ
                              0
                           
                           =
                           0
                        
                      for the depot. Each arc 
                        
                           (
                           i
                           ,
                           j
                           )
                           ∈
                           A
                        
                      represents a travel possibility from node i to j for a distance dij
                     , which can be traveled with any speed vij
                      in the interval [vmin, vmax
                     ]. The PRP aims at determining a speed matrix (v)
                        ij
                      for the arcs and a set of feasible routes R to serve all customers while minimizing environmental and operational costs.

Let 
                        
                           
                              σ
                           
                           =
                           (
                           
                              σ
                              1
                           
                           ,
                           
                              σ
                              2
                           
                           ,
                           …
                           ,
                           
                              σ
                              
                                 |
                                 σ
                                 |
                              
                           
                           )
                        
                      be a route, 
                        
                           f
                           
                              
                                 σ
                                 i
                              
                              
                                 σ
                                 
                                    i
                                    +
                                    1
                                 
                              
                           
                        
                      be the vehicle load on arc 
                        
                           (
                           
                              σ
                              i
                           
                           ,
                           
                              σ
                              
                                 i
                                 +
                                 1
                              
                           
                           )
                        
                      and 
                        
                           t
                           
                              σ
                              i
                           
                        
                      be the arrival time at customer σi
                     . The environmental cost is proportional to fuel consumption, computed as in Eq. (1) where w
                     1, w
                     2, w
                     3, w
                     4 are parameters based on fuel properties, vehicle and network characteristics. The labor costs are proportional to route duration, computed as the difference between departure and arrival time 
                        
                           
                              t
                              
                                 σ
                                 
                                    |
                                    σ
                                    |
                                 
                              
                           
                           −
                           
                              t
                              
                                 σ
                                 1
                              
                           
                        
                     . Defining 
                        
                           ω
                           
                              f
                              c
                           
                        
                      as the fuel cost per liter and 
                        
                           ω
                           
                              d
                              c
                           
                        
                      as the driving cost per second, the objective of the PRP is given in Eq. (2):

                        
                           (1)
                           
                              
                                 
                                    
                                       
                                          
                                             F
                                             
                                                
                                                   σ
                                                   i
                                                
                                                
                                                   σ
                                                   
                                                      i
                                                      +
                                                      1
                                                   
                                                
                                             
                                             f
                                          
                                          
                                             (
                                             
                                                v
                                                
                                                   
                                                      σ
                                                      i
                                                   
                                                   
                                                      σ
                                                      
                                                         i
                                                         +
                                                         1
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             d
                                             
                                                
                                                   σ
                                                   i
                                                
                                                
                                                   σ
                                                   
                                                      i
                                                      +
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   w
                                                   1
                                                
                                                
                                                   v
                                                   
                                                      
                                                         σ
                                                         i
                                                      
                                                      
                                                         σ
                                                         
                                                            i
                                                            +
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                             +
                                             
                                                w
                                                2
                                             
                                             +
                                             
                                                w
                                                3
                                             
                                             
                                                f
                                                
                                                   
                                                      σ
                                                      i
                                                   
                                                   
                                                      σ
                                                      
                                                         i
                                                         +
                                                         1
                                                      
                                                   
                                                
                                             
                                             +
                                             
                                                w
                                                4
                                             
                                             
                                                v
                                                
                                                   
                                                      σ
                                                      i
                                                   
                                                   
                                                      σ
                                                      
                                                         i
                                                         +
                                                         1
                                                      
                                                   
                                                
                                                2
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (2)
                           
                              
                                 
                                    
                                       
                                          
                                             Z
                                             
                                                p
                                                r
                                                p
                                             
                                          
                                          
                                             (
                                             R
                                             ,
                                             v
                                             )
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                
                                                   σ
                                                
                                                ∈
                                                R
                                             
                                          
                                          
                                             (
                                             
                                                ω
                                                
                                                   f
                                                   c
                                                
                                             
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   |
                                                   σ
                                                   |
                                                   −
                                                   1
                                                
                                             
                                             
                                                F
                                                
                                                   
                                                      σ
                                                      i
                                                   
                                                   
                                                      σ
                                                      
                                                         i
                                                         +
                                                         1
                                                      
                                                   
                                                
                                                f
                                             
                                             
                                                (
                                                
                                                   v
                                                   
                                                      
                                                         σ
                                                         i
                                                      
                                                      
                                                         σ
                                                         
                                                            i
                                                            +
                                                            1
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             +
                                             
                                                ω
                                                
                                                   f
                                                   d
                                                
                                             
                                             
                                             
                                                (
                                                
                                                   t
                                                   
                                                      σ
                                                      
                                                         |
                                                         σ
                                                         |
                                                      
                                                   
                                                
                                                −
                                                
                                                   t
                                                   
                                                      σ
                                                      1
                                                   
                                                
                                                )
                                             
                                             )
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

This section deals with the optimization of speeds and departure times for a fixed route σ. To simplify the exposition, we will omit σ in the notations, and thus assume that customers are indexed by their order of appearance in the route.

The fuel consumption per distance unit 
                        
                           
                              F
                              
                                 i
                                 ,
                                 i
                                 +
                                 1
                              
                              f
                           
                           
                              (
                              
                                 v
                                 
                                    i
                                    ,
                                    i
                                    +
                                    1
                                 
                              
                              )
                           
                        
                      is a convex function. The speed value 
                        
                           v
                           f
                           *
                        
                      that minimizes fuel costs is given in Eq. (3). Similarly, for any arc 
                        
                           (
                           i
                           ,
                           
                              i
                              +
                              1
                           
                           )
                           ,
                        
                      assuming that there is no waiting time in the route after i, the speed value 
                        
                           
                              v
                              f
                              *
                           
                           d
                        
                      that minimizes fuel plus driver costs is expressed in Eq. (4):

                        
                           (3)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                d
                                                
                                                   F
                                                   
                                                      i
                                                      ,
                                                      i
                                                      +
                                                      1
                                                   
                                                   f
                                                
                                             
                                             
                                                d
                                                
                                                   v
                                                   
                                                      i
                                                      ,
                                                      i
                                                      +
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             (
                                             
                                                v
                                                f
                                                *
                                             
                                             )
                                          
                                          =
                                          0
                                          ⇔
                                          
                                             v
                                             f
                                             *
                                          
                                          =
                                          
                                             
                                                (
                                                
                                                   
                                                      w
                                                      1
                                                   
                                                   
                                                      2
                                                      
                                                         w
                                                         4
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                1
                                                /
                                                3
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (4)
                           
                              
                                 
                                    
                                       
                                          
                                             v
                                             f
                                             *
                                          
                                          d
                                          =
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ω
                                                               d
                                                            
                                                            c
                                                         
                                                         
                                                            
                                                               ω
                                                               f
                                                            
                                                            c
                                                         
                                                      
                                                      +
                                                      
                                                         w
                                                         1
                                                      
                                                   
                                                   
                                                      2
                                                      
                                                         w
                                                         4
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                1
                                                /
                                                3
                                             
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     For a fixed route, the speed and departure time optimization problem consists of finding the departure time from the depot and the optimal speeds for each arc while respecting customers’ time windows. To solve this problem, we propose an optimal recursive algorithm that extends those presented in Demir et al. (2012); Hvattum et al. (2013) and Kramer et al. (2015). It solves in quadratic time a special case of the time-dependent SOP of Franceschetti et al. (2013).

The algorithm relies on a general divide-and-conquer strategy, which iteratively solves a relaxed SOP obtained by ignoring time windows at intermediate destinations. If the resulting solution satisfies all constraints, then it is returned. Otherwise the customer p with maximum time-window violation is identified and its arrival time is set to its closest feasible value. Fixing this decision variable creates two sub-problems which are recursively solved (Algorithm 1
                     , lines 20–21). The novelty of this algorithm is the way it manages departure or arrival-time fixing within subproblems to converge towards optimal departure and speed decisions.

For a route with nσ
                      nodes (including the departure and return to the depot), Algorithm 1 is applied by setting the start s to 1 and the end e to nσ
                     . The departure time is first set to the earliest possible value 
                        
                           
                              t
                              1
                           
                           =
                           
                              a
                              1
                           
                        
                      (Algorithm 1, line 6). This decision will be revised later on. The arrival times at each customers are then derived as follows. The arrival time at the last customer when traveling at speed 
                        
                           
                              v
                              f
                              *
                           
                           d
                        
                      is determined and, in case of violation, updated to its closest time-window bound (Algorithm 1, line 8). This leads to a reference speed 
                        
                           
                              v
                              r
                           
                           e
                           f
                        
                      on the route (Algorithm 1, line 11) which is used to compute the arrival time at each customer as well as the maximum time-window violation (Algorithm 1, lines 12–17).
                  

In case of violation, two subproblems are recursively solved. Any subproblem starting at the depot is now solved without fixing the departure time. Indeed, the arrival time to the last customer of this sub-problem is already fixed, such that it is possible to evaluate the reference speed “backwards”, deriving the best departure time at the depot (Algorithm 1, line 10), and the customer arrival times. The other sub-problems are similarly solved. The recursion is repeated until all constraints are satisfied. Finally, when arrival times are known for all customers, the associated speeds are revised in such a way that any speed below 
                        
                           v
                           f
                           *
                        
                      is replaced by 
                        
                           v
                           f
                           *
                        
                      and a waiting time (Algorithm 1, lines 22–24).


                     Fig. 1 shows an execution example of the presented algorithm in a route involving seven nodes. The horizontal lines represent the customers and the brackets their corresponding time windows. Bullet points indicate the arrival times. The best departure and arrival times of this example are depicted in Fig. 1.f.

At each iteration, for a range of indices 
                        
                           (
                           s
                           ,
                           …
                           ,
                           e
                           )
                           ,
                        
                      the algorithm generates a solution with uniform speed starting from the earliest feasible time as
                      (lines 6 and 10 of Algorithm 1). The symmetric case (Line 8, where the arrival time is fixed) reduces to a fixed starting time with a change of variable. Then, the algorithm evaluates the largest infeasibility, either earliness or tardiness, when using the speed 
                        
                           
                              v
                              r
                           
                           e
                           f
                        
                      on the route. If no infeasibility is found, then the schedule is optimal. Otherwise, there exists one service time tK
                     , 
                        
                           K
                           ∈
                           {
                           s
                           +
                           1
                           ,
                           …
                           ,
                           e
                           −
                           1
                           }
                           ,
                        
                      with maximum constraint violation. This service time is fixed to its closest bound: 
                        
                           
                              t
                              K
                           
                           =
                           
                              a
                              K
                           
                        
                      in case of earliness, or 
                        
                           
                              t
                              K
                           
                           =
                           
                              b
                              K
                           
                        
                      in case of tardiness. Proving that at least one optimal solution exists, with this fixed variable, at each iteration would lead to the optimality of the algorithm. We will prove Theorem 1.

                        Theorem 1
                        
                           
                              
                                 (A)
                                 
                                    If the selected variable K corresponds to a late service, then there exists no optimal solution of the subproblem 
                                    t*
                                     
                                    such that
                                    
                                       
                                          
                                             t
                                             K
                                             *
                                          
                                          <
                                          
                                             b
                                             K
                                          
                                       
                                    
                                    .
                                 


                                    If the selected variable K corresponds to an early service, then there exists no optimal solution of the subproblem 
                                    t*
                                     
                                    such that
                                    
                                       
                                          
                                             t
                                             K
                                             *
                                          
                                          >
                                          
                                             a
                                             K
                                          
                                       
                                    
                                    .
                                 

The speed optimization subproblem is reformulated in Eqs. (5)–(7). The function 
                              
                                 c
                                 
                                    (
                                    x
                                    )
                                 
                                 =
                                 
                                    ω
                                    
                                       f
                                       c
                                    
                                 
                                 
                                    (
                                    
                                       w
                                       1
                                    
                                    x
                                    +
                                    
                                       w
                                       4
                                    
                                    /
                                    
                                       x
                                       2
                                    
                                    )
                                 
                                 +
                                 
                                    ω
                                    
                                       d
                                       c
                                    
                                 
                                 x
                              
                            is convex and smooth. Other constant members of the objective have been eliminated.

                              
                                 (5)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   min
                                                   
                                                      
                                                         t
                                                         s
                                                      
                                                      ,
                                                      …
                                                      ,
                                                      
                                                         t
                                                         e
                                                      
                                                   
                                                
                                                
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      s
                                                      +
                                                      1
                                                   
                                                   e
                                                
                                                
                                                   d
                                                   
                                                      i
                                                      −
                                                      1
                                                      ,
                                                      i
                                                   
                                                
                                                
                                                
                                                   c
                                                   ^
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            t
                                                            i
                                                         
                                                         −
                                                         
                                                            t
                                                            
                                                               i
                                                               −
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                         d
                                                         
                                                            i
                                                            −
                                                            1
                                                            ,
                                                            i
                                                         
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (6)
                                 
                                    
                                       
                                          
                                             
                                                s.t.
                                                
                                                
                                                   a
                                                   i
                                                
                                                ≤
                                                
                                                   t
                                                   i
                                                
                                                ≤
                                                
                                                   b
                                                   i
                                                
                                                
                                                s
                                                ≤
                                                i
                                                ≤
                                                e
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (7)
                                 
                                    
                                       
                                          
                                             
                                                with
                                                
                                                
                                                   c
                                                   ^
                                                
                                                
                                                   (
                                                   x
                                                   )
                                                
                                                =
                                                
                                                   {
                                                   
                                                      
                                                         
                                                            ∞
                                                         
                                                         
                                                            
                                                               
                                                                  for
                                                                  
                                                                  x
                                                                  ∈
                                                                  [
                                                                  0
                                                                  ,
                                                                  
                                                                     1
                                                                     
                                                                        v
                                                                        
                                                                           m
                                                                           a
                                                                           x
                                                                        
                                                                     
                                                                  
                                                                  [
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               c
                                                               (
                                                               x
                                                               )
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  for
                                                                  
                                                                  x
                                                                  ∈
                                                                  [
                                                                  
                                                                     1
                                                                     
                                                                        v
                                                                        
                                                                           m
                                                                           a
                                                                           x
                                                                        
                                                                     
                                                                  
                                                                  ,
                                                                  
                                                                     1
                                                                     
                                                                        v
                                                                        f
                                                                        *
                                                                     
                                                                  
                                                                  [
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               c
                                                               
                                                                  (
                                                                  
                                                                     
                                                                        1
                                                                        
                                                                           v
                                                                           f
                                                                           *
                                                                        
                                                                     
                                                                  
                                                                  )
                                                               
                                                               +
                                                               
                                                                  ω
                                                                  
                                                                     d
                                                                     c
                                                                  
                                                               
                                                               
                                                                  (
                                                                  
                                                                     x
                                                                     −
                                                                     
                                                                        1
                                                                        
                                                                           v
                                                                           f
                                                                           *
                                                                        
                                                                     
                                                                  
                                                                  )
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  for
                                                                  
                                                                  x
                                                                  ∈
                                                                  [
                                                                  
                                                                     1
                                                                     
                                                                        v
                                                                        f
                                                                        *
                                                                     
                                                                  
                                                                  ,
                                                                  ∞
                                                                  [
                                                                  .
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Function 
                              
                                 
                                    c
                                    ^
                                 
                                 
                                    (
                                    ·
                                    )
                                 
                              
                            returns the best per-mile cost, including possible waiting decisions. This function is also convex and smooth, and attains its minimum for 
                              
                                 x
                                 =
                                 1
                                 /
                                 
                                    v
                                    f
                                    *
                                 
                                 d
                              
                           . The necessary and sufficient Karush–Kuhn–Tucker (KKT) optimality conditions of this problem can be stated as follows. Associate the Lagrangian multipliers 
                              
                                 (
                                 
                                    μ
                                    s
                                    *
                                 
                                 ,
                                 …
                                 ,
                                 
                                    μ
                                    e
                                    *
                                 
                                 )
                              
                            to the constraints ai
                            ≤ ti
                           , and 
                              
                                 (
                                 
                                    λ
                                    s
                                    *
                                 
                                 ,
                                 …
                                 ,
                                 
                                    λ
                                    e
                                    *
                                 
                                 )
                              
                            to the constraints ti
                            ≤ bi
                           . A solution t*
                            of Eqs. (5)–(6) is optimal if and only if there exists (
                              μ
                           
                           *, 
                              λ
                           
                           *) such that

                              
                                 (8)
                                 
                                    
                                       
                                          
                                             
                                                {
                                                
                                                   
                                                      
                                                         
                                                            
                                                               a
                                                               i
                                                            
                                                            ≤
                                                            
                                                               t
                                                               i
                                                            
                                                            ≤
                                                            
                                                               b
                                                               i
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            i
                                                            ∈
                                                            {
                                                            s
                                                            ,
                                                            …
                                                            ,
                                                            e
                                                            }
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            −
                                                            
                                                               
                                                                  c
                                                                  ^
                                                               
                                                               ′
                                                            
                                                            
                                                               (
                                                               
                                                                  
                                                                     
                                                                        
                                                                           t
                                                                           
                                                                              s
                                                                              +
                                                                              1
                                                                           
                                                                        
                                                                        −
                                                                        
                                                                           t
                                                                           s
                                                                        
                                                                     
                                                                     
                                                                        d
                                                                        
                                                                           s
                                                                           ,
                                                                           s
                                                                           +
                                                                           1
                                                                        
                                                                     
                                                                  
                                                               
                                                               )
                                                            
                                                            +
                                                            
                                                               λ
                                                               s
                                                            
                                                            −
                                                            
                                                               μ
                                                               s
                                                            
                                                            =
                                                            0
                                                         
                                                      
                                                      
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  c
                                                                  ^
                                                               
                                                               ′
                                                            
                                                            
                                                               (
                                                               
                                                                  
                                                                     
                                                                        
                                                                           t
                                                                           i
                                                                        
                                                                        −
                                                                        
                                                                           t
                                                                           
                                                                              i
                                                                              −
                                                                              1
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        d
                                                                        
                                                                           i
                                                                           −
                                                                           1
                                                                           ,
                                                                           i
                                                                        
                                                                     
                                                                  
                                                               
                                                               )
                                                            
                                                            −
                                                            
                                                               
                                                                  c
                                                                  ^
                                                               
                                                               ′
                                                            
                                                            
                                                               (
                                                               
                                                                  
                                                                     
                                                                        
                                                                           t
                                                                           
                                                                              i
                                                                              +
                                                                              1
                                                                           
                                                                        
                                                                        −
                                                                        
                                                                           t
                                                                           i
                                                                        
                                                                     
                                                                     
                                                                        d
                                                                        
                                                                           i
                                                                           ,
                                                                           i
                                                                           +
                                                                           1
                                                                        
                                                                     
                                                                  
                                                               
                                                               )
                                                            
                                                            +
                                                            
                                                               λ
                                                               i
                                                            
                                                            −
                                                            
                                                               μ
                                                               i
                                                            
                                                            
                                                               
                                                               =
                                                               
                                                            
                                                            0
                                                         
                                                      
                                                      
                                                         
                                                            i
                                                            ∈
                                                            {
                                                            s
                                                            
                                                               
                                                               +
                                                               
                                                            
                                                            1
                                                            ,
                                                            …
                                                            ,
                                                            e
                                                            −
                                                            1
                                                            }
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  c
                                                                  ^
                                                               
                                                               ′
                                                            
                                                            
                                                               (
                                                               
                                                                  
                                                                     
                                                                        
                                                                           t
                                                                           e
                                                                        
                                                                        −
                                                                        
                                                                           t
                                                                           
                                                                              e
                                                                              −
                                                                              1
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        d
                                                                        
                                                                           e
                                                                           −
                                                                           1
                                                                           ,
                                                                           e
                                                                        
                                                                     
                                                                  
                                                               
                                                               )
                                                            
                                                            +
                                                            
                                                               λ
                                                               e
                                                            
                                                            −
                                                            
                                                               μ
                                                               e
                                                            
                                                            =
                                                            0
                                                         
                                                      
                                                      
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               λ
                                                               i
                                                            
                                                            
                                                               (
                                                               
                                                                  t
                                                                  i
                                                               
                                                               −
                                                               
                                                                  b
                                                                  i
                                                               
                                                               )
                                                            
                                                            =
                                                            0
                                                            
                                                            ;
                                                            
                                                            
                                                               λ
                                                               i
                                                            
                                                            ≥
                                                            0
                                                         
                                                      
                                                      
                                                         
                                                            i
                                                            ∈
                                                            {
                                                            s
                                                            ,
                                                            …
                                                            ,
                                                            e
                                                            }
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               μ
                                                               i
                                                            
                                                            
                                                               (
                                                               
                                                                  t
                                                                  i
                                                               
                                                               −
                                                               
                                                                  a
                                                                  i
                                                               
                                                               )
                                                            
                                                            =
                                                            0
                                                            
                                                            ;
                                                            
                                                            
                                                               μ
                                                               i
                                                            
                                                            ≥
                                                            0
                                                         
                                                      
                                                      
                                                         
                                                            i
                                                            ∈
                                                            {
                                                            s
                                                            ,
                                                            …
                                                            ,
                                                            e
                                                            }
                                                            .
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           These optimality conditions can be reformulated as in Eqs. (9)–(11):

                              
                                 (9)
                                 
                                    
                                       
                                          
                                             
                                                for
                                                
                                                i
                                                =
                                                s
                                                ,
                                                
                                                   {
                                                   
                                                      
                                                         
                                                            
                                                               either
                                                               
                                                               
                                                                  t
                                                                  s
                                                               
                                                               ∈
                                                               
                                                                  [
                                                                  
                                                                     a
                                                                     s
                                                                  
                                                                  ,
                                                                  
                                                                     b
                                                                     s
                                                                  
                                                                  ]
                                                               
                                                            
                                                         
                                                         
                                                            and
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           t
                                                                           
                                                                              s
                                                                              +
                                                                              1
                                                                           
                                                                        
                                                                        −
                                                                        
                                                                           t
                                                                           s
                                                                        
                                                                     
                                                                     
                                                                        d
                                                                        
                                                                           s
                                                                           ,
                                                                           s
                                                                           +
                                                                           1
                                                                        
                                                                     
                                                                  
                                                                  =
                                                                  
                                                                     1
                                                                     
                                                                        
                                                                           v
                                                                           f
                                                                           *
                                                                        
                                                                        d
                                                                     
                                                                  
                                                                  ,
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               or
                                                               
                                                               
                                                                  t
                                                                  s
                                                               
                                                               =
                                                               
                                                                  a
                                                                  s
                                                               
                                                            
                                                         
                                                         
                                                            and
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           t
                                                                           
                                                                              s
                                                                              +
                                                                              1
                                                                           
                                                                        
                                                                        −
                                                                        
                                                                           t
                                                                           s
                                                                        
                                                                     
                                                                     
                                                                        d
                                                                        
                                                                           s
                                                                           ,
                                                                           s
                                                                           +
                                                                           1
                                                                        
                                                                     
                                                                  
                                                                  ≤
                                                                  
                                                                     1
                                                                     
                                                                        
                                                                           v
                                                                           f
                                                                           *
                                                                        
                                                                        d
                                                                     
                                                                  
                                                                  ,
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               or
                                                               
                                                               
                                                                  t
                                                                  s
                                                               
                                                               =
                                                               
                                                                  b
                                                                  s
                                                               
                                                            
                                                         
                                                         
                                                            and
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           t
                                                                           
                                                                              s
                                                                              +
                                                                              1
                                                                           
                                                                        
                                                                        −
                                                                        
                                                                           t
                                                                           s
                                                                        
                                                                     
                                                                     
                                                                        d
                                                                        
                                                                           s
                                                                           ,
                                                                           s
                                                                           +
                                                                           1
                                                                        
                                                                     
                                                                  
                                                                  ≥
                                                                  
                                                                     1
                                                                     
                                                                        
                                                                           v
                                                                           f
                                                                           *
                                                                        
                                                                        d
                                                                     
                                                                  
                                                                  ;
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (10)
                                 
                                    
                                       
                                          
                                          
                                          
                                             
                                                for
                                                
                                                each
                                                
                                                i
                                                ∈
                                                {
                                                s
                                                +
                                                1
                                                ,
                                                …
                                                ,
                                                e
                                                −
                                                1
                                                }
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                
                                                
                                                
                                                
                                                   {
                                                   
                                                      
                                                         
                                                            
                                                               either
                                                               
                                                               
                                                                  t
                                                                  i
                                                               
                                                               ∈
                                                               
                                                                  [
                                                                  
                                                                     a
                                                                     i
                                                                  
                                                                  ,
                                                                  
                                                                     b
                                                                     i
                                                                  
                                                                  ]
                                                               
                                                            
                                                         
                                                         
                                                            and
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           t
                                                                           i
                                                                        
                                                                        −
                                                                        
                                                                           t
                                                                           
                                                                              i
                                                                              −
                                                                              1
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        d
                                                                        
                                                                           i
                                                                           −
                                                                           1
                                                                           ,
                                                                           i
                                                                        
                                                                     
                                                                  
                                                                  =
                                                                  
                                                                     
                                                                        
                                                                           t
                                                                           
                                                                              i
                                                                              +
                                                                              1
                                                                           
                                                                        
                                                                        −
                                                                        
                                                                           t
                                                                           i
                                                                        
                                                                     
                                                                     
                                                                        d
                                                                        
                                                                           i
                                                                           ,
                                                                           i
                                                                           +
                                                                           1
                                                                        
                                                                     
                                                                  
                                                                  ,
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               or
                                                               
                                                               
                                                                  t
                                                                  i
                                                               
                                                               =
                                                               
                                                                  a
                                                                  i
                                                               
                                                            
                                                         
                                                         
                                                            and
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           t
                                                                           i
                                                                        
                                                                        −
                                                                        
                                                                           t
                                                                           
                                                                              i
                                                                              −
                                                                              1
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        d
                                                                        
                                                                           i
                                                                           −
                                                                           1
                                                                           ,
                                                                           i
                                                                        
                                                                     
                                                                  
                                                                  ≥
                                                                  
                                                                     
                                                                        
                                                                           t
                                                                           
                                                                              i
                                                                              +
                                                                              1
                                                                           
                                                                        
                                                                        −
                                                                        
                                                                           t
                                                                           i
                                                                        
                                                                     
                                                                     
                                                                        d
                                                                        
                                                                           i
                                                                           ,
                                                                           i
                                                                           +
                                                                           1
                                                                        
                                                                     
                                                                  
                                                                  ,
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               or
                                                               
                                                               
                                                                  t
                                                                  i
                                                               
                                                               =
                                                               
                                                                  b
                                                                  i
                                                               
                                                            
                                                         
                                                         
                                                            and
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           t
                                                                           i
                                                                        
                                                                        −
                                                                        
                                                                           t
                                                                           
                                                                              i
                                                                              −
                                                                              1
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        d
                                                                        
                                                                           i
                                                                           −
                                                                           1
                                                                           ,
                                                                           i
                                                                        
                                                                     
                                                                  
                                                                  ≤
                                                                  
                                                                     
                                                                        
                                                                           t
                                                                           
                                                                              i
                                                                              +
                                                                              1
                                                                           
                                                                        
                                                                        −
                                                                        
                                                                           t
                                                                           i
                                                                        
                                                                     
                                                                     
                                                                        d
                                                                        
                                                                           i
                                                                           ,
                                                                           i
                                                                           +
                                                                           1
                                                                        
                                                                     
                                                                  
                                                                  ;
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (11)
                                 
                                    
                                       
                                          
                                             
                                                for
                                                
                                                i
                                                =
                                                e
                                                ,
                                                
                                                   {
                                                   
                                                      
                                                         
                                                            
                                                               either
                                                               
                                                               
                                                                  t
                                                                  e
                                                               
                                                               ∈
                                                               
                                                                  [
                                                                  
                                                                     a
                                                                     e
                                                                  
                                                                  ,
                                                                  
                                                                     b
                                                                     e
                                                                  
                                                                  ]
                                                               
                                                            
                                                         
                                                         
                                                            and
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           t
                                                                           e
                                                                        
                                                                        −
                                                                        
                                                                           t
                                                                           
                                                                              e
                                                                              −
                                                                              1
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        d
                                                                        
                                                                           e
                                                                           −
                                                                           1
                                                                           ,
                                                                           e
                                                                        
                                                                     
                                                                  
                                                                  =
                                                                  
                                                                     1
                                                                     
                                                                        
                                                                           v
                                                                           f
                                                                           *
                                                                        
                                                                        d
                                                                     
                                                                  
                                                                  ,
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               or
                                                               
                                                               
                                                                  t
                                                                  e
                                                               
                                                               =
                                                               
                                                                  a
                                                                  e
                                                               
                                                            
                                                         
                                                         
                                                            and
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           t
                                                                           e
                                                                        
                                                                        −
                                                                        
                                                                           t
                                                                           
                                                                              e
                                                                              −
                                                                              1
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        d
                                                                        
                                                                           e
                                                                           −
                                                                           1
                                                                           ,
                                                                           e
                                                                        
                                                                     
                                                                  
                                                                  ≥
                                                                  
                                                                     1
                                                                     
                                                                        
                                                                           v
                                                                           f
                                                                           *
                                                                        
                                                                        d
                                                                     
                                                                  
                                                                  ,
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               or
                                                               
                                                               
                                                                  t
                                                                  e
                                                               
                                                               =
                                                               
                                                                  b
                                                                  e
                                                               
                                                            
                                                         
                                                         
                                                            and
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           t
                                                                           e
                                                                        
                                                                        −
                                                                        
                                                                           t
                                                                           
                                                                              e
                                                                              −
                                                                              1
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        d
                                                                        
                                                                           e
                                                                           −
                                                                           1
                                                                           ,
                                                                           e
                                                                        
                                                                     
                                                                  
                                                                  ≤
                                                                  
                                                                     1
                                                                     
                                                                        
                                                                           v
                                                                           f
                                                                           *
                                                                        
                                                                        d
                                                                     
                                                                  
                                                                  .
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                        

Now, suppose that the algorithm found a maximum tardiness for the index K, and that there exists an optimal solution t*
                            such that 
                              
                                 
                                    t
                                    K
                                    *
                                 
                                 <
                                 
                                    b
                                    K
                                 
                              
                           . We will show by contradiction that such a solution cannot be optimal.

Let the index I be defined as 
                              
                                 I
                                 =
                                 max
                                 {
                                 
                                    {
                                    i
                                    
                                    |
                                    
                                    i
                                    <
                                    K
                                    
                                    and
                                    
                                    
                                       t
                                       i
                                       *
                                    
                                    =
                                    
                                       b
                                       i
                                    
                                    }
                                 
                                 ∪
                                 
                                    {
                                    s
                                    }
                                 
                                 }
                                 ,
                              
                            that is, the largest index i smaller than K such that 
                              
                                 
                                    t
                                    i
                                    *
                                 
                                 =
                                 
                                    b
                                    i
                                 
                                 ,
                              
                            or s if no such index exists. As such, either 
                              
                                 
                                    t
                                    I
                                    *
                                 
                                 =
                                 
                                    b
                                    I
                                 
                              
                            
                           or
                           
                              
                                 {
                                 I
                                 =
                                 s
                              
                            
                           and
                           
                              
                                 
                                    t
                                    s
                                    *
                                 
                                 <
                                 
                                    b
                                    s
                                 
                                 
                                    }
                                 
                              
                           .

Similarly, let the index J be defined as 
                              
                                 J
                                 =
                                 min
                                 {
                                 
                                    {
                                    j
                                    
                                    |
                                    
                                    j
                                    >
                                    K
                                    
                                    and
                                    
                                    
                                       t
                                       j
                                       *
                                    
                                    =
                                    
                                       b
                                       i
                                    
                                    }
                                 
                                 ∪
                                 
                                    {
                                    e
                                    }
                                 
                                 }
                              
                           . As such, either 
                              
                                 
                                    t
                                    J
                                    *
                                 
                                 =
                                 
                                    b
                                    J
                                 
                              
                            
                           or
                           
                              
                                 {
                                 J
                                 =
                                 e
                              
                            
                           and
                           
                              
                                 
                                    t
                                    J
                                    *
                                 
                                 <
                                 
                                    b
                                    J
                                 
                                 
                                    }
                                 
                              
                           .

From the definition of I and J, 
                              
                                 
                                    t
                                    i
                                    *
                                 
                                 <
                                 
                                    b
                                    i
                                 
                              
                            for 
                              
                                 i
                                 ∈
                                 {
                                 I
                                 +
                                 1
                                 ,
                                 …
                                 ,
                                 J
                                 −
                                 1
                                 }
                                 ,
                              
                            and thus, from the optimality conditions of Eq. (10), we obtain

                              
                                 (12)
                                 
                                    
                                       
                                          
                                             
                                                t
                                                i
                                                *
                                             
                                             −
                                             
                                                t
                                                
                                                   i
                                                   −
                                                   1
                                                
                                                *
                                             
                                          
                                          
                                             d
                                             
                                                i
                                                −
                                                1
                                                ,
                                                i
                                             
                                          
                                       
                                       ≥
                                       
                                          
                                             
                                                t
                                                
                                                   i
                                                   +
                                                   1
                                                
                                                *
                                             
                                             −
                                             
                                                t
                                                i
                                                *
                                             
                                          
                                          
                                             d
                                             
                                                i
                                                ,
                                                i
                                                +
                                                1
                                             
                                          
                                       
                                       
                                       for
                                       
                                       i
                                       ∈
                                       
                                          {
                                          I
                                          +
                                          1
                                          ,
                                          …
                                          ,
                                          J
                                          −
                                          1
                                          }
                                       
                                       .
                                    
                                 
                              
                           
                        

Now, recall that K is the maximum tardiness obtained from a solution with constant speed 
                              
                                 
                                    v
                                    r
                                 
                                 e
                                 f
                                 ,
                              
                            such that 
                              
                                 
                                    v
                                    r
                                 
                                 e
                                 f
                                 ≥
                                 
                                    v
                                    f
                                    *
                                 
                                 d
                                 ,
                              
                            starting from as
                           . Hence,

                              
                                 (13)
                                 
                                    
                                       
                                          
                                             
                                                a
                                                s
                                             
                                          
                                          
                                             +
                                          
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      s
                                                   
                                                   
                                                      K
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      d
                                                      
                                                         i
                                                         ,
                                                         i
                                                         +
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         v
                                                         r
                                                      
                                                      e
                                                      f
                                                   
                                                
                                                −
                                                
                                                   b
                                                   K
                                                
                                                ≥
                                                
                                                   a
                                                   s
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      s
                                                   
                                                   
                                                      I
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      d
                                                      
                                                         i
                                                         ,
                                                         i
                                                         +
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         v
                                                         r
                                                      
                                                      e
                                                      f
                                                   
                                                
                                                −
                                                
                                                   b
                                                   I
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                          
                                          
                                             ⇒
                                          
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      I
                                                   
                                                   
                                                      K
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      d
                                                      
                                                         i
                                                         ,
                                                         i
                                                         +
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         v
                                                         r
                                                      
                                                      e
                                                      f
                                                   
                                                
                                                ≥
                                                
                                                   b
                                                   K
                                                
                                                −
                                                
                                                   b
                                                   I
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (14)
                                 
                                    
                                       
                                          
                                             
                                                a
                                                s
                                             
                                          
                                          
                                             +
                                          
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      s
                                                   
                                                   
                                                      K
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      d
                                                      
                                                         i
                                                         ,
                                                         i
                                                         +
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         v
                                                         r
                                                      
                                                      e
                                                      f
                                                   
                                                
                                                −
                                                
                                                   b
                                                   K
                                                
                                                ≥
                                                
                                                   a
                                                   s
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      s
                                                   
                                                   
                                                      J
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      d
                                                      
                                                         i
                                                         ,
                                                         i
                                                         +
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         v
                                                         r
                                                      
                                                      e
                                                      f
                                                   
                                                
                                                −
                                                
                                                   b
                                                   J
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                          
                                          
                                             ⇒
                                          
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      K
                                                   
                                                   
                                                      J
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      d
                                                      
                                                         i
                                                         ,
                                                         i
                                                         +
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         v
                                                         r
                                                      
                                                      e
                                                      f
                                                   
                                                
                                                ≤
                                                
                                                   b
                                                   J
                                                
                                                −
                                                
                                                   b
                                                   K
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 •
                                 If 
                                       
                                          
                                             t
                                             I
                                             *
                                          
                                          =
                                          
                                             b
                                             I
                                          
                                          ,
                                       
                                     then 
                                       
                                          
                                             b
                                             K
                                          
                                          −
                                          
                                             b
                                             I
                                          
                                          >
                                          
                                             t
                                             K
                                             *
                                          
                                          −
                                          
                                             t
                                             I
                                             *
                                          
                                       
                                    . Eq. (13) leads to:

                                       
                                          (15)
                                          
                                             
                                                
                                                   
                                                   
                                                   
                                                      
                                                         
                                                            ∑
                                                            
                                                               i
                                                               =
                                                               I
                                                            
                                                            
                                                               K
                                                               −
                                                               1
                                                            
                                                         
                                                         
                                                            
                                                               d
                                                               
                                                                  i
                                                                  ,
                                                                  i
                                                                  +
                                                                  1
                                                               
                                                            
                                                            
                                                               
                                                                  v
                                                                  r
                                                               
                                                               e
                                                               f
                                                            
                                                         
                                                         ≥
                                                         
                                                            b
                                                            K
                                                         
                                                         −
                                                         
                                                            b
                                                            I
                                                         
                                                         >
                                                         
                                                            t
                                                            K
                                                            *
                                                         
                                                         −
                                                         
                                                            t
                                                            I
                                                            *
                                                         
                                                         ,
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                   
                                                      
                                                         with
                                                         
                                                         
                                                            t
                                                            K
                                                            *
                                                         
                                                         −
                                                         
                                                            t
                                                            I
                                                            *
                                                         
                                                         =
                                                         
                                                            ∑
                                                            
                                                               i
                                                               =
                                                               I
                                                            
                                                            
                                                               K
                                                               −
                                                               1
                                                            
                                                         
                                                         
                                                            (
                                                            
                                                               t
                                                               
                                                                  i
                                                                  +
                                                                  1
                                                               
                                                               *
                                                            
                                                            −
                                                            
                                                               t
                                                               i
                                                               *
                                                            
                                                            )
                                                         
                                                         =
                                                         
                                                            ∑
                                                            
                                                               i
                                                               =
                                                               I
                                                            
                                                            
                                                               K
                                                               −
                                                               1
                                                            
                                                         
                                                         
                                                            d
                                                            
                                                               i
                                                               ,
                                                               i
                                                               +
                                                               1
                                                            
                                                         
                                                         ×
                                                         
                                                            
                                                               
                                                                  t
                                                                  
                                                                     i
                                                                     +
                                                                     1
                                                                  
                                                                  *
                                                               
                                                               −
                                                               
                                                                  t
                                                                  i
                                                                  *
                                                               
                                                            
                                                            
                                                               d
                                                               
                                                                  i
                                                                  ,
                                                                  i
                                                                  +
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                   
                                                      
                                                         ⇒
                                                         
                                                         
                                                            ∑
                                                            
                                                               i
                                                               =
                                                               I
                                                            
                                                            
                                                               K
                                                               −
                                                               1
                                                            
                                                         
                                                         
                                                            
                                                               d
                                                               
                                                                  i
                                                                  ,
                                                                  i
                                                                  +
                                                                  1
                                                               
                                                            
                                                            
                                                               
                                                                  v
                                                                  r
                                                               
                                                               e
                                                               f
                                                            
                                                         
                                                         >
                                                         
                                                            ∑
                                                            
                                                               i
                                                               =
                                                               I
                                                            
                                                            
                                                               K
                                                               −
                                                               1
                                                            
                                                         
                                                         
                                                            d
                                                            
                                                               i
                                                               ,
                                                               i
                                                               +
                                                               1
                                                            
                                                         
                                                         ×
                                                         
                                                            
                                                               
                                                                  t
                                                                  
                                                                     i
                                                                     +
                                                                     1
                                                                  
                                                                  *
                                                               
                                                               −
                                                               
                                                                  t
                                                                  i
                                                                  *
                                                               
                                                            
                                                            
                                                               d
                                                               
                                                                  i
                                                                  ,
                                                                  i
                                                                  +
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                   
                                                      
                                                         ⇒
                                                         
                                                         ∃
                                                         
                                                         i
                                                         ∈
                                                         
                                                            {
                                                            I
                                                            ,
                                                            …
                                                            ,
                                                            K
                                                            −
                                                            1
                                                            }
                                                         
                                                         
                                                         such
                                                         
                                                         that
                                                         
                                                         
                                                            1
                                                            
                                                               
                                                                  v
                                                                  r
                                                               
                                                               e
                                                               f
                                                            
                                                         
                                                         >
                                                         
                                                            
                                                               
                                                                  t
                                                                  
                                                                     i
                                                                     +
                                                                     1
                                                                  
                                                                  *
                                                               
                                                               −
                                                               
                                                                  t
                                                                  i
                                                                  *
                                                               
                                                            
                                                            
                                                               d
                                                               
                                                                  i
                                                                  ,
                                                                  i
                                                                  +
                                                                  1
                                                               
                                                            
                                                         
                                                         .
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 

Else 
                                       
                                          {
                                          I
                                          =
                                          s
                                       
                                     and 
                                       
                                          
                                             t
                                             s
                                             *
                                          
                                          <
                                          
                                             b
                                             s
                                          
                                          
                                             }
                                          
                                       
                                    . We have:

                                       
                                          (16)
                                          
                                             
                                                
                                                   
                                                   
                                                   
                                                      
                                                         
                                                            t
                                                            K
                                                            *
                                                         
                                                         −
                                                         
                                                            t
                                                            s
                                                            *
                                                         
                                                         <
                                                         
                                                            b
                                                            K
                                                         
                                                         −
                                                         
                                                            a
                                                            s
                                                         
                                                         ≤
                                                         
                                                            ∑
                                                            
                                                               i
                                                               =
                                                               s
                                                            
                                                            
                                                               K
                                                               −
                                                               1
                                                            
                                                         
                                                         
                                                            
                                                               d
                                                               
                                                                  i
                                                                  ,
                                                                  i
                                                                  +
                                                                  1
                                                               
                                                            
                                                            
                                                               
                                                                  v
                                                                  r
                                                               
                                                               e
                                                               f
                                                            
                                                         
                                                         ,
                                                         
                                                         and
                                                         
                                                         similarly
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                   
                                                      
                                                         ⇒
                                                         
                                                         ∃
                                                         
                                                         i
                                                         ∈
                                                         
                                                            {
                                                            I
                                                            ,
                                                            …
                                                            ,
                                                            K
                                                            −
                                                            1
                                                            }
                                                         
                                                         
                                                         
                                                         such
                                                         
                                                         that
                                                         
                                                         
                                                         
                                                            1
                                                            
                                                               
                                                                  v
                                                                  r
                                                               
                                                               e
                                                               f
                                                            
                                                         
                                                         >
                                                         
                                                            
                                                               
                                                                  t
                                                                  
                                                                     i
                                                                     +
                                                                     1
                                                                  
                                                                  *
                                                               
                                                               −
                                                               
                                                                  t
                                                                  i
                                                                  *
                                                               
                                                            
                                                            
                                                               d
                                                               
                                                                  i
                                                                  ,
                                                                  i
                                                                  +
                                                                  1
                                                               
                                                            
                                                         
                                                         .
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 

If 
                                       
                                          
                                             t
                                             J
                                             *
                                          
                                          =
                                          
                                             b
                                             J
                                          
                                          ,
                                       
                                     then 
                                       
                                          
                                             b
                                             J
                                          
                                          −
                                          
                                             b
                                             K
                                          
                                          <
                                          
                                             t
                                             J
                                             *
                                          
                                          −
                                          
                                             t
                                             K
                                             *
                                          
                                       
                                    . Eq. (14) leads to:

                                       
                                          (17)
                                          
                                             
                                                
                                                   
                                                   
                                                   
                                                      
                                                         
                                                            ∑
                                                            
                                                               j
                                                               =
                                                               K
                                                            
                                                            
                                                               J
                                                               −
                                                               1
                                                            
                                                         
                                                         
                                                            
                                                               d
                                                               
                                                                  j
                                                                  ,
                                                                  j
                                                                  +
                                                                  1
                                                               
                                                            
                                                            
                                                               
                                                                  v
                                                                  r
                                                               
                                                               e
                                                               f
                                                            
                                                         
                                                         ≤
                                                         
                                                            b
                                                            J
                                                         
                                                         −
                                                         
                                                            b
                                                            K
                                                         
                                                         <
                                                         
                                                            t
                                                            J
                                                            *
                                                         
                                                         −
                                                         
                                                            t
                                                            K
                                                            *
                                                         
                                                         ,
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                   
                                                      
                                                         
                                                         with
                                                         
                                                         
                                                            t
                                                            J
                                                            *
                                                         
                                                         −
                                                         
                                                            t
                                                            K
                                                            *
                                                         
                                                         =
                                                         
                                                            ∑
                                                            
                                                               j
                                                               =
                                                               K
                                                            
                                                            
                                                               J
                                                               −
                                                               1
                                                            
                                                         
                                                         
                                                            (
                                                            
                                                               t
                                                               
                                                                  j
                                                                  +
                                                                  1
                                                               
                                                               *
                                                            
                                                            −
                                                            
                                                               t
                                                               j
                                                               *
                                                            
                                                            )
                                                         
                                                         =
                                                         
                                                            ∑
                                                            
                                                               j
                                                               =
                                                               K
                                                            
                                                            
                                                               J
                                                               −
                                                               1
                                                            
                                                         
                                                         
                                                            d
                                                            
                                                               j
                                                               ,
                                                               j
                                                               +
                                                               1
                                                            
                                                         
                                                         ×
                                                         
                                                            
                                                               
                                                                  t
                                                                  
                                                                     j
                                                                     +
                                                                     1
                                                                  
                                                                  *
                                                               
                                                               −
                                                               
                                                                  t
                                                                  j
                                                                  *
                                                               
                                                            
                                                            
                                                               d
                                                               
                                                                  j
                                                                  ,
                                                                  j
                                                                  +
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                   
                                                      
                                                         ⇒
                                                         
                                                         
                                                            ∑
                                                            
                                                               j
                                                               =
                                                               K
                                                            
                                                            
                                                               J
                                                               −
                                                               1
                                                            
                                                         
                                                         
                                                            
                                                               d
                                                               
                                                                  j
                                                                  ,
                                                                  j
                                                                  +
                                                                  1
                                                               
                                                            
                                                            
                                                               
                                                                  v
                                                                  r
                                                               
                                                               e
                                                               f
                                                            
                                                         
                                                         <
                                                         
                                                            ∑
                                                            
                                                               j
                                                               =
                                                               K
                                                            
                                                            
                                                               J
                                                               −
                                                               1
                                                            
                                                         
                                                         
                                                            d
                                                            
                                                               j
                                                               ,
                                                               j
                                                               +
                                                               1
                                                            
                                                         
                                                         ×
                                                         
                                                            
                                                               
                                                                  t
                                                                  
                                                                     j
                                                                     +
                                                                     1
                                                                  
                                                                  *
                                                               
                                                               −
                                                               
                                                                  t
                                                                  j
                                                                  *
                                                               
                                                            
                                                            
                                                               d
                                                               
                                                                  j
                                                                  ,
                                                                  j
                                                                  +
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                   
                                                      
                                                         ⇒
                                                         
                                                         ∃
                                                         
                                                         j
                                                         ∈
                                                         
                                                            {
                                                            K
                                                            ,
                                                            ⋯
                                                            ,
                                                            J
                                                            −
                                                            1
                                                            }
                                                         
                                                         
                                                         such
                                                         
                                                         that
                                                         
                                                         
                                                            1
                                                            
                                                               
                                                                  v
                                                                  r
                                                               
                                                               e
                                                               f
                                                            
                                                         
                                                         <
                                                         
                                                            
                                                               
                                                                  t
                                                                  
                                                                     j
                                                                     +
                                                                     1
                                                                  
                                                                  *
                                                               
                                                               −
                                                               
                                                                  t
                                                                  j
                                                                  *
                                                               
                                                            
                                                            
                                                               d
                                                               
                                                                  j
                                                                  ,
                                                                  j
                                                                  +
                                                                  1
                                                               
                                                            
                                                         
                                                         .
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 

Else 
                                       
                                          {
                                          J
                                          =
                                          e
                                       
                                     and 
                                       
                                          
                                             t
                                             e
                                             *
                                          
                                          <
                                          
                                             b
                                             e
                                             *
                                          
                                          
                                             }
                                             ,
                                          
                                       
                                     then the condition of Eq. (11) states that 
                                       
                                          
                                             1
                                             
                                                
                                                   v
                                                   f
                                                   *
                                                
                                                d
                                             
                                          
                                          ≤
                                          
                                             
                                                
                                                   t
                                                   e
                                                   *
                                                
                                                −
                                                
                                                   t
                                                   
                                                      e
                                                      −
                                                      1
                                                   
                                                   *
                                                
                                             
                                             
                                                d
                                                
                                                   e
                                                   −
                                                   1
                                                   ,
                                                   e
                                                
                                             
                                          
                                       
                                    . Since 
                                       
                                          
                                             v
                                             f
                                             *
                                          
                                          d
                                          ≤
                                          
                                             v
                                             r
                                          
                                          e
                                          f
                                          ,
                                       
                                     this leads to the same statement as Eq. (17).

Overall, Eqs. (15–17) lead to:

                                       
                                          (18)
                                          
                                             
                                                
                                                   ∃
                                                   
                                                   
                                                      (
                                                      i
                                                      ,
                                                      j
                                                      )
                                                   
                                                   
                                                   |
                                                   
                                                   i
                                                   <
                                                   K
                                                   ≤
                                                   j
                                                   ,
                                                   
                                                   such
                                                   
                                                   that
                                                   
                                                
                                                
                                                   
                                                      
                                                         t
                                                         
                                                            i
                                                            +
                                                            1
                                                         
                                                         *
                                                      
                                                      −
                                                      
                                                         t
                                                         i
                                                         *
                                                      
                                                   
                                                   
                                                      d
                                                      
                                                         i
                                                         ,
                                                         i
                                                         +
                                                         1
                                                      
                                                   
                                                
                                                <
                                                
                                                   1
                                                   
                                                      
                                                         v
                                                         r
                                                      
                                                      e
                                                      f
                                                   
                                                
                                                ≤
                                                
                                                   
                                                      
                                                         t
                                                         
                                                            j
                                                            +
                                                            1
                                                         
                                                         *
                                                      
                                                      −
                                                      
                                                         t
                                                         j
                                                         *
                                                      
                                                   
                                                   
                                                      d
                                                      
                                                         j
                                                         ,
                                                         j
                                                         +
                                                         1
                                                      
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    
                                 

This is a direct contradiction of Eq. (12). Our original assumption, that there exists an optimal solution with 
                              
                                 
                                    t
                                    K
                                    *
                                 
                                 <
                                 
                                    b
                                    K
                                 
                              
                            is impossible, hence completing the proof of statement A). The proof of case B) is analogous.□

The proposed algorithm was integrated into the ILS-SP-SOA matheuristic of Kramer et al. (2015), which makes
                      use of an adaptive speed matrix during the search to keep track of speed decisions. The speed and departure time optimization algorithm is executed on each route associated to a local optimum of ILS. These routes are also stored in a pool and used to generate new solutions by means of integer programming over a set partitioning (SP) formulation.

We tested the method on the instances of Demir et al. (2012) and Kramer et al. (2015), containing between 10 and 200 customers. The coefficients of the objective function were set to the same values as Kramer et al. (2015). The algorithm was implemented in C++ and executed on an Intel i7 3.40 GHz processor with 16 GB of RAM, using CPLEX 12.4.


                     Table 1 reports the results of these experiments. Ten independent runs were done for each instance, and each line corresponds to averaged results on a set of 20 instances. All detailed results are available at http://w1.cirrelt.ca/∼vidalt/en/VRP-resources.html. The new solutions are compared to the previous best known solutions (BKS) from Kramer et al. (2015), which did not consider departure-time delays. The rightmost part of the table also reports the effects of departure time optimization, in percentage, on labor costs, fuel and distance (comparing our best solution to the BKS).

In light of these results, allowing delayed departures times can lead to significant reductions of operational costs (
                        
                           −
                           8.36
                        
                      percent on average). Instances with tighter time-windows (sets B and C) tend to be more prone for solution quality improvement based on delays at the depot, as illustrated in Fig. 2 for individual instances.

The main cost improvements originate, as expected, from reduced labor costs (
                        
                           −
                           15.72
                        
                      percent). Moreover, we also notice a quasi-systematic decrease of driven distance (
                        
                           −
                           0.49
                        
                      percent). Delayed departure time optimization indeed leads to a larger set of good-quality candidate routes, increasing the size of the search space, resulting in further opportunities of distance minimization.

The impact on pollution emissions depends on the tightness of the time constraints. For all benchmark sets of type A, with large time windows, a reduction can be observed (
                        
                           −
                           0.48
                        
                      percent) as a consequence of the improvement in total distance. For most benchmark sets of type B and C, with tight time windows, we observe a moderate but consistent increase of fuel consumption (1.18 percent). This is an indirect consequence of the optimality conditions of the SOP. Indeed, when confronted with an active time-window constraint of the type ai
                      ≤ t, early in the route, the speed optimization algorithm with fixed departure time creates a waiting time followed by a travel at speed 
                        
                           v
                           f
                           *
                        
                      (minimal emissions since the labor costs are constant). This is illustrated on the left of Fig. 3.

In contrast, the speed and departure time optimization algorithm will delay the departure, using the speed 
                        
                           
                              v
                              f
                              *
                           
                           d
                        
                      (minimal emissions + labor costs, such that 
                        
                           
                              v
                              f
                              *
                           
                           d
                           ≥
                           
                              v
                              f
                              *
                           
                        
                     ) to arrive exactly on time to the first active constraint, as illustrated on the right part of Fig. 3. This effect is particularly visible on instances with more induced waiting times and opportunities of labor cost reductions.

@&#CONCLUSIONS@&#

A new speed and departure time optimization algorithm for the PRP has been presented. This algorithm is conceptually simple, runs in quadratic time, and is guaranteed to produce an optimal solution. It was implemented and integrated in the matheuristic of Kramer et al. (2015), where departure time and speed optimizations occur for each local minimum of the iterated local search. Our experimental results with this heuristic showed that delayed departure times from the depot can lead to very significant savings: up to 8.36 percent operational costs for the considered benchmark sets.

Overall, integrated scheduling, speed control, and routing optimization can help to reduce costs and environmental fingerprints in a variety of other industrial domains. The proposed methodology has contributed to address some open challenges related to combined speed and schedule optimization. Further research can now be focused on generalizing these methods to broader application classes. In particular, arc-dependent cost/speed functions are very relevant for ship operations in the presence of variable weather and sea conditions. However, no efficient algorithm is known for this setting.

@&#ACKNOWLEDGMENTS@&#

This research was partially supported by the Instituto Nacional de Ciência e Tecnologia (INCT/Brazil), grant 557128/2009-9, and by the Conselho Nacional de Desenvolvimento Científico e Tecnológico (CNPq/Brazil), grants 471158/2012-7 and 201222/2014-0.

@&#REFERENCES@&#

