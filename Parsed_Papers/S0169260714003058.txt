@&#MAIN-TITLE@&#Automated detection of fovea in fundus images based on vessel-free zone and adaptive Gaussian template

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We developed a method for automated detection of fovea in fundus images based on vessel-free zone and adaptive Gaussian template.


                        
                        
                           
                           The proposed method constrained the search region based on the vessel-free region and did not need the segmentation of vessels.


                        
                        
                           
                           The proposed method was evaluated using three publicly available databases (DIARETDB0, DIARETDB1 and MESSIDOR).


                        
                        
                           
                           The proposed method obtained the fovea detection accuracy of 97.0%.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Fovea centre detection

Fundus image

Vessel-free zone

Gaussian template

@&#ABSTRACT@&#


               
               
                  This study developed a computerised method for fovea centre detection in fundus images. In the method, the centre of the optic disc was localised first by the template matching method, the disc–fovea axis (a line connecting the optic disc centre and the fovea) was then determined by searching the vessel-free region, and finally the fovea centre was detected by matching the fovea template around the centre of the axis. Adaptive Gaussian templates were used to localise the centres of the optic disc and fovea for the images with different resolutions. The proposed method was evaluated using three publicly available databases (DIARETDB0, DIARETDB1 and MESSIDOR), which consisted of a total of 1419 fundus images with different resolutions. The proposed method obtained the fovea detection accuracies of 93.1%, 92.1% and 97.8% for the DIARETDB0, DIARETDB1 and MESSIDOR databases, respectively. The overall accuracy of the proposed method was 97.0% in this study.
               
            

@&#INTRODUCTION@&#

The fovea is a part of the eye located in the centre of the macular region of the retina, and is responsible for sharp central vision. In a fundus image, a dark circular area represents the macula, and the fovea is located at the centre of the dark region. Damage to the macular region would cause vision loss or blindness. The lesions located close to the fovea would cause more serious damage, and the distance between the lesions and the fovea has clinical relevance to the extent of damage [1]. Hence, for automated analysis of the fundus retinal images, detection of the fovea is essential.

Several methods for the fovea detection have been proposed, most of which were performed in two stages. In the first stage, a constraining region was defined for searching the fovea. In the second stage, an algorithm for the fovea detection was applied in the defined region. In addition to the two-stage approach, Niemeijer et al. [2] proposed a method to directly obtain the fovea location by a point distribution model; Singh et al. [3] proposed an appearance-based method for fovea detection; Kovacs et al. [4] presented a framework that used a combination of different methods for fovea detection.

In the two-stage approach, constraining the search area in the first stage could reduce the computation time and avoid the disturbance from other anatomic structures. Most of the methods for constraining the search area used the information on the optic disc, namely the optic disc diameter and the optic disc centre. It assumed that the fovea is located at a distance that is approximately 2.5 times the optic disc diameter from the optic disc centre. These constraining methods can be categorised into three types: (1) using the training method to find the search area [5]; (2) constraining a region with the fixed location relative to the optic disc centre [6–11]; (3) constraining a region with the adaptive location based on the vascular information [12–16]. Besides constraining the search area, the algorithms to precisely locate the fovea in the second stage can also be divided into four categories: (1) template matching based method [17,18]; (2) thresholding based method [6,9,12,16]; (3) minimum-density based method [7,8,10,11,14]; (4) feature based method [5,15].

Constraining the search region with the fixed location relative to the optic disc centre may pose problem when the fovea does not locate nearby the centre of a fundus image (the location of the fovea is far from the horizontal line passing through the centre of the optic disc). This problem could be solved by constraining the search region with the adaptive location based on the vascular information. However, obtaining vascular information needs segmentation of the vessels and is time-consuming. In this study, a two-stage method was proposed for the fovea centre detection, which constrained the search region adaptively without segmentation of the vessels. In the first stage, the proposed method constrained the search region with the adaptive location based on the vessel-free region and did not need the segmentation of vessels. In the second stage, an adaptive Gaussian template was used to localise the fovea centre in the search region for the images with different resolutions. Three publicly available databases with different resolutions were used to evaluate the method, and the fovea detection accuracy was assessed in this study.

The proposed method was evaluated on three publicly available databases: DIARETDB0 [19], DIARETDB1 [20] and MESSIDOR [21]. The DIARETDB0 and DIARETDB1 databases consisted of 130 and 89 colour fundus images with a size of 1500 by 1152 pixels. The MESSIDOR database (1200 fundus images) included 588, 400 and 212 images with a size of 1440×960, 2240×1488 and 2304×1536 pixels, respectively. Each pixel in a colour fundus image included three components, namely red, green and blue. The value of each component was quantised to 256 grey levels. The fundus images with different resolutions were used to evaluate the proposed method in this study.

The overall scheme of the proposed method for the fovea centre detection is illustrated in Fig. 1
                        . In the first step, a fundus image is processed to obtain the information used in the following steps. In the second step, the optic disc centre is localised. In the third step, the disc–fovea axis is determined, based on the vessel-free region. Finally, the fovea centre is localised around the centre of the disc–fovea axis. Each step of the proposed method is described in detail as follows.

To localise the fovea centre, some derivative images and information need to be obtained by processing the original fundus image. These derivative images and information, which would be used in the following procedures, are described and defined in this section.

A colour fundus image comprises red, green and blue components. In this study, the green component of the image I(x,y) was used to detect the fovea centre, as shown in Fig. 2(a). Because only the pixels in the field of view (FOV) need to be used, the FOV mask was first obtained. The values of the pixels outside the field of view were close to zero. A threshold value, T
                           mask, was determined from the histogram of the green component image by searching a minimum point between 0 and 50, as shown in Fig. 2(b). A binary image was then obtained by thresholding the green component image with T
                           mask, as shown in Fig. 2(c). Because only the pixels in the bright region (FOV) were needed, the green component image was masked by the binary image, as shown in Fig. 2(d). The masked green component image was used for the fovea detection by the following procedures.

After determining the FOV mask, the diameter (D
                           FOV) and the centre (X
                           FOV, Y
                           FOV) of FOV can be further determined, as shown in Fig. 2(c). Assuming the area of the bright region as A, the diameter of FOV could be determined by 
                              
                                 2
                                 ×
                                 
                                    
                                       A
                                       /
                                       π
                                    
                                 
                              
                           , and the centre of FOV could be determined by the mass centre of the bright region. In this study, D
                           FOV was used as a reference length for normalisation between the images of different resolutions.

In addition to the green component image containing the density information, another derivative image containing the gradient information was used in this study. Fig. 3(b) demonstrates a gradient image by applying gradient operation to a green component image in Fig. 3(a). The operation of the gradient is defined by Eq. (1):
                              
                                 (1)
                                 
                                    
                                       
                                          I
                                          
                                             gradient
                                          
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       =
                                       |
                                       I
                                       (
                                       x
                                       −
                                       1
                                       ,
                                       y
                                       +
                                       1
                                       )
                                       +
                                       I
                                       (
                                       x
                                       ,
                                       y
                                       +
                                       1
                                       )
                                       +
                                       I
                                       (
                                       x
                                       +
                                       1
                                       ,
                                       y
                                       +
                                       1
                                       )
                                       −
                                       I
                                       (
                                       x
                                       −
                                       1
                                       ,
                                       y
                                       −
                                       1
                                       )
                                       −
                                       I
                                       (
                                       x
                                       ,
                                       y
                                       −
                                       1
                                       )
                                       −
                                       I
                                       (
                                       x
                                       +
                                       1
                                       ,
                                       y
                                       −
                                       1
                                       )
                                       |
                                       +
                                       |
                                       I
                                       (
                                       x
                                       +
                                       1
                                       ,
                                       y
                                       −
                                       1
                                       )
                                       +
                                       I
                                       (
                                       x
                                       +
                                       1
                                       ,
                                       y
                                       )
                                       +
                                       I
                                       (
                                       x
                                       +
                                       1
                                       ,
                                       y
                                       +
                                       1
                                       )
                                       −
                                       I
                                       (
                                       x
                                       −
                                       1
                                       ,
                                       y
                                       −
                                       1
                                       )
                                       −
                                       I
                                       (
                                       x
                                       −
                                       1
                                       ,
                                       y
                                       )
                                       −
                                       I
                                       (
                                       x
                                       −
                                       1
                                       ,
                                       y
                                       +
                                       1
                                       )
                                       |
                                    
                                 
                              
                           
                        

In addition to the blood vessels, the FOV boundary, the optic disc and the exudates (bright lesions) have large gradient values, as shown in Fig. 3(b). These structures with large gradient values may pose problems for subsequent procedures and need to be eliminated. For the elimination of large gradient values corresponding to the FOV boundary, a mask can be used by applying the erosion operation to the mask shown in Fig. 2(c). The erosion operation causes the mask to shrink inward by 6 pixels, and the large gradient values corresponding to the FOV boundary fall outside the mask. Therefore, the shrunken mask can eliminate the large gradient values.

For the large gradient values corresponding to the exudates and the optic disc, the use of another mask is necessary. From our observations, the exudates and the optic disc are characterised by a yellowish colour. A mask obtained by applying the colour information was used to eliminate the large gradient values corresponding to the exudates and the optic disc. To obtain the mask, the RGB colour co-ordinate was converted to the HSI colour co-ordinate [22]. The H value represents the hue of colour; when H
                           =0°, the colour is red; when H
                           =60°, the colour is yellow. The yellowish colour of the exudates and the optic disc should correspond with an H value larger than that for the background and the blood vessels. To mask the pixels with large H values, the mean (μ
                           
                              H
                           ) and standard deviation (ρ
                           
                              H
                           ) of H values in a fundus image were determined, along with threshold (μ
                           
                              H
                           
                           +
                           ρ
                           
                              H
                           ). The threshold was used to obtain a mask for large H values, as shown in Fig. 3(c).

Finally, the shrunken mask for the FOV boundary and the mask for large H values were used to eliminate the corresponding pixels to obtain the masked gradient image, as shown in Fig. 3(d).

The method proposed in this study was based on the template matching method. The templates used for detecting the fovea and the optic disc centre were constructed by Gaussian functions. A 2-D Gaussian function is expressed in Eq. (2):
                              
                                 (2)
                                 
                                    
                                       f
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       =
                                       
                                          e
                                          
                                             −
                                             (
                                             
                                                
                                                   (
                                                   x
                                                   −
                                                   
                                                      x
                                                      0
                                                   
                                                   )
                                                
                                                2
                                             
                                             /
                                             2
                                             
                                                σ
                                                x
                                                2
                                             
                                             +
                                             
                                                
                                                   (
                                                   y
                                                   −
                                                   
                                                      y
                                                      0
                                                   
                                                   )
                                                
                                                2
                                             
                                             /
                                             2
                                             
                                                σ
                                                y
                                                2
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           where x
                           0, y
                           0 is the centre and σ
                           
                              x
                            and σ
                           
                              y
                            are the standard deviations in the x and y directions. The standard deviations, σ
                           
                              x
                            and σ
                           
                              y
                           , control the width of the bell shape in the x and y directions and are the parameters to be deduced for the templates. For a 1-D Gaussian distribution function, the relationship [23] between the full width at half maximum (FWHM) and the standard deviation (σ) is described by Eq. (3):
                              
                                 (3)
                                 
                                    
                                       FWHM
                                       =
                                       2
                                       
                                          
                                             2
                                             ln
                                              
                                             2
                                             σ
                                          
                                       
                                       ≈
                                       2.35482
                                       σ
                                    
                                 
                              
                           
                        

This relationship was used to determine the standard deviations of the Gaussian functions for the templates used in this study. Fig. 4(a) demonstrates a profile intersecting the fovea centre, and FWHM for the fovea can be obtained by analysing the profile. FWHM for the optic disc can be similarly obtained. To overcome drawbacks associated with images of different resolutions, the length used in this study was normalised to FOV diameter (D
                           FOV). Following the analysis of 100 fundus images with different resolutions, the ratio between D
                           FOV and FWHM for the fovea (FWHMfovea) was 14.4±2.2 (FWHMfovea
                           =
                           D
                           FOV/14.4) and the ratio between D
                           FOV and FWHM for the optic disc (FWHMOD) was 13.2±2.8 (FWHMOD
                           =
                           D
                           FOV/13.2). To further determine the standard deviations obtained by Eq. (3) for the fovea and the optic disc, the following equations were applied:
                              
                                 (4)
                                 
                                    
                                       
                                          σ
                                          
                                             fovea
                                          
                                       
                                       ≈
                                       
                                          
                                             
                                                D
                                                
                                                   FOV
                                                
                                             
                                          
                                          
                                             34
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (5)
                                 
                                    
                                       
                                          σ
                                          
                                             OD
                                          
                                       
                                       ≈
                                       
                                          
                                             
                                                D
                                                
                                                   FOV
                                                
                                             
                                          
                                          
                                             31
                                          
                                       
                                    
                                 
                              
                           
                        

Using the results described above, the fovea template was constructed by a Gaussian function, with the standard deviation of D
                           FOV/34 as defined by Eq. (6):
                              
                                 (6)
                                 
                                    
                                       
                                          T
                                          
                                             fovea
                                          
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       =
                                       255
                                       −
                                       255
                                       ×
                                       
                                          e
                                          
                                             −
                                             (
                                             (
                                             
                                                x
                                                2
                                             
                                             /
                                             2
                                             
                                                σ
                                                
                                                   fovea
                                                
                                                2
                                             
                                             )
                                             +
                                             (
                                             
                                                y
                                                2
                                             
                                             /
                                             2
                                             
                                                σ
                                                
                                                   fovea
                                                
                                                2
                                             
                                             )
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        

Subsequently, the optic disc template was constructed by a Gaussian function, with the standard deviation of D
                           FOV/31 as defined by Eq. (7):
                              
                                 (7)
                                 
                                    
                                       
                                          T
                                          
                                             OD
                                          
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       =
                                       255
                                       ×
                                       
                                          e
                                          
                                             −
                                             (
                                             (
                                             
                                                x
                                                2
                                             
                                             /
                                             2
                                             
                                                σ
                                                
                                                   OD
                                                
                                                2
                                             
                                             )
                                             +
                                             (
                                             
                                                y
                                                2
                                             
                                             /
                                             2
                                             
                                                σ
                                                
                                                   OD
                                                
                                                2
                                             
                                             )
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        

In Eqs. (6) and (7), the constant value, 255, is the dynamic range of a green component image. From our observations, the optic disc or the macular region could be covered with the Gaussian template sized at 2FWHM×2FWHM entirely. The optic disc template with a size of 2FWHMOD
                           ×2FWHMOD was constructed to cover with the optic disc. However, the fovea is located at the centre of the dark region in the macula. To localise the fovea centre precisely, instead of using the template with a size of 2FWHMfovea
                           ×2FWHMfovea to cover with the macular region, the fovea template was constructed with a size of FWHMfovea
                           ×FWHMfovea to cover the dense region around the fovea in this study. The examples of the templates for the fovea and optic disc are demonstrated in Fig. 4(b).

To define the region for seeking the fovea centre, the centre of the optic disc was initially determined by matching the optic disc template in the two regions, as shown in Fig. 5(a). The correlation value at each location for matching the optic disc is defined by Eq. (8):
                              
                                 (8)
                                 
                                    
                                       
                                          C
                                          
                                             OD
                                          
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       =
                                       
                                          1
                                          
                                             
                                                
                                                   (
                                                   2
                                                   
                                                      FWHM
                                                      
                                                         OD
                                                      
                                                   
                                                   )
                                                
                                                2
                                             
                                          
                                       
                                       
                                          ∑
                                          
                                             i
                                             =
                                             −
                                             
                                                FWHM
                                                
                                                   OD
                                                
                                             
                                          
                                          
                                             
                                                FWHM
                                                
                                                   OD
                                                
                                             
                                          
                                       
                                       
                                          
                                             ∑
                                             
                                                j
                                                =
                                                −
                                                
                                                   FWHM
                                                   
                                                      OD
                                                   
                                                
                                             
                                             
                                                
                                                   FWHM
                                                   
                                                      OD
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   I
                                                   (
                                                   x
                                                   +
                                                   i
                                                   ,
                                                   y
                                                   +
                                                   j
                                                   )
                                                   −
                                                   
                                                      I
                                                      ¯
                                                   
                                                   )
                                                   (
                                                   
                                                      T
                                                      
                                                         OD
                                                      
                                                   
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                   −
                                                   
                                                      
                                                         T
                                                         ¯
                                                      
                                                      
                                                         OD
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                      σ
                                                      I
                                                   
                                                   
                                                      σ
                                                      
                                                         
                                                            T
                                                            
                                                               OD
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where
                              
                                 
                                    
                                       
                                          
                                             
                                                I
                                                ¯
                                             
                                             =
                                             
                                                1
                                                
                                                   2
                                                   
                                                      
                                                         (
                                                         
                                                            FWHM
                                                            
                                                               OD
                                                            
                                                         
                                                         )
                                                      
                                                      2
                                                   
                                                
                                             
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   −
                                                   
                                                      FWHM
                                                      
                                                         OD
                                                      
                                                   
                                                
                                                
                                                   
                                                      FWHM
                                                      
                                                         OD
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      j
                                                      =
                                                      −
                                                      
                                                         FWHM
                                                         
                                                            OD
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         FWHM
                                                         
                                                            OD
                                                         
                                                      
                                                   
                                                
                                                
                                                   I
                                                   (
                                                   x
                                                   +
                                                   i
                                                   ,
                                                    
                                                   y
                                                   +
                                                   j
                                                   )
                                                
                                             
                                             ,
                                              
                                             
                                                
                                                   T
                                                   ¯
                                                
                                                
                                                   OD
                                                
                                             
                                             =
                                             
                                                1
                                                
                                                   
                                                      
                                                         (
                                                         2
                                                         
                                                            FWHM
                                                            
                                                               OD
                                                            
                                                         
                                                         )
                                                      
                                                      2
                                                   
                                                
                                             
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   −
                                                   
                                                      FWHM
                                                      
                                                         OD
                                                      
                                                   
                                                
                                                
                                                   
                                                      FWHM
                                                      
                                                         OD
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      j
                                                      =
                                                      −
                                                      
                                                         FWHM
                                                         
                                                            OD
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         FWHM
                                                         
                                                            OD
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      T
                                                      
                                                         OD
                                                      
                                                   
                                                   (
                                                   i
                                                   ,
                                                    
                                                   j
                                                   )
                                                
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             
                                                σ
                                                I
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                            
                                                               i
                                                               =
                                                               −
                                                               
                                                                  FWHM
                                                                  
                                                                     OD
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  FWHM
                                                                  
                                                                     OD
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               ∑
                                                               
                                                                  j
                                                                  =
                                                                  −
                                                                  
                                                                     FWHM
                                                                     
                                                                        OD
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     FWHM
                                                                     
                                                                        OD
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     (
                                                                     I
                                                                     (
                                                                     x
                                                                     +
                                                                     i
                                                                     ,
                                                                      
                                                                     y
                                                                     +
                                                                     j
                                                                     )
                                                                     −
                                                                     
                                                                        I
                                                                        ¯
                                                                     
                                                                     )
                                                                  
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               (
                                                               2
                                                               
                                                                  FWHM
                                                                  
                                                                     OD
                                                                  
                                                               
                                                               )
                                                            
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                             ,
                                              
                                             
                                                σ
                                                
                                                   
                                                      T
                                                      
                                                         OD
                                                      
                                                   
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                            
                                                               i
                                                               =
                                                               −
                                                               
                                                                  FWHM
                                                                  
                                                                     OD
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  FWHM
                                                                  
                                                                     OD
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               ∑
                                                               
                                                                  j
                                                                  =
                                                                  −
                                                                  
                                                                     FWHM
                                                                     
                                                                        OD
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     FWHM
                                                                     
                                                                        OD
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     (
                                                                     
                                                                        T
                                                                        
                                                                           OD
                                                                        
                                                                     
                                                                     (
                                                                     i
                                                                     ,
                                                                      
                                                                     j
                                                                     )
                                                                     −
                                                                     
                                                                        
                                                                           T
                                                                           ¯
                                                                        
                                                                        
                                                                           OD
                                                                        
                                                                     
                                                                     )
                                                                  
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               (
                                                               2
                                                               
                                                                  FWHM
                                                                  
                                                                     OD
                                                                  
                                                               
                                                               )
                                                            
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Among the two search regions, the location at which the correlation value C
                           OD is maximum was used as the centre of the optic disc and the side (left or right) on which the optic disc locates in a fundus image was also determined at the same time, as shown in Fig. 5(b).

Following the location of the optic disc centre, the direction of the fovea relative to the optic disc was determined to be a precise area in which the fovea lies. Li and Chutatape [12], Tobin et al. [13] and Fleming et al. [14] have proposed the methods for determining the direction by indirectly modelling blood vessels. Our proposed method directly detected the direction in this study without the segmentation of blood vessels. As shown in Fig. 6(a), the disc–fovea axis, a line connecting the optic disc and the fovea, would lie in a region without blood vessels. This feature was used in determining the direction of the fovea relative to the optic disc in this study. The direction was determined using the lines originating from the optic disc centre to the FOV boundary to scan the masked gradient image in different directions, and the scans were performed from −20° to 20°, as shown in Fig. 6(b). The mean gradient value G
                           m for each line was calculated by averaging the pixels on each line in the masked gradient image. Fig. 6(c) shows the distribution of G
                           m in the different directions. The passage of the scanning line through the vessels would result in a large G
                           m value, which would otherwise be small for the vessel-free region. Hence, a line with a minimum G
                           m was used as the disc–fovea axis in this study, as shown in Fig. 6(d).

The fovea centre was determined in the last step. Fig. 7(a) demonstrates that the centre of the disc–fovea axis was close to the fovea centre. For the precise localisation of the fovea centre, the template matching method was further applied in a small region with a size of 4FWHMfovea
                           ×4FWHMfovea around the centre of the axis. The correlation value between the fovea template and the subimage with a size of FWHMfovea
                           ×FWHMfovea at each location is defined by Eq. (9):
                              
                                 (9)
                                 
                                    
                                       
                                          C
                                          
                                             fovea
                                          
                                       
                                       (
                                       x
                                       ,
                                       y
                                       )
                                       =
                                       
                                          1
                                          
                                             FWH
                                             
                                                
                                                   
                                                      M
                                                      
                                                         fovea
                                                      
                                                   
                                                
                                                2
                                             
                                          
                                       
                                       
                                          ∑
                                          
                                             i
                                             =
                                             −
                                             
                                                FWHM
                                                
                                                   fovea
                                                
                                             
                                             /
                                             2
                                          
                                          
                                             
                                                FWHM
                                                
                                                   fovea
                                                
                                             
                                             /
                                             2
                                          
                                       
                                       
                                          
                                             ∑
                                             
                                                j
                                                =
                                                −
                                                
                                                   FWHM
                                                   
                                                      fovea
                                                   
                                                
                                                /
                                                2
                                             
                                             
                                                
                                                   FWHM
                                                   
                                                      fovea
                                                   
                                                
                                                /
                                                2
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   I
                                                   (
                                                   x
                                                   +
                                                   i
                                                   ,
                                                   y
                                                   +
                                                   j
                                                   )
                                                   −
                                                   
                                                      I
                                                      ¯
                                                   
                                                   )
                                                   (
                                                   
                                                      T
                                                      
                                                         fovea
                                                      
                                                   
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                   −
                                                   
                                                      
                                                         T
                                                         ¯
                                                      
                                                      
                                                         fovea
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                      σ
                                                      I
                                                   
                                                   
                                                      σ
                                                      
                                                         
                                                            T
                                                            
                                                               fovea
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      I
                                                      ¯
                                                   
                                                   =
                                                   
                                                      1
                                                      
                                                         FWH
                                                         
                                                            
                                                               
                                                                  M
                                                                  
                                                                     fovea
                                                                  
                                                               
                                                            
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         i
                                                         =
                                                         −
                                                         
                                                            FWHM
                                                            
                                                               fovea
                                                            
                                                         
                                                         /
                                                         2
                                                      
                                                      
                                                         
                                                            FWHM
                                                            
                                                               fovea
                                                            
                                                         
                                                         /
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         ∑
                                                         
                                                            j
                                                            =
                                                            −
                                                            
                                                               FWHM
                                                               
                                                                  fovea
                                                               
                                                            
                                                            /
                                                            2
                                                         
                                                         
                                                            
                                                               FWHM
                                                               
                                                                  fovea
                                                               
                                                            
                                                            /
                                                            2
                                                         
                                                      
                                                      
                                                         I
                                                         (
                                                         x
                                                         +
                                                         i
                                                         ,
                                                         y
                                                         +
                                                         j
                                                         )
                                                      
                                                   
                                                   ,
                                                    
                                                   
                                                      
                                                         T
                                                         ¯
                                                      
                                                      
                                                         fovea
                                                      
                                                   
                                                   =
                                                   
                                                      1
                                                      
                                                         F
                                                         W
                                                         H
                                                         
                                                            
                                                               
                                                                  M
                                                                  
                                                                     fovea
                                                                  
                                                               
                                                            
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         i
                                                         =
                                                         −
                                                         
                                                            FWHM
                                                            
                                                               fovea
                                                            
                                                         
                                                         /
                                                         2
                                                      
                                                      
                                                         
                                                            FWHM
                                                            
                                                               fovea
                                                            
                                                         
                                                         /
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         ∑
                                                         
                                                            j
                                                            =
                                                            −
                                                            
                                                               FWHM
                                                               
                                                                  fovea
                                                               
                                                            
                                                            /
                                                            2
                                                         
                                                         
                                                            
                                                               FWHM
                                                               
                                                                  fovea
                                                               
                                                            
                                                            /
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            T
                                                            
                                                               fovea
                                                            
                                                         
                                                         (
                                                         i
                                                         ,
                                                         j
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      σ
                                                      I
                                                   
                                                   =
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  ∑
                                                                  
                                                                     i
                                                                     =
                                                                     −
                                                                     
                                                                        FWHM
                                                                        
                                                                           fovea
                                                                        
                                                                     
                                                                     /
                                                                     2
                                                                  
                                                                  
                                                                     
                                                                        FWHM
                                                                        
                                                                           fovea
                                                                        
                                                                     
                                                                     /
                                                                     2
                                                                  
                                                               
                                                               
                                                                  
                                                                     ∑
                                                                     
                                                                        j
                                                                        =
                                                                        −
                                                                        
                                                                           FWHM
                                                                           
                                                                              fovea
                                                                           
                                                                        
                                                                        /
                                                                        2
                                                                     
                                                                     
                                                                        
                                                                           FWHM
                                                                           
                                                                              fovea
                                                                           
                                                                        
                                                                        /
                                                                        2
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           (
                                                                           I
                                                                           (
                                                                           x
                                                                           +
                                                                           i
                                                                           ,
                                                                           y
                                                                           +
                                                                           j
                                                                           )
                                                                           −
                                                                           
                                                                              I
                                                                              ¯
                                                                           
                                                                           )
                                                                        
                                                                        2
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               FWH
                                                               
                                                                  
                                                                     
                                                                        M
                                                                        
                                                                           fovea
                                                                        
                                                                     
                                                                  
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   ,
                                                    
                                                   
                                                      σ
                                                      
                                                         
                                                            T
                                                            
                                                               fovea
                                                            
                                                         
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  ∑
                                                                  
                                                                     i
                                                                     =
                                                                     −
                                                                     
                                                                        FWHM
                                                                        
                                                                           fovea
                                                                        
                                                                     
                                                                     /
                                                                     2
                                                                  
                                                                  
                                                                     
                                                                        FWHM
                                                                        
                                                                           fovea
                                                                        
                                                                     
                                                                     /
                                                                     2
                                                                  
                                                               
                                                               
                                                                  
                                                                     ∑
                                                                     
                                                                        j
                                                                        =
                                                                        −
                                                                        
                                                                           FWHM
                                                                           
                                                                              fovea
                                                                           
                                                                        
                                                                        /
                                                                        2
                                                                     
                                                                     
                                                                        
                                                                           FWHM
                                                                           
                                                                              fovea
                                                                           
                                                                        
                                                                        /
                                                                        2
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           (
                                                                           
                                                                              T
                                                                              
                                                                                 fovea
                                                                              
                                                                           
                                                                           (
                                                                           i
                                                                           ,
                                                                           j
                                                                           )
                                                                           −
                                                                           
                                                                              
                                                                                 T
                                                                                 ¯
                                                                              
                                                                              
                                                                                 fovea
                                                                              
                                                                           
                                                                           )
                                                                        
                                                                        2
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               FWH
                                                               
                                                                  
                                                                     
                                                                        M
                                                                        
                                                                           fovea
                                                                        
                                                                     
                                                                  
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

In the search region, the location corresponding to the maximum correlation value was considered as the fovea centre in this study, as shown in Fig. 7(b).

A specialist annotated the location of the fovea centre for each fundus image used in this study by using software developed in-house, as shown in Fig. 8(a). For those images without a visible fovea, the expert estimated the locations. These annotated locations were then used as the gold standards to evaluate the proposed method. In the present study, we measured the accuracy of the proposed method based on the target, which represents the relative location between the detected locations and the gold standards, as shown in Fig. 8(b). The centre of the target was the location for the gold standards, whereas the errors, which were determined by the distance between the detected locations and the gold standards, would be distributed around the centre. In the current study, an error smaller than FWHMfovea/2 (≈D
                        FOV/28) was considered to be a success in fovea detection, if not, the detection was deemed to have failed. Thus, a successfully detected location would fall inside the dense area of the macula and within the circle with a radius of FWHMfovea/2, as shown in Fig. 8.

@&#RESULTS@&#

The proposed method was evaluated on the fundus images with different resolutions. Three publicly available databases, MESSIDOR, DIARETDB0 and DIARETDB1, were used in this study. The MESSIDOR database consisted of 1200 fundus images with three different resolutions (1440×960, 2240×1488 and 2304×1536). The images with different resolutions in the MESSIDOR database were separately evaluated.


                     Fig. 9(a) and (b) presents the distributions of the errors for the DIARETDB0 and DIARETDB1 databases, respectively, whereas Fig. 10(a)–(c), present the error distributions for the MESSIDOR database with three different image sizes. A circle with a radius of FWHMfovea/2 for each dataset was used to measure the detection accuracy, with the detection considered a success if the detection error fell inside the circle (error<FWHMfovea/2). Most of the cases that were analysed fell inside the circles and close to the centres of the targets, as shown in Figs. 9 and 10. This means that the locations of the fovea centre, as detected by the proposed method, were close to the corresponding reference positions annotated by the expert.


                     Table 1
                      summarises the detection results for the proposed method when applied to the five datasets. The proposed method obtained the fovea detection accuracies of 93.1% (121/130), 92.1% (82/89) and 97.8% (1174/1200) for the DIARETDB0, DIARETDB1 and MESSIDOR databases, respectively. Tables 2 and 3
                     
                      show the fovea detection accuracies in terms of the disease stages provided by the MESSIDOR database. The overall accuracy of the proposed method for the fovea centre detection was 0.970 (1377/1419) in this study.

@&#DISCUSSION@&#

The present study developed a computerised method to detect the fovea centre in fundus images. In the method, the centre of the optic disc was initially localised by the template matching method, the disc–fovea axis was then determined by searching the vessel-free region and finally the fovea centre was detected by matching the fovea template in an area around the centre of the disc–fovea axis. To apply the method to the images with different resolutions, adaptive Gaussian templates were used to localise the centres of the optic disc and fovea in this study. The proposed method was evaluated using the publicly available databases with different resolutions. FWHM for the fovea was used to define the area in which a successful detection should fall. The fovea detection accuracies were 93.1%, 92.1% and 97.8% for the DIARETDB0, DIARETDB1 and MESSIDOR databases, respectively. The robustness of the method is illustrated in Tables 2 and 3. The overall accuracy of the proposed method was 97.0% in this study. The software was written in C++ and tested on an Intel(R) Core(TM) i7-3610QM 2.30GHz PC. Average processing times were 2.6, 6.1, 6.9 and 5.3s for the images with sizes of 1440×960, 2240×1488, 2304×1536 and 1500×1152, respectively.

Most of the proposed methods for the fovea detection were performed in two stages; in the first stage, the region for searching the fovea was defined and in the second stage, the algorithm for the fovea detection was applied to the defined region. The novelties of our proposed method are discussed according to the stages as follows. For constraining a search region, some proposed method assumed that the fovea and the optic disc centre were located in the same level and constrained the search region with the fixed location relative to the optic disc centre. This may cause a failure in the fovea detection when the fovea locates far from the horizontal line of the optic disc centre, as shown in Fig. 6(a). This problem can be overcome by determining the direction of the fovea relative to the optic disc centre. Li and Chutatape [12], Tobin et al. [13] and Fleming et al. [14] have proposed the methods that determined the direction by constructing a line connecting the optic disc centre and the fovea (disc–fovea axis). In the methods, segmentation of the vessels needed to be performed first and the disc–fovea axis was determined by modelling the blood vessels. In our present study, we proposed a sample method to determine the disc–fovea axis without segmentation of the vessels. The disc–fovea axis was determined directly, based on the feature that the axis should locate in the vessel-free region in a fundus image. Determining the axis directly can reduce the computation complexity without segmentation of the vessels.

Subsequently, the template matching method was used to detect the fovea around the centre of the axis. Sinthanayothin et al. [17] have proposed a template matching method for the fovea detection using a template of Gaussian distribution, wherein the standard deviation of Gaussian distribution was 22 pixels. The Gaussian template with a fixed standard deviation posed a problem when applied to the images in this study that had different resolutions. To overcome this problem, we proposed using adaptive Gaussian templates with variable standard deviations in accordance with the FOV sizes. Regardless of the resolutions of the fundus images, the standard deviation of a Gaussian function for the fovea was determined to be 1/34th of the FOV diameter using Eq. (4) in our study.

The measurement of accuracy is an important aspect for evaluating the methods of the fovea detection, a topic not mentioned a lot in the relevant literature. The experts who observed the detection results obtained the accuracies in most study. Niemeijer et al. [2] proposed using a fixed distance for measuring the fovea detection accuracy, wherein the detection of an error that falls within 50 pixels for a FOV with a diameter of 530 pixels was considered successful. A similar method was used by Zhang et al. [10] and Welfer et al. [11]; the criterion used by Zhang et al. was that the error should fall within 30 pixels for the images with a size of 968×644 pixels, whereas Welfer et al. used the criterion that the error should fall within 34 pixels for the images with a size of 640×480 pixels. In the present study, we introduced an idea of using FWHM to measure the fovea detection accuracy. The relationship between FWHM for the fovea and the FOV diameter (FWHMfovea
                     ≈
                     D
                     FOV/14) was obtained by analysing the profiles intersecting the fovea centre. A circle with a radius of FWHMfovea/2 (D
                     FOV/28) was used to measure the fovea detection accuracy. Based on the criterion used in this study, the errors should fall within 19, 23 and 17 pixels for the methods proposed by Niemeijer et al. [2], Zhang et al. [10] and Welfer et al. [11], respectively. A comparison with the other criteria described above, the criterion used in our study was more critical than those used by the other groups. Additionally, our method overcame the problem associated with evaluating images with different resolutions. Table 4
                      summarises the fovea detection accuracy for the proposed and other methods available in the literature. To compare the existing two-stage approaches for fovea detection on the same dataset, the proposed method shows the detection accuracy (92.1%) comparable to the results (92.13%) reported by Welfer et al. [11] based on the DIARETDB1 database.

We identified three main reasons for the failure in successfully detecting fovea in this study: (1) failure in determining the optic disc centre [Fig. 11(a)], (2) failure in determining the disc–fovea axis [Fig. 11(b)] and (3) an invisible fovea together with dark lesions such as haemorrhages or dark structures in the fovea search region [Fig. 11(c)]. The first two reasons influence the first stage of constraining the fovea search region and the third reason influences the second stage of a precise search for the fovea centre. The method can be improved upon by reflecting on several aspects of the process. In this study, the optic disc centre detection accuracy was 95.6% (1357/1419). Among the cases of which the optic discs were not detected correctly, 11.3% of the cases (7/62) further resulted in the failure of fovea detection. For the failure in optic disc centre detection, a more robust method needs to be developed. For the failure in disc–fovea axis determination, the non-vessel structures with high gradient values could be further eliminated in the pre-process procedure. For rejecting the detection not belonging to a fovea, the features of dark lesions and structures should be further analysed.

@&#CONCLUSION@&#

The present study developed a computerised method for the fovea centre detection in the fundus images. The results indicate that the proposed method yielded high detection accuracy and could be used as a module for grading [24] the severity of retinal abnormality in the fundus images.

@&#ACKNOWLEDGMENTS@&#

The authors thank the DIARETDB0, DIARETDB1 and MESSIDOR project teams for making available their image databases on the internet.

@&#REFERENCES@&#

