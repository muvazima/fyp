@&#MAIN-TITLE@&#Reducing sojourn points from recurrence plots to improve transition detection: Application to fetal heart rate transitions

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           Developing clean recurrence plots.


                        
                        
                           
                           Reducing the bias of recurrence quantification analysis.


                        
                        
                           
                           Improving the detection of dynamic transitions by reducing sojourn points.


                        
                        
                           
                           Improving the rate of discrimination of logistic map transitions and improving the discrimination of two fetal heart rate signals.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Recurrence plots

Signal-based recurrence plots

Sojourn points

Dynamic transitions

Detection

Complexity analysis

Fetal heart rate

@&#ABSTRACT@&#


               
               
                  The analysis of biomedical signals demonstrating complexity through recurrence plots is challenging. Quantification of recurrences is often biased by sojourn points that hide dynamic transitions. To overcome this problem, time series have previously been embedded at high dimensions. However, no one has quantified the elimination of sojourn points and rate of detection, nor the enhancement of transition detection has been investigated. This paper reports our on-going efforts to improve the detection of dynamic transitions from logistic maps and fetal hearts by reducing sojourn points. Three signal-based recurrence plots were developed, i.e. embedded with specific settings, derivative-based and m-time pattern. Determinism, cross-determinism and percentage of reduced sojourn points were computed to detect transitions. For logistic maps, an increase of 50% and 34.3% in sensitivity of detection over alternatives was achieved by m-time pattern and embedded recurrence plots with specific settings, respectively, and with a 100% specificity. For fetal heart rates, embedded recurrence plots with specific settings provided the best performance, followed by derivative-based recurrence plot, then unembedded recurrence plot using the determinism parameter. The relative errors between healthy and distressed fetuses were 153%, 95% and 91%. More than 50% of sojourn points were eliminated, allowing better detection of heart transitions triggered by gaseous exchange factors. This could be significant in improving the diagnosis of fetal state.
               
            

@&#INTRODUCTION@&#

Complexity analysis of biomedical time series by means of various descriptors including, but not limited to, fractal dimension [1], multi-fractal spectra [2], and entropies [3–5] is quantitative and currently standard practice.

Large studies involving the analysis of biomedical systems and signals have recently used recurrence plots (RPs) that featured and located recurring states or patterns constituting the system׳s time series or variables in 2-dimensions [6–12]. Quantitative indicators named recurrence quantification analysis (RQA) have been computed in order to extract certain scalar indicators from RPs [13–15].

One of the significant uses of RQA was in the detection of the various dynamic transitions of logistic maps [13,12,16]. In addition, the Determinism (DET) parameter was employed to quantify chaotic-periodic and periodic-chaotic transitions [13,12]. Such transitions were detected in two different ways. The first focused on the computation of RQA promptly from a single unembedded time series [16]. This method was appealing due to its simple mathematical formulation. However, quantification was biased and a poor transition detection rate was obtained due to the presence of sojourn points [13–15,8].

The second method was based on embedding the time series [6,7,13,17]. Although this method required heavy computation, it reduced sojourn points empirically and promoted transition detection [13,12]. However, no one has yet quantified the improvement of the detection rate, nor identified whether it would be possible to enhance the transition detection rate. This leads us to the question regarding the best value of the embedding dimension that would allow the detection of all dynamic transitions.

This paper describes our on-going efforts to extract and cleanly quantify the dynamic information from nonlinear dynamic systems such as the logistic map and the fetal heart. The aim was to improve the detection rate of transitions by eliminating sojourn points present in recurrence plots. For the logistic map, the transitions to be detected were periodic-chaotic and chaotic-periodic transitions, while for the fetal heart the states to be detected were healthy-distressed and distressed-healthy fetal heart rates (FHRs). The solution adopted consisted of eliminating sojourn points present in recurrence plots. Several RPs were employed to find an efficient solution to the above problems. The first empirical method comprised two plots with different embedding dimension values. As proposed in [16] the first plot required no embedding and was the unembedded RP. The second recurrence plot required an embedding dimension greater than 2, as suggested by Marwan et al. [13,12]. As the choice of the embedding dimension in the second method is often arbitrary, we developed a new method that comprised finding the optimal embedding dimension that minimized the number of sojourn points. We also developed two additional signal-based methods using the derivative concept and the m-time pattern concept, and compared them with the above plots.

To quantify the levels of performance of the proposed approaches, each technique was applied to the nonlinear logistic map and to the FHR, and both the sensitivity and the specificity were assessed in each case.

The remainder of this paper is organized as follows. In Section 2, we introduce the methods including the already existing RPs and the three signal-based recurrence plots developed. In Section 3, we set out the numerical results. Finally, in Section 4 we discuss the results, provide a general conclusion and suggest the future prospects of this work.

@&#METHODS@&#

An RP is a two-dimensional squared matrix, with black and white dots and two time-axes. Each black dot at the coordinates (i,j) represents a recurrence of the system state 
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                              
                            with another 
                              
                                 
                                    X
                                 
                                 
                                    j
                                 
                              
                           , it is expressed as follows for tolerance r:
                              
                                 (1)
                                 
                                    RP
                                    =
                                    Θ
                                    (
                                    r
                                    −
                                    ∥
                                    
                                       
                                          X
                                       
                                       
                                          i
                                       
                                    
                                    −
                                    
                                       
                                          X
                                       
                                       
                                          j
                                       
                                    
                                    ∥
                                    )
                                    ,
                                    
                                    
                                       
                                          X
                                       
                                       
                                          i
                                       
                                    
                                    ∈
                                    
                                       
                                          R
                                       
                                       
                                          d
                                       
                                    
                                    ,
                                 
                              
                           where 
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    d
                                 
                              
                            stands for the points in the phase space at which the system is situated at time i, 
                              Θ
                              (
                              ·
                              )
                            the Heaviside function, 
                              ∥
                              ·
                              ∥
                            the 
                              
                                 
                                    L
                                 
                                 
                                    ∞
                                 
                              
                            norm, 
                              i
                              ,
                              j
                              =
                              {
                              1
                              ,
                              …
                              ,
                              N
                              −
                              d
                              +
                              1
                              }
                           , N the total number of points and d the embedding dimension [7,13,12,18].

After the computation of the qualitative RP, scalar quantitative parameters could be calculated. Of all the existing RQA, DET seemed to be the most sensitive scalar parameter to detect transitions [13,12]. The determinism (DET) [8] is calculated as follows:
                              
                                 (2)
                                 
                                    DET
                                    =
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                l
                                                =
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      min
                                                   
                                                
                                             
                                             
                                                N
                                             
                                          
                                          lP
                                          (
                                          l
                                          )
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ,
                                                j
                                                =
                                                1
                                             
                                             
                                                N
                                             
                                          
                                          RP
                                       
                                    
                                    ,
                                 
                              
                           where P(l) is the number of diagonal lines of length l and l
                           
                              min
                            the minimum length of a diagonal line [19–21,13,22,9], i.e. the number of points forming a diagonal line of at least length l
                           
                              min
                           .

The removal of sojourn points is illustrated with sojourn points starting from a single time series. Fig. 1
                            is a diagram of how sojourn points appear in two dimensions and the mode of computing the RPs developed. Fig. 1 sets out (a) a sine wave x(t) made up of 200 sample points, its time delayed version, 
                              y
                              (
                              t
                              )
                              =
                              x
                              (
                              t
                              +
                              τ
                              )
                            and their elliptical phase space (i.e. x(t) versus y(t)), (b) a sine wave, x(t), its derivative, 
                              
                                 
                                    x
                                 
                                 
                                    ̇
                                 
                              
                              (
                              t
                              )
                            and their circular phase space (i.e. x(t) versus 
                              
                                 
                                    x
                                 
                                 
                                    ̇
                                 
                              
                              (
                              t
                              )
                           ) and (c) a sine wave constituted of pairs of points. Note that the size of a single chosen slice is called tolerance r.


                           Fig. 1(a) shows the points denoted as 1 (red circles) and 3 (black cross) existing within the same slice of size r. In reality, only the points denoted as 1 truly recur with each other and not with points denoted as 3. According to the standard recurrence test (of an unembedded time series), all 1׳s and 3׳s were recurrences. This was very clear while comparing all the points existing on the same amplitude level of x(t) to those of the delayed signal and confined within the same tolerance r. By introducing a second signal y(t) (a delayed or a derivative version of x(t)), it was then possible to remove sojourn points by comparing points 2 and 4 of y(t) to the corresponding points 1 and 3 of x(t). Point 4 of y(t) which corresponded to 3 in x(t) did not exist at the same amplitude level, whereas all the red circles were within r. Consequently, point 3 was a sojourn point since it was not periodic
                              1
                           
                           
                              1
                              In 1-Dimension, sojourn points are non-periodic points existing within tolerance r.
                            with 1׳s. However, in the two signal-based RPs Fig. 1(a) and (b) this was overcome. Tolerance r was fixed in Fig. 1 to ensure a fair comparison. This tolerance value r is usually 10% of the standard deviation of x(t).

An unembedded recurrence plot is that produced from a single time series, there is thus no need for sub-time series. Eq. (1) becomes
                              
                                 (3)
                                 
                                    
                                       
                                          RP
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    Θ
                                    (
                                    r
                                    −
                                    ∥
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                    −
                                    
                                       
                                          x
                                       
                                       
                                          j
                                       
                                    
                                    ∥
                                    )
                                    ,
                                 
                              
                           where 
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                            stands for the time series points at time i. As reported by Iwanski et al. [16], when d=1, Eq. (1) is called an unembedded RP. This plot is denoted throughout this work as 
                              
                                 
                                    RP
                                 
                                 
                                    1
                                 
                              
                            (see Table 1
                           ).

Originally developed by Eckmann [7], embedded plots have been used to track recurrences of system states out of a reconstructed phase space of d-embedding dimension. This was fulfilled using the embedding theorem [17,6,13,23,24]. The reconstructed RP was obtained by calculating a time delay τ and embedding dimension d using the mutual information (M.I.) [25] and the false nearest neighbour (F.N.N.) [18] methods, and subsequently computing Eq. (1), given that 
                              
                                 
                                    X
                                 
                                 
                                    j
                                 
                              
                              =
                              
                                 
                                    X
                                 
                                 
                                    i
                                    +
                                    τ
                                 
                              
                            and 
                              d
                              ≥
                              2
                           . Analogous to previous investigations [17,13,12,26], d was fixed at 3, i.e. three sub-time series produced from x(t) were used to reconstruct the RP. The corresponding RP was denoted as 
                              
                                 
                                    RP
                                 
                                 
                                    2
                                 
                              
                            (see Table 1). Note that such a plot has been recommended to eliminate sojourn points by using an embedding dimension 
                              d
                              ≥
                              2
                            
                           [8,26].

We provide here our first signal-based RP that is responsible for enhancing the detection of dynamic transitions. With this technique, instead of looking for the best embedding dimension and time delay that guarantee the independence of the sub-time series, as already demonstrated by Trulla et al. [17] and later by Marwan et al. [13,12], we looked for the best value of the embedding dimension and time delay that ensured the minimum presence of sojourn points in an RP. Both d=d
                           
                              optimal
                            and τ=τ
                           
                              optimal
                            were obtained by minimizing the cost function 
                              (
                              J
                              (
                              
                                 
                                    d
                                 
                                 
                                    k
                                 
                              
                              ,
                              
                                 
                                    τ
                                 
                                 
                                    k
                                 
                              
                              )
                              =
                              CDET
                              )
                            characterizing sojourn points.

In contrast to DET, where P(l) was the number of diagonal lines, the Cross-Determinism (CDET) was defined by Eq. (2) for P(l), being the number of cross-diagonal lines of length l. This quantified the number of points constituting the diagonal lines perpendicular to the line of identity (LOI). Instead of developing a new algorithm to evaluate CDET, CDET was obtained by Eq. (2) computed from the 90° rotation of the recurrence matrix. The optimization equation was as follows:
                              
                                 (4)
                                 
                                    
                                       
                                          φ
                                       
                                       
                                          k
                                       
                                       
                                          ⁎
                                       
                                    
                                    =
                                    arg
                                    
                                    
                                       
                                          min
                                       
                                       
                                          φ
                                       
                                    
                                    (
                                    J
                                    (
                                    
                                       
                                          φ
                                       
                                       
                                          k
                                       
                                    
                                    )
                                    )
                                    ,
                                 
                              
                           where φ
                           
                              k
                           =(d
                           
                              k
                           , τ
                           
                              k
                           ) is a vector composed of the kth embedding dimension and the kth time delay to be optimized. An example of such optimization is presented in Appendix A.

As the optimal value of d
                           
                              optimal
                            converged to 2 (see Appendix A and the two signals in Fig. 1(a)), it was fixed for this plot and τ
                           
                              optimal
                            depended on the signal. We denoted the resulting recurrence plot as 
                              
                                 
                                    RP
                                 
                                 
                                    3
                                 
                              
                            (see Table 1). Fig. 1(a) sets out a sine wave x(t) and 
                              y
                              =
                              x
                              (
                              t
                              +
                              
                                 
                                    τ
                                 
                                 
                                    optimal
                                 
                              
                              )
                            for the embedded RPs with specific settings.

Instead of assessing the best embedding dimension and time delay, another RP was developed and is discussed in the subsection below.

We provide here our second signal-based RP method. Starting from a single time series, and instead of considering the independence between two sub-time series, we considered the orthogonal data by using the derivative principle (see the example in Fig. 1(b)). This approach required neither looking at the time delay nor at the embedding dimension. The resulting plot is denoted as 
                              
                                 
                                    RP
                                 
                                 
                                    4
                                 
                              
                            (see Table 1). Fig. 1(b) sets out how derivative-based RPs are constructed from a sine wave x(t) and 
                              y
                              =
                              
                                 
                                    x
                                 
                                 
                                    ̇
                                 
                              
                              (
                              t
                              )
                           .

Having introduced the derivative-based RPs, we provide our third nonlinear technique, i.e. the m-time pattern Recurrence Plot. This is a multi-pattern algorithm. However, in this study it was used as a 2-point to 2-point recurrence computation. Fig. 1(c) sets out the keystone time series x(t), which is divided into pairs of points, from which a 2-time pattern RP was computed. For m=2, the m-time pattern RP, i.e. 
                              (
                              RP
                              (
                              m
                              =
                              2
                              )
                              )
                            is denoted as 
                              
                                 
                                    RP
                                 
                                 
                                    5
                                 
                              
                            throughout this paper.


                           Table 1 summarizes the vectors involved in Eq. (1), with d being the embedding dimension, m the number of patterns and 
                              d
                              ′
                            the virtual embedding dimension used in all the recurrence plots discussed in this paper.

We illustrate in Fig. 2
                            an evaluation of the drop off in sojourn points for a sine wave displayed within a window of 200 points (a) as compared to the unembedded RP1 (b). It is an example of a simulated sine wave and its corresponding standard and developed recurrence plots. Fig. 2(a) sets out a sine wave and its corresponding (b) unembedded recurrence plot RP1, (c) embedded recurrence plot RP3 with specific settings, (d) derivative-based recurrence plot RP4 and (e) 2-time pattern recurrence plot RP5.

The plots in Fig. 2 are arranged as follows: RP1, RP3 for 
                              (
                              τ
                              =
                              T
                              /
                              4
                              )
                            where T is the period of the sine wave, RP4 and RP5. Fig. 2(b) demonstrates a few diagonal and cross-diagonal lines revealing periodicity and uniformity, the crossing data being due to the presence of sojourn points. Fig. 2(c) merely reveals diagonal lines in RP3 and the cross-diagonals which showed up in RP1 have vanished completely. This was due to embedding the time series. Moreover, RP4 manifested how the cross-diagonal lines totally vanished. However, junction points connecting both diagonal and cross-diagonal lines vanished (see Fig. 2(d)) at τ=30 time units. This is due to the fact that the positions of crests and troughs in the sine wave (a) did not correspond to the same positions in the derived signal. Thus points constituting the crests and troughs did not exist within the same tolerance r, and hence black points disappeared. This could be due to the usage of the approximate derivative.

In Fig. 2(e) RP5 shows how the cross-diagonal lines vanished differently. A few points lying on the cross-diagonal lines persisted, as compared to RP
                           3 and RP
                           4. This might have been due to the fact that the time delay was not set according to a formulation, but rather it was by default equal to one. The time delay was less than T/4 (as for RP
                           3). The two signals adhered, consequently little cross-diagonal information showed up.

As a global visual evidence, sojourn points were eliminated using RP3, RP4 and RP5.

Evaluation of the performance of the transition detector and sojourn point reduction was taken into account for the biologically inspired logistic map and for the real healthy and distressed FHR data. For the logistic map, each detector operating on the DET parameter was evaluated for the five different RPs over different values of the control parameter b. Both a qualitative RP representation and a quantitative (the rate of the reduced sojourn points, sensitivity and specificity) evaluation were obtained. For FHRs, three parameters (DET, CDET and the Percentage of Reduced Sojourn Points (PRSP)) were evaluated from the five RPs of 30-min FHRs split into 10 windows of 3min each. The three statistical measures (mean, Standard Deviation (SD) and the Relative Error (RE)) were used to evaluate the detection of fetal transitions. Simulations were obtained using Matlab (Mathworks, Natick, MA, USA).

In order to mimic dynamic biomedical systems, the five techniques in Table 1 were applied to the simulated nonlinear biologically inspired system, known as the logistic map [17]. It was defined as
                           
                              (5)
                              
                                 
                                    
                                       x
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                 
                                 =
                                 b
                                 ⁎
                                 
                                    
                                       x
                                    
                                    
                                       n
                                    
                                 
                                 ⁎
                                 (
                                 1
                                 −
                                 
                                    
                                       x
                                    
                                    
                                       n
                                    
                                 
                                 )
                                 ,
                              
                           
                        where b stands for the control parameter of the logistic map and n the iteration number.


                        Fig. 3
                         sets out the bifurcation diagram of the logistic map and its corresponding standard and developed recurrence plots, originating from a simulated time series for b=4. Fig. 3 (top left) represents the famous bifurcation diagram of the logistic map for 
                           b
                           ∈
                           [
                           3.5
                           ,
                           4
                           ]
                        . The different dynamic regimes are displayed in green. For each b value, a time series of length M=1000 was computed with a step of 
                           Δ
                           b
                           =
                           0.0005
                        . DET values were recorded in relation to b and the detection of system state transitions is evaluated qualitatively and quantitatively in the next subsection. The time series corresponding to b=4, i.e. the chaotic region, was then simulated as suggested by [13,12] and incorporated in the illustration of sojourn point reduction below. The preferred b=4 maintained the maximum rate of system growth (i.e. chaoticity) [27].

As there is a major interest in reducing the number of sojourn points, Marwan et al. [13,12] suggested that calculating a time series for a fixed value of b is better for this purpose. Furthermore, to illustrate the advantages of our signal-based recurrence plots over existing plots, we simulated RP
                           1 and RP
                           2 for (b=4) [13,12]. Fig. 3 sets out (a) the unembedded recurrence plot RP1, (b) the embedded recurrence plot RP2 and the three signal-based RPs arranged as follows: (c) RP3 for 
                              τ
                              =
                              4
                           , (d) RP4 and (e) RP5. A zoomed portion of the RP was imposed on each plot to highlight different cross-diagonal lines (in red) that seemed to represent the sojourn points, and these were involved in the further quantitative evaluation. RP1 of the simulated time series x(t) showed various small diagonal and cross-diagonal lines (i.e diagonals perpendicular to the main diagonal). These features reflected the chaotic nature of the simulated system. RP2 resembled that simulated by Marwan et al. [13,12] for b=4. RP3 showed the least number of recurrences. It revealed that the major cross-diagonal lines had vanished, as well as significant vertical lines. This may have been due to the choice of 
                              
                                 
                                    d
                                 
                                 
                                    opt
                                 
                              
                              =
                              2
                            based on the minimum number of sojourn points that could be obtained. RP4 demonstrated how the cross-diagonal lines, which existed in the classical RP1 and in RP2 images, had vanished, whereas extra small structures and cross-diagonals showed up instead.

RP5 revealed that there was a remarkable loss of vertical information compared to RP4, especially in the small cross-diagonals. Thus sojourn points were reduced as a consequence of the detection techniques, as is obvious in Fig. 3(c)–(e).

As previously claimed by Marwan et al. [13,12], DET parameters seemed to be a good indicator for detecting dynamic changes from RPs.


                           CDET and DET, provided by Eq. (2) for l characterizing cross-diagonals and diagonals, respectively, were evaluated as percentages from the RPs of the simulated Logistic time series. Quantitative results are depicted in Table 2
                           . Tolerance r was initially chosen to be 10% of the standard deviation of the time series (as suggested in [13,12]) to ensure a noise-free situation. Table 2 shows that the DET changed from 78% according to RP2 to 73% according to RP3, i.e. the number of the points detected along the diagonal had slightly decreased. This may have been due to some long diagonal lines that were transformed into separate discrete points to reinforce the chaotic nature of the logistic map for (b=4). Moreover, the number of points detected along the cross-diagonal lines increased.

The straightforward comparison of the cross-diagonal values with the detected points forming the cross-diagonal lines obtained through the reference method, RP2, showed that (i) 27% out of 22% cross-diagonal points were detected in RP3, (ii) 13.3% out of 22% cross-diagonal points were detected in RP4, and (iii) 13% out of 22% cross-diagonal points were detected in RP5.

As a result, the remaining percentages of sojourn points were (i) 6%, (ii) 3% and (iii) 2.9% in RP3, RP4 and RP5, respectively. Consequently, the percentages of reduced sojourn points were (i) 94%, (ii) 97% and (iii) 97.1% in RP3, RP4 and RP5, respectively. Table 2 shows that the performance of the elimination of sojourn points can be arranged as follows: 
                              
                                 
                                    RP
                                 
                                 
                                    5
                                 
                              
                              >
                              
                                 
                                    RP
                                 
                                 
                                    4
                                 
                              
                              >
                              
                                 
                                    RP
                                 
                                 
                                    3
                                 
                              
                              >
                              
                                 
                                    RP
                                 
                                 
                                    1
                                 
                              
                           .

Simulations were performed to evaluate the performance of the three signal-based recurrence plot methods in detecting dynamic changes compared to already existing techniques (Fig. 4
                           ). Fig. 4 depicts the variation in the normalized determinism (shown in blue) as a function of the control parameter of the logistic map. The quantification parameter was computed from (a) RP1 (b) RP2, (c) RP3, (d) RP4 and (e) RP5. The three methods developed exhibited the major peaks present in the bifurcation diagram (diagonal information had been preserved).


                           Fig. 4 shows that the results of DET versus b of the techniques developed imitated those of RP2 but were not the same. For instance, the amplitudes of peaks were not strictly equal to 1 as in RP2. This led us to choose another detection criterion to distinguish between transitions. Although tracking unity to distinguish between transitions was effective in RP2, the number of peaks detected was not sufficient compared to our signal-based recurrence plots and the bifurcation diagram.

Despite this, a quantitative evaluation of the detection of dynamic transitions was necessary to provide a reliable interpretation.

Statistical measurements were used to evaluate the performance of detection. For each DET versus b displayed in Fig. 4 a constant threshold λ was applied and used as a detector. The value of λ
                           was chosen from an empirical inference, i.e. after trying several values then choosing the one permitting the detection of the maximum number of peaks. Four cases were encountered in the detection process: (i) True Positive (TP), represented the number of peaks/transitions detected in the right place (where there was a real transition), (ii) False positive (FP), represented the number of peaks detected in the wrong place (where there was no transition), (iii) False negative (FN), reflected the number of undetected peaks in the right position and (iv) True Negative (TN), represented the number of undetected peaks in the wrong position. Finally, both the 
                              Sensitivity
                              =
                              TP
                              /
                              (
                              TP
                              +
                              FN
                              )
                            and 
                              Specificity
                              =
                              TN
                              /
                              (
                              TN
                              +
                              FP
                              )
                            were calculated.

Based on the results in Fig. 4 we carried out a quantitative evaluation of whether the detection provided the exact position of each transition (see Fig. 3 top left). Table 3
                            sets out the performance of detection (P.D.), i.e. the percentages of both sensitivity and specificity in detecting dynamic transitions.

The values depicted in Table 3 were calculated for 
                              b
                              ∈
                              [
                              3.64
                              ,
                              4
                              ]
                           . The total number of detected and non-detected transitions was 11. As shown in Table 3, the m-time pattern and embedded recurrence plots with specific settings possessed both the ultimate sensitivity and specificity, i.e. 90% and 100%, respectively. In particular, the relative percentages of differences between the sensitivities of detection were computed. For instance, an increase in sensitivity of detection of 34.33% ((90−67)/67=34.33%) was obtained by the m-time pattern and embedded recurrence plot with specific settings over the embedded recurrence plot (RP2). Moreover, an increase in sensitivity of detection of 50% ((90−60)/60=50%) was obtained by the m-time pattern and embedded recurrence plot with specific settings over the unembedded recurrence plot (RP1).

It is clear from Table 3 that the levels of performance, in terms of sensitivity and specificity, were as follows: 
                              
                                 
                                    RP
                                 
                                 
                                    5
                                 
                              
                              =
                              
                                 
                                    RP
                                 
                                 
                                    3
                                 
                              
                              >
                              
                                 
                                    RP
                                 
                                 
                                    4
                                 
                              
                              >
                              
                                 
                                    RP
                                 
                                 
                                    2
                                 
                              
                              >
                              
                                 
                                    RP
                                 
                                 
                                    1
                                 
                              
                           . This showed that we could eliminate sojourn points without embedding at high dimensions.

Healthy and distressed FHRs were acquired at CHRU-Bretonneau Hospital Tours, France by the Fetal Multichannel Monitor (by Althais Technology, Tours). The consent of each patient was obtained and the study was approved by the Ethics Committee of the Clinical Investigation Center for Innovative Technology of Tours (CIC-IT 806 CHRU of Tours). Patients were over 18 years of age and each patient was carrying a single fetus. The gestational ages of fetuses ranged from 25 to 39 weeks; each fetus was monitored for 30minutes. Distressed fetuses were identified by Intrauterine Growth Restriction (IUGR) often associated with gaseous exchange issues.

Healthy and distressed FHRs were evaluated every 250ms as proposed by [3,28], yielding 7200 samples every 30minutes. Each signal was split into 10 sub-signals each of 3minutes (i.e. 10 windows). Fig. 5
                         shows three minute recordings of FHRs from two different fetuses at Bretonneau Hospital in Tours, France: (a) a healthy FHR recording and (b) a distressed FHR recording.

From the 10 sub-signals, 10 CDETs were evaluated by Eq. (2). The average value of CDET expressed as a percentage was obtained for healthy and distressed fetuses. Fig. 6
                            sets out the qualitative detection of healthy-distressed and distressed-healthy dynamic FHR transitions. Fig. 6(a) and (b) depicts the variation in CDET (%) and PRSP (%), respectively, as a function of the RP techniques. Tolerance r remained 10% of the standard deviation of the time series, as suggested in [13,12].

The rate of PRSP can be deduced from CDET by computing (100%−CDET). The bar graphs in Fig. 6(b) show the mean value of PRSP for each technique. The percentage of RE is shown at top of each bar graph. RE (in %) is the normalized difference between CDET obtained from healthy and distressed fetuses. For instance, RE of CDET obtained from RP
                           1 was calculated as follows: (67–46)/67=31%. The SD of each bar is shown in blue for the healthy fetus and in red for the distressed fetus. The rate of elimination for the distressed fetus is arranged in the following increasing order: 
                              
                                 
                                    RP
                                 
                                 
                                    1
                                 
                              
                              <
                              
                                 
                                    RP
                                 
                                 
                                    2
                                 
                              
                              <
                              
                                 
                                    RP
                                 
                                 
                                    3
                                 
                              
                              <
                              
                                 
                                    RP
                                 
                                 
                                    5
                                 
                              
                              <
                              
                                 
                                    RP
                                 
                                 
                                    4
                                 
                              
                           . For the healthy fetus the rate of elimination is arranged in the following increasing order: 
                              
                                 
                                    RP
                                 
                                 
                                    1
                                 
                              
                              <
                              
                                 
                                    RP
                                 
                                 
                                    2
                                 
                              
                              <
                              
                                 
                                    RP
                                 
                                 
                                    5
                                 
                              
                              <
                              
                                 
                                    RP
                                 
                                 
                                    3
                                 
                              
                              <
                              
                                 
                                    RP
                                 
                                 
                                    4
                                 
                              
                           .

To evaluate the performance of the three signal-based RPs in detecting dynamic changes of the fetal heart compared to existing techniques, RE and SD are highlighted in the bar graph simulations of Fig. 6. The dynamic changes involved in detection were healthy-distressed and distressed-healthy transitions.

The three proposed signal-based RP algorithms reduced the number of sojourn points (see Fig. 6(b)).

For the distressed fetus, the RE of PRSP was the lowest (at 33%) for RP
                           1 and the highest (at 83%) for RP
                           4. PRSP could be used as a discriminator for certain RP
                           
                              i
                            where 
                              i
                              =
                              [
                              1
                              ,
                              2
                              ,
                              3
                              ,
                              4
                              ,
                              5
                              ]
                            (see stars highlighted in Fig. 6(b)). This was due to the high relative error obtained between healthy and distressed FHRs for PRSP, and simultaneously the low standard deviation. The performance of detection was arranged as follows: RP
                           3 (with RE=50%), followed by RP
                           2 (with RE=39%) and RP
                           4 (with RE=16%) when SDs were small and well separated. Note that for RP
                           1, although RE was the highest, the standard deviation obtained was one of the lowest SD values.

For the above reasons, CDET in Fig. 6(a) could be also considered to be a discriminator for healthy-distressed and distressed-healthy transitions (of RP
                           2, RP
                           3, RP
                           4). The performance of detection based on RE was arranged in the following ascending order: 
                              
                                 
                                    RP
                                 
                                 
                                    5
                                 
                              
                              <
                              
                                 
                                    RP
                                 
                                 
                                    1
                                 
                              
                              <
                              
                                 
                                    RP
                                 
                                 
                                    2
                                 
                              
                              <
                              
                                 
                                    RP
                                 
                                 
                                    4
                                 
                              
                              <
                              
                                 
                                    RP
                                 
                                 
                                    3
                                 
                              
                           .

Finally, Fig. 6(c) shows a bar graph of the DET parameter originating from RP1, RP2, RP3, RP4 and 2-time recurrence plot RP5. From the 10 signals which were issued for 3min, 10 DETs were evaluated using Eq. (2). The average value of DET, expressed as a percentage, was obtained for both the healthy and distressed fetuses. This was the ultimate parameter appropriate for detecting transitions since the following four RPs, i.e. RP
                           3, RP
                           1, RP
                           4, RP
                           2 were capable of providing detection. Among the previous RPs, RP
                           3 was the best discriminator (with an RE of 153%), followed by RP
                           1 (with an RE of 95%) and RP
                           4 (with an RE of 91%). The performance of detection was arranged in the following ascending order: 
                              
                                 
                                    RP
                                 
                                 
                                    5
                                 
                              
                              <
                              
                                 
                                    RP
                                 
                                 
                                    2
                                 
                              
                              <
                              
                                 
                                    RP
                                 
                                 
                                    4
                                 
                              
                              <
                              
                                 
                                    RP
                                 
                                 
                                    1
                                 
                              
                              <
                              
                                 
                                    RP
                                 
                                 
                                    3
                                 
                              
                           .


                           Fig. 6(c) shows that for the healthy fetus RP
                           1 gave the highest value of DET (with DET=73%) followed by RP
                           3 (DET=58%).

@&#DISCUSSION AND CONCLUSION@&#

Of all the RPs and their corresponding detection efficacy tested with different configurations, only two RPs were always within the first three best detectors: those based on RP
                     3 and RP
                     4.

For the logistic map, Table 3 shows an increase of (90–60)/60=50% in sensitivity (60% for RP1 and 90% for RP5, see Table 3 for more details) by the m-pattern approach over the unembedded approach, whereas the specificity of all detectors was constant (100%). Although the sensitivity of detection by RP5 was similar to RP3, an additional 3.1% of sojourn points were eliminated by RP5 over RP3. An overall investigation of the simulated logistic system showed that RP5 was much more effective than RP3 in eliminating sojourn points, and slightly more effective than RP4.

For the FHRs, DET obtained from RP
                     3 was greater than that obtained from RP
                     2 although the dimension d=2 was the same. This indicates that the choice of the time delay is crucial for discrimination purposes in embedded RPs. From this study, it seemed that the time series obtained from the healthy fetus was more deterministic than that obtained from the distressed fetus. This was in accordance with the work of [3]. Moreover, DET obtained from RP
                     1 also appeared to be a good alternative since it did not require the embedding process to discriminate between single distressed fetus and single healthy fetus. RP
                     3 appeared to be the best since it was designed to be the most effective. RP
                     4, which is derivative-based, was also a good alternative since it does not require setting of both the time delay and the embedding dimension. Obviously complications with fetal gas exchange can reflect a healthy-distressed transition of the heart. This fact demonstrates the importance of novel signal-based RPs and unembedded RP in detecting such crucial dynamic changes. However, the use of a single healthy and a single distressed FHR limited the results of the application of the signal-based RPs to FHRs.

Comparing the detection results of the FHRs to those of the logistic map indicated that RP3 might have advantages over RP4 and RP5 for FHRs, whereas RP3 and RP5 had equal advantages over RP4 for the logistic map. This result could be due to the sensitivity of RP5 to the system, particularly to the degree of chaoticity. RP3 seemed to be the most stable among the signal-based RPs when applied to various chaotic systems.

The major findings of this study were the improvement in transition detection and the elimination of sojourn points. Although the sensitivity of the detector was affected by the existence of sojourn points, the specificity was not.

The comparison and the evaluation of the performances of RP simulations were significant and varied from one RP to another. Our hypothesis that signal-based RPs enhance the detection of dynamic behaviours of complex systems, particularly the logistic map and the fetal heart, was valid. We showed that different transitions can be detected cleanly, i.e. with the least number of sojourn points, the lowest dimensionality cost and the fewest complications.

It was worthwhile investigating the effects of embedding and finding an alternative tool independent of the embedding concept in order to achieve reliable chaotic-periodic and periodic-chaotic detection, and healthy-distressed and distressed-healthy transition detection and quantification with reduced bias.

It was obvious that the elimination of sojourn points could affect the detection of dynamic transitions. However, it was not possible to find an explicit relationship to describe this until now. We were able to reduce the false recurring information from FHR RPs. We were able also to improve the detection of different types of transitions which we believe are directly related to the problem in question.

These findings demonstrate that true recurrences, along with complex information, can be extracted from time series.

The significant level of performance of our unbiased RPs could interpret the change in the operating regime of nonlinear system such as the fetal heart by certain medical factors. These complications are highlighted by the difference between DET derived from clean RPs and those extracted from RPs contaminated with sojourn points. Consequently, such clean RPs should improve FHR diagnosis and play a major role on deciding on immediate delivery.

The results from the application of signal-based RPs to a single healthy fetus and a distressed fetus were promising. Future application of our signal-based RPs and their corresponding quantification should involve the use of a larger dataset for the diagnosis of multiple health issues.

None declared.

@&#ACKNOWLEDGMENTS@&#

This work was supported financially by the National Council for Scientific Research in Lebanon (CNRS-L), the Lebanese University and Imaging and Brain Laboratory, and the National Institute of Health and Medical Research, INSERM U930 in Tours, France. We thank Prof. F. Perrotin and his team in the Obstetric Department at CHRU-Bretonneau Hospital of Tours for recording the signals. We would like also to thank Miss Faten Khatib from the Sharp Chula Vista Medical Center in the United States for her valuable feedback and for editing the English language.


                     Fig. 7
                      is a diagram setting out the mode for selecting the optimal embedding dimension and time delay corresponding to the minimum number of sojourn points. Fig. 7 (top left) represents the sine signal, (center left) the cost-function versus the embedding dimension d and (bottom left) the cost-function versus the time delay. Fig. 7 (top right) represents a part of a healthy fetal heart rate recording, (center right) the cost-function versus the embedding dimension and (bottom right) the cost-function versus the time delay τ.


                     Fig. 7 (top left) represents the cost function versus d, while maintaining 
                        τ
                        =
                        T
                        /
                        4
                     , with T being the period of the signal as indicated theoretically. Note that τ could also be calculated by the autocorrelation. Fig. 7 (center left) sets out the first zero-crossing of J or J
                     
                        minimum
                      occurring at d=2. Consequently, d was set at 2 in the optimization process. Fig. 7 (bottom left) exhibits the cost function versus the time delay, while holding d fixed at 2. Parameter τ was tested in the following range 
                        0
                        ≤
                        τ
                        ≤
                        55
                     . This led to an optimized range rather than a single value, 
                        τ
                        ∈
                        {
                        6
                        ,
                        14
                        }
                        ∪
                        {
                        26
                        ,
                        34
                        }
                        ∪
                        {
                        46
                        ,
                        54
                        }
                      time unit.

By analogy to the sine wave, d and τ were optimized for the RP of both the logistic map and the FHRs. For the logistic map, d was set at 2 and τ at 4. For the healthy FHR, Fig. 7 (center right) demonstrates that J
                     
                        minimum
                      occurred at d=2. The range of d tested was from 2 to 7 embedding dimensions. Fig. 7 (bottom right) shows that J
                     
                        minimum
                      occurred at τ=1 time unit.

@&#REFERENCES@&#

