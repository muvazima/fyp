@&#MAIN-TITLE@&#Accelerometric signals in automatic balance assessment

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           We propose a system for automatic balance assessment.


                        
                        
                           
                           Acceleration signals acquired by sensors worn by a patient.


                        
                        
                           
                           Multiple medium and high frequency signal features extraction and selection.


                        
                        
                           
                           Building an expert system able to process the feature vector.


                        
                        
                           
                           Experiments with seven BBS activities and 52 elderly patients yielding 75–94% of correct assessments.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Ambient assisted living

Computer-aided diagnosis

Balance assessment

Feature extraction

@&#ABSTRACT@&#


               
               
                  The paper presents the automatic computer-aided balance assessment system for supporting and monitoring the diagnosis and rehabilitation process of patients with limited mobility or disabled in home environment. The system has adopted seven Berg Balance Scale activities. The assessment approach is based on the accelerometric signals acquired by the inertial sensors worn by the patient. Several specific, mostly medium frequency features of signals are introduced and discussed. The reduction of the feature vector has been performed using the multilevel Fisher's linear discriminant. The classification employs the multilayer perceptron artificial neural network. The direct assessment effectiveness ranges from 75% to 94% for various activities.
               
            

@&#INTRODUCTION@&#

The clinical balance assessment has been an object of study in the past years [1]. Various disorders and diseases (Parkinson's disease, multiple sclerosis, neurological and musculoskeletal diseases [2,3]) are accompanied by balance problems. Due to the aging of contemporary societies, the safety and well-being of the elderly emerges as one of the major concerns in health care; this general consideration easily covers balance assessment and therapy. The postural perturbations and balance disorders control is critical for the selection of the proper treatment and rehabilitation [4]. The assessment requires dedicated procedures and standards to provide reliable inference and enable detection of possible threats. It has been discovered and proven, that specific activity-based testing of certain tasks (transfer, turning, reaching, standing, gait) meets this requirement very well [5].

Several clinical tests for balance assessment have been proposed in the past 50 years. A comprehensive review throughout this area might be found in [6]. Lets mention just few propositions from the last 30 years. In the Tinetti Balance and Gait Test [7] a clinician rates a total of 24 postural balance and gait tasks, which enable reliable fall prediction. The Activities-Specific Balance Confidence Scale (ABC) test [8,9] collects knowledge via a 16-item questionnaire on the subject's confidence while attempting different daily activities. The quick one-task tests (”timed up and go” – TUG [10], functional reach [11] and some earlier propositions) provide fast results, yet yield neither comprehensive nor sufficient information about the balance problem. On the other hand, advanced or multi-input ideas (Physiological Profile Approach – PPA [12], Balance Evaluation Systems Test – BESTest [13]) show satisfactory fall prediction sensitivity and inter-rater reliability, yet are difficult to perform due to a long duration (ca. 30min) and equipment requirements.

Among these approaches, the Berg Balance Scale (BBS) test [14–16] is recognized as a reasonable tool for balance evaluation. The easy to use test consists of 14 various tasks, each one rated between 0 and 4 according to precisely defined criteria. The total score classifies a subject into one of three groups, referring to the physical abilities and fall risk. The test takes ca. 10–15min with the individual task duration ranging between 5 and 120s. The BBS is valued for its high inter-rater reliability and specificity indicators (both over 95% [6]). However, some recent studies have shown its relatively poor sensitivity in fall prediction, as well as frequent uncertainty between two close scores: the BBS requires an 8 point change to be considered a clinically relevant difference [17,18]. Nonetheless, the Berg test remains popular and is willingly used in balance evaluation.

To the best of our knowledge, there are only isolated, preliminary reports on the attempts to automatize the BBS scoring. An application for mobile device has been proposed in [19], using the ACHILE acquisition system [20]. It consists of a set of different sensors (accelerometer, gyroscope, force, temperature, and humidity sensors, bending variable resistor) placed in a sole. Each BBS task has been implemented in a form of a serious game with the inference output based on acquired signals. The application has been tested with nine male students, yet neither profound numerical results, nor the application-to-expert reference have been reported. Rare commercial (mobile) applications offer user-friendly interfaces for the test supervision, yet the scoring is not automated and still relies on the operator's assessment [21,22]. Since inertial sensors are kept more common due to their presence in easily accessible mobile devices, the reliable automatic assessment tools may become a basic and valuable instrument in the elderly care, also in home environment. This, however, requires a comprehensive study on inertial signals features, repeatability, inter-device, inter-subject or even inter-clothe invariance, using the simplest and less expensive or disturbing devices. This paper stands for the primary investigation on the accelerometric signals usefulness in such a task.

In our previous works, we focused on the development of an ambient assisted living (AAL) system for activity monitoring of the elderly in home environment [23,24]. The overall aim of the current research is to ensure well-being of the elderly people who are living (possibly alone) in their homes. Although the patient might be assigned to a higher risk group for falls or fainting, she/he can still live a normal life. The remote AAL supervision should not disturb the patient, and the equipment is supposed to be as simple and cheap as possible. Minor goals include direct incident detection, short-term threat prediction and long-term subject's condition monitoring, able to indicate more or less noticeable decreases in health. Furthermore, we would like to create some sort of a subject-specific model on the basis of one's standard behavior, e.g. overall and detailed motion characteristics, activity time distribution, etc. To do so, a remotely accessible computer-aided diagnosis (CAD) [25] AAL system has been proposed [24], employing mobile data acquisition devices with inertial sensors at the lowest level of the architecture. Preliminary study on signal personalization in feature domain has been reported in [26]. Having the entire system prepared and running, as well as some assessment standards as defined above, we can attempt to use the available data to monitor and evaluate the patient's balance abilities.

The ultimate goal of this study is to develop an automatic system of accelerometric signal analysis that supports the balance assessment. Such a solution plugged into the AAL system designed to monitor the patient in home environment is supposed to substantially aid the balance evaluation according to well known standards without a need to visit the hospital. The system is supposed to serve as a long-term objective tool able to evaluate specific activities periodically performed in home environment and remotely supervised by the physiotherapist. Therefore, seven activities from the BBS able to be performed at home have been chosen under the physician's and physiotherapist's supervision. A set of specific signal features have been proposed as premises for the automatic inference system. Most of them are extracted from the medium and high frequency range and thus reflect the directional motion characteristics of the patient. The feature space dimensionality reduction and classifier training and testing have been performed to indicate features most relevant for certain activities and motion patterns.

The paper is organized as follows. After the introduction, all aspects of the methodology are presented in details in Section 2: the sensors description and arrangement, the input data, selected activity types under consideration, feature definition, extraction, and selection techniques, and the expert system specification. Section 3 introduces and summarizes the experimental results. Section 4 concludes the paper.

The overall scheme of the proposed assessment system is presented in Fig. 1
                        . All experiments described in this paper have been supervised by physicians and physiotherapists. Each activity is monitored by five inertial sensors (MPU6050 modules), measuring the acceleration and angular velocity in three directions (Fig. 2
                        ).

With sampling frequency f
                        
                           s
                         set to 100Hz, each sensor produces two 3-element samples in time t: (1) acceleration 
                           a
                           (
                           t
                           )
                           =
                           
                              
                                 
                                    
                                       
                                          a
                                          x
                                       
                                       (
                                       t
                                       )
                                       ,
                                       
                                          a
                                          y
                                       
                                       (
                                       t
                                       )
                                       ,
                                       
                                          a
                                          z
                                       
                                       (
                                       t
                                       )
                                    
                                 
                              
                              T
                           
                         normalized with respect to the gravitational acceleration g and (2) angular velocity 
                           ω
                           (
                           t
                           )
                           =
                           
                              
                                 
                                    
                                       
                                          ω
                                          x
                                       
                                       (
                                       t
                                       )
                                       ,
                                       
                                          ω
                                          y
                                       
                                       (
                                       t
                                       )
                                       ,
                                       
                                          ω
                                          z
                                       
                                       (
                                       t
                                       )
                                    
                                 
                              
                              T
                           
                         in radians per second.

The raw acceleration data from inertial sensors are preprocessed according to procedures described in [26]. This includes e.g. the gyroscope data-based virtual sensor rotation to the default position, applied to predict and remove the gravitational acceleration influence on each of the sensor axis using complementary filter [27,28].

For the feature extraction and classification purposes, some additional signals and representations are determined at the preprocessing stage:
                           
                              1
                              Jerk 
                                    
                                       
                                          j
                                       
                                    
                                    (
                                    t
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   j
                                                   x
                                                
                                                (
                                                t
                                                )
                                                ,
                                                
                                                   j
                                                   y
                                                
                                                (
                                                t
                                                )
                                                ,
                                                
                                                   j
                                                   z
                                                
                                                (
                                                t
                                                )
                                             
                                          
                                       
                                       T
                                    
                                 , as the derivative of acceleration with respect to time:
                                    
                                       (1)
                                       
                                          
                                             j
                                             i
                                          
                                          =
                                          
                                             
                                                d
                                                
                                                   a
                                                   i
                                                
                                                (
                                                t
                                                )
                                             
                                             dt
                                          
                                          :
                                          
                                          i
                                          =
                                          {
                                          x
                                          ,
                                          y
                                          ,
                                          z
                                          }
                                          .
                                       
                                    
                                 
                              

Jounce 
                                    
                                       
                                          s
                                       
                                    
                                    (
                                    t
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   s
                                                   x
                                                
                                                (
                                                t
                                                )
                                                ,
                                                
                                                   s
                                                   y
                                                
                                                (
                                                t
                                                )
                                                ,
                                                
                                                   s
                                                   z
                                                
                                                (
                                                t
                                                )
                                             
                                          
                                       
                                       T
                                    
                                 , as the second derivative of acceleration with respect to time:
                                    
                                       (2)
                                       
                                          
                                             s
                                             i
                                          
                                          =
                                          
                                             
                                                
                                                   d
                                                   2
                                                
                                                
                                                   a
                                                   i
                                                
                                                (
                                                t
                                                )
                                             
                                             
                                                d
                                                
                                                   t
                                                   2
                                                
                                             
                                          
                                          =
                                          
                                             
                                                d
                                                
                                                   j
                                                   i
                                                
                                                (
                                                t
                                                )
                                             
                                             dt
                                          
                                          :
                                          
                                          i
                                          =
                                          {
                                          x
                                          ,
                                          y
                                          ,
                                          z
                                          }
                                          .
                                       
                                    
                                 
                              

For each signal under consideration: the Euclidean vector length at time t, indicated by a subscript ρ, e.g. for the acceleration:
                                    
                                       (3)
                                       
                                          
                                             a
                                             ρ
                                          
                                          (
                                          t
                                          )
                                          =
                                          
                                             
                                                
                                                   a
                                                   x
                                                
                                                
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   2
                                                
                                                +
                                                
                                                   a
                                                   y
                                                
                                                
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   2
                                                
                                                +
                                                
                                                   a
                                                   z
                                                
                                                
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                   2
                                                
                                             
                                          
                                          .
                                       
                                    
                                 
                              

Five sensors are used for accelerometric data acquisition. The data is obtained from 52 patients: 41 female and 11 male. The age of subjects ranges from 62 to 91 years with a mean of 77.9±6.8. Thirty-one patients have been generally assessed as “independent”, whilst 21 – as “walking with assistance”. Each examination consists of seven activities:
                           
                              •
                              
                                 sitting to standing,


                                 standing unsupported,


                                 standing to sitting,


                                 standing unsupported with eyes closed,


                                 retrieving an object from the floor,


                                 turn 360°,


                                 stepping on the stair.

The reference scoring summary is given in Table 2
                        .

In each case raw acceleration signals are acquired from five body locations. Five of these activities are rather short (the total time T up to 20s), two (standing unsupported with or without eyes closed) take up to 120s. Their representation in frequency domain represents some noticeable patterns, which have been used in feature extraction phase.

A large set of features have been proposed, extracted and tested during the system development. They are divided into three groups and described in this section:
                           
                              •
                              jerk and jounce features,

STFT-based features,

temporal features.

Automatic activity recognition systems often employ basic scalar acceleration characteristics, like the signal mean, standard deviation or peak-to-peak amplitude in a specified time window [23,30]. The sum of the signal absolute values in one of directions has been found as a more useful measure. That concerns mainly two types of signals: jerk j and jounce s:
                              
                                 (4)
                                 
                                    
                                       Σ
                                       
                                          
                                             j
                                             i
                                          
                                       
                                       S
                                    
                                    =
                                    
                                       ∑
                                       
                                          n
                                          =
                                          1
                                       
                                       N
                                    
                                    |
                                    
                                       j
                                       i
                                       S
                                    
                                    (
                                    n
                                    )
                                    |
                                    ,
                                 
                              
                           
                           
                              
                                 (5)
                                 
                                    
                                       Σ
                                       
                                          
                                             s
                                             i
                                          
                                       
                                       S
                                    
                                    =
                                    
                                       ∑
                                       
                                          n
                                          =
                                          1
                                       
                                       N
                                    
                                    |
                                    
                                       s
                                       i
                                       S
                                    
                                    (
                                    n
                                    )
                                    |
                                    ,
                                 
                              
                           also in a variant normalized per second: 
                              
                                 
                                    (6)
                                    
                                       
                                          σ
                                          
                                             
                                                j
                                                i
                                             
                                          
                                          S
                                       
                                       =
                                       
                                          
                                             
                                                Σ
                                                
                                                   
                                                      j
                                                      i
                                                   
                                                
                                                S
                                             
                                          
                                          T
                                       
                                       ,
                                    
                                 
                                 
                                    (7)
                                    
                                       
                                          σ
                                          
                                             
                                                s
                                                i
                                             
                                          
                                          S
                                       
                                       =
                                       
                                          
                                             
                                                Σ
                                                
                                                   
                                                      s
                                                      i
                                                   
                                                
                                                S
                                             
                                          
                                          T
                                       
                                       .
                                    
                                 
                              
                            with i
                           ={x, y, z, ρ}, S denoting the sensor number or ID and N being the number of signal samples. The above measures are used to calculate ratios that compare motion of various sensors. Ankle-to-ankle, hip-to-hip, back-to-ankle and back-to-hip ratios r are defined by both, jerk and jounce, in each direction, as:
                              
                                 (8)
                                 
                                    
                                       r
                                       
                                          
                                             j
                                             i
                                          
                                       
                                       
                                          
                                             A
                                             p
                                          
                                          
                                             A
                                             a
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             Σ
                                             
                                                
                                                   j
                                                   i
                                                
                                             
                                             
                                                
                                                   A
                                                   p
                                                
                                             
                                          
                                       
                                       
                                          
                                             Σ
                                             
                                                
                                                   j
                                                   i
                                                
                                             
                                             
                                                
                                                   A
                                                   a
                                                
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    
                                    
                                       r
                                       
                                          
                                             s
                                             i
                                          
                                       
                                       
                                          
                                             A
                                             p
                                          
                                          
                                             A
                                             a
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             Σ
                                             
                                                
                                                   s
                                                   i
                                                
                                             
                                             
                                                
                                                   A
                                                   p
                                                
                                             
                                          
                                       
                                       
                                          
                                             Σ
                                             
                                                
                                                   s
                                                   i
                                                
                                             
                                             
                                                
                                                   A
                                                   a
                                                
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                           
                              
                                 (9)
                                 
                                    
                                       r
                                       
                                          
                                             j
                                             i
                                          
                                       
                                       
                                          
                                             H
                                             p
                                          
                                          
                                             H
                                             a
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             Σ
                                             
                                                
                                                   j
                                                   i
                                                
                                             
                                             
                                                
                                                   H
                                                   p
                                                
                                             
                                          
                                       
                                       
                                          
                                             Σ
                                             
                                                
                                                   j
                                                   i
                                                
                                             
                                             
                                                
                                                   H
                                                   a
                                                
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    
                                    
                                       r
                                       
                                          
                                             s
                                             i
                                          
                                       
                                       
                                          
                                             H
                                             p
                                          
                                          
                                             H
                                             a
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             Σ
                                             
                                                
                                                   s
                                                   i
                                                
                                             
                                             
                                                
                                                   H
                                                   p
                                                
                                             
                                          
                                       
                                       
                                          
                                             Σ
                                             
                                                
                                                   s
                                                   i
                                                
                                             
                                             
                                                
                                                   H
                                                   a
                                                
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                           
                              
                                 (10)
                                 
                                    
                                       r
                                       
                                          
                                             j
                                             i
                                          
                                       
                                       
                                          B
                                          
                                             A
                                             a
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             Σ
                                             
                                                
                                                   j
                                                   i
                                                
                                             
                                             B
                                          
                                       
                                       
                                          
                                             Σ
                                             
                                                
                                                   j
                                                   i
                                                
                                             
                                             
                                                
                                                   A
                                                   a
                                                
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    
                                    
                                       r
                                       
                                          
                                             s
                                             i
                                          
                                       
                                       
                                          B
                                          
                                             A
                                             a
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             Σ
                                             
                                                
                                                   s
                                                   i
                                                
                                             
                                             B
                                          
                                       
                                       
                                          
                                             Σ
                                             
                                                
                                                   s
                                                   i
                                                
                                             
                                             
                                                
                                                   A
                                                   a
                                                
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                           
                              
                                 (11)
                                 
                                    
                                       r
                                       
                                          
                                             j
                                             i
                                          
                                       
                                       
                                          B
                                          
                                             A
                                             p
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             Σ
                                             
                                                
                                                   j
                                                   i
                                                
                                             
                                             B
                                          
                                       
                                       
                                          
                                             Σ
                                             
                                                
                                                   j
                                                   i
                                                
                                             
                                             
                                                
                                                   A
                                                   p
                                                
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    
                                    
                                       r
                                       
                                          
                                             s
                                             i
                                          
                                       
                                       
                                          B
                                          
                                             A
                                             p
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             Σ
                                             
                                                
                                                   s
                                                   i
                                                
                                             
                                             B
                                          
                                       
                                       
                                          
                                             Σ
                                             
                                                
                                                   s
                                                   i
                                                
                                             
                                             
                                                
                                                   A
                                                   p
                                                
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                           
                              
                                 (12)
                                 
                                    
                                       r
                                       
                                          
                                             j
                                             i
                                          
                                       
                                       
                                          B
                                          
                                             H
                                             a
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             Σ
                                             
                                                
                                                   j
                                                   i
                                                
                                             
                                             B
                                          
                                       
                                       
                                          
                                             Σ
                                             
                                                
                                                   j
                                                   i
                                                
                                             
                                             
                                                
                                                   H
                                                   a
                                                
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    
                                    
                                       r
                                       
                                          
                                             s
                                             i
                                          
                                       
                                       
                                          B
                                          
                                             H
                                             a
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             Σ
                                             
                                                
                                                   s
                                                   i
                                                
                                             
                                             B
                                          
                                       
                                       
                                          
                                             Σ
                                             
                                                
                                                   s
                                                   i
                                                
                                             
                                             
                                                
                                                   H
                                                   a
                                                
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                           
                              
                                 (13)
                                 
                                    
                                       r
                                       
                                          
                                             j
                                             i
                                          
                                       
                                       
                                          B
                                          
                                             H
                                             p
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             Σ
                                             
                                                
                                                   j
                                                   i
                                                
                                             
                                             B
                                          
                                       
                                       
                                          
                                             Σ
                                             
                                                
                                                   j
                                                   i
                                                
                                             
                                             
                                                
                                                   H
                                                   p
                                                
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    
                                    
                                       r
                                       
                                          
                                             s
                                             i
                                          
                                       
                                       
                                          B
                                          
                                             H
                                             p
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             Σ
                                             
                                                
                                                   s
                                                   i
                                                
                                             
                                             B
                                          
                                       
                                       
                                          
                                             Σ
                                             
                                                
                                                   s
                                                   i
                                                
                                             
                                             
                                                
                                                   H
                                                   p
                                                
                                             
                                          
                                       
                                    
                                    ,
                                    ,
                                 
                              
                           where A
                           
                              a
                           , A
                           
                              p
                           , H
                           
                              a
                           , H
                           
                              p
                           , B stand for active ankle, passive ankle, active hip, passive hip and back, respectively. The differentiation between passive and active leg (ankle, hip) is based on the short-time Fourier transform (STFT) [31] of the acceleration signal a(t), providing more valuable features for the analysis, and described in Section 2.3.2.

Other features are extracted from the jerk signal by the observation of significant jerk values, indicating motion moments. Therefore, the number of noticeable jerk peaks is determined. A minimum jerk threshold ξ is used to eliminate insignificant fluctuations: the peak is in fact treated as a single transition outside the [−
                           ξ, ξ] interval (Fig. 3
                           ).

The total number of such peaks is denoted as 
                              
                                 P
                                 
                                    
                                       j
                                       i
                                    
                                 
                                 S
                              
                              (
                              ξ
                              )
                           , and the same feature per second – 
                              
                                 p
                                 
                                    
                                       j
                                       i
                                    
                                 
                                 S
                              
                              (
                              ξ
                              )
                           .

Due to the type of activities, a frequency range of [0, 8]Hz with a step 0.5Hz has been applied for the STFT analysis, with the 50-sample (0.5s) non-overlapping Hamming window. In order to eliminate the low frequency components, the STFT analysis and feature extraction are performed in the range of f
                           ∈[2, 8]Hz (Fig. 4
                           a).

The first feature is the total medium frequency energy per second:
                              
                                 (14)
                                 
                                    
                                       E
                                       
                                          
                                             a
                                             i
                                          
                                       
                                       S
                                    
                                    =
                                    
                                       1
                                       T
                                    
                                    ·
                                    
                                       ∑
                                       
                                          f
                                          ∈
                                          [
                                          2
                                          ,
                                          8
                                          ]
                                       
                                    
                                    
                                       ∑
                                       t
                                    
                                    |
                                    
                                       STFT
                                       
                                          
                                             a
                                             i
                                          
                                       
                                       S
                                    
                                    (
                                    f
                                    ,
                                    t
                                    )
                                    |
                                    ,
                                 
                              
                           where 
                              
                                 STFT
                                 
                                    
                                       a
                                       i
                                    
                                 
                                 S
                              
                              (
                              f
                              ,
                              t
                              )
                            is the STFT sample at frequency f and time t computed for the ith component of acceleration signal acquired by sensor S. The active ankle is indicated by the higher total energy. This points out the active leg and hip. In most of the exercises under consideration there is an important influence of the discrepancy between legs (mainly ankles) activities. Therefore, another feature is used in a form of a passive-to-active ankle ratio. It is defined as:
                              
                                 (15)
                                 
                                    
                                       r
                                       
                                          
                                             STFT
                                             
                                                
                                                   a
                                                   i
                                                
                                             
                                          
                                       
                                       
                                          
                                             A
                                             p
                                          
                                          
                                             A
                                             a
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                             
                                                i
                                                =
                                                {
                                                x
                                                ,
                                                y
                                                ,
                                                z
                                                ,
                                                ρ
                                                }
                                             
                                          
                                          
                                             E
                                             
                                                
                                                   a
                                                   i
                                                
                                             
                                             
                                                
                                                   A
                                                   p
                                                
                                             
                                          
                                       
                                       
                                          
                                             ∑
                                             
                                                i
                                                =
                                                {
                                                x
                                                ,
                                                y
                                                ,
                                                z
                                                ,
                                                ρ
                                                }
                                             
                                          
                                          
                                             E
                                             
                                                
                                                   a
                                                   i
                                                
                                             
                                             
                                                
                                                   A
                                                   a
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Very often the exercise evaluation is determined by balance interference (shakes, leans, unsuccessful foot raises, jitter, sometimes falls). All these short motion incidents leave a trail in the higher frequency region on the STFT domain. Thus, a set of features is defined, that takes advantage of the constant frequency STFT profiles at certain levels (Fig. 4a). Lets take a constant frequency f and extract the row from 
                              
                                 STFT
                                 
                                    
                                       a
                                       i
                                    
                                 
                                 S
                              
                              (
                              f
                              ,
                              t
                              )
                            (Fig. 4b). The sum of its elements per second:
                              
                                 (16)
                                 
                                    
                                       E
                                       
                                          
                                             a
                                             i
                                          
                                       
                                       S
                                    
                                    (
                                    f
                                    )
                                    =
                                    
                                       1
                                       T
                                    
                                    ·
                                    
                                       ∑
                                       t
                                    
                                    |
                                    
                                       STFT
                                       
                                          
                                             a
                                             i
                                          
                                       
                                       S
                                    
                                    (
                                    f
                                    ,
                                    t
                                    )
                                    |
                                    ,
                                 
                              
                           constitutes the feature for each sensor and direction. Energy variation in frequency channels is investigated via the profile gradient computation (Fig. 4c):
                              
                                 (17)
                                 
                                    ∇
                                    
                                       STFT
                                       
                                          
                                             a
                                             i
                                          
                                       
                                       S
                                    
                                    (
                                    f
                                    ,
                                    t
                                    )
                                    =
                                    
                                       
                                          d
                                          
                                             STFT
                                             
                                                
                                                   a
                                                   i
                                                
                                             
                                             S
                                          
                                          (
                                          f
                                          ,
                                          t
                                          )
                                       
                                       dt
                                    
                                    .
                                 
                              
                           The total energy of the acceleration variations at frequency f per second (corresponding to the jerk-based measures) is found by:
                              
                                 (18)
                                 
                                    
                                       E
                                       
                                          ∇
                                          
                                             a
                                             i
                                          
                                       
                                       S
                                    
                                    (
                                    f
                                    )
                                    =
                                    
                                       1
                                       T
                                    
                                    ·
                                    
                                       ∑
                                       t
                                    
                                    |
                                    ∇
                                    
                                       STFT
                                       
                                          
                                             a
                                             i
                                          
                                       
                                       S
                                    
                                    (
                                    f
                                    ,
                                    t
                                    )
                                    |
                                    ,
                                 
                              
                           
                        

Another way to extract the information of the motion incidents is to threshold the 
                              
                                 STFT
                                 
                                    
                                       a
                                       i
                                    
                                 
                                 S
                              
                              (
                              f
                              ,
                              t
                              )
                            at a θ level, to obtain the binary version of the STFT matrix
                              1
                           
                           
                              1
                              Binary data is denoted in lower case letters.
                            (Fig. 5
                           a,b):


                           
                              
                                 (19)
                                 
                                    
                                       stft
                                       
                                          
                                             a
                                             i
                                          
                                       
                                       S
                                    
                                    (
                                    f
                                    ,
                                    t
                                    ,
                                    θ
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      ⇔
                                                   
                                                   
                                                      
                                                         STFT
                                                         
                                                            
                                                               a
                                                               i
                                                            
                                                         
                                                         S
                                                      
                                                      (
                                                      f
                                                      ,
                                                      t
                                                      )
                                                      >
                                                      θ
                                                   
                                                
                                                
                                                   
                                                      0
                                                   
                                                   
                                                   
                                                      otherwise
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Similarly, a profile can be extracted from 
                              
                                 stft
                                 
                                    
                                       a
                                       i
                                    
                                 
                                 S
                              
                              (
                              f
                              ,
                              t
                              ,
                              θ
                              )
                           , yielding a binary, one dimensional signal (Fig. 5c). Two measures are determined for each profile: the mean value per second:
                              
                                 (20)
                                 
                                    
                                       e
                                       
                                          
                                             a
                                             i
                                          
                                       
                                       S
                                    
                                    (
                                    f
                                    ,
                                    θ
                                    )
                                    =
                                    
                                       1
                                       T
                                    
                                    ·
                                    
                                       ∑
                                       t
                                    
                                    
                                       stft
                                       
                                          
                                             a
                                             i
                                          
                                       
                                       S
                                    
                                    (
                                    f
                                    ,
                                    t
                                    ,
                                    θ
                                    )
                                    ,
                                 
                              
                           and the number of peaks 
                              
                                 n
                                 
                                    
                                       a
                                       i
                                    
                                 
                                 S
                              
                              (
                              f
                              ,
                              θ
                              )
                            (local maxima, corresponding to the balance disturbances) per signal (illustrated in Fig. 5c).

Finally, the entire 
                              
                                 stft
                                 
                                    
                                       a
                                       i
                                    
                                 
                                 S
                              
                              (
                              f
                              ,
                              t
                              ,
                              θ
                              )
                            might be treated as a binary image and searched for 4-connected components [32]. The number of connected components in 
                              
                                 stft
                                 
                                    
                                       a
                                       i
                                    
                                 
                                 S
                              
                              (
                              f
                              ,
                              t
                              ,
                              θ
                              )
                            is defined as 
                              
                                 c
                                 
                                    
                                       a
                                       i
                                    
                                 
                                 S
                              
                              (
                              θ
                              )
                            (Fig. 5b).

The medium frequency STFT analysis is used in patient's activity detection. In each STFT time window, the total energy in a [2, 8] Hz range is computed for all sensors and components. High energy values common for multiple signals indicate motion timestamps, and form the activity chart, yielding the temporal features: total activity and inactivity times T
                           
                              act
                           , T
                           
                              inact
                           , activity and inactivity time per second t
                           
                              act
                           , t
                           
                              inact
                           , and the activity ratio:
                              
                                 (21)
                                 
                                    
                                       r
                                       act
                                    
                                    =
                                    
                                       
                                          
                                             T
                                             act
                                          
                                       
                                       T
                                    
                                    .
                                 
                              
                           
                        

Since the total number of features to be processed with fixed frequencies and thresholds reaches a few hundred, a selection stage is required.

In order to reduce the feature space dimensionality, a multilevel Fisher's linear discriminant (FLD) [33] is employed. Since the total number of features under the FLD analysis (several hundred) exceeds both, number of clusters (5) and reference data samples (several dozen), the process has to be complex and performed on a large number of FLD applications (tournaments) with a small amount M
                        
                           FLD
                         (10–15) of randomly selected features (Algorithm 1). Each tournament yields a set of features marked as winners. The whole process is repeated N
                        
                           FLDtrials
                        
                        =1000 times to improve selection reliability. Features indicated by the highest amount of tournaments are then passed to the final round, which subjects the ultimate feature vector to the classifier. Various p-levels for the null hypothesis verification have been tested. The optimal number of features N
                        
                           f
                         varies from 5 to 15 per task. Then, for a fixed number of inputs, the classification phase takes place.


                        
                           Algorithm 1
                           Feature space dimensionality reduction. 
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

The balance assessment expert system employs a multilayer perceptron (MLP) artificial neural network (ANN) [34] (Fig. 6
                        );

its specification is as follows:
                           
                              •
                              The number of layers has been set to 4 (including two hidden layers).

There are 10 and 8 neurons in hidden layers, respectively. The output layer has a single neuron, providing a real-valued output y. Since the number of inputs (distinctive features) N
                                 
                                    f
                                  varies depending on the activity, some attempts to adaptively follow N
                                 
                                    f
                                  while establishing the number of hidden layers and neurons have been done, yet the fixed structure as described above provides the best classification efficiency.

The hyperbolic tangent activation function is applied in hidden layers’ neurons, whilst the output neuron has a partially linear form presented in Fig. 7
                                 . It covers the desired output range of [0, 4] with a 0.5 margin, which shows better properties than other tested margin sizes (e.g. 0.0 or 1.0).

The features are initially normalized to the [−1, 1] range.

The network learning phase employs the backpropagation with adaptive learning rate [35,34]. During the training process the learning rate can be decreased when the training epoch enhances the network error. Otherwise, the learning rate grows to accelerate the gradient descent learning. Each learning step involves a feature vector at the input side and the expert score for evaluated patient and activity as the desired network response.

@&#RESULTS AND DISCUSSION@&#

The reference database presented in Table 2 has been used at the evaluation stage. The training and testing procedure employs the k-fold cross validation scheme with k
                     =10 [36,37]. For each activity, the entire set of features described in Section 2.3 is extracted, processed by the FLD analysis (Section 2.4) and subjected to the classifier for training and testing. The collection of features described in Section 2 is extracted for each fixed combination of parameters (thresholds ξ, θ and frequency f). The following values are established for parameters: ξ
                     ={0.01, 0.025, 0.05}, f
                     ={2, 5, 8} Hz, and θ
                     ={0.25, 0.5, 1.0, 2.0, 4.0}. Features selected by the FLD stage are shown in Table 3
                     .


                     Fig. 8
                      shows the confusion matrices obtained during testing specific activities.

Two efficiency measures have been defined for each activity:
                        
                           1
                           Assessment efficiency, defined as a percentage of correct assessments N
                              
                                 corr
                              , given N
                              
                                 tot
                               testing data:
                                 
                                    (22)
                                    
                                       Eff
                                       =
                                       
                                          
                                             
                                                N
                                                corr
                                             
                                          
                                          
                                             
                                                N
                                                tot
                                             
                                          
                                       
                                       ·
                                       100
                                       %
                                       .
                                    
                                 
                              
                           

Mean distance d
                              
                                 mean
                               between the real-valued MLP responses and the reference scores:
                                 
                                    (23)
                                    
                                       
                                          d
                                          mean
                                       
                                       =
                                       
                                          1
                                          
                                             
                                                N
                                                tot
                                             
                                          
                                       
                                       ·
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             
                                                N
                                                tot
                                             
                                          
                                       
                                       
                                          d
                                          i
                                       
                                       ,
                                    
                                 
                              where a single distance d
                              
                                 i
                               is defined for a response y
                              
                                 i
                               and an expert score ES
                              
                                 i
                               as:
                                 
                                    (24)
                                    
                                       
                                          d
                                          i
                                       
                                       =
                                       |
                                       
                                          δ
                                          i
                                       
                                       |
                                       ,
                                    
                                 
                              
                              
                                 
                                    (25)
                                    
                                       
                                          δ
                                          i
                                       
                                       =
                                       
                                          y
                                          i
                                       
                                       −
                                       
                                          ES
                                          i
                                       
                                       .
                                    
                                 
                              
                           

More comprehensive information on the assessment performance is presented in Fig. 9
                      as histograms of the assessment error Δ (black lines):


                     
                        
                           (26)
                           
                              Δ
                              =
                              Y
                              −
                              ES
                              .
                           
                        
                     It can be noticed that almost all system mistakes differ by ±1 from the reference score; no errors by a margin of ±3 or more have been observed. Moreover, since each classifier response y has been truncated to the nearest integer Y, the real interval for Y is y
                     ∈([Y
                     −0.5, Y
                     +0.5]. Extension of this interval to almost the nearest neighboring rate: y
                     ∈(Y
                     −1.0, Y
                     +1.0) raises efficiency values for considered activities to 94.2%, 100.0%, 92.3%, 96.2%, 94.2%, 92.3%, and 92.3%, respectively.

The results support also the idea of leaving the real-valued assessment y intact instead of truncating it. It is rather hard to require physiotherapist to differentiate and score using a real-valued scale. However, the well learned CAD system could be able to cover all balance factors by using the real-valued, uncertain assessments. Moreover, our experiments involving 52 patients have shown, that the mean error δ
                     
                        mean
                      produced by the classifier:
                        
                           (27)
                           
                              
                                 δ
                                 mean
                              
                              =
                              
                                 1
                                 
                                    
                                       N
                                       tot
                                    
                                 
                              
                              ·
                              
                                 ∑
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    
                                       N
                                       tot
                                    
                                 
                              
                              
                                 δ
                                 i
                              
                           
                        
                     is close to zero: 0.01, −0.01, −0.02, 0.00, 0.08, 0.02, and 0.05, respectively. Histograms of δ at 0.2 window width are shown in Fig. 9 (gray bars centered and focused around zero). Thus, it is likely that the assessment errors are able to compensate each other and the system can provide more reliable total score if left untruncated.

The main BBS drawbacks are: different levels of scoring variability in case of various tasks, especially in certain populations [29] and a ±8-point assessment uncertainty rule [17,18]. For the described system, poorly differentiated scores in case of some BBS tasks make the classifier training challenging. On the other hand, the entire examination reflects the balance abilities reliably and repetitively [6]. These properties along with observations made in this study might be examined during research on the entire BBS including more data with better distributed reference scoring. Thus, our future research heads towards further experimental data collection and study on current and new features influence on the balance assessment in case of all BBS tasks, and the examination as a whole. The important hypothesis to be verified is the usefulness and perhaps the advantage of the real-valued scoring of individual tasks and the CAD estimation compliance with the total BBS reference score.

The automation of balance assessment might be a useful tool for the motor condition monitoring. It requires certain measurement architecture and standardization. This paper proposes an inference system designed for a defined 5-sensor structure, dedicated for multiple AAL purposes. Since there are many propositions for motion tracking with miscellaneous sensor selections, a further research is desirable for automatic movement mechanisms detection and their relations to feature extraction from signals. For example, it is likely, that a more detailed study on particular sensors influence on the AAL system under consideration could be profitable. However, the collection of features introduced here has shown promising capabilities to provide quantitative information on observed balance level.

@&#CONCLUSION@&#

The approach for an automatic computer-aided balance assessment using inertial sensors worn by a subject is described in this paper. The study on assessment employs certain activities and scoring standards corresponding to the Berg Balance Scale test. The system introduces several different features, mainly associated with the signal medium frequency characteristics. With such an approach, some problems with the inertial sensors orientation during exercises might be ignored. A large set of features is evaluated for their suitability for specific activities assessment using multilevel Fisher's linear discriminant. Finally, the artificial neural network-based classifier yields numerical assessment in the real-valued or truncated form corresponding to the Berg scale rates.

With the experiments involving 52 patients with different balance abilities, the system is able to estimate the precise expert score with a 75–94% efficiency, depending on the task. The mean distance between the system and reference score ranges between 0.19 and 0.40 for certain tasks, yet the mean signed error tends to zero.

@&#ACKNOWLEDGEMENTS@&#

Project co-financed by the European Regional Development Fund under the Operational Programme Innovative Economy, project no. POIG.01.03.01-24-061/12.

The author wishes to thank Ewa Pietka, Monika Płoska, Piotr Zarychta, Seweryn Piwowarski, Paula Lubina, Maria J. Skotnicka, and Wojciech Wieclawek, who assisted in the data acquisition and assessment.

@&#REFERENCES@&#

