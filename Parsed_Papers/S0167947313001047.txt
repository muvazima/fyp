@&#MAIN-TITLE@&#Numerical distribution functions for seasonal unit root tests

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A generalisation of HEGY seasonal unit root tests was presented in Smith, Taylor and del Barrio Castro (2009).


                        
                        
                           
                           We use a response surface regressions approach to calculate 
                                 P
                              -values for the HEGY statistics.


                        
                        
                           
                           They can be used for any seasonal periodicity, sample size and autoregressive order.


                        
                        
                           
                           A Gretl function package is provided for applying the tests and calculating their 
                                 P
                              -values.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Seasonality

Unit roots

Response surface analysis

HEGY tests

@&#ABSTRACT@&#


               
               
                  It is often necessary to test for the presence of seasonal unit roots when working with time series data observed at intervals of less than a year. One of the most widely used methods for doing this is based on regressing the seasonal difference of the series over the transformations of the series by applying specific filters for each seasonal frequency. This provides test statistics with non-standard distributions. A generalisation of this method for any periodicity is presented and a response surface regressions approach is used to calculate the 
                        P
                     -values of the statistics whatever the periodicity and sample size of the data. The algorithms are prepared with the Gretl open source econometrics package and two empirical examples are presented.
               
            

@&#INTRODUCTION@&#

Unit roots may cause severe problems in a regression model if they are not properly dealt with: this may imply inconsistent coefficient estimators and non-standard distributions for significance tests and for forecast intervals. There have been many papers on testing for unit roots since the book by Fuller (1976), which introduced the test currently known as the Augmented Dickey–Fuller test, ADF (see also  Dickey and Fuller, 1981). Apart from the ADF test, other noteworthy tests are Phillips and Perron (1988), the KPSS test for stationarity by Kwiatkowski et al. (1992) and the ADF–GLS test by Elliott et al. (1996), all of which have become widely used by empirical economists. However, when working with time series data observed at intervals shorter than a year, the presence of unit roots should be tested for, not only in the long run but also in seasonal cycles. Over the last thirty years various methods have been proposed for testing for seasonal unit roots. For example, Hasza and Fuller (1982) and Dickey et al. (1984) propose joint tests for all seasonal unit roots, and in later papers Osborn et al. (1988) and in particular Hylleberg et al. (1990) (hereinafter HEGY) propose tests that would deal with each seasonal and zero frequency root to be considered separately. There are also interesting tests of seasonal stability by Canova and Hansen (1995), which also consider each frequency individually. The HEGY tests are not very difficult to implement and have therefore become widely used among empirical economists.

One of the problems with most of the unit root tests mentioned above is that their statistics have non-standard distributions, so in practice the values in the tables published need to be interpolated to compare them with the values calculated or simulate the empirical distributions for exactly the same model and the same sample size that is being used. MacKinnon (1994) uses simulation methods and response surface regressions to estimate the asymptotic distributions of a large number of unit roots and cointegration tests at zero frequency (long run). MacKinnon (1996) then extends these results, providing a way of approximating small sample distributions too.


                     Harvey and van Dijk (2006) apply MacKinnon’s method, using response surface regressions to provide a simple way of obtaining critical values and 
                        P
                      values for any sample size and any order of lags of the endogenous variable in the regression for the HEGY tests mentioned above. As in the original HEGY article, all this is for quarterly data.

In the 21st century it seems quite anachronistic to have to use statistical tables. Empirical economists normally use computers for calculations, so ideally they should have a computer algorithm to calculate 
                        P
                     -values instead of having to look at statistical tables. The main objective of this paper is to obtain a generalisation of the method by Harvey and van Dijk for calculating the 
                        P
                      values of the HEGY statistics whatever the seasonal periodicity, 
                        S
                     , and sample size 
                        T
                      of the data. Seasonal periodicity 
                        S
                      is defined as the number of values of the series observed in each year (it is sometimes convenient to change the reference period from one year, for example, to one day if data are hourly, 
                        S
                        =
                        24
                     , or one week if data are daily, 
                        S
                        =
                        7
                     , but for ease of exposition I will continue to refer to the reference period as the ‘year’).

For this approach to be practical it needs to be possible to implement it in a computer algorithm. As a complement to this paper an algorithm prepared in Gretl is provided (see http://gretl.sourceforge.net). Gretl is a cross-platform software package for econometric analysis. It is open source, free software: anyone may redistribute it and/or modify it under the terms of the GNU General Public License (GPL). This makes Gretl a very good econometric package in terms of the replicability of its calculations and results (Baiocchi, 2007).

The study of seasonality requires the use of some concepts of spectral or frequency-domain analysis. The fundamental goal of such analysis is to determine how important cycles of different frequencies are in accounting for the behaviour of the series [For a thorough introduction to frequency-domain analysis see, for example, Chapter 6 of Harvey (1993) or the equivalent chapter in Hamilton (1994)].

The period, 
                        T
                     , is defined as the time taken to complete one cycle. The angular frequency, 
                        ω
                        =
                        2
                        π
                        /
                        T
                     , measures the frequency of the cycle in radians per unit of time. For a series with 
                        T
                      observations, if 
                        T
                      is even a total of 
                        T
                        /
                        2
                      complete cycles may be observed, with their periods being 
                        T
                        /
                        j
                      with 
                        j
                      being an integer and 
                        j
                        =
                        1
                        ,
                        2
                        ,
                        …
                        ,
                        T
                        /
                        2
                     . If 
                        T
                      is odd, 
                        T
                        /
                        2
                      is not an integer, and only 
                        
                           (
                           T
                           −
                           1
                           )
                        
                        /
                        2
                      complete cycles may be observed, with their periods being 
                        T
                        /
                        j
                      with 
                        j
                        =
                        1
                        ,
                        2
                        ,
                        …
                        ,
                        
                           (
                           T
                           −
                           1
                           )
                        
                        /
                        2
                     . Those of these cycles that can be observed within a year are called seasonal cycles. Series whose values are observed 
                        S
                      times a year may, if 
                        S
                      is even, show up to 
                        S
                        /
                        2
                      complete seasonal cycles every year, with periods 
                        S
                        /
                        j
                      with 
                        j
                      being an integer and 
                        j
                        =
                        1
                        ,
                        2
                        ,
                        …
                        ,
                        S
                        /
                        2
                     . If 
                        S
                      is odd, only 
                        
                           (
                           S
                           −
                           1
                           )
                        
                        /
                        2
                      cycles may be observed within a year and their periods are 
                        S
                        /
                        j
                      with 
                        j
                        =
                        1
                        ,
                        2
                        ,
                        …
                        ,
                        
                           (
                           S
                           −
                           1
                           )
                        
                        /
                        2
                     . For example if 
                        S
                        =
                        4
                      the seasonal cycles have periods 4 and 2, which correspond respectively to cycles observed once and twice a year; if 
                        S
                        =
                        5
                      two seasonal cycles are also observed, one with period 5 and the other with period 
                        2.5
                     . In summary, a time series in which observations are regularly collected 
                        S
                      times a year can contain 
                        
                           ⌊
                           S
                           /
                           2
                           ⌋
                        
                      different seasonal cycles, with 
                        
                           ⌊
                           ⋅
                           ⌋
                        
                      denoting the integer part of the number contained in brackets, i.e.  
                        
                           
                              
                                 ⌊
                                 S
                                 /
                                 2
                                 ⌋
                              
                              =
                              
                                 {
                                 
                                    
                                       
                                          S
                                          /
                                          2
                                       
                                       
                                          if  
                                          S
                                            is even  
                                       
                                    
                                    
                                       
                                          
                                             (
                                             S
                                             −
                                             1
                                             )
                                          
                                          /
                                          2
                                       
                                       
                                          if  
                                          S
                                            is odd
                                       
                                    
                                 
                              
                           
                        
                      and the angular frequencies corresponding to the seasonal cycles are 
                        
                           
                              ω
                           
                           
                              j
                           
                        
                        =
                        
                           
                              2
                              π
                              j
                           
                           
                              S
                           
                        
                     , with 
                        j
                        =
                        1
                        ,
                        …
                        ,
                        
                           ⌊
                           S
                           /
                           2
                           ⌋
                        
                     .

If a series is generated by an autoregressive (AR) process such as 
                        
                           (1)
                           
                              ϕ
                              
                                 (
                                 L
                                 )
                              
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                              
                              =
                              
                                 
                                    ε
                                 
                                 
                                    t
                                 
                              
                           
                        
                      where 
                        L
                      is the lag operator, such that 
                        L
                        
                           
                              x
                           
                           
                              t
                           
                        
                        =
                        
                           
                              x
                           
                           
                              t
                              −
                              1
                           
                        
                        ,
                        ϕ
                        
                           (
                           L
                           )
                        
                      represents the polynomial 
                        1
                        −
                        
                           
                              ϕ
                           
                           
                              1
                           
                        
                        L
                        −
                        
                           
                              ϕ
                           
                           
                              2
                           
                        
                        
                           
                              L
                           
                           
                              2
                           
                        
                        −
                        ⋯
                      and 
                        
                           
                              ε
                           
                           
                              t
                           
                        
                      is a white noise process with variance 
                        
                           
                              σ
                           
                           
                              ε
                           
                           
                              2
                           
                        
                     , the cycles in 
                        
                           
                              x
                           
                           
                              t
                           
                        
                      are associated with the roots of the polynomial equation 
                        ϕ
                        
                           (
                           z
                           )
                        
                        =
                        0
                     , where 
                        z
                      is a number in the complex plane, i.e.  
                        z
                        =
                        a
                        +
                        b
                        ⋅
                        i
                      with 
                        a
                        ,
                        b
                        ∈
                        R
                      and 
                        i
                        =
                        
                           
                              −
                              1
                           
                        
                     . Each root implies a cycle. The real and imaginary parts of the roots determine the period and the frequency of the cycle. The angular frequency of a cycle is related to the roots of the AR polynomial by 
                        ω
                        =
                        arctan
                        
                           (
                           b
                           /
                           a
                           )
                        
                     . If 
                        z
                        >
                        0
                      and real 
                        
                           (
                           b
                           =
                           0
                           )
                        
                      the root is on the horizontal right axis of the complex plane, 
                        ω
                        =
                        0
                     , and the period is infinite. This root corresponds to the long run (or trend) of the series. If 
                        z
                        <
                        0
                      and real, the root is on the left side of the horizontal axis, 
                        ω
                        =
                        π
                      (called the Nyquist frequency) and the period is 2. All the complex solutions (with 
                        b
                        ≠
                        0
                     ) of 
                        ϕ
                        
                           (
                           z
                           )
                        
                        =
                        0
                      have conjugate solutions associated with them. In this case, the problem of aliasing arises (See  Hamilton, 1994, pp. 160–161, for a detailed description of this problem). Basically the problem is this: based on a sample of 
                        T
                      observations it is impossible to distinguish between the cycle associated with the root 
                        z
                        =
                        a
                        +
                        b
                        ⋅
                        i
                     , with frequency 
                        ω
                     , and the cycle associated with its complex conjugate root 
                        z
                        =
                        a
                        −
                        b
                        ⋅
                        i
                     , with frequency 
                        −
                        ω
                     . The only possible way of working with them is therefore to treat them jointly.


                     Hylleberg et al. (1990) study how to test for unit roots in seasonal time series. They take quarterly periodicity of data 
                        
                           (
                           S
                           =
                           4
                           )
                        
                      as their reference and assume that the series 
                        
                           
                              x
                           
                           
                              t
                           
                        
                      is generated by a possibly infinite order autoregressive process, as in Eq. (1). To test the hypothesis that the roots of 
                        ϕ
                        
                           (
                           z
                           )
                        
                        =
                        0
                      are on the unit circle against the alternative hypothesis that they are outside the unit circle they set up the following procedure. They show that Eq. (1) can be written in an equivalent form as 
                        
                           (2)
                           
                              
                                 
                                    ϕ
                                 
                                 
                                    ∗
                                 
                              
                              
                                 (
                                 L
                                 )
                              
                              
                                 
                                    y
                                 
                                 
                                    4
                                    t
                                 
                              
                              =
                              
                                 
                                    π
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    y
                                 
                                 
                                    1
                                    t
                                    −
                                    1
                                 
                              
                              +
                              
                                 
                                    π
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    y
                                 
                                 
                                    2
                                    t
                                    −
                                    1
                                 
                              
                              +
                              
                                 
                                    π
                                 
                                 
                                    3
                                 
                              
                              
                                 
                                    y
                                 
                                 
                                    3
                                    t
                                    −
                                    2
                                 
                              
                              +
                              
                                 
                                    π
                                 
                                 
                                    4
                                 
                              
                              
                                 
                                    y
                                 
                                 
                                    3
                                    t
                                    −
                                    1
                                 
                              
                              +
                              
                                 
                                    ε
                                 
                                 
                                    t
                                 
                              
                           
                        
                      where 
                        
                           
                              
                                 
                                    
                                       y
                                    
                                    
                                       1
                                       t
                                    
                                 
                                 =
                                 
                                    (
                                    1
                                    +
                                    L
                                    +
                                    
                                       
                                          L
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          L
                                       
                                       
                                          3
                                       
                                    
                                    )
                                 
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    
                                       y
                                    
                                    
                                       2
                                       t
                                    
                                 
                                 =
                                 −
                                 
                                    (
                                    1
                                    −
                                    L
                                    +
                                    
                                       
                                          L
                                       
                                       
                                          2
                                       
                                    
                                    −
                                    
                                       
                                          L
                                       
                                       
                                          3
                                       
                                    
                                    )
                                 
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    
                                       y
                                    
                                    
                                       3
                                       t
                                    
                                 
                                 =
                                 −
                                 
                                    (
                                    1
                                    −
                                    
                                       
                                          L
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    
                                       y
                                    
                                    
                                       4
                                       t
                                    
                                 
                                 =
                                 
                                    (
                                    1
                                    −
                                    
                                       
                                          L
                                       
                                       
                                          4
                                       
                                    
                                    )
                                 
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       Δ
                                    
                                    
                                       4
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                 
                              
                           
                        
                      and 
                        
                           
                              ϕ
                           
                           
                              ∗
                           
                        
                        
                           (
                           L
                           )
                        
                      is a polynomial with all the roots outside the unit circle. Eq. (2) can be estimated consistently by ordinary least squares (OLS).

Testing the hypothesis of a unit root, 
                        z
                        =
                        1
                     , at zero frequency is equivalent to testing the significance of the coefficient 
                        
                           
                              π
                           
                           
                              1
                           
                        
                     , which can be done by using a 
                        t
                      statistic. However, this statistic does not follow a Student’s 
                        t
                     -distribution. Hylleberg et al. (1990) show that the asymptotic distribution of this 
                        
                           
                              t
                           
                           
                              
                                 
                                    π
                                 
                                 
                                    1
                                 
                              
                           
                        
                      statistic is the same as that of the Dickey–Fuller statistic.

The existence of a unit root, 
                        z
                        =
                        −
                        1
                     , at frequency 
                        ω
                        =
                        π
                      can be checked for by a significance test on the coefficient 
                        
                           
                              π
                           
                           
                              2
                           
                        
                     , also using a 
                        t
                     -statistic. The presence of the complex conjugate (alias) unit roots 
                        z
                        =
                        ±
                        i
                      at frequencies 
                        ω
                        =
                        ±
                        π
                        /
                        2
                      can be tested for by an F-statistic for the joint hypothesis that 
                        
                           
                              π
                           
                           
                              3
                           
                        
                        =
                        
                           
                              π
                           
                           
                              4
                           
                        
                        =
                        0
                     .


                     Beaulieu and Miron (1993) (and in a slightly different way  Franses, 1990) study the problem of testing for seasonal unit roots with monthly data. They show that an equation with a similar structure to that of HEGY could also be proposed for this case. In the quarterly case there are two seasonal cycles at frequencies 
                        ±
                        π
                        /
                        2
                      and 
                        π
                     , but in the monthly case there are six seasonal cycles at frequencies 
                        ±
                        π
                        /
                        6
                        ,
                        ±
                        π
                        /
                        3
                        ,
                        ±
                        π
                        /
                        2
                        ,
                        ±
                        2
                        π
                        /
                        3
                        ,
                        ±
                        5
                        π
                        /
                        6
                     , and 
                        π
                      which, as Beaulieu and Miron show, makes the structure of the equation a little more complicated, as it depends on 12 filters instead of only 4 (See Eqs. (4) and 5 in  Beaulieu and Miron, 1993). There is also a version of Eq. (2) for weekly data (with 
                        S
                        =
                        52
                     ) in Cáceres (1996), which depends on 52 seasonal filters.

To test for seasonal unit roots in an applied study with quarterly data, the aforementioned procedure by Harvey and van Dijk for calculating critical values or 
                        P
                     -values for the tests can be used. If the data are monthly or weekly the tables of critical values in the articles by Beaulieu and Miron or Cáceres mentioned above can be used. An interpolation method is needed to calculate the critical values and there is no method for obtaining 
                        P
                     -values. When working with daily data (
                        S
                        =
                        5
                        ,
                        6
                      or 7 days a week), hourly data (
                        S
                        =
                        24
                        
                        
                           h
                        
                      a day), etc., there are not even any tables to compare with. As stated above, the main goal of this paper is to solve this problem.

The first step towards obtaining a general solution to the problem is to show a generalisation of Eq. (2) for any seasonal periodicity 
                        S
                     . Such a generalisation, presented in Smith et al. (2009), is used in the next section.

Let 
                        
                           
                              y
                           
                           
                              t
                           
                        
                      be a time series observed 
                        S
                      times a year integrated of order one at frequencies 
                        
                           
                              ω
                           
                           
                              j
                           
                        
                        ≡
                        2
                        π
                        j
                        /
                        S
                        ,
                        j
                        =
                        0
                        ,
                        …
                        ,
                        
                           ⌊
                           S
                           /
                           2
                           ⌋
                        
                     , and let its autoregressive representation be 
                        
                           (3)
                           
                              ϕ
                              
                                 (
                                 L
                                 )
                              
                              
                              
                                 
                                    y
                                 
                                 
                                    t
                                 
                              
                              =
                              
                                 
                                    γ
                                 
                                 
                                    ′
                                 
                              
                              
                                 
                                    D
                                 
                                 
                                    t
                                 
                              
                              +
                              
                                 
                                    u
                                 
                                 
                                    t
                                 
                              
                           
                        
                      where 
                        ϕ
                        
                           (
                           L
                           )
                        
                      is a polynomial on the lag operator, 
                        
                           
                              D
                           
                           
                              t
                           
                        
                      is a column vector with deterministic terms, 
                        γ
                      is its associated coefficients vector and 
                        
                           
                              u
                           
                           
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              u
                           
                           
                              T
                           
                        
                      are 
                        i
                        i
                        d
                        
                           (
                           0
                           ,
                           
                              
                                 σ
                              
                              
                                 u
                              
                              
                                 2
                              
                           
                           )
                        
                     .

Now define 
                        
                           
                              Δ
                           
                           
                              s
                           
                        
                        =
                        1
                        −
                        
                           
                              L
                           
                           
                              S
                           
                        
                      as the polynomial of order 
                        S
                      made up of (single) unit roots at frequencies 
                        
                           
                              ω
                           
                           
                              j
                           
                        
                        ,
                        j
                        =
                        0
                        ,
                        …
                        ,
                        
                           ⌊
                           S
                           /
                           2
                           ⌋
                        
                      [remember that there are two unit roots per 
                        
                           
                              ω
                           
                           
                              j
                           
                        
                        ∈
                        
                           (
                           0
                           ,
                           π
                           )
                        
                      but only one per 
                        
                           
                              ω
                           
                           
                              j
                           
                        
                        =
                        0
                        ,
                        π
                     ]. The roots at frequencies 0 and 
                        π
                      are real, but the rest have complex-conjugate values. Define 
                        
                           
                              S
                           
                           
                              ∗
                           
                        
                      as 
                        
                           (
                           S
                           /
                           2
                           )
                        
                        −
                        1
                      (if 
                        S
                      is even) and 
                        
                           ⌊
                           S
                           /
                           2
                           ⌋
                        
                      (if 
                        S
                      is odd).

Model (3) may be expressed as follows (See Eq. (4.1) in  Smith et al., 2009): 
                        
                           (4)
                           
                              
                                 
                                    ϕ
                                 
                                 
                                    ∗
                                 
                              
                              
                                 (
                                 L
                                 )
                              
                              
                                 
                                    Δ
                                 
                                 
                                    S
                                 
                              
                              
                                 
                                    y
                                 
                                 
                                    t
                                 
                              
                              =
                              
                                 
                                    γ
                                 
                                 
                                    ′
                                 
                              
                              
                                 
                                    D
                                 
                                 
                                    t
                                 
                              
                              +
                              
                                 
                                    π
                                 
                                 
                                    0
                                 
                              
                              
                                 
                                    y
                                 
                                 
                                    0
                                    ,
                                    t
                                    −
                                    1
                                 
                              
                              +
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    
                                       
                                          S
                                       
                                       
                                          ∗
                                       
                                    
                                 
                              
                              
                                 (
                                 
                                    
                                       π
                                    
                                    
                                       j
                                       ,
                                       a
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       j
                                       ,
                                       t
                                       −
                                       1
                                    
                                    
                                       a
                                    
                                 
                                 +
                                 
                                    
                                       π
                                    
                                    
                                       j
                                       ,
                                       b
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       j
                                       ,
                                       t
                                       −
                                       1
                                    
                                    
                                       b
                                    
                                 
                                 )
                              
                              +
                              
                                 
                                    π
                                 
                                 
                                    S
                                    /
                                    2
                                 
                              
                              
                                 
                                    y
                                 
                                 
                                    S
                                    /
                                    2
                                    ,
                                    t
                                    −
                                    1
                                 
                              
                              +
                              
                                 
                                    u
                                 
                                 
                                    t
                                 
                              
                           
                        
                      dropping the term 
                        
                           
                              π
                           
                           
                              S
                              /
                              2
                           
                        
                        
                           
                              y
                           
                           
                              S
                              /
                              2
                              ,
                              t
                              −
                              1
                           
                        
                      if 
                        S
                      is odd, 
                        t
                        =
                        1
                        ,
                        2
                        ,
                        …
                     , with the transformed level variables 
                        
                           
                              y
                           
                           
                              0
                              ,
                              t
                           
                        
                        ,
                        
                           
                              y
                           
                           
                              j
                              ,
                              t
                           
                           
                              a
                           
                        
                        ,
                        
                           
                              y
                           
                           
                              j
                              ,
                              t
                           
                           
                              b
                           
                        
                      and 
                        
                           
                              y
                           
                           
                              S
                              /
                              2
                              ,
                              t
                           
                        
                        
                        j
                        =
                        1
                        ,
                        …
                        ,
                        
                           
                              S
                           
                           
                              ∗
                           
                        
                      defined by 
                        
                           
                              
                                 
                                    
                                       y
                                    
                                    
                                       0
                                       ,
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       S
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       t
                                       −
                                       i
                                    
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    
                                       y
                                    
                                    
                                       j
                                       ,
                                       t
                                    
                                    
                                       a
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       S
                                       −
                                       1
                                    
                                 
                                 cos
                                 
                                    [
                                    
                                       (
                                       i
                                       +
                                       1
                                       )
                                    
                                    
                                       
                                          ω
                                       
                                       
                                          j
                                       
                                    
                                    ]
                                 
                                 
                                    
                                       y
                                    
                                    
                                       t
                                       −
                                       i
                                    
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    
                                       y
                                    
                                    
                                       j
                                       ,
                                       t
                                    
                                    
                                       b
                                    
                                 
                                 =
                                 −
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       S
                                       −
                                       1
                                    
                                 
                                 sin
                                 
                                    [
                                    
                                       (
                                       i
                                       +
                                       1
                                       )
                                    
                                    
                                       
                                          ω
                                       
                                       
                                          j
                                       
                                    
                                    ]
                                 
                                 
                                    
                                       y
                                    
                                    
                                       t
                                       −
                                       i
                                    
                                 
                              
                           
                        
                      and 
                        
                           
                              
                                 
                                    y
                                 
                                 
                                    S
                                    /
                                    2
                                    ,
                                    t
                                 
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    0
                                 
                                 
                                    S
                                    −
                                    1
                                 
                              
                              cos
                              
                                 [
                                 
                                    (
                                    i
                                    +
                                    1
                                    )
                                 
                                 π
                                 ]
                              
                              
                                 
                                    y
                                 
                                 
                                    t
                                    −
                                    i
                                 
                              
                              .
                           
                        
                     
                  

In practice, using data for a given sample size 
                        T
                        ,
                        
                           
                              ϕ
                           
                           
                              ∗
                           
                        
                        
                           (
                           L
                           )
                        
                      is approximated by a finite order 
                        p
                      polynomial, so that model (4) may be written as 
                        
                           (5)
                           
                              
                                 
                                    Δ
                                 
                                 
                                    S
                                 
                              
                              
                                 
                                    y
                                 
                                 
                                    t
                                 
                              
                              =
                              
                                 
                                    γ
                                 
                                 
                                    ′
                                 
                              
                              
                                 
                                    D
                                 
                                 
                                    t
                                 
                              
                              +
                              
                                 
                                    π
                                 
                                 
                                    0
                                 
                              
                              
                                 
                                    y
                                 
                                 
                                    0
                                    ,
                                    t
                                    −
                                    1
                                 
                              
                              +
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    
                                       
                                          S
                                       
                                       
                                          ∗
                                       
                                    
                                 
                              
                              
                                 (
                                 
                                    
                                       π
                                    
                                    
                                       j
                                       ,
                                       a
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       j
                                       ,
                                       t
                                       −
                                       1
                                    
                                    
                                       a
                                    
                                 
                                 +
                                 
                                    
                                       π
                                    
                                    
                                       j
                                       ,
                                       b
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       j
                                       ,
                                       t
                                       −
                                       1
                                    
                                    
                                       b
                                    
                                 
                                 )
                              
                              +
                              
                                 
                                    π
                                 
                                 
                                    S
                                    /
                                    2
                                 
                              
                              
                                 
                                    y
                                 
                                 
                                    S
                                    /
                                    2
                                    ,
                                    t
                                    −
                                    1
                                 
                              
                              +
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    p
                                 
                              
                              
                                 
                                    ϕ
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    Δ
                                 
                                 
                                    S
                                 
                              
                              
                                 
                                    y
                                 
                                 
                                    t
                                    −
                                    i
                                 
                              
                              +
                              
                                 
                                    u
                                 
                                 
                                    t
                                 
                              
                           
                        
                      with the term 
                        
                           
                              π
                           
                           
                              S
                              /
                              2
                           
                        
                        
                           
                              y
                           
                           
                              S
                              /
                              2
                              ,
                              t
                              −
                              1
                           
                        
                      being dropped if 
                        S
                      is odd. Filters 
                        
                           
                              y
                           
                           
                              j
                              ,
                              t
                           
                           
                              a
                           
                        
                      and 
                        
                           
                              y
                           
                           
                              j
                              ,
                              t
                           
                           
                              b
                           
                        
                      in the quarterly case reflect the same transformations as in the HEGY paper, in the monthly case they are the same as those of Beaulieu and Miron.

To test for unit roots, (5) is estimated by OLS and then the significance of the coefficients is tested using appropriate finite sample distributions based on Monte Carlo results. 
                        
                           
                              π
                           
                           
                              0
                           
                        
                        =
                        0
                      implies that the series contains a unit root at the zero frequency. When 
                        S
                      is even and 
                        
                           
                              π
                           
                           
                              S
                              /
                              2
                           
                        
                        =
                        0
                     , there is a seasonal unit root at frequency 
                        π
                      (two observations per cycle). When 
                        
                           
                              π
                           
                           
                              j
                              ,
                              a
                           
                        
                        =
                        
                           
                              π
                           
                           
                              j
                              ,
                              b
                           
                        
                        =
                        0
                     , seasonal unit roots are present at frequency 
                        
                           
                              ω
                           
                           
                              j
                           
                        
                        =
                        
                           
                              2
                              π
                              j
                           
                           
                              S
                           
                        
                     . For frequencies 0 and 
                        π
                      it suffices to examine the relevant 
                        t
                     -statistics for 
                        
                           
                              π
                           
                           
                              0
                           
                        
                        =
                        0
                      and 
                        
                           
                              π
                           
                           
                              S
                              /
                              2
                           
                        
                        =
                        0
                      against the alternatives that 
                        
                           
                              π
                           
                           
                              0
                           
                        
                        <
                        0
                      and 
                        
                           
                              π
                           
                           
                              S
                              /
                              2
                           
                        
                        <
                        0
                      respectively. For other frequencies, the strategy is to test 
                        
                           
                              π
                           
                           
                              j
                           
                           
                              a
                           
                        
                        =
                        
                           
                              π
                           
                           
                              j
                           
                           
                              b
                           
                        
                        =
                        0
                     . This may be done by means of two 
                        t
                     -statistics, but an 
                        F
                     -statistic for this hypothesis, referred to here as 
                        
                           
                              F
                           
                           
                              j
                           
                           
                              a
                              b
                           
                        
                     , proves to be more powerful.

By means of Itô calculus, Phillips (1987) shows that 
                        
                           
                              t
                           
                           
                              
                                 
                                    π
                                 
                                 
                                    0
                                 
                              
                           
                        
                      and 
                        
                           
                              t
                           
                           
                              
                                 
                                    π
                                 
                                 
                                    S
                                    /
                                    2
                                 
                              
                           
                        
                      asymptotically have the Dickey–Fuller distribution. Ahtola and Tiao (1987) and Chan and Wei (1988) note that the asymptotic distributions of 
                        t
                      statistics for the 
                        
                           
                              π
                           
                           
                              j
                           
                           
                              a
                           
                        
                      coefficients are the same across frequencies. Beaulieu and Miron show, using their Lemma 1, that the 
                        t
                      statistics for the 
                        
                           
                              π
                           
                           
                              j
                           
                           
                              b
                           
                        
                      coefficients also have the same asymptotic distribution and that the 
                        
                           
                              F
                           
                           
                              j
                           
                           
                              a
                              b
                           
                        
                      statistics, for 
                        j
                        =
                        1
                        ,
                        …
                        ,
                        
                           
                              S
                           
                           
                              ∗
                           
                        
                      converge in law to 
                        
                           
                              1
                           
                           
                              2
                           
                        
                        
                           (
                           
                              
                                 t
                              
                              
                                 
                                    
                                       π
                                    
                                    
                                       j
                                    
                                    
                                       a
                                    
                                 
                              
                              
                                 2
                              
                           
                           +
                           
                              
                                 t
                              
                              
                                 
                                    
                                       π
                                    
                                    
                                       j
                                    
                                    
                                       b
                                    
                                 
                              
                              
                                 2
                              
                           
                           )
                        
                     . Because all the 
                        
                           
                              t
                           
                           
                              
                                 
                                    π
                                 
                                 
                                    j
                                 
                                 
                                    a
                                 
                              
                           
                        
                     -statistics have the same distribution and all the 
                        
                           
                              t
                           
                           
                              
                                 
                                    π
                                 
                                 
                                    j
                                 
                                 
                                    b
                                 
                              
                           
                        
                     -statistics have the same distribution, all the 
                        
                           
                              F
                           
                           
                              j
                           
                           
                              a
                              b
                           
                        
                      statistics, for 
                        j
                        =
                        1
                        ,
                        …
                        ,
                        
                           
                              S
                           
                           
                              ∗
                           
                        
                     , have the same asymptotic distribution. An analysis of the proof in Chan and Wei (1988) and Lemmas 1–4 in the aforesaid article by Beaulieu and Miron reveal that this asymptotic distribution does not depend on 
                        S
                     , the periodicity of the data. This is the key feature of Eq. (5), which enables a general method for calculating 
                        P
                     -values or critical values to be set up that is valid for any periodicity. However, different periodicities imply different numbers of regressors in this equation so a movement should be expected in the finite sample distributions of the 
                        t
                      and 
                        F
                      statistics depending on the periodicity 
                        S
                     .

Along with the 
                        
                           
                              t
                           
                           
                              
                                 
                                    π
                                 
                                 
                                    0
                                 
                              
                           
                        
                        ,
                        
                           
                              t
                           
                           
                              
                                 
                                    π
                                 
                                 
                                    S
                                    /
                                    2
                                 
                              
                           
                        
                      and 
                        
                           
                              F
                           
                           
                              j
                           
                           
                              a
                              b
                           
                        
                      statistics already explained, the following sections also study the distribution of the 
                        F
                     -statistic for the joint hypothesis 
                        
                           
                              π
                           
                           
                              1
                           
                           
                              a
                           
                        
                        =
                        
                           
                              π
                           
                           
                              1
                           
                           
                              b
                           
                        
                        =
                        ⋯
                        =
                        
                           
                              π
                           
                           
                              
                                 
                                    S
                                 
                                 
                                    ∗
                                 
                              
                           
                           
                              a
                           
                        
                        =
                        
                           
                              π
                           
                           
                              
                                 
                                    S
                                 
                                 
                                    ∗
                                 
                              
                           
                           
                              b
                           
                        
                        =
                        
                           
                              π
                           
                           
                              S
                              /
                              2
                           
                        
                        =
                        0
                      (all the seasonal roots have modulus one), which is denoted by 
                        
                           
                              F
                           
                           
                              S
                           
                        
                     , and the 
                        F
                     -statistic for the joint hypothesis 
                        
                           
                              π
                           
                           
                              0
                           
                        
                        =
                        
                           
                              π
                           
                           
                              1
                           
                           
                              a
                           
                        
                        =
                        
                           
                              π
                           
                           
                              1
                           
                           
                              b
                           
                        
                        =
                        ⋯
                        =
                        
                           
                              π
                           
                           
                              
                                 
                                    S
                                 
                                 
                                    ∗
                                 
                              
                           
                           
                              a
                           
                        
                        =
                        
                           
                              π
                           
                           
                              
                                 
                                    S
                                 
                                 
                                    ∗
                                 
                              
                           
                           
                              b
                           
                        
                        =
                        
                           
                              π
                           
                           
                              S
                              /
                              2
                           
                        
                        =
                        0
                      (all the seasonal and the frequency zero roots have modulus one), which is denoted by  
                        
                           
                              F
                           
                           
                              C
                           
                        
                     .

Even for seasonal periodicities for which tables of the HEGY tests are available, and even though the asymptotic theory of those tests is well developed, it is not easy for applied researchers to calculate the 
                        P
                     -value of a given test statistic. Here a generalisation of Harvey and Van Dijk’s procedure is presented which is based on response surface regressions, which serve to obtain 
                        P
                     -values not only for quarterly data but for any seasonal periodicity.

The first step in implementing the response surface regressions is to estimate the relevant quantiles of the distributions of the HEGY tests for several combinations of T (effective sample size), 
                        p
                      and 
                        S
                      from a large set of Monte Carlo simulations. Following MacKinnon (2002), the process is then repeated 
                        M
                        =
                        50
                      times for each value of 
                        T
                      to obtain more accurate results. These Monte Carlo simulations were carried out here in two stages. In the first stage the value of the autoregressive order, 
                        p
                     , was considered as fixed, and in the second stage the value of 
                        p
                      was determined empirically using information criteria. In particular, the Akaike information criterion (AIC), the Bayes information criterion (BIC) and the Hannan–Quinn criterion (HQC). In both stages, each experiment consisted of 
                        N
                        =
                        100
                        
                        000
                      replications, where the series 
                        
                           
                              y
                           
                           
                              t
                           
                        
                      was generated by the data generation process 
                        
                           
                              Δ
                           
                           
                              S
                           
                        
                        
                           
                              y
                           
                           
                              t
                           
                        
                        =
                        
                           
                              u
                           
                           
                              t
                           
                        
                      with 
                        
                           
                              u
                           
                           
                              t
                           
                        
                        ∼
                        n
                        i
                        d
                        
                           (
                           0
                           ,
                           1
                           )
                        
                      and the equation estimated was  (5).

The distributional properties of the HEGY statistics depend on four ‘design parameters’: the estimation sample size 
                           
                              (
                              T
                              )
                           
                        , the number of autoregressive lags included in the model 
                           
                              (
                              p
                              )
                           
                        , the seasonal periodicity 
                           
                              (
                              S
                              )
                           
                         and the deterministic components in 
                           
                              
                                 D
                              
                              
                                 t
                              
                           
                        . To provide well fitted results for a wide range of situations common in empirical investigations, the simulations for the first stage, where 
                           p
                         is considered as fixed, span a full factorial design of the following 
                           T
                           ,
                           p
                           ,
                           S
                         and 
                           
                              
                                 D
                              
                              
                                 t
                              
                           
                        : 
                           
                              
                                 
                                    T
                                 :
                              48,52,64,76,100,124,152,200,300,400,500,780


                                 
                                    0
                                    ,
                                    1
                                    ,
                                    2
                                    ,
                                    …
                                    ,
                                    S
                                  (with maximum 12)

4,5,6,7,12,24,52


                                 
                                    
                                       (a)
                                       constant term;

constant term, 
                                             t
                                          ;

constant term, 
                                             S
                                             −
                                             1
                                           seas. dummies;

constant term, 
                                             S
                                             −
                                             1
                                           seas. dummies, 
                                             t
                                          .

The range of the sample size is intended to provide information on both the test statistic’s asymptotic properties and the deviations of the finite sample therefrom. For each value of 
                           S
                         the estimation in the longest version of (5) uses 
                           2
                           S
                           +
                           p
                           +
                           1
                         degrees of freedom so when 
                           S
                           >
                           12
                         a minimum sample size of 
                           2
                           S
                           +
                           12
                         is needed. This implies that the first valid sample size for 
                           S
                           =
                           24
                         is 
                           T
                           =
                           64
                         and for 
                           S
                           =
                           52
                         is 
                           T
                           =
                           124
                        . For each 
                           S
                           ≤
                           12
                         the design includes all integer values of 
                           p
                         from zero up to 
                           S
                        ; for 
                           S
                           >
                           12
                         high values of 
                           p
                         imply significant computation costs, so 
                           p
                         is limited to 12, which is deemed sufficient for most empirical applications. The values for 
                           S
                         include the most widely used periodicities in time series applications: 4 (quarterly data), 5 and 7 (two types of daily data), 12 (monthly data), 24 (hourly data), 52 (weekly data), and 
                           S
                           =
                           6
                         which is not so widely used but for which results are obtained very quickly in computational terms. The choice of the deterministic term 
                           
                              
                                 D
                              
                              
                                 t
                              
                           
                         implies four cases for each test statistic which are required for adequate model specification, i.e. because the deterministic terms are in the DGP.

Although full factorial design was used at this stage, the use of optimal methods for response surface design could improve computational efficiency and/or the precision of the estimates for some specific values of 
                           T
                           ,
                           p
                         or 
                           S
                         (see for example Kleijnen, 1987, Part II.a, Conlisk, 1974 or for more recent developments Hertel and Kohler, 2013).

In practice, it is rare to be able to specify the value of 
                           p
                         beforehand. Analysts must typically use an empirical method to determine it. The method may include observing the graph of the series, the partial autocorrelation function, using significance tests or using information criteria such as AIC, BIC, and HQC. Information criteria have been proven to have good properties in selecting the order of an autoregression (see for example  Tsay, 1984). To account for this and to provide 
                           P
                        -values that may be useful in some of these empirical contexts, in the second stage we proceed in a way similar to Harvey and van Dijk (2006). For each replication, we determine the appropriate lag order in (5) using the AIC, BIC or HQC by varying 
                           p
                         between 
                           
                              
                                 p
                              
                              
                                 
                                    min
                                 
                              
                           
                           =
                           0
                         and 
                           
                              
                                 p
                              
                              
                                 
                                    max
                                 
                              
                           
                         and selecting the value of 
                           p
                         that minimises the criterion chosen.

There are various definitions of information criteria in the context of autoregressive models. Following Ng and Perron (2005) the version used here is 
                           
                              (6)
                              
                                 I
                                 C
                                 
                                    (
                                    p
                                    )
                                 
                                 =
                                 ln
                                 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       p
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       K
                                    
                                    
                                       p
                                    
                                 
                                 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             T
                                             −
                                             
                                                
                                                   K
                                                
                                                
                                                   
                                                      max
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       T
                                       −
                                       
                                          
                                             K
                                          
                                          
                                             
                                                max
                                             
                                          
                                       
                                    
                                 
                              
                           
                         where 
                           
                              
                                 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       p
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       
                                          (
                                          T
                                          −
                                          
                                             
                                                K
                                             
                                             
                                                
                                                   max
                                                
                                             
                                          
                                          )
                                       
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             K
                                          
                                          
                                             
                                                max
                                             
                                          
                                       
                                       +
                                       1
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       
                                          
                                             e
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       t
                                    
                                    
                                       2
                                    
                                 
                                 ,
                              
                           
                         is an estimate of the regression error variance for the model with 
                           p
                         lags, 
                           
                              
                                 K
                              
                              
                                 p
                              
                           
                         is the number of regressors in that model and, with 
                           n
                           d
                           e
                           t
                         being the number of deterministic components, 
                           
                              
                                 K
                              
                              
                                 
                                    max
                                 
                              
                           
                           =
                           n
                           d
                           e
                           t
                           +
                           S
                           +
                           
                              
                                 p
                              
                              
                                 
                                    max
                                 
                              
                           
                         is the maximum number of regressors. Using 
                           
                              
                                 C
                              
                              
                                 T
                                 −
                                 
                                    
                                       K
                                    
                                    
                                       
                                          max
                                       
                                    
                                 
                              
                           
                           =
                           2
                         in (6) for the AIC, 
                           
                              
                                 C
                              
                              
                                 T
                                 −
                                 
                                    
                                       K
                                    
                                    
                                       
                                          max
                                       
                                    
                                 
                              
                           
                           =
                           ln
                           
                              (
                              T
                              −
                              
                                 
                                    K
                                 
                                 
                                    
                                       max
                                    
                                 
                              
                              )
                           
                         for the BIC and 
                           
                              
                                 C
                              
                              
                                 T
                                 −
                                 
                                    
                                       K
                                    
                                    
                                       
                                          max
                                       
                                    
                                 
                              
                           
                           =
                           2
                           ln
                           ln
                           
                              (
                              T
                              −
                              
                                 
                                    K
                                 
                                 
                                    
                                       max
                                    
                                 
                              
                              )
                           
                         for HQC.

The prior identification of 
                           p
                         via information criteria generally slows down simulations and increases computational costs. This meant that at this stage it was necessary to use an experimental design which limited computational costs to an affordable level. The simulations for this second stage were made using a fractional factorial design based on the following values of 
                           T
                           ,
                           
                              
                                 p
                              
                              
                                 
                                    max
                                 
                              
                           
                        , and 
                           S
                        : 
                           
                              
                                 
                                    T
                                 :
                              124,200,300,400,780,

3,6,9,12,50,

4,5,6,7,12,24,52

The Monte Carlo simulations were programmed in Gretl 1.9.6 (see Cottrell and Lucchetti, 2011a,b; Yalta and Schreiber, 2012). From version 1.9.4 onwards Gretl uses the SIMD-oriented Fast Mersenne Twister (SFMT) (see  Saito and Matsumoto, 2008) as its random number generator for the uniform distribution, in particular the implementation referred to as SFMT19937, which has a period of 219937−1 and is based on version 1.3.3 of the original C code by Saito and Matsumoto. Gretl uses Ziggurat (Marsaglia and Tsang, 2000) as the default method for generating normal variates on the basis of uniform input.

In the first stage, where 
                           p
                         is considered as fixed, from each Monte Carlo experiment a record is made of the 221 quantiles estimated of the statistics 
                           
                              
                                 t
                              
                              
                                 
                                    
                                       π
                                    
                                    
                                       0
                                    
                                 
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 
                                    
                                       π
                                    
                                    
                                       S
                                       /
                                       2
                                    
                                 
                              
                           
                           ,
                           
                              
                                 F
                              
                              
                                 j
                              
                              
                                 a
                                 b
                              
                           
                         with 
                           j
                           =
                           1
                           ,
                           …
                           ,
                           
                              
                                 S
                              
                              
                                 ∗
                              
                           
                           ,
                           
                              
                                 F
                              
                              
                                 S
                              
                           
                         and 
                           
                              
                                 F
                              
                              
                                 C
                              
                           
                         for probabilities 
                           α
                           =
                           0.0001
                           ,
                           0.0002
                           ,
                           0.0005
                           ,
                           0.001
                           ,
                           0.002
                           ,
                           …
                        ,
                           0.01
                           ,
                           0.015
                           ,
                           …
                        ,
                           0.99
                           ,
                           0.991
                           ,
                           …
                        ,
                           0.999
                           ,
                           0.9995
                           ,
                           0.9998
                           ,
                           0.9999
                         and the quantiles estimated are used as dependent variables in response surface regressions of the form 
                           
                              (7)
                              
                                 
                                    
                                       q
                                    
                                    
                                       i
                                    
                                    
                                       α
                                    
                                 
                                 
                                    (
                                    
                                       
                                          T
                                       
                                       
                                          c
                                       
                                    
                                    ,
                                    p
                                    ,
                                    S
                                    )
                                 
                                 =
                                 
                                    
                                       θ
                                    
                                    
                                       ∞
                                    
                                    
                                       α
                                    
                                 
                                 +
                                 
                                    
                                       θ
                                    
                                    
                                       1
                                    
                                    
                                       α
                                    
                                 
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             T
                                          
                                          
                                             c
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       θ
                                    
                                    
                                       2
                                    
                                    
                                       α
                                    
                                 
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             T
                                          
                                          
                                             c
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       θ
                                    
                                    
                                       3
                                    
                                    
                                       α
                                    
                                 
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             T
                                          
                                          
                                             c
                                          
                                          
                                             3
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       θ
                                    
                                    
                                       4
                                    
                                    
                                       α
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       
                                          
                                             T
                                          
                                          
                                             c
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       θ
                                    
                                    
                                       5
                                    
                                    
                                       α
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       
                                          
                                             T
                                          
                                          
                                             c
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       θ
                                    
                                    
                                       6
                                    
                                    
                                       α
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       
                                          
                                             T
                                          
                                          
                                             c
                                          
                                          
                                             3
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       θ
                                    
                                    
                                       7
                                    
                                    
                                       α
                                    
                                 
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       
                                          
                                             T
                                          
                                          
                                             c
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       θ
                                    
                                    
                                       8
                                    
                                    
                                       α
                                    
                                 
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       
                                          
                                             T
                                          
                                          
                                             c
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       θ
                                    
                                    
                                       9
                                    
                                    
                                       α
                                    
                                 
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       
                                          
                                             T
                                          
                                          
                                             c
                                          
                                          
                                             3
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       θ
                                    
                                    
                                       10
                                    
                                    
                                       α
                                    
                                 
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             3
                                          
                                       
                                    
                                    
                                       
                                          
                                             T
                                          
                                          
                                             c
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       θ
                                    
                                    
                                       11
                                    
                                    
                                       α
                                    
                                 
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             3
                                          
                                       
                                    
                                    
                                       
                                          
                                             T
                                          
                                          
                                             c
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       θ
                                    
                                    
                                       12
                                    
                                    
                                       α
                                    
                                 
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             3
                                          
                                       
                                    
                                    
                                       
                                          
                                             T
                                          
                                          
                                             c
                                          
                                          
                                             3
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       θ
                                    
                                    
                                       13
                                    
                                    
                                       α
                                    
                                 
                                 
                                    
                                       S
                                    
                                    
                                       
                                          
                                             T
                                          
                                          
                                             c
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       θ
                                    
                                    
                                       14
                                    
                                    
                                       α
                                    
                                 
                                 
                                    
                                       S
                                    
                                    
                                       
                                          
                                             T
                                          
                                          
                                             c
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       θ
                                    
                                    
                                       15
                                    
                                    
                                       α
                                    
                                 
                                 
                                    
                                       S
                                    
                                    
                                       
                                          
                                             T
                                          
                                          
                                             c
                                          
                                          
                                             3
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       e
                                    
                                    
                                       i
                                    
                                 
                              
                           
                         where 
                           
                              
                                 T
                              
                              
                                 c
                              
                           
                           =
                           T
                           −
                           m
                        , with 
                           T
                         being the sample size in the estimation of Eq. (5) and 
                           m
                         the number of regressors used in this equation. 
                           
                              
                                 q
                              
                              
                                 i
                              
                              
                                 α
                              
                           
                           
                              (
                              
                                 
                                    T
                                 
                                 
                                    c
                                 
                              
                              ,
                              p
                              ,
                              S
                              )
                           
                         denotes quantile 
                           α
                         obtained from the 
                           i
                        -th experiment with a given value of 
                           
                              
                                 T
                              
                              
                                 c
                              
                           
                        , autoregressive order 
                           p
                         and periodicity 
                           S
                        . This functional form was arrived at after some experimentation: it is based on the one used by Harvey and van Dijk but includes a third degree in 
                           p
                        , which is significant when 
                           S
                           >
                           4
                        , and adds three terms to take seasonal periodicity into account. Parameter 
                           
                              
                                 θ
                              
                              
                                 ∞
                              
                              
                                 α
                              
                           
                         represents quantile 
                           α
                         of the asymptotic distribution when 
                           T
                           →
                           ∞
                        . In the regressions estimated some of the coefficients were not significant but I preferred to maintain the same explanatory variables in all regressions, given that with the number of observations available this did not imply much loss of efficiency and the algorithms were thus made much simpler.

When the parameters of Eq. (7) are estimated by ordinary least squares, the errors are heteroscedastic with variance depending on 
                           
                              
                                 T
                              
                              
                                 c
                              
                           
                         and 
                           S
                        . Several alternative weighted least squares were tried out to take heteroscedasticity into account and in all cases the best result was that of the default hsk native command of Gretl. The procedure implemented by this command involves three steps: first an OLS estimation of the model, then an auxiliary regression to generate an estimate of the error variance, and then finally weighted least squares, using the reciprocal of the estimated variance as the weight. In the auxiliary regression the log of the squared residuals from the first OLS is regressed on the original regressors and their squares. The log transformation is performed to ensure that the estimated variances are non-negative.

In the monthly case 
                           
                              (
                              S
                              =
                              12
                              )
                           
                        , Beaulieu and Miron (1993, pp. 316–317) have the following to say with respect to the 
                           
                              
                                 F
                              
                              
                                 j
                              
                              
                                 a
                                 b
                              
                           
                         statistics (and for the 
                           
                              
                                 t
                              
                              
                                 
                                    
                                       π
                                    
                                    
                                       j
                                    
                                    
                                       a
                                    
                                 
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 
                                    
                                       π
                                    
                                    
                                       j
                                    
                                    
                                       b
                                    
                                 
                              
                           
                         statistics) for the different values of 
                           j
                           =
                           1
                           ,
                           …
                           ,
                           5
                        : “Investigation of the finite sample distributions for a subset of the cases considered below indicates that these distributions are similar for a given number of simulations and converge as the number of simulations increases”. Eq. (7) has been used here to test the hypothesis that all the 
                           
                              
                                 F
                              
                              
                                 j
                              
                              
                                 a
                                 b
                              
                           
                         statistics have the same distribution across different values of 
                           j
                        . This is a joint test of the null hypothesis that parameters 
                           
                              
                                 θ
                              
                              
                                 ∞
                              
                              
                                 α
                              
                           
                           ,
                           
                              
                                 θ
                              
                              
                                 1
                              
                              
                                 α
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 θ
                              
                              
                                 15
                              
                              
                                 α
                              
                           
                         for the 
                           F
                         statistics are the same for different 
                           j
                        . Assuming normality, albeit asymptotically, the statistic has a very high 
                           P
                        -value so at a 5% significance level the null is not rejected and the conclusion is that the distribution of 
                           
                              
                                 F
                              
                              
                                 j
                              
                              
                                 a
                                 b
                              
                           
                         does not depend on 
                           j
                         with finite samples either. The only remaining concerns are five distributions: 
                           
                              
                                 t
                              
                              
                                 
                                    
                                       π
                                    
                                    
                                       0
                                    
                                 
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 
                                    
                                       π
                                    
                                    
                                       S
                                       /
                                       2
                                    
                                 
                              
                           
                        , a generic 
                           F
                         which is the same for different values of 
                           j
                           ,
                           
                              
                                 F
                              
                              
                                 S
                              
                           
                         and 
                           
                              
                                 F
                              
                              
                                 C
                              
                           
                        . This means that all the simulations of the different 
                           
                              
                                 F
                              
                              
                                 j
                              
                              
                                 a
                                 b
                              
                           
                         statistics can be used jointly to estimate the parameters of (7) for 
                           F
                        , thus improving the precision of the estimates.

With the experimental design for the first stage described above, the number of observations available is 
                           
                              
                                 ∑
                              
                              
                                 S
                              
                           
                           
                              
                                 N
                              
                              
                                 S
                              
                           
                           
                              (
                              
                                 
                                    p
                                 
                                 
                                    S
                                    ,
                                    12
                                 
                              
                              +
                              1
                              )
                           
                           M
                         for the 
                           
                              
                                 t
                              
                              
                                 
                                    
                                       π
                                    
                                    
                                       0
                                    
                                 
                              
                           
                           ,
                           
                              
                                 F
                              
                              
                                 S
                              
                           
                         and 
                           
                              
                                 F
                              
                              
                                 C
                              
                           
                         statistics, 
                           
                              
                                 ∑
                              
                              
                                 S
                                 ≠
                                 5
                                 ,
                                 7
                              
                           
                           
                              
                                 N
                              
                              
                                 S
                              
                           
                           
                              (
                              
                                 
                                    p
                                 
                                 
                                    S
                                    ,
                                    12
                                 
                              
                              +
                              1
                              )
                           
                           M
                         for 
                           
                              
                                 t
                              
                              
                                 
                                    
                                       π
                                    
                                    
                                       S
                                       /
                                       2
                                    
                                 
                              
                           
                         and 
                           
                              
                                 ∑
                              
                              
                                 S
                              
                           
                           
                              
                                 N
                              
                              
                                 S
                              
                           
                           
                              (
                              
                                 
                                    p
                                 
                                 
                                    S
                                    ,
                                    12
                                 
                              
                              +
                              1
                              )
                           
                           M
                           
                              [
                              
                                 (
                                 S
                                 /
                                 2
                                 )
                              
                              −
                              1
                              ]
                           
                         for the 
                           F
                         statistic, where 
                           
                              
                                 N
                              
                              
                                 S
                              
                           
                         is the number of different sample sizes simulated for periodicity 
                           S
                         and 
                           
                              
                                 p
                              
                              
                                 S
                                 ,
                                 12
                              
                           
                         is 
                           S
                         for 
                           S
                           ≤
                           12
                         and 12 if 
                           S
                           >
                           12
                        .

Tables with the coefficients estimated for Eq. (7) for the quantiles of probabilities 0.10,0.05 and 0.01 for alternatives (c) and (d) of the deterministic term can be found online as supplementary material related to this article.

In the second stage, where the AR order is determined empirically, the same quantiles of the empirical small sample distributions are recorded as before and response surface regressions are estimated as in (7) with 
                           p
                         replaced with 
                           
                              
                                 p
                              
                              
                                 
                                    max
                                 
                              
                           
                        . Tables with the coefficients estimated for Eq. (7) for the quantiles of probabilities 0.10,0.05 and 0.01 for the alternatives (c) and (d) of the deterministic term when the value of 
                           p
                         is determined using AIC, BIC and HQC can also be found in the supplementary material section of the online version of this article.

After the response surface regression (7) is estimated for all 221 quantiles for the five statistics, an interpolation between these values can be performed using the method by MacKinnon (1996). Consider the regression 
                           
                              (8)
                              
                                 
                                    
                                       Φ
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    (
                                    α
                                    )
                                 
                                 =
                                 
                                    
                                       γ
                                    
                                    
                                       0
                                    
                                 
                                 +
                                 
                                    
                                       γ
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       q
                                    
                                    
                                       ˆ
                                    
                                 
                                 
                                    (
                                    α
                                    )
                                 
                                 +
                                 
                                    
                                       γ
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          
                                             q
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    α
                                    )
                                 
                                 +
                                 
                                    
                                       γ
                                    
                                    
                                       3
                                    
                                 
                                 
                                    
                                       
                                          
                                             q
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       3
                                    
                                 
                                 
                                    (
                                    α
                                    )
                                 
                                 +
                                 
                                    
                                       e
                                    
                                    
                                       α
                                    
                                 
                              
                           
                         where 
                           α
                         denotes one of the 221 points at which the quantiles are estimated, with 
                           0
                           <
                           α
                           <
                           1
                           ,
                           
                              
                                 q
                              
                              
                                 ˆ
                              
                           
                           
                              (
                              α
                              )
                           
                         denotes the estimate of 
                           
                              
                                 q
                              
                              
                                 α
                              
                           
                         and 
                           
                              
                                 Φ
                              
                              
                                 −
                                 1
                              
                           
                           
                              (
                              α
                              )
                           
                         is the inverse of the cumulative standard normal distribution function. There is enough empirical evidence to show that this equation may be a good candidate for approximating the distribution of a two-tailed test statistic, such as 
                           
                              
                                 t
                              
                              
                                 
                                    
                                       π
                                    
                                    
                                       0
                                    
                                 
                              
                           
                         and 
                           
                              
                                 t
                              
                              
                                 
                                    
                                       π
                                    
                                    
                                       S
                                       /
                                       2
                                    
                                 
                              
                           
                        , in a small region around a specified value of 
                           α
                        . For an F-type test a 
                           
                              
                                 χ
                              
                              
                                 2
                              
                           
                           
                              (
                              2
                              )
                           
                         is a better option than the normal distribution in 
                           
                              
                                 Φ
                              
                              
                                 −
                                 1
                              
                           
                           
                              (
                              α
                              )
                           
                        . In principle the order 
                           p
                         of an autoregressive model may be an integer between 0 and 
                           ∞
                         but obviously the model cannot be simulated for infinite values of 
                           p
                        . Furthermore for Eq. (7) to be practical and produce well fitted estimations of 
                           
                              
                                 q
                              
                              
                                 ˆ
                              
                           
                           
                              (
                              α
                              )
                           
                         it is not advisable to use high powers of 
                           p
                        . This implies that the procedure works well for values of 
                           p
                         around those used in the simulations but tends to give very inaccurate forecasts of 
                           q
                           
                              (
                              α
                              )
                           
                         for large values of 
                           p
                        . However these cases are very easy to detect in practice so it is not difficult to put a warning in the computer algorithm for when excessively large values of 
                           p
                         or 
                           
                              
                                 p
                              
                              
                                 
                                    max
                                 
                              
                           
                         are selected. In our case, after some experimentation I have found that this method with the powers determined in (7) and the values of 
                           p
                         used in our experimental design is reliable for around 
                           p
                           ⪅
                           80
                         (and the same for 
                           
                              
                                 p
                              
                              
                                 
                                    max
                                 
                              
                           
                        ).

Eq. (8) is usually estimated with a small, odd number of points, 
                           ℓ
                        , around the specified significance level, in particular, 
                           ℓ
                           =
                           9
                           ,
                           11
                           ,
                           13
                         or 15 points are considered reasonable (there seems to be little difference between the results from 9 to 15, so this parameter is left to the choice of the user in the Gretl functions provided). To account for heteroscedasticity and serial correlation MacKinnon suggests employing a feasible GLS estimator using a symmetric covariance matrix with elements 
                           
                              (9)
                              
                                 
                                    
                                       
                                          
                                             ω
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 =
                                 
                                    s.e
                                 
                                 
                                    (
                                    
                                       
                                          
                                             
                                                θ
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          ∞
                                       
                                       
                                          
                                             
                                                α
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    )
                                 
                                 
                                    s.e
                                 
                                 
                                    (
                                    
                                       
                                          
                                             
                                                θ
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          ∞
                                       
                                       
                                          
                                             
                                                α
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                (
                                                1
                                                −
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      j
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   j
                                                
                                             
                                             
                                                (
                                                1
                                                −
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 i
                                 <
                                 j
                                 ,
                              
                           
                         where the standard errors of 
                           
                              
                                 
                                    
                                       θ
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 ∞
                              
                              
                                 
                                    
                                       α
                                    
                                    
                                       i
                                    
                                 
                              
                           
                         are obtained from the OLS estimation of Eq. (8).

In order to calculate the 
                           P
                        -value for an observed test statistic, 
                           
                              
                                 τ
                              
                              
                                 ∗
                              
                           
                        , it is possible simply to estimate Eq. (8) for a small set of values of 
                           
                              
                                 q
                              
                              
                                 ˆ
                              
                           
                           
                              (
                              α
                              )
                           
                         near 
                           
                              
                                 τ
                              
                              
                                 ∗
                              
                           
                         and then compute 
                           
                              (10)
                              
                                 
                                    
                                       P
                                    
                                    
                                       ∗
                                    
                                 
                                 =
                                 Φ
                                 
                                    (
                                    
                                       
                                          
                                             
                                                γ
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          0
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                γ
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          τ
                                       
                                       
                                          ∗
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                γ
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          τ
                                       
                                       
                                          ∗
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                γ
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          3
                                       
                                    
                                    
                                       
                                          τ
                                       
                                       
                                          ∗
                                       
                                       
                                          3
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     

Some scripts prepared by the author in HANSL (the Gretl scripting language) can be found in the supplementary material section of the online version of this article.

In particular they contain 
                           
                              •
                              a function for obtaining the 
                                    P
                                 -values of the 
                                    
                                       
                                          t
                                       
                                       
                                          
                                             
                                                π
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          
                                             
                                                π
                                             
                                             
                                                S
                                                /
                                                2
                                             
                                          
                                       
                                    
                                    ,
                                    F
                                    ,
                                    
                                       
                                          F
                                       
                                       
                                          s
                                       
                                    
                                 , and 
                                    
                                       
                                          F
                                       
                                       
                                          C
                                       
                                    
                                  tests;

a function for automatically calculating the HEGY tests and 
                                    P
                                 -values for any periodicity; and

a Gretl function package for using these functions under the Gretl graphical user interface.

The 
                        P
                     -values and quantiles obtained with the methods described above use all the data from the simulations in the experiments and 
                        M
                        =
                        50
                      repetitions for each model. So although both the values obtained here and the critical values reported in the articles mentioned above are estimations or approximations of the true critical values, a much lower variance and thus a more accurate approximation can be expected from the method described in this paper.

The precision of the estimated quantiles obtained by a single simulation (as done e.g. in the cited articles by HEGY and Beaulieu–Miron) and that of the present procedure can be compared by the confidence intervals calculated for both procedures. A confidence interval for a single simulation may be obtained as follows (see for example Kleijnen, 1987). In order to estimate the quantile 
                        
                           
                              q
                           
                           
                              α
                           
                        
                     , the simulated values of the statistic 
                        
                           
                              x
                           
                           
                              i
                           
                        
                        
                        
                           (
                           i
                           =
                           1
                           ,
                           …
                           ,
                           N
                           )
                        
                      (where 
                        x
                      may be 
                        
                           
                              t
                           
                           
                              
                                 
                                    π
                                 
                                 
                                    0
                                 
                              
                           
                        
                        ,
                        
                           
                              t
                           
                           
                              
                                 
                                    π
                                 
                                 
                                    S
                                    /
                                    2
                                 
                              
                           
                        
                        ,
                        F
                        ,
                        
                           
                              F
                           
                           
                              s
                           
                        
                      or 
                        
                           
                              F
                           
                           
                              C
                           
                        
                     ) must be arranged in increasing order; that is the order statistics 
                        
                           
                              x
                           
                           
                              
                                 (
                                 i
                                 )
                              
                           
                        
                      must be obtained: 
                        
                           
                              
                                 
                                    x
                                 
                                 
                                    
                                       (
                                       1
                                       )
                                    
                                 
                              
                              ≤
                              
                                 
                                    x
                                 
                                 
                                    
                                       (
                                       2
                                       )
                                    
                                 
                              
                              ≤
                              ⋯
                              ≤
                              
                                 
                                    x
                                 
                                 
                                    
                                       (
                                       N
                                       −
                                       1
                                       )
                                    
                                 
                              
                              ≤
                              
                                 
                                    x
                                 
                                 
                                    
                                       (
                                       N
                                       )
                                    
                                 
                              
                              .
                           
                        
                      It can be proved that a 
                        1
                        −
                        ϵ
                      confidence interval for the quantile 
                        
                           
                              q
                           
                           
                              α
                           
                        
                     , provided 
                        N
                        >
                        20
                     , is 
                        
                           (11)
                           
                              Pr
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       
                                          (
                                          l
                                          )
                                       
                                    
                                 
                                 ≤
                                 
                                    
                                       q
                                    
                                    
                                       α
                                    
                                 
                                 ≤
                                 
                                    
                                       x
                                    
                                    
                                       
                                          (
                                          r
                                          )
                                       
                                    
                                 
                                 )
                              
                              =
                              1
                              −
                              ϵ
                           
                        
                      with 
                        
                           
                              l
                              =
                              
                                 ⌈
                                 N
                                 α
                                 −
                                 
                                    
                                       z
                                    
                                    
                                       ϵ
                                       /
                                       2
                                    
                                 
                                 
                                    
                                       N
                                       α
                                       
                                          (
                                          1
                                          −
                                          α
                                          )
                                       
                                    
                                 
                                 ⌉
                              
                              
                              and
                              
                              r
                              =
                              
                                 ⌈
                                 N
                                 α
                                 +
                                 
                                    
                                       z
                                    
                                    
                                       ϵ
                                       /
                                       2
                                    
                                 
                                 
                                    
                                       N
                                       α
                                       
                                          (
                                          1
                                          −
                                          α
                                          )
                                       
                                    
                                 
                                 ⌉
                              
                              ,
                           
                        
                      where the symbol 
                        
                           ⌈
                           
                           ⌉
                        
                      means that 
                        l
                      and 
                        r
                      are rounded upward and 
                        
                           
                              z
                           
                           
                              ϵ
                              /
                              2
                           
                        
                      denotes the quantile 
                        ϵ
                        /
                        2
                      in the Gaussian distribution. Applying this, for example, to a single simulation with the deterministic part formed by a constant and 
                        S
                        −
                        1
                      seasonal dummies, with 
                        S
                        =
                        4
                        ,
                        T
                        =
                        1000
                        ,
                        p
                        =
                        0
                      and 
                        N
                        =
                        24
                        
                        000
                     , with 
                        α
                        =
                        ϵ
                        =
                        0.05
                     , a 95% confidence interval for the 0.05 quantile for 
                        
                           
                              t
                           
                           
                              
                                 
                                    π
                                 
                                 
                                    0
                                 
                              
                           
                        
                      of (−2.89554,−2.85211) is obtained. Its semi-amplitude is 0.02171 which, assuming local linearity in the density 
                        f
                        
                           (
                           
                              
                                 t
                              
                              
                                 
                                    
                                       π
                                    
                                    
                                       0
                                    
                                 
                              
                           
                           )
                        
                     , implies an approximate standard error of 0.01108 for the quantile.

A confidence interval for the estimations of the quantiles of 
                        
                           
                              t
                           
                           
                              
                                 
                                    π
                                 
                                 
                                    0
                                 
                              
                           
                        
                      obtained through the method described in Section  4 may be obtained as a prediction interval for given values of the explanatory variables (for 
                        S
                        =
                        4
                        ,
                        T
                        =
                        1000
                        ,
                        p
                        =
                        0
                     ) in Eq. (7). Given that this equation is estimated by weighted least squares, the confidence interval may be approximated through the usual OLS confidence interval in the weighted equation, and a subsequent de-weighting of the interval limits, which for 95% confidence gives (−2.86729,−2.83333), with semi-amplitude 0.01698 and a standard error for the quantile of 0.008663, which gives a standard error 21% smaller than using a single simulation estimate.

The accuracy of the quantile estimations obtained through the response surface regression  (7) can also be compared with the quantile estimation obtained as an average of the quantiles obtained after 50 repetitions of 
                        N
                        =
                        100
                        
                        000
                      replications of the given statistic. MacKinnon (2002) makes such a comparison for the example of the Dickey–Fuller tests and concludes that “…it appears that the standard errors of response surface estimates will be of roughly the same order of magnitude as, but probably somewhat smaller than, the standard errors suggested by the formula (45.11)” (using an average of the repetitions). In general here I obtain better results. The left side of Table 1
                      has the results for the use of 50 repetitions with 
                        N
                        =
                        100
                        
                        000
                      replications of the same model as above and considering the estimation of the 0.10,0.05 and 0.01 quantiles of 
                        
                           
                              t
                           
                           
                              
                                 
                                    π
                                 
                                 
                                    0
                                 
                              
                           
                        
                        ,
                        
                           
                              t
                           
                           
                              
                                 
                                    π
                                 
                                 
                                    S
                                    /
                                    2
                                 
                              
                           
                        
                      and 
                        F
                      obtained by averaging the empirical quantiles of the 50 repetitions. The right side of the table shows the results obtained with the response-surface regressions, which in all cases produce much lower standard errors.


                        Hylleberg et al. (1990) illustrate their tests using United Kingdom data on consumption and income (the data set can be obtained from  Hylleberg et al., 1996). The data are quarterly observations for the period 1955.1–1984.4 on the variables 
                           y
                           =
                           
                              log of personal disposable income
                           
                         and 
                           c
                           =
                           
                              log of consumption expenditures on non durables
                           
                        . For 
                           c
                         and 
                           y
                         they use a model with 
                           p
                           =
                           5
                        , which gives 
                           T
                           =
                           111
                         effective observations for estimating Eq. (5). They also use 
                           p
                           =
                           4
                         with 
                           c
                           −
                           y
                         to test for a cointegration relationship, which implies 
                           T
                           =
                           112
                        . They report the seasonal unit roots statistics for five different specifications for the deterministic term. For example, for 
                           
                              
                                 D
                              
                              
                                 t
                              
                           
                           =
                         constant, 
                           
                              (
                              S
                              −
                              1
                              )
                           
                         seasonal dummies and a linear trend, they obtain the values of the statistics under columns 
                           
                              
                                 t
                              
                              
                                 
                                    
                                       π
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 
                                    
                                       π
                                    
                                    
                                       2
                                    
                                 
                              
                           
                         and 
                           
                              
                                 F
                              
                              
                                 
                                    
                                       π
                                    
                                    
                                       3
                                    
                                 
                                 ∩
                                 
                                    
                                       π
                                    
                                    
                                       4
                                    
                                 
                              
                           
                         shown in Table 2
                        .

The tables of critical values based on Monte Carlo simulations that they present give information for 
                           T
                           =
                           48
                           ,
                           100
                           ,
                           136
                         and 200, so with 
                           T
                           =
                           111
                         or 112 they can only obtain one conclusion because their estimated values are far enough from all the values for the different sample sizes in their tables. In cases that are not so clear an interpolation method is needed. Using the Gretl algorithm based on the method presented above it is easy to obtain the 
                           P
                        -values associated with the statistics calculated by HEGY. They are reported in parentheses in Table 2. It can be seen that in general the conclusions obtained by Hylleberg et al. are valid. The only difference is that they did not reject the hypothesis 
                           
                              
                                 π
                              
                              
                                 2
                              
                           
                           =
                           0
                         for 
                           c
                           −
                           y
                         whereas it can now be seen that it should be rejected at a 5% level of significance, which implies that there is no unit root at frequency 
                           ω
                           =
                           π
                         in this series. Although in theory this might be considered as providing some degree of evidence of seasonal cointegration on the biannual cycle, that evidence is not strong and a more comprehensive analysis using, for example, the Canova–Hansen test is advisable.


                        Fig. 1
                         shows the series of hourly aggregate demand for electricity in Spain from 2012/04/01/01:00 to 2012/09/30/24:00 (4392 observations. Source: Comisión Nacional de Energía, http://www.cne.es). Taking the day as the period of reference, there are 24 observations in a day, so in this case 
                           S
                           =
                           24
                        . The graph shows intra-daily cycles which may lead to the suspicion that there are seasonal unit roots with periods of less than or equal to 24, but it also shows a weekly cycle with period 24×7=168. This means that if the period of one day is taken as a reference, 
                           S
                           =
                           24
                        , in running the intra-day seasonal unit root tests at least one AR order of 
                           p
                           =
                           168
                           −
                           24
                           =
                           144
                         will need to be determined to obtain consistent estimators. Table 3
                         shows statistics for testing for unit roots by means of the procedure described in Section  4. Given the graph of the series, a deterministic part including a constant and 23 seasonal dummies (the trend is not significant) is considered, with 
                           p
                           =
                           144
                         taken as given. From the last row of the table it can be seen that by means of the 
                           
                              
                                 F
                              
                              
                                 C
                              
                           
                         statistic the null hypothesis of unit roots in all seasonal frequencies and also the zero frequency is not rejected at, for example, 5% significance level. The possibility of unit roots at each frequency separately can now be considered. In this case at 5% significance level only the hypothesis that the series presents a unit root with statistic 
                           
                              
                                 F
                              
                              
                                 6
                              
                              
                                 a
                                 b
                              
                           
                        , i.e. corresponding to a cycle with period 4, is rejected.

Another alternative with these hourly data is to consider the possibility of seasonal unit roots not only for the cycles in the day but also for the cycles in the week. In that case the reference period must be changed to a week, making 
                           S
                           =
                           168
                        . Table 4
                         shows the results of applying the seasonal unit root tests for this seasonal periodicity and calculating the 
                           P
                        -values with the method described in Section  4. A deterministic part including a constant and 167 seasonal dummies is used and the autoregressive order is determined by means of the BIC with 
                           
                              
                                 p
                              
                              
                                 
                                    max
                                 
                              
                           
                           =
                           40
                        , which gives a value of 
                           p
                           =
                           2
                        . This table shows that most of the unit roots corresponding to intra-day frequencies are not rejected, except the root at frequency 
                           ±
                           π
                           /
                           2
                         (period 4) as before and now also the root at frequency 
                           ±
                           π
                           /
                           12
                         (period 24). However, given the value of 
                           
                              
                                 F
                              
                              
                                 1
                              
                              
                                 a
                                 b
                              
                           
                        , the unit root is clearly rejected for the cycle with period 168, which implies that the weekly cycle shown in the graph is deterministic, and given the values of the statistics 
                           
                              
                                 F
                              
                              
                                 j
                              
                              
                                 a
                                 b
                              
                           
                         when 
                           j
                         is not a multiple of 7, the unit root is also rejected for the rest of the intermediate frequency cycles that appear because of the weekly seasonality. Thus, by means of the 
                           
                              
                                 F
                              
                              
                                 C
                              
                           
                         statistic the null hypothesis of unit roots at all seasonal frequencies and also at zero frequency is rejected at the 5% significance level, and the same occurs with the 
                           
                              
                                 F
                              
                              
                                 S
                              
                           
                         statistic, i.e. the null joint hypothesis of having unit roots at all seasonal frequencies (not including zero frequency) is rejected.

@&#CONCLUSION@&#

The HEGY 
                        t
                      and 
                        F
                      test statistics for seasonal unit roots have non-standard distributions that vary depending on the sample size, the number of autoregressive lags included in the model, the type and number of deterministic components and the seasonal periodicity of the data. Tables of critical values for the quarterly, monthly and weekly cases have already been published for some specific sample sizes, zero autoregressive lags and several deterministic components. A method based on surface regressions has also been published which calculates the 
                        P
                     -values and critical values of these tests for quarterly data for any sample size and autoregressive order (Harvey and van Dijk, 2006).

In the present paper this method is extended so that 
                        P
                     -values can also be obtained for any periodicity. Lemmas 1 and 4 in Beaulieu and Miron (1993) are used as a theoretical basis for determining that the 
                        F
                      statistics for frequencies in 
                        
                           (
                           0
                           ,
                           π
                           )
                        
                      have equal asymptotic distributions. This result enables a general algorithm to be set up for obtaining 
                        P
                     -values for any periodicity.

In Section  4 the procedure for estimating the surface regressions based on Monte Carlo simulations and for obtaining the 
                        P
                     -values of the different statistics is explained in detail. Two different cases are presented: the first considers the autoregressive order as given, and the second uses an information criterion as a tool for determining 
                        p
                     . Users can find Gretl scripts for applying these techniques in empirical analyses in the supplementary material section of the online version of this article.

A comparison between the precision of the estimates obtained with a single simulation, with an average of 50 simulations, and that obtained through response surface regressions is presented in Section  5, and Section  6 presents two simple applications of the method proposed here: the first uses the same data on consumption and income in the UK used in the HEGY article and the second an hourly time series on aggregate demand for electricity in Spain. The first example shows how knowing a valid 
                        P
                     -value may improve the conclusions obtained in a cointegration study with respect to the case when only some critical values for specific sample sizes are available in a Table. The second example shows an application of the tests with an hourly time series that may be considered as having a seasonal periodicity of 
                        S
                        =
                        24
                      or 
                        S
                        =
                        168
                     .

The main advantage of the procedure presented here is that it extends the application of these tests to a wide range of new possibilities, including the high frequency data more and more of which are becoming available as time goes by: daily, hourly and semi-hourly data, etc.

@&#ACKNOWLEDGEMENTS@&#

The idea for this study emerged in a conversation with Riccardo ‘Jack’ Lucchetti. Financial support from Ministerio de Ciencia e Innovación under research project ECO2010-15332 and from the Basque Government Econometrics Research
                     Group
                  
                  IT-334-07 is acknowledged. The SGI/IZO-SGIker UPV/EHU is gratefully acknowledged for its generous allocation of computational resources. I am grateful to Fernando Tusell for providing resources for computing, and Aitor Ciarreta for help with obtaining appropriate data. I also thank the Associate Editor and two anonymous referees for their very constructive remarks.

Supplementary material related to this article can be found online at http://dx.doi.org/10.1016/j.csda.2013.03.006.

The following is the Supplementary material related to this article. 
                        
                           MMC S1
                           
                              Gretl scripts with the examples in the paper and a Gretl function package
                           
                           
                        
                     
                     
                        
                           MMC S2
                           
                              Response surface regression estimates for quantiles 
                                    
                                       
                                          q
                                       
                                       
                                          α
                                       
                                    
                                  with 
                                    α
                                    =
                                    0.10
                                 , 0.05 and 0.01 when the AR order is: fixed, determined by AIC, BIC or HQC
                           
                           
                        
                     
                  

@&#REFERENCES@&#

