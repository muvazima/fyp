@&#MAIN-TITLE@&#Covariance estimation for minimal geometry solvers via scaled unscented transformation

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Scaled unscented transformation (SUT) for minimal geometry solvers (MGS).


                        
                        
                           
                           SUT vs. first-order-propagation (FOP) in uncertainty estimation of MGS.


                        
                        
                           
                           Since MGS are highly nonlinear, SUT is a better uncertainty estimator than FOP.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Covariance estimation

Camera calibration

Epipolar geometry

@&#ABSTRACT@&#


               
               
                  Covariance is a well-established characterisation of the output uncertainty for estimators dealing with noisy data. It is conventionally estimated via first-order forward propagation (FOP) of input covariance. However, since FOP employs a local linear approximation of the estimator, its reliability is compromised in the case of nonlinear transformations. An alternative method, scaled unscented transformation (SUT) is known to cope with such cases better. However, despite the nonlinear nature of many vision problems, its adoption remains limited. This paper investigates the application of SUT on common minimal geometry solvers, a class of algorithms at the core of many applications ranging from image stitching to film production and robot navigation. The contributions include an experimental comparison of SUT against FOP on synthetic and real data, and practical suggestions for adapting the original SUT to the geometry solvers. The experiments demonstrate the superiority of SUT to FOP as a covariance estimator, over a range of scene types and noise levels, on synthetic and real data.
               
            

@&#INTRODUCTION@&#

The output of a parameter estimator is of limited utility without a measure of its reliability. In practice, Gaussians are deemed an adequate uncertainty representation, and therefore, reliability is often assessed by propagating the input covariance to the output. However, since the output covariance is itself an estimate, its accuracy is a valid concern.

In this paper, we study the quality of covariance estimates computed via first-order propagation (FOP) and scaled unscented transformation (SUT), for a collection of common minimal geometry problems; namely, homography, epipolar geometry and calibration estimation, and triangulation. The associated solvers recover the mappings relating a set of image-image, or scene-image correspondences from a minimum number of correspondences, by using all available constraints. Their covariance is of interest in a number of practical applications. For example, in RANSAC [1], the covariance estimate computed from the minimal set with the best score is an upper bound to the actual uncertainty of the result. This is employed in [14] to approximate the measurement covariances in a prediction–correction scheme with an unscented Kalman filter (UKF), which estimates the internal and external calibration parameters of a moving camera. In [21], the covariance estimates are utilised within the RANSAC cycle to reject ambiguous/unstable solutions and to improve the hypothesis evaluation, resulting in significantly faster operation. It can also potentially be used for determining the search regions in guided matching [11], global registration of pairwise relative pose estimates [4], sensor fusion, and keyframe selection in structure-from-motion [26]. Finally, in film production, commercial software packages typically allow an operator to make use of known survey points for manually establishing correspondences for calibration [2]. A minimal geometry solver (MGS) requires less effort, and an estimate of the covariance can guide the operator to more reliable correspondences.

An MGS can be expressed as a function mapping a set of measurements (i.e. image-image, or scene-image correspondences) to a set of parameters (e.g. a camera pose). For such a map, covariance propagation via FOP involves substituting the original function with a local first order linear approximation [5]. Visual SLAM via extended Kalman filter (EKF) [8] is a well-known application of this approach, as FOP lies at the core of EKF. Other examples include the estimation of fundamental matrix [7,22], 2D homography [6], and relative and absolute orientation [9].

The accuracy of FOP depends on the fidelity of the linear approximation to the original function. For example, EKF-SLAM is prone to underestimating the covariance (inconsistency) due to the accumulation of the linearisation errors [3]. An alternative approach is SUT [16]. It involves the generation of a number of “particles” by deterministically perturbing the original input, which are to be propagated through the function, in order to compute the sample covariance of the output. This technique approximates the output distribution by a Gaussian, as opposed to FOP, which approximates the function in such a way that the output distribution is a Gaussian [16]. SUT was recently employed in SLAM [12], by replacing EKF with UKF, and superior estimate consistency is reported. SUT is also utilised in [14] to estimate the uncertainty of a number of perspective-n-point (PnP) solvers.

The superiority of SUT over FOP is already established in the control and robotics literature (e.g. 
                     [16,12]): it offers a performance identical to a second-order linear approximation (SOP). SUT is preferable to SOP as well, as it does not involve any Jacobians or Hessians [16]. However, the adoption of SUT in the computer vision field remains limited. In this paper, we aim to highlight the benefits of SUT on a collection of minimal geometry solvers. Our main contribution is twofold:
                        
                           •
                           We show that SUT is superior to FOP, by comparing the covariance estimates with the true covariance obtained through Monte-Carlo (MC) simulations in synthetic and real data.

The original SUT is formulated for 1:1 functions mapping Euclidean vectors. We describe how SUT can be implemented when these conditions are violated, as is the case for most of the solvers.

The organisation of the paper is as follows: Section 2 introduces the notation, and provides a brief background on FOP, MC and SUT. Section 3 discusses some solver-specific implementation details. The experimental results are presented in Section 4, followed by the conclusions in Section 5. Two appendices include further details on the solvers, and additional experiments.

Consider a solver S, an explicit function that maps a measurement vector (
                        
                           x
                        
                     ) to a vector representing the estimated parameters (
                        
                           y
                        
                     ). Given the measurement covariance matrix (
                        
                           
                              
                                 C
                              
                              
                                 x
                              
                           
                        
                     ), our aim is to find an estimate (
                        
                           
                              
                                 
                                    
                                       C
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 y
                              
                           
                        
                     ) to the output covariance (
                        
                           
                              
                                 C
                              
                              
                                 y
                              
                           
                        
                     ). This can be accomplished either by linearising S (FOP), or by computing the sample statistics of 
                        
                           y
                        
                     .

The first two terms of the Taylor series expansion of 
                           
                              S
                              (
                              x
                              )
                           
                         about an 
                           
                              
                                 
                                    x
                                 
                                 
                                    ¯
                                 
                              
                           
                         provide a locally linear approximation to S in 
                           
                              Δ
                              x
                              =
                              x
                              -
                              
                                 
                                    x
                                 
                                 
                                    ¯
                                 
                              
                           
                        , i.e.
                        
                           
                              (1)
                              
                                 y
                                 =
                                 S
                                 (
                                 x
                                 )
                                 ≅
                                 S
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       ¯
                                    
                                 
                                 )
                                 +
                                 J
                                 Δ
                                 x
                                 ,
                              
                           
                        where 
                           
                              J
                           
                         is the Jacobian of S with respect to 
                           
                              x
                           
                        , evaluated at 
                           
                              
                                 
                                    x
                                 
                                 
                                    ¯
                                 
                              
                           
                        . If 
                           
                              x
                           
                         is distributed as a Gaussian with the mean 
                           
                              
                                 
                                    x
                                 
                                 
                                    ¯
                                 
                              
                           
                         and covariance 
                           
                              
                                 
                                    C
                                 
                                 
                                    x
                                 
                              
                           
                        , i.e. 
                        
                           
                              x
                              ∼
                              N
                              (
                              
                                 
                                    x
                                 
                                 
                                    ¯
                                 
                              
                              ,
                              
                                 
                                    C
                                 
                                 
                                    x
                                 
                              
                              )
                           
                        , the distribution of 
                           
                              y
                           
                         can be approximated as 
                           
                              N
                              (
                              S
                              (
                              
                                 
                                    x
                                 
                                 
                                    ¯
                                 
                              
                              )
                              ,
                              
                                 
                                    JC
                                 
                                 
                                    x
                                 
                              
                              
                                 
                                    J
                                 
                                 
                                    T
                                 
                              
                              )
                           
                         
                        [5]. This technique is known as first order (forward) propagation of covariance (FOP) [11].


                        
                           
                              J
                           
                         can be computed analytically or numerically. The analytical method involves the algebraic derivation of a closed-form expression for 
                           
                              
                                 
                                    ∇
                                 
                                 
                                    x
                                 
                              
                              S
                           
                         (through the chain rule, when S is a composition of several distinct stages). The numerical method computes one partial derivative at a time, by applying deterministic perturbations to each element of 
                           
                              
                                 
                                    x
                                 
                                 
                                    ¯
                                 
                              
                           
                        , and passing the results through a discrete high-pass filter. A common implementation, the central difference scheme, approximates the partial derivatives as
                           
                              (2)
                              
                                 
                                    
                                       ∂
                                       S
                                    
                                    
                                       ∂
                                       
                                          
                                             x
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       S
                                       (
                                       x
                                       +
                                       
                                          
                                             δ
                                          
                                          
                                             j
                                          
                                       
                                       
                                          
                                             e
                                          
                                          
                                             j
                                          
                                       
                                       )
                                       -
                                       S
                                       (
                                       x
                                       -
                                       
                                          
                                             δ
                                          
                                          
                                             j
                                          
                                       
                                       
                                          
                                             e
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                    
                                       2
                                       
                                          
                                             δ
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    δ
                                 
                                 
                                    j
                                 
                              
                           
                         denotes the magnitude of the perturbation. 
                           
                              
                                 
                                    x
                                 
                                 
                                    j
                                 
                              
                           
                         is the jth element of 
                           
                              x
                           
                        , and 
                           
                              
                                 
                                    e
                                 
                                 
                                    j
                                 
                              
                           
                         is a vector whose elements are all zeros, except for the jth, which is 1. The appropriate perturbation is problem-dependent; however, for geometry problems, [11] suggests 
                           
                              max
                              (
                              
                                 
                                    10
                                 
                                 
                                    -
                                    6
                                 
                              
                              ,
                              |
                              
                                 
                                    10
                                 
                                 
                                    -
                                    4
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    j
                                 
                              
                              |
                              )
                           
                         (p. 602).

The analytical method has advantages in terms of accuracy and computational cost (a single evaluation of 
                           
                              
                                 
                                    ∇
                                 
                                 
                                    x
                                 
                              
                              S
                           
                        , as opposed to 
                           
                              2
                              M
                           
                         evaluations of S, for an M-element 
                           
                              x
                           
                        ). However, we adopted the numerical approach for the following reasons:
                           
                              •
                              We are not aware of any closed-form expressions of the Jacobians for some components of the solvers (e.g. Gröbner basis solvers).

For a very common component, SVD, [32] offers a method to compute the exact Jacobian, but states that the results are identical to those obtained by the numerical approach.

In practice, for geometry estimation problems, the error introduced by the numerical approximation is insignificant 
                                 [11], especially, compared to the error due to the first-order approximation of S (i.e. Eq. (1)).

Therefore, we believe that this decision is unlikely to have a qualitative impact on the results.

A related method is backward propagation of covariance (BP): consider a function 
                           
                              
                                 
                                    x
                                 
                                 
                                    ˆ
                                 
                              
                              =
                              T
                              (
                              y
                              )
                           
                         that minimises 
                           
                              ‖
                              x
                              -
                              
                                 
                                    x
                                 
                                 
                                    ˆ
                                 
                              
                              
                                 
                                    ‖
                                 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          x
                                       
                                    
                                 
                              
                           
                        , i.e. the Mahalanobis distance. If 
                           
                              x
                              ∼
                              N
                              (
                              T
                              (
                              y
                              )
                              ,
                              
                                 
                                    C
                                 
                                 
                                    x
                                 
                              
                              )
                              
                                 
                                    |
                                 
                                 
                                    y
                                    =
                                    
                                       
                                          y
                                       
                                       
                                          ¯
                                       
                                    
                                 
                              
                           
                        , and 
                           
                              
                                 
                                    J
                                 
                                 
                                    T
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                ∂
                                                T
                                             
                                             
                                                ∂
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      j
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    j
                                 
                              
                              
                                 
                                    |
                                 
                                 
                                    y
                                    =
                                    
                                       
                                          y
                                       
                                       
                                          ¯
                                       
                                    
                                 
                              
                              ,
                              
                              
                                 
                                    C
                                 
                                 
                                    y
                                 
                              
                           
                         can be approximated as 
                           
                              
                                 
                                    (
                                    
                                       
                                          J
                                       
                                       
                                          T
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          C
                                       
                                       
                                          x
                                       
                                       
                                          -
                                          1
                                       
                                    
                                    
                                       
                                          J
                                       
                                       
                                          T
                                       
                                    
                                    )
                                 
                                 
                                    -
                                    1
                                 
                              
                           
                         
                        [11]. When T is an analytical function, 
                           
                              
                                 
                                    J
                                 
                                 
                                    T
                                 
                              
                           
                         can be computed without resorting to multiple evaluations. However, the applicability of this technique is limited to the cases where 
                           
                              T
                              (
                              y
                              )
                           
                         uniquely defines a vector in the measurement space, e.g. a T projecting a 3D scene point to the image plane of a camera (BP in structure-from-motion). Of the minimal solvers studied in this paper (Section 3), only the two-view triangulation case satisfies this condition, with T being the perspective projection operator, which maps a 3D point to two unique 2D image points, through two known camera matrices: alone, a camera matrix or an epipolar geometry relation is not sufficient to identify a unique scene-image or image-image correspondence, respectively. Furthermore, most solvers either do not minimise the Mahalanobis distance (e.g. epipolar geometry estimation), or perform a constrained minimisation (e.g. metric calibration estimation). Therefore, we will not consider BP further as an alternative linearisation method.

Given a set of measurements 
                           
                              {
                              
                                 
                                    x
                                 
                                 
                                    k
                                 
                              
                              }
                              ∼
                              N
                              (
                              
                                 
                                    x
                                 
                                 
                                    ¯
                                 
                              
                              ,
                              
                                 
                                    C
                                 
                                 
                                    x
                                 
                              
                              )
                              ,
                              
                                 
                                    
                                       
                                          C
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    y
                                 
                              
                           
                         can be computed as the sample covariance of 
                           
                              {
                              
                                 
                                    y
                                 
                                 
                                    k
                                 
                              
                              }
                              =
                              S
                              (
                              {
                              
                                 
                                    x
                                 
                                 
                                    k
                                 
                              
                              }
                              )
                           
                        ,
                           
                              (3)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   ˆ
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                   
                                                      L
                                                   
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   k
                                                
                                             
                                             S
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         ^
                                                      
                                                   
                                                
                                                
                                                   y
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                   
                                                      L
                                                   
                                                
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   k
                                                
                                             
                                             (
                                             S
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                             -
                                             
                                                
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   ˆ
                                                
                                             
                                             )
                                             
                                                
                                                   (
                                                   S
                                                   (
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                   -
                                                   
                                                      
                                                         
                                                            
                                                               y
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                   )
                                                
                                                
                                                   T
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    u
                                 
                                 
                                    k
                                 
                              
                           
                         and 
                           
                              
                                 
                                    w
                                 
                                 
                                    k
                                 
                              
                           
                         are two sets of scalar weights, and L is the number of samples [5]. Both MC and SUT make use of Eq. (3), but differ in the way 
                           
                              {
                              
                                 
                                    x
                                 
                                 
                                    k
                                 
                              
                              }
                           
                         is generated.

In MC, 
                              
                                 {
                                 
                                    
                                       x
                                    
                                    
                                       k
                                    
                                 
                                 }
                              
                            is randomly drawn from 
                              
                                 N
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       ¯
                                    
                                 
                                 ,
                                 
                                    
                                       C
                                    
                                    
                                       x
                                    
                                 
                                 )
                              
                           . 
                              
                                 
                                    
                                       u
                                    
                                    
                                       k
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       w
                                    
                                    
                                       k
                                    
                                 
                              
                            are uniformly set to 
                              
                                 
                                    
                                       1
                                    
                                    
                                       L
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       1
                                    
                                    
                                       L
                                       -
                                       1
                                    
                                 
                              
                           , respectively. However, the simplicity of MC comes with two problems: redundant parametrisations and the computational complexity.

A parametrisation is redundant, when a 
                              
                                 D
                              
                            – dimensional entity is represented by Q parameters, with 
                              
                                 D
                                 <
                                 Q
                              
                            (e.g. a rotation matrix encodes the space of 3 dimensional rotations with 9 parameters: 
                              
                                 D
                                 =
                                 3
                              
                            and 
                              
                                 Q
                                 =
                                 9
                              
                           ). Since there are D degrees-of-freedom, the rank of 
                              
                                 
                                    
                                       C
                                    
                                    
                                       y
                                    
                                 
                              
                            is at most D. However, MC does not enforce this constraint, and, the rank could be as high as Q. This issue can be remedied by converting the estimated parameters to a D-dimensional, minimal representation, as discussed in Section 3.

The computational complexity of MC is proportional to L, the number of samples in 
                              
                                 {
                                 
                                    
                                       x
                                    
                                    
                                       k
                                    
                                 
                                 }
                              
                           . However, accurate estimates of 
                              
                                 
                                    
                                       y
                                    
                                    
                                       ¯
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       C
                                    
                                    
                                       y
                                    
                                 
                              
                            often require a large L 
                           [11]. Therefore, in terms of computational complexity, MC is usually impractical as a covariance estimator. However, since 
                              
                                 
                                    
                                       lim
                                    
                                    
                                       L
                                       →
                                       ∞
                                    
                                 
                                 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       y
                                    
                                 
                                 (
                                 L
                                 )
                                 =
                                 
                                    
                                       C
                                    
                                    
                                       y
                                    
                                 
                              
                           , for sufficiently large L, it is considered a good approximation to the true statistics [5,7,11].

SUT deterministically generates 
                              
                                 {
                                 
                                    
                                       x
                                    
                                    
                                       k
                                    
                                 
                                 }
                              
                            as a 
                              
                                 L
                                 =
                                 2
                                 M
                                 +
                                 1
                              
                            element sample set, for an 
                              
                                 M
                                 ×
                                 1
                              
                            measurement vector [16]. Specifically, for the Cholesky decomposition
                              
                                 (4)
                                 
                                    
                                       
                                          C
                                       
                                       
                                          x
                                       
                                    
                                    =
                                    Ψ
                                    
                                       
                                          Ψ
                                       
                                       
                                          T
                                       
                                    
                                    ,
                                 
                              
                           the corresponding 
                              
                                 {
                                 
                                    
                                       x
                                    
                                    
                                       k
                                    
                                 
                                 }
                              
                            is constructed as [23]
                           
                              
                                 (5)
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      1
                                                   
                                                
                                                =
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      k
                                                      +
                                                      1
                                                   
                                                
                                                =
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                                +
                                                
                                                   
                                                      
                                                         
                                                            α
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      (
                                                      M
                                                      +
                                                      κ
                                                      )
                                                   
                                                
                                                
                                                   
                                                      Ψ
                                                   
                                                   
                                                      k
                                                   
                                                
                                                ,
                                                
                                                k
                                                =
                                                1
                                                …
                                                M
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      k
                                                      +
                                                      1
                                                      +
                                                      M
                                                   
                                                
                                                =
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                                +
                                                
                                                   
                                                      
                                                         
                                                            α
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      (
                                                      M
                                                      +
                                                      κ
                                                      )
                                                   
                                                
                                                
                                                   
                                                      Ψ
                                                   
                                                   
                                                      k
                                                   
                                                
                                                ,
                                                
                                                k
                                                =
                                                1
                                                …
                                                M
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 
                                    
                                       Ψ
                                    
                                    
                                       k
                                    
                                 
                              
                            denotes the kth row of the Cholesky factor 
                              
                                 Ψ
                              
                           . α and κ are two scaling parameters, controlling the spread of 
                              
                                 {
                                 
                                    
                                       x
                                    
                                    
                                       k
                                    
                                 
                                 }
                              
                            around 
                              
                                 
                                    
                                       x
                                    
                                    
                                       ¯
                                    
                                 
                              
                           .

The weights 
                              
                                 
                                    
                                       u
                                    
                                    
                                       k
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       w
                                    
                                    
                                       k
                                    
                                 
                              
                            are calculated as follows [23]:
                              
                                 (6)
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      1
                                                   
                                                
                                                =
                                                1
                                                -
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      
                                                         
                                                            α
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      (
                                                      M
                                                      +
                                                      κ
                                                      )
                                                   
                                                
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      1
                                                   
                                                
                                                =
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                (
                                                1
                                                -
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                β
                                                )
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      k
                                                   
                                                
                                                =
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      k
                                                   
                                                
                                                =
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                      
                                                         
                                                            α
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      (
                                                      M
                                                      +
                                                      κ
                                                      )
                                                   
                                                
                                                ,
                                                
                                                k
                                                =
                                                2
                                                …
                                                (
                                                2
                                                M
                                                +
                                                1
                                                )
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           where β is a parameter used to incorporate prior information about known higher order statistics.

Julier and Uhlmann [16] and Merwe et al. [23] discusses the selection of 
                              
                                 α
                                 ,
                                 κ
                              
                            and β, and suggest optimal values for 
                              
                                 x
                                 ∼
                                 N
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       ¯
                                    
                                 
                                 ,
                                 
                                    
                                       C
                                    
                                    
                                       x
                                    
                                 
                                 )
                              
                            (i.e. the case of interest for this work):
                              
                                 •
                                 Merwe et al. [23] states that 
                                       
                                          κ
                                          ⩾
                                          0
                                       
                                     guarantees a positive semi-definite 
                                       
                                          
                                             
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      ^
                                                   
                                                
                                             
                                             
                                                y
                                             
                                          
                                       
                                    , however the specific value is not critical. Therefore, it recommends 
                                       
                                          κ
                                          =
                                          0
                                       
                                    .


                                    α should be in 
                                       
                                          [
                                          0
                                          ,
                                          1
                                          ]
                                       
                                    . Merwe et al. [23] recommends a small value when the transformation (i.e. S) is highly nonlinear.

It is important that 
                                       
                                          {
                                          
                                             
                                                x
                                             
                                             
                                                k
                                             
                                          
                                          }
                                       
                                     accurately characterises the distribution of 
                                       
                                          x
                                       
                                    . When 
                                       
                                          x
                                          ∼
                                          N
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                ¯
                                             
                                          
                                          ,
                                          
                                             
                                                C
                                             
                                             
                                                x
                                             
                                          
                                          )
                                       
                                    , the moments of 
                                       
                                          {
                                          
                                             
                                                x
                                             
                                             
                                                k
                                             
                                          
                                          }
                                       
                                     and 
                                       
                                          x
                                       
                                     match up to the 3rd order [16]. Setting 
                                       
                                          
                                             
                                                u
                                             
                                             
                                                1
                                             
                                          
                                          =
                                          1
                                          -
                                          
                                             
                                                M
                                             
                                             
                                                3
                                             
                                          
                                       
                                     ensures a match in some of the 4th order moments [16]. It is also shown in [16] that 
                                       
                                          β
                                          =
                                          2
                                       
                                     minimises the error in the 4th order moments.

If 
                                       
                                          κ
                                          =
                                          0
                                          ,
                                          
                                          
                                             
                                                u
                                             
                                             
                                                1
                                             
                                          
                                          =
                                          1
                                          -
                                          
                                             
                                                M
                                             
                                             
                                                3
                                             
                                          
                                       
                                     implies that 
                                       
                                          α
                                          =
                                          
                                             
                                                
                                                   
                                                      3
                                                   
                                                   
                                                      M
                                                   
                                                
                                             
                                          
                                       
                                     (Eq. (6)).

Therefore, throughout the paper, we follow the recommendations for the Gaussian case, and set 
                              
                                 κ
                                 =
                                 0
                                 ,
                                 
                                 α
                                 =
                                 
                                    
                                       
                                          
                                             3
                                          
                                          
                                             M
                                          
                                       
                                    
                                 
                              
                            and 
                              
                                 β
                                 =
                                 2
                              
                           . We specifically indicate the cases where a smaller α is chosen due to the nonlinearity of the solver.

The computational cost of SUT is 
                              
                                 2
                                 M
                                 +
                                 1
                              
                            evaluations of S (as opposed to 
                              
                                 2
                                 M
                              
                            of FOP), plus the Cholesky decomposition of an 
                              
                                 M
                                 ×
                                 M
                              
                            matrix. However, under the assumption of independent measurements, 
                              
                                 
                                    
                                       C
                                    
                                    
                                       x
                                    
                                 
                              
                            is either diagonal, or block-diagonal with 
                              
                                 2
                                 ×
                                 2
                              
                            and 
                              
                                 3
                                 ×
                                 3
                              
                            submatrices; therefore, the cost of the Cholesky decomposition is negligible.

The formulation in Section 2 is not suitable for all minimal geometry solvers covered in this paper. Below is a presentation of the solver-specific issues, and implementation guidelines. Since all cases involve either image-image (2D–2D), or image-scene (2D–3D) correspondences as input, 
                        
                           
                              
                                 x
                              
                              
                                 ¯
                              
                           
                        
                      is formed by concatenating the individual coordinates. The dimensionalities of the measurement and the parameter space are presented in Table 1
                     .

In order to maintain the focus on covariance estimation, we choose to omit a detailed discussion of the solvers. However, each section provides the relevant references for the interested reader, and a brief exposition is included in Appendix A. Unless otherwise stated, the parameters for SUT are set to the values mentioned in Section 2.2, and those for the minimal solvers, to the defaults recommended by the original authors.

2-Point triangulation (T2) solver estimates the 3D coordinates of a scene point, given its 2D projections on the image planes of two known cameras. The solver we employ is the optimal triangulation algorithm [11]. 
                           
                              y
                           
                         is the triangulated scene point. The application of SUT and FOP is straightforward: it only requires the computation of the 3D points corresponding to the various perturbations of the original pair of image points (as discussed in Section 2).

An epipolar relation 
                           
                              Y
                           
                         defines a constraint of type 
                           
                              
                                 
                                    p
                                 
                                 
                                    T
                                 
                              
                              Yr
                              =
                              0
                           
                        , and describes the epipolar geometry between the images to which the image correspondence 
                           
                              (
                              p
                              ;
                              r
                              )
                           
                         belongs [11]. When the internal calibration parameters are unknown, 
                           
                              Y
                           
                         is the fundamental matrix, and can be estimated via the 8-point (F8),
                           1
                           The 8-point algorithm is not a true minimal solver, as it does not use all available constraints.
                        
                        
                           1
                         or the 7-point (F7) method, which involves 8 and 7 image correspondences, respectively [11]. Otherwise, one solves for the essential matrix from 5 image correspondences (E5), via [19].


                        
                           
                              Y
                           
                        , being a 3×3 matrix, is a redundant representation of the underlying entity: a fundamental matrix has 7 degrees of freedom, whereas an essential matrix has only 5. In order to avoid a singular covariance matrix, 
                           
                              Y
                           
                         must be reparametrised by a minimal representation.

A 7-element minimal parametrisation for fundamental matrix can be obtained through the singular value decomposition (SVD) of 
                           
                              Y
                           
                        , as proposed in [25]: given the decomposition 
                           
                              Y
                              =
                              
                                 
                                    USV
                                 
                                 
                                    T
                                 
                              
                              ,
                              
                              U
                           
                         and 
                           
                              V
                           
                         are rotation matrices, each of which can be encoded by a 3-parameter axis-angle vector. Since a non-degenerate fundamental matrix must be of rank-2, 
                           
                              S
                           
                         is a diagonal matrix with two non-zero entries. However, since 
                           
                              Y
                           
                         is a homogeneous entity, i.e. 
                        
                           
                              Y
                              ≡
                              c
                              Y
                              
                              ∀
                              c
                              ∈
                              R
                              ⧹
                              {
                              0
                              }
                           
                        , it can be scaled so that the largest singular value is 1. Therefore, a fundamental matrix can be represented by 2 axis-angle vectors and a scalar. Computation of the sample statistics of parametrisations with a rotation component is discussed in Section 3.4.

A non-degenerate essential matrix can be decomposed into a rotation matrix, and a rank-2 skew-symmetric matrix representing a unit-norm translation vector [11]. This decomposition forms the basis of a minimal representation: similar to the fundamental matrix case, the rotation component can be represented by 3 parameters, as an axis-angle vector. The translation component is a vector on the 3D unit sphere, and therefore, can be encoded by its azimuth and elevation angles. When the elevation is 
                           
                              ±
                              
                                 
                                    π
                                 
                                 
                                    2
                                 
                              
                           
                        , the azimuth can take any arbitrary value, which is chosen as 0.

The epipolar geometry case poses an additional challenge to SUT and FOP: both methods assume that S is a one-to-one transformation. However, the solutions to the F7 and E5 algorithms are the roots of a 3rd and a 10th degree polynomial, respectively: there could be as many solutions as the real roots. We identified two strategies for such one-to-many solvers:
                           
                              •
                              All solutions satisfy the epipolar constraint for 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                 . However, barring degeneracies, only one can represent the epipolar geometry between the images. Therefore, a small set of additional matches can be used as a validation set, to identify the correct solution. This approach, effectively, makes a one-to-many solver one-to-one.

Alternatively, one can estimate a separate covariance for each solution. However, it may not be obvious with which covariance a solution should be associated. Moreover, the number of real solutions may vary for different perturbations of 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                 .

In practice, often the epipolar geometry is estimated from a redundant set of correspondences; therefore, in our experiments, we chose the former approach.

This class of problems aims to find a mapping 
                           
                              Y
                           
                         that satisfies the projective equality relation 
                           
                              p
                              ≈
                              Yr
                           
                         for a homogeneous point correspondence 
                           
                              (
                              p
                              ;
                              r
                              )
                           
                        . 
                           
                              Y
                           
                         is estimated via the normalised direct linear transform algorithm (DLT) [11]. The instances we study are resectioning (i.e. projective camera matrix estimation) from 6 scene-image correspondences (P6P), and 2D homography from 4 image correspondences (H4).

Since 
                           
                              Y
                           
                         is a homogeneous transformation, identifying 
                           
                              y
                           
                         with the elements of 
                           
                              Y
                           
                         leads to a redundant parametrisation, and a singular covariance matrix. Begelfor and Werman [27] proposes to mitigate this problem by characterising the uncertainty as a Lie-normal distribution. Although this distribution has a functional form that is superficially similar to a Gaussian, we deem it outside of the scope of this paper, which is limited to the covariance estimation, i.e. Gaussian characterisations. A more relevant, and common non-redundant representation involves the removal of the redundancy via a projection to a plane tangent to the unit sphere at the vector representation of 
                           
                              Y
                           
                         
                        [11,24]. Despite its success in 2D- and 3D-point cases [24], in our experiments, due to numerical issues, this approach occasionally resulted in rank-deficient covariance matrices: Fig. 1
                         depicts the rank histogram for the H4 and P6P problems for a set of covariance matrices computed via the procedure described in Section 4.1.1 (steps 1–3), by using the parameter set N1 (Table 3) and the MC technique. As shown in Table 1, the rank of valid covariance matrices for H4 and P6P are 8 and 11, respectively.

An alternative representation for H4 is inspired by the fundamental matrix case, discussed in Section 3.2: a homography can be decomposed into two rotations and two scalars, obtained via the SVD of the homography matrix. Unlike a fundamental matrix, there is no rank constraint for a homography matrix. Therefore, the scalars are the second and the third largest singular values, which are normalised with the largest singular value.

As for the P6P, a projective camera matrix can be decomposed into a set of intrinsic and extrinsic parameters [11]. Although this may yield an improbable camera, with skew and aspect ratio exhibiting significant deviations from 0 and 1, respectively, the decomposition is an algebraically valid minimal representation.

Both alternative parametrisations are equivalent to their “tangent-plane” counterparts, in that they represent the same entity. However, due to the numerical issues, they differ in their suitability for the covariance estimation problem: Fig. 1 indicates that, unlike the “tangent-plane” parametrisation [24], the decomposition-based parametrisations effectively mitigate the rank-deficiency problem. It should be noted that, since both methods operate on the same data, the observed difference cannot be explained by a degeneracy in the homographies involved.

Upon decomposition, FOP and SUT can be employed without any issues, to obtain a full-rank 
                           
                              
                                 
                                    
                                       
                                          C
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    y
                                 
                              
                           
                        .

A calibration estimator utilises the projective equality relation 
                           
                              p
                              ≈
                              Y
                              (
                              K
                              ,
                              r
                              )
                           
                         between the scene-image correspondence pair 
                           
                              (
                              r
                              ;
                              p
                              )
                           
                        , induced by the projection operator Y, to recover K, the unknown internal and/or external calibration parameters. What K represents defines a sequence of progressively more difficult problems: 2-point orientation (P2P) [14]; 2-point orientation and focal length (P2Pf) [14]; 3-point orientation and position (P3P) [10,13]; and 4-point orientation, position, focal length and lens distortion coefficient (P4P) [15] (Table 2
                        ). All solvers except for P2P involve polynomial equations of varying degrees, hence yield multiple real solutions (up to 2, 4 and 12, respectively). There are two more issues specific to the calibration estimation problem: sample statistics of the orientation component, and the selection of α (Eq. (6)).

Consider the P2P case, where the only output is the orientation. The use of Eq. (3) is not appropriate, as neither 
                           
                              
                                 
                                    
                                       
                                          y
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    ˆ
                                 
                              
                           
                        , nor 
                           
                              S
                              (
                              
                                 
                                    x
                                 
                                 
                                    k
                                 
                              
                              )
                              -
                              
                                 
                                    
                                       
                                          y
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    ˆ
                                 
                              
                           
                         is guaranteed to represent a valid rotation. Instead, 
                           
                              
                                 
                                    
                                       
                                          y
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    ˆ
                                 
                              
                           
                         can be calculated as [18]
                        
                           
                              (7)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   q
                                                
                                                
                                                   k
                                                
                                             
                                             =
                                             S
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   ˆ
                                                
                                             
                                             =
                                             arg
                                             
                                             
                                                
                                                   
                                                      min
                                                   
                                                   
                                                      q
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                             
                                                
                                                   u
                                                
                                                
                                                   k
                                                
                                             
                                             ‖
                                             R
                                             (
                                             
                                                
                                                   q
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                             -
                                             R
                                             (
                                             q
                                             )
                                             
                                                
                                                   ‖
                                                
                                                
                                                   F
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              q
                           
                         and 
                           
                              
                                 
                                    q
                                 
                                 
                                    k
                                 
                              
                           
                         are quaternions, 
                           
                              R
                              (
                              q
                              )
                           
                         is the rotation matrix corresponding to 
                           
                              q
                           
                        , and 
                           
                              ‖
                              ·
                              
                                 
                                    ‖
                                 
                                 
                                    F
                                 
                              
                           
                         is the Frobenius norm operator. As for the covariance, the difference quaternion is computed by inverse-rotation, and then converted to the axis-angle representation, to obtain a non-singular covariance [17]:
                           
                              (8)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   k
                                                
                                             
                                             =
                                             A
                                             (
                                             
                                                
                                                   q
                                                
                                                
                                                   k
                                                
                                             
                                             ⊗
                                             
                                                conj
                                             
                                             (
                                             
                                                
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   ˆ
                                                
                                             
                                             )
                                             )
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         ^
                                                      
                                                   
                                                
                                                
                                                   y
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                
                                                   a
                                                
                                                
                                                   k
                                                
                                             
                                             
                                                
                                                   a
                                                
                                                
                                                   k
                                                
                                                
                                                   T
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        In (8), ⊗ denotes the quaternion multiplication operator and 
                           
                              conj
                              (
                              ·
                              )
                           
                        , the quaternion conjugate. A converts a quaternion to an axis-angle vector.

In other solvers, in which the orientation is only a part of the output, the mean orientation and 
                           
                              {
                              
                                 
                                    a
                                 
                                 
                                    k
                                 
                              
                              }
                           
                        , the set of orientation differences, are computed separately, and concatenated to the other components (e.g. focal length in P2P, and position vector in P3P) for use in Eq. (3). Since 
                           
                              
                                 
                                    u
                                 
                                 
                                    k
                                 
                              
                           
                         must be non-negative [18], 
                           
                              α
                              =
                              1
                           
                        .

Another issue with α stems from the smoothness of the manifold on which 
                           
                              
                                 
                                    x
                                 
                                 
                                    ¯
                                 
                              
                           
                         reside. α determines the magnitude of the perturbations. If the manifold is smooth, the perturbed points remain on the manifold. However, in some cases, the perturbation may result in an 
                           
                              x
                           
                        , for which no real solution exists. In our experience, only P4P is susceptible to this problem, which can be mitigated by picking smaller α.

@&#EXPERIMENTAL RESULTS@&#

The performance of SUT and FOP are compared against the true covariance, estimated via MC, by generating random problem instances on synthetic data. The following procedure is repeated 1000 times for P4P, and 10,000 times for the other solvers (due to the high computational cost of P4P):
                              
                                 1.
                                 Randomly generate 1–2 cameras, and a number of scene points, as dictated by the problem type (Table 4). For H4, project the points on a random plane.

For E5, F7, P2Pf, P3P and P4P problems, generate 3 scene points for the validation set. As discussed in Section 3, this is necessary to identify the correct solution, in the case of multiple solutions.

Find the ground-truth correspondences (
                                       
                                          
                                             
                                                x
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                    ) by projecting the scene points to the camera(s) (Table 4).

Estimate the true covariance 
                                       
                                          
                                             
                                                C
                                             
                                             
                                                y
                                             
                                          
                                       
                                     via MC, by generating 1000 random perturbations to 
                                       
                                          
                                             
                                                x
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                    , representing the noise (i.e. 
                                    
                                       
                                          L
                                          =
                                          1000
                                       
                                    ).

Estimate the covariance 
                                       
                                          
                                             
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      ^
                                                   
                                                
                                             
                                             
                                                y
                                             
                                          
                                       
                                     by SUT and FOP, from the input distribution 
                                       
                                          N
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                ¯
                                             
                                          
                                          ,
                                          
                                             
                                                C
                                             
                                             
                                                x
                                             
                                          
                                          )
                                       
                                     (Table 3
                                    ).

Evaluate the quality of the SUT and FOP estimates.

The variables governing the problem generation are reported in Tables 3 and 4
                           . Scene is the dimensions of the volume containing the scene points. The cameras are located at the centre of this region, within the subvolume defined by Camera (Fig. 2
                           ). Lens distortion is applied only in the P4P case. In order to evaluate the performance, 3 distinct scene and camera configurations that represent typical real capture conditions are considered: an indoor studio (Indoor), an outdoor scene viewed by wide-baseline cameras (OWB), and an outdoor scene with narrow-baseline cameras (ONB). The main difference between these scenarios is the camera baseline (i.e. inter-camera distances relative to the size of the scene), which is largest for Indoor, and smallest for ONB. The scene noise is higher for OWB and ONB, to reflect the loss of accuracy in localisation of distant points. The parameters of Indoor are used to generate 3 more datasets, N1, N4 and N9, corresponding to different levels of noise.

The problem generation process described above follows the established practice in the minimal geometry estimation field, and therefore, do not attempt to detect degenerate set-ups explicitly at the problem generation stage [15,28]. However, if the set-up is
                              
                                 •
                                 truly degenerate, which is indicated by the failure of 
                                       
                                          S
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                ¯
                                             
                                          
                                          )
                                       
                                    , or,

near-degenerate, which is indicated by the failure of 
                                       
                                          S
                                          (
                                          ·
                                          )
                                       
                                     for a member of 
                                       
                                          {
                                          x
                                          }
                                       
                                    , i.e. one of the perturbed versions of 
                                       
                                          
                                             
                                                x
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                    .

FOP and SUT cannot be computed. In such a case, the problem instance is discarded, and a new one is generated. We choose not to impose an artificial “near-degeneracy prevention” mechanism, like a threshold, beyond the above procedure: if 
                              
                                 S
                                 (
                                 ·
                                 )
                              
                            can be computed at and around 
                              
                                 
                                    
                                       x
                                    
                                    
                                       ¯
                                    
                                 
                              
                           , even though it may involve a difficult case, we take this sufficient proof that the set-up is valid, and therefore, suitable for covariance estimation. Considering the parameter ranges (Table 3) and the number of experiments, we believe that any pathological cases that might slip through would be too few in number to affect the robust statistics we employ to evaluate the performance (Section 4.1.2).

The accuracy of a covariance estimate is quantified by its Kullback–Leibler (KL) divergence from its true value. For the purposes of divergence calculation only, the mean for all estimators is set to 
                              
                                 
                                    
                                       y
                                    
                                    
                                       ¯
                                    
                                 
                                 =
                                 S
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       ¯
                                    
                                 
                                 )
                              
                           , i.e. the maximum-likelihood estimate of the output. This facilitates a fair comparison of FOP and SUT as covariance estimators. The divergence of the estimated distribution 
                              
                                 N
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       ¯
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       y
                                    
                                 
                                 )
                              
                            from the true distribution 
                              
                                 N
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       ¯
                                    
                                 
                                 ,
                                 
                                    
                                       C
                                    
                                    
                                       y
                                    
                                 
                                 )
                              
                            can be expressed as [20]
                           
                              
                                 (9)
                                 
                                    P
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             trace
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  C
                                                               
                                                               
                                                                  ^
                                                               
                                                            
                                                         
                                                         
                                                            y
                                                         
                                                         
                                                            -
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            y
                                                         
                                                      
                                                   
                                                
                                             
                                             -
                                             ln
                                             det
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  C
                                                               
                                                               
                                                                  ^
                                                               
                                                            
                                                         
                                                         
                                                            y
                                                         
                                                         
                                                            -
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            y
                                                         
                                                      
                                                   
                                                
                                             
                                             -
                                             D
                                          
                                       
                                    
                                    ,
                                 
                              
                           where D is the size of the covariance matrix (also, dim(y) in Table 1). The unit of divergence is nats, which is approximately 1.44bits.

@&#RESULTS@&#


                           Fig. 3
                            presents the performance of FOP and SUT under various noise conditions, as a box-and-whisker diagram of the distribution of P. The order statistics depicted in the plots are the 5th, 25th, 50th, 75th and 95th percentiles. The mean is marked with a square, when it is within the range of the y-axis. The results indicate that SUT is superior to FOP for all solvers, with the exception of T2, where a performance parity is observed. Furthermore, SUT yields an accurate estimate of the true covariance, especially in problems with low output dimensionality (Table 1), i.e. T2, E5, P2P, P2Pf and P3P, over the entire noise range.

The poor performance of FOP seems to stem from ill-conditioned covariance estimates, which leads to very large entries in 
                              
                                 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       y
                                    
                                 
                              
                           : the determinant term in Eq. (9) is attenuated by the logarithmic scaling, however, when 
                              
                                 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       y
                                    
                                 
                              
                            is ill-conditioned, the trace of 
                              
                                 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             ^
                                          
                                       
                                    
                                    
                                       y
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 
                                    
                                       C
                                    
                                    
                                       y
                                    
                                 
                              
                            tends to reach extreme values. On the other hand, a well-conditioned, but inaccurate covariance estimate is likely to result in a more modest divergence value, which can be observed in most of the low dimensionality problems (up to and including P3P). In contrast, SUT regularly achieves accurate covariance estimates, especially in the N1 case. Conditioning is a major issue only in H4. However, the 95th percentile and the mean values suggest that, with the exception of P2P and T2, SUT might occasionally yield ill-conditioned estimates. Still, the range of problem instances that can be successfully handled by SUT is much wider than that of FOP, as the results clearly demonstrate.

For both methods, the quality of the estimated covariance is generally better in problems with lower parameter space dimensionalities (Table 1), and problems involving scene-image correspondences. The former reflects the link between the dimensionality and the complexity of the parameter space: in higher dimensionality problems, the sampling pattern employed by SUT may be less suitable for a good statistical characterisation. The latter might be due to the fact that a coordinate error of 1 pixel and 1cm are not necessarily equally detrimental to the quality of the output. However, the median value of P for SUT remains relatively small across the entire problem set, whereas FOP achieves similar values only for T2 and P2P.

With the exception of 2-point problems (T2, P2P and P2Pf), the increasing noise variance deteriorates the performance, which is manifested as a larger median divergence, and a wider spread (Fig. 3 and Table 5
                           ). However, it leaves the clear superiority of SUT over FOP intact. The degradation in FOP is less distinguishable, as the already-poor performance is dominated by the aforementioned conditioning issue. As for SUT, within the 25th–75th percentile range, and in lower dimensionality problems, the impact of the noise is small. P4P and P6P suffer a relatively mild degradation, whereas in H4, F8 and F7, higher noise levels imply a significant rise in divergence.

In problems involving 2 cameras (T2, H4 and epipolar geometry estimation), a narrow baseline (i.e. ONB case) accentuates the nonlinearities, and undermines the Gaussianity assumption. Fig. 4
                            quantifies the associated loss in performance. As expected, the quality of the covariance estimates decreases with the decreasing baseline, i.e. Indoor is the best, and ONB is the worst performance case. However, unlike FOP, SUT proves to be a reliable estimator in Indoor and OWB configurations, and, in certain problems (T2 and E5), even in ONB. The impact of baseline on the performance is more pronounced than that of the noise, especially in the fundamental matrix problems, F7 and F8. The only exception is T2, which exhibits a remarkable robustness to decreasing baseline, both in FOP and SUT.

Finally, Fig. 5
                            depicts the distribution of the divergence for 1-camera problems (P6P and calibration estimation) at different scene configurations, i.e. Indoor and OWB. Despite the higher scene noise, the results are generally similar, with SUT retaining its superiority over FOP. This suggests that the scene size has a limited effect on the performance, and the quality of the covariance estimates is primarily determined by the image noise.

The performance of FOP and SUT on real data is compared via the camera calibration pipeline presented in [14] (Fig. 6
                        ). The algorithm recovers the unknown internal and external calibration parameters of a moving (principal) camera, which shares a field-of-view with a number of static witness cameras. This is a common set-up in film production, where accurate registration of the principal camera with the witness cameras is essential for many post-production and special effects tasks [14]. The calibration process is as follows:
                           
                              1.
                              
                                 Given: Known calibration parameters for the principal camera (e.g. focal length for metric calibration or camera position for a nodal motion), full calibration parameters for the witness cameras.

Build a sparse 3D scene model from the 2D image feature correspondences observed in the static witness cameras (Fig. 8).

For each frame acquired by the moving camera
                                    
                                       (a)
                                       Establish scene-image correspondences.

Depending on whether the principal camera is static or moving, or the focal length is known, solve the appropriate minimal geometry problem to recover the missing calibration parameters (Table 2).

Feed the resulting calibration measurement to a Kalman filter for jitter removal.

Read the current calibration estimate of the principal camera off the state of the Kalman filter.

The state of the Kalman filter includes the unknown calibration parameters, which, depending on the problem type, may include some or all of orientation, position, lens distortion and focal length (Table 2), and their rates of change (e.g. rotation, translation, distortion change rate and zoom rate). Sample images from the principal camera sequences are presented in Fig. 7
                        . The camera set-up, the scene model, and the recovered trajectory for Odzemok are illustrated in Fig. 8
                        .

A Kalman filter requires an indicator of the reliability of each measurement, in the form of a covariance matrix. The measurement covariance has a significant influence on the state vector (
                           
                              
                                 
                                    s
                                 
                                 
                                    ¯
                                 
                              
                           
                        ) and its covariance (
                           
                              
                                 
                                    C
                                 
                                 
                                    s
                                 
                              
                           
                        ) through the Kalman gain matrix [16]. The real data experiment compares the Gaussian representing the state, 
                           
                              N
                              (
                              
                                 
                                    s
                                    ,
                                    
                                       
                                          C
                                       
                                       
                                          s
                                       
                                    
                                 
                                 
                                    ¯
                                 
                              
                              )
                           
                        , when the measurement covariance is estimated via FOP, SUT and MC. As in the synthetic data experiments, the state computed from the MC estimates of the measurement acts as the ground-truth, 
                           
                              N
                              (
                              
                                 
                                    s
                                 
                                 
                                    ¯
                                 
                              
                              ,
                              
                                 
                                    C
                                 
                                 
                                    s
                                 
                              
                              )
                           
                        . The Kullback–Leibler divergence of 
                           
                              N
                              (
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    ˆ
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          C
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    s
                                 
                              
                              )
                           
                        , the FOP- or SUT-based state, from the true state is [20]
                        
                           
                              (10)
                              
                                 P
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          trace
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               C
                                                            
                                                            
                                                               ^
                                                            
                                                         
                                                      
                                                      
                                                         s
                                                      
                                                      
                                                         -
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  s
                                                               
                                                               
                                                                  ¯
                                                               
                                                            
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      ^
                                                   
                                                
                                             
                                             
                                                s
                                             
                                             
                                                -
                                                1
                                             
                                          
                                          (
                                          
                                             
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                ˆ
                                             
                                          
                                          -
                                          
                                             
                                                s
                                             
                                             
                                                ¯
                                             
                                          
                                          )
                                          -
                                          ln
                                          det
                                          (
                                          
                                             
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      ^
                                                   
                                                
                                             
                                             
                                                s
                                             
                                             
                                                -
                                                1
                                             
                                          
                                          
                                             
                                                C
                                             
                                             
                                                s
                                             
                                          
                                          )
                                          -
                                          D
                                       
                                    
                                 
                                 .
                              
                           
                        
                        Fig. 9
                         illustrates the order statistics of the divergence for FOP and SUT, over the 125-frame sequences used in [14] (the experiments Unicycle1, Unicycle2, Odzemok and Juggler, respectively). The results are in agreement with the synthetic data experiments: SUT outperforms FOP, and yields a very accurate estimate of the state (and its uncertainty) for P2P, P2Pf and P3P. FOP, despite being a clearly inferior alternative, still provides acceptable results for P2P and P2Pf.

@&#CONCLUSION@&#

Like most computer vision algorithms, minimal geometry solvers deal with uncertain inputs, therefore, any output representation without a measure of the associated uncertainty is incomplete. A common representation of the uncertainty is covariance, whose utility is linked to its accuracy. However, the reliability of first-order forward propagation, the most common covariance estimator, is known to suffer in nonlinear problems, which is the case for minimal geometry solvers.

Scaled unscented transformation is a covariance estimator whose superiority to FOP is already established in control and robotics literature [16,12] for nonlinear transformations. Encouraged by its success in a related field, in this paper, we study the effectiveness of SUT as an alternative to FOP for minimal geometry solvers. To this aim, we first explain how SUT can be implemented for a collection of common solvers, highlight the practical problems for each solver, and propose solutions. Then, we compare SUT and FOP against the estimates of the true covariance by synthetic and real data experiments, through Kullback–Leibler divergence. Both experiments indicate the superiority of SUT over FOP as a covariance estimator, over a number of different noise and scene conditions. Moreover, the covariance estimates of SUT are usually highly accurate and in general, exhibit a better robustness to noise, compared to FOP. Both estimators suffer a severe performance deterioration under narrow baseline conditions (ONB), however, SUT still performs reasonably well for E5 and T2 (Fig. 4). Finally, when employed in Kalman filtering, the use of SUT for computing the measurement covariance matrices yields an accurate estimate of the state and its uncertainty, which is significantly better than that obtained through FOP.

We conclude that, SUT is a better technique than FOP for covariance estimation, offering a considerable performance advantage at effectively no additional computational cost.

@&#ACKNOWLEDGMENTS@&#

This work is supported by the TSB Projects “i3Dlive: interactive 3D methods for live-action media (TP/11/CII/6/I/AJ307D)”, “SyMMM: Synchronising Multimodal Metadata” (CRD 101033) and the European Commission FP7 Project “IMPART: Intelligent Management Platform for Advanced Real-Time Media Processes” (FP7-ICT 316564).

A detailed discussion of the minimal solvers is beyond the scope of this paper. However, in the interest of self-containedness, we believe a short summary, as provided below, would be helpful.

Consider the camera matrices, 
                           
                              
                                 
                                    P
                                 
                                 
                                    p
                                 
                              
                           
                         and 
                           
                              
                                 
                                    P
                                 
                                 
                                    r
                                 
                              
                           
                        , and the homogeneous 2D points 
                           
                              p
                           
                         and 
                           
                              r
                           
                         on their respective image planes. The T2 solver estimates the coordinates of the 3D point, whose projections through the camera matrices yield a pair 
                           
                              {
                              
                                 
                                    p
                                 
                                 
                                    ′
                                 
                              
                              ;
                              
                                 
                                    r
                                 
                                 
                                    ′
                                 
                              
                              }
                           
                        , closest to 
                           
                              {
                              p
                              ;
                              r
                              }
                           
                         in the Euclidean sense [11].


                        
                           
                              
                                 
                                    P
                                 
                                 
                                    p
                                 
                              
                           
                         and 
                           
                              
                                 
                                    P
                                 
                                 
                                    r
                                 
                              
                           
                         define the fundamental matrix 
                           
                              
                                 
                                    F
                                 
                                 
                                    rp
                                 
                              
                           
                        . The solver seeks 
                           
                              {
                              
                                 
                                    p
                                 
                                 
                                    ′
                                 
                              
                              ;
                              
                                 
                                    r
                                 
                                 
                                    ′
                                 
                              
                              }
                           
                         which exactly satisfies the epipolar constraint 
                           
                              
                                 
                                    p
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    F
                                 
                                 
                                    rp
                                 
                              
                              r
                              =
                              0
                           
                        , while minimising the objective function 
                           
                              ∑
                              ‖
                              
                                 
                                    p
                                 
                                 
                                    ′
                                 
                              
                              -
                              p
                              
                                 
                                    ‖
                                 
                                 
                                    2
                                 
                              
                              +
                              ‖
                              
                                 
                                    r
                                 
                                 
                                    ′
                                 
                              
                              -
                              r
                              
                                 
                                    ‖
                                 
                                 
                                    2
                                 
                              
                           
                        , by solving a 6th degree polynomial [11]. The epipolar constraint ensures that the projection rays linking the camera centres of 
                           
                              
                                 
                                    P
                                 
                                 
                                    p
                                 
                              
                           
                         and 
                           
                              
                                 
                                    P
                                 
                                 
                                    r
                                 
                              
                           
                         to the points 
                           
                              
                                 
                                    p
                                 
                                 
                                    ′
                                 
                              
                           
                         and 
                           
                              
                                 
                                    r
                                 
                                 
                                    ′
                                 
                              
                           
                         intersect at a 3D point, which is the solution to the 2-view triangulation problem.

This class of problems involves the estimation of a fundamental or an essential matrix, from a set of 2D image correspondences 
                           
                              {
                              
                                 
                                    p
                                 
                                 
                                    k
                                 
                              
                              ;
                              
                                 
                                    r
                                 
                                 
                                    k
                                 
                              
                              }
                           
                        . The solution is a 3×3 matrix 
                           
                              Y
                           
                        , which satisfies the epipolar constraint 
                           
                              
                                 
                                    p
                                 
                                 
                                    T
                                 
                              
                              Yr
                              =
                              0
                           
                        , for 
                           
                              {
                              
                                 
                                    p
                                 
                                 
                                    k
                                 
                              
                              ;
                              
                                 
                                    r
                                 
                                 
                                    k
                                 
                              
                              }
                           
                         
                        [11]. Since 
                           
                              Y
                           
                         is a rank-2 matrix, 
                           
                              det
                              Y
                              =
                              0
                           
                         
                        [11]. An essential matrix offers one more constraint: 
                           
                              Y
                           
                         satisfies the equation 
                           
                              2
                              
                                 
                                    YY
                                 
                                 
                                    T
                                 
                              
                              Y
                              -
                              trace
                              (
                              
                                 
                                    YY
                                 
                                 
                                    T
                                 
                              
                              )
                              Y
                              =
                              0
                           
                         
                        [19].

For each correspondence, the epipolar constraint provides a relation linear in the elements of 
                           
                              Y
                           
                        . These equations can be stacked into a system of the form 
                           
                              A
                              θ
                              =
                              0
                           
                        , where 
                           
                              θ
                           
                         is the elements of 
                           
                              Y
                           
                         reordered into a vector. 
                           
                              θ
                           
                         is a linear combination of the basis vectors of 
                           
                              Θ
                           
                        , the nullspace of 
                           
                              A
                           
                         (with the condition that 
                           
                              ‖
                              θ
                              ‖
                              =
                              1
                           
                        , which disqualifies the zero-vector as a solution). The solvers differ in their ways to estimate 
                           
                              Y
                           
                         from 
                           
                              Θ
                           
                        .


                        8-point fundamental matrix estimation: F8 utilises 8 correspondences, therefore 
                           
                              θ
                           
                         is the sole basis vector of 
                           
                              Θ
                           
                        . The determinant constraint is enforced post hoc, by removing the component corresponding to the smallest singular value [11].


                        7-point fundamental matrix estimation: In the case of F7, 
                           
                              A
                           
                         is a 7×9 matrix, and 
                           
                              Θ
                           
                         has two elements, 
                           
                              
                                 
                                    θ
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    θ
                                 
                                 
                                    2
                                 
                              
                           
                        . Therefore, the solution is of the form 
                           
                              
                                 
                                    θ
                                 
                                 
                                    1
                                 
                              
                              +
                              ψ
                              
                                 
                                    θ
                                 
                                 
                                    2
                                 
                              
                           
                        . The determinant constraint provides a polynomial equation cubic in ψ, whose real roots yield up to 3 solutions [11].


                        5-point essential matrix estimation: E5 requires 5 correspondences, and 
                           
                              A
                           
                         has a 4-dimensional nullspace. Therefore, 
                           
                              θ
                              =
                              
                                 
                                    ψ
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    θ
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 
                                    ψ
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    θ
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    ψ
                                 
                                 
                                    3
                                 
                              
                              
                                 
                                    θ
                                 
                                 
                                    3
                                 
                              
                              +
                              
                                 
                                    θ
                                 
                                 
                                    4
                                 
                              
                           
                        . Nister [19] utilises the determinant and the trace constraints to build 10 cubic polynomial equations in 
                           
                              
                                 
                                    ψ
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    ψ
                                 
                                 
                                    2
                                 
                              
                           
                         and 
                           
                              
                                 
                                    ψ
                                 
                                 
                                    3
                                 
                              
                           
                        , which are, then, solved via Grobner basis techniques. The real solutions of the polynomial system yield up to 10 essential matrices.

Homography estimation problems deal with the estimation of a matrix 
                           
                              Y
                           
                        , for a set of correspondences 
                           
                              {
                              
                                 
                                    p
                                 
                                 
                                    k
                                 
                              
                              ;
                              
                                 
                                    r
                                 
                                 
                                    k
                                 
                              
                              }
                           
                         satisfying the projective equality relation 
                           
                              p
                              ≈
                              Yr
                           
                        . This algebraic constraint can be expressed as 
                           
                              
                                 
                                    p
                                 
                                 
                                    ×
                                 
                              
                              Yr
                              =
                              0
                           
                        , where 
                           
                              
                                 
                                    p
                                 
                                 
                                    ×
                                 
                              
                           
                         is a skew symmetric matrix, determined by the problem type [11,29]. Each such relation yields two equations linear in the elements of 
                           
                              Y
                           
                         which, similar to Appendix A.2, can be stacked into the form 
                           
                              A
                              θ
                              =
                              0
                           
                        . The scale of 
                           
                              θ
                           
                         is fixed by the constraint 
                           
                              ‖
                              θ
                              ‖
                              =
                              1
                           
                        .


                        4-point homography estimation: Estimation of a 3×3 homography matrix 
                           
                              Y
                           
                         relating the homogeneous 2D points requires 4 correspondences. Therefore, 
                           
                              A
                           
                         is an 8×9 matrix, nullspace of which is 
                           
                              Y
                           
                         
                        [11].


                        6-point camera matrix estimation: A projective camera matrix can be regarded as a 3×4 homography, and can be estimated from 6 2D–3D correspondences. Since 6 correspondences provide 12 equations, 
                           
                              A
                           
                         is full-rank, and the solution is the singular vector corresponding to the minimum singular value of 
                           
                              A
                           
                         
                        [30].

A 3D point can be parametrised by the line segment linking it to the camera centre. In the camera reference frame (where the camera centre is at the origin), for a 2D–3D correspondence 
                           
                              {
                              p
                              ;
                              
                                 
                                    r
                                 
                                 
                                    ′
                                 
                              
                              }
                           
                        , this line segment is a function of the focal length, 
                           
                              ‖
                              
                                 
                                    r
                                 
                                 
                                    ′
                                 
                              
                              ‖
                           
                         and the image point 
                           
                              p
                           
                        . The mapping between the camera and the world reference frames is an isometry, under which distances between pairs of points are preserved. Therefore, 
                           
                              ‖
                              
                                 
                                    r
                                 
                                 
                                    ′
                                 
                              
                              ‖
                           
                         can be computed as the distance between the camera centre and 
                           
                              r
                           
                        , the corresponding 3D point in the world reference frame. The P2P, P2Pf and P3P solvers leverage this observation, as described below.


                        2-point orientation estimation: The P2P solver [14] estimates the orientation component of a camera matrix from two 2D–3D correspondences, 
                           
                              {
                              
                                 
                                    p
                                 
                                 
                                    k
                                 
                              
                              ;
                              
                                 
                                    r
                                 
                                 
                                    k
                                 
                              
                              }
                           
                        , when the camera centre and the intrinsic calibration parameters are available. The known camera centre allows the computation of the distances 
                           
                              ‖
                              
                                 
                                    r
                                 
                                 
                                    k
                                 
                                 
                                    ′
                                 
                              
                              ‖
                           
                        , and the known focal length, the direction of the line segments (i.e. the back-projection ray). Therefore, for each 
                           
                              r
                           
                        , the corresponding 
                           
                              
                                 
                                    r
                                 
                                 
                                    ′
                                 
                              
                           
                         in the camera reference frame can be computed. Two such correspondences are sufficient to compute the orientation of the camera [31].


                        2-point orientation and focal length estimation: The P2Pf solver, proposed in [14] estimates the focal length and the orientation of a camera, given a pair of 2D–3D correspondences and the camera centre. The algorithm estimates up to two focal lengths, and then recovers the associated orientations via P2P. In order to set up a constraint on the focal length, first, the cosine of the angle between the projection rays of the correspondences is computed, by applying the cosine law on the triangle defined by the camera centre and the 3D points. This is equal to the dot product of the projection rays, which can be expressed as a quadratic function of the square of the unknown focal length. The constraint can be expressed as a polynomial equation, with up to two positive solutions.


                        3-point orientation and position: The P3P algorithm [10] estimates the orientation and the position of a camera from 3 2D–3D correspondences, given the focal length. Its solution strategy involves locating the 3D points in the camera frame, and then recovering the Euclidean transformation to the world reference frame (via, e.g. 
                        [13]). Since the direction of the projection rays can be established from the 2D–3D correspondences, the problem can be cast as the estimation of 3 distances to the camera centre. Observing that the distances between the 3D points are available, application of the cosine law on each triangle involving two of the 3D points and the camera centre yields 3 quadratic constraints. The resulting equation system is solved by computing the roots of a cubic polynomial, which yields up to 3 solutions [10].

The P4P problem involves the estimation of the pose, focal length and lens distortion of a camera from 4 2D–3D correspondences. Josephson and Byröd [15] utilises the projection equation which links each correspondence 
                           
                              {
                              p
                              ;
                              r
                              }
                           
                         as
                           
                              (A.1)
                              
                                 λ
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   μ
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  p
                                                               
                                                               
                                                                  1
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  p
                                                               
                                                               
                                                                  2
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 Y
                                 (
                                 K
                                 )
                                 r
                                 ,
                              
                           
                        where 
                           
                              Y
                              (
                              K
                              )
                           
                         is the camera calibration matrix defined by the calibration parameters 
                           
                              K
                              ,
                              μ
                           
                         is the lens distortion coefficient, and λ is a projective scaling factor. By a suitable choice of coordinate system, the translation and the focal length parameters can be expressed in terms of the orientation quaternion. λ is eliminated by multiplying Eq. (A.1) by a skew symmetric matrix on the left, similar to Appendix A.3. The resulting polynomial equation system is solved via Grobner basis techniques, yielding up to 12 solutions.

In practice, the computation of Kullback–Leibler divergence (Eq. (9)) could be problematic, as the estimated covariance matrices could be ill-conditioned. If the invertibility of a covariance estimate is of secondary importance, relative Frobenius norm difference can be employed as an alternative, algebraic measure, i.e.
                     
                        
                           (B.1)
                           
                              
                                 
                                    P
                                 
                                 
                                    al
                                 
                              
                              =
                              
                                 
                                    ‖
                                    
                                       
                                          
                                             
                                                C
                                             
                                             
                                                ^
                                             
                                          
                                       
                                       
                                          y
                                       
                                    
                                    -
                                    
                                       
                                          C
                                       
                                       
                                          y
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          F
                                       
                                    
                                 
                                 
                                    ‖
                                    
                                       
                                          C
                                       
                                       
                                          y
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          F
                                       
                                    
                                 
                              
                              ,
                           
                        
                     where 
                        
                           
                              
                                 C
                              
                              
                                 y
                              
                           
                        
                      is the estimate of the ground truth (via MC), 
                        
                           
                              
                                 
                                    
                                       C
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 y
                              
                           
                        
                      is the covariance estimate (via FOP or SUT), and 
                        
                           ‖
                           ·
                           
                              
                                 ‖
                              
                              
                                 F
                              
                           
                        
                      is the Frobenius norm operator.

The synthetic data experiments in Section 4.1.2 are repeated with the algebraic error metric. The results, depicted in Figs. B.1–B.3
                     
                     
                     , are consistent with those in Section 4.1.2. The only deviations are in P6P, P2Pf and P4P cases, where there appears to be a parity in performance. This can be explained by observing that, as indicated in Sections 3.3 and 3.4, focal length is one of the elements in the minimal parametrisations employed by P6P, P2Pf, and P4P. Also, Table 3 shows that the value of focal length is up to 3 orders of magnitude larger than the orientation and the position parameters. Therefore, the covariance term corresponding to the focal length dominates Eq. (B.1), and any errors on the remaining entries of 
                        
                           
                              
                                 
                                    
                                       C
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 y
                              
                           
                        
                      become negligible. The experiments for the P2P and P3P cases, whose parametrisations employ only the extrinsic calibration terms, show that the error terms suppressed by the relatively large magnitude of the focal length are, in fact, non-trivial. On the other hand, the inversion operation in Eq. (9) effectively performs a magnitude normalisation.

Despite the emphasis of Eq. (9) on invertibility, and of Eq. (B.1) towards fidelity in higher-magnitude entries, taken together, they paint a clear picture: with the exception of the 2-view triangulation case (where FOP performs similarly to SUT), SUT is superior to FOP.

As discussed in Section 2.2, MC and SUT differ in the way the samples are generated: MC uses a large number of random samples, whereas SUT, a smaller number of deterministic samples. In this section, we present experimental results for a variant of MC which employs random sampling, but generates only as many samples as SUT (henceforth, MC2).

The experimental setup follows the procedure described in Section 4.1.1. The new experiment involves the generation of 
                        
                           {
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                           }
                        
                      via Monte-Carlo sampling, however, with 
                        
                           L
                           =
                           2
                           M
                           +
                           1
                        
                     , i.e. the same number of samples as SUT. The estimated covariance is evaluated via the Kullback–Leibler divergence and the relative Frobenius norm. The experiment is performed only for the N1 case, as the performance of MC2 does not encourage further experiments on other cases, which present more challenging conditions: as Figs. C.1 and C.2
                     
                      depict, MC2 is inferior to both FOP and SUT.

A comparison of the sampling strategies of MC, SUT and FOP is helpful to explain the poor performance of MC2. A successful propagation of covariance is possible only if the sample statistics of 
                        
                           {
                           
                              
                                 x
                              
                              
                                 k
                              
                           
                           }
                        
                      is a good characterisation of the uncertainty of 
                        
                           x
                        
                     . As discussed in Section 2.2, MC achieves this by employing a large number of points, whose sample statistics, in the limit, converge to the true covariance, 
                        
                           
                              
                                 C
                              
                              
                                 x
                              
                           
                        
                     . SUT deterministically selects a small number of points, in a way that matches the first three moments of 
                        
                           x
                        
                     . FOP perturbs the measurement vector along each coordinate axis, to generate a symmetric lattice around it. However, MC2 cannot guarantee an accurate characterisation as,
                        
                           •
                           it employs too few samples, therefore, unlike MC does not offer a representative sampling of the uncertainty volume, and the underlying density function,

it employs random sampling, which cannot provide the theoretical guarantees enjoyed by SUT, achieved via a careful placement of samples.

The deficiencies of MC2 in sample generation leads to an erroneous 
                        
                           
                              
                                 
                                    
                                       C
                                    
                                    
                                       ^
                                    
                                 
                              
                              
                                 y
                              
                           
                        
                     , and a poor performance.

@&#REFERENCES@&#

