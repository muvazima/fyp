@&#MAIN-TITLE@&#Quantitative assessment of corneal vibrations during intraocular pressure measurement with the air-puff method in patients with keratoconus

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We showed how corneal vibrations could be automatically measured.


                        
                        
                           
                           We measured vibration parameters for large inter-individual variability in patients.


                        
                        
                           
                           We confirms the usefulness of the proposed method in this type of classification.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Air-puff

Corvis ST tonometer

High-speed deformation

Keratoconus

Image processing

measurement automation

Vibrations

@&#ABSTRACT@&#


               
               
                  Background
                  One of the current methods for measuring intraocular pressure is the air-puff method. A tonometer which uses this method is the Corvis device. With the ultra-high-speed (UHS) Scheimpflug camera, it is also possible to observe corneal deformation during measurement. The use of modern image analysis and processing methods allows for analysis of higher harmonics of corneal deflection above 100Hz.
               
               
                  Method
                  493 eyes of healthy subjects and 279 eyes of patients with keratoconus were used in the measurements. For each eye, 140 corneal deformation images were recorded during intraocular pressure measurement. Each image was recorded every 230µs and had a resolution of 200×576 pixels. A new, original algorithm for image analysis and processing has been proposed. It enables to separate the eyeball reaction as well as low-frequency and high-frequency corneal deformations from the eye response to an air puff. Furthermore, a method for classification of healthy subjects and patients with keratoconus based on decision trees has been proposed.
               
               
                  Results
                  The obtained results confirm the possibility to distinguish between patients with keratoconus and healthy subjects. The features used in this classification are directly related to corneal vibrations. They are only available in the proposed software and provide specificity of 98%, sensitivity-85%, and accuracy-92%. This confirms the usefulness of the proposed method in this type of classification that uses corneal vibrations during intraocular pressure measurement with the Corvis tonometer.
               
               
                  Discussion
                  With the new proposed algorithm for image analysis and processing allowing for the separation of individual features from a corneal deformation image, it is possible to: automatically measure corneal vibrations in a few characteristic points of the cornea, obtain fully repeatable measurement of vibrations for the same registered sequence of images and measure vibration parameters for large inter-individual variability in patients.
               
            

@&#INTRODUCTION@&#

Keratoconus is one of the diseases of the cornea characterized by changes in its structure [1,2]. These changes usually lead to thinning and excessive bulging of the cornea [3]. As a result, there occurs a change in the corneal curvature [4,5]. The cornea takes a conical shape, which in turn causes visual difficulties [6]. Keratoconus is the most common corneal dystrophy. It has no ethnic restrictions and is not directly related to the degree of progress of civilisation [7,8]. The disease is relatively unknown, has indeterminate etiology and its course is difficult to predict. Due to corneal thinning, it also has an impact on changes in the biomechanical properties of the cornea. It should be visible in a special way in the sequence of corneal deformation images during intraocular pressure measurement using the air-puff method, e.g. when performing measurement with the Corvis tonometer [9–11]. The methods of image analysis and processing enable to determine the position of inner and outer contours of the cornea when measuring its deformation [12]. It is also possible to separate from the eye response to an air puff: the eyeball reaction, low-frequency (≤100Hz) and high-frequency (>100Hz) corneal reactions [13–18]. The eyeball reaction is dependent on the response of musculi bulbi oculi [15]. The left eye reacts differently in comparison with the right one [16,17]. These reactions are so characteristic that on their basis it is possible to say with almost 100% certainty which eye (left or right) is being examined [18,19]. Extremely low-frequency corneal deformations are primarily three characteristic moments: the time of the first applanation (temporary flattening of the cornea), the maximum corneal deformation, the time of the second applanation [20]. High-frequency corneal reactions (>100Hz), hereinafter referred to as vibrations, and their relationship with diseases of the cornea are currently being addressed by ophthalmologists [1,2]. The connection between vibrations of the cornea (its parameters) with keratoconus and an attempt to classify healthy subjects and patients are presented below.

493 eyes of healthy subjects and 279 eyes of patients with keratoconus were used in the measurements. For each eye, I=140 corneal deformation images were recorded during intraocular pressure measurement. Each image was recorded every 230 µs and had a resolution M×N=200×576 pixels, which gave the pixel size of 16.5×15.7µm. Healthy subjects gave informed consent for examinations and in the case of children the consent was obtained from their legal guardians. The examinations of ill patients were from routine medical examinations carried out at the Instituto de Olhos Renato Ambrósio, Rio de Janeiro. All tests were performed in accordance with the Declaration of Helsinki. Healthy subjects and patients ranged in age from 16 to 89 years, 58% of them were women. They had no history of any other type of condition and, above all, any other eye diseases. Diagnosis of keratoconus was made based on placido disk-based axial topography, elevation-derived anterior corneal curvature maps, [21] and according to the criteria used in the collaborative longitudinal evaluation of Keratoconus study [22]. Keratoconus cases with a history of corneal surgery or with extensive corneal scarring were excluded from the study.

@&#METHOD@&#

The method of image analysis and processing proposed in this paper is fully automatic and provides reproducible and quantitative results. The proposed method has been divided into 3 phases:
                        
                           •
                           image pre-processing and detection of the outer corneal contour,

detection of corneal vibrations,

selection of features necessary to classify patients.

Image pre-processing involved image acquisition from the Corvis tonometer, filtration, detection of the outer corneal edge and then separation of individual components: constant component, eyeball reaction and corneal deformation. In the second phase, corneal vibrations in a few specific areas in the two axes of the coordinate system (rows and columns of the image matrix) are analysed. In the final stage, characteristic features of keratoconus are selected and a classifier in the form of discriminant analysis and decision trees is proposed. The illustrative diagram of measurement and analysis is shown in 
                     Fig. 1. The phases of the proposed image analysis and processing method and the selection of features and classification are described in detail in the following sub-sections.

The algorithm proposed in this paper is designed for analysis of a sequence of images from the Corvis ST tonometer (OCULUS Optikgeräte GmbH, Germany). The sequence of images may be read from the following files: *.u12, *.avi or *.jpg. In each case, it will be a sequence of i images L
                        
                           GRAY
                        (m,n) for i∈(1,I). The first stage of analysis involves median filtering with a mask h sized M
                        
                           h
                        ×N
                        
                           h
                        =200×576 pixels. The image L
                        
                           M
                        (m,n) resulting from median filtering is normalised to the image L
                        
                           W
                        (m,n). Then, this image (L
                        
                           W
                        (m,n)) is analysed in terms of the position of maximum values for each of the columns, i.e.:
                           
                              (1)
                              
                                 
                                    
                                       L
                                       K
                                    
                                    
                                       (
                                       n
                                       )
                                    
                                    =
                                    
                                       min
                                       m
                                    
                                    
                                       L
                                       T
                                    
                                    
                                       (
                                       m
                                       ,
                                       n
                                       )
                                    
                                 
                              
                           
                        
                     

where:
                           
                              (2)
                              
                                 
                                    
                                       L
                                       T
                                    
                                    
                                       (
                                       m
                                       ,
                                       n
                                       )
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                n
                                             
                                             
                                                if
                                             
                                             
                                                
                                                   (
                                                   
                                                      L
                                                      W
                                                   
                                                   
                                                      (
                                                      m
                                                      +
                                                      1
                                                      ,
                                                      n
                                                      )
                                                   
                                                   −
                                                   
                                                      L
                                                      W
                                                   
                                                   
                                                      (
                                                      m
                                                      ,
                                                      n
                                                      )
                                                   
                                                   )
                                                
                                                >
                                                
                                                   p
                                                   r
                                                
                                             
                                          
                                          
                                             
                                                N
                                             
                                             
                                                other
                                             
                                             
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

and
                           
                              (3)
                              
                                 
                                    
                                       
                                          L
                                       
                                       
                                          W
                                       
                                    
                                    
                                       (
                                       
                                          
                                             m
                                          
                                          
                                             ,
                                          
                                          
                                             n
                                          
                                       
                                       )
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             
                                                L
                                             
                                             
                                                M
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   m
                                                
                                                
                                                   ,
                                                
                                                
                                                   n
                                                
                                             
                                             )
                                          
                                          
                                             −
                                          
                                          
                                             
                                                min
                                             
                                             
                                                
                                                   m
                                                
                                                
                                                   ,
                                                
                                                
                                                   n
                                                
                                             
                                          
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   M
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      ,
                                                   
                                                   
                                                      n
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                                max
                                             
                                             
                                                
                                                   m
                                                
                                                
                                                   ,
                                                
                                                
                                                   n
                                                
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   
                                                      
                                                         L
                                                      
                                                   
                                                   
                                                      
                                                         M
                                                      
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         ,
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   )
                                                
                                                
                                                   −
                                                
                                                
                                                   
                                                      
                                                         min
                                                      
                                                   
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         ,
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            L
                                                         
                                                      
                                                      
                                                         
                                                            M
                                                         
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            ,
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     

for m∈(1,M−1).

Due to normalisation, the value of the threshold p
                        
                           r
                         can be constant. For the analysed cases and the best obtained results (90% of correct detections of the outer contour) it is 0.2.

The resulting contour L
                        
                           k
                        (n) is further approximated with a polynomial of degree three. The polynomial degree was chosen arbitrarily on the basis of analysis of possible corneal deformations and anthropometric constraints. Consequently, a sequence of 140 2D images L
                        
                           GRAY
                        (m,n) gives an image L
                        
                           E
                        (n,i). An example of the image L
                        
                           E
                        (n,i) is shown in 
                        Fig. 2a.

The image L
                        
                           E
                        (n,i) presented in Fig. 2a is the basis for further analysis.

The image L
                        
                           E
                        (n,i) is subjected to further transformations. The first of them is separation of the eyeball reaction. For this purpose, the extreme (beginning and end) columns of the image L
                        
                           E
                        (n,i), i.e. for n∈(1,10) and n∈(N−9,N), are analysed. This analysis involves calculating the straight line passing through two points of coordinates (m
                        
                           P
                        (i)
                           ,
                        
                        n
                        
                           P
                        (i)) and (m
                        
                           K
                        (i)
                           ,
                        
                        n
                        
                           K
                        (i)) which are designated as follows:
                           
                              (4)
                              
                                 
                                    
                                       
                                          m
                                       
                                       
                                          P
                                       
                                    
                                    
                                       (
                                       
                                          i
                                       
                                       )
                                    
                                    
                                       =
                                    
                                    
                                       
                                          1
                                       
                                       
                                          
                                             10
                                          
                                       
                                    
                                    
                                       ∑
                                       
                                          
                                             n
                                          
                                          
                                             =
                                             1
                                          
                                       
                                       
                                          10
                                       
                                    
                                    
                                       
                                          
                                             L
                                          
                                          
                                             E
                                          
                                       
                                       
                                          (
                                          
                                             
                                                n
                                             
                                             
                                                ,
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (5)
                              
                                 
                                    
                                       
                                          m
                                       
                                       
                                          K
                                       
                                    
                                    
                                       (
                                       
                                          i
                                       
                                       )
                                    
                                    
                                       =
                                    
                                    
                                       
                                          1
                                       
                                       
                                          
                                             10
                                          
                                       
                                    
                                    
                                       ∑
                                       
                                          
                                             n
                                          
                                          
                                             =
                                          
                                          
                                             N
                                          
                                          
                                             −
                                             9
                                          
                                       
                                       
                                          N
                                       
                                    
                                    
                                       
                                          
                                             L
                                          
                                          
                                             E
                                          
                                       
                                       
                                          (
                                          
                                             
                                                n
                                             
                                             
                                                ,
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                    
                                 
                              
                           
                        
                     

and n
                        
                           P
                        (i) as well as n
                        
                           K
                        (i) are constant for each i-th measurement and are 1 and N respectively. The next step involves calculating parameters of the image L
                        
                           EB
                        (n,i) being the eyeball reaction, i.e.:
                           
                              (6)
                              
                                 
                                    
                                       
                                          L
                                       
                                       
                                          EB
                                       
                                    
                                    
                                       (
                                       
                                          
                                             n
                                          
                                          
                                             ,
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             
                                                m
                                             
                                             
                                                K
                                             
                                          
                                          
                                             (
                                             
                                                i
                                             
                                             )
                                          
                                          
                                             −
                                          
                                          
                                             
                                                m
                                             
                                             
                                                P
                                             
                                          
                                          
                                             (
                                             
                                                i
                                             
                                             )
                                          
                                       
                                       
                                          
                                             
                                                n
                                             
                                             
                                                K
                                             
                                          
                                          
                                             (
                                             
                                                i
                                             
                                             )
                                          
                                          
                                             −
                                          
                                          
                                             
                                                n
                                             
                                             
                                                P
                                             
                                          
                                          
                                             (
                                             
                                                i
                                             
                                             )
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             n
                                          
                                          
                                             −
                                          
                                          
                                             
                                                n
                                             
                                             
                                                P
                                             
                                          
                                          
                                             (
                                             
                                                i
                                             
                                             )
                                          
                                       
                                       )
                                    
                                    
                                       +
                                    
                                    
                                       
                                          m
                                       
                                       
                                          P
                                       
                                    
                                    
                                       (
                                       
                                          i
                                       
                                       )
                                    
                                 
                              
                           
                        
                     

for n
                        
                           P
                        (i)≠n
                        
                           K
                        (i).

The obtained results are shown in Fig. 2b. In the next stage, the corneal deformation L
                        
                           EC
                        (n,i) is calculated as:
                           
                              (7)
                              
                                 
                                    
                                       
                                          L
                                       
                                       
                                          EC
                                       
                                    
                                    
                                       (
                                       
                                          
                                             n
                                          
                                          
                                             ,
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       =
                                    
                                    
                                       
                                          L
                                       
                                       
                                          E
                                       
                                    
                                    
                                       (
                                       
                                          
                                             n
                                          
                                          
                                             ,
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       −
                                    
                                    
                                       
                                          L
                                       
                                       
                                          EB
                                       
                                    
                                    
                                       (
                                       
                                          
                                             n
                                          
                                          
                                             ,
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        
                     

For about 99% of cases, both eyes and the subsequent analysed columns, the values of L
                        
                           EC
                        (n,i) are greater than zero. This is due to the adopted method for calculating the coordinates (m
                        
                           P
                        (i)
                           ,
                        
                        n
                        
                           P
                        (i)) and (m
                        
                           K
                        (i)
                           ,
                        
                        n
                        
                           K
                        (i)). On the basis of the image L
                        
                           EC
                        (n,i), the vibration L
                        
                           EV
                        (n,i)) is calculated as:
                           
                              (8)
                              
                                 
                                    
                                       
                                          L
                                       
                                       
                                          EV
                                       
                                    
                                    
                                       (
                                       
                                          
                                             n
                                          
                                          
                                             ,
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       =
                                    
                                    
                                       
                                          L
                                       
                                       
                                          EC
                                       
                                    
                                    
                                       (
                                       
                                          
                                             n
                                          
                                          
                                             ,
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                    
                                       −
                                    
                                    
                                       
                                          1
                                       
                                       
                                          
                                             ∑
                                             
                                                
                                                   j
                                                
                                                
                                                   =
                                                   1
                                                
                                             
                                             
                                                J
                                             
                                          
                                          
                                             
                                                ∑
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      =
                                                      1
                                                   
                                                
                                                
                                                   K
                                                
                                             
                                             
                                                
                                                   h
                                                
                                                
                                                   (
                                                   
                                                      
                                                         j
                                                      
                                                      
                                                         ,
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    
                                       ∑
                                       
                                          
                                             j
                                          
                                          
                                             =
                                             −
                                          
                                          
                                             J
                                          
                                          
                                             /
                                             2
                                          
                                       
                                       
                                          
                                             J
                                          
                                          
                                             /
                                             2
                                          
                                       
                                    
                                    
                                       
                                          ∑
                                          
                                             
                                                k
                                             
                                             
                                                =
                                                −
                                             
                                             
                                                K
                                             
                                             
                                                /
                                                2
                                             
                                          
                                          
                                             
                                                K
                                             
                                             
                                                /
                                                2
                                             
                                          
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      L
                                                   
                                                
                                                
                                                   
                                                      EC
                                                   
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      −
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      ,
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      −
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             
                                                ∙
                                             
                                             
                                                h
                                             
                                             
                                                (
                                                
                                                   
                                                      j
                                                   
                                                   
                                                      ,
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                          
                                          )
                                       
                                    
                                 
                              
                           
                        
                     

where h – mask sized J×K=31×31 pixels.

The mask size was selected based on the image-recording frequency (every 230µs) and the frequency limit of 100Hz allowing for the distinction between low-frequency and high-frequency (vibrations) corneal deformations. The frequency limit of 100Hz was based on observation and previous measurements presented in papers [16,18]. It should be noted that the frequency of 100Hz stems also from the upper frequency limit of the musculi bulbi oculi response (no more than 100Hz). The thus obtained image L
                        
                           EV
                        (n,i) is shown in Fig. 2d. Based on the images L
                        
                           EV
                        (n,i) and L
                        
                           M
                        (m,n) as well as L
                        
                           GRAY
                        (m,n) for i∈(1,I), features and the method of classification of healthy subjects and patients with keratoconus are further proposed.

Classification of healthy subjects and patients with keratoconus will be carried out on the basis of vibration analysis results. The results presented in the previous section will be enhanced with additional vibration analysis. It will involve measurements made at different locations of the outer corneal contour. 
                        Fig. 3 shows the measuring points of corneal vibrations (v
                        
                           g
                        , v
                        
                           ur
                         and v
                        
                           ul
                         as well as v
                        
                           br
                         and v
                        
                           bl
                        ) during intraocular pressure measurement for a healthy subject (for i=76). Fig. 3 shows 5 selected measuring points: v
                        
                           g
                        -the place of the maximum corneal deformation, v
                        
                           ur
                         and v
                        
                           ul
                        -the place of the maximum corneal curvature during the maximum deformation as well as v
                        
                           br
                         and v
                        
                           bl
                         – the boundary points between the area of deformation and the area of non-deformed cornea.

Based on the image L
                        
                           EV
                        (n,i) obtained for the complete sequence of images i∈(1,I), the following features of corneal vibrations have been defined:
                           
                              
                                 w(1) – the vibration frequency measured for the entire outer corneal contour,


                                 w(2) – the maximum vibration amplitude for the frequency w(1) measured for the entire outer corneal contour,


                                 w(3) – the vibration frequency measured at the point v
                                 
                                    ur
                                  in the axis m,


                                 w(4) – the vibration frequency measured at the point v
                                 
                                    ul
                                  in the axis m,


                                 w(5) – the vibration amplitude measured at the pint v
                                 
                                    ur
                                  in the axis m for the frequency w(3),


                                 w(6) – the vibration amplitude measured at the point v
                                 
                                    ul
                                  in the axis m for the frequency w(4),


                                 w(7) – the difference between the amplitude of the maximum and minimum vibrations measured for the entire outer corneal contour,


                                 w(8) – the maximum corneal deformation measured in the axis m at the point v
                                 
                                    g.
                                 
                              

Sample results, values of individual features, for healthy subjects and patients are shown in


                        
                        Table 1.

The following section presents the results of classification of healthy subjects and patients with keratoconus performed on the basis of the proposed features from w(1) to w(11).

@&#RESULTS@&#


                     Two basic steps of classification have been proposed. The initial stage involved evaluation of the classification quality of healthy subjects and patients for the features commonly available both in the original software of the Corvis tonometer and the proposed algorithm (these will be additional features w(9), w(10) and w(11)). The classification based on discriminant analysis was proposed. In the next step, the quality of classification for the full range of features from w(1) to w(11), including the proposed new features directly related to vibrations, was assessed. In this case, due to the better fit to the data, decision trees were chosen [23,24].


                     In the initial stage of classification, the features of corneal deformation not directly related to its vibration were taken into account. These features were selected from the most characteristic ones for keratoconus. All the features were taken into account, both the ones measured by the Corvis tonometer software and the proposed algorithm, i.e.: IOPnct, Pachymetry, Applanation 1 time, Applanation 1 Length, Applanation 1 Velocity, Applanation 2 time, Applanation 2 Length, Applanation 2 Velocity, Highest Concavity time, Peak distance, Radius, Def., Amp. Max. Based on the results of principal component analysis and factor analysis, three features were selected as the most representative in the classification of healthy subjects and patients with keratoconus. These are:
                        
                           
                              w(9) – applanation 1 length – defined as the length of the deformed cornea during the first applanation,


                              w(10) – intraocular pressure (IOP),


                              w(11) – pachymetry – corneal thickness, measured at the point of the maximum corneal deformation [25].

The values of individual features for healthy subjects (red) and patients (green) are shown on the graph in 
                     Fig. 4. In order to pre-classify healthy subjects and patients using three features (w(9), w(10) and w(11)), discriminant analysis was used, which resulted in a discriminant function. Four different forms of the discriminant function were adopted (abbreviations are derived from the names of the original parameters in Matlab):
                        
                           •
                           linear—linear discriminant analysis,

diaglinear—linear discriminant analysis but with a diagonal covariance matrix estimate (naive Bayes classifiers),

quadratic—quadratic discriminant analysis,

mahalanobis—using the distance Mahalanobis with stratified covariance estimates.

The results for the resubstitution method are shown in 
                     Table 2. The results shown in Table 2 relate to the analysis of 477 ill patients and 269 healthy subjects. The acronyms and abbreviations used in the table stand for: TP-true positive, TN-true negative, FP-false positive and FN – false negative, SPC-specificity, TPR-sensitivity and ACC-accuracy. The number reduced in comparison with the original one (493 healthy subjects and 279 patients with keratoconus) results from the rejection of extreme values and application of the exclusion criteria (false results of image analysis and processing). Discriminant functions are shown in blue in 
                     Fig. 5. When analysing the results presented in Table 2 and Fig. 5, it can be observed that the results of accuracy are very similar for different types of discriminant analysis. Specificity is more than 80%, sensitivity around 77% and accuracy from 79 to 82%. Such small differences between different types of discriminant analysis enable to use in practise the simplest approach, namely linear discriminant analysis.


                     The next classification of healthy subjects and ill patients used the entire range of features from w(1) to w(11). As is apparent from Fig. 5 presented in the previous paragraph, linear discriminant analysis does not allow for a good fit to the data. On the one hand, overfitting is not possible by definition, but on the other hand it seems that the discriminant function should be more complex. For this reason, much better results are obtained in the analysed case for a different classifier type, namely decision trees. Because of the ease in the subsequent implementation and the classifier clarity, binary decision trees were used. CART algorithm was used as a decision tree induction algorithm and the Gini index as a measure of node impurity. A set of 477 ill patients and 269 healthy subjects was divided into the training set (designed to create a complete tree) and the test set (designed to prune the tree) in the proportions of 2/3 and 1/3 (318 and 159 ill patients and 179 and 90 healthy subjects respectively). In the case of decision trees, cross-validation was used as a measure of the quality of classification based on which a decision tree was pruned. A sub-tree characterized by the smallest cross-validation error was chosen during pruning. The impact of subsequent features on the classification quality (SPC, TPR and ACC indicators) was analysed. For this purpose, all combinations of features from w(1) to w(11) were analysed thereby forming 211-1=2047 classifiers. The results obtained for the pruned decision tree are shown in 
                     Table 3.

As is apparent from Table 3, the greatest accuracy in various combinations of all the features (from w(1) to w(11)) was obtained for the features w(3), w(9), w(10) and w(11) (on the basis of Youden Index [26]). In contrast, when limiting the number of features (from w(1) to w(8)), the highest accuracy was obtained for the features w(1), w(3), w(4), w(6) and w(8). The results presented in Table 3 are the result of the random selection of individual data in groups (cross-validation). Therefore, 100 pruned decision trees were created for each possible combination of the features from w(1) to w(11) and for the limited number of features (from w(1) to w(8))-a total of 2·100·(211−1)= 409,400 decision trees. The probability of occurrence of individual features was analysed for the top 10 results (best in terms of ACC). The results of the likelihood of occurrence of each feature are shown in 
                     Fig. 6. The bar graph shown in Fig. 6a indicates the importance (frequency of occurrence) of individual features in the classification process. The predominant feature here is w(5), which is a measure of the vibration amplitude calculated at the point v
                     
                        ur
                      in the axis m for the frequency w(3). On the graph shown in Fig. 6b, the feature w(6), which is a measure of the vibration amplitude calculated at the point v
                     
                        ul
                      in the axis m for the frequency w(4), is most common. Both w(5) and w(6) are directly linked to the corneal vibration (Fig. 3). They relate to the points of maximum curvature visible on both sides of the cornea. The least significant feature (with the lowest frequency of occurrence) is mainly the feature w(11)-Fig. 6a.

@&#DISCUSSION@&#

The obtained results can be compared to other known works and results. This comparison can be made in terms of both classification quality and the applied methods of image analysis and processing.

In the case of classification and analysis of the differences between healthy subjects and patients with keratoconus, the works known from the literature compare the parameters available in the Corvis tonometer. These include, for example, publications [20–29]. In the first one [20], authors compare 12 patients with keratoconus with 12 healthy subjects. They found significant differences in the corneal deformation amplitude and corneal curvature radius. At the same time, they found no statistically significant differences between the two groups as far as the values of Applanation 1 and 2 are concerned. In work [27], authors used a larger population, 44 healthy subjects and 92 patients with keratoconus. Deformation measurement was here associated with Fourier analysis of corneal deformation. The authors proposed a scale of corneal deformation from 1 to 3. Curvature variables were significantly different for normal and diseased eyes and for each grade. Biomechanical variables of normal and diseased eyes differed considerably but were similar for grades 1 and 2. At the same time, the authors confirmed that there was no significant biomechanical difference between mild disease grades, in spite of progressive corneal thinning. In the next paper [28], different types of diseases such as photorefractive keratectomy (PRK) and keratoconus were analysed. The analysis aimed at finding the correlation between corneal biomechanical and morphological data in healthy and diseased eyes. The results obtained by the authors suggest that the corneal curvature has a greater influence on corneal deformation than the central corneal thickness. A similar population was studied in publication [29]-52 keratoconic eyes of 43 patients with keratoconus and 52 normal eyes of 52 healthy subjects. The authors analysed intraclass correlations. Both keratoconic and normal eyes had high intraclass correlation coefficients of the deformation amplitude, peak distance, maximum deformation area and others. The correlation was >0.75. In paper [30], 76 ill patients (and the same number of eyes) were analysed. There was a slight correlation between corneal deformation parameters and corneal morphological parameters as well as the spherical equivalent. A much larger number of patients were used in the study described in work [31]-86 eyes. In this work it was found that the parameters obtainable from the Corvis tonometer cannot be used to diagnose keratoconus. Confirmation of reproducibility of parameters derived from the Corvis tonometer was shown in paper [15]. Both intraocular pressure and central corneal thickness were highly repeatable (intraclass correlation was >0.70, coefficient of variation <0.20). Deformation amplitude and applanation 1 time were fairly repeatable. No association between deformation amplitude and age, sex, or ethnicity was found in healthy eyes. In the other works [32–45], measurements and correlations were performed between healthy subjects and patients with keratoconus. In no case, however, a classifier in the form of decision trees was used. Moreover, the accuracy was not as large as the one obtained in this article with the proposed new method, ACC=92%. Additionally, none of these works took into account the quantitative assessment of corneal vibrations during deformation.


                     Methods of image analysis and processing allow for fully automated and repeatable measurements of corneal deformation parameters and, in particular, vibrations during intraocular pressure measurement [13,16,18,46]. The methods are only one of the possible solutions to the problems of this type. The methods of corneal edge analysis on individual image sequences may be extended. The methods applied here use Prewitt, Sobel [47] or Canny filters [48,49]. Wavelet analysis [50], simple binarization or the active contour method are also applied. The next phase uses methods that enable to adequately detect the proper corneal contour in the cloud of partly detected edges. These are most often methods of approximation, although methods based on the afore-mentioned active contour are also applied here. Analysis of corneal images from the Corvis ST tonometer presents no problems for typical cases [18]. In the case of local brightness changes, it is necessary to correct uneven illumination for the proper contour detection. This adjustment is especially important for the image periphery-the beginnings of the sclera visible in a sequence of images.

@&#SUMMARY@&#

The paper proposes a new method for quantitative evaluation of corneal vibrations during intraocular pressure measurement using an air puff method in patients with keratoconus. A new algorithm and definitions of new parameters (features) associated directly with corneal vibrations have been presented. The paper proposes a method of classification of healthy subjects and patients with keratoconus. Two new, profiled types of classifiers have been created. The first one was based on discriminant analysis and was created on the basis of three features characteristic of keratoconus: Applanation 1 length, IOP, pachymetry. When using the Mahalanobis distance with stratified covariance estimates, the following values were obtained: SPC=86%, TPR=77% and ACC=82%. Due to the need for a more complicated form of the discriminant function, the second classifier based on decision trees was proposed. For the classification of healthy subjects and patients with keratoconus, SPC=98%, TPR=85% and ACC=92% when using features w(3), w(9), w(10), w(11). Considering only the features associated with vibration, the best results were obtained for the features w(1), w(3), w(4), w(6) and w(8): SPC=89%, TPR=87% and ACC=88%. Comparing the results obtained for all classifications (3 classifiers), the best results were obtained for the features characteristic of keratoconus (Applanation 1 length IOP, pachymetry) expanded by the feature directly related to vibration w(3) (ACC=92%). Then, the next worse result is ACC=88% obtained for the features associated only with corneal vibrations. ACC=82% was obtained for the features that are not associated with corneal vibrations. These results show very good classification quality using pruned decision trees and the most significant features of vibrations, namely w(5) and w(6) (Fig. 6).

With the new proposed algorithm for image analysis and processing allowing for the separation of individual features from a corneal deformation image, it is possible to:
                        
                           •
                           automatically measure corneal vibrations in a few characteristic points of the cornea,

obtain fully repeatable measurement of vibrations for the same registered sequence of images,

measure vibration parameters for large inter-individual variability in patients,

use any classifier for the automatic classification of healthy subjects and patients with keratoconus,

automatically assess the impact of individual features, measuring points and vibration types, on the obtained classification results (healthy subject and patient with keratoconus).

In subsequent papers, the authors intend to extend the proposed approach to a different type of diseases modifying the proposed algorithm and set of features in an appropriate manner. In future work, the authors will also aim to assess the impact of accuracy of designating corneal vibration measuring points (Fig. 3) and other acquisition parameters on the classification results.

The authors declare that they have no conflict of interests.

@&#ACKNOWLEDGEMENTS@&#

No outside funding was received for this study.

@&#REFERENCES@&#

