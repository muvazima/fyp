@&#MAIN-TITLE@&#Image fusion of Ultrasound Computer Tomography volumes with X-ray mammograms using a biomechanical model based 2D/3D registration

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           Investigation of patient-specific biomechanical modeling of the breast based on sound speed volume.


                        
                        
                           
                           Model-based 2D/3D registration using a breast compression simulation.


                        
                        
                           
                           Image fusion of X-ray mammograms with quantitative tissue properties.


                        
                        
                           
                           Method for analysis of diagnostic value of Ultrasound Computer Tomography.


                        
                        
                           
                           Evaluation with software phantoms and nine in-vivo datasets.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Image fusion

Image registration

Ultrasound Computer Tomography

X-Ray mammography

Breast imaging

Multimodal diagnosis

@&#ABSTRACT@&#


               
               
                  Ultrasound Computer Tomography (USCT) is a promising breast imaging modality under development. Comparison to a standard method like mammography is essential for further development. Due to significant differences in image dimensionality and compression state of the breast, correlating USCT images and X-ray mammograms is challenging. In this paper we present a 2D/3D registration method to improve the spatial correspondence and allow direct comparison of the images. It is based on biomechanical modeling of the breast and simulation of the mammographic compression. We investigate the effect of including patient-specific material parameters estimated automatically from USCT images. The method was systematically evaluated using numerical phantoms and in-vivo data. The average registration accuracy using the automated registration was 11.9mm. Based on the registered images a method for analysis of the diagnostic value of the USCT images was developed and initially applied to analyze sound speed and attenuation images based on X-ray mammograms as ground truth. Combining sound speed and attenuation allows differentiating lesions from surrounding tissue. Overlaying this information on mammograms, combines quantitative and morphological information for multimodal diagnosis.
               
            

@&#INTRODUCTION@&#

Breast cancer is still one of the most common cancer among women in both the developed and developing countries [1]. Early detection of cancer before a metastatic spread is key to survival [2]. Besides palpation, the method of choice for early breast cancer diagnosis is medical imaging. Currently X-ray mammography is the standard technology used in screening. It provides high resolution projection images of the breast and is broadly available. However, mammography frequently provides poor contrast for tumors located in glandular tissue as both tissues have similar density, limiting the sensitivity in dense breasts [3].

To overcome the drawbacks of X-ray mammography, innovative imaging methods are being developed. Ultrasound Computer Tomography (USCT) is one such promising breast imaging modality, which aims at providing reproducible high resolution 3D images of the undeformed breast without exposing any ionizing radiation to the patient [4]. First systems acquiring multiple 2D slices are being tested in clinical studies [5,6] while a full 3D system is currently undergoing first in-vivo trials [7]. The image acquisition is based on up to several thousand ultrasound transducers, which surround the breast in a water bath. USCT allows simultaneous acquisition of reflection and transmission signals from which three types of images are reconstructed: reflection images, attenuation images and sound speed images. Reflection images reveal changes in the echotexture resulting in the qualitative imaging of tissue surfaces. Attenuation and sound speed images are expected to provide a quantitative tissue characterization [8].

Since USCT is still in development, comparison of the images with the screening method X-ray mammography is of high interest. X-ray mammography images the patient in upright position with the breast compressed between parallel plates to enhance the contrast of the 2D projection image. USCT acquires an image of the patient while lying in prone position with the breast hanging freely into the water bath. Due to the differences in dimensionality and compression state of the breast, the correlation of both imaging methods is challenging. An image registration of both modalities, which overcomes these differences, is therefore likely to improve the correlation of both images. It may assist radiologists in learning to read USCT images as they can be compared to a well known standard method. The registration furthermore allows for an evaluation of the diagnostic value of USCT images, e.g. of quantitative sound speed and attenuation images using X-ray mammograms as ground truth. Finally it makes it possible to combine both imaging methods in a single image for multimodal assessment, either for evaluation or possibly for diagnosis in future.

In this work we developed a registration method based on patient specific biomechanical models of the breast. The method originates from an automated registration for X-ray mammograms and MRI volumes [9]. In preliminary work [10–12] it was successfully applied to in-vivo USCT datasets. In contrast to the previously used breast modeling using constant breast stiffness value for the entire breast model, USCT makes it possible to estimate patient-specific breast stiffness distributions automatically. Compression simulations ignoring the patient-specific tissue distribution result in a homogeneous deformation of the breast and may not reflect stiffness differences in the breast, e.g. of a hard tumor compared to surrounding fatty tissue. In this paper we investigate the effect of including an estimation of the spatial distribution of tissue stiffness properties from USCT images on the compression simulation of the breast. A structured analysis of the effect is carried out with numerical phantoms before the biomechanical modeling is evaluated with in-vivo data. Furthermore the aim of this paper is to summarize and conclude on the proposed overall registration method. Building on the registration method we present a method for analysis of the diagnostic value of USCT images. Additionally an image fusion technique is presented which combines the quantitative USCT imaging with the morphology of X-ray mammograms at a glance for visual evaluation of the USCT imaging capabilities. Results with in-vivo data are illustrated.

2D/3D registrations of X-ray mammograms with 3D volume datasets of the female breast were until now mainly carried out for MRI datasets. Methods include a 2D registration of projected MRI images [13,14], 3D affine transformations [15], using idealized ellipsoidal models of the breast in combination with Finite Element compression simulations [16] and using biomechanical models of the breast [17–22]. None of these methods has been applied to other modalities than MRI. Partly lesion correspondence is used to determine transformation parameters which limits clinical applicability. To the best of our knowledge, the presented approach is the first which was applied to multiple modalities, and especially the first which was applied for the registration of X-ray mammograms with USCT volumes.

@&#METHODS@&#

The challenge for the proposed image registration is that X-ray mammograms are two-dimensional projection images of the breast in a deformed configuration whereas USCT images represent the three-dimensional undeformed breast. The basic idea of our registration approach is to simulate the deformation, which was applied to the breast during X-ray mammography compression, in order to achieve a deformed configuration of the USCT volume. A projection of the deformed USCT volume along the mammographic projection angle is then directly comparable to the X-ray mammogram (Fig. 1
                     ). The deformation of the breast during compression is simulated using a patient-specific biomechanical model, which is built up on the sound speed USCT volume. The simulation is carried out using the Finite Element Method (FEM). The preprocessing of the datasets, the construction of the biomechanical model and the final image registration are presented in the following subsections.

The mammogram is manually cropped anterior to the pectoralis muscle if it is imaged. The mammogram is then segmented into background and breast using thresholding and morphological operations. Afterwards mammograms are downsampled to the resolution of the USCT images, which is typically in the range of 0.5–1.0mm. Rotations are performed to match a consistent coordinate system for alignment of both modalities.

As a basis for the biomechanical modeling, the breast in the USCT images needs to be separated from the water background. This segmentation is based on the sound speed images using an elliptical fitting method to approximate the breast boundary [23]. Partly obvious segmentation errors, e.g. caused by image artifacts, were corrected manually using a freehand tool. The resulting segmentation mask is afterwards applied to all USCT modalities. Finally the volume images are rotated to the registration coordinate system.

Based on the preprocessed sound speed image, the patient-specific biomechanical model is built up. The geometry, i.e. the breast shape, is represented by a three-dimensional mesh which is created by an algorithm [24] based on Delauny triangulation [25] and the CGAL toolbox [26]. The mesh divides the entire sound speed volume into four-node tetrahedrons, each representing a Finite Element (FE). The element size was chosen as trade off between computing time and visual representation of a smooth surface of the breast.

The behavior of the model under compression depends on the underlying material model. We assume the breast tissue to be an incompressible material which is approximated by a Poisson's ratio near 0.5. In our simulations, a value of 0.45 is applied, which is a trade off between simulation convergence and preservation of the breast volume [27]. The stress-strain-relationship of the breast tissue is described by an isotropic hyperelastic neo-hookean material model. For each FE, parameters of the neo-hookean material have to be defined. Different tissue types within the breast are likely to represent different elastic properties. Typically they can be retrieved from the literature [28–32]. A segmentation of the underlying breast image is required to distinguish between tissue types and assign them different elastic parameters, which often involves manual interactions by an expert. Alternatively a homogeneous stiffness distribution throughout the entire breast can be used ignoring any differences in elastic properties. A compression ignoring tissue differences results in a homogeneous deformation of the breast, which contradicts e.g. the preservation of the shape of hard lesion due to their increased stiffness. This results in a deformation of the lesion, which makes the lesion size in a projection image larger, i.e. the lesion is broadened and appears much larger than it would look like in X-ray mammography. In contrast, applying a heterogeneous stiffness distribution model might represent the shape change of tissue structures and lesions better.

Automatic segmentation of tissue types in USCT breast images is challenging and currently not intended during the evaluation phase of the new imaging method. Especially detecting and accurately delineating lesions within the breast is not feasible. A manual segmentation of different tissues would restrict the clinical use of the registration method. However by constructing the biomechanical model based on USCT, we can make use of the physical relationship of sound speed and elastic properties [33]. The sound speed distribution in the breast can be used directly to estimate the Young's modulus E at a particular region of the biomechanical model. The individual Young's modulus for each Finite Element can be calculated from the intensities, i.e. quantitative sound speed c, at the corresponding positions within the sound speed volume by the relationship given in Eq. (1) 
                        [33]. A constant density ρ, taken from literature [34], and a constant Poisson's ratio ν are assumed.


                        
                           
                              (1)
                              
                                 E
                                 =
                                 3
                                 (
                                 
                                    c
                                    2
                                 
                                 ρ
                                 )
                                 (
                                 1
                                 −
                                 2
                                 ν
                                 )
                              
                           
                        
                     

Eq. (1) implies a quadratic relationship between c and E, which results in relatively small changes of the Young's modulus for the small dynamic range of sound speed in breast tissue. In literature often a much higher increase of stiffness from fatty over glandular to tumorous tissue is measured when applying compression on the tissue [28–30]. To account for this behavior, additional stiffness distribution models were developed and included in the present study. The basic idea is to fit an exponential function (Eq. (2)) at supporting points given by the sound speeds c with known or assumed Young's moduli E resulting in the coefficients x
                        1 and x
                        2. Eq. (2) was chosen empirically for its monotonicity and the lowest fit errors for the given data points. A nonlinear least squares fitting was applied.


                        
                           
                              (2)
                              
                                 E
                                 =
                                 
                                    x
                                    1
                                 
                                 ·
                                 
                                    e
                                    
                                       
                                          x
                                          2
                                       
                                       c
                                    
                                 
                              
                           
                        
                     

Two basic concepts resulting in six additional stiffness distribution models are proposed:
                           
                              •
                              Supporting points of the fit were chosen from literature to represent mean sound speed values for fatty tissue (1422m/s), glandular tissue (1487m/s), benign lesion (1513m/s) and malignant lesion (1548m/s) according to Li et al. [35]. E for the corresponding sound speed fit point was chosen from literature as well. In this work we use the values of Wellman et al. [28] (Model 1a), Krouskop et al. [29] (Model 1b) and Samani et al. [30] (Model 1c).

Supporting points of the fit were chosen at 1300m/s and 1600m/s as extreme sound speed values for breast tissue. E at 1300m/s was calculated by Eq. (1) while E at 1600m/s was chosen to be five (Model 2a), ten (Model 2b) and 20 (Model 2c) times higher than at 1300m/s [36].


                        Fig. 2
                         presents the relationship between sound speed and Young's modulus for the proposed models. For comparison, the quadratic relationship model (Eq. (1)) is given as Model 0.

The element-specific Young's modulus is interpolated using the mean sound speed values of voxels inside the element and afterwards converted to the material parameters of the neo-hookean material model of the element.

The effect of the proposed stiffness distribution models on tissue displacements and lesion sizes will be evaluated in Section 3.1 using numerical phantoms before its effect on the registration accuracy is evaluated in Section 3.2 using in-vivo data. In addition to all heterogeneous models, a homogeneous model with a Young's modulus of fatty tissue according to [28] was applied for comparison (Fig. 2).

Based on the biomechanical model, the image registration is carried out in two steps. In the first step, compression plates are modeled, which are positioned and moved according to the given compression direction until the desired amount of compression is achieved. The compression thickness of the breast is retrieved from the mammogram's meta data. Posterior-most nodes of the breast are kept in position in anteroposterior direction to model the fixation of the breast at the chest wall. The deformation of the breast is achieved by solving a contact problem between the breast surface and the compression plates. The simulation is carried out using the FEM software ABAQUS [37] which employs a Newton-Raphson based solver to support large deformations and geometric nonlinearities. The deformation field given by the displacement of the nodes of the biomechanical model is afterwards used to deform the breast within the volume image. A linear interpolation of the displacement for voxels within one element and a bilinear interpolation of the intensity values within the original volume are applied.

After the first simulation step the correct breast compression thickness is achieved, however breast circumferences in the deformed volume image and the mammogram typically do not overlap fully due to simplifications of the deformation process. As such, predeformations due to effects such as skin folding, rolling of the breast in USCT relative to X-ray mammography and manual correction of the breast position during X-ray mammography are not considered as they are unknown from the image and its meta data.

To compensate for these differences we apply a second simulation step based on a target surface [38], which is similarly often used in literature, e.g. [22,39]. At first the USCT volume is rigidly aligned with the X-ray mammogram in anteroposterior direction at the chest wall. In mediolateral direction a translation of the USCT volume is carried out to bring the breast's center of mass into overlap with the center of mass of the breast in the X-ray mammogram. The breast circumference extracted from the segmented X-ray mammogram acts as the center cross section of a target surface. The height of the 3D target surface is given by the compression thickness extracted from the mammogram's meta data. The 3D profile of the breast between the compression plates is approximated by a semi-ellipsoidal shape. For an illustration and more details refer to [38,40]. To carry out the second simulation, a second biomechanical model is created based on the deformed volume after the plate compression simulation. Displacement vectors from the surface nodes of this model to the closest point on the target surface are defined and the displacement-based FEM simulation and image deformation are subsequently carried out. The outcome is a deformed volume image, in which the breast is in the same configuration as the breast in the mammogram, i.e. the breast circumference in a projection image of the deformed volume overlaps with the circumference of the breast in the mammogram.

The described model-based registration process runs independently from any prior knowledge like lesion positions or relationships of modalities like image similarity. However it depends on a number of parameters for the preprocessing, the creation of the biomechanical model and both deformation simulation steps, which influence the registration accuracy. As an optional add-on to adapt these parameters to patient specific conditions, an optimization via image similarity similar to [9] is implemented. The image similarity S is calculated between the projection of the deformed USCT volume image and the corresponding mammogram. The registration process using a parameter set p delivering the best value for S is used as final result. For each parameter set the whole registration process described before is carried out. In this work we focused on optimizing one parameter: the rotation of the volume data around the anteroposterior axis to compensate relative rotations of the breast, which were found to have the largest effect on the registration accuracy in earlier work [41]. Gradient correlation [42] was found to be a suitable image similarity method for comparison of USCT images with X-ray mammograms [12]. An exhaustive search for rotation angles in the range of −30° to +30° with a step size of 5° is used as optimization scheme.

While the registration of USCT images and X-ray mammograms is already helpful to evaluate USCT, a key for future analysis or even use in multimodal diagnosis is to provide adequate visualization of the spatial correspondence. Besides applying linked cursors [43], a common method to combine the information of two modalities at a glance is image fusion [44]. In case of USCT, quantitative information, i.e. sound speed and attenuation, can be combined with the morphological details retrieved from mammography. This image fusion is carried out by projecting the deformed sound speed and attenuation image and overlay it color-coded on the gray scale mammogram. In this work we developed three different methods: sound speed combined with X-ray mammography, attenuation combined with X-ray mammography and both quantitative USCT images combined with X-ray mammography. While in the first two cases, the information from sound speed respectively attenuation is color-coded and overlaid, in the latter case, thresholds are applied on sound speed and attenuation image and both images are combined using a two-dimensional separator (Section 3.3). The resulting overlay is then rendered on the mammogram.

For analysis of the diagnostic value of the USCT images it is of interest to compare tissue structures in the X-ray mammogram with the quantitative values of sound speed and attenuation images. In this work we developed an analysis method using a segmentation of the mammogram into the three predominant tissue types fat, gland and lesion as ground truth. The breast in the X-ray mammogram was separated from the background using thresholding and morphological operations. Fatty and glandular tissue were differentiated using an interactive thresholding method similar to [45] and morphological closing. Lesions were manually annotated by an expert using a freehand tool. A resulting segmentation mask is illustrated in Fig. 3
                        .

After performing the registration of the USCT images, projections of the registered sound speed image and the registered attenuation image were created. These projection images overlap with the mammogram. Hence, the segmentation mask of the mammogram can be used to quantify sound speed and attenuation characteristics of the different types of tissue. For each segmented tissue type in the mammogram, the average sound speed and attenuation values of corresponding areas in the projection images of USCT was calculated for each patient dataset.

To evaluate how well quantitative properties imaged by USCT can separate different tissue types, a classification was carried out. A linear support vector machine (SVM) [46] was trained to separate fatty from glandular tissue and glandular tissue from lesions (3-class-problem). Furthermore an evaluation of a 2-class-problem distinguishing lesions from other tissue was carried out. A leave-one-patient-out training of the SVM was performed with sequential minimization option [47]. As training data the average sound speed and attenuation values for fatty tissue, glandular tissue and lesion of nine patients were used. After classifier training with eight of nine patients, the data of the remaining patient was used to test whether the SVM classified the average sound speed and attenuation to the correct tissue. The overall-accuracy (OAA) and Cohen's kappa κ 
                        [48] were calculated. This process was repeated with all combinations of training-test-partitions and the training and test errors were averaged over all runs.

To systematically investigate the influence of the stiffness distribution model, the compression simulation was tested with simplified numerical phantoms with different lesion sizes, lesion positions, lesion sound speeds and breast tissue compositions. A semi-sphere with a diameter of 12cm, which represents the volume of a B-cup [49], was used to approximate the breast. Within the sphere, three types of tissue were modeled: a layer of fatty tissue with a sound speed of 1400m/s, an optional layer of glandular tissue with a sound speed of 1450m/s and a round tumor, for which the sound speed (1500–1575m/s), radius (2.5–20mm) and position (central, lateral) was varied (Fig. 4
                        , top left image). The phantoms were compressed to 50% in thickness using the first simulation step before evaluating the shape change of the lesion and the relative displacement of the center of lesion.

For evaluation of the registration with in-vivo images, nine datasets from a clinical study [5] were used. Each dataset included volume images of the three USCT modalities reflectivity, attenuation and sound speed and the corresponding mammogram. As proof of principle, craniocaudal mammograms were used while the method may also be applied to oblique mammograms [50]. The datasets were selected to clearly show a lesion in one of the USCT images as well as in the corresponding mammogram for evaluation purposes. The visible lesion was marked by an expert using a freehand tool within the X-ray mammogram and the sound speed volume. The center of mass was calculated to approximate the center point of the lesion. The average lesion area projected along the mammographic compression angle was 463mm2 (range: 129–1039mm2) in the USCT images before the image registration and 903mm2 (range: 452–1695mm2) in the X-ray mammograms.

The USCT volumes had an in plane resolution of 1mm2, a spacing between the slices of 1mm and a slice thickness of 4mm with a varying number of coronal slices to cover the breast. In four of the datasets, the breasts were not fully imaged to the mammilla due to the large breast sizes. In these cases the breast curvature was manually extrapolated with fatty tissue.

X-ray mammograms were partly acquired on analog units and digitized with a resolution between 0.45 and 0.35mm2. Digital mammograms had a resolution between 0.1 and 0.07mm2. In seven of the datasets, the lesion was diagnosed as cancer, in two the lesion was a cyst. The average compression thickness of the breasts was 67mm (range: 55–80mm) representing a mean compression of the breast of approx. 60%.

@&#RESULTS@&#

To evaluate the effect of the mammographic compression on the lesion shape with the proposed heterogeneous stiffness distribution models in the biomechanical model, the size change of the included lesion in all directions of space was measured. Slice images of the uncompressed and compressed phantoms are illustrated in Fig. 4. Compared to a homogeneous modeling ignoring stiffness differences in the tissue, the heterogeneous models preserved the lesion shape in compression direction (Fig. 4). This was especially the case for the Models 1a (lesion size after compression against before compression: 84%), 1b (97%) and 1c (93%). In comparison, the lesion was compressed to 52% in diameter using the homogeneous stiffness distribution model, which well accords with the overall phantom compression of 50%, i.e. the lesion is compressed in the same fashion as the entire breast (Fig. 4). Embedding the lesion at a lateral position showed the same trends, however the differences between homogeneous and heterogeneous modeling were less pronounced. The lesion size had a minor effect on the overall observations with an average standard deviation. The lesion size change in compression direction was approx. 2% higher when the lesion was embedded in glandular tissue.

The observed trends are present for all evaluated sound speed values of the embedded lesion. When changing the sound speed of the lesion, the lesion shapechanges less for higher sound speeds, e.g. for a central lesion of radius 10mm, the lesion size in craniocaudal direction after compression with sitffness distribution Model 1b against before compression was 87% at 1500m/s, 94% at 1525m/s, 97% at 1550m/s and 99% at 1575m/s.

To estimate the influence of the stiffness distribution model on the relative movement of a lesion when mammographic compression is applied, the lesion positions after the compression simulations with the proposed heterogeneous models were compared to the same simulation with a homogeneous model. The distance between the lesion center points was calculated by the three-dimensional Euclidean distance. The relative displacement increases with increasing lesion radius. The maximum displacement was 9.0mm for a lesion with radius 20mm with Model 1b. The minimum displacement was 0.2mm for a lesion with radius 2.5mm with model 0. Results for the lateral lesion are in the same range with an average difference of +0.3mm. If the lesion is not embedded in a layer of glandular tissue, in average 1.8mm less displacement for lesion radii smaller than 20mm is observed while for large lesion the displacement stays approximately constant.

To evaluate the effect of the proposed stiffness distribution models with in-vivo data, the registration was applied to all datasets with all heterogeneous stiffness distribution models and the homogeneous model for comparison. The biomechanical models for one dataset are illustrated in Fig. 5
                           . It was observed that convergence problems of the compression plate simulation occurred randomly depending on the combination of stiffness distribution model and mesh geometry due to single heavily distorted elements. In order to get comparable results which only depend on the stiffness distribution model, the node and element distribution was slightly altered randomly by parameterizing the meshing algorithm until convergence of the simulation was achieved for all stiffness distribution models per dataset. The average number of elements was 16252 (range: 13858–20171) with an average element volume of 70.1mm3.

After carrying out the plate compression simulation, lesion center points using heterogeneous models were compared to the one using the homogeneous model. The compression angle was fixed to be 0°, according to an ideal craniocaudal compression. The average relative displacements (Table 1
                           ) for the heterogeneous Models 1a, 1b and 1c were considerably higher than for stiffness distribution Models 2a, 2b and 2c which well accords with the phantom image results. Using stiffness distribution Model 0 showed only a small effect on the lesion displacement. The same trends can be observed for the lesion area (Table 1). The area increased considerably for the homogeneous stiffness distribution model and stiffness distribution model 0.

Since the breast shapes for one dataset after applying the plate compression simulation differ depending on the stiffness distribution models, the breast meshes created based on them for the target model simulation are also different. In consequence the results of the target model simulation depend not only on the stiffness distribution model but on the meshing as well and can therefore not be compared directly. After applying the target model simulation to get the final registered USCT volume, the lesion areas were compared to the area of the lesion marking in the mammogram (Table 1). Especially for the Models 1a–1c, a good agreement of the lesion sizes can be observed, while for the homogeneous model, the lesions appear considerably larger than in the mammograms.

The registration accuracy was estimated by calculating the target registration error (TRE) and Dice coefficient (D) of lesion markings. The TRE is calculated as the Euclidean distance between the lesion center marked in the X-ray mammogram (C
                           XR) and the projection of the lesion center marked in the USCT volume (C
                           USCT):


                           
                              
                                 (3)
                                 
                                    TRE
                                    =
                                    
                                       
                                          
                                             
                                                C
                                                XR
                                             
                                             −
                                             
                                                C
                                                USCT
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        

The TRE is thereby relatively insensitive to the lesion shape. In addition, the Dice coefficient D is calculated from the areas A of the mammogram's lesion marking described by the polygon P
                           XR and the polygon resulting from the convex hull of the projection of the USCT's lesion marking (P
                           USCT):


                           
                              
                                 (4)
                                 
                                    D
                                    =
                                    
                                       
                                          2
                                          
                                          A
                                          (
                                          
                                             P
                                             XR
                                          
                                          ∩
                                          
                                             P
                                             USCT
                                          
                                          )
                                       
                                       
                                          A
                                          (
                                          
                                             P
                                             XR
                                          
                                          )
                                          +
                                          A
                                          (
                                          
                                             P
                                             USCT
                                          
                                          )
                                       
                                    
                                    .
                                 
                              
                           
                        

After initial alignment of the images without applying the registration, the average TRE was 40.1mm (Median: 40.9mm, standard deviation SD: 14.6mm) and the average D was 3.5%.

Applying only the compression plate simulation at a fixed compression angle of 0° reduced the TRE considerably to 25.1mm (Median: 22.8mm, SD: 11.9mm) using the homogeneous stiffness distribution model (Table 2
                           ). The results differed only slightly for the applied stiffness distribution models. The homogeneous model and Model 0 achieved the best accuracy.

The overall TRE reduces to 16.2mm (Median: 13.5mm, SD: 9.0mm) and the overall D increases to 38.0% for the homogeneous model when applying the target model simulation. The difference in TRE for different stiffness distribution models increases, however because of different breast shapes after performing the plate compression step, the meshes used for the target model simulation are not identical. The differences are approximately within the range of the mesh influence and may in consequence be only partly attributed to the different stiffness distribution models.

By applying the compression angles previously determined automatically using the intensity based optimization in [12], the TRE was reduced to 11.9mm using the homogeneous model. The best TRE was reached with stiffness distribution Model 0 (11.7mm) while for all other heterogeneous models the mean TRE was higher, i.e. in the worst case 17.3mm using Model 1b. Manually choosing the compression angle which delivers the lowest TRE results in an average TRE of 7.1mm using the homogeneous model. Table 3
                            summarizes the results for the different registration steps and compression angle optimizations using the homogeneous stiffness distribution model as despite it's simplicity this model obtained the best TRE and D values and empirically shows the best convergence behavior. Fig. 6
                            shows resulting images of two patients.

After performing the image registration, the analysis method proposed in Section 2.5 was applied to get a first estimate of the diagnostic value of in-vivo sound speed and attenuation images. The images were registered using the homogeneous stiffness distribution model and the manually chosen compression angle to have the best tissue overlap for analysis.

Firstly, the sound speed and attenuation values in maximum intensity projections of the registered USCT images were analyzed separately (Fig. 7
                        ). The average over all mean sound speed values was 1447m/s for fatty tissue, 1460m/s for glandular tissue and 1516m/s for the lesion. Accordingly, the average over all mean attenuation values was 0.19dB/cm for fatty tissue, 0.21dB/cm for glandular tissue and 0.25dB/cm for the lesion. The average sound speed and attenuation values were inserted into the SVM classification as single features. The average training and test OAA and κ for the evaluation with nine patients are given in Table 4
                         for the 3-class separation and Table 5
                         for the 2-class separation. As observed from the boxplots, the separation of different tissue by sound speed was considerably better than with attenuation.

Secondly, when using both sound speed and attenuation as features for the SVM classification, the training as well as the test error is slightly decreased compared to using only sound speed from 19% (training) / 19% (test) to 13% / 15% for the 3-class problem and from 3% / 4% to 0% / 0% for the 2-class problem (Tables 4, 5). The main part of the error of the 3-class problem is contributed by the separation between fatty and glandular tissue. This can be observed as well in Fig. 8
                         which presents a scatter plot of average sound speed and attenuation for fatty tissue, glandular tissue and lesion. The best classification results were achieved with maximum intensity projections of the absolute sound speed and attenuation while normalizing the values to the maximal value per dataset or using a summation projection increases the training and test errors.

No definite differentiation between the cancer and cyst cases could be obtained in the projection images based on absolute sound speed and attenuation. Both lesions diagnosed as cysts had an average sound speed which was amongst the highest observed in the patient collective and very high maximum sound speeds >1560m/s, however this needs to be addressed in a separate study with a larger patient collective.

Finally the image fusion with the X-ray mammogram was carried out in order to display mammogram and USCT information in a single image. Fig. 9
                         shows the color coded sound speed overlaid semi-transparently on the mammogram of two patients. The SVM trained separation lines in Fig. 8 describe two functions f
                        
                           FG
                         and f
                        
                           GL
                         of the sound speed c:


                        
                           
                              (5)
                              
                                 
                                    f
                                    FG
                                 
                                 (
                                 c
                                 )
                                 =
                                 −
                                 3.86
                                 
                                 c
                                 +
                                 5.82
                              
                           
                        
                        
                           
                              (6)
                              
                                 
                                    f
                                    GL
                                 
                                 (
                                 c
                                 )
                                 =
                                 −
                                 6.65
                                 
                                 c
                                 +
                                 10.06
                              
                           
                        
                     

These functions were used to classify tissue in the fused images by masking the colored overlay (Fig. 10
                        ). This enables to highlight the location of different tissue types in the mammogram, especially the suspicious lesion. The lesion visible in the mammogram is clearly marked by the overlaid area. Though in this case the lesion in the mammogram was clearly visible for evaluation purposes, the applied image fusion method may help in cases were a tumor is not visible in the mammogram of a very dense breast since USCT promises to distinguish between glandular tissue and tumor.

@&#DISCUSSION AND CONCLUSION@&#

In this paper we presented a method for registration of three-dimensional Ultrasound Computer Tomography images with X-ray mammograms based on a patient-specific biomechanical modeling of the breast and simulation of the mammographic compression. In contrast to earlier work, we investigated material parameters estimated individually for each patient from the underlying sound speed image. The proposed heterogeneous stiffness distribution models were evaluated using numerical phantoms and in-vivo data of nine patients. The registration accuracy was evaluated by measuring lesion correspondence between X-ray mammograms and USCT images. Based on the registration, an image fusion of sound speed and attenuation images with mammograms was carried out. A first evaluation of the diagnostic value of projections of sound speed and attenuation images showed promising results to distinguish between different types of tissue, especially between lesion and other tissues.

In addition to our previous publications [10–12], this work introduced several stiffness distribution models for patient-specific biomechanical modeling based on sound speed images. The evaluation with numerical phantoms made it possible to carry out a systematic analysis of the influence of the lesion size, lesion position and sound speed of a lesion on the nonlinear effects in the breast. In addition, in-vivo images of a consistent patient collective were used for evaluation of registration accuracy, diagnostic value of the quantitative USCT imaging and image fusion in order to summarize on the observed effects.

The registration method is based on a method originally developed for the registration of Magnetic Resonance Tomography images with X-ray mammograms [9,22] and was successfully applied for the registration of USCT images with X-ray mammograms. The obtained accuracy for an automated registration (TRE 11.9mm) is slightly better than for the registration with MRI images (13.2mm), well within the range other MRI-to-mammography registration approaches in literature [20,51] and as well in a range which might assist radiologists in multimodal diagnosis. The accuracy is partly limited by the performance of the image similarity metric to optimize the compression angle: by manually choosing the best compression angle, the mean TRE can even be reduced to 7.1mm.

Applying heterogeneous stiffness distribution models had a relatively large effect on the lesion shape in our idealized phantom images, especially for the Models 1a, 1b and 1c which imply large stiffness differences for different tissue types within the breast. Lesions may be displaced several millimeters compared to using a homogeneous model. It could be shown that the proposed stiffness distribution models preserve the lesion shape more than homogeneous models. With increasing sound speed and therefore increasing Young's modulus the lesion size in compression direction changes less, though the interpolation of the Young's modulus for each Finite Element can only be seen as approximation of the real distribution of mechanical properties. The lesion shape and the exact shape of glandular structures are not represented by the mesh geometry, i.e. sharp edges between tissues are not modeled due to the meshing of the entire breast before interpolating the mechanical properties per element. In in-vivo data the effect of different stiffness distribution models is less pronounced which might be due to smaller differences in sound speed and smoother transitions between tissues compared to our idealized phantoms. However the observed trends of the effect on the lesion shape are similar.

When applied to in-vivo data, heterogeneous models have an influence on the convergence behavior of the Finite Element simulation. Especially for large differences in tissue stiffness, e.g. in Models 1a and 1b, simulations do not converge in some cases due to single heavily distorted elements and large strains. To increase the robustness of the method in such cases, the mesh geometry was randomly changed until convergence was achieved. Further investigation on an optimization of the initial meshing in such cases is subject to current research.

Despite the considerably different lesion shapes using the heterogeneous stiffness distribution models in our compression simulation, the highest overall registration accuracy was still observed with the homogeneous model. Yet when applying only the first simulation with compression plates, the differences in the registration error are relatively low. Boundary conditions, e.g. the fixation of the breast at the chest wall, and simulation uncertainties like the exact compression thickness have to be considered in interpreting these results. The biomechanical model constructed patient-specifically based on the sound speed images furthermore still include simplifications. While e.g. Cooper's ligaments [52] might be depicted with Ultrasound Computer Tomography [53], they were not visible in the images used in this study and thus were not modeled. Furthermore, their mechanical properties and the effect on the breast under compression need further investigation. Another effect which cannot be modeled is the manual positioning of the breast during X-ray mammography examination. Besides not always correctly measured breast thickness and compression angle, the breast is often shifted on the compression plate [54] to meet the quality criterion of screening programs.

Ignoring such effects during the compression plate simulation results in shape differences compared to the mammogram and necessitates the second deformation step using the target model to achieve overlapping breast boundaries. A drawback of this step is that it is only an approximation of the sum of physical processes described before. After applying this step, the differences in registration accuracy for the heterogeneous stiffness distribution models compared to the homogeneous model increase. This might be due to the boundary conditions applied only on the surface nodes of the biomechanical model which in consequence reduce the inner tissue movement for models with large stiffness differences. However, it can be concluded that the target model simulation still considerably decreases the registration error for all applied stiffness distribution models.

Estimation of the registration accuracy and evaluation of the lesion size differences are restricted to manual annotations, which are subject to intra- and inter-observer variability [40]. The shape of the lesion markings can only approximate the real shape and might over- or underestimate their area respectively volume. Comparison of the lesion sizes after carrying out the registration however showed a clear trend that heterogeneous stiffness distribution models better match the lesion area observed in the mammogram. The areas of the lesion markings in projections of the USCT images were nearly 100% the area of the marking in the X-ray mammograms using the heterogeneous Models 1a, 1b and 1c. Though with the current limitations of the registration method the overall accuracy is not improved with heterogeneous stiffness distribution models, they might be applied in more complex future biomechanical models.

The first analysis of projections of sound speed and attenuation images was aimed as a proof of principle for the evaluation method and can be applied to a larger patient collective to achieve statistically more significant results. The results already showed a clear trend that for the current USCT images, sound speed gives a better distinction between tissues than attenuation. The results are limited by projecting the information into a 2D image using a maximum intensity projection. The absolute values therefore cannot be directly compared to evaluations of volume images [55]. Although spatial information gets degraded by the projection, reformatting the sound speed and attenuation information into a mammography-like representation now allows direct comparison and quantitative analysis given a well-known imaging modality as ground truth. The evaluation is limited to the current resolution of the USCT volumes, which was constant for all datasets used in this study. In future the effect of the image resolutions on the analysis might also be included in an evaluation with more datasets. For the patient collective it was possible to distinguish between lesion and other tissue in all cases. Also glandular tissue and fatty tissue might be roughly separated based on sound speed and attenuation. Classifying the tissue types, the training and test errors using both quantitative modalities decreased in comparison to using only one of the modalities.

The analysis method is limited to the registration accuracy, i.e. the overlap of corresponding tissue structures in X-ray mammograms and projections of sound speed and attenuation images. Therefore the registration results with the best registration accuracy were chosen for analysis despite that their compression angle was optimized manually. The registration error affects the mean sound speed and attenuation values for each tissue type, if e.g. high sound speeds corresponding with the lesion in the USCT images are several millimeters off the area segmented as lesion in the mammogram. Furthermore, the annotation of lesions and the segmentation of glandular structures are subject to observer variance. In some cases (e.g. Fig. 10) image artifacts e.g. near the mammilla, and problems in the separation of the breast from the water background may downgrade the results, since the maximum intensity projection of the images emphasizes high values. However in order to distinguish between lesion and other tissue a maximum intensity projection is beneficial, especially for small lesions, to definitely highlight suspicious structures in overlay images. While in this evaluation only cases with obvious lesions in X-ray mammograms were used – which was essential to measure the registration error – the possible applications may as well be cases in which a lesion is poorly visible in the X-ray mammogram. In such cases, the overlay of quantitative information on the mammogram provides additional information for the radiologists. Even if not clearly outlined by sound speed and attenuation, the method may provide hints where to have a closer look on the mammogram.

In conclusion, the presented method and evaluation showed promising results in registering and fusing information of two imaging devices with significantly different patient positioning, compression state of the breast and imaging dimensionality. It was successfully applied to in-vivo data, allowing for an automatic correlation of tissue structures. It is therefore likely to assist the challenging and time consuming multimodal diagnosis by providing intuitive tools for radiologists. In consequence the method may help radiologists in learning how to read USCT images and how to interpret quantitative sound speed respectively attenuation and qualitative reflection images. The first results differentiating between different types of tissue in mammograms by overlaying sound speed and attenuation information are encouraging and may assist multimodal diagnosis in future.

@&#REFERENCES@&#

