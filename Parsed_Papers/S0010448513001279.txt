@&#MAIN-TITLE@&#Designing heterogeneous porous tissue scaffolds for additive manufacturing processes

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Heterogeneous porous architecture of tissue scaffolds is designed.


                        
                        
                           
                           To improve cell survivability, radial channels are optimally generated.


                        
                        
                           
                           Iso-porous curves are optimally determined to generate the spatial porosity.


                        
                        
                           
                           A continuous deposition path planning is developed for additive processes.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Scaffold architecture

Gradient porosity

Medial axis

Biarc fitting

Continuous path planning

Additive manufacturing

@&#ABSTRACT@&#


               
               
                  A novel tissue scaffold design technique has been proposed with controllable heterogeneous architecture design suitable for additive manufacturing processes. The proposed layer-based design uses a bi-layer pattern of radial and spiral layers consecutively to generate functionally gradient porosity, which follows the geometry of the scaffold. The proposed approach constructs the medial region from the medial axis of each corresponding layer, which represents the geometric internal feature or the spine. The radial layers of the scaffold are then generated by connecting the boundaries of the medial region and the layer’s outer contour. To avoid the twisting of the internal channels, reorientation and relaxation techniques are introduced to establish the point matching of ruling lines. An optimization algorithm is developed to construct sub-regions from these ruling lines. Gradient porosity is changed between the medial region and the layer’s outer contour. Iso-porosity regions are determined by dividing the sub-regions peripherally into pore cells and consecutive iso-porosity curves are generated using the iso-points from those pore cells. The combination of consecutive layers generates the pore cells with desired pore sizes. To ensure the fabrication of the designed scaffolds, the generated contours are optimized for a continuous, interconnected, and smooth deposition path-planning. A continuous zig–zag pattern deposition path crossing through the medial region is used for the initial layer and a biarc fitted iso-porosity curve is generated for the consecutive layer with 
                        
                           
                              C
                           
                           
                              1
                           
                        
                      continuity. The proposed methodologies can generate the structure with gradient (linear or non-linear), variational or constant porosity that can provide localized control of variational porosity along the scaffold architecture. The designed porous structures can be fabricated using additive manufacturing processes.
               
            


                        
                           i
                        th contour curve represented with the parameter 
                           t
                        
                     

Unit normal vector on curve 
                           
                              
                                 C
                              
                              
                                 i
                              
                           
                           
                              (
                              t
                              )
                           
                         at a parametric location 
                           t
                        
                     

Offset distance

Upper widths for the biologically allowable pore size for cells in growth

Lower widths for the biologically allowable pore size for cells in growth

Width of the medial region

Medial boundary of 
                           i
                        th contour curve represented with the parameter 
                           t
                        
                     

Range of parameter 
                           t
                         for 
                           i
                        th contour curve

Range of parameter 
                           t
                         for 
                           i
                        th medial boundary

Set of points generated on the external contour curve 
                           
                              
                                 C
                              
                              
                                 i
                              
                           
                           
                              (
                              t
                              )
                           
                        
                     

Set of points generated on the medial boundary curve 
                           M
                           
                              
                                 B
                              
                              
                                 i
                              
                           
                           
                              (
                              t
                              )
                           
                        
                     

Number of points generated on 
                           
                              
                                 C
                              
                              
                                 i
                              
                           
                           
                              (
                              t
                              )
                           
                         with equal cord length sections

Number of points generated on 
                           M
                           
                              
                                 B
                              
                              
                                 i
                              
                           
                           
                              (
                              t
                              )
                           
                         with equal cord length sections

Counterpart point set for 
                           
                              
                                 P
                              
                              
                                 m
                              
                           
                         on 
                           
                              
                                 C
                              
                              
                                 i
                              
                           
                           
                              (
                              t
                              )
                           
                        
                     

Counterpart point set for 
                           
                              
                                 P
                              
                              
                                 c
                              
                           
                         on 
                           M
                           
                              
                                 B
                              
                              
                                 i
                              
                           
                           
                              (
                              t
                              )
                           
                        
                     


                        
                           j
                        th point on external contour curve 
                           
                              
                                 C
                              
                              
                                 i
                              
                           
                           
                              (
                              t
                              )
                           
                        
                     


                        
                           k
                        th point on medial boundary curve 
                           M
                           
                              
                                 B
                              
                              
                                 i
                              
                           
                           
                              (
                              t
                              )
                           
                        
                     

Set of ruling lines

Total number of ruling lines generated

Normal direction at point location 
                           
                              
                                 p
                              
                              
                                 c
                                 j
                              
                           
                         on external contour curve 
                           
                              
                                 C
                              
                              
                                 i
                              
                           
                           
                              (
                              t
                              )
                           
                        
                     

Normal direction at point location 
                           
                              
                                 p
                              
                              
                                 m
                                 k
                              
                           
                         on medial boundary curve 
                           M
                           
                              
                                 B
                              
                              
                                 i
                              
                           
                           
                              (
                              t
                              )
                           
                        
                     

Area between 
                           
                              
                                 C
                              
                              
                                 i
                              
                           
                           
                              (
                              t
                              )
                           
                         and 
                           M
                           
                              
                                 B
                              
                              
                                 i
                              
                           
                           
                              (
                              t
                              )
                           
                        
                     

Set of segments, which is defined by the area between two adjacent ruling line

Area of 
                           n
                        th segment

Lower width of 
                           n
                        th segment

Upper width of 
                           n
                        th segment

Set of sub-region channels

Area of 
                           d
                        th sub-region

Lower width of 
                           d
                        th sub-region

Upper width of 
                           d
                        th sub-region

Expected area of sub-region

Expected lower width of sub-region

Expected upper width of sub-region

Penalty weight for sub-region area deviation

Penalty weight for sub-region lower width deviation

Penalty weight for sub-region upper width deviation

Set of sub-region’s boundary lines

Set of pore-cell line segments (iso-porosity)

Set of starting points for pore-cell line segment

Set of ending points for pore-cell line segment

Number of pore cells or iso-porosity regions


                        
                           p
                        th pore-cell in 
                           d
                        th sub-region

Deposited filament diameter

Set of starting points for 
                           S
                           R
                           A
                        
                     

Set of end points for 
                           S
                           R
                           A
                        
                     

Medial axis for 
                           i
                        th contour curve 
                           
                              
                                 C
                              
                              
                                 i
                              
                           
                           
                              (
                              t
                              )
                           
                        
                     

Set of points projected on 
                           
                              
                                 M
                              
                              
                                 i
                              
                           
                         from point set 
                           A
                           E
                        
                     

Refined pore cell point set

Refined iso-porosity line segment

Acceptable tolerance for biarc fitting

Maximum (Hausdorff) distance between fitted biarc and 
                           C
                           S
                         and 
                           C
                           E
                        .

@&#INTRODUCTION@&#

In tissue engineering, porous scaffold structures are used as a guiding substrate for three-dimensional (3D) tissue regeneration processes. The interaction between the cells and the scaffold constitutes a dynamic regulatory system for directing tissue formation, as well as regeneration in response to injury  [1]. A successful interaction must facilitate the cell survival rate by cell migration, proliferation and differentiation, waste removal, and vascularization while regulating bulk degradation, inflammatory response, pH level, denaturization of proteins, and carcinogenesis affect. Inducing an amenable bio-reactor and stimulating the tissue regeneration processes while minimally upsetting the delicate equilibrium of the cellular microenvironment is the fundamental expectation of a functional scaffold. Achieving the desired functionality can be facilitated by scaffold design factors such as pore size, porosity, internal architecture, bio-compatibility, degradability, permeability, mechano-biological properties, and fabrication technology  [2,3]. For example, cells seeded on the scaffold structure need nutrients, proteins, growth factors and waste disposal, which make mass and fluid transport vital to cell survival. However, in traditional homogeneous scaffolds, seeded cells away from the boundary of the scaffold might have limited access to the nutrient and oxygen affecting their survival rate  [4]. Thus, controlling the size, geometry, orientation, interconnectivity, and surface chemistry of pores and channels could determine the nature of nutrient flow  [5]. Moreover, the size of the pores determines the distance between cells at the initial stages of cultivation and also influences how much space the cells have for 3D self-organization in later stages. Cell seeding on the surface of scaffold and feeding the inner sections are limited when the pores are too small, whereas larger pores affect the stability and its ability to provide physical support for the seeded cells  [6].

The porous internal architecture of the scaffold may have significant influence on the cellular microenvironment  [7] and tissue re-generation process  [8]. Several studies have focused on designing the internal architecture of the porous scaffold and a few have tried to optimize the scaffold’s geometric structure  [9]. However, functional pore size and porosity for scaffold structure varies with native tissue  [10] and their spatial location. Multi-functional hierarchical bone structure and porosity have been analyzed  [11] and modeled using synergy between the geometric model and the multi-scale material model. In  [12,13], the authors modeled bone tissue using multi-scale finite element analysis, which provides better understanding of the bone tissue. As mentioned in this paper, tissues cannot be represented by homogeneous properties and hence require tissue scaffolds with multi-scale porosity. Karageorgiou  [8] in their studies found that larger pores (100–150 and 150–200 μm) showed substantial bone ingrowth while smaller pores (75–100 μm) resulted in ingrowth of unmineralized osteoid tissue. They also determined that the pore sizes of 10–44 and 44–75 μm were penetrated only by fibrous tissue cells and thus recommend the pore sizes greater than 300 μm. Hollister  [14] designed the scaffolds with the pore sizes of 300 and 900 μm for bone tissue. Karande  [15] also reported that considering the tissue type, scaffold material and fabrication systems, a wide range of pore size (50–400 μm) was found to be acceptable. Thus, there is no consensus regarding the optimal pore size either for bone or soft tissue scaffold.

The development of bio-manufacturing techniques and the improvement in biomaterial properties by synergy provides the leverage for using additive processes to manufacture interconnected porous structures. Additive manufacturing processes can build mass customized 3D object layer-by-layer providing a high level of control over external shape and internal morphology  [16] while guarantee its reproducibility  [10,17]. A detail review of the bio-manufacturing processes can be found in  [16,17]. Despite such a unique freedom to fabricate complex design geometries, additive manufacturing approaches have been very much confined within homogeneous scaffold structures with uniform porosity  [3]. But homogeneous scaffolds do not capture the spatial properties and may not represent the bio-mimetic structure of native tissues. A possible solution for performing the diverse functionality would be designing scaffolds with functionally variational porosity. Gradient porosity along the internal scaffold architecture might provide extrinsic and intrinsic properties of multi-functional scaffolds and might perform the guided tissue regeneration. Thus, achieving controllable, continuous and interconnected gradient porosity may lead to a successful tissue engineering approach. Improved cell seeding and distribution efficiency has been reported by Sobral et al.  [18] by implementing continuous gradient pore size. Hence, the need for a reproducible and manufacturable porous structure design with controllable gradient porosity is obvious but possibly limited by either available design or fabrication methods or both  [9,18].

Variational porosity design has been used by Lal et al.  [19] in their proposed microsphere-packed porous scaffold modeling technique. The resultant porosity is stochastically distributed throughout the structure. The achievable porosity variation depends upon their packing conditions which can be controlled with the size and number of the microspheres. A heuristic-based porous structure modeling has been developed in the literature  [20] using an approach based on constructive solid geometry (CSG) with stochastic Boolean functions. Porous objects designed with a nested cellular structure have been proposed in the literature  [21,22], which may introduce the gradient porosity. A function-based variation of geometry and topology has been developed  [21] using unit-cell library to build scaffold structure. A 3D porous structure modeling technique has been deployed with layer-based 2D Voronoi tessellation  [23], which ensures the interconnected pore networks. In  [24], geometric modeling of functionally graded material (FGM) has been developed with graded microstructures. The gradient porosity in the FGM has been achieved with stochastically distributed Voronoi cells. Porous scaffolds with 3D internal channel networks are designed with axisymmetric cylindrical geometry based on energy conservation and flow analysis  [25,26]. After the scaffolds are designed, they need to be fabricated mainly by using additive manufacturing processes layer by layer. The filament deposition direction or the layout pattern in scaffold plays an important role toward its mechanical and biological properties  [27] as well as cell in-growth  [28]. In the literature, because most of the design and fabrication processes are not developed simultaneously, and their fabrications are after-thought, the designed scaffolds might generate discontinuous deposition path which may not be feasible for additive manufacturing processes.

In tissue engineering strategies, scaffold matrices are developed with/without cells  [10] and growth factors either using conventional and/or non-conventional techniques  [29]. The details of these strategies and different additive processes and materials for tissue and organ engineering can be found  [10,17]. One of the most common strategies in tissue engineering is to develop scaffolds and seed the cells. The scaffolds are then provided with a suitable bio-reactor as in-vitro or implanted as in-vivo for cell proliferation  [17] within the scaffold structure until the damaged tissue is re-grown. Limited nutrient and oxygen supply from and to the scaffold architecture has been reported in both static  [30] and dynamic  [31] environments. As a result, the seeded cells away from the peripheral boundary of the scaffold have lower survival rates and tissue formation. Therefore, it is important to change and control the porosity along the architecture of the scaffold, and at the same time, it should have the channels feeding deepest regions of the scaffold for proper nutrition flow and waste removal. Different strategies such as perfusion channel  [32], surface modification, i.e. plasma treatment, hydrophobic to hydrophilic  [33] are used to improve the cell survival rate. In  [33], the authors used plasma-modified 3D extruded polycaprolactone (PCL) to improve the osteoblast cell adhesion. To automate and integrate scaffold development and cell seeding, the Biocell system was also developed  [29]. Controlling the internal architecture of the scaffold with pore size, shape, distribution and interconnectivity has a strong effect on the biological response of cells  [37]. In this paper, we propose a novel method to address the scaffold design limitations by designing a functionally gradient variational porosity architecture that conforms to the anatomical shape of the damaged tissue. The proposed layer-based design uses a bi-layer pattern of radial and spiral layers consecutively in 3D to achieve the desired functional porosity. The material deposition is controlled by the scaffold’s contour geometry, and this would allow us to control the internal architecture of the designed scaffold. The designed layers have been optimized for a continuous, interconnected, and smooth material deposition path-planning for additive manufacturing processes.

The rest of the paper is organized as follows. Section  2 presents a layer-based geometric modeling technique for controlling porosity for each layer. Section  2.1 introduces the internal geometric feature for each layer, which controls the discretization of the scaffold area. Section  2.2 discusses the modeling of radial layer, while Section  2.3  details the modeling for the consecutive spiral layer. A continuous and interconnected additive manufacturing path-planning for the designed model has been developed in Section  3. Section  4 describes the additive manufacturing based process used to fabricate the proposed sample models, and Section  5 provides implementation and examples of the proposed techniques. This paper ends with concluding remarks in Section  6.

In this section a modeling technique has been proposed for layer-based additive manufacturing processes to control the internal architecture of tissue scaffolds. First, the anatomical 3D shape of the targeted region needs to be extracted using non-invasive techniques and layers are generated by slicing the 3D shape. To demonstrate the proposed heterogeneous controllable porosity modeling, two consecutive layers are considered as bi-layer pattern. For each layer, the medial axis is constructed as the topological skeleton using the inward offsetting method which is then converted into a two dimensional medial region. The scaffolding area is discretized with radial ruling lines by connecting the boundaries of the medial region and the layer’s outer contour. An optimization algorithm is developed and sub-regions are accumulated from ruling lines. Dividing the sub-regions into pore-cells along their periphery generates iso-porosity regions for the consecutive layer. The combination of consecutive layers constructs the pore cells with desired pore sizes. Finally, a continuous, interconnected, and smooth deposition path-planning is proposed to ensure the fabrication of the designed scaffolds. By stacking the designed bi-layers consecutively along the building direction will generate the 3D porous scaffold structure with controllable heterogeneous porosity.

The defected or targeted region could be geometrically reconstructed from medical images obtained by Computed Tomography (CT) or Magnetic Resonance Imaging (MRI). The extracted 3D geometric model is then sliced by a set of intersecting planes parallel to each other to find the layer contours to be used for additive manufacturing processes. All the contour curves are simple planar closed curves, i.e., they do not intersect themselves other than at their start and end points and have the same (positive) orientation. The general equation for these contours can be parametrically represented as: 
                        
                           (1)
                           
                              
                                 
                                    C
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 t
                                 )
                              
                              =
                              
                                 
                                    
                                       {
                                       x
                                       
                                          (
                                          t
                                          )
                                       
                                       ,
                                       y
                                       
                                          (
                                          t
                                          )
                                       
                                       ,
                                       z
                                       
                                          (
                                          t
                                          )
                                       
                                       =
                                       c
                                       }
                                    
                                 
                                 
                                    
                                       T
                                    
                                 
                              
                              
                              ∀
                              t
                              ∈
                              
                                 [
                                 
                                    
                                       a
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       i
                                    
                                 
                                 ]
                              
                              →
                              
                                 
                                    ℜ
                                 
                                 
                                    2
                                 
                              
                              ;
                              
                              
                                 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             i
                                          
                                       
                                       |
                                    
                                 
                                 
                                    t
                                    =
                                    
                                       
                                          a
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             i
                                          
                                       
                                       |
                                    
                                 
                                 
                                    t
                                    =
                                    
                                       
                                          b
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              ;
                              
                              i
                              =
                              0
                              ,
                              …
                              ,
                              N
                              L
                              .
                           
                        
                      Here, 
                        
                           
                              C
                           
                           
                              i
                           
                        
                        
                           (
                           t
                           )
                        
                      represents the parametric equation for the 
                        i
                     th contour curve with respect to the parameter 
                        t
                      at a range between 
                        
                           [
                           
                              
                                 a
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 b
                              
                              
                                 i
                              
                           
                           ]
                        
                     . The number of sliced contours generated from the 3D model depends upon the capability of the additive manufacturing process used. To accomplish the desired connectivity, continuity, and spatial porosity, consecutive adjacent layers and their contours are considered, and the design methodology is presented for such a pair in the next section. When these bi-layers are added layer-by-layer, a 3D scaffold design can be obtained and used for additive manufacturing processes.

As mentioned above, the seeded cells away from the peripheral boundary of the scaffold have lower survival rates and tissue formation. In our proposed design processes, the spinal (deepest) region of the scaffold architecture needs to be determined so that the gradient of functional porous structure can change between the outer contour and the spinal region. The medial axis  [34] of each layer contour 
                           
                              
                                 C
                              
                              
                                 i
                              
                           
                         is used as its spine or internal feature.

The medial axis of a contour is the topological skeleton of a closed contour which is also a symmetric bisector. The uniqueness, invertibility, and the topological equivalence of a medial axis make it to be a suitable candidate for a geometrically significant internal spinal feature. To ensure the proper physical significance of this one-dimensional geometric feature, a medial region has been constructed from the medial axis for each corresponding layer as shown in Fig. 1
                        (b). The medial region has been defined as the sweeping area covered by a circle whose loci of centers are the constructed medial axis. The width of this medial region is determined by the radius of the imaginary circle. Higher width can be used if the scaffold is designed with perfusion bioreactor cell culture  [35] consideration to reduce the cell morbidity with proper nutrient and oxygen circulation. The boundary curve of the medial region is defined as the medial boundary in this paper; it is also the deepest region from the boundary, as shown in Fig. 1(b).

A medial axis 
                           
                              
                                 M
                              
                              
                                 i
                              
                           
                         for every planar closed contour or slice 
                           
                              
                                 C
                              
                              
                                 i
                              
                           
                         has been generated using the inward offsetting method  [36] as shown in Fig. 1(a). The approximated offset curve 
                           
                              
                                 C
                              
                              
                                 i
                              
                              
                                 d
                              
                           
                           
                              (
                              t
                              )
                           
                         of the contour curve 
                           
                              
                                 C
                              
                              
                                 i
                              
                           
                           
                              (
                              t
                              )
                           
                         at a distance 
                           d
                         from the boundary is defined by: 
                           
                              (2)
                              
                                 
                                    
                                       C
                                    
                                    
                                       i
                                    
                                    
                                       d
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 =
                                 
                                    
                                       C
                                    
                                    
                                       i
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                                 +
                                 d
                                 
                                    
                                       N
                                    
                                    
                                       ⃗
                                    
                                 
                                 
                                    (
                                    t
                                    )
                                 
                              
                           
                         where 
                           
                              
                                 N
                              
                              
                                 ⃗
                              
                           
                           
                              (
                              t
                              )
                           
                         is the unit normal vector on curve 
                           
                              
                                 C
                              
                              
                                 i
                              
                           
                           
                              (
                              t
                              )
                           
                         at a parametric location 
                           t
                        . Such an offset may generate self-intersection if 
                           d
                         is larger than the minimum radius of the curvature at any parametric location 
                           t
                         of the offset curve 
                           
                              
                                 C
                              
                              
                                 i
                              
                              
                                 d
                              
                           
                           
                              (
                              t
                              )
                           
                        . Such intersection during offsetting has been eliminated by implementing the methodology discussed in our earlier work  [3]. A singular point is obtained at each self-intersection event where there is no 
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                         continuity. Each segment of the medial axis is generated by obtaining the intersection of each incrementing offset and then by connecting them together as a piecewise linear curves. The end points of the medial axis in this paper are assumed to be the locus of centers of maximal circles that is tangent to the joint point sets. Any branch point for the medial axis is assumed to be located at the center of loci that is tangent to three or more disjoint point sets simultaneously. The branch connection has been determined with higher offset resolution and interpolation.

A medial boundary curve shown in Fig. 1(b) has been constructed by offsetting the medial axis at a constant distance in both directions using 
                           d
                           =
                           ±
                           δ
                           :
                           l
                           
                              
                                 l
                              
                              
                                 /
                              
                           
                           ≤
                           δ
                           ≤
                           u
                           
                              
                                 l
                              
                              
                                 /
                              
                           
                         in Eq. (2) where 
                           u
                           
                              
                                 l
                              
                              
                                 /
                              
                           
                         and 
                           l
                           
                              
                                 l
                              
                              
                                 /
                              
                           
                         represent the upper and lower widths for the biologically allowable pore size for cells in growth. The offset of all the medial axis segments are generated and joined into an untrimmed closed curve. The self-intersecting loops are eliminated  [3] and the open edges are closed with an arc of radius 
                           δ
                        . The general notation for the medial boundary of the 
                           i
                        th contour can be represented as 
                           M
                           
                              
                                 B
                              
                              
                                 i
                              
                           
                           
                              (
                              t
                              )
                           
                         with respect to parameter 
                           t
                         at a range between 
                           
                              [
                              
                                 
                                    A
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    B
                                 
                                 
                                    i
                                 
                              
                              ]
                           
                         as shown in Fig. 1(b).

In extrusion based additive manufacturing processes, one of the most common deposition patterns in making porous scaffolds following a Cartesian layout pattern (0°–90°) in each layer crisscrossing the scaffold area arbitrarily as shown in Fig. 2
                        (a). However, other layout patterns are also reported to determine the influence of pore size and geometry  [37]. After cells are seeded in those filaments, their accessibility to the outer region for nutrient or mass transport becomes limited to the alignment of the filament in lieu of their own locations. As shown in Fig. 2(a), seeded cells away from the outer contour may have less accessibility through the filament. This could affect the cell survival rate significantly as discussed earlier. However, a carefully crafted filament deposition between the outer contour and the medial region can improve the cell accessibility and may increase the mass transportation at any location as shown in Fig. 2(b).

The medial region can be used as an internal perfusion channel through which the cell nutrients and oxygen can be supplied and may increase the cell survival rate. Moreover, to improve the mass transportation for the seeded cells inside the scaffold, such an internal feature can be used as a base to build radial channels that can be used as a guiding path for nutrient flow. These radial channels are defined as sub-regions in this paper as shown in Fig. 2(b). The constructed channels/sub-regions directed between the external contours and the internal segments of the scaffold will shorten the diffusion paths and reduce resistance to mass transportation while guiding the cell and tissue in-growth. Connecting the external contour with the medial region arbitrarily degenerates the accessibility and worsens the mass transportation within the scaffold. Moreover, the geometric size and area of each sub-region channel must comply for the tissue regeneration and their support. The geometric dimensions may also depend upon the design objective and available fabrication methods  [38]. In the literature  [14,15], the suitable pore size has been suggested with a wide range from 100 to 900 μm for hard tissue and 30–150 μm for soft tissue.

A two-step sub-region modeling technique is developed to increase the accessibility and mass transportation for the designed sub-region in this section. During modeling, the scaffold area is decomposed into smaller radial segments by ensuring global optimum accessibility between the external contour 
                           
                              
                                 C
                              
                              
                                 i
                              
                           
                           
                              (
                              t
                              )
                           
                         and the medial region 
                           M
                           
                              
                                 B
                              
                              
                                 i
                              
                           
                           
                              (
                              t
                              )
                           
                        . Then, a heuristic method is developed to construct the radial sub-regions by accumulating those segments.

To construct the radial channels or sub-regions, the scaffold area is decomposed into a finite number of segments connected between the external contour 
                              
                                 
                                    C
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 t
                                 )
                              
                            and the internal feature 
                              M
                              
                                 
                                    B
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 t
                                 )
                              
                           . The scaffold area of the 
                              i
                           th contour is partitioned with a finite number of radial lines connected between 
                              
                                 
                                    C
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 t
                                 )
                              
                            and 
                              M
                              
                                 
                                    B
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 t
                                 )
                              
                           . The space between the two lines is defined as a segment. The easiest way to construct such lines is to divide both features with an equal number of either equidistant or parametric distant points and connecting the points between them. However, such point-to-point correspondence between these features could generate twisted and intersecting lines, which would reduce the accessibility of the internal channels. Moreover, the properties or the functionality of scaffolds are changing along contour normals  [39]. Thus to increase accessibility, and to ensure the smooth property transition between the outer and inner contours, an adaptive ruled layer algorithm  [40] is developed to discretize the scaffold area with the following conditions. 
                              
                                 (a)
                                 The connecting lines must not intersect with each other.

The generated lines must be connected through a single point on 
                                       
                                          
                                             C
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                     and 
                                       M
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                    .

The line resolution must be higher than the lower width of biologically allowable pore size for cell in growth, 
                                       l
                                       
                                          
                                             l
                                          
                                          
                                             /
                                          
                                       
                                    .

The length of such lines must be the minimum possible.

The summation of the inner product of the unit normal vectors at two end points on the contour 
                                       
                                          
                                             C
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                     and the internal boundary 
                                       M
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                     is maximized.

The connecting lines must be able to generate a manifold, valid, and untangled surface.

We have a total 
                              
                                 (
                                 
                                    
                                       N
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       N
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                            number of individual points on both 
                              
                                 
                                    C
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 t
                                 )
                              
                            and 
                              M
                              
                                 
                                    B
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 t
                                 )
                              
                           ; however, the determination of how points are connected is important to avoid twisted and intersecting ruling lines, 
                              L
                              R
                           , which could generate an invalid internal architecture. For better matching of the connected ruling lines, the following two conditions must be considered. 
                              
                                 (a)
                                 The inner product of the unit normal vectors to the curves 
                                       
                                          
                                             C
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                     and 
                                       M
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                     at 
                                       
                                          
                                             p
                                          
                                          
                                             c
                                             j
                                          
                                       
                                         and  
                                       
                                          
                                             p
                                          
                                          
                                             m
                                             k
                                          
                                       
                                       ∀
                                       j
                                       ,
                                       k
                                    , respectively, is maximized. The maximum value of the inner product is equal to one when both unit normals become collinear with the ruling line, rendering 
                                       
                                          
                                             p
                                          
                                          
                                             c
                                             j
                                          
                                       
                                         and  
                                       
                                          
                                             p
                                          
                                          
                                             m
                                             k
                                          
                                       
                                     perfectly matched.

The square of the length of the ruling line, i.e.,  
                                       
                                          
                                             
                                                |
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      c
                                                      j
                                                   
                                                
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      m
                                                      k
                                                   
                                                
                                                |
                                             
                                          
                                          
                                             2
                                          
                                       
                                    , is minimized. This condition is used to prevent twisting of the ruling lines.

subject to: 
                              
                                 
                                    (5)
                                    
                                       L
                                       
                                          
                                             R
                                          
                                          
                                             s
                                          
                                       
                                       :
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      c
                                                      j
                                                   
                                                
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      m
                                                      k
                                                   
                                                
                                             
                                             ¯
                                          
                                          ⋂
                                          
                                             
                                                C
                                             
                                             
                                                i
                                             
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                          }
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                p
                                             
                                             
                                                c
                                                j
                                             
                                          
                                          }
                                       
                                       
                                       ∀
                                       j
                                       ,
                                       k
                                    
                                 
                                 
                                    (6)
                                    
                                       L
                                       
                                          
                                             R
                                          
                                          
                                             s
                                          
                                       
                                       :
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      c
                                                      j
                                                   
                                                
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      m
                                                      k
                                                   
                                                
                                             
                                             ¯
                                          
                                          ⋂
                                          M
                                          
                                             
                                                B
                                             
                                             
                                                i
                                             
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                          }
                                       
                                       =
                                       
                                          {
                                          
                                             
                                                p
                                             
                                             
                                                m
                                                k
                                             
                                          
                                          }
                                       
                                       
                                       ∀
                                       j
                                       ,
                                       k
                                    
                                 
                                 
                                    (7)
                                    
                                       L
                                       
                                          
                                             R
                                          
                                          
                                             s
                                          
                                       
                                       :
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      c
                                                      j
                                                   
                                                
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      m
                                                      k
                                                   
                                                
                                             
                                             ¯
                                          
                                          ⋂
                                          L
                                          
                                             
                                                R
                                             
                                             
                                                s
                                                −
                                                1
                                             
                                          
                                          }
                                       
                                       =
                                       0̸
                                       
                                       ∀
                                       j
                                       ,
                                       k
                                       ,
                                       s
                                       .
                                    
                                 
                              
                            During ruling line insertion, the ruling lines should intersect with the base curves 
                              
                                 
                                    C
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 t
                                 )
                              
                            and 
                              M
                              
                                 
                                    B
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 t
                                 )
                              
                            only at one single point as shown in Eqs. (5) and (6) to avoid twisting and intersecting ruling lines. Moreover, they should not intersect with each other because intersection generates invalid discretization as the same area given in Eq. (7). Thus, a ruling line needs to be inserted if it does not intersect any of the previously inserted ruling lines on the base curves 
                              
                                 
                                    C
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 t
                                 )
                              
                            and 
                              M
                              
                                 
                                    B
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 t
                                 )
                              
                           . Following the ruling line insertion, there may exist non-connected vertices on both 
                              
                                 
                                    C
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 t
                                 )
                              
                            and 
                              M
                              
                                 
                                    B
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 t
                                 )
                              
                            directrices. This may happen when the curvature of the curves changes suddenly. A vertex insertion method outlined in the literature  [39] is applied, and the additional vertices have been inserted between two occupied vertices on the shorter arc length to connect them with the unoccupied vertices on the other directrices. Thus, a scaffold layer is partitioned with 
                              N
                            number of singular segments defined as the space between the inserted ruling line sets 
                              L
                              R
                              =
                              
                                 
                                    
                                       {
                                       l
                                       
                                          
                                             r
                                          
                                          
                                             n
                                          
                                       
                                       }
                                    
                                 
                                 
                                    n
                                    =
                                    0
                                    ,
                                    1
                                    …
                                    N
                                 
                              
                           , where 
                              N
                              ≥
                              
                                 (
                                 
                                    
                                       N
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       N
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                           .

In the previous section, the ruling lines are used for discretizing the scaffold layer as shown in Fig. 4
                           (b). The space between the two adjacent ruling lines 
                              l
                              
                                 
                                    r
                                 
                                 
                                    n
                                 
                              
                            and 
                              l
                              
                                 
                                    r
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                            has been defined as segment 
                              l
                              
                                 
                                    s
                                 
                                 
                                    n
                                 
                              
                           , as shown in Fig. 4(d). Thus, the area between the external and the internal feature, 
                              
                                 
                                    
                                       A
                                    
                                 
                                 
                                    ̇
                                 
                              
                           , is decomposed into 
                              N
                            number of segments constituting the set 
                              L
                              S
                              =
                              
                                 
                                    
                                       {
                                       l
                                       
                                          
                                             s
                                          
                                          
                                             n
                                          
                                       
                                       }
                                    
                                 
                                 
                                    n
                                    =
                                    0
                                    ,
                                    1
                                    …
                                    N
                                 
                              
                           . Each segment 
                              l
                              
                                 
                                    s
                                 
                                 
                                    n
                                 
                              
                            in set 
                              L
                              S
                            is characterized by its area 
                              S
                              
                                 
                                    A
                                 
                                 
                                    n
                                 
                              
                           , lower width 
                              S
                              
                                 
                                    L
                                 
                                 
                                    n
                                 
                              
                            and upper width 
                              S
                              
                                 
                                    U
                                 
                                 
                                    n
                                 
                              
                           , i.e.,  
                              l
                              
                                 
                                    s
                                 
                                 
                                    n
                                 
                              
                              =
                              
                                 {
                                 S
                                 
                                    
                                       A
                                    
                                    
                                       n
                                    
                                 
                                 ,
                                 S
                                 
                                    
                                       L
                                    
                                    
                                       n
                                    
                                 
                                 ,
                                 S
                                 
                                    
                                       U
                                    
                                    
                                       n
                                    
                                 
                                 }
                              
                           . The lower width 
                              S
                              
                                 
                                    L
                                 
                                 
                                    n
                                 
                              
                            and the upper width 
                              S
                              
                                 
                                    U
                                 
                                 
                                    n
                                 
                              
                            of the segment are defined as the minimum width closest to 
                              M
                              
                                 
                                    B
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 t
                                 )
                              
                            and 
                              
                                 
                                    C
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 t
                                 )
                              
                           , respectively, as shown in Fig. 4(d).

By using these segments 
                              L
                              S
                            as building blocks, sub-region channels 
                              S
                              R
                            need to be constructed by accumulation which will guide the cell in-growth and nutrient/waste flow between the outer contour and the inner region. To ensure the seeded cell in-growth and their support, the geometric properties of these sub-regions must be optimized during the design processes. Thus, the 
                              d
                           th accumulated sub-region 
                              S
                              
                                 
                                    R
                                 
                                 
                                    d
                                 
                              
                            is characterized by its area 
                              R
                              
                                 
                                    A
                                 
                                 
                                    d
                                 
                              
                           , lower width 
                              R
                              
                                 
                                    S
                                 
                                 
                                    d
                                 
                              
                           , and upper width 
                              R
                              
                                 
                                    U
                                 
                                 
                                    d
                                 
                              
                           , or as 
                              S
                              
                                 
                                    R
                                 
                                 
                                    d
                                 
                              
                              =
                              
                                 {
                                 R
                                 
                                    
                                       A
                                    
                                    
                                       d
                                    
                                 
                                 ,
                                 R
                                 
                                    
                                       L
                                    
                                    
                                       d
                                    
                                 
                                 ,
                                 R
                                 
                                    
                                       U
                                    
                                    
                                       d
                                    
                                 
                                 }
                              
                              
                              ∀
                              d
                            as shown in Fig. 5
                           (a). The target values for these variables are defined as 
                              R
                              
                                 
                                    A
                                 
                                 
                                    ∗
                                 
                              
                              ,
                              R
                              
                                 
                                    L
                                 
                                 
                                    ∗
                                 
                              
                                and  
                              R
                              
                                 
                                    U
                                 
                                 
                                    ∗
                                 
                              
                           , respectively, and their values can be determined from the expected pore sizes discussed earlier.

An orderly and incremental sub-region accumulation has been performed, and the goal is to accumulate the segment sets 
                              L
                              S
                            into as few sub-regions 
                              S
                              
                                 
                                    R
                                 
                                 
                                    d
                                 
                              
                            as possible. For uniform geometry, every segment that arrives in the queue may have an identical segment, i.e. the similar variable values. In such a case, there is no uncertainty and the equal number of segments can be bundled to construct the sub-region. However, for free form geometry, the generated segment constructed by the ruling lines is anisotropic in nature and sub-region accumulation must be optimized. An optimization model is formulated as a minimization problem for sub-region construction and is expressed with Eqs. (8)–(11). 
                              
                                 (8)
                                 
                                    
                                       Min
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          d
                                       
                                    
                                    
                                       
                                          ω
                                       
                                       
                                          a
                                       
                                    
                                    
                                       (
                                       
                                          |
                                          R
                                          
                                             
                                                A
                                             
                                             
                                                d
                                             
                                          
                                          −
                                          R
                                          
                                             
                                                A
                                             
                                             
                                                ∗
                                             
                                          
                                          |
                                       
                                       )
                                    
                                    +
                                    
                                       
                                          ω
                                       
                                       
                                          l
                                       
                                    
                                    
                                       (
                                       
                                          |
                                          R
                                          
                                             
                                                L
                                             
                                             
                                                d
                                             
                                          
                                          −
                                          R
                                          
                                             
                                                L
                                             
                                             
                                                ∗
                                             
                                          
                                          |
                                       
                                       )
                                    
                                    +
                                    
                                       
                                          ω
                                       
                                       
                                          u
                                       
                                    
                                    
                                       (
                                       
                                          |
                                          R
                                          
                                             
                                                U
                                             
                                             
                                                d
                                             
                                          
                                          −
                                          R
                                          
                                             
                                                U
                                             
                                             
                                                ∗
                                             
                                          
                                          |
                                       
                                       )
                                    
                                    
                                    ∀
                                    d
                                    ,
                                 
                              
                           
                        

subject to: 
                              
                                 
                                    (9)
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             d
                                          
                                       
                                       S
                                       
                                          
                                             R
                                          
                                          
                                             d
                                          
                                       
                                       =
                                       
                                          
                                             
                                                A
                                             
                                          
                                          
                                             ̇
                                          
                                       
                                       
                                       ∀
                                       d
                                    
                                 
                                 
                                    (10)
                                    
                                       
                                          
                                             ω
                                          
                                          
                                             a
                                          
                                       
                                       +
                                       
                                          
                                             ω
                                          
                                          
                                             l
                                          
                                       
                                       +
                                       
                                          
                                             ω
                                          
                                          
                                             u
                                          
                                       
                                       =
                                       1
                                    
                                 
                                 
                                    (11)
                                    
                                       S
                                       
                                          
                                             R
                                          
                                          
                                             d
                                          
                                       
                                       ⋂
                                       S
                                       
                                          
                                             R
                                          
                                          
                                             t
                                          
                                       
                                       =
                                       ϕ
                                       
                                       ∀
                                       d
                                       ;
                                       t
                                       .
                                    
                                 
                              
                            A penalty function with weights 
                              
                                 
                                    ω
                                 
                                 
                                    a
                                 
                              
                              ,
                              
                                 
                                    ω
                                 
                                 
                                    l
                                 
                              
                           , and 
                              
                                 
                                    ω
                                 
                                 
                                    u
                                 
                              
                            is introduced for any deviation from the corresponding target values 
                              R
                              
                                 
                                    A
                                 
                                 
                                    ∗
                                 
                              
                              ,
                              R
                              
                                 
                                    L
                                 
                                 
                                    ∗
                                 
                              
                            and 
                              R
                              
                                 
                                    U
                                 
                                 
                                    ∗
                                 
                              
                           , respectively. Accumulated sub-regions must follow the area conservation, which has been defined by the constraint (9). Constraint (10) normalizes the penalty functions, and constraint (11) ensures non-intersecting sub-regions.

The accumulation of the sub-region is geometrically determined with the following algorithm. 
                              
                                 (a)
                                 The segments are obtained from an initial set 
                                       L
                                       S
                                       =
                                       
                                          
                                             
                                                {
                                                l
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      n
                                                   
                                                
                                                }
                                             
                                          
                                          
                                             n
                                             =
                                             0
                                             ,
                                             1
                                             …
                                             N
                                          
                                       
                                    .

Start with any segment as initial segment 
                                       l
                                       
                                          
                                             s
                                          
                                          
                                             i
                                          
                                       
                                     and add the consecutive segment 
                                       l
                                       
                                          
                                             s
                                          
                                          
                                             
                                                (
                                                i
                                                +
                                                1
                                                )
                                             
                                          
                                       
                                     into the end of the queue.

Determine their accumulation following their properties 
                                       S
                                       
                                          
                                             R
                                          
                                          
                                             d
                                          
                                       
                                       =
                                       
                                          {
                                          R
                                          
                                             
                                                A
                                             
                                             
                                                d
                                             
                                          
                                          ,
                                          R
                                          
                                             
                                                L
                                             
                                             
                                                d
                                             
                                          
                                          ,
                                          R
                                          
                                             
                                                U
                                             
                                             
                                                d
                                             
                                          
                                          }
                                       
                                    .


                                    If (
                                       R
                                       
                                          
                                             A
                                          
                                          
                                             d
                                          
                                       
                                       ≈
                                       R
                                       
                                          
                                             A
                                          
                                          
                                             ∗
                                          
                                       
                                       ;
                                       R
                                       
                                          
                                             L
                                          
                                          
                                             d
                                          
                                       
                                       ≈
                                       R
                                       
                                          
                                             L
                                          
                                          
                                             ∗
                                          
                                       
                                       ;
                                       R
                                       
                                          
                                             U
                                          
                                          
                                             d
                                          
                                       
                                       ≈
                                       R
                                       
                                          
                                             U
                                          
                                          
                                             ∗
                                          
                                       
                                    ) /*** The variables satisfy the acceptable property range***/


                                    Then
                                 

{Cut the queue;


                                    Add penalty cost to the objective value in the Eq. (8);


                                    Accumulate the sub-region, and Start a new queue; }


                                    If (
                                       R
                                       
                                          
                                             A
                                          
                                          
                                             d
                                          
                                       
                                       <
                                       R
                                       
                                          
                                             A
                                          
                                          
                                             ∗
                                          
                                       
                                       ;
                                       R
                                       
                                          
                                             L
                                          
                                          
                                             d
                                          
                                       
                                       <
                                       R
                                       
                                          
                                             L
                                          
                                          
                                             ∗
                                          
                                       
                                       ;
                                       R
                                       
                                          
                                             U
                                          
                                          
                                             d
                                          
                                       
                                       <
                                       R
                                       
                                          
                                             U
                                          
                                          
                                             ∗
                                          
                                       
                                    ) /*** The variables properties are short of the acceptable property range***/


                                    Then
                                 

{Add a consecutive segment to the queue; }


                                    If (
                                       R
                                       
                                          
                                             A
                                          
                                          
                                             d
                                          
                                       
                                       >
                                       R
                                       
                                          
                                             A
                                          
                                          
                                             ∗
                                          
                                       
                                       ;
                                       R
                                       
                                          
                                             L
                                          
                                          
                                             d
                                          
                                       
                                       >
                                       R
                                       
                                          
                                             L
                                          
                                          
                                             ∗
                                          
                                       
                                       ;
                                       R
                                       
                                          
                                             U
                                          
                                          
                                             d
                                          
                                       
                                       >
                                       R
                                       
                                          
                                             U
                                          
                                          
                                             ∗
                                          
                                       
                                    ) /*** The variables properties are above the acceptable property range***/


                                    Then
                                 

{Cut the queue to the previous segment;


                                    Add penalty cost to the objective value in the Eq. (8);


                                    Start the new queue with the current segment as the initial segment }

Continue step (c) until all 
                                       N
                                     segments are accumulated.

Change the initial segment 
                                       i
                                       ←
                                       
                                          (
                                          i
                                          +
                                          1
                                          )
                                       
                                       :
                                       
                                          (
                                          i
                                          +
                                          1
                                          )
                                       
                                       <
                                       N
                                     and continue the processes (step (a)–(d)) to find the minimum objective function value.

The generated sub-regions are constructed between 
                           M
                           
                              
                                 B
                              
                              
                                 i
                              
                           
                           
                              (
                              t
                              )
                           
                         and 
                           
                              
                                 C
                              
                              
                                 i
                              
                           
                           
                              (
                              t
                              )
                           
                         and act as a channel between them. Their alignment depends upon the outer contour profile as well as the ruling line density. Building a 3D structure by stacking the sub-region layers may be possible; however, this would significantly impede the connectivity within the scaffold area as well as the structural integrity since this may build a solid wall rather than a porous boundary. Since the properties or the functionality of scaffolds are changing toward the inner region, the designed porosity has to follow the shape of the scaffold. Thus iso-porosity regions are introduced which will follow the shape of the scaffold as shown in Fig. 6
                        (a). To build the iso-porosity region each sub-region is partitioned according to the porosity with iso-porosity line segments as shown in Fig. 6(b). The porosity has been interpreted into area by modeling the pore cell methodology discussed in our previous work  [38]. Each sub-region is separated from its adjacent neighbor by a boundary line which itself is a ruling line and represent by sub-region boundary line set, 
                           S
                           R
                           A
                           =
                           
                              
                                 
                                    {
                                    S
                                    R
                                    
                                       
                                          A
                                       
                                       
                                          d
                                       
                                    
                                    }
                                 
                              
                              
                                 l
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 …
                                 ,
                                 D
                              
                           
                        , where 
                           S
                           R
                           A
                           ⊆
                           L
                           R
                         as shown in Fig. 6(b). Dividing the sub-region with the iso-porosity line segments across those boundary lines 
                           S
                           R
                           A
                         will generate the desired pore size defined as pore cell 
                           P
                           
                              
                                 C
                              
                              
                                 d
                                 ,
                                 p
                              
                           
                         as shown in Fig. 6(b)–(c), where, 
                           P
                           
                              
                                 C
                              
                              
                                 d
                                 ,
                                 p
                              
                           
                         is the 
                           p
                        th pore cell in the 
                           d
                        th sub-region 
                           S
                           
                              
                                 R
                              
                              
                                 d
                              
                           
                        .

The number of pore cells, 
                           p
                           =
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           P
                        , in each sub-region 
                           S
                           
                              
                                 R
                              
                              
                                 d
                              
                           
                         depends upon the available area and desired porosity gradient. The number of pore cells need to be the same for all sub-regions to ensure equal number of iso-porosity region across the geometry which will make sure a continuous and interconnected deposition path plan during fabrication. The desired porosity has been interpreted into area and the sub-regions are divided accordingly. The acceptable pore size reported in the literature  [14,15] considers isotropic geometry, i.e., sphere, cube or cylinder. Because of the free-form shape of the outer contour and the accumulation pattern, the generated sub-regions will have anisotropic shapes as shown in Fig. 5(b). Thus, the acceptable pore size needs to be calculated from the approximating sphere diameter and can be measured by the following equations. 
                           
                              
                                 (12)
                                 
                                    
                                       
                                          P
                                       
                                       
                                          
                                             min
                                          
                                       
                                    
                                    =
                                    
                                       
                                          R
                                          
                                             
                                                A
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                       
                                          max
                                          
                                             (
                                             p
                                             
                                                
                                                   d
                                                
                                                
                                                   
                                                      max
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             R
                                             
                                                
                                                   L
                                                
                                                
                                                   d
                                                   ,
                                                   max
                                                
                                             
                                             ×
                                             p
                                             
                                                
                                                   d
                                                
                                                
                                                   
                                                      min
                                                   
                                                
                                             
                                             ,
                                             R
                                             
                                                
                                                   U
                                                
                                                
                                                   d
                                                   ,
                                                   max
                                                
                                             
                                             ×
                                             p
                                             
                                                
                                                   d
                                                
                                                
                                                   
                                                      min
                                                   
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                    ∀
                                    d
                                 
                              
                              
                                 (13)
                                 
                                    
                                       
                                          P
                                       
                                       
                                          
                                             max
                                          
                                       
                                    
                                    =
                                    
                                       
                                          R
                                          
                                             
                                                A
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                       
                                          min
                                          
                                             (
                                             p
                                             
                                                
                                                   d
                                                
                                                
                                                   
                                                      min
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             R
                                             
                                                
                                                   L
                                                
                                                
                                                   d
                                                   ,
                                                   max
                                                
                                             
                                             ×
                                             p
                                             
                                                
                                                   d
                                                
                                                
                                                   
                                                      min
                                                   
                                                
                                             
                                             ,
                                             R
                                             
                                                
                                                   U
                                                
                                                
                                                   d
                                                   ,
                                                   max
                                                
                                             
                                             ×
                                             p
                                             
                                                
                                                   d
                                                
                                                
                                                   
                                                      min
                                                   
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                    ∀
                                    d
                                    .
                                 
                              
                           
                         Here, 
                           
                              
                                 P
                              
                              
                                 
                                    min
                                 
                              
                           
                         and 
                           
                              
                                 P
                              
                              
                                 
                                    max
                                 
                              
                           
                         are the minimum and the maximum number of pore cells that can fit in the designed sub-regions. 
                           p
                           
                              
                                 d
                              
                              
                                 
                                    min
                                 
                              
                           
                         and 
                           p
                           
                              
                                 d
                              
                              
                                 
                                    max
                                 
                              
                           
                         are the minimum and the maximum allowable pore size. The 
                           R
                           
                              
                                 L
                              
                              
                                 d
                                 ,
                                 max
                              
                           
                         and 
                           R
                           
                              
                                 U
                              
                              
                                 d
                                 ,
                                 max
                              
                           
                         are the maximum upper and lower widths for all generated sub-regions. The line connecting the sub-region’s boundary lines 
                           S
                           R
                           
                              
                                 A
                              
                              
                                 d
                              
                           
                         and 
                           S
                           R
                           
                              
                                 A
                              
                              
                                 d
                                 +
                                 1
                              
                           
                         for partitioning is called iso-porosity line segments, 
                           P
                           C
                           L
                           =
                           
                              
                                 
                                    {
                                    P
                                    C
                                    
                                       
                                          L
                                       
                                       
                                          d
                                          ,
                                          p
                                       
                                    
                                    }
                                 
                              
                              
                                 d
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 …
                                 ,
                                 D
                                 ;
                                 p
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 …
                                 ,
                                 
                                    (
                                    P
                                    −
                                    1
                                    )
                                 
                              
                           
                        . Here the 
                           P
                           C
                           
                              
                                 L
                              
                              
                                 d
                                 ,
                                 p
                              
                           
                         represents the iso-porosity line segments for 
                           p
                        th pore cell in sub-region 
                           S
                           
                              
                                 R
                              
                              
                                 d
                              
                           
                        . Each iso-porosity line segments 
                           P
                           C
                           
                              
                                 L
                              
                              
                                 d
                                 ,
                                 p
                              
                           
                         is defined by its two end points, 
                           C
                           
                              
                                 S
                              
                              
                                 d
                                 ,
                                 p
                              
                           
                         and 
                           C
                           
                              
                                 E
                              
                              
                                 
                                    (
                                    d
                                    +
                                    1
                                    )
                                 
                                 ,
                                 p
                              
                           
                        , i.e.,  
                           P
                           C
                           
                              
                                 L
                              
                              
                                 d
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                           =
                           
                              
                                 C
                                 
                                    
                                       S
                                    
                                    
                                       d
                                       ,
                                       p
                                    
                                 
                                 C
                                 
                                    
                                       E
                                    
                                    
                                       
                                          (
                                          d
                                          +
                                          1
                                          )
                                       
                                       ,
                                       p
                                    
                                 
                              
                              ¯
                           
                         as shown in Fig. 6(b). All the cell points for this layer can be represented as the cell point sets 
                           C
                           S
                           =
                           
                              
                                 
                                    {
                                    C
                                    
                                       
                                          S
                                       
                                       
                                          d
                                          ,
                                          p
                                       
                                    
                                    }
                                 
                              
                              
                                 
                                    
                                    
                                       d
                                       =
                                       0
                                       ,
                                       1
                                       ,
                                       …
                                       ,
                                       D
                                       ;
                                       p
                                       =
                                       0
                                       ,
                                       1
                                       ,
                                       …
                                       ,
                                       
                                          (
                                          P
                                          −
                                          1
                                          )
                                       
                                    
                                 
                              
                           
                         and 
                           C
                           E
                           =
                           
                              
                                 
                                    {
                                    C
                                    
                                       
                                          E
                                       
                                       
                                          d
                                          ,
                                          p
                                       
                                    
                                    }
                                 
                              
                              
                                 d
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 …
                                 ,
                                 D
                                 ;
                                 p
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 …
                                 ,
                                 
                                    (
                                    P
                                    −
                                    1
                                    )
                                 
                              
                           
                        .

The following optimization method is used to divide the sub-regions into pore cells. 
                           
                              (14)
                              
                                 
                                    Min
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       d
                                       =
                                       0
                                    
                                    
                                       D
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       p
                                       =
                                       0
                                    
                                    
                                       P
                                    
                                 
                                 
                                    |
                                    P
                                    
                                       
                                          C
                                       
                                       
                                          p
                                       
                                       
                                          ∗
                                       
                                    
                                    −
                                    P
                                    
                                       
                                          C
                                       
                                       
                                          d
                                          ,
                                          p
                                       
                                    
                                    |
                                 
                                 
                                 ∀
                                 p
                                 ;
                                 d
                              
                           
                         subject to: 
                           
                              
                                 (15)
                                 
                                    
                                       
                                          P
                                       
                                       
                                          
                                             min
                                          
                                       
                                    
                                    ≤
                                    P
                                    ≤
                                    
                                       
                                          P
                                       
                                       
                                          
                                             max
                                          
                                       
                                    
                                 
                              
                              
                                 (16)
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          p
                                          =
                                          0
                                       
                                       
                                          P
                                       
                                    
                                    P
                                    
                                       
                                          C
                                       
                                       
                                          d
                                          ,
                                          p
                                       
                                    
                                    =
                                    S
                                    
                                       
                                          R
                                       
                                       
                                          d
                                       
                                    
                                    
                                    ∀
                                    d
                                 
                              
                              
                                 (17)
                                 
                                    P
                                    
                                       
                                          C
                                       
                                       
                                          m
                                          ,
                                          p
                                       
                                    
                                    =
                                    P
                                    
                                       
                                          C
                                       
                                       
                                          n
                                          ,
                                          p
                                       
                                    
                                    
                                    ∀
                                    p
                                    ;
                                    m
                                    ∈
                                    D
                                    ;
                                    n
                                    ∈
                                    D
                                    .
                                 
                              
                           
                         The constraint in Eq. (15) ensures the number of pore cell falls within the allowable range. The generated pore cells follow the conservation of area rule, i.e., sum area of all 
                           P
                         pore cells 
                           P
                           
                              
                                 C
                              
                              
                                 d
                                 ,
                                 p
                              
                           
                         has the same area as the sub-region 
                           S
                           
                              
                                 R
                              
                              
                                 d
                              
                           
                         which is introduced as a constraint in Eq. (16). The porosity in each pore cell with the same numerical location at any sub-region is the same, and the constraint is defined by Eq. (17). This minimization problem reduces the deviation from the desired or expected pore cell area, 
                           P
                           
                              
                                 C
                              
                              
                                 p
                              
                              
                                 ∗
                              
                           
                         with the generated pore cell, 
                           P
                           
                              
                                 C
                              
                              
                                 d
                                 ,
                                 p
                              
                           
                        .

Thus the desired controllable porosity gradient can be achieved with iso-porosity region constructed by the pore cells. The height 
                           2
                           
                              
                                 d
                              
                              
                                 s
                              
                           
                         of the pore cell is the same as the height of the two layers, i.e. two times the diameter of the filament as shown in Fig. 6(c). By stacking successive 
                           i
                        th and 
                           
                              (
                              i
                              +
                              1
                              )
                           
                        th layers, a 3D fully interconnected and continuous porous architecture is achieved. Moreover, the iso-porosity line segments cross at the support points for sub-regions above, which has been widely used in layer-by-layer manufacturing, as each layer supports the consecutive layer.

Connecting the cell point, 
                           C
                           
                              
                                 S
                              
                              
                                 d
                                 ,
                                 p
                              
                           
                         and 
                           C
                           
                              
                                 E
                              
                              
                                 
                                    (
                                    d
                                    +
                                    1
                                    )
                                 
                                 ,
                                 p
                              
                           
                         of all iso-porosity line segments (PCL) gradually will generate a piecewise linear iso-porosity curve shown in Fig. 6. As shown in Fig. 6(a), the iso-porosity curve is closed but not smooth and for a better fabrication results, iso-porosity curve needs to be smoothed.

The proposed bi-layer pore design represents the controllable and desired gradient porosity along the scaffold architecture. To ensure the proper additive manufacturing, a feasible tool-path plan needs to be developed that would minimize the deviation between the design and the actual fabricated structure. Even though some earlier research emphasized on the variational porosity design, the fabrication procedure with existing techniques remains a challenge. In this work, a continuous deposition path planning method has been proposed to fabricate the designed scaffold with additive manufacturing techniques ensuring connectivity of the internal channel network. A layer-by-layer deposition is progressed through consecutive layers with zigzag pattern crossing the sub-region boundary line followed by an iso-porosity deposition path planning.

To generate the designed sub-regions in the 
                           i
                        th layer, the tool-path has been planned through the sub-region’s boundary lines, 
                           S
                           R
                           A
                        , and bridging the medial region to generate a continuous material deposition path-plan. Crossing the medial region along the path-plan will provide the structural integrity for the overall scaffold architecture and divide the long medial region channel into smaller pore size. Thus, at first we extended the sub-region’s boundary lines, 
                           S
                           R
                           A
                         toward the medial axis crossing the medial region and then a path-planning algorithm has been developed to generate the continuous path for the sub-region layer fabrication.

Each sub-region from set 
                           S
                           R
                         has a boundary line 
                           S
                           R
                           A
                           =
                           
                              
                                 
                                    {
                                    S
                                    R
                                    
                                       
                                          A
                                       
                                       
                                          d
                                       
                                    
                                    }
                                 
                              
                              
                                 l
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 …
                                 ,
                                 D
                              
                           
                        , which is also a ruling line that can be represented with the two end point sets, 
                           A
                           S
                           =
                           
                              
                                 
                                    {
                                    a
                                    
                                       
                                          s
                                       
                                       
                                          d
                                       
                                    
                                    }
                                 
                              
                              
                                 d
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 …
                                 ,
                                 D
                              
                           
                         and 
                           A
                           E
                           =
                           
                              
                                 
                                    {
                                    a
                                    
                                       
                                          e
                                       
                                       
                                          d
                                       
                                    
                                    }
                                 
                              
                              
                                 d
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 …
                                 ,
                                 D
                              
                           
                        , as shown in Fig. 7
                        . Here, 
                           a
                           
                              
                                 s
                              
                              
                                 d
                              
                           
                         and 
                           a
                           
                              
                                 e
                              
                              
                                 d
                              
                           
                         are the starting and ending points of the 
                           d
                        th boundary line 
                           S
                           R
                           
                              
                                 A
                              
                              
                                 d
                              
                           
                         intersected with 
                           
                              
                                 C
                              
                              
                                 i
                              
                           
                           
                              (
                              t
                              )
                           
                         and 
                           M
                           
                              
                                 B
                              
                              
                                 i
                              
                           
                           
                              (
                              t
                              )
                           
                         respectively. Each point 
                           a
                           
                              
                                 e
                              
                              
                                 d
                              
                           
                         has been projected over the medial axis along the inward direction 
                           
                              
                                 
                                    
                                       N
                                    
                                    
                                       ⃗
                                    
                                 
                              
                              
                                 a
                                 
                                    
                                       e
                                    
                                    
                                       d
                                    
                                 
                              
                           
                           ∀
                           d
                        , where 
                           
                              
                                 
                                    
                                       N
                                    
                                    
                                       ⃗
                                    
                                 
                              
                              
                                 a
                                 
                                    
                                       e
                                    
                                    
                                       d
                                    
                                 
                              
                           
                         is the unit normal vector on 
                           M
                           
                              
                                 B
                              
                              
                                 i
                              
                           
                           
                              (
                              t
                              )
                           
                         at a point 
                           a
                           
                              
                                 e
                              
                              
                                 d
                              
                           
                        . The projected line from point 
                           a
                           
                              
                                 e
                              
                              
                                 d
                              
                           
                         intersects with the medial axis, 
                           
                              
                                 M
                              
                              
                                 i
                              
                           
                         at a location 
                           a
                           
                              
                                 e
                              
                              
                                 d
                              
                              
                                 /
                              
                           
                         and generates a new point set 
                           A
                           
                              
                                 E
                              
                              
                                 /
                              
                           
                           =
                           
                              
                                 
                                    {
                                    a
                                    
                                       
                                          e
                                       
                                       
                                          d
                                       
                                       
                                          /
                                       
                                    
                                    }
                                 
                              
                              
                                 d
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 …
                                 ,
                                 D
                              
                           
                         on the medial axis as shown in Fig. 7. Such a methodology would bring the lower width of each sub-region onto the medial axis and provide the opportunity for a continuous tool-path during fabrication through the medial region with the extended line segment 
                           
                              
                                 a
                                 
                                    
                                       e
                                    
                                    
                                       d
                                    
                                 
                                 a
                                 
                                    
                                       e
                                    
                                    
                                       d
                                    
                                    
                                       /
                                    
                                 
                              
                              ¯
                           
                        .

An algorithm has been developed to generate a continuous tool-path through the start point, end point and projected point sets 
                           A
                           S
                           =
                           
                              
                                 
                                    {
                                    a
                                    
                                       
                                          s
                                       
                                       
                                          d
                                       
                                    
                                    }
                                 
                              
                              
                                 d
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 …
                                 ,
                                 D
                              
                           
                           ,
                           A
                           E
                           =
                           
                              
                                 
                                    {
                                    a
                                    
                                       
                                          e
                                       
                                       
                                          d
                                       
                                    
                                    }
                                 
                              
                              
                                 d
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 …
                                 ,
                                 D
                              
                           
                             and  
                           A
                           
                              
                                 E
                              
                              
                                 /
                              
                           
                           =
                           
                              
                                 
                                    {
                                    a
                                    
                                       
                                          e
                                       
                                       
                                          d
                                       
                                       
                                          /
                                       
                                    
                                    }
                                 
                              
                              
                                 d
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 …
                                 ,
                                 D
                              
                           
                        , respectively, considering the minimum amount of over-deposition as well as starts and stops, as shown in Fig. 8
                        .

The tool-path needs to start with a sub-region boundary line closest to the end point of the medial axis (Fig. 8) while starting of the tool-path on another location might increase the number of discontinuities during the deposition process. In addition, if the number of the sub-region’s boundary lines is odd, then the tool-path should start from the external feature, i.e., from a point on the contour 
                           
                              
                                 C
                              
                              
                                 i
                              
                           
                           
                              (
                              t
                              )
                           
                        , otherwise from a point on the 
                           M
                           
                              
                                 B
                              
                              
                                 i
                              
                           
                           
                              (
                              t
                              )
                           
                         to reduce or eliminate any possible discontinuity or jumps. Moreover, if the decomposed points 
                           a
                           
                              
                                 e
                              
                              
                                 c
                              
                              
                                 /
                              
                           
                         and 
                           a
                           
                              
                                 e
                              
                              
                                 b
                              
                              
                                 /
                              
                           
                         are aligned with the line segment 
                           
                              
                                 a
                                 
                                    
                                       e
                                    
                                    
                                       c
                                    
                                 
                                 a
                                 
                                    
                                       e
                                    
                                    
                                       b
                                    
                                 
                              
                              ¯
                           
                        , that connect their generator points, then the decomposed points are eliminated 
                           ∀
                           a
                           
                              
                                 e
                              
                              
                                 c
                              
                              
                                 /
                              
                           
                             and  
                           a
                           
                              
                                 e
                              
                              
                                 b
                              
                              
                                 /
                              
                           
                           ∈
                           A
                           
                              
                                 E
                              
                              
                                 /
                              
                           
                        . Such elimination would increase the continuity during material deposition. The algorithm describing the tool-path generation for the sub-region layer is presented in the Appendix.

The iso-porosity curve in the 
                           
                              (
                              i
                              +
                              1
                              )
                           
                        th layer can be constructed as a set of piecewise line segments through the inserted cell points 
                           C
                           
                              
                                 S
                              
                              
                                 d
                                 ,
                                 p
                              
                           
                         and 
                           C
                           
                              
                                 E
                              
                              
                                 
                                    (
                                    d
                                    +
                                    1
                                    )
                                 
                                 ,
                                 p
                              
                           
                         as shown in Fig. 6; however, this can cause discrete deposited filaments because of the stepping and needs to be smoothed for a uniform deposition. Besides, the number of points on the iso-porosity curve requires a large number of tool-path points during fabrication. Linear and circular motions provide better control of the deposition speed along its path precisely for additive manufacturing processes. Thus, a curve-fitting methodology is used to ensure a smooth and continuous path. However, the distribution of cell points may not be suitable for curve fitting techniques, i.e., each sub-region’s boundary line contains two adjacent cell points and this can skew curve fitting unexpectedly. Instead, a two-step smoothing for iso-porosity path is proposed to achieve a continuous tool-path suitable for fabrication. The first step refines the cell point distribution and then a biarc fitting technique has been developed to generate 
                           
                              
                                 C
                              
                              
                                 1
                              
                           
                         continuity in iso-porosity region path planning.

The iso-porosity curve generated by connecting the gradual cell points could have a stepping due to two cell points 
                              C
                              
                                 
                                    S
                                 
                                 
                                    d
                                    ,
                                    p
                                 
                              
                            and 
                              C
                              
                                 
                                    E
                                 
                                 
                                    d
                                    ,
                                    p
                                 
                              
                              
                              ∀
                              d
                              ;
                              p
                            on the same sub-region boundary lines 
                              S
                              R
                              
                                 
                                    A
                                 
                                 
                                    d
                                 
                              
                              
                              ∀
                              d
                           . To smooth these stepped line segments, the two cell points 
                              C
                              
                                 
                                    S
                                 
                                 
                                    d
                                    ,
                                    p
                                 
                              
                            and 
                              C
                              
                                 
                                    E
                                 
                                 
                                    d
                                    ,
                                    p
                                 
                              
                              
                              ∀
                              d
                              ;
                              p
                            need to be replaced with a single refined cell points, 
                              R
                              
                                 
                                    K
                                 
                                 
                                    d
                                    ,
                                    p
                                 
                              
                              
                              ∀
                              d
                              ,
                              p
                           . An area weight-based point insertion algorithm has been developed to generate the refined cell points, 
                              R
                              
                                 
                                    K
                                 
                                 
                                    d
                                    ,
                                    p
                                 
                              
                           . The refined points, 
                              R
                              
                                 
                                    K
                                 
                                 
                                    d
                                    ,
                                    p
                                 
                              
                            are located on the line segment 
                              
                                 
                                    C
                                    
                                       
                                          S
                                       
                                       
                                          d
                                          ,
                                          p
                                       
                                    
                                    C
                                    
                                       
                                          E
                                       
                                       
                                          d
                                          ,
                                          p
                                       
                                    
                                 
                                 ¯
                              
                            based on the corresponding location of the iso-porosity line segment as shown in Fig. 9
                           . Mathematically, the location of this weighted point 
                              R
                              
                                 
                                    K
                                 
                                 
                                    d
                                    ,
                                    p
                                 
                              
                            can be expressed as: 
                              
                                 (18)
                                 
                                    R
                                    
                                       
                                          K
                                       
                                       
                                          d
                                          ,
                                          p
                                       
                                    
                                    =
                                    C
                                    
                                       
                                          E
                                       
                                       
                                          d
                                          ,
                                          p
                                       
                                    
                                    +
                                    w
                                    
                                       |
                                       C
                                       
                                          
                                             S
                                          
                                          
                                             d
                                             ,
                                             p
                                          
                                       
                                       C
                                       
                                          
                                             E
                                          
                                          
                                             d
                                             ,
                                             p
                                          
                                       
                                       |
                                    
                                    
                                       
                                          
                                             
                                                C
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      d
                                                      ,
                                                      p
                                                   
                                                
                                                C
                                                
                                                   
                                                      E
                                                   
                                                   
                                                      d
                                                      ,
                                                      p
                                                   
                                                
                                             
                                             
                                                ⃗
                                             
                                          
                                       
                                       
                                          
                                             ‖
                                             
                                                
                                                   C
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         d
                                                         ,
                                                         p
                                                      
                                                   
                                                   C
                                                   
                                                      
                                                         E
                                                      
                                                      
                                                         d
                                                         ,
                                                         p
                                                      
                                                   
                                                
                                                
                                                   ⃗
                                                
                                             
                                             ‖
                                          
                                       
                                    
                                    .
                                 
                              
                            Here, the weight, 
                              w
                            represents the ratio 
                              
                                 
                                    
                                       Area
                                    
                                    _
                                    
                                       (
                                       C
                                       
                                          
                                             S
                                          
                                          
                                             d
                                             −
                                             1
                                             ,
                                             p
                                          
                                       
                                       C
                                       
                                          
                                             S
                                          
                                          
                                             d
                                             ,
                                             p
                                          
                                       
                                       C
                                       
                                          
                                             E
                                          
                                          
                                             d
                                             ,
                                             p
                                          
                                       
                                       )
                                    
                                 
                                 
                                    
                                       Area
                                    
                                    _
                                    
                                       (
                                       C
                                       
                                          
                                             S
                                          
                                          
                                             d
                                             −
                                             1
                                             ,
                                             p
                                          
                                       
                                       C
                                       
                                          
                                             S
                                          
                                          
                                             d
                                             ,
                                             p
                                          
                                       
                                       C
                                       
                                          
                                             E
                                          
                                          
                                             d
                                             ,
                                             p
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       Area
                                    
                                    _
                                    
                                       (
                                       C
                                       
                                          
                                             E
                                          
                                          
                                             d
                                             +
                                             1
                                             ,
                                             p
                                          
                                       
                                       C
                                       
                                          
                                             S
                                          
                                          
                                             d
                                             ,
                                             p
                                          
                                       
                                       C
                                       
                                          
                                             E
                                          
                                          
                                             d
                                             ,
                                             p
                                          
                                       
                                       )
                                    
                                 
                              
                            shown in Fig. 9. The proposed algorithm would generate a refined cell point set, 
                              R
                              K
                              =
                              
                                 
                                    
                                       {
                                       R
                                       
                                          
                                             K
                                          
                                          
                                             d
                                             ,
                                             p
                                          
                                       
                                       }
                                    
                                 
                                 
                                    d
                                    =
                                    0
                                    ,
                                    1
                                    ,
                                    …
                                    ,
                                    D
                                    ;
                                    p
                                    =
                                    0
                                    ,
                                    1
                                    ,
                                    …
                                    ,
                                    
                                       (
                                       P
                                       −
                                       1
                                       )
                                    
                                 
                              
                            and connecting two adjacent points would generate a refined iso-porosity line segment (RPCL), 
                              R
                              P
                              C
                              
                                 
                                    L
                                 
                                 
                                    d
                                    ,
                                    p
                                 
                              
                              =
                              
                                 
                                    R
                                    
                                       
                                          K
                                       
                                       
                                          d
                                          ,
                                          p
                                       
                                    
                                    R
                                    
                                       
                                          K
                                       
                                       
                                          d
                                          +
                                          1
                                          ,
                                          p
                                       
                                    
                                 
                                 ¯
                              
                             and the set of refined RPCL line segments is represented as 
                              R
                              P
                              C
                              L
                              =
                              
                                 
                                    
                                       {
                                       R
                                       P
                                       C
                                       
                                          
                                             L
                                          
                                          
                                             d
                                             ,
                                             p
                                          
                                       
                                       }
                                    
                                 
                                 
                                    d
                                    =
                                    0
                                    ,
                                    1
                                    ,
                                    …
                                    ,
                                    D
                                    ;
                                    p
                                    =
                                    0
                                    ,
                                    1
                                    ,
                                    …
                                    ,
                                    
                                       (
                                       P
                                       −
                                       1
                                       )
                                    
                                 
                              
                           . Connecting RPCL consecutively would form a piecewise closed linear curve as shown in Fig. 9. This will eliminate the stepping issue but could result in over-deposition at the refined cell points because of possible directional changes. A planar iso-porosity curve with 
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                            continuity could provide the required smoothness while maintaining the iso-porosity regions. Thus a bi-arc fitting through those refined cell points would be more appropriate for a smooth deposition path.

A biarc curve can be defined as two consecutive arcs with identical tangents at the junction point that preserves 
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                            continuity while maintaining a given accuracy. When applied to a series of points, it determines a piecewise circular arc interpolation of given points. Because of the distribution of cell points, both C- and S-type biarc shapes need to be generated for precisely following the cell points’ patterns.

The following information is required to construct biarc  [41,42]. 
                              
                                 (a)
                                 The number of points (
                                       D
                                    ) through which it must pass.

The coordinate 
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                     of the point 
                                       R
                                       K
                                       =
                                       
                                          
                                             
                                                {
                                                R
                                                
                                                   
                                                      K
                                                   
                                                   
                                                      d
                                                      ,
                                                      p
                                                   
                                                
                                                }
                                             
                                          
                                          
                                             d
                                             =
                                             0
                                             ,
                                             1
                                             ,
                                             …
                                             ,
                                             D
                                             ;
                                             p
                                             =
                                             0
                                             ,
                                             1
                                             ,
                                             …
                                             ,
                                             
                                                (
                                                P
                                                −
                                                1
                                                )
                                             
                                          
                                       
                                    .

The tangent at the first and last points.

Some conventions are used  [42] as: 
                              
                                 (a)
                                 Arc 
                                       
                                          
                                             A
                                          
                                          
                                             1
                                          
                                       
                                     must pass through the cell point 
                                       R
                                       
                                          
                                             K
                                          
                                          
                                             s
                                          
                                       
                                    , and arc 
                                       
                                          
                                             A
                                          
                                          
                                             2
                                          
                                       
                                     must pass through the cell point 
                                       R
                                       
                                          
                                             K
                                          
                                          
                                             e
                                          
                                       
                                     with the tangents 
                                       
                                          
                                             t
                                          
                                          
                                             s
                                          
                                       
                                     and 
                                       
                                          
                                             t
                                          
                                          
                                             e
                                          
                                       
                                    , respectively.

The junction point 
                                       J
                                     has been determined by minimizing the difference in the curvature technique.

A positive angle is defined as the counterclockwise direction from the vector 
                                       
                                          
                                             R
                                             
                                                
                                                   K
                                                
                                                
                                                   s
                                                
                                             
                                             R
                                             
                                                
                                                   K
                                                
                                                
                                                   e
                                                
                                             
                                          
                                          
                                             ⃗
                                          
                                       
                                     to the corresponding tangent vector.

If 
                                       α
                                       =
                                       β
                                       =
                                       0
                                    , the associated arc is a straight line; the biarc is C-shaped if 
                                       α
                                     and 
                                       β
                                     have the same sign; otherwise it is S-shaped.

Minimizing the Hausdorff distance  [44] technique has been used for error control.

The tangent vector at each cell point has been approximated by interpolating the three consecutive neighboring cell points  [45].

The iso-porosity curve is generated by initializing the tool-path at the first refined cell point 
                              R
                              
                                 
                                    K
                                 
                                 
                                    d
                                    =
                                    1
                                 
                              
                              →
                              R
                              
                                 
                                    K
                                 
                                 
                                    s
                                 
                              
                           . Then a biarc is fitted for the point set 
                              P
                              S
                              =
                              
                                 {
                                 R
                                 
                                    
                                       K
                                    
                                    
                                       d
                                    
                                 
                                 ,
                                 R
                                 
                                    
                                       K
                                    
                                    
                                       d
                                       +
                                       1
                                    
                                 
                                 ,
                                 R
                                 
                                    
                                       K
                                    
                                    
                                       d
                                       +
                                       2
                                    
                                 
                                 }
                              
                           , and the fitting accuracy of a biarc has been determined based on the one-sided Hausdorff distance  [44]. Even though, the biarc has been constructed from the point set 
                              R
                              K
                           , the fitting accuracy must be measured from the actual cell point sets 
                              C
                              S
                              =
                              
                                 
                                    
                                       {
                                       C
                                       
                                          
                                             S
                                          
                                          
                                             d
                                             ,
                                             p
                                          
                                       
                                       }
                                    
                                 
                                 
                                    
                                       
                                       
                                          d
                                          =
                                          0
                                          ,
                                          1
                                          ,
                                          …
                                          ,
                                          D
                                          ;
                                          p
                                          =
                                          0
                                          ,
                                          1
                                          ,
                                          …
                                          ,
                                          
                                             (
                                             P
                                             −
                                             1
                                             )
                                          
                                       
                                    
                                 
                              
                            and 
                              C
                              E
                              =
                              
                                 
                                    
                                       {
                                       C
                                       
                                          
                                             E
                                          
                                          
                                             d
                                             ,
                                             p
                                          
                                       
                                       }
                                    
                                 
                                 
                                    
                                       
                                       
                                          d
                                          =
                                          0
                                          ,
                                          1
                                          ,
                                          …
                                          ,
                                          D
                                          ;
                                          p
                                          =
                                          0
                                          ,
                                          1
                                          ,
                                          …
                                          ,
                                          
                                             (
                                             P
                                             −
                                             1
                                             )
                                          
                                       
                                    
                                 
                              
                            to maintain minimum deviation from the actually computed pore size as shown in Fig. 10
                           .

The Hausdorff distance provides a robust, simple and computationally acceptable curve-fitting quality measure methodology and can produce a smaller number of biarcs from the cell points.

The Hausdorff distance between two given sets of points 
                              
                                 A
                              
                              =
                              
                                 
                                    
                                       {
                                       
                                          
                                             a
                                          
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       }
                                    
                                 
                                 
                                    
                                       
                                          h
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              =
                              0
                              ,
                              1
                              ,
                              …
                              ,
                              
                                 
                                    H
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 B
                              
                              =
                              
                                 
                                    
                                       {
                                       
                                          
                                             b
                                          
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                       }
                                    
                                 
                                 
                                    
                                       
                                          h
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              =
                              0
                              ,
                              1
                              ,
                              …
                              ,
                              
                                 
                                    H
                                 
                                 
                                    2
                                 
                              
                           , are calculated by assigning a set of minimum distance to each points and taking the maximum of all these values. Mathematically, it is expressed as: 
                              
                                 (19)
                                 
                                    d
                                    
                                       (
                                       
                                          
                                             a
                                          
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          B
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          min
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                       (
                                       d
                                       
                                          (
                                          
                                             
                                                a
                                             
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          ,
                                          
                                             
                                                b
                                             
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          )
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          ε
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    
                                    ∀
                                    
                                       
                                          h
                                       
                                       
                                          2
                                       
                                    
                                    .
                                 
                              
                            Here 
                              d
                              
                                 (
                                 
                                    
                                       a
                                    
                                    
                                       
                                          
                                             h
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       
                                          
                                             h
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 )
                              
                            is the Euclidean distance as shown in Fig. 10. 
                              
                                 A
                              
                            represents the iso-porosity curve defining cell point sets 
                              C
                              S
                            and 
                              C
                              E
                            and 
                              
                                 B
                              
                            represent the point set defining the generated biarc 
                              
                                 B
                              
                           . The Hausdorff distance from 
                              
                                 A
                              
                            and 
                              
                                 B
                              
                            can be represented as follows: 
                              
                                 (20)
                                 
                                    h
                                    
                                       (
                                       
                                          A
                                       
                                       ,
                                       
                                          B
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          max
                                       
                                       
                                          
                                             
                                                h
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    
                                       (
                                       d
                                       
                                          (
                                          
                                             
                                                a
                                             
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          ,
                                          
                                             B
                                          
                                          )
                                       
                                       )
                                    
                                    =
                                    max
                                    
                                       (
                                       
                                          
                                             ε
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             ε
                                          
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             …
                                             ,
                                          
                                       
                                       
                                          
                                             ε
                                          
                                          
                                             
                                                
                                                   H
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          ε
                                       
                                       
                                          
                                             max
                                          
                                       
                                    
                                    
                                    ∀
                                    
                                       
                                          h
                                       
                                       
                                          1
                                       
                                    
                                    .
                                 
                              
                            In this process, the Hausdorff distance has been used as a measure for biarc fitting quality with respect to the original points. Also, an iterative approach has been proposed for fitting an optimized biarc through maximum number of cell points. If 
                              
                                 
                                    ε
                                 
                                 
                                    
                                       max
                                    
                                 
                              
                            stays within the user input tolerance range 
                              ζ
                           , the new point is included in the biarc fitting 
                              P
                              S
                              =
                              
                                 {
                                 R
                                 
                                    
                                       K
                                    
                                    
                                       d
                                    
                                 
                                 ,
                                 R
                                 
                                    
                                       K
                                    
                                    
                                       d
                                       +
                                       1
                                    
                                 
                                 ,
                                 R
                                 
                                    
                                       K
                                    
                                    
                                       d
                                       +
                                       2
                                    
                                 
                                 ,
                                 R
                                 
                                    
                                       K
                                    
                                    
                                       d
                                       +
                                       3
                                    
                                 
                                 }
                              
                            and the deviation has been computed with the Hausdorff distance; otherwise the previously generated biarc is kept, and the new consecutive point is considered for the new biarc. Subsequent points are checked and included in biarc fitting until the maximum error exceeds the tolerance, and eventually the optimized biarc can be generated with the maximum number of cell points 
                              P
                              S
                              =
                              
                                 {
                                 R
                                 
                                    
                                       K
                                    
                                    
                                       d
                                    
                                 
                                 ,
                                 R
                                 
                                    
                                       K
                                    
                                    
                                       d
                                       +
                                       1
                                    
                                 
                                 …
                                 R
                                 
                                    
                                       K
                                    
                                    
                                       d
                                       +
                                       n
                                    
                                 
                                 }
                              
                           . The same method is applied for subsequent biarcs. Thus, biarc fitting is implemented to generate a 
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                            continuous and smooth tool-path with significantly reduced cell points.

The continuous iso-porosity region tool-path for the 
                              
                                 (
                                 i
                                 +
                                 1
                                 )
                              
                           th layer can be constructed by joining the set 
                              B
                              i
                              a
                              r
                              c
                              
                                 (
                                 m
                                 )
                              
                            which may contain both linear and biarc segments. This technique is applied for all iso-porosity line segments as shown in Fig. 12(a). This ends the proposed bi-layer pore design for controllable and desired gradient porosity along the scaffold architecture. Stacking the spirally designed 
                              
                                 (
                                 i
                                 +
                                 1
                                 )
                              
                           th layer over the radial designed 
                              i
                           th layer consecutively will create a 3D bi-layer pattern with the height of twice the diameter of the filament used. The continuity and the connectivity of the combined layers are ensured by aligning the start and end points during the deposition path planning as shown in Fig. 12. The methodology is repeated for all the 
                              N
                              L
                            contours and stacking those bi-layer pattern consecutively one on top of the other will generate the 3D porous structure along with the optimum filament deposition path plan. A sample 3D porous structure modeled with the proposed methodology and stacked with multiple bi-layer patterns is shown latter in Fig. 16(a). By optimizing the porosity in each bi-layer set or pair, a true 3D spatial porosity can be achieved for the whole 3D structure.

The proposed modeling algorithm generates sequential point locations in a continuous uninterrupted manner. To fabricate the designed model, the points can be fed to any layer based additive manufacturing processes and the system can follow the deposition path to build the designed porous structure. To demonstrate the manufacturability of the designed scaffold, a novel in-house 3D micro-nozzle biomaterial deposition system (shown in Fig. 11
                     ) is used to fabricate the porous scaffold structure. Sodium alginate, a type of hydrogel widely used in cell immobilization, cell transplantation, and tissue engineering, is preferred as biomaterial due to its biocompatibility and formability. However, for hard tissue such as bone, rigid bio-polymers such as poly(L-lactide) (PLLA) or poly(
                        ε
                     -caprolactone) (PCL) materials can be used.

Sodium alginate from brown algae and calcium chloride were purchased from Sigma-Aldrich, USA. Alginate solutions 3% (w/v) were prepared by suspending 0.3 mg sodium alginate (SA) into 10 ml de-ionized (DI) water and stirred in room temperature for 20 min. Nozzle tips for dispensing systems were purchased from EFD®. The sodium alginate solution is filled in a reservoir and a pneumatic system is deployed to flow the solution via the micro-nozzles (100–250 μm). The system runs in room temperature under low pressure (0–8 psi). The reservoir is mounted on the dispensing system that is driven by a 3D motion control. A PC is connected to the system to control the motion in 3D. And by controlling the motion of the dispensing system, the deposition of the material can be controlled. Calcium chloride was suspended in DI water to obtain 0.6% (w/v) calcium chloride solution. Calcium chloride solution is then dispensed onto printed alginate structure through another nozzle to provide cross-linking between the alginate anion and the calcium cation to form the hydrogel. A pink color pigment is used just for proper visualization purpose.

@&#IMPLEMENTATION@&#

The proposed methodologies have been implemented with a 2.3 GHz PC using the Rhino Script and Visual Basic programming languages in the following examples. Two different scripts are written to implement the methodology on bi-layer pattern. The first script starts with the bilayer slice and generates the medial boundary. The second script uses the external and internal features and generates the final tool-path performing all geometric algorithms sequentially. Time required to execute both scripts may vary based on the contour shape and the desired gradient. However, required time can be reduced significantly by parallel processing or increasing the computational power. For a free-form shape geometry, the methodology generates a continuous tool-path for fabrication considering 8 iso-porosity regions (shown in Table 1
                     ) with constant; increasing and decreasing porosities are shown in Fig. 12(b)–(d). The resultant porosity (%) shown in Table 1 is calculated on the pore cell of the bi-layer pattern as shown in Fig. 12. There are 8 iso-porosity regions in 
                        
                           (
                           i
                           +
                           1
                           )
                        
                     th layer which create 8 pore cells in each sub-region. As a result, the bi-layer pattern shows a gradient porosity with 8 different pore size with a direction from inner contour (medial boundary) toward the outer contour (external contour). The filament radius has been considered as 250 μm during the design processes. A total of 160 sub-regions have been generated from 3130 ruling lines, and a continuous tool-path has been constructed for additive manufacturing processes. Smoothing of iso-porosity line segments has been performed using biarcs and the total number of biarcs required is shown in Table 1. Finally, combining the tool-path for both the 
                        i
                     th and 
                        
                           (
                           i
                           +
                           1
                           )
                        
                     th layers will make a continuous and interconnected tool-path for the designed bi-layer, as shown in Fig. 12. Total execution for Fig. 12(b); (c) and (d) in a 2.3 GHz PC is less than 5 min.

The methodology is also implemented on a femur head slice extracted using ITK-Snap 1.6  [46] and Mimics Software  [47]. The following femur slice (shown in Fig. 13
                     ) has been used to implement the methodology for variable but controllable porosity along its architecture. Fig. 13(b) shows the generated medial axis and the corresponding medial boundary with 
                        δ
                        =
                        0.5
                       mm.

The ruling line generation methodology described in Section  2.2.1 has been implemented and 2828 ruling lines have been generated. The scaffold area has been discretized with 185 sub-regions as shown in Fig. 14
                     (a). The continuous tool-path plan through these sub-regions has been shown in Fig. 14(b).

For the successive layer, the scaffold area has been divided into 10 iso-porosity regions and corresponding pore cells have been generated as shown in Fig. 15
                     
                     . Three sets of controllable porosity i.e. constant, positive gradient and negative gradient porosity have been designed considering a 250 μm filament diameter. A total of 185 sub-regions have been generated from 2832 ruling lines, and a continuous tool-path has been constructed for deposition. The total number of biarcs and the porosity distribution are shown in Table 2
                     . Finally, combining the tool-path for both the 
                        i
                     th and 
                        
                           (
                           i
                           +
                           1
                           )
                        
                     th layers will make a continuous and interconnected tool-path for the designed bi-layer as shown in Fig. 15(a)–(c). Total execution for Fig. 15(a); (b) and (c) in a 2.3 GHz PC is less than 6 min.

The proposed method has also been compared with the conventional homogeneous porous structure with constant 80% porosity as shown in Fig. 16. For Fig. 16(a), the blue color represents the radial layer and the red color represents the spiral layer to distinguish the deposition pattern. Similarly, for Fig. 16(b), blue and red colors represent the 0° and 90° layout pattern respectively. As shown in this figure, it is clear that the porosity architecture in the homogeneous structure does not follow the shape of the geometry. However, the proposed method in this paper generates the porosity along the scaffold architecture considering its geometry. Furthermore, the proposed methodology generates a continuous and interconnected tool-path while achieving the designed controllable or variational pore size or porosity.

Bio-fabrication of sample models is constructed and fabricated using the micro-nozzle biomaterial deposition system discussed in Section  4. For visual representation and demonstration purposes, sample models are generated from two consecutive femur slices with larger pore-sizes. A total of 105 sub-regions and three iso-porosity regions are generated with the methodology discussed above. Three sets of controllable porosity, i.e., constant, positive gradient and negative gradient porosity have been designed and fabricated with a 100 μm filament diameter as shown in Fig. 17
                     .

The designed and corresponding fabricated models are presented in Fig. 17. The prototype computer numerical controlled (CNC) additive manufacturing system (shown in Fig. 11) is used because of the suitable fabrication parameters (pressure, temperature etc.) viable to deposit bio-compatible materials. The fabricated structures closely conform to the design models as shown in Fig. 17. The proposed design algorithm generates the internal points of the designed scaffold sequentially which are supplied to the motion control system to follow the deposition path. The developed methods can be used by any additive manufacturing processes. Heterogeneous or gradient porosity can be achieved through additive manufacturing techniques either by changing the deposited filament diameter or by controlling the segment size, i.e., the pore size during the fabrication processes. In this paper, micro nozzle extrusion based additive manufacturing processes are used and controlling of filament diameter may not be possible during deposition process. The fabricated scaffolds could be tested in-vitro and in-vivo with the cells. However, these experiments are beyond the scope of this paper. The mechanical properties, fluid flow dynamics, resolution and accuracy of the fabricated scaffolds may also be used to verify the proposed methodology. However, they are strongly related to the fabrication process used and biomaterials chosen (i.e. viscosity, stiffness), which are out of the scope of this paper.

@&#CONCLUSION@&#

The proposed methodology generates interconnected and controlled porous architecture with continuous deposition path planning appropriate for additive manufacturing processes. The proposed novel techniques can generate the scaffold structure with gradient (linear or non-linear), variational, or constant porosity that can provide localized control of material concentration along the scaffold architecture. Using the layer-by-layer deposition method, a 3D porous scaffold structure with controllable variational pore size or porosity can be achieved by stacking the designed layers consecutively. The proposed method addresses multiple desired properties in the scaffold, such as continuous and interconnected variational porosity, better structural integrity, improved oxygen diffusion during cell regeneration, cell differentiation, and guided tissue regeneration. Most importantly, the generated models are reproducible and suitable for any additive manufacturing processes.

@&#ACKNOWLEDGMENT@&#

The research was partially supported by the EU FP7 Marie Curie Grant #: PCIG09-GA-2011-294088 awarded to Dr. Koc.


                     
                        
                           
                        
                     
                  

@&#REFERENCES@&#

