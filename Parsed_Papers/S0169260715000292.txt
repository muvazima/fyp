@&#MAIN-TITLE@&#Probabilistic modeling of short survivability in patients with brain metastasis from lung cancer

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           The use of Bayesian network to predict the short survivability of patients.


                        
                        
                           
                           The use of synthetic minority over-sampling technique to improve the sensitivity.


                        
                        
                           
                           The proposed model has the highest sensitivity among all benchmark methods.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Bayesian network

Brain metastasis

Lung cancer

Survivability

@&#ABSTRACT@&#


               
               
                  The prediction of substantially short survivability in patients is extremely risky. In this study, we proposed a probabilistic model using Bayesian network (BN) to predict the short survivability of patients with brain metastasis from lung cancer. A nationwide cancer patient database from 1996 to 2010 in Taiwan was used. The cohort consisted of 438 patients with brain metastasis from lung cancer. We utilized synthetic minority over-sampling technique (SMOTE) to solve the imbalanced property embedded in the problem. The proposed BN was compared with three competitive models, namely, naive Bayes (NB), logistic regression (LR), and support vector machine (SVM). Statistical analysis showed that performances of BN, LR, NB, and SVM were statistically the same in terms of all indices with low sensitivity when these models were applied on an imbalanced data set. Results also showed that SMOTE can improve the performance of the four models in terms of sensitivity, while keeping high accuracy and specificity. Further, the proposed BN is more effective as compared with NB, LR, and SVM from two perspectives: the transparency and ability to show the relation of factors affecting brain metastasis from lung cancer; it allows decision makers to find the probability despite incomplete evidence and information; and the sensitivity of the proposed BN is the highest among all standard machine learning methods.
               
            

@&#INTRODUCTION@&#

Physicians generally predict the survivability of patients from the combination of clinical symptoms and signs, as well as from laboratory data, based on their experience and judgment. The prediction precision that depends on the levels of experience and length of patient–physician relationship may vary in each individual [1]. Although regression models have been developed to predict survivability [1–5], these models still have restrictions in applying medical data that are uncertain, complex, and have nonlinear variables with implicit interactions between the variables themselves [6]. Predicting the short survivability of cancer metastases patients (i.e., survival of less than two months) is thus challenging, and attempts for precise prediction were not completely successful.

Lung cancer often spreads to the brain, given that 65% of patients diagnosed with primary tumor in their lungs have brain metastases [7]. Therefore, modeling and predicting the development of brain metastasis from lung cancer is necessary. Whole brain radiotherapy (WBRT) and corticosteroids are the standard recommended treatments to effectively control symptoms for patients with brain metastases [8] and survivability prognosis is crucial to administer such treatment. A patient with short survivability may not gain any advantage from additional radiation [9–11]. A patient who is expected to have short survivability can be recommended by treatment using steroids alone. Therefore, correct classification of the short survival group of patients with brain metastasis is required to maximize the benefit of the treatment and minimize the suffering of patients. Given the abovementioned properties inherent in lung cancer patients with brain metastases with extremely short survivability, current prognostic models failed to identify patients who will not gain any major benefit from WBRT. The goal of this study is to develop a more reliable survival prediction model.

Traditional statistical models for survivability prediction have rigid assumptions in which the variables are independent [12,13] and difficult to use in calculating for posterior probabilities. By contrast, Bayesian network (BN) is a powerful tool for representing probabilistic events in a simple graphically readable manner and for efficiently predicting tasks. BN can be viewed as a knowledge-representation method with an explicit structure and an associated semantic and reasoning method [14]. Each node can be computed for the posterior probability, which is useful for decision makers. BN can approximate complex multivariate probability distributions of heterogeneous variables as interpretable local probabilities to incorporate prior clinical and biological knowledge as well as to visualize and interpret interactions among variables of interest for clinical use [15]. In addition, BN can be applied in both linear and nonlinear relation problems, including interaction problems, such as a parent–child relationship.

The remainder of this paper is organized as follows: in Section 2, we briefly review the BN along with other standard machine learning methods; in addition, a technique to solve imbalanced problem is stated in this section as well. Variables and data, including model evaluation criteria, are described in Section 3. The experiments and results are presented in Section 4. We provide the conclusions in Section 5.

@&#METHODS@&#

The BN is a probability graphical model that has capability to encode a joint probability distribution over a set of random variables that is either discrete or continuous. Officially, a BN builds a directed-acyclic graph (DAG) by using a set of nodes representing the variables and a set of directed edges representing the relationships between the variables [15]. Given 
                           X
                        
                        ={X
                        1, …, X
                        
                           n
                        } as the set of random variables, each variable X
                        
                           i
                         is independent of its non-descendants given its parents in the graph. The joint probability distribution over 
                           X
                         is given by 
                           
                              P
                              (
                              
                                 X
                                 1
                              
                              ,
                              …
                              ,
                              
                                 X
                                 n
                              
                              )
                              =
                              
                                 ∏
                                 
                                    i
                                    =
                                    1
                                 
                                 n
                              
                              
                                 P
                                 (
                                 
                                    X
                                    i
                                 
                                 |
                                 
                                    P
                                    a
                                 
                                 (
                                 
                                    X
                                    i
                                 
                                 )
                                 )
                              
                           
                        , where P
                        
                           a
                        (X
                        
                           i
                        ) is the set of parents of X
                        
                           i
                        .

There are three important steps for the BN construction [12,16]. (i) Identify the set of correlated variables and their possible values, as well as details for variable identification. (ii) Find the network structure by linking nodes that represent variables with arcs with DAG, and constructing the graph using expert knowledge or by applying the algorithm obtained from the data. (iii) Define the conditional probability table (CPT) for each node in the graph.

In this study, the network structure was rigorously examined by domain experts/doctors and constructed using data from related medical literature. After the structure of a BN was known, we quantified the relationship between connected nodes by CPT for discrete variables. We used the Maximum a Posteriori (MAP) estimation method to obtain the values for CPT.

Given that 
                              D
                            represents a set of random variables {X
                           1, X
                           2, …, X
                           
                              n
                           } where X
                           
                              i
                            is an element of the BN variables, θ represents a set of probability distribution parameter best explain D. The purpose of parameter learning is to find the most probable values for vector θ. The maximum a posterior estimate for the parameter set θ denoted by 
                              
                                 
                                    
                                       θ
                                       ˆ
                                    
                                    
                                       M
                                       A
                                       P
                                    
                                 
                                 =
                                 arg
                                 
                                    
                                       max
                                    
                                    θ
                                 
                                 P
                                 (
                                 θ
                                 |
                                 D
                                 )
                              
                           .

From the Bayes’ rule, the posterior distribution over θ:
                              
                                 
                                    
                                       P
                                       (
                                       θ
                                       |
                                       D
                                       )
                                       =
                                       
                                          
                                             P
                                             (
                                             D
                                             |
                                             θ
                                             )
                                             P
                                             (
                                             θ
                                             )
                                          
                                          
                                             P
                                             (
                                             D
                                             )
                                          
                                       
                                    
                                 
                              
                           where P(D|θ) represents the likelihood function L(θ:D), P(θ) represents the prior over parameters, and P(D) represents a normalizing factor.

The MAP estimation for a binary variable can be explained as follows. Assume D is the set of i.i.d samples D
                           ={X
                           1, …, X
                           
                              n
                           }, X
                           
                              i
                            is a discrete binary variable with real values 0 and 1(X
                           
                              i
                            has Bernoulli distribution), then P(D|θ)=
                           θ, P(X
                           
                              i
                           
                           =
                           θ). Thus, L(θ:D) representing the likelihood function for Bernoulli distribution has the form: 
                              
                                 P
                                 (
                                 D
                                 |
                                 θ
                                 )
                                 =
                                 L
                                 (
                                 θ
                                 :
                                 D
                                 )
                                 =
                                 
                                    ∏
                                    
                                       i
                                       =
                                       1
                                    
                                    n
                                 
                                 
                                    
                                       θ
                                       
                                          
                                             x
                                             i
                                          
                                       
                                    
                                    
                                       
                                          (
                                          1
                                          −
                                          θ
                                          )
                                       
                                       
                                          (
                                          1
                                          −
                                          
                                             x
                                             i
                                          
                                          )
                                       
                                    
                                    =
                                    
                                       θ
                                       
                                          
                                             N
                                             1
                                          
                                       
                                    
                                    
                                       
                                          (
                                          1
                                          −
                                          θ
                                          )
                                       
                                       
                                          
                                             N
                                             2
                                          
                                       
                                    
                                 
                              
                           .

A conjugate prior for a binomial is Beta distribution, then P(θ)=
                           γθ
                           
                              α
                              1−1(1−
                           θ)
                              α
                              2−1, γ
                           =
                           Γ(α
                           1
                           +
                           α
                           2)/Γ(α
                           1)Γ(α
                           2), where Γ(·) is the Gamma function. For any integer x, Γ(x
                           +1)=
                           xΓ(x), Γ(1)=1, Γ(x)=(x
                           −1)!.

From Bayes’ rule in Eq. (1), P(θ|D)∝
                           θ
                           
                              N
                              1
                           (1−
                           θ)
                              N
                              2
                           
                           ·
                           θ
                           
                              α
                              1−1(1−
                           θ)
                              α
                              2−1
                           ∝
                           θ
                           
                              α
                              1+N
                              1−1(1−
                           θ)
                              α
                              2+N
                              2−1. Therefore, 
                              
                                 
                                    
                                       θ
                                       ˆ
                                    
                                    
                                       M
                                       A
                                       P
                                    
                                 
                                 =
                                 (
                                 
                                    α
                                    1
                                 
                                 +
                                 
                                    N
                                    1
                                 
                                 −
                                 1
                                 )
                                 /
                                 (
                                 
                                    α
                                    1
                                 
                                 +
                                 
                                    α
                                    2
                                 
                                 +
                                 
                                    N
                                    1
                                 
                                 +
                                 
                                    N
                                    2
                                 
                                 −
                                 2
                                 )
                              
                           .

The MAP estimation for a multinomial variable can be extended as follows. Assume D is a multinomial experiment consisted of n trials, i.e. D
                           ={X
                           1, …, X
                           
                              n
                           } where X
                           
                              i
                            has k possible outcomes; for X
                           
                              i
                           , the k outcomes can occur with the probability θ
                           1, …, θ
                           
                              k
                            when 
                              
                                 
                                    ∑
                                    j
                                    k
                                 
                                 
                                    
                                       θ
                                       j
                                    
                                    =
                                    1
                                 
                              
                           . Given n
                           
                              j
                            represents number of the jth outcome, then
                              
                                 
                                    
                                       P
                                       (
                                       
                                          n
                                          1
                                       
                                       ,
                                       …
                                       ,
                                       
                                          n
                                          k
                                       
                                       )
                                       =
                                       
                                          
                                             n
                                             !
                                          
                                          
                                             
                                                n
                                                1
                                             
                                             !
                                             ⋯
                                             
                                                n
                                                k
                                             
                                             !
                                          
                                       
                                       
                                          θ
                                          1
                                          
                                             
                                                n
                                                1
                                             
                                          
                                       
                                       
                                          θ
                                          2
                                          
                                             
                                                n
                                                2
                                             
                                          
                                       
                                       ⋯
                                       
                                          θ
                                          k
                                          
                                             
                                                n
                                                k
                                             
                                          
                                       
                                        
                                       where
                                          
                                       
                                          ∑
                                          i
                                       
                                       
                                          
                                             n
                                             i
                                          
                                          =
                                          n
                                       
                                    
                                 
                              
                           
                        

Therefore L(θ:D) representing the multinomial likelihood function has the form:
                              
                                 
                                    
                                       P
                                       (
                                       D
                                       |
                                       θ
                                       )
                                       =
                                       L
                                       (
                                       θ
                                       :
                                       D
                                       )
                                       =
                                       
                                          ∏
                                          j
                                          k
                                       
                                       
                                          
                                             θ
                                             j
                                             
                                                
                                                   n
                                                   j
                                                
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           
                        

A conjugate prior for a multinomial is Dirichlet distribution, θ
                           ∼
                           Dir(α
                           1, …, α
                           
                              k
                           ), then 
                              
                                 P
                                 (
                                 θ
                                 )
                                 =
                                 
                                    
                                       Γ
                                       
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                k
                                             
                                             
                                                
                                                   α
                                                   j
                                                
                                             
                                          
                                       
                                    
                                    /
                                    
                                       
                                          ∏
                                          
                                             j
                                             =
                                             1
                                          
                                          k
                                       
                                       
                                          Γ
                                          (
                                          
                                             α
                                             j
                                          
                                          )
                                       
                                    
                                 
                                 
                                    ∏
                                    
                                       j
                                       =
                                       1
                                    
                                    k
                                 
                                 
                                    
                                       θ
                                       i
                                       
                                          
                                             α
                                             j
                                          
                                          −
                                          1
                                       
                                    
                                 
                              
                           , where α
                           
                              j
                           , j
                           =1, …, k are the hyperparameters of the prior. From Bayes’ rule
                              
                                 
                                    
                                       P
                                       (
                                       θ
                                       |
                                       D
                                       )
                                       ∝
                                       P
                                       (
                                       D
                                       |
                                       θ
                                       )
                                       P
                                       (
                                       θ
                                       )
                                       ∝
                                       (
                                       
                                          θ
                                          1
                                          
                                             
                                                n
                                                1
                                             
                                          
                                       
                                       
                                          θ
                                          2
                                          
                                             
                                                n
                                                2
                                             
                                          
                                       
                                       ⋯
                                       
                                          q
                                          k
                                          
                                             
                                                n
                                                k
                                             
                                          
                                       
                                       )
                                       
                                          
                                             
                                                ∏
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                k
                                             
                                             
                                                
                                                   θ
                                                   j
                                                   
                                                      
                                                         α
                                                         j
                                                      
                                                      −
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       ∝
                                       
                                          ∏
                                          
                                             j
                                             =
                                             1
                                          
                                          k
                                       
                                       
                                          
                                             θ
                                             j
                                             
                                                
                                                   n
                                                   j
                                                
                                                +
                                                
                                                   α
                                                   j
                                                
                                                −
                                                1
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           
                        

Therefore P(θ|D)∼
                           Dir(n
                           1
                           +
                           α
                           1, n
                           2
                           +
                           α
                           2, …, n
                           
                              k
                           
                           +
                           α
                           
                              k
                           ), then 
                              
                                 
                                    
                                       θ
                                       ˆ
                                    
                                    
                                       j
                                       ,
                                       M
                                       A
                                       P
                                    
                                 
                                 =
                                 
                                    
                                       (
                                       
                                          n
                                          j
                                       
                                       +
                                       
                                          α
                                          j
                                       
                                       −
                                       1
                                       )
                                    
                                    /
                                    
                                       
                                          
                                             n
                                             +
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                k
                                             
                                             
                                                (
                                                
                                                   α
                                                   j
                                                
                                                ,
                                                −
                                                1
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           .

Inference in a BN is an important task, wherein the posterior probability of the query variables is computed using a given set of evidence as knowledge to the network. Two algorithms are used for inference in a BN, namely, exact and approximate. The most popular exact inference algorithm converts a BN into a junction tree and then performs an exact inference. The computation of exact inference on a junction tree consists of three steps [17]: (1) local evidence absorption wherein the clique potential tables that include evidence variables are updated; (2) evidence propagation wherein the evidence is propagated throughout the entire junction tree; and (3) query wherein the probability distribution of the query variables is computed from the potential table of the cliques that include query variables. Such inference algorithm can be employed in Bayes net toolbox for Matlab [18], and was used in our experiments.

Due to the advantages of the BN model, recently, the BN model has been widely utilized to predict the survivability. For example, The BN model was applied to predict the 1-year, 3-year, and 5-year survivability of patients diagnosed with malignant skin melanoma [19]. Choi et al. [20] predicted breast cancer survival using a hybrid BN. Dekker et al. [21] applied BN and support vector machine (SVM) to predict 2-year survivability of lung cancer patients, they concluded that the BN model is more suitable to use for medical domain since it is able to handle with missing data. Forsberg et al. [22] developed a BN model to predict survival from 189 patients who underwent surgery for bone metastasis.

The naive Bayes (NB) is the simplest BN classifier, in which each variable node X
                           
                              i
                            has the class node C
                           
                              i
                           , but does not have any other parent. All variables node X
                           
                              i
                            are mutually independent given the class variable. This classifier learns the conditional probability of each variable X
                           
                              i
                            given the label C
                           
                              i
                            in the training data. Classification is then done by applying Bayes rule to compute the probability of C given the particular instantiation of X
                           
                              i
                           , …, X
                           
                              n
                           . Surprisingly, the performance of a NB is somewhat competitive given that this is clearly an unrealistic assumption. More details for the NB can refer to Lowd and Domingos [23] and Su and Zhang [24].

The logistic regression (LR) is well known as the gold standard method in prediction tasks [25]. It is a statistical method that describes the relation between predictor variables denoted by x′=(x
                           1, x
                           2, …, x
                           
                              p
                           ) and a response variable, which is a categorical variable with two values [26], that is, the “2-month survivability” or “non 2-month survivability” in this study.

The conditional probability of the 2-month survivability of lung cancer patients with brain metastasis can be written as P(Y
                           =1|
                              x
                           )=
                           π(
                              x
                           ) then, the LR model for p predictor variables can be written as
                              
                                 
                                    
                                       π
                                       (
                                       
                                          x
                                       
                                       )
                                       =
                                       
                                          
                                             
                                                e
                                                
                                                   (
                                                   
                                                      β
                                                      0
                                                   
                                                   +
                                                   
                                                      β
                                                      1
                                                   
                                                   
                                                      x
                                                      1
                                                   
                                                   +
                                                   
                                                      β
                                                      2
                                                   
                                                   
                                                      x
                                                      2
                                                   
                                                   +
                                                   ⋯
                                                   +
                                                   
                                                      β
                                                      p
                                                   
                                                   
                                                      x
                                                      p
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             1
                                             +
                                             
                                                e
                                                
                                                   (
                                                   
                                                      β
                                                      0
                                                   
                                                   +
                                                   
                                                      β
                                                      1
                                                   
                                                   
                                                      x
                                                      1
                                                   
                                                   +
                                                   
                                                      β
                                                      2
                                                   
                                                   
                                                      x
                                                      2
                                                   
                                                   +
                                                   ⋯
                                                   +
                                                   
                                                      β
                                                      p
                                                   
                                                   
                                                      x
                                                      p
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where 0≤
                           π(
                              x
                           )≤1.

A useful transformation of a LR is the logit transformation, defined as
                              
                                 
                                    
                                       g
                                       (
                                       
                                          x
                                       
                                       )
                                       =
                                       ln
                                       
                                          
                                             
                                                
                                                   π
                                                   (
                                                   
                                                      x
                                                   
                                                   )
                                                
                                                
                                                   1
                                                   −
                                                   π
                                                   (
                                                   
                                                      x
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       =
                                       
                                          β
                                          0
                                       
                                       +
                                       
                                          β
                                          1
                                       
                                       
                                          x
                                          1
                                       
                                       +
                                       
                                          β
                                          2
                                       
                                       
                                          x
                                          2
                                       
                                       +
                                       ⋯
                                       +
                                       
                                          β
                                          p
                                       
                                       
                                          x
                                          p
                                       
                                       .
                                    
                                 
                              
                           
                        

The odds ratio (OR) associated with one unit change in x
                           
                              j
                            is represented with e
                           (β
                              
                                 j
                              ).

The support vector machine (SVM) is a machine learning method which is widely recognized used for classification tasks in medical problems [27–30]. The function of SVM is to find the hyper-plane that classifies the space of all possible instances into two classes and maximally separates these two classes. The SVM differs from other machine learning methods and maps inseparable data into a higher dimensional space where these data can be linearly separated [31].

Synthetic minority over-sampling technique (SMOTE) has been proved to be a successful technique for medical domain. Wang et al. [32] presented that SMOTE has successfully improved the survivability performance prediction when the data set is imbalanced. Moreover, Nicandro et al. [33] suggested SMOTE to improve the performance of machine learning for classification in medical data.

SMOTE is an over-sampling technique that operates in feature space rather than data space. This method is applied to pre-process the data by increasing the number of instances for the minority class in the original data set, resulting in broader decision regions for the minority class compared with over-sampling with replacement. As a result, the over-fitting problem in the learning algorithm can be avoided [34–36]. To create the new synthetic instances, the amount of over-sampling (%) and the number of nearest neighbors are required.

This study used the NHI database from 1996 to 2010 collected by the Bureau of NHI, Taiwan, which collects nationwide data of cancer patients. The registration and original claim data for reimbursement were considered [37]. Data were retrieved from the “Ambulatory care expenditures by visits file” (CD file), which is in the “Original claim data for reimbursement” file. The cohort consisted of 438 lung cancer patients with brain metastasis from the database containing more than 50,000 cases of cancer patients.


                        Table 1
                         shows that 53 patients survived in less than two months, and 385 patients survived longer than two months. Of these patients, 55% were males, and most of the patients were between 61 and 70 years of age. Data showed that almost half of the patients were from northern Taiwan. Most patients with brain metastasis received drug medication after being diagnosed with lung cancer, and 84% of brain metastasis patients have lung cancer in bronchus.

Given the imbalanced property in the data set, a classification model can be overwhelmed by instances in the majority class. Consequently, high accuracy was observed for the majority class (i.e., the cohort of patients survived longer than two months), which is not true for the minority (i.e., the cohort of patients survived in less than two months). SMOTE was used to balance the data distribution to solve this problem. SMOTE was applied on the training data set to increase the number of instances in the minority class by creating new synthetic instances.

A previous study by Wang et al. [38] constructed a BN to describe and predict the occurrence of brain metastasis from lung cancer. Their data are consisted of 35,605 patients who were diagnosed with only lung cancer, and among them 438 patients developed brain metastasis. Five variables, namely, age, gender, region of residence (represent the environment of patients), site of lung cancer within human body, and treatment (primary treatment described in the medical database of patients), were employed to construct their BN model and occurrence is the prediction target.

The structure of the network presented in this study is not fully adopted by learning from data. Instead, the network is revised from the study of Wang et al. [38] which was developed by literature survey, statistical correlation justification, and opinions of domain experts to predict the occurrence of brain metastasis from lung cancer patients. Notably, one additional factor (the time interval from the first lung diagnosis to the development of brain metastasis) and more significant links among the factors are included in our study.

We modified the BN topology proposed by Wang et al. [38] to describe and predict the short survivability in patients with brain metastasis from lung cancer. Five variables, namely, age, gender, region, site of lung cancer, and treatment which previously describe in the study [38] regarding the occurrence of brain metastasis from lung cancer patients were adopted in this study. In addition, the “interval” representing the time interval from the first lung diagnosis to the development of brain metastasis is incorporated because the patients have brain metastasis. This variable is notably still controversial while the interval variable was perceived to be an insignificant predictor in predicting the survivability of patients [8–10]; however, Hung et al. [39] claimed that this factor is necessary for survival prediction. To consider the influence of lung cancer treatment on brain metastasis development, brain metastasis development was defined as one month, which is the shortest time for metastasis after lung cancer diagnosis [40]. Consequently, the treatment is defined as the lung cancer treatment that a patient undergoes one month before brain metastasis is detected.

Accordingly, seven variables were considered to construct the proposed BN model: (1) age, (2) gender, (3) region of residence and environment of patients, (4) site of lung cancer, (5) treatment (primary treatment described in the medical database of patients), (6) interval (interval from first lung diagnosis to development of brain metastasis), and (7) survivability, which represents the survival of brain metastasis patients. Survivability is designated as “yes” if the patient can survive longer than two months; otherwise, it is designated as “no”. Survivability functions as a response variable. The possible values of these variables are presented in Table 1. The graphical BN model with seven variables was constructed and is shown in Fig. 1
                        . A multiple-layer relationship exists in this network structure. To name a few, confirmed by Ko et al. [41], Samet et al. [42], and de Groot and Munden [43], gender is a determinant of lung cancer. In addition, WHO Department of Gender, Women and Health [44] states that gender is a cause of treatment. Age is confirmed by Brown et al. [45] to be a determinant of treatment. The study of American Cancer Society [46], Samet et al. [42], and de Groot and Munden [43] claimed that region is a determinant of site of lung cancer. Cartman et al. [47] and Forrest et al. [48] confirmed that region affects treatment. Given that lung cancer metastasis occurs at the time of diagnosis or after undergoing treatment, treatment is a factor for occurrence of brain metastasis [40,49].

For the performance evaluation, a full data set was divided into two sets, namely training and testing sets. In this study, fivefold cross-validation was used so that the bias caused by random sampling can be reduced [50]. In this method, a full data set was divided into five independent folds (subsets), with each fold approximately one-fifth of the full data set (with approximately one-fifth of survival and one-fifth of non-survival). Four out of the five subsets were combined and used as the training set. The remaining subset was used as the testing set. Each of the five subsets was used once as a testing set to evaluate the performance of a classifier, which was built from the combination of the other remaining subsets.

The measurement indices were calculated as follows: accuracy
                        =(TP
                        +
                        TN)/(TP
                        +
                        TN
                        +
                        FP
                        +
                        FN), 
                           
                              s
                              e
                              n
                              s
                              i
                              t
                              i
                              v
                              i
                              t
                              y
                              =
                              T
                              P
                              /
                              (
                              T
                              P
                              +
                              F
                              N
                              )
                           
                        , specificity
                        =
                        TN/(TN
                        +
                        FP), where TP denotes true positives, TN denotes true negatives, FP denotes false positives, and FN denotes false negatives. These values are often displayed in a confusion matrix as presented in Table 2
                        .

@&#EXPERIMENTS AND RESULTS@&#

In this study, the data set is consisted of 53 patients survived in less than two months, and 385 patients survived longer than two months. To balance the data set, SMOTE is applied and the number of new synthetic instances was increased depending on two parameters, namely, the multiplier of over-sampling and the number of nearest neighbors. Each training set is resized at an over-sampling rate of 700%. This number is determined to make the number of instances in the two classes to be approximately balanced. Further, 5-nearest neighbor setting which is widely used in medical studies (e.g., [51–53]) is employed in our SMOTE implementation. The implementations for all models with and without SMOTE are illustrated in Figs. 2 and 3
                        
                        .

All models, namely, the proposed BN, LR, NB, and SVM are applied to the imbalanced and balanced data sets that were pre-processed using SMOTE. For the proposed BN implementation, the constructed BN shown in Fig. 1 is employed to find the conditional probability table (CPT) values from the balanced and imbalanced data sets, respectively. CPT values were obtained from MAP implemented in Bayes Net of Matlab Toolbox [18] using Bayesian Dirichlet equivalence uniform (BDeu) score with α
                        =1 in every cell of CPT. Moreover, LR, NB, and SVM were implemented by using default Weka setting (more details for the default can refer to [54]).

@&#RESULTS@&#

The conditional probabilities created from the database explain the changes of each variable affected by some evidence that provide useful information for predicting the very short survival in patients with brain metastasis. Table A1 in Appendix shows the resulting conditional probability for the site of lung cancer and the findings from the changes in the type of site of lung cancer after the presentation of gender, age, and region. Comparing to the probability of site of lung cancer [P(Si)], we have found as follows (Fig. 4
                        ). (1) The probability to occur lung cancer in the trachea, bronchus and lung (162) most increases in male patients aged of 50–60 and living in the east, which accounted for 49.42%. (2) The probability to occur lung cancer in the trachea (1620) most increases in male patients aged of 50–60 and living in the center, which accounted for 19.98%. (3) The probability to occur lung cancer in the bronchus (1622) most increases in male patients aged of 61–70 and living in the center, which accounted for 11.11%. (4) The probability to occur lung cancer in the upper lobe, bronchus, and lung (1623) most increases in male patients lower than 50 years old and living in the south, which accounted for 21.41%. (5) The probability to occur lung cancer in the middle lobe, bronchus, and lung (1624) most increases in male patients lower than 50 years old and living in the center, which accounted for 7.70%. (6) The probability to occur lung cancer in the lower lobe, bronchus and lung (1625) most increases in male patients over than 70 years old and living in the center, which accounted for 13.33%. (7) The probability to occur lung cancer in other parts of the bronchus or lung (1628) most increases in female patients aged of 50–60 and 61–70 and living in the center, which accounted for 29.95%. (8) The probability to occur lung cancer in the bronchus and lung or an unspecified site (1629) most increases in female patients aged of 61–70 and living in the east, which accounted for 99.95%.

The resulting conditional probabilities of the primary treatment for lung cancer patients after presenting gender, age, region, and site of lung cancer are listed in Table A2 of Appendix which reveals that the chance that a patient undergoes radiotherapy most increases (which accounted for 99.74%) compared to the probability of treatment [P(Tr)] when the patient has the following characteristics: (1) a patient who is female, aged over than 70 years old, living in the center, and diagnosed with lung cancer in the trachea, bronchus and lung (162), (2) a patient who is male, aged of 50–60, living in the south, and diagnosed with lung cancer in the trachea, bronchus and lung (162), (3) a patient who is female, aged over than 70 years old, living in the north, and diagnosed with lung cancer in the trachea (1620), (4) a patient who is male, aged of 50 to 60, living in the center, and diagnosed with lung cancer in the upper lobe, bronchus, and lung (1623), (5) a patient who is female, aged lower than 50 years old, living in the south, and diagnosed with lung cancer in the lower lobe, bronchus and lung (1625). Moreover, the chance that a patient undergoes chemotherapy most increases (which accounted for 99.74%) compared to the probability of treatment [P(Tr)] when the patient is male, aged of 61–70, living in the north, and diagnosed with lung cancer in the upper lobe, bronchus, and lung (1623). Likewise, the chance that a patient undergoes drugs most increases (which accounted for 99.97%) compared to the probability of treatment [P(Tr)] when the patient is male, aged lower than 50 years old, living in the north, and diagnosed with lung cancer in the bronchus and lung or an unspecified site (1629). The results are summarized in Fig. 5
                        .

The resulting conditional probabilities of the interval from first lung diagnosis to development of brain metastasis after presenting age, site of lung cancer, and treatment are listed in Table A3 of Appendix which reveals as follows. (1) The chance which the time interval from first lung cancer diagnosis to brain metastasis occurrence is less than 2 month most increases (which accounted for 99.61%) when a patient is aged over than 70 years old, having lung cancer in the trachea (1620), and undergoing drugs. (2) The chance which interval from first lung cancer diagnosis to brain metastasis occurrence is 3–6 month most increases (which accounted for 99.23%) when a patient is following: (i) age is lower than 50 years old, has lung cancer in the bronchus and lung or an unspecified site (1629), and undergoing chemotherapy; (ii) age is lower than 50 years old, has lung cancer in the middle lobe, bronchus, and lung (1624), and undergoing drugs; and (iii) age is lower than 50 years old, has lung cancer in the lower lobe, bronchus and lung (1625), and undergoing drugs. (3) The chance which interval from first lung cancer diagnosis to brain metastasis occurrence is 7–12 month most increases (which accounted for 99.23%) when a patient aged lower than 50 years old, having lung cancer in the lower lobe, bronchus and lung (1625), and undergoing radiotherapy. (4) The chance which interval from first lung cancer diagnosis to brain metastasis occurrence is over than 1 year most increases (which accounted for 99.23%) when a patient aged of 50–60, having lung cancer in the upper lobe, bronchus, and lung (1623), and undergoing drugs. The results are summarized in Fig. 6
                        .

Finally, the resulting conditional probabilities of the survivability after presenting the age and interval are listed in Table A4 of Appendix, which reveals that the probability which a patient survive over 2 month most increases when knowing that the patient aged of 61–70 and having interval longer than 1 year (which accounted for 94.00%). On the other hand, the probability which a patient survive less than 2 month most increases when given a patient aged lower than 50 years and having interval from first lung cancer diagnosis to brain metastasis occurrence is 7–12 month (which accounted for 28.57%). The results are summarized in Fig. 7
                        .

Moreover, when the proposed BN is used, we can compute for the posterior probabilities for any query/prediction given the evidences. The BN allows the model to find the probability despite incomplete evidence. For example, physicians can use the proposed BN to predict the probability of interval from first lung cancer diagnosis to brain metastasis occurrence given some exist evidences. If the patient is a 55-year-old man diagnosed with lung cancer in the lower lobe, bronchus and lung (1625) and living in the east of Taiwan (without any information concerning treatment), the probability of the interval is P(T|G
                        =1, A
                        =2, R
                        =1, Si
                        =5 presented in Table 3
                        . The computation of c, for instance, can be expressed as follows:
                           
                              
                                 
                                    P
                                    (
                                    T
                                    |
                                    G
                                    =
                                    1
                                    ,
                                    A
                                    =
                                    2
                                    ,
                                    R
                                    =
                                    1
                                    ,
                                    S
                                    i
                                    =
                                    5
                                 
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                =
                                                
                                                   
                                                      P
                                                      (
                                                      T
                                                      =
                                                      1
                                                      |
                                                      ,
                                                      G
                                                      =
                                                      1
                                                      ,
                                                      A
                                                      =
                                                      2
                                                      ,
                                                      R
                                                      =
                                                      1
                                                      ,
                                                      S
                                                      i
                                                      =
                                                      5
                                                      )
                                                   
                                                   
                                                      P
                                                      (
                                                      G
                                                      =
                                                      1
                                                      ,
                                                      A
                                                      =
                                                      2
                                                      ,
                                                      R
                                                      =
                                                      1
                                                      ,
                                                      S
                                                      i
                                                      =
                                                      5
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                =
                                                
                                                   
                                                      
                                                         Σ
                                                         
                                                            T
                                                            r
                                                            ,
                                                            S
                                                         
                                                      
                                                      P
                                                      (
                                                      G
                                                      =
                                                      1
                                                      )
                                                      P
                                                      (
                                                      A
                                                      =
                                                      2
                                                      )
                                                      P
                                                      (
                                                      R
                                                      =
                                                      1
                                                      )
                                                      P
                                                      (
                                                      S
                                                      i
                                                      =
                                                      5
                                                      |
                                                      G
                                                      =
                                                      1
                                                      ,
                                                      A
                                                      =
                                                      2
                                                      ,
                                                      R
                                                      =
                                                      1
                                                      )
                                                      P
                                                      (
                                                      T
                                                      r
                                                      |
                                                      G
                                                      =
                                                      1
                                                      ,
                                                      A
                                                      =
                                                      2
                                                      ,
                                                      R
                                                      =
                                                      1
                                                      ,
                                                      S
                                                      i
                                                      =
                                                      5
                                                      )
                                                      P
                                                      (
                                                      T
                                                      =
                                                      1
                                                      |
                                                      A
                                                      =
                                                      2
                                                      ,
                                                      S
                                                      i
                                                      =
                                                      5
                                                      ,
                                                      T
                                                      r
                                                      )
                                                      P
                                                      (
                                                      S
                                                      |
                                                      A
                                                      =
                                                      2
                                                      ,
                                                      T
                                                      =
                                                      1
                                                      )
                                                   
                                                   
                                                      
                                                         Σ
                                                         
                                                            T
                                                            r
                                                            ,
                                                            T
                                                            ,
                                                            S
                                                         
                                                      
                                                      P
                                                      (
                                                      G
                                                      =
                                                      1
                                                      )
                                                      P
                                                      (
                                                      A
                                                      =
                                                      2
                                                      )
                                                      P
                                                      (
                                                      R
                                                      =
                                                      1
                                                      )
                                                      P
                                                      (
                                                      S
                                                      i
                                                      =
                                                      5
                                                      |
                                                      G
                                                      =
                                                      1
                                                      ,
                                                      A
                                                      =
                                                      2
                                                      ,
                                                      R
                                                      =
                                                      1
                                                      )
                                                      P
                                                      (
                                                      T
                                                      r
                                                      |
                                                      G
                                                      =
                                                      1
                                                      ,
                                                      A
                                                      =
                                                      2
                                                      ,
                                                      R
                                                      =
                                                      1
                                                      ,
                                                      S
                                                      i
                                                      =
                                                      5
                                                      )
                                                      P
                                                      (
                                                      T
                                                      |
                                                      A
                                                      =
                                                      2
                                                      ,
                                                      S
                                                      i
                                                      =
                                                      5
                                                      ,
                                                      T
                                                      r
                                                      )
                                                      P
                                                      (
                                                      S
                                                      |
                                                      A
                                                      =
                                                      2
                                                      ,
                                                      T
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                =
                                                
                                                   
                                                      P
                                                      (
                                                      G
                                                      =
                                                      1
                                                      )
                                                      P
                                                      (
                                                      A
                                                      =
                                                      2
                                                      )
                                                      P
                                                      (
                                                      R
                                                      =
                                                      1
                                                      )
                                                      P
                                                      (
                                                      S
                                                      i
                                                      =
                                                      5
                                                      |
                                                      G
                                                      =
                                                      1
                                                      ,
                                                      A
                                                      =
                                                      2
                                                      ,
                                                      R
                                                      =
                                                      1
                                                      )
                                                      
                                                         Σ
                                                         
                                                            T
                                                            r
                                                         
                                                      
                                                      P
                                                      (
                                                      T
                                                      r
                                                      |
                                                      G
                                                      =
                                                      1
                                                      ,
                                                      A
                                                      =
                                                      2
                                                      ,
                                                      R
                                                      =
                                                      1
                                                      ,
                                                      S
                                                      i
                                                      =
                                                      5
                                                      )
                                                      P
                                                      (
                                                      T
                                                      =
                                                      1
                                                      |
                                                      A
                                                      =
                                                      2
                                                      ,
                                                      S
                                                      i
                                                      =
                                                      5
                                                      ,
                                                      T
                                                      r
                                                      )
                                                      
                                                         Σ
                                                         S
                                                      
                                                      P
                                                      (
                                                      S
                                                      |
                                                      A
                                                      =
                                                      2
                                                      ,
                                                      T
                                                      =
                                                      1
                                                      )
                                                   
                                                   
                                                      P
                                                      (
                                                      G
                                                      =
                                                      1
                                                      )
                                                      P
                                                      (
                                                      A
                                                      =
                                                      2
                                                      )
                                                      P
                                                      (
                                                      R
                                                      =
                                                      1
                                                      )
                                                      P
                                                      (
                                                      S
                                                      i
                                                      =
                                                      5
                                                      |
                                                      G
                                                      =
                                                      1
                                                      ,
                                                      A
                                                      =
                                                      2
                                                      ,
                                                      R
                                                      =
                                                      1
                                                      )
                                                      
                                                         Σ
                                                         
                                                            T
                                                            r
                                                         
                                                      
                                                      P
                                                      (
                                                      T
                                                      r
                                                      |
                                                      G
                                                      =
                                                      1
                                                      ,
                                                      A
                                                      =
                                                      2
                                                      ,
                                                      R
                                                      =
                                                      1
                                                      ,
                                                      S
                                                      i
                                                      =
                                                      5
                                                      )
                                                      
                                                         Σ
                                                         
                                                            T
                                                            ,
                                                            T
                                                            r
                                                         
                                                      
                                                      P
                                                      (
                                                      T
                                                      |
                                                      A
                                                      =
                                                      2
                                                      ,
                                                      S
                                                      i
                                                      =
                                                      5
                                                      ,
                                                      T
                                                      r
                                                      )
                                                      
                                                         Σ
                                                         
                                                            T
                                                            ,
                                                            S
                                                         
                                                      
                                                      P
                                                      (
                                                      S
                                                      |
                                                      A
                                                      =
                                                      2
                                                      ,
                                                      T
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                =
                                                0.1675
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

The survivability of patient with brain metastasis is also informative and crucial for the treatment management, especially to avoid the over treatment of radiation. Therefore, the proposed BN model aids physicians to predict the 2-month survivability of patient with brain metastasis given some evidences. Physicians can make decision to apply the WBRT to patients based on the finding obtained in the study. To employ the proposed BN model, for example, a male patient with lung cancer in the bronchus (1622), interval 1–2 month has the probability to survive longer than 2 months is 91.98%. The probability computation can be expressed as follows:
                           
                              
                                 
                                    P
                                    (
                                    S
                                    =
                                    1
                                    |
                                    G
                                    =
                                    1
                                    ,
                                    S
                                    i
                                    =
                                    3
                                    ,
                                    T
                                    =
                                    1
                                    )
                                    =
                                    
                                       
                                          P
                                          (
                                          S
                                          =
                                          1
                                          ,
                                          G
                                          =
                                          1
                                          ,
                                          S
                                          i
                                          =
                                          3
                                          ,
                                          T
                                          =
                                          1
                                          )
                                       
                                       
                                          P
                                          (
                                          G
                                          =
                                          1
                                          ,
                                          S
                                          i
                                          =
                                          3
                                          ,
                                          T
                                          =
                                          1
                                          )
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                =
                                                
                                                   
                                                      
                                                         Σ
                                                         
                                                            A
                                                            ,
                                                            R
                                                            ,
                                                            T
                                                            r
                                                         
                                                      
                                                      P
                                                      (
                                                      G
                                                      =
                                                      1
                                                      )
                                                      P
                                                      (
                                                      A
                                                      )
                                                      P
                                                      (
                                                      R
                                                      )
                                                      P
                                                      (
                                                      S
                                                      i
                                                      =
                                                      3
                                                      |
                                                      G
                                                      =
                                                      1
                                                      ,
                                                      A
                                                      ,
                                                      R
                                                      )
                                                      P
                                                      (
                                                      T
                                                      r
                                                      |
                                                      G
                                                      =
                                                      1
                                                      ,
                                                      A
                                                      ,
                                                      R
                                                      ,
                                                      S
                                                      i
                                                      =
                                                      3
                                                      )
                                                      P
                                                      (
                                                      T
                                                      =
                                                      1
                                                      |
                                                      A
                                                      =
                                                      2
                                                      ,
                                                      S
                                                      i
                                                      =
                                                      3
                                                      ,
                                                      T
                                                      r
                                                      )
                                                      P
                                                      (
                                                      S
                                                      =
                                                      1
                                                      |
                                                      A
                                                      ,
                                                      T
                                                      =
                                                      1
                                                      )
                                                   
                                                   
                                                      
                                                         Σ
                                                         
                                                            A
                                                            ,
                                                            R
                                                            ,
                                                            T
                                                            r
                                                            ,
                                                            S
                                                         
                                                      
                                                      P
                                                      (
                                                      G
                                                      =
                                                      1
                                                      )
                                                      P
                                                      (
                                                      A
                                                      )
                                                      P
                                                      (
                                                      R
                                                      )
                                                      P
                                                      (
                                                      S
                                                      i
                                                      =
                                                      3
                                                      |
                                                      G
                                                      =
                                                      1
                                                      ,
                                                      A
                                                      ,
                                                      R
                                                      )
                                                      P
                                                      (
                                                      T
                                                      r
                                                      |
                                                      G
                                                      =
                                                      1
                                                      ,
                                                      A
                                                      ,
                                                      R
                                                      ,
                                                      S
                                                      i
                                                      =
                                                      3
                                                      )
                                                      P
                                                      (
                                                      T
                                                      =
                                                      1
                                                      |
                                                      A
                                                      =
                                                      2
                                                      ,
                                                      S
                                                      i
                                                      =
                                                      3
                                                      ,
                                                      T
                                                      r
                                                      )
                                                      P
                                                      (
                                                      S
                                                      |
                                                      A
                                                      ,
                                                      T
                                                      =
                                                      1
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                =
                                                
                                                   
                                                      P
                                                      (
                                                      G
                                                      =
                                                      1
                                                      )
                                                      
                                                         Σ
                                                         
                                                            A
                                                            ,
                                                            R
                                                            ,
                                                            T
                                                            r
                                                         
                                                      
                                                      P
                                                      (
                                                      A
                                                      )
                                                      P
                                                      (
                                                      R
                                                      )
                                                      P
                                                      (
                                                      S
                                                      i
                                                      =
                                                      3
                                                      |
                                                      G
                                                      =
                                                      1
                                                      ,
                                                      A
                                                      ,
                                                      R
                                                      )
                                                      P
                                                      (
                                                      T
                                                      r
                                                      |
                                                      G
                                                      =
                                                      1
                                                      ,
                                                      A
                                                      ,
                                                      R
                                                      ,
                                                      S
                                                      i
                                                      =
                                                      3
                                                      )
                                                      P
                                                      (
                                                      T
                                                      =
                                                      1
                                                      |
                                                      A
                                                      =
                                                      2
                                                      ,
                                                      S
                                                      i
                                                      =
                                                      3
                                                      ,
                                                      T
                                                      r
                                                      )
                                                      P
                                                      (
                                                      S
                                                      =
                                                      1
                                                      |
                                                      A
                                                      ,
                                                      T
                                                      =
                                                      1
                                                      )
                                                   
                                                   
                                                      P
                                                      (
                                                      G
                                                      =
                                                      1
                                                      )
                                                      
                                                         Σ
                                                         
                                                            A
                                                            ,
                                                            R
                                                            ,
                                                            T
                                                            r
                                                            ,
                                                            S
                                                         
                                                      
                                                      P
                                                      (
                                                      A
                                                      )
                                                      P
                                                      (
                                                      R
                                                      )
                                                      P
                                                      (
                                                      S
                                                      i
                                                      =
                                                      3
                                                      |
                                                      G
                                                      =
                                                      1
                                                      ,
                                                      A
                                                      ,
                                                      R
                                                      )
                                                      P
                                                      (
                                                      T
                                                      r
                                                      |
                                                      G
                                                      =
                                                      1
                                                      ,
                                                      A
                                                      ,
                                                      R
                                                      ,
                                                      S
                                                      i
                                                      =
                                                      3
                                                      )
                                                      P
                                                      (
                                                      T
                                                      =
                                                      1
                                                      |
                                                      A
                                                      =
                                                      2
                                                      ,
                                                      S
                                                      i
                                                      =
                                                      3
                                                      ,
                                                      T
                                                      r
                                                      )
                                                      P
                                                      (
                                                      S
                                                      |
                                                      A
                                                      ,
                                                      T
                                                      =
                                                      1
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                =
                                                0.9198
                                                   
                                                (
                                                or
                                                   
                                                P
                                                (
                                                S
                                                =
                                                2
                                                |
                                                G
                                                =
                                                1
                                                ,
                                                S
                                                i
                                                =
                                                3
                                                ,
                                                T
                                                =
                                                1
                                                )
                                                =
                                                0.0802
                                                )
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

Furthermore, the obtained probabilities using the proposed BN profitably guide insurance policymakers to specify the relationship between patients’ demographic information, the occurrence of brain metastasis in different interval, and the survivability. For example, given a patient with lung cancer in the bronchus (1624) aged lower 50 years and developing brain metastasis longer than 1 year, the probability of these conditions happening in any gender of a patient is P(G
                        =1|A
                        =1, Si
                        =5, T
                        =4) and is expressed as follows:
                           
                              
                                 
                                    P
                                    (
                                    G
                                    =
                                    1
                                    |
                                    A
                                    =
                                    1
                                    ,
                                    S
                                    i
                                    =
                                    5
                                    =
                                    T
                                    =
                                    4
                                    )
                                    =
                                    
                                       
                                          P
                                          (
                                          G
                                          =
                                          1
                                          ,
                                          A
                                          =
                                          1
                                          ,
                                          S
                                          i
                                          =
                                          5
                                          ,
                                          T
                                          =
                                          4
                                          )
                                       
                                       
                                          P
                                          (
                                          A
                                          =
                                          1
                                          ,
                                          S
                                          i
                                          =
                                          5
                                          ,
                                          T
                                          =
                                          4
                                          )
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                =
                                                
                                                   
                                                      
                                                         Σ
                                                         
                                                            R
                                                            ,
                                                            T
                                                            r
                                                            ,
                                                            S
                                                         
                                                      
                                                      P
                                                      (
                                                      G
                                                      =
                                                      1
                                                      )
                                                      P
                                                      (
                                                      A
                                                      =
                                                      1
                                                      )
                                                      P
                                                      (
                                                      R
                                                      )
                                                      P
                                                      (
                                                      S
                                                      i
                                                      =
                                                      5
                                                      |
                                                      G
                                                      =
                                                      1
                                                      ,
                                                      A
                                                      =
                                                      1
                                                      ,
                                                      R
                                                      )
                                                      P
                                                      (
                                                      T
                                                      r
                                                      |
                                                      G
                                                      =
                                                      1
                                                      ,
                                                      A
                                                      =
                                                      1
                                                      ,
                                                      R
                                                      ,
                                                      S
                                                      i
                                                      =
                                                      5
                                                      )
                                                      P
                                                      (
                                                      T
                                                      =
                                                      4
                                                      |
                                                      A
                                                      =
                                                      1
                                                      ,
                                                      S
                                                      i
                                                      =
                                                      5
                                                      ,
                                                      T
                                                      r
                                                      )
                                                      P
                                                      (
                                                      S
                                                      |
                                                      A
                                                      =
                                                      1
                                                      ,
                                                      T
                                                      =
                                                      1
                                                      )
                                                   
                                                   
                                                      
                                                         Σ
                                                         
                                                            G
                                                            ,
                                                            R
                                                            ,
                                                            T
                                                            r
                                                            ,
                                                            S
                                                         
                                                      
                                                      P
                                                      (
                                                      G
                                                      )
                                                      P
                                                      (
                                                      A
                                                      =
                                                      1
                                                      )
                                                      P
                                                      (
                                                      R
                                                      )
                                                      P
                                                      (
                                                      S
                                                      i
                                                      =
                                                      5
                                                      |
                                                      G
                                                      =
                                                      1
                                                      ,
                                                      A
                                                      =
                                                      1
                                                      ,
                                                      R
                                                      )
                                                      P
                                                      (
                                                      T
                                                      r
                                                      |
                                                      G
                                                      =
                                                      1
                                                      ,
                                                      A
                                                      =
                                                      1
                                                      ,
                                                      R
                                                      ,
                                                      S
                                                      i
                                                      =
                                                      5
                                                      )
                                                      P
                                                      (
                                                      T
                                                      =
                                                      4
                                                      |
                                                      A
                                                      =
                                                      1
                                                      ,
                                                      S
                                                      i
                                                      =
                                                      5
                                                      ,
                                                      T
                                                      r
                                                      )
                                                      P
                                                      (
                                                      S
                                                      |
                                                      A
                                                      =
                                                      1
                                                      ,
                                                      T
                                                      =
                                                      1
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                =
                                                
                                                   
                                                      P
                                                      (
                                                      G
                                                      =
                                                      1
                                                      )
                                                      P
                                                      (
                                                      A
                                                      =
                                                      1
                                                      )
                                                      
                                                         Σ
                                                         
                                                            R
                                                            ,
                                                            T
                                                            r
                                                            ,
                                                            S
                                                         
                                                      
                                                      P
                                                      (
                                                      R
                                                      )
                                                      P
                                                      (
                                                      S
                                                      i
                                                      =
                                                      5
                                                      |
                                                      G
                                                      =
                                                      1
                                                      ,
                                                      A
                                                      =
                                                      1
                                                      ,
                                                      R
                                                      )
                                                      P
                                                      (
                                                      T
                                                      r
                                                      |
                                                      G
                                                      =
                                                      1
                                                      ,
                                                      A
                                                      =
                                                      1
                                                      ,
                                                      R
                                                      ,
                                                      S
                                                      i
                                                      =
                                                      5
                                                      )
                                                      P
                                                      (
                                                      T
                                                      =
                                                      4
                                                      |
                                                      A
                                                      =
                                                      1
                                                      ,
                                                      S
                                                      i
                                                      =
                                                      5
                                                      ,
                                                      T
                                                      r
                                                      )
                                                      P
                                                      (
                                                      S
                                                      |
                                                      A
                                                      =
                                                      1
                                                      ,
                                                      T
                                                      =
                                                      1
                                                      )
                                                   
                                                   
                                                      P
                                                      (
                                                      A
                                                      =
                                                      1
                                                      )
                                                      
                                                         Σ
                                                         
                                                            G
                                                            ,
                                                            R
                                                            ,
                                                            T
                                                            r
                                                            ,
                                                            S
                                                         
                                                      
                                                      P
                                                      (
                                                      G
                                                      )
                                                      P
                                                      (
                                                      R
                                                      )
                                                      P
                                                      (
                                                      S
                                                      i
                                                      =
                                                      5
                                                      |
                                                      G
                                                      =
                                                      1
                                                      ,
                                                      A
                                                      =
                                                      1
                                                      ,
                                                      R
                                                      )
                                                      P
                                                      (
                                                      T
                                                      r
                                                      |
                                                      G
                                                      =
                                                      1
                                                      ,
                                                      A
                                                      =
                                                      1
                                                      ,
                                                      R
                                                      ,
                                                      S
                                                      i
                                                      =
                                                      5
                                                      )
                                                      P
                                                      (
                                                      T
                                                      =
                                                      4
                                                      |
                                                      A
                                                      =
                                                      1
                                                      ,
                                                      S
                                                      i
                                                      =
                                                      5
                                                      ,
                                                      T
                                                      r
                                                      )
                                                      P
                                                      (
                                                      S
                                                      |
                                                      A
                                                      =
                                                      1
                                                      ,
                                                      T
                                                      =
                                                      1
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                =
                                                0.7258
                                                   
                                                (
                                                or
                                                   
                                                P
                                                (
                                                G
                                                =
                                                2
                                                |
                                                A
                                                =
                                                1
                                                ,
                                                S
                                                i
                                                =
                                                5
                                                ,
                                                T
                                                =
                                                4
                                                )
                                                =
                                                0.2742
                                                )
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

The performance of the proposed model was compared against benchmark methods (LR, NB, and SVM) by using Weka at the default. The proposed BN and the three methods are applied to the imbalanced and balanced data sets that were pre-processed using SMOTE. The five replications of the accuracy, sensitivity, and specificity values of the four models without and with SMOTE are presented in Table 4
                        (a) and (b), respectively. The proposed BN performed the best in terms of accuracy and specificity when SMOTE is not presented. However, all methods are poor in sensitivity. The sensitivity performance improved when SMOTE was employed. Therefore, LR performed the best in terms of specificity, when SMOTE was presented.

The significance of performances of the different models was further determined using Kruskal Wallis test because the data did not follow the normal distribution for each model. The results of Kruskal Wallis test in Table 5
                         show at least one significant difference (p
                        <0.05) of specificity and sensitivity among these methods; however, the accuracy performances are statistically similar for all methods. To identify the differences among specificity and sensitivity for these models, Mann–Whitney was used, and the results are presented in Table 6
                        (a) and (b). Three findings are as follows: (1) the models without SMOTE (i.e., the proposed BN, NB, LR, and SVM) applied on the original imbalanced data set have no significant different in terms of performance, (2) the models with SMOTE (i.e., SMOTE+the proposed BN, SMOTE+NB, SMOTE+LR, and SMOTE+SVM) applied on the balanced data set were not significantly different in terms of performance, and (3) the performances of the proposed BN, NB, LR, and SVM compared to SMOTE+the proposed BN, SMOTE+NB, SMOTE+LR, and SMOTE+SVM in pair, respectively, were significantly different. In addition, the performances of all models with SMOTE were arranged significantly different from the proposed BN, NB, LR, and SVM.

@&#CONCLUSION@&#

The performance for short survival prognosis in lung cancer patients with brain metastases was generally poor. In this study, a BN model was proposed to resolve this problem. The BN model was first applied to predict the short survivability for lung cancer patients with brain metastasis. Seven factors were identified and used to construct the BN model. These factors include (1) age, (2) gender; (3) region of residence and environment of patients, (4) site of lung cancer within human body, (5) treatment, (6) interval, and (7) short survivability. The cohort consisted of 438 lung cancer patients with brain metastasis collected from nationwide database containing more than 50,000 cases of cancer patients from 1996 to 2010 in Taiwan. The profile of patients with brain metastasis was categorized and the explanatory graphical model and various inferences were shown.

In practical application, the proposed BN is not only useful to predict the short survivability of patients with brain metastasis with high performance, but it can also compute the posterior probabilities of any query variable given the evidences. For example, physicians can use the proposed BN to predict the probability of the following: a patient experiencing lung cancer given particular demographic information regarding the patient, a patient experiencing brain metastasis in different interval after undergoing treatment, and a patient surviving who has brain metastasis in different intervals and sites of lung cancer. Moreover, policymakers can receive advice on cancer patient management and development of protective measures by querying the patient characteristics given any evidence for the site of lung cancer, type of treatment, interval from first lung diagnosis to development of brain metastases, and survivability.

With reference to prediction performance, the proposed BN was compared with standard benchmark methods (LR, NB, and SVM). Statistical analysis showed that performances of proposed BN, LR, NB, and SVM were statistically the same in terms of all indices with the low sensitivity values when these models were applied on the imbalanced data set. To improve the performance in terms of the sensitivity (the correct prediction for the minority group) value affected by imbalanced data, SMOTE was used to balance the data set. The performances of all models with SMOTE were significantly improved in terms of sensitivity, while maintaining the quality of specificity.

Although further statistical analysis showed that the proposed model did not significantly outperform the benchmark methods, several benefits of using the proposed BN over the benchmark models have been observed: (1) the proposed model is easily understood by physicians as shown in Fig. 1; (2) the proposed model is capable in modeling both linear and non-linear situations; (3) the ability of the proposed BN to solve probabilistic medical decision-making problems, such as the survivability of patients with lung cancer brain metastasis, by finding the probability distribution of children nodes given the evidence values of their parents and vice versa, as shown in the experimental results; (4) the ability the proposed model to handle situations wherein information is missing, as indicated in a variety of medical-related queries and decisions on several evidences; and (5) the sensitivity is critical to cancer patient identification and the sensitivity of the proposed BN is the highest among all standard machine learning methods.

A suggested future study involves extending the proposed BN model to predict the cost of treatment for lung cancer brain metastasis. Several clinical investigations using the proposed model are also suggested. The correct classification of the “survival” and “non survival” populations are both important because different cure/treatments required to be conducted for distinct situations. Notably, this raises a decision regarding type I error and type II error issues in statistics. The cost due to wrong classification of the two distinct populations needs to be further evaluated by medical practice consideration and patient risk management.

None declared.

@&#ACKNOWLEDGEMENTS@&#

The authors gratefully acknowledge the comments and suggestions of the editor and the anonymous referees. This work is partially supported by the National Science Council, ROC (Taiwan) and National Taiwan University of Science and Technology – Taipei Medical University Joint Research Program (TMU-NTUST-102-06 and TMU-NTUST-101-07). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript. This study is based in part on data from the National Health Insurance Research Database provided by the Bureau of National Health Insurance, Department of Health and managed by National Health Research Institutes, ROC (Taiwan). The interpretation and conclusions contained herein do not represent those of Bureau of National Health Insurance, Department of Health or National Health Research Institutes.

See Tables A1–A4
                     
                     
                     
                     .

@&#REFERENCES@&#

