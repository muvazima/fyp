@&#MAIN-TITLE@&#A robust optimization approach to energy and reserve dispatch in electricity markets

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We determine electrical energy and reserve dispatch via adaptive robust optimization.


                        
                        
                           
                           A novel reformulation is proposed to account for general polyhedral uncertainty sets.


                        
                        
                           
                           We compare robust optimization, stochastic programming and deterministic approaches.


                        
                        
                           
                           The proposed model gradually trades off optimality in expectation with risk aversion.


                        
                        
                           
                           The robust optimization approach scales well with the size of the power system.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

OR in energy

Robust optimization

Decomposition

Electricity market

Renewable energy

@&#ABSTRACT@&#


               
               
                  To a large extent, electricity markets worldwide still rely on deterministic procedures for clearing energy and reserve auctions. However, increasing shares of the production mix consist of renewable sources whose nature is stochastic and non-dispatchable, as their output is uncertain and cannot be controlled by the operators of the production units. Stochastic programming models allow the joint determination of the day-ahead energy and reserve dispatch accounting for the uncertainty in the output from these sources. However, the size of these models gets quickly out of hand as a large number of scenarios are needed to properly represent the uncertainty. In this work, we take an alternative approach and cast the problem as an adaptive robust optimization problem. The resulting day-ahead energy and reserve schedules yield the minimum system cost, accounting for the cost of the redispatch decisions at the balancing (real-time) stage, in the worst-case realization of the stochastic production within a specified uncertainty set. We propose a novel reformulation of the problem that allows considering general polyhedral uncertainty sets. In a case-study, we show that, in comparison to a risk-averse stochastic programming model, the robust optimization approach progressively trades off optimality in expectation with improved performance in terms of risk. These differences, however, gradually taper off as the level of risk-aversion increases for the stochastic programming approach. Computational studies show that the robust optimization model scales well with the size of the power system, which is promising in view of real-world applications of this approach.
               
            

@&#INTRODUCTION@&#

In recent years, renewable electricity production sources have experienced an unprecedented growth in installed capacity worldwide. Such a development is explained both by technological advance, which has made production from sources like wind and solar cheaper, and by governmental support aimed at promoting sustainability. Sources of this type are fundamentally different from conventional means of electricity generation. Indeed, they are stochastic, i.e., their production is not known with certainty in advance, and non-dispatchable, i.e., the power plant operators have partial or no control on the output level.

Owing to the features described above, an increasing penetration of renewables challenges the traditional way electricity markets are operated. In particular, deterministic schemes have been employed for years to assess the amount of reserve capacity, the availability of which is needed in order to cope with unforeseen events in the system. Typically, mechanisms for reserve determination are based on deterministic 
                        
                           n
                           −
                           1
                        
                      or 
                        
                           n
                           −
                           k
                        
                      criteria, which guarantee the functioning of an n-unit system in the event of loss of the largest unit, or of the k largest units in the system, respectively. As the penetration of stochastic generation sources in power system grows, reserves are increasingly used to cover the fluctuations of the power output from renewables, thus calling for stochastic decision-making tools.

In parallel, market-clearing procedures for energy markets are also challenged by the growth of stochastic production capacity. For example, the day-ahead market is cleared according to a deterministic least-cost dispatch principle based on the offers and bids submitted by suppliers and consumers. Stochastic production is normally dispatched at a point forecast of its output distribution. However, this procedure does not account for the projected cost of the dispatch at the balancing stage, and is therefore suboptimal, see Pritchard, Zakeri, and Philpott (2010).

The existing literature on the subject, see Morales, Conejo, and Pérez-Ruiz (2009), shows that system cost can be significantly reduced in expectation by jointly optimizing the day-ahead dispatch and the reserve in a stochastic programming framework (Birge & Louveaux, 2011). However, models of this type exhibit two important drawbacks. Firstly, to represent the uncertain parameters, e.g., the uncertain production at different locations in the grid, a number of scenarios need to be fabricated, usually by fitting distribution functions to historical data. This is a complex process that may result in a distorted representation of the uncertainty, especially if many dependent uncertain parameters need to be represented. Secondly, the number of scenarios required to achieve an accurate representation of the uncertain parameters is large, which generally involves high computational burden and eventual intractability.

An alternative framework to stochastic programming for dealing with problems under uncertainty is robust optimization, see Bertsimas, Brown, and Caramanis (2011). This framework for decision-making under uncertainty does not require scenarios. Indeed, the uncertain parameters are represented through uncertainty sets, directly derived from the historical data without resorting to scenarios. This generally results in computationally tractable models with appropriate flexibility in terms of conservatism. A robust solution must be feasible for any realization of the uncertainty, and optimal in the worst-case choice of the stochastic parameters in the uncertainty set. The equivalent of stochastic programming with recourse in robust optimization is adaptive robust optimization. This framework aims at minimizing the total cost in the worst-case realization of the stochastic parameters, assuming that recourse actions can be taken as a response to the uncertainty.

The modeling effort is reduced in robust optimization to a description of a meaningful set over which the uncertain parameters may take values in, i.e., the support of the density function rather than the full probability distribution required by the stochastic programming approach. As the number of stochastic production facilities grows in an electric energy system, the level of uncertain dependent parameters dramatically increases, which, unless drastic simplifications are implemented, leads to intractable stochastic programming models. On the contrary, the difficulty in solving robust optimization models does not increase significantly with the number of uncertain dependent parameters, and thus robust optimization is particularly suited to attack the considered problem in this paper: the development of a market clearing algorithm under a highly uncertain production.

Recent applications of adaptive robust optimization focusing on unit commitment in electricity markets are presented in Bertsimas, Litvinov, Sun, Zhao, and Zheng (2012), Furini, Laguna, and Samorani (2012), Jiang, Wang, and Guan (2012), Jiang, Zhang, Li, and Guan (2014), Zhao and Zeng (2012) , which study the problem under uncertain load or production from stochastic sources. In all these works, a cutting-plane approach is employed to exploit the convex dependence of the objective function on the first-stage decision, see Thiele, Terry, and Epelman (2010). Then, the max-min problem resulting from the sequential enforcement of the worst-case (maximum-cost or maximum-regret in the case of Furini et al. (2012)) parameter realization and decision on the optimal recourse action is cast as a single-level bilinear program. This problem is then solved either with an heuristic (outer-approximation in Bertsimas et al. (2012)), or as a Mixed Integer Linear Program (MILP) after linearization through binary expansion (Jiang et al., 2012; Zhao & Zeng, 2012). Both approaches are considered and compared in Jiang et al. (2014). Different, though related, applications of two-stage robust optimization in electricity markets include unit commitment considering contingencies (Guan & Wang, 2014) and the self-scheduling and trading for a virtual power plant (Lima, Novais, & Conejo, 2015).

Considering the above framework, the main features of the model presented in this paper are threefold:

                        
                           1.
                           We apply adaptive robust optimization to the problem of determining the optimal day-ahead energy and reserve dispatch in a single time-period, rather than to unit commitment. The problem we consider is relevant since, as Section 2 clarifies, it resembles the current design of electricity markets in Europe, where decisions on unit commitment are left to the power producers, and the market operator determines sequentially the amount of reserves needed and the optimal day-ahead energy dispatch. Note that the extension of the proposed model to a multi-period setting does not entail any conceptual complication but only computational ones. We propose the joint determination of day-ahead energy and reserve dispatch akin to the one in Morales et al. (2009), though in a robust optimization framework.

We propose a reformulation of the inner max–min problem for the determination of the uncertainty and recourse decision that can accommodate general polyhedral sets for the uncertainty and converges to an exact solution. Our approach is more flexible than the binary reformulation in Jiang et al. (2012, 2014); Zhao and Zeng (2012) in that, differently from those models, it allows to model any polyhedral uncertainty set rather than a budget uncertainty set, still using a comparable number of binary variables. Note that this additional flexibility allows the modeler to design uncertainty sets of smaller size, though still able to encompass all the relevant realizations of the uncertainty. In turn, the reduced size of the uncertainty set may decrease the conservativeness of the solution, and thus its suboptimality in expectation, see Guan and Wang (2014). In comparison to the heuristic approach in Bertsimas et al. (2012), Jiang et al. (2014), which is more flexible with respect to the choice of the uncertainty set, our reformulation guarantees convergence to an optimal solution.

We compare the results obtained from the robust optimization approach with the ones from corresponding deterministic and stochastic programming versions of the model, considering for the latter both the risk-neutral and the risk-averse cases. Another original feature of this work is that these comparisons are based on a battery of case-studies where real-world data for wind power production are employed within standard IEEE power system models.

The structure of the paper is the following. Section 2 briefly describes the design of American and European electricity markets, and relates them to the market framework considered in this paper. In Section 3, we introduce the formulation of the problem. Algorithms for solving this problem are then described in Section 4. Section 5 presents results from a simple illustrative example and from a larger case study based on the 24-node IEEE Reliability Test System in Grigg et al. (1999), as well as computational results based on case-studies involving networks of different sizes. Finally, conclusions are presented in Section 6.

Electricity markets throughout the world generally operate as pools or exchanges, and include two trading floors: the day-ahead market and the real-time or balancing market. The day-ahead market clears 12–36 hours in advance of electrical energy delivery, and involves firm financial obligations. The output of the day-ahead market clearing is the energy production and consumption schedules as well as the electricity prices. The real-time market clears minutes prior to electrical energy delivery and makes it possible to balance supply and demand. The real-time market is particularly relevant because electrical energy cannot be stored in significant quantities, and for a number of important technical reasons, supply and demand should be balanced at any time. In addition to energy, an important commodity is also traded in the day-ahead market: reserve. Reserve involves the ability by certain facilities to increase or reduce production to guarantee energy balance at any time. Reserve of the former type, i.e., for production increase, is referred to as upward reserve, while the latter one, i.e., for production reduction, as downward reserve.

In most American markets, reserve and electrical energy are cleared in the day-ahead market, once producers and consumers submit production offers and demand bids. The market is cleared using an appropriate market clearing algorithm, and clearing prices are fabricated disregarding non-convexities, notoriously those pertaining to the start-up and shut-down costs of the production units. Ad-hoc, heuristic procedures are then used to compensate producers for start-up and shut-down cost. As part of clearing the market, the operator – denoted as Independent Systems Operator or ISO – decides on the start-up and shut-down of the production units. Production offers by producers are supposed to be close to actual marginal costs and the regulator has the obligation to monitor the market to verify that this is the case.

Most European markets work as their American counterparts, but with a fundamental difference: producers keep the right to start-up and shut-down their own production facilities at their will, provided that they comply with their market clearing obligations. Since these producers do not receive out-of-the-market compensation for start-up and shut-down costs, they are allowed (by the regulator) to submit production offers above marginal costs. Such production offers should internalize start-up and shut-down costs.

Another fundamental difference among American and European markets is that most American markets include in the market clearing algorithms a detailed representation of the transmission network, which renders market clearing solutions that comply with transmission limits. On the contrary, most European markets, pursuing simplicity, do not represent the transmission networks in their market clearing algorithms. This generally results in market clearing outcomes that violate network limits, which require ad-hoc heuristic adjustments outside the market, and necessarily renders suboptimal solutions.

Considering the above framework, the market clearing algorithm proposed in this paper relies on the following hypothesis:

                        
                           1.
                           As in most currently operating electric energy markets, the considered market is based on a pool that includes a day-ahead auction and a real time one.

The reserve market is cleared jointly with the day-ahead market. This practice is common in many American markets, and will be paramount for the large-scale integration of stochastic renewable sources, as it can improve significantly the efficiency of power system operations, see Morales et al. (2009).

As in most American markets, the proposed market clearing algorithm incorporates a detailed representation on the transmission network.

As in most European markets, the proposed market clearing algorithm gives producers the right to start-up and shut-down their production facilities at their will, provided that they comply with their market obligations.

In short, the proposed clearing algorithm applies to most European markets if transmission constraints are disregarded, and to most American markets if the right to start-up and shut-down production facilities is transferred from the owners of such facilities to the ISO.

When an electric energy system includes stochastic production sources, the joint determination of the optimal day-ahead energy and reserve dispatch can be formulated as the following optimization problem under uncertainty:

                        
                           (1a)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                min
                                                
                                                   p
                                                   ,
                                                   
                                                      r
                                                      +
                                                   
                                                   ,
                                                   
                                                      r
                                                      −
                                                   
                                                   ,
                                                   
                                                      
                                                         δ
                                                      
                                                      0
                                                   
                                                
                                             
                                             
                                             
                                                ∑
                                                k
                                             
                                             
                                                C
                                                k
                                             
                                             
                                                p
                                                k
                                             
                                             +
                                             
                                                C
                                                k
                                                +
                                             
                                             
                                                r
                                                k
                                                +
                                             
                                             +
                                             
                                                C
                                                k
                                                −
                                             
                                             
                                                r
                                                k
                                                −
                                             
                                             +
                                             
                                                Q
                                                W
                                             
                                             
                                                (
                                                p
                                                ,
                                                
                                                   r
                                                   +
                                                
                                                ,
                                                
                                                   r
                                                   −
                                                
                                                ,
                                                
                                                   
                                                      δ
                                                   
                                                   0
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (1b)
                           
                              
                                 
                                    
                                       
                                          s.t.
                                          
                                          
                                             ∑
                                             
                                                k
                                                ∈
                                                
                                                   G
                                                   i
                                                
                                             
                                          
                                          
                                             p
                                             k
                                          
                                          =
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                
                                                   N
                                                   i
                                                
                                             
                                          
                                          
                                             B
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             (
                                             
                                                δ
                                                i
                                                0
                                             
                                             −
                                             
                                                δ
                                                j
                                                0
                                             
                                             )
                                          
                                          +
                                          
                                             d
                                             
                                                s
                                                (
                                                i
                                                )
                                             
                                          
                                          −
                                          
                                             
                                                w
                                                ^
                                             
                                             
                                                q
                                                (
                                                i
                                                )
                                             
                                          
                                          ,
                                          
                                          ∀
                                          i
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (1c)
                           
                              
                                 
                                    
                                       
                                          
                                             δ
                                             1
                                             0
                                          
                                          =
                                          0
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (1d)
                           
                              
                                 
                                    
                                       
                                          
                                             p
                                             k
                                          
                                          +
                                          
                                             r
                                             k
                                             +
                                          
                                          ≤
                                          
                                             P
                                             k
                                             
                                                max
                                             
                                          
                                          ,
                                          
                                          ∀
                                          k
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (1e)
                           
                              
                                 
                                    
                                       
                                          
                                             p
                                             k
                                          
                                          −
                                          
                                             r
                                             k
                                             −
                                          
                                          ≥
                                          0
                                          ,
                                          
                                          ∀
                                          k
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (1f)
                           
                              
                                 
                                    
                                       
                                          
                                             B
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             (
                                             
                                                δ
                                                i
                                                0
                                             
                                             −
                                             
                                                δ
                                                j
                                                0
                                             
                                             )
                                          
                                          ≤
                                          
                                             T
                                             
                                                i
                                                j
                                             
                                             
                                                max
                                             
                                          
                                          ,
                                          
                                          ∀
                                          i
                                          ,
                                          j
                                          ∈
                                          
                                             N
                                             i
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (1g)
                           
                              
                                 
                                    
                                       
                                          
                                             p
                                             k
                                          
                                          ,
                                          
                                             r
                                             k
                                             +
                                          
                                          ,
                                          
                                             r
                                             k
                                             −
                                          
                                          ≥
                                          0
                                          ,
                                          
                                          ∀
                                          k
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where pk
                     , 
                        
                           r
                           k
                           +
                        
                      and 
                        
                           r
                           k
                           −
                        
                      are the dispatch of electricity, upward and downward reserve, respectively, for unit k, while 
                        
                           δ
                           i
                           0
                        
                      is the state variable (voltage angle) at node i of the network. Constraints (1d) and (1e) ensure that the combination of energy and reserve dispatch neither exceeds the production capacity, 
                        
                           
                              P
                              k
                              
                                 max
                              
                           
                           ,
                        
                      nor is negative, respectively. Inequalities (1f) enforce that the flow of electricity from node i to j in the left-hand-side is not larger than the transmission capacity 
                        
                           T
                           
                              i
                              j
                           
                           
                              max
                           
                        
                     . Non-negativity of dispatch is imposed in (1g), while (1c) sets node 1 as the reference by forcing its state variable to 0. Nodal power balance is enforced by (1b), which guarantees that the total electricity dispatch of the units Gi
                      located at node i is equal to the sum of planned net power flow from i to all the neighboring nodes Ni
                     , the consumption from the demand located at the node (indexed by s(i), possibly an empty set) minus the forecast stochastic power production from the production site located at the node (indexed by q(i), possibly an empty set). The first three terms in the objective function represent the dispatch costs of electricity as well as upward and downward reserve (with linear cost coefficients Ck
                     , 
                        
                           C
                           k
                           +
                        
                      and 
                        
                           
                              C
                              k
                              −
                           
                           ,
                        
                      respectively). The last term 
                        
                           
                              Q
                              W
                           
                           
                              (
                              p
                              ,
                              
                                 r
                                 +
                              
                              ,
                              
                                 r
                                 −
                              
                              ,
                              
                                 
                                    δ
                                 
                                 0
                              
                              )
                           
                        
                      is a measure of the cost of redispatch at the balancing market, which in turn is a function of the day-ahead schedule as indicated by the dependence on 
                        
                           p
                           ,
                           
                              r
                              +
                           
                           ,
                           
                              r
                              −
                           
                           ,
                           
                              
                                 δ
                              
                              0
                           
                        
                     . Such a measure is also parameterized on the distribution 
                        W
                      of the uncertainty, in this case, stochastic power generation.

At the balancing market, the actual deviations, Δw
                     
                        q(i), of stochastic power production from the forecasts, 
                        
                           
                              
                                 w
                                 ^
                              
                              
                                 q
                                 (
                                 i
                                 )
                              
                           
                           ,
                        
                      become known and the system operator must redispatch the system accordingly. The optimal redispatch cost is the objective function value of the following optimization problem:

                        
                           (2a)
                           
                              
                                 
                                    
                                       
                                          
                                             min
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                            +
                                                         
                                                         ,
                                                         
                                                            
                                                               p
                                                            
                                                            −
                                                         
                                                         ,
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               l
                                                            
                                                            
                                                               sh
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               w
                                                            
                                                            
                                                               sp
                                                            
                                                         
                                                         ,
                                                         
                                                            δ
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                          
                                             ∑
                                             k
                                          
                                          
                                             C
                                             k
                                          
                                          
                                             (
                                             
                                                p
                                                k
                                                +
                                             
                                             −
                                             
                                                p
                                                k
                                                −
                                             
                                             )
                                          
                                          +
                                          
                                             ∑
                                             s
                                          
                                          
                                             V
                                             
                                                sh
                                             
                                          
                                          
                                             l
                                             s
                                             
                                                sh
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (2b)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          s.t.
                                          
                                          
                                             ∑
                                             
                                                k
                                                ∈
                                                
                                                   G
                                                   i
                                                
                                             
                                          
                                          
                                             (
                                             
                                                p
                                                k
                                                +
                                             
                                             −
                                             
                                                p
                                                k
                                                −
                                             
                                             )
                                          
                                          +
                                          
                                             l
                                             
                                                s
                                                (
                                                i
                                                )
                                             
                                             
                                                sh
                                             
                                          
                                          +
                                          Δ
                                          
                                             w
                                             
                                                q
                                                (
                                                i
                                                )
                                             
                                          
                                          −
                                          
                                             w
                                             
                                                q
                                                (
                                                i
                                                )
                                             
                                             
                                                sp
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                          =
                                          
                                             ∑
                                             
                                                j
                                                ∈
                                                
                                                   N
                                                   i
                                                
                                             
                                          
                                          
                                             B
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             (
                                             
                                                δ
                                                i
                                             
                                             −
                                             
                                                δ
                                                i
                                                0
                                             
                                             −
                                             
                                                δ
                                                j
                                             
                                             +
                                             
                                                δ
                                                j
                                                0
                                             
                                             )
                                          
                                          ,
                                          
                                          ∀
                                          i
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (2c)
                           
                              
                                 
                                    
                                       
                                          
                                          
                                             δ
                                             1
                                          
                                          =
                                          0
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (2d)
                           
                              
                                 
                                    
                                       
                                          
                                          
                                             p
                                             k
                                             +
                                          
                                          ≤
                                          
                                             r
                                             k
                                             +
                                          
                                          ,
                                          
                                          ∀
                                          k
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (2e)
                           
                              
                                 
                                    
                                       
                                          
                                          
                                             p
                                             k
                                             −
                                          
                                          ≤
                                          
                                             r
                                             k
                                             −
                                          
                                          ,
                                          
                                          ∀
                                          k
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (2f)
                           
                              
                                 
                                    
                                       
                                          
                                          
                                             l
                                             s
                                             
                                                sh
                                             
                                          
                                          ≤
                                          
                                             d
                                             s
                                          
                                          ,
                                          
                                          ∀
                                          s
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (2g)
                           
                              
                                 
                                    
                                       
                                          
                                          
                                             w
                                             q
                                             
                                                sp
                                             
                                          
                                          ≤
                                          
                                             
                                                w
                                                ^
                                             
                                             q
                                          
                                          +
                                          Δ
                                          
                                             w
                                             q
                                          
                                          ,
                                          
                                          ∀
                                          q
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (2h)
                           
                              
                                 
                                    
                                       
                                          
                                          
                                             B
                                             
                                                i
                                                j
                                             
                                          
                                          
                                             (
                                             
                                                δ
                                                i
                                             
                                             −
                                             
                                                δ
                                                j
                                             
                                             )
                                          
                                          ≤
                                          
                                             T
                                             
                                                i
                                                j
                                             
                                             
                                                max
                                             
                                          
                                          
                                          ∀
                                          i
                                          ,
                                          j
                                          ∈
                                          
                                             N
                                             i
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (2i)
                           
                              
                                 
                                    
                                       
                                          
                                          
                                             p
                                             k
                                             +
                                          
                                          ,
                                          
                                             p
                                             k
                                             −
                                          
                                          ≥
                                          0
                                          ,
                                          ∀
                                          k
                                          ,
                                          
                                             l
                                             s
                                             
                                                sh
                                             
                                          
                                          ≥
                                          0
                                          ,
                                          ∀
                                          s
                                          ,
                                          
                                             w
                                             q
                                             
                                                sp
                                             
                                          
                                          ≥
                                          0
                                          ,
                                          ∀
                                          q
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

Constraints (2d) and (2e) impose that the upward and downward deviations, 
                        
                           p
                           k
                           +
                        
                      and 
                        
                           
                              p
                              k
                              −
                           
                           ,
                        
                      from the day-ahead electricity dispatch, pk
                     , are not larger than the respective reserves allocated at the day-ahead stage. According to (2f), load-shedding (i.e., the forced disconnection of demand that cannot be supplied) for demand s, 
                        
                           
                              l
                              s
                              
                                 sh
                              
                           
                           ,
                        
                      must be at most equal to the actual consumption. Similarly, stochastic power spillage, 
                        
                           
                              w
                              q
                              
                                 sp
                              
                           
                           ,
                        
                      from each production site q must be smaller than or equal to the actual production as a result of (2g). Transmission limits for real-time power flows resulting from the actual network states, δi
                     , are enforced by (2h), while (2c) confirms node 1 as the reference node. Eq. (2b) ensures that the power redispatch at each node i is equal to the sum of the additional net flow out of the node with the error of stochastic power prediction. Combined with (1b), (2b) imposes the nodal power balance condition at the balancing market stage. The objective function (2a) is given by the cost or benefit of upward or downward redispatch, summed with a penalty for load-shedding.

Within a stochastic programming approach (Birge & Louveaux, 2011), 
                        
                           
                              Q
                              W
                           
                           
                              (
                              p
                              ,
                              
                                 r
                                 +
                              
                              ,
                              
                                 r
                                 −
                              
                              ,
                              
                                 
                                    δ
                                 
                                 0
                              
                              )
                           
                        
                      would be determined as the expectation or the conditional value at risk (or a combination of these) over a discrete set of scenarios approximating the actual distribution of the uncertain deviation of stochastic power production Δw
                     
                        q(i) from the forecast. In a robust optimization framework, instead, we seek to minimize the recourse cost in the worst-case realization of the stochastic parameters within an uncertainty set. As we shall see later in this section, this requires the solution of a three-level min-max-min optimization problem, where the top- and the bottom-level problems correspond to the minimization of dispatch and redispatch cost, respectively, and the maximization problem to the search of the worst-case realization of the uncertainty. We refer the reader to Morales, Conejo, Madsen, Pinson, and Zugno (2014) for more detail on the problem of dispatching energy and reserve.

Indicating all the first-stage (i.e., day-ahead) decision variables 
                        
                           p
                           ,
                           
                              r
                              +
                           
                           ,
                           
                              r
                              −
                           
                           ,
                           
                              
                                 δ
                              
                              0
                           
                        
                      with the vector 
                        
                           x
                           ,
                        
                      we can write (1) compactly as

                        
                           (3a)
                           
                              
                                 
                                    
                                       
                                          
                                             min
                                             x
                                          
                                          
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   c
                                                   x
                                                
                                             
                                             T
                                          
                                          x
                                          +
                                          
                                             Q
                                             W
                                          
                                          
                                             (
                                             x
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (3b)
                           
                              
                                 
                                    
                                       
                                          s.t.
                                          
                                          
                                       
                                    
                                    
                                       
                                          
                                             F
                                             x
                                             =
                                             d
                                             −
                                             
                                                w
                                                ^
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (3c)
                           
                              
                                 
                                    
                                       
                                          
                                          
                                             G
                                             x
                                             ≥
                                             g
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where (3b) includes Eqs. (1b) and (1c), while (3c) group the inequality constraints (1d)–(1g).

Let the vector 
                        y
                      include the recourse variables 
                        
                           
                              p
                              +
                           
                           ,
                           
                              p
                              −
                           
                           ,
                           
                              l
                              
                                 sh
                              
                           
                           ,
                           
                              w
                              
                                 sp
                              
                           
                           ,
                           
                              δ
                           
                        
                      (i.e., pertaining to the balancing market stage). The determination of the worst-case recourse cost, or redispatch cost, writes as the following max–min programming problem, parameterized on the first-stage decision 
                        x
                     :

                        
                           (4a)
                           
                              
                                 
                                    
                                       
                                          
                                             Q
                                             W
                                          
                                          
                                             (
                                             
                                                x
                                             
                                             )
                                          
                                          =
                                          
                                             max
                                             
                                                Δ
                                                w
                                             
                                          
                                          
                                          
                                             min
                                             y
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   c
                                                   y
                                                
                                             
                                             T
                                          
                                          y
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (4b)
                           
                              
                                 
                                    
                                       
                                          s.t.
                                          
                                       
                                    
                                    
                                       
                                          
                                             P
                                             y
                                             =
                                             −
                                             Δ
                                             w
                                             −
                                             Q
                                             x
                                          
                                          ,
                                          
                                          :
                                          
                                             λ
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (4c)
                           
                              
                                 
                                    
                                       
                                          
                                          
                                             L
                                             y
                                             ≥
                                             l
                                             −
                                             M
                                             x
                                             −
                                             N
                                             Δ
                                             w
                                          
                                          ,
                                          
                                          :
                                          
                                             μ
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (4d)
                           
                              
                                 
                                    
                                       
                                          
                                          s.t.
                                          
                                          
                                          H
                                          Δ
                                          w
                                       
                                    
                                    
                                       ≤
                                    
                                    
                                       
                                          h
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

Model (4) has a max-min structure that allows the determination of the minimum recourse cost in the worst-case realization of the uncertainty. Indeed, the maximization problem chooses the worst-case realization of deviation 
                        
                           Δ
                           w
                        
                      of stochastic power production from its conditional mean forecast within the polyhedral uncertainty set defined by the set (4d) of linear inequalities. After the worst-case realization of the uncertainty is chosen, the recourse cost is minimized in the min problem in (4a), that corresponds to (2a). The set of equations (4b) includes (2b) and (2c), while (4c) group inequalities (2d)–(2i).

The formulation in the above section cannot be immediately employed in practice. Indeed, the direct substitution of 
                           
                              
                                 Q
                                 W
                              
                              
                                 (
                                 x
                                 )
                              
                           
                         as defined in (4) into (3) results in a min-max-min problem, for which a general-purpose solution algorithm is not available. However, following the derivations in Bertsimas et al. (2012), Jiang et al. (2012) and Zhao and Zeng (2012), it is possible to reformulate it as a min-max-max problem by substituting the right-hand side max problem with its dual. This results in the following formulation:

                           
                              (5a)
                              
                                 
                                    
                                       
                                          
                                             
                                                min
                                                x
                                             
                                             
                                             
                                             
                                                
                                                   
                                                      c
                                                      x
                                                   
                                                
                                                T
                                             
                                             x
                                             +
                                             
                                                max
                                                
                                                   Δ
                                                   w
                                                
                                             
                                             
                                          
                                       
                                       
                                          
                                             
                                                max
                                                
                                                   λ
                                                   ,
                                                   μ
                                                
                                             
                                             
                                             
                                                
                                                   (
                                                   −
                                                   Δ
                                                   w
                                                   −
                                                   Q
                                                   x
                                                   )
                                                
                                                T
                                             
                                             
                                                λ
                                             
                                             +
                                             
                                                
                                                   (
                                                   l
                                                   −
                                                   M
                                                   x
                                                   −
                                                   N
                                                   Δ
                                                   w
                                                   )
                                                
                                                T
                                             
                                             
                                                μ
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (5b)
                              
                                 
                                    
                                       
                                       
                                          
                                             s.t.
                                             
                                             
                                             
                                                
                                                   P
                                                
                                                T
                                             
                                             
                                                λ
                                             
                                             +
                                             
                                                
                                                   L
                                                
                                                T
                                             
                                             
                                                μ
                                             
                                             =
                                             
                                                c
                                                y
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (5c)
                              
                                 
                                    
                                       
                                          
                                             
                                             
                                                μ
                                             
                                             ≥
                                             0
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (5d)
                              
                                 
                                    
                                       
                                          
                                             
                                             s.t.
                                             
                                             
                                             H
                                             Δ
                                             w
                                             ≤
                                             h
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (5e)
                              
                                 
                                    
                                       
                                          
                                             
                                             s.t.
                                             
                                             
                                             F
                                             x
                                             =
                                             d
                                             −
                                             
                                                w
                                                ^
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (5f)
                              
                                 
                                    
                                       
                                          
                                             
                                             G
                                             x
                                             ≥
                                             g
                                             .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

It should be noticed that model (5) is in fact a min–max programming problem. Indeed, the mid- and right-hand-side maximization problems can be merged into a single maximization problem in the optimization variables 
                           
                              Δ
                              w
                              ,
                           
                         
                        
                           λ
                         and 
                           μ
                        . Furthermore, we point out that the optimization problem resulting from this merging is a bilinear one, as it involves cross-products between 
                           
                              Δ
                              w
                           
                         and the lower-level decision variables 
                           λ
                         and 
                           μ
                         in the objective function (5a).

We conclude this section with the following two observations, which will turn out to be useful in Section 4.

                           
                              1.
                              The problem resulting from the merging of the mid and the right-hand-side maximization problems (5a)–(5d) is bilinear and defined over a polyhedral set. As a consequence, its optimal solution is one of the vertices of this set.

Since the vector 
                                    x
                                  of day-ahead decision variables only appears in the objective function and not in the constraints, the polyhedral feasible region is independent of the day-ahead decision, and hence it has a finite number of vertices.

We consider again formulation (5). We notice that it is possible to swap the order of the mid and right-hand-side maximization problems, thus first optimizing over the variables 
                           λ, μ
                        , and then over 
                           
                              Δ
                              w
                           
                        . Furthermore, not all the terms of the objective function depend on 
                           
                              Δ
                              w
                              ,
                           
                         and the constraints are separable for the two sets of variables. As a result, we can reformulate (5) as follows:

                           
                              (6a)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                min
                                                x
                                             
                                             
                                             
                                             
                                                
                                                   
                                                      c
                                                      x
                                                   
                                                
                                                T
                                             
                                             x
                                             +
                                             
                                                max
                                                
                                                   
                                                      λ
                                                   
                                                   ,
                                                   
                                                      μ
                                                   
                                                
                                             
                                             
                                             −
                                             
                                                
                                                   (
                                                   Qx
                                                   )
                                                
                                                T
                                             
                                             
                                                λ
                                             
                                             +
                                             
                                                
                                                   (
                                                   l
                                                   −
                                                   M
                                                   x
                                                   )
                                                
                                                T
                                             
                                             
                                                μ
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             +
                                             
                                             
                                                max
                                                
                                                   Δ
                                                   w
                                                
                                             
                                             −
                                             
                                                (
                                                
                                                   
                                                      λ
                                                   
                                                   T
                                                
                                                +
                                                
                                                   
                                                      μ
                                                   
                                                   T
                                                
                                                N
                                                )
                                             
                                             
                                                Δ
                                                w
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (6b)
                              
                                 
                                    
                                       
                                          
                                             
                                             s.t.
                                             
                                             
                                             
                                                H
                                                Δ
                                                w
                                                ≤
                                                h
                                             
                                             ,
                                             
                                             :
                                             
                                                ξ
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (6c)
                              
                                 
                                    
                                       
                                       
                                          
                                             s.t.
                                             
                                             
                                             
                                                
                                                   P
                                                
                                                T
                                             
                                             
                                                λ
                                             
                                             +
                                             
                                                
                                                   L
                                                
                                                T
                                             
                                             
                                                μ
                                             
                                             =
                                             
                                                c
                                                y
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (6d)
                              
                                 
                                    
                                       
                                          
                                             
                                             
                                                μ
                                             
                                             ≥
                                             0
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (6e)
                              
                                 
                                    
                                       
                                          
                                             
                                             s.t.
                                             
                                             
                                             F
                                             x
                                             =
                                             d
                                             −
                                             
                                                w
                                                ^
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (6f)
                              
                                 
                                    
                                       
                                          
                                             
                                             G
                                             x
                                             ≥
                                             g
                                             ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where we indicate with 
                           ξ
                         the set of dual variables relative to constraints (6b) for the right-hand-side maximization problem.

The max-max problem comprising the mid and the right-hand-side optimization problems in (6) can be cast as a Mathematical Program with Equilibrium Constraints (MPEC), see Gabriel, Conejo, Fuller, Hobbs, and Ruiz (2012). However, before doing so, we point out that since the right-hand-side maximization problem is linear, the strong duality theorem holds. Therefore, the following relationship holds at optimality:

                           
                              (7)
                              
                                 
                                    
                                       
                                          
                                             −
                                             
                                                (
                                                
                                                   
                                                      λ
                                                   
                                                   T
                                                
                                                +
                                                
                                                   
                                                      μ
                                                   
                                                   T
                                                
                                                N
                                                )
                                             
                                             
                                                Δ
                                                w
                                             
                                             =
                                             
                                                
                                                   h
                                                
                                                T
                                             
                                             
                                                ξ
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        Differently from the term on the left-hand side of (7), the one on the right-hand side is linear, as it does not involve cross-products between optimization variables. Therefore, considering (6) and (7) renders the problem below whose objective function is linear in the optimization variables:

                           
                              (8a)
                              
                                 
                                    
                                       
                                          
                                             
                                                min
                                                x
                                             
                                             
                                             
                                             
                                                
                                                   
                                                      c
                                                      x
                                                   
                                                
                                                T
                                             
                                             x
                                             +
                                          
                                       
                                       
                                          
                                             
                                                max
                                                
                                                   
                                                      λ
                                                   
                                                   ,
                                                   
                                                      μ
                                                   
                                                   ,
                                                   
                                                      Δ
                                                      w
                                                   
                                                   ,
                                                   
                                                      ξ
                                                   
                                                
                                             
                                             
                                             
                                                
                                                   −
                                                   (
                                                   Q
                                                   x
                                                   )
                                                
                                                T
                                             
                                             
                                                λ
                                             
                                             +
                                             
                                                
                                                   (
                                                   l
                                                   −
                                                   M
                                                   x
                                                   )
                                                
                                                T
                                             
                                             
                                                μ
                                             
                                             +
                                             
                                                
                                                   h
                                                
                                                T
                                             
                                             
                                                ξ
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (8b)
                              
                                 
                                    
                                       
                                          
                                             
                                             s.t.
                                             
                                             
                                             0
                                             ≤
                                             
                                                ξ
                                             
                                             ⊥
                                             
                                                h
                                                −
                                                H
                                                Δ
                                                w
                                                ≥
                                                0
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (8c)
                              
                                 
                                    
                                       
                                          
                                             
                                             
                                             
                                                
                                                   H
                                                
                                                T
                                             
                                             
                                                ξ
                                             
                                             =
                                             −
                                             
                                                λ
                                             
                                             −
                                             
                                                
                                                   N
                                                
                                                T
                                             
                                             
                                                μ
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (8d)
                              
                                 
                                    
                                       
                                          
                                             
                                             
                                             
                                                
                                                   P
                                                
                                                T
                                             
                                             
                                                λ
                                             
                                             +
                                             
                                                
                                                   L
                                                
                                                T
                                             
                                             
                                                μ
                                             
                                             =
                                             
                                                c
                                                y
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (8e)
                              
                                 
                                    
                                       
                                          
                                             
                                             
                                             
                                                μ
                                             
                                             ≥
                                             0
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (8f)
                              
                                 
                                    
                                       
                                          
                                             s.t.
                                             
                                             
                                             F
                                             x
                                             =
                                             d
                                             −
                                             
                                                w
                                                ^
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (8g)
                              
                                 
                                    
                                       
                                          
                                             
                                             G
                                             x
                                             ≥
                                             g
                                             .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Finally, notice that formulations (3)–(4), (5) and (8) are equivalent.

Reformulation (8) as a min-max problem with equilibrium constraints allows us to solve the energy and reserve dispatch problem (3)–(4) under any definition of the uncertainty set for stochastic power production as a polyhedron, defined by a set of linear inequalities HΔw ≤ h. Without loss of generality, uncertainty sets of the following type will be considered in the following:

                           
                              (9a)
                              
                                 
                                    
                                       
                                       
                                          
                                             Δ
                                             
                                                w
                                                q
                                             
                                             =
                                             Δ
                                             
                                                w
                                                q
                                                +
                                             
                                             −
                                             Δ
                                             
                                                w
                                                q
                                                −
                                             
                                             ,
                                             
                                             ∀
                                             q
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (9b)
                              
                                 
                                    
                                       
                                       
                                          
                                             0
                                             ≤
                                             Δ
                                             
                                                w
                                                q
                                                +
                                             
                                             ≤
                                             Δ
                                             
                                                w
                                                q
                                                
                                                   max
                                                
                                             
                                             ,
                                             
                                             ∀
                                             q
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (9c)
                              
                                 
                                    
                                       
                                       
                                          
                                             0
                                             ≤
                                             Δ
                                             
                                                w
                                                q
                                                −
                                             
                                             ≤
                                             Δ
                                             
                                                w
                                                q
                                                
                                                   max
                                                
                                             
                                             ,
                                             
                                             ∀
                                             q
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (9d)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                ∑
                                                q
                                             
                                             
                                                
                                                   Δ
                                                   
                                                      w
                                                      q
                                                      +
                                                   
                                                   +
                                                   Δ
                                                   
                                                      w
                                                      q
                                                      −
                                                   
                                                
                                                
                                                   Δ
                                                   
                                                      w
                                                      q
                                                      
                                                         max
                                                      
                                                   
                                                
                                             
                                             ≤
                                             Γ
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (9e)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   Δ
                                                   
                                                      w
                                                      q
                                                   
                                                
                                                
                                                   Δ
                                                   
                                                      w
                                                      q
                                                      
                                                         max
                                                      
                                                   
                                                
                                             
                                             −
                                             
                                                
                                                   Δ
                                                   
                                                      w
                                                      u
                                                   
                                                
                                                
                                                   Δ
                                                   
                                                      w
                                                      u
                                                      
                                                         max
                                                      
                                                   
                                                
                                             
                                             ≤
                                             
                                                ρ
                                                
                                                   q
                                                   u
                                                
                                             
                                             ,
                                             
                                             ∀
                                             q
                                             ,
                                             u
                                             ∈
                                             
                                                W
                                                q
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The set defined by (9) is a refined version of the budget uncertainty set, which is a well known concept in robust optimization (Bertsimas et al., 2011). The deviation of stochastic power production is split into its positive and negative parts by (9a). Inequalities (9b)–(9c) enforce upper and lower bounds, assumed symmetric here without loss of generality, for this deviation. Constraint (9d) defines the so-called budget of uncertainty, Γ. This constraint ensures that the sum of the absolute values of deviations of stochastic power production, after normalization to their maximum value, across all locations q does not exceed the budget, Γ. This assumption makes particular sense in this application, as unforeseen deviations of stochastic power production from a day-ahead forecast are largely due to weather phenomena that occur on a local scale, and therefore have a limited effect on the overall production in a large power system.

Constraints (9e) are a way to enforce spatial correlation between stochastic production facilities at nodes q and u, for each u within the set Wq
                         of neighboring sites to q. Such constraints limit the normalized deviation of actual production from these sites to ρqu
                        . Intuitively, owing to the local scale of the weather phenomena driving the deviation of the actual stochastic power production from the considered day-ahead point forecast, one may expect that such deviations be in the same direction and of similar size for neighboring sites. Note that a similar approach to defining uncertainty sets that account for spatial correlation of stochastic production sources is proposed in Guan and Wang (2014).

We remark that the standard bilinear formulation (5) of the inner problem would not allow for an exact solution under definition (9) of the uncertainty set. Indeed, the exact solution schemes in Jiang et al. (2012) and Zhao and Zeng (2012) are based on a binary expansion of the deviations that relies on the uncertainty set being of the budget type, i.e., they do not allow for imposing more general constraints such as (9e). Within our formulation, convergence to an exact solution is guaranteed.

In this section, we report the extended formulation of the inner maximization problem with equilibrium constraints (8) corresponding to the max–min problem (4), with the definition of the uncertainty set (9) and of the recourse problem as (2). Let us define the following set of optimization variables :

                           
                              (10)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             Θ
                                             =
                                             {
                                             
                                                λ
                                             
                                             ,
                                             ν
                                             ,
                                             
                                                
                                                   μ
                                                
                                                +
                                             
                                             ,
                                             
                                                
                                                   μ
                                                
                                                −
                                             
                                             ,
                                             
                                                
                                                   ϵ
                                                
                                                
                                                   sh
                                                
                                             
                                             ,
                                             
                                                
                                                   ϵ
                                                
                                                
                                                   sp
                                                
                                             
                                             ,
                                             
                                                σ
                                             
                                             ,
                                             Δ
                                             w
                                             ,
                                             Δ
                                             
                                                w
                                                +
                                             
                                             ,
                                             Δ
                                             
                                                w
                                                −
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             ×
                                             
                                             
                                                γ
                                             
                                             ,
                                             
                                                
                                                   ξ
                                                
                                                +
                                             
                                             ,
                                             
                                                
                                                   ξ
                                                
                                                −
                                             
                                             
                                                ,
                                                η
                                                ,
                                                
                                                   ω
                                                
                                                ,
                                                
                                                   i
                                                
                                                }
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 λ
                              
                              ,
                              ν
                              ,
                              
                                 
                                    μ
                                 
                                 +
                              
                              ,
                              
                                 
                                    μ
                                 
                                 −
                              
                              ,
                              
                                 
                                    ϵ
                                 
                                 
                                    sh
                                 
                              
                              ,
                              
                                 
                                    ϵ
                                 
                                 
                                    sp
                                 
                              
                              ,
                              
                                 σ
                              
                           
                         represent the dual variables of (2b), (2c), (2d), (2e), (2f), (2g) and (2h), respectively, while 
                           
                              
                                 γ
                              
                              ,
                              
                                 
                                    ξ
                                 
                                 +
                              
                              ,
                              
                                 
                                    ξ
                                 
                                 −
                              
                              ,
                              η
                              ,
                              
                                 ω
                              
                           
                         the dual variables of (9a), of the upper bounds in (9b) and (9c), as well as of (9d) and (9e), respectively. The vector i is a collection of binary variables needed to linearize the complementarity conditions according to the reformulation proposed in Fortuny-Amat and McCarl (1981). After performing the appropriate transformations, the following MILP model is obtained:

                           
                              (11a)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                max
                                                Θ
                                             
                                             
                                             
                                                ∑
                                                i
                                             
                                             −
                                             
                                                λ
                                                i
                                             
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   
                                                      N
                                                      i
                                                   
                                                
                                             
                                             
                                                B
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                                (
                                                
                                                   δ
                                                   i
                                                   0
                                                
                                                −
                                                
                                                   δ
                                                   j
                                                   0
                                                
                                                )
                                             
                                             +
                                             
                                                ∑
                                                k
                                             
                                             
                                                (
                                                
                                                   μ
                                                   k
                                                   +
                                                
                                                
                                                   r
                                                   k
                                                   +
                                                
                                                +
                                                
                                                   μ
                                                   k
                                                   −
                                                
                                                
                                                   r
                                                   k
                                                   −
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (11b)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                +
                                                
                                                   ∑
                                                   s
                                                
                                                
                                                   d
                                                   s
                                                
                                                
                                                   ϵ
                                                   s
                                                   
                                                      sh
                                                   
                                                
                                                +
                                                
                                                   ∑
                                                   q
                                                
                                                
                                                   
                                                      w
                                                      ^
                                                   
                                                   q
                                                
                                                
                                                   ϵ
                                                   q
                                                   
                                                      sp
                                                   
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      i
                                                      ,
                                                      j
                                                      ∈
                                                      
                                                         N
                                                         i
                                                      
                                                   
                                                
                                                
                                                   T
                                                   
                                                      i
                                                      j
                                                   
                                                   
                                                      max
                                                   
                                                
                                                
                                                   σ
                                                   
                                                      i
                                                      j
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (11c)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                +
                                                
                                                   ∑
                                                   q
                                                
                                                Δ
                                                
                                                   w
                                                   q
                                                   
                                                      
                                                         m
                                                      
                                                      a
                                                      x
                                                   
                                                
                                                
                                                   (
                                                   
                                                      ξ
                                                      q
                                                      +
                                                   
                                                   +
                                                   
                                                      ξ
                                                      q
                                                      −
                                                   
                                                   )
                                                
                                                +
                                                Γ
                                                η
                                                +
                                                
                                                   ∑
                                                   
                                                      q
                                                      ,
                                                      u
                                                      ∈
                                                      
                                                         W
                                                         q
                                                      
                                                   
                                                
                                                
                                                   ρ
                                                   
                                                      q
                                                      u
                                                   
                                                
                                                
                                                   ω
                                                   
                                                      q
                                                      u
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (11d)
                              
                                 
                                    
                                       
                                          
                                             s.t.
                                             
                                          
                                       
                                       
                                          
                                             Δ
                                             
                                                w
                                                q
                                             
                                             =
                                             Δ
                                             
                                                w
                                                q
                                                +
                                             
                                             −
                                             Δ
                                             
                                                w
                                                q
                                                −
                                             
                                             ,
                                             
                                             ∀
                                             q
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (11e)
                              
                                 
                                    
                                       
                                       
                                          
                                             0
                                             ≤
                                             
                                                ξ
                                                q
                                                +
                                             
                                             ≤
                                             
                                                M
                                                q
                                                
                                                   1
                                                   d
                                                
                                             
                                             
                                                i
                                                q
                                                1
                                             
                                             ,
                                             
                                             0
                                             ≤
                                             Δ
                                             
                                                w
                                                q
                                                
                                                   max
                                                
                                             
                                             −
                                             Δ
                                             
                                                w
                                                q
                                                +
                                             
                                             ≤
                                             
                                                M
                                                q
                                                
                                                   1
                                                   p
                                                
                                             
                                             
                                                (
                                                1
                                                −
                                                
                                                   i
                                                   q
                                                   1
                                                
                                                )
                                             
                                             ,
                                             
                                             ∀
                                             q
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (11f)
                              
                                 
                                    
                                       
                                       
                                          
                                             0
                                             ≤
                                             
                                                ξ
                                                q
                                                −
                                             
                                             ≤
                                             
                                                M
                                                q
                                                
                                                   2
                                                   d
                                                
                                             
                                             
                                                i
                                                q
                                                2
                                             
                                             ,
                                             
                                             0
                                             ≤
                                             Δ
                                             
                                                w
                                                q
                                                
                                                   max
                                                
                                             
                                             −
                                             Δ
                                             
                                                w
                                                q
                                                −
                                             
                                             ≤
                                             
                                                M
                                                q
                                                
                                                   2
                                                   p
                                                
                                             
                                             
                                                (
                                                1
                                                −
                                                
                                                   i
                                                   q
                                                   2
                                                
                                                )
                                             
                                             ,
                                             
                                             ∀
                                             q
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (11g)
                              
                                 
                                    
                                       
                                       
                                          
                                             0
                                             ≤
                                             η
                                             ≤
                                             
                                                M
                                                
                                                   3
                                                   d
                                                
                                             
                                             
                                                i
                                                3
                                             
                                             ,
                                             
                                             0
                                             ≤
                                             Γ
                                             −
                                             
                                                ∑
                                                q
                                             
                                             
                                                
                                                   Δ
                                                   
                                                      w
                                                      q
                                                      +
                                                   
                                                   +
                                                   Δ
                                                   
                                                      w
                                                      q
                                                      −
                                                   
                                                
                                                
                                                   Δ
                                                   
                                                      w
                                                      q
                                                      
                                                         max
                                                      
                                                   
                                                
                                             
                                             ≤
                                             
                                                M
                                                
                                                   3
                                                   p
                                                
                                             
                                             
                                                (
                                                1
                                                −
                                                
                                                   i
                                                   3
                                                
                                                )
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (11h)
                              
                                 
                                    
                                       
                                          0
                                       
                                       
                                          ≤
                                       
                                       
                                          
                                             
                                                ω
                                                
                                                   q
                                                   u
                                                
                                             
                                             ≤
                                             
                                                M
                                                
                                                   q
                                                   u
                                                
                                                
                                                   4
                                                   d
                                                
                                             
                                             
                                                i
                                                
                                                   q
                                                   u
                                                
                                                4
                                             
                                             ,
                                             
                                             0
                                             ≤
                                             
                                                ρ
                                                
                                                   q
                                                   u
                                                
                                             
                                             −
                                             
                                                
                                                   Δ
                                                   
                                                      w
                                                      q
                                                   
                                                
                                                
                                                   Δ
                                                   
                                                      w
                                                      q
                                                      
                                                         max
                                                      
                                                   
                                                
                                             
                                             +
                                             
                                                
                                                   Δ
                                                   
                                                      w
                                                      u
                                                   
                                                
                                                
                                                   Δ
                                                   
                                                      w
                                                      u
                                                      
                                                         max
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          ≤
                                       
                                       
                                          
                                             
                                                M
                                                
                                                   q
                                                   u
                                                
                                                
                                                   4
                                                   p
                                                
                                             
                                             
                                                (
                                                1
                                                −
                                                
                                                   i
                                                   
                                                      q
                                                      u
                                                   
                                                   4
                                                
                                                )
                                             
                                             ,
                                             
                                             ∀
                                             q
                                             ,
                                             u
                                             ∈
                                             
                                                W
                                                q
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (11i)
                              
                                 
                                    
                                       
                                          
                                             
                                                γ
                                                q
                                             
                                             +
                                             
                                                ∑
                                                
                                                   u
                                                   ∈
                                                   
                                                      W
                                                      q
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ω
                                                      
                                                         q
                                                         u
                                                      
                                                   
                                                   −
                                                   
                                                      ω
                                                      
                                                         u
                                                         q
                                                      
                                                   
                                                
                                                
                                                   Δ
                                                   
                                                      w
                                                      q
                                                      
                                                         max
                                                      
                                                   
                                                
                                             
                                             +
                                             
                                                λ
                                                
                                                   q
                                                   (
                                                   i
                                                   )
                                                
                                             
                                             −
                                             
                                                ϵ
                                                q
                                                
                                                   sp
                                                
                                             
                                             =
                                             0
                                             
                                             ∀
                                             q
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (11j)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             0
                                             ≤
                                             Δ
                                             
                                                w
                                                q
                                                +
                                             
                                             ≤
                                             
                                                M
                                                
                                                   q
                                                
                                                
                                                   5
                                                   p
                                                
                                             
                                             
                                                i
                                                q
                                                5
                                             
                                             ,
                                             0
                                             ≤
                                             
                                                ξ
                                                q
                                                +
                                             
                                             −
                                             
                                                γ
                                                q
                                             
                                             +
                                             
                                                η
                                                
                                                   Δ
                                                   
                                                      w
                                                      q
                                                      
                                                         max
                                                      
                                                   
                                                
                                             
                                             ≤
                                             
                                                M
                                                
                                                   q
                                                
                                                
                                                   5
                                                   d
                                                
                                             
                                             
                                                (
                                                1
                                                −
                                                
                                                   i
                                                   q
                                                   5
                                                
                                                )
                                             
                                             ,
                                             
                                             ∀
                                             q
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (11k)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             0
                                             ≤
                                             Δ
                                             
                                                w
                                                q
                                                −
                                             
                                             ≤
                                             
                                                M
                                                
                                                   q
                                                
                                                
                                                   6
                                                   p
                                                
                                             
                                             
                                                i
                                                q
                                                6
                                             
                                             ,
                                             0
                                             ≤
                                             
                                                γ
                                                q
                                             
                                             +
                                             
                                                ξ
                                                q
                                                −
                                             
                                             +
                                             
                                                η
                                                
                                                   Δ
                                                   
                                                      w
                                                      q
                                                      
                                                         max
                                                      
                                                   
                                                
                                             
                                             ≤
                                             
                                                M
                                                q
                                                
                                                   6
                                                   d
                                                
                                             
                                             
                                                (
                                                1
                                                −
                                                
                                                   i
                                                   q
                                                   6
                                                
                                                )
                                             
                                             ,
                                             
                                             ∀
                                             q
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (11l)
                              
                                 
                                    
                                       
                                          
                                             
                                                λ
                                                
                                                   i
                                                   (
                                                   k
                                                   )
                                                
                                             
                                             +
                                             
                                                μ
                                                k
                                                +
                                             
                                             ≤
                                             
                                                C
                                                k
                                             
                                             ,
                                             
                                             ∀
                                             k
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (11m)
                              
                                 
                                    
                                       
                                          
                                             −
                                             
                                                λ
                                                
                                                   i
                                                   (
                                                   k
                                                   )
                                                
                                             
                                             +
                                             
                                                μ
                                                k
                                                −
                                             
                                             ≤
                                             −
                                             
                                                C
                                                k
                                             
                                             ,
                                             
                                             ∀
                                             k
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (11n)
                              
                                 
                                    
                                       
                                          
                                             
                                                λ
                                                
                                                   i
                                                   (
                                                   s
                                                   )
                                                
                                             
                                             +
                                             
                                                ϵ
                                                s
                                                
                                                   sh
                                                
                                             
                                             ≤
                                             
                                                V
                                                
                                                   sh
                                                
                                             
                                             ,
                                             
                                             ∀
                                             s
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (11o)
                              
                                 
                                    
                                       
                                          
                                             −
                                             
                                                λ
                                                
                                                   i
                                                   (
                                                   q
                                                   )
                                                
                                             
                                             +
                                             
                                                ϵ
                                                q
                                                
                                                   sp
                                                
                                             
                                             ≤
                                             0
                                             ,
                                             
                                             ∀
                                             q
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (11p)
                              
                                 
                                    
                                       
                                          
                                             ν
                                             −
                                             
                                                (
                                                
                                                   ∑
                                                   
                                                      j
                                                      ∈
                                                      
                                                         N
                                                         1
                                                      
                                                   
                                                
                                                
                                                   B
                                                   
                                                      1
                                                      j
                                                   
                                                
                                                )
                                             
                                             
                                                λ
                                                1
                                             
                                             +
                                             
                                                (
                                                
                                                   ∑
                                                   
                                                      j
                                                      ∈
                                                      
                                                         N
                                                         1
                                                      
                                                   
                                                
                                                
                                                   B
                                                   
                                                      1
                                                      j
                                                   
                                                
                                                
                                                   λ
                                                   j
                                                
                                                )
                                             
                                             +
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   
                                                      N
                                                      1
                                                   
                                                
                                             
                                             
                                                B
                                                
                                                   1
                                                   j
                                                
                                             
                                             
                                                (
                                                
                                                   σ
                                                   
                                                      1
                                                      j
                                                   
                                                
                                                −
                                                
                                                   σ
                                                   
                                                      j
                                                      1
                                                   
                                                
                                                )
                                             
                                             =
                                             0
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (11q)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             −
                                             
                                                (
                                                
                                                   ∑
                                                   
                                                      j
                                                      ∈
                                                      
                                                         N
                                                         i
                                                      
                                                   
                                                
                                                
                                                   B
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                )
                                             
                                             
                                                λ
                                                i
                                             
                                             +
                                             
                                                (
                                                
                                                   ∑
                                                   
                                                      j
                                                      ∈
                                                      
                                                         N
                                                         i
                                                      
                                                   
                                                
                                                
                                                   B
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                
                                                   λ
                                                   j
                                                
                                                )
                                             
                                             +
                                             
                                                ∑
                                                
                                                   j
                                                   ∈
                                                   
                                                      N
                                                      i
                                                   
                                                
                                             
                                             
                                                B
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                                (
                                                
                                                   σ
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                −
                                                
                                                   σ
                                                   
                                                      j
                                                      i
                                                   
                                                
                                                )
                                             
                                             =
                                             0
                                             ,
                                             
                                             ∀
                                             i
                                             ≠
                                             1
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (11r)
                              
                                 
                                    
                                       
                                          
                                             
                                                μ
                                                k
                                                +
                                             
                                             ,
                                             
                                                μ
                                                k
                                                −
                                             
                                             ≤
                                             0
                                             ,
                                             ∀
                                             k
                                             ,
                                             
                                                ϵ
                                                s
                                                
                                                   sh
                                                
                                             
                                             ≤
                                             0
                                             ,
                                             ∀
                                             s
                                             ,
                                             
                                                ϵ
                                                q
                                                
                                                   sp
                                                
                                             
                                             ≤
                                             0
                                             ,
                                             ∀
                                             q
                                             ,
                                             
                                                σ
                                                
                                                   i
                                                   j
                                                
                                             
                                             ≤
                                             0
                                             ,
                                             ∀
                                             i
                                             ,
                                             j
                                             ∈
                                             
                                                N
                                                i
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (11s)
                              
                                 
                                    
                                       
                                          
                                             
                                                i
                                                q
                                                1
                                             
                                             ,
                                             
                                                i
                                                q
                                                2
                                             
                                             ,
                                             
                                                i
                                                q
                                                5
                                             
                                             ,
                                             
                                                i
                                                q
                                                6
                                             
                                             ∈
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                             ,
                                             ∀
                                             q
                                             ,
                                             
                                                i
                                                3
                                             
                                             ∈
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                             ,
                                             
                                                i
                                                
                                                   q
                                                   u
                                                
                                                4
                                             
                                             ,
                                             ∀
                                             q
                                             ,
                                             u
                                             ∈
                                             
                                                W
                                                q
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Note that (11e)–(11h), (11j) and (11k) represent the complementarity conditions (8b) as a set of linear constraints involving both continuous and binary variables. The parameters in these constraints denoted by M with relevant indices and superscripts are “big-M” constants. Their value should be set large enough so that the optimal solution of the innermost maximization problem in (6) is not cut out of the feasible region of (11e)–(11h), (11j)–(11k). However, the choice on their value should be made with care, since too high values for the “big-M” constants would worsen the computational performance of the MILP solver (Gabriel et al., 2012).

In this section, we present two iterative schemes to solve the min–max–min problem (3)–(4), both of which are based on the cutting-plane algorithm in Kelley (1960) within a Benders’ decomposition scheme (Conejo, Castillo, Mínguez, & García-Bertrand, 2006).

We consider reformulation (5). Due to the observations in the last paragraph of Section 3.1, the solution to the inner level bilinear maximization problem belongs to a set of finite cardinality K, which does not depend on the first-stage decisions. Indicating the elements of this set as (
                           Δw
                        
                           k
                        , 
                           λ
                        
                        
                           k
                        , 
                           μ
                        
                        
                           k
                        ), with 
                           
                              k
                              =
                              1
                              ,
                              ⋯
                              ,
                              K
                              ,
                           
                         we can reformulate problem (3) and (4) as follows:

                           
                              (12a)
                              
                                 
                                    
                                       
                                          
                                             
                                                min
                                                
                                                   x
                                                   ,
                                                   β
                                                
                                             
                                             
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      c
                                                      x
                                                   
                                                
                                                T
                                             
                                             x
                                             +
                                             β
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (12b)
                              
                                 
                                    
                                       
                                          
                                             s.t.
                                             
                                             
                                          
                                       
                                       
                                          
                                             β
                                             ≥
                                             −
                                             
                                                
                                                   Δ
                                                   w
                                                
                                                k
                                                T
                                             
                                             
                                                
                                                   λ
                                                
                                                k
                                             
                                             +
                                             
                                                
                                                   (
                                                   
                                                      
                                                         l
                                                         −
                                                         N
                                                         Δ
                                                         w
                                                      
                                                      k
                                                   
                                                   )
                                                
                                                T
                                             
                                             
                                                
                                                   μ
                                                
                                                k
                                             
                                             −
                                             
                                                (
                                                
                                                   
                                                      λ
                                                   
                                                   k
                                                
                                                Q
                                                +
                                                
                                                   
                                                      μ
                                                   
                                                   k
                                                
                                                M
                                                )
                                             
                                             x
                                             ,
                                             
                                             ∀
                                             k
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (12c)
                              
                                 
                                    
                                       
                                          
                                             
                                             
                                                F
                                                x
                                                =
                                                d
                                                −
                                                
                                                   w
                                                   ^
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (12d)
                              
                                 
                                    
                                       
                                          
                                             
                                             
                                                G
                                                x
                                                ≥
                                                g
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

As one can see, the term β in the objective function is bounded from below by the pointwise maximum of a finite set of linear functions in the first-stage decision variables 
                           x
                        . This implies that the optimal objective function value of (12) is a convex, piecewise linear function in 
                           x
                        . The following cutting-plane algorithm, proposed for robust optimization problems with recourse by Thiele et al. (2010), is guaranteed to converge to the optimal solution in a finite number of steps.

                           
                              1.
                              Set upper and lower bounds 
                                    
                                       
                                          UB
                                       
                                       =
                                       +
                                       ∞
                                    
                                  and 
                                    
                                       
                                          LB
                                       
                                       =
                                       −
                                       ∞
                                       ,
                                    
                                  and initialize the iteration index i ← 1.

Define the relaxed master problem (MP) as the minimization of (12a), subject to (12c) and (12d), and fix a reasonable lower bound for β, i.e., lower than the expected objective value of the inner problem. Fix a feasible solution 
                                    
                                       (
                                       
                                          
                                             x
                                          
                                          1
                                          *
                                       
                                       ,
                                       
                                          β
                                          1
                                          *
                                       
                                       )
                                    
                                  to the relaxed MP.

Solve either the following subproblem

                                    
                                       (13a)
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         SP
                                                         1
                                                      
                                                      :
                                                      
                                                         max
                                                         
                                                            
                                                               Δ
                                                               w
                                                            
                                                            ,
                                                            
                                                               λ
                                                               ,
                                                               μ
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  −
                                                                  Δ
                                                                  w
                                                                  −
                                                                  Q
                                                                  x
                                                               
                                                               i
                                                               *
                                                            
                                                            )
                                                         
                                                         T
                                                      
                                                      
                                                         λ
                                                      
                                                      +
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  l
                                                                  −
                                                                  M
                                                                  x
                                                               
                                                               i
                                                               *
                                                            
                                                            −
                                                            
                                                               N
                                                               Δ
                                                               w
                                                            
                                                            )
                                                         
                                                         T
                                                      
                                                      
                                                         μ
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       (13b)
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                      s.t.
                                                      
                                                      
                                                         
                                                            P
                                                         
                                                         T
                                                      
                                                      
                                                         λ
                                                      
                                                      +
                                                      
                                                         
                                                            L
                                                         
                                                         T
                                                      
                                                      
                                                         μ
                                                      
                                                      =
                                                      
                                                         c
                                                         y
                                                      
                                                      ,
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       (13c)
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                      
                                                         μ
                                                      
                                                      ≥
                                                      0
                                                      ,
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       (13d)
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                      
                                                         H
                                                         Δ
                                                         w
                                                         ≤
                                                         h
                                                      
                                                      ,
                                                   
                                                
                                             
                                          
                                       
                                    
                                 or

                                    
                                       (14a)
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         SP
                                                         2
                                                      
                                                      :
                                                      
                                                         max
                                                         
                                                            
                                                               λ
                                                            
                                                            ,
                                                            
                                                               μ
                                                            
                                                            ,
                                                            
                                                               Δ
                                                               w
                                                            
                                                            ,
                                                            
                                                               ξ
                                                            
                                                         
                                                      
                                                      
                                                      
                                                   
                                                
                                                
                                                   
                                                      −
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  Q
                                                                  x
                                                               
                                                               i
                                                               *
                                                            
                                                            )
                                                         
                                                         T
                                                      
                                                      
                                                         λ
                                                      
                                                      +
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  l
                                                                  −
                                                                  M
                                                                  x
                                                               
                                                               i
                                                               *
                                                            
                                                            )
                                                         
                                                         T
                                                      
                                                      
                                                         μ
                                                      
                                                      +
                                                      
                                                         
                                                            h
                                                         
                                                         T
                                                      
                                                      
                                                         ξ
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       (14b)
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                      s.t.
                                                      
                                                      
                                                      0
                                                      ≤
                                                      
                                                         ξ
                                                      
                                                      ⊥
                                                      
                                                         h
                                                         −
                                                         H
                                                         Δ
                                                         w
                                                         ≥
                                                         0
                                                      
                                                      ,
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       (14c)
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                      
                                                         
                                                            H
                                                         
                                                         T
                                                      
                                                      
                                                         ξ
                                                      
                                                      =
                                                      −
                                                      
                                                         λ
                                                      
                                                      −
                                                      
                                                         
                                                            N
                                                         
                                                         T
                                                      
                                                      
                                                         μ
                                                      
                                                      ,
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       (14d)
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                      
                                                         
                                                            P
                                                         
                                                         T
                                                      
                                                      
                                                         λ
                                                      
                                                      +
                                                      
                                                         
                                                            L
                                                         
                                                         T
                                                      
                                                      
                                                         μ
                                                      
                                                      =
                                                      
                                                         c
                                                         y
                                                      
                                                      ,
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       (14e)
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                      
                                                         μ
                                                      
                                                      ≥
                                                      0
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              

Notice that (13a) and (14a) correspond to the merging of the mid and right-hand-side optimization problems in (5), and to the right-hand-side problem in (8), respectively, where the first-stage variables are fixed. Let us indicate the optimal SP objective function value as 
                                    
                                       
                                          
                                             z
                                             i
                                             
                                                SP
                                             
                                          
                                       
                                       *
                                    
                                 . Update the upper bound 
                                    
                                       UB
                                       =
                                       min
                                       {
                                       UB
                                       ,
                                       
                                          
                                             
                                                c
                                                x
                                             
                                             x
                                          
                                          i
                                          *
                                       
                                       +
                                       
                                          
                                             
                                                z
                                                i
                                                
                                                   SP
                                                
                                             
                                          
                                          *
                                       
                                       }
                                    
                                 . Add to the relaxed MP the Benders cut (12b) corresponding to the SP solution 
                                    
                                       (
                                       
                                          
                                             Δ
                                             w
                                          
                                          i
                                          *
                                       
                                       ,
                                       
                                          
                                             λ
                                          
                                          i
                                          *
                                       
                                       ,
                                       
                                          
                                             μ
                                          
                                          i
                                          *
                                       
                                       )
                                    
                                  determined at this stage.

Solve the relaxed MP, fix 
                                    
                                       
                                          x
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                       *
                                    
                                  at the solution and 
                                    
                                       
                                          
                                             z
                                             
                                                i
                                                +
                                                1
                                             
                                             
                                                MP
                                             
                                          
                                       
                                       *
                                    
                                  at the objective function value. Update 
                                    
                                       
                                          LB
                                       
                                       =
                                       
                                          
                                             
                                                z
                                                
                                                   i
                                                   +
                                                   1
                                                
                                                
                                                   MP
                                                
                                             
                                          
                                          *
                                       
                                    
                                 .

If 
                                    
                                       
                                          UB
                                       
                                       −
                                       
                                          LB
                                       
                                       <
                                       τ
                                       ,
                                    
                                  where τ is a small tolerance value, then stop. Otherwise, update 
                                    
                                       i
                                       ←
                                       i
                                       +
                                       1
                                    
                                  and go back to 3.

The above approach is named Benders-dual cutting plane algorithm in Zeng and Zhao (2013), since the cuts generated in step 3 of the algorithm above are based on the optimal dual solution of the lower-level problem in (4).

It should be remarked that subproblem (13a), i.e., SP1, is bilinear, which makes it particularly hard to solve to optimality for a generic polyhedral uncertainty set. In the literature, this approach has been followed either considering specific types of uncertainty sets, i.e., the budget uncertainty set used by Jiang et al. (2012); Zhao and Zeng (2012), Jiang et al. (2014), or by employing methods converging to a local optimum (Bertsimas et al., 2012; Jiang et al., 2014). In contrast to these references, we propose the use of subproblem (14a), i.e., SP2, within the described cutting-plane algorithm. This allows us to solve the subproblem to optimality without having to make any further assumption on the structure of the uncertainty set (besides the fact that it must be polyhedral).

Finally, observe that there is another way to achieve the same degree of flexibility of formulation (14a) in the definition of the uncertainty set: by formulating problem (4) directly as an MPEC, and casting it as an MILP through the big-M reformulation. However, this would result in a much larger number of binary variables than the approach considered through formulation (14a). Indeed, (4c) includes a large number of inequality constraints (e.g., unit minimum and maximum power outputs and transmission capacity limits), which would generate an equally large number of complementarity conditions to be linearized by using binary variables. Thus, the proposed formulation (14a) reconciles flexibility in the definition of the uncertainty set with tractability of the resulting MILP subproblem, which has a moderate size in terms of binary variables.

Similarly to the previous approach, the primal cut algorithm (Zeng & Zhao, 2013) is based on the fact that the solution to the lower-level optimization problem in (5) is at one of the vertices of the feasibility set. Because the feasibility set for 
                           
                              Δ
                              w
                           
                         is completely decoupled from the feasibility set of the variables (
                           λ, μ
                        ), the worst-case realization of the uncertainty 
                           
                              Δ
                              w
                           
                         is at a vertex of its feasibility set defined by 
                           
                              H
                              Δ
                              w
                              ≤
                              h
                           
                        .

We indicate with 
                           Δw
                        
                           k
                         the vertices of the feasibility set for the uncertain stochastic power production 
                           
                              Δ
                              w
                              ,
                           
                         and assign a copy 
                           
                              y
                              k
                           
                         of the vector of recourse decision variables to each of these vertices. Hence, one can reformulate problem (3) and (4) in the following way:

                           
                              (15a)
                              
                                 
                                    
                                       
                                          
                                             
                                                min
                                                
                                                   
                                                      
                                                         x
                                                         ,
                                                         y
                                                      
                                                      k
                                                   
                                                   ,
                                                   β
                                                
                                             
                                             
                                             
                                             
                                                
                                                   
                                                      c
                                                      x
                                                   
                                                
                                                T
                                             
                                             x
                                             +
                                             β
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (15b)
                              
                                 
                                    
                                       
                                          
                                             s.t.
                                             
                                             
                                             β
                                             ≥
                                             
                                                
                                                   
                                                      c
                                                      y
                                                   
                                                
                                                T
                                             
                                             
                                                y
                                                k
                                             
                                             ,
                                             
                                             ∀
                                             k
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (15c)
                              
                                 
                                    
                                       
                                          
                                             
                                             
                                                
                                                   P
                                                   y
                                                
                                                k
                                             
                                             =
                                             −
                                             
                                                
                                                   Δ
                                                   w
                                                
                                                k
                                             
                                             −
                                             
                                                Q
                                                x
                                             
                                             ,
                                             
                                             ∀
                                             k
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (15d)
                              
                                 
                                    
                                       
                                          
                                             
                                             
                                                
                                                   L
                                                   y
                                                
                                                k
                                             
                                             ≥
                                             
                                                
                                                   l
                                                   −
                                                   M
                                                   x
                                                   −
                                                   N
                                                   Δ
                                                   w
                                                
                                                k
                                             
                                             ,
                                             
                                             ∀
                                             k
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (15e)
                              
                                 
                                    
                                       
                                          
                                             
                                             
                                                F
                                                x
                                                =
                                                d
                                                −
                                                
                                                   w
                                                   ^
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (15f)
                              
                                 
                                    
                                       
                                          
                                             
                                             
                                                G
                                                x
                                                ≥
                                                g
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Notice that cuts (15b) are affine in the primal recourse variables 
                           
                              
                                 y
                                 k
                              
                              ,
                           
                         as opposed to cuts (12b), which depend on the dual variables. Besides, we remark that there is a copy y
                        
                           k
                         of the recourse variables and of constraints (15b), (15c) and (15d) for each vertex 
                           Δw
                        
                           k
                        .

The following comments are in order:

                           
                              1.
                              Differently from (12), model (15) includes energy redispatch, load shedding, stochastic power spillage, and network state variables at the balancing stage as decision variables. Furthermore, there is one such set of decisions for each vertex of the uncertainty set.

The number of vertices, and therefore of Benders cuts, in (15) is smaller than that in (12). This is because in (15) there is one Benders cut per vertex of the uncertainty set, and not per vertex of the joint feasibility set of (
                                    Δw, λ, μ
                                 ), which has higher dimensionality.

The increase in size of the relaxed MP in a Benders scheme is significant every time a vertex is added to the MP. Indeed, this entails adding a set of balancing market variables (recourse for a specific realization of the uncertainty), as well as a Benders cut (15b) and a set of feasibility constraints (15c)–(15d) for the balancing stage.

The primal cut algorithm is akin to the one described in Section 4.1, with the following differences:

                           
                              •
                              The master problem used in step 2 of every iteration of the algorithm is a relaxation of (15), i.e., it has a reduced set of recourse variables 
                                    
                                       y
                                       k
                                    
                                  and of constraints (15b)–(15d). At the first iteration, the master problem consists exclusively of (15a), (15e) and (15f) and a lower bound for β.

At the end of step 3, we add a set 
                                    
                                       y
                                       k
                                    
                                  of recourse variables and a set of constraints (15b)–(15d), where we fix 
                                    
                                       Δ
                                       w
                                    
                                  at the current solution 
                                    
                                       
                                          Δ
                                          w
                                       
                                       i
                                       *
                                    
                                  of the subproblem.

As documented in Zeng and Zhao (2013) and Zhao and Zeng (2012), the primal cut algorithm, which is the one used in this work, generally guarantees a faster convergence to the optimal solution than the Benders-dual cutting plane one.

To our knowledge, the existing literature exclusively considers subproblem (13a) within the cutting-plane algorithms described in Sections 4.1 and 4.2. The solution of this optimization problem is far from being trivial, since the presence of bilinear terms in the objective function (5a) renders the problem non-convex. In Bertsimas et al. (2012), an outer-approximation algorithm is proposed to solve this problem with general uncertainty sets. However, since the subproblem is non-convex, only local convergence is guaranteed for this method. As an alternative, exact linearization methods based on the use of integer variables are proposed in Jiang et al. (2012) and Zhao and Zeng (2012). However, the uncertainty set is restricted to the particular case of polyhedral budget sets.

In this work, we propose the use of subproblem (14a). The only nonlinearity in this problem is the presence of complementarity conditions (14b), where the ⊥ operator implies that 
                           
                              
                                 ξ
                              
                              (
                              h
                              −
                              H
                              Δ
                              w
                              )
                              =
                              0
                           
                        . In (11), we linearized these complementarity conditions by making use of binary variables as proposed by Fortuny-Amat and McCarl (1981). Alternatively, one could employ the approach of Siddiqui and Gabriel (2013), which is based on SOS-1 variables.

In comparison to the models in Jiang et al. (2012), Zhao and Zeng (2012) and Bertsimas et al. (2012), the proposed model has the following characteristics. As compared to the method in Bertsimas et al. (2012), our approach converges to the global optimal solution. However, the model in Bertsimas et al. (2012) considers general convex uncertainty set, while our model is valid for any type of polyhedral set.

In comparison to the approach in Jiang et al. (2012) and Zhao and Zeng (2012), our approach retains the convergence to the global optimum while allowing us to consider any type of polyhedral sets. Indeed, note that the reformulation of the complementarity constraints as linear inequalities involving continuous and binary variables performed in (11) is valid for any polyhedral uncertainty set. The approach in Jiang et al. (2012) and Zhao and Zeng (2012) is based on a discretization of the deviation of stochastic power production, which is redefined as the product of binary variables with the maximum/minimum allowed deviation. Contrary to our approach, such a discretization only holds for budget uncertainty sets defined by (9a)–(9d). Other types of constraints, e.g., the correlation constraints (9e), may imply that the worst-case realization of the stochastic production be “fractional” in the sense that it is neither 0 nor the maximum/minimum value at some locations of the network. Hence, such constraints cannot be considered within that binary expansion scheme.

We conclude with a remark on the number of binary variables of (11), which ultimately drives the computational properties of the model. If correlation constraints (9e) are not considered, (11h) is not needed in (11). This results in 
                           
                              4
                              ×
                              
                                 N
                                 q
                              
                              +
                              1
                           
                         binary variables, where Nq
                         is the number of locations with stochastic production. A linear dependence is also true for the discretization approach in Jiang et al. (2012) and Zhao and Zeng (2012), which results in 2 × Nq
                         binary variables, representing maximum and minimum deviation at each location q, respectively. For general polyhedral uncertainty sets, the number of binary variables in our approach would be linearly dependent on the number of constraints, which in turn is related to the number of stochastic production sites. Typically, such a number is limited for a power system.

@&#RESULTS AND DISCUSSION@&#

In this section, we present results obtained by employing the proposed model on different case-studies. Section 5.1 describes an example based on a simple two-node system to illustrate the functioning of the model. A larger study based on the 24-node IEEE Reliability Test System, the specifications of which can be found in Grigg et al. (1999), is considered in Section 5.2. Finally, computational results obtained using power system models of increasing size are discussed in Section 5.3.

Let us consider the two-node system depicted in Fig. 1
                        . The line between the two nodes of the system has a capacity of 60 MW and a reactance of 0.13 pu (physical parameter that characterizes the functioning of the line). The load at each node is known with certainty and equal to 110 MWh and 30 MWh at nodes 1 and 2, respectively, during the market period considered. Furthermore, we consider two wind farms, one at each node of the network. The day-ahead production forecast is equal to 20 MWh and 25 MWh for wind farms 1 and 2, respectively. Notice that we assume that the length of a market period is 1 hour. Hence, a forecast production equal to 20 MWh corresponds to an average output of 20 MW during the considered period. However, for the sake of clarity we will hereinafter employ the unit MWh for energy production and dispatch, and MW for reserve and capacity.

The characteristics of the units in the system are listed in Table 1
                        . The marginal cost for production from unit 1, C
                        1, is high, but the unit is highly flexible, which is reflected in its low costs for reserve, 
                           
                              C
                              1
                              
                                 +
                                 /
                                 −
                              
                           
                        . On the contrary, unit 3 has a low marginal cost of production but is inflexible. Unit 2 has balanced characteristics.

The day-ahead dispatch problem (1) for this example writes as follows:

                           
                              (16a)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                min
                                                
                                                   p
                                                   ,
                                                   
                                                      r
                                                      +
                                                   
                                                   ,
                                                   
                                                      r
                                                      −
                                                   
                                                   ,
                                                   
                                                      
                                                         δ
                                                      
                                                      0
                                                   
                                                
                                             
                                             
                                             
                                             32
                                             
                                                p
                                                1
                                             
                                             +
                                             20
                                             
                                                p
                                                2
                                             
                                             +
                                             12
                                             
                                                p
                                                3
                                             
                                             +
                                             7
                                             
                                                r
                                                1
                                                +
                                             
                                             +
                                             11
                                             
                                                r
                                                2
                                                +
                                             
                                             +
                                             15
                                             
                                                r
                                                3
                                                +
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             +
                                             
                                             5
                                             
                                                r
                                                1
                                                −
                                             
                                             +
                                             6
                                             
                                                r
                                                2
                                                −
                                             
                                             +
                                             14
                                             
                                                r
                                                3
                                                −
                                             
                                             +
                                             
                                                Q
                                                W
                                             
                                             
                                                (
                                                p
                                                ,
                                                
                                                   r
                                                   +
                                                
                                                ,
                                                
                                                   r
                                                   −
                                                
                                                ,
                                                
                                                   
                                                      δ
                                                   
                                                   0
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (16b)
                              
                                 
                                    
                                       
                                          
                                             s.t.
                                             
                                          
                                       
                                       
                                          
                                             
                                                p
                                                1
                                             
                                             +
                                             
                                                p
                                                2
                                             
                                             +
                                             20
                                             =
                                             110
                                             −
                                             
                                                
                                                   δ
                                                   2
                                                   0
                                                
                                                
                                                   0.13
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (16c)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                p
                                                3
                                             
                                             +
                                             25
                                             =
                                             30
                                             +
                                             
                                                
                                                   δ
                                                   2
                                                   0
                                                
                                                
                                                   0.13
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (16d)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                p
                                                1
                                             
                                             +
                                             
                                                r
                                                1
                                                +
                                             
                                             ≤
                                             120
                                             ,
                                             
                                             
                                                p
                                                2
                                             
                                             +
                                             
                                                r
                                                2
                                                +
                                             
                                             ≤
                                             80
                                             ,
                                             
                                             
                                                p
                                                3
                                             
                                             +
                                             
                                                r
                                                3
                                                +
                                             
                                             ≤
                                             70
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (16e)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                p
                                                1
                                             
                                             −
                                             
                                                r
                                                1
                                                −
                                             
                                             ≥
                                             0
                                             ,
                                             
                                             
                                                p
                                                2
                                             
                                             −
                                             
                                                r
                                                2
                                                −
                                             
                                             ≥
                                             0
                                             ,
                                             
                                             
                                                p
                                                3
                                             
                                             −
                                             
                                                r
                                                3
                                                −
                                             
                                             ≥
                                             0
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (16f)
                              
                                 
                                    
                                       
                                          
                                             −
                                             60
                                             ≤
                                             
                                                
                                                   δ
                                                   2
                                                   0
                                                
                                                
                                                   0.13
                                                
                                             
                                             ≤
                                             60
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (16g)
                              
                                 
                                    
                                       
                                          
                                             
                                                p
                                                1
                                             
                                             ,
                                             
                                                p
                                                2
                                             
                                             ,
                                             
                                                p
                                                3
                                             
                                             ,
                                             
                                                r
                                                1
                                                +
                                             
                                             ,
                                             
                                                r
                                                2
                                                +
                                             
                                             ,
                                             
                                                r
                                                3
                                                +
                                             
                                             ,
                                             
                                                r
                                                1
                                                −
                                             
                                             ,
                                             
                                                r
                                                2
                                                −
                                             
                                             ,
                                             
                                                r
                                                3
                                                −
                                             
                                             ≥
                                             0
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

At the balancing (real-time) stage, the actual wind power production can deviate from the day-ahead forecast. Table 2
                         reports forecast, 
                           
                              
                                 w
                                 ^
                              
                              ,
                           
                         maximum deviation in absolute value, Δw
                        max, and the resulting minimum and maximum values, 
                           w
                         and 
                           
                              
                                 w
                                 ¯
                              
                              ,
                           
                         respectively, of production for the two wind farms considered. In a practical application, the latter lower and upper bounds could be a low and a high quantile, respectively, of the forecasted conditional distribution of wind power production.

We make the further assumption that production from the two wind farms cannot deviate by Δw
                        max at the same time. To this purpose, we impose the budget of uncertainty 
                           
                              Γ
                              =
                              1.4
                           
                         through a constraint of the type (9d). This constraint implies that, if the deviation of one wind farm’s production is equal to Δw
                        max, then the other wind farm can deviate at most by 0.4 × Δw
                        max.

Under the non restrictive assumption that the marginal cost for redispatching is equal to the day-ahead dispatch cost, and assuming a load-shedding cost equal to $ 200/MWh, the worst-case recourse cost 
                           
                              
                                 Q
                                 W
                              
                              
                                 (
                                 p
                                 ,
                                 
                                    r
                                    +
                                 
                                 ,
                                 
                                    r
                                    −
                                 
                                 ,
                                 
                                    
                                       δ
                                    
                                    0
                                 
                                 )
                              
                           
                         is equal to the objective function value of the following max-min problem, which corresponds to model (4):

                           
                              (17a)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                max
                                                
                                                   Δ
                                                   w
                                                
                                             
                                             
                                                min
                                                
                                                   
                                                      
                                                         
                                                            
                                                               p
                                                               +
                                                            
                                                            ,
                                                            
                                                               p
                                                               −
                                                            
                                                            ,
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               l
                                                               
                                                                  sh
                                                               
                                                            
                                                            ,
                                                            
                                                               w
                                                               
                                                                  sp
                                                               
                                                            
                                                            ,
                                                            
                                                               δ
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             32
                                             
                                                (
                                                
                                                   p
                                                   1
                                                   +
                                                
                                                −
                                                
                                                   p
                                                   1
                                                   −
                                                
                                                )
                                             
                                             +
                                             20
                                             
                                                (
                                                
                                                   p
                                                   2
                                                   +
                                                
                                                −
                                                
                                                   p
                                                   2
                                                   −
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             
                                             +
                                             
                                             12
                                             
                                                (
                                                
                                                   p
                                                   3
                                                   +
                                                
                                                −
                                                
                                                   p
                                                   3
                                                   −
                                                
                                                )
                                             
                                             +
                                             200
                                             
                                                (
                                                
                                                   l
                                                   1
                                                   
                                                      sh
                                                   
                                                
                                                +
                                                
                                                   l
                                                   2
                                                   
                                                      sh
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (17b)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                
                                                s.t.
                                                
                                                
                                                
                                                   p
                                                   1
                                                   +
                                                
                                                −
                                                
                                                   p
                                                   1
                                                   −
                                                
                                                +
                                                
                                                   p
                                                   2
                                                   +
                                                
                                                −
                                                
                                                   p
                                                   2
                                                   −
                                                
                                                +
                                                Δ
                                                
                                                   w
                                                   1
                                                
                                                −
                                                
                                                   w
                                                   1
                                                   
                                                      sp
                                                   
                                                
                                                +
                                                
                                                   l
                                                   1
                                                   
                                                      sh
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             =
                                             −
                                             
                                                
                                                   
                                                      δ
                                                      2
                                                   
                                                   −
                                                   
                                                      δ
                                                      2
                                                      0
                                                   
                                                
                                                
                                                   0.13
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (17c)
                              
                                 
                                    
                                       
                                          
                                             
                                             
                                                p
                                                3
                                                +
                                             
                                             −
                                             
                                                p
                                                3
                                                −
                                             
                                             +
                                             Δ
                                             
                                                w
                                                2
                                             
                                             −
                                             
                                                w
                                                2
                                                
                                                   sp
                                                
                                             
                                             +
                                             
                                                l
                                                2
                                                
                                                   sh
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      δ
                                                      2
                                                   
                                                   −
                                                   
                                                      δ
                                                      2
                                                      0
                                                   
                                                
                                                
                                                   0.13
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (17d)
                              
                                 
                                    
                                       
                                          
                                             
                                             
                                                p
                                                1
                                                +
                                             
                                             ≤
                                             
                                                r
                                                1
                                                +
                                             
                                             ,
                                             
                                             
                                                p
                                                2
                                             
                                             ≤
                                             
                                                r
                                                2
                                                +
                                             
                                             ,
                                             
                                             
                                                p
                                                3
                                             
                                             ≤
                                             
                                                r
                                                3
                                                +
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (17e)
                              
                                 
                                    
                                       
                                          
                                             
                                             
                                                p
                                                1
                                                −
                                             
                                             ≤
                                             
                                                r
                                                1
                                                −
                                             
                                             ,
                                             
                                             
                                                p
                                                2
                                                −
                                             
                                             ≤
                                             
                                                r
                                                2
                                                −
                                             
                                             ,
                                             
                                             
                                                p
                                                3
                                                −
                                             
                                             ≤
                                             
                                                r
                                                3
                                                −
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (17f)
                              
                                 
                                    
                                       
                                          
                                             
                                             
                                                l
                                                1
                                                
                                                   sh
                                                
                                             
                                             ≤
                                             110
                                             ,
                                             
                                             
                                                l
                                                2
                                                
                                                   sh
                                                
                                             
                                             ≤
                                             30
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (17g)
                              
                                 
                                    
                                       
                                          
                                             
                                             
                                                w
                                                1
                                                
                                                   sp
                                                
                                             
                                             ≤
                                             20
                                             +
                                             Δ
                                             
                                                w
                                                1
                                             
                                             ,
                                             
                                             
                                                w
                                                2
                                                
                                                   sp
                                                
                                             
                                             ≤
                                             25
                                             +
                                             Δ
                                             
                                                w
                                                2
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (17h)
                              
                                 
                                    
                                       
                                          
                                             
                                             −
                                             60
                                             ≤
                                             
                                                
                                                   δ
                                                   2
                                                
                                                
                                                   0.13
                                                
                                             
                                             ≤
                                             60
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (17i)
                              
                                 
                                    
                                       
                                          
                                             
                                             
                                                p
                                                1
                                                +
                                             
                                             ,
                                             
                                                p
                                                2
                                                +
                                             
                                             ,
                                             
                                                p
                                                3
                                                +
                                             
                                             ,
                                             
                                                p
                                                1
                                                −
                                             
                                             ,
                                             
                                                p
                                                2
                                                −
                                             
                                             ,
                                             
                                                p
                                                3
                                                −
                                             
                                             ,
                                             
                                                l
                                                1
                                                
                                                   sh
                                                
                                             
                                             ,
                                             
                                                l
                                                2
                                                
                                                   sh
                                                
                                             
                                             ,
                                             
                                                w
                                                1
                                                
                                                   sp
                                                
                                             
                                             ,
                                             
                                                w
                                                2
                                                
                                                   sp
                                                
                                             
                                             ≥
                                             0
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (17j)
                              
                                 
                                    
                                       
                                          
                                             s.t.
                                             
                                          
                                       
                                       
                                          
                                             −
                                             15
                                             ≤
                                             Δ
                                             
                                                w
                                                1
                                             
                                             ≤
                                             15
                                             ,
                                             
                                             −
                                             20
                                             ≤
                                             Δ
                                             
                                                w
                                                2
                                             
                                             ≤
                                             20
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (17k)
                              
                                 
                                    
                                       
                                       
                                          
                                             Δ
                                             
                                                w
                                                1
                                             
                                             =
                                             Δ
                                             
                                                w
                                                1
                                                +
                                             
                                             −
                                             Δ
                                             
                                                w
                                                1
                                                −
                                             
                                             ,
                                             
                                             Δ
                                             
                                                w
                                                2
                                             
                                             =
                                             Δ
                                             
                                                w
                                                2
                                                +
                                             
                                             −
                                             Δ
                                             
                                                w
                                                2
                                                −
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (17l)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   Δ
                                                   
                                                      w
                                                      1
                                                      +
                                                   
                                                   +
                                                   Δ
                                                   
                                                      w
                                                      1
                                                      −
                                                   
                                                
                                                15
                                             
                                             +
                                             
                                                
                                                   Δ
                                                   
                                                      w
                                                      2
                                                      +
                                                   
                                                   +
                                                   Δ
                                                   
                                                      w
                                                      2
                                                      −
                                                   
                                                
                                                20
                                             
                                             ≤
                                             1.4
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The inner minimization problem in (17) enforces the minimum-cost redispatch in the electric energy system, whose general formulation is (2). The maximization problem in (17) picks the worst case realization of deviation 
                           
                              Δ
                              w
                           
                         of the wind power production from the day-ahead forecast 
                           
                              w
                              ^
                           
                        . The feasible region is polyhedral and of the budget uncertainty set type, see Section 3.3.


                        Table 3
                        a displays the results of model (16) and (17) in terms of day-ahead energy and reserve dispatch. These results can be compared to the ones obtained using a similar model based on stochastic programming as reported in Table 3b. The latter model is obtained by replacing 
                           
                              
                                 Q
                                 W
                              
                              
                                 (
                                 ·
                                 )
                              
                           
                         in (16) with the expected value of the recourse cost over a discrete set of scenarios, rather than with its worst-case value determined by model (17). The scenarios used in the stochastic programming model are 100 random samples drawn from a uniform distribution defined over the uncertainty set (17j)–(17l). While the day-ahead energy dispatch coincides, the following observations on reserve are in order:

                           
                              1.
                              As far as upward reserve is concerned, the robust optimization model yields more conservative results than the stochastic programming model. Indeed, no realization of the wind power deviation within the uncertainty set results in load-shedding events with the former approach. On the contrary, with the latter approach load shedding can take place if its cost is offset in expectation by the savings in terms of reserve.

No downward reserve is scheduled with the robust optimization approach. This is explained by the fact that there is no cost associated to wind power spillage. Hence, the worst-case realization of the wind power deviation is always negative, i.e., an underproduction, which requires no downward redispatch at the balancing stage.

With the robust optimization approach, units with the lowest aggregate cost of reserve and production, e.g., unit 3, are preferred to units with lower reserve cost but higher marginal costs, e.g., unit 1. This is a straightforward result of the focus on the worst-case realization of the uncertainty in (17). On the contrary, the stochastic programming model schedules reserve from units with lower capacity cost and higher operating costs, since the latter are weighted by the probability of actual deployment of the reserves.

In the following section, we assess the impact of increasing robustness in the proposed approach on the costs of energy dispatch, reserve and energy redispatch in a more realistic setup.

The results presented in this section are obtained from a modified version of the 24-node IEEE Reliability Test System in Grigg et al. (1999).

We include six wind farms at different locations throughout the grid. Table 4
                         reports the geographical and nodal location as well as the forecast for mean, minimum and maximum power production at the balancing stage. Forecast mean, minimum and maximum values for wind power production were estimated from historical data of wind speed at different locations in Spain included in the dataset presented in Espejo et al. (2011) and Menéndez et al. (2011). In total 500 data points were considered corresponding to the wind speed measured at 5am during 500 consecutive days starting from 1st January 1989. Wind speed data were converted into power by using the power curve of a Vestas V112 turbine of capacity 3 MW, and rescaled so as to represent the power production from wind farms whose capacities are 420, 315, 455, 245, 175 and 420 MW, respectively. Forecast mean, minimum and maximum values are the historical mean, minimum and maximum values of wind power production in the considered 500 data points. The total forecast wind power production is 588.25 MWh. Regarding demand, we consider the peak hour, where consumption totals 2850 MWh, thus wind power is expected to cover slightly above 20  percent of the load.

The budget of uncertainty, Γ, which enters the robust optimization model as the parameter on the right-hand side of (9d), was also estimated from the historical data as the largest total relative deviation for the wind farms considered. A value of 
                           
                              Γ
                              =
                              5.71
                           
                         was obtained from such an analysis in the considered period.

Besides the intervals (9a)–(9c), whose parameters are reported in Table 4, and the budget constraint (9d), we also enforce (9e) to model spatial correlation between the wind farms in the system. Table 5
                         reports the values of ρ estimated as the historical maximum relative deviation between the sites considered in the 500 points in the dataset.
                     

Capacity on the transmission lines connecting the node pairs (15, 21), (14, 16) and (13, 23) is reduced to 400 MW, 250 MW and 250 MW, respectively. This is done in order to introduce bottlenecks in the transmission system. The production cost of the units is linearized by making use of a piecewise-linear approximation. Four blocks with constant marginal cost are employed for each power unit. As far as reserve provision is concerned, we assume that nuclear plants are totally inflexible and thus unable to provide reserve. For coal units, the reserve cost per MW is equal to one fourth of the marginal cost of its most expensive block. Oil units are assumed to be more flexible and their reserve cost is one tenth of the marginal cost of the most expensive block. Notice, however, that these units have the highest production cost among the plants considered. Finally, the load-shedding cost is set to $1000/MWh.

In this section we discuss the results in terms of system cost for the day-ahead dispatch and reserve schedules for the 24-node system determined with the proposed robust optimization model. Results are compared with those obtained using a stochastic programming approach whose objective is the minimization of the expected cost, and a deterministic approach where the amount of upward and downward reserve is fixed to 15 percent of the forecasted load.

The results presented in this section are exclusively obtained out-of-sample. This means that results in terms of system cost for the different approaches are calculated over a different set of scenarios for wind power production than the one used as input to the models to determine the optimal energy and reserve dispatch. The scenario set employed in this ex-post calculation of the system cost is constructed from measurements of actual wind speed in Spain, in a way fully consistent with the scenario set used as input to the optimization models, which is described at the beginning of Section 5.2. However, such scenarios are extracted from a different time window of 500 days to guarantee the independence between the input to the optimization models and their evaluation set.


                           Table 6 breaks down the system cost for the robust optimization, the stochastic programming and the deterministic approaches into day-ahead costs (for energy and reserve dispatch) and balancing costs (for energy redispatch and load-shedding). For the latter, the expectation is reported along with two measures of risk: the Conditional Value at Risk (CVaR), see Rockafellar and Uryasev (2000), at confidence level 95 percent, and the worst-case scenario, which is denoted as VaR100percent.

Compared to the stochastic programming approach, the total reserve costs are lower for the robust optimization solution. Indeed, its higher level of conservatism is completely offset by the cost for downward reserve in the stochastic programming approach. However, the energy dispatch cost and, notably, the expected costs in the balancing stage are lower for the stochastic programming approach, which benefits from the possibility of redispatching units down rather than spilling wind power as in the solution obtained through robust optimization. In total, the stochastic programming approach outperforms the robust optimization one in terms of expected cost by about 7.3 percent. On the contrary, the robust optimization approach performs significantly better both in terms of CVaR and of cost in the worst-case scenario. It should also be mentioned that the performance gap in expected cost between the two approaches decreases to about 5.2 percent if the amount of scheduled downward reserve is fixed to zero in the stochastic programming case. This means that the performance of the robust optimization approach could be enhanced – without significantly affecting the worst-case results – if an efficient ex-post procedure to schedule downward reserve is devised. We leave this as a direction for future research.

The total amount of reserve is larger for the deterministic approach than for the stochastic programming model described above. Nevertheless, the results obtained using the deterministic model yield poorer performance than those obtained with the stochastic programming approach and with the robust optimization one, which benefit from including a projection of the balancing costs in the dispatch determination. In the case of the deterministic model, too much downward reserve is scheduled compared to the reserve in the upward direction, leading to a large cost for load-shedding.

This section focuses on the relationship between the robust optimization approach and a risk-averse one based on stochastic programming. The latter refers to a model where the Conditional-Value-at-Risk (CVaR) of the total cost at a certain confidence level α is minimized, see Rockafellar and Uryasev (2000). In practice, System Operators (SOs) are particularly concerned with the risk of not being able to meet the demand. Indeed, such a situation of deficit of production would imply load-shedding events that are costly not only in financial terms, but also in terms of corporate image. In most European markets, rather than in the day-ahead energy market, where the dispatch (and/or unit commitment) cost is minimized, risk aversion materializes in the operation of reserve markets, which ensure the presence of enough reserve capacity to deal with contingencies. The empirical proof of this risk aversion is the fact that black-outs are extremely rare events in the developed world. By jointly optimizing the energy and reserve dispatch, we introduce risk aversion also in the operation of the energy market, as in most US electricity markets.

The previous sections highlighted an important feature of the robust optimization approach, consisting in the fact that no downward reserve is scheduled. As pointed out earlier, this is a result of the focus of robust optimization on the worst-case realization of stochastic power production. The risk-averse approach based on CVaR minimization has similar properties, as long as the confidence level α is sufficiently large to exclude from the objective function scenarios with overproduction from stochastic units. This can be observed in Fig. 2
                           (a), which shows that the total amount of scheduled downward reserve drops rapidly with the confidence level α, reaching zero at levels of risk aversion slightly below 0.4. The total amount of upward reserve scheduled by both the risk-averse stochastic programming model and the robust optimization one is illustrated in Fig. 2(b). Noticeably, this amount is an increasing function of α for low values of this parameter, but then stabilizes at a lower value than the one yielded by the more conservative robust optimization approach. It should be mentioned that, although the total amount of scheduled upward regulation is basically constant for the risk-averse approach and values of α greater than 0.2, the allocation of reserve among the units varies with the level of risk-aversion.


                           Fig. 3
                           
                            illustrates the expected value of the cost obtained in-sample, i.e., calculated with respect to the scenario set employed in the optimization algorithm, by the two models considered in this section. It is relevant to point out that the expectation of the cost obtained by the risk-averse stochastic programming approach is comparable to the one obtained by the robust optimization model for values of the confidence level α in the range between 0.9 and 1. Similar results are obtained out-of-sample, using the scenario set considered in Section 5.2.1.

A comparison between the two models in terms of risk is provided in Fig. 4, which shows the in-sample CVaR at the 95 percent confidence level and the worst-case result among the scenarios considered (VaR100 percent). As expected, the in-sample CVaR95percent is minimized by the risk-averse stochastic programming approach with 
                              
                                 α
                                 =
                                 0.95
                              
                           . It is important to note that the results obtained via robust optimization have a comparable performance in terms of that risk measure. The cost in the worst-case scenario of wind power production is also similar for large values of the risk-aversion parameter α. In this respect, it should be observed that the worst-case realization within the uncertainty set estimated as described at the beginning of Section 5.2 does not necessarily coincide with the worst-case scenario in the original dataset.

Similar results, though obtained out-of-sample, are illustrated in Fig. 5
                           . In this situation, the robust optimization approach is able to achieve better results than the stochastic programming one at any level of risk aversion. This holds both in terms of CVaR95percent and in the worst-case scenario in the dataset.

In this section, we discuss the computational properties of the proposed robust optimization approach in comparison to the stochastic programming one. To this end, we consider three different power systems of increasing sizes: the 24-node IEEE Reliability Test System already considered above, as well as the 118-node and 300-node IEEE test systems. The parameters for the latter two models can be found in MATPOWER, see Zimmerman, Murillo-Sánchez, and Thomas (2011). The setup for the uncertainty in these models is the same as the one for the 24-node system previously considered, i.e., we consider historical data as scenarios for wind power production in 6 different sites. The models have been implemented in GAMS and solved using CPLEX 12, running on a laptop equipped with a 4-core processor clocking at 2.66 gigahertz.

Solution times for the robust optimization and the risk-neutral stochastic programming models are illustrated in Fig. 6
                         for scenario sets of different size. The robust optimization model converged in all cases in few iterations of the cutting-plane algorithm. The solution times for this model are plotted as horizontal lines in the figure since robust optimization is scenario-free. The lines with circular markers in the figure represent the time for solving the stochastic programming approach for the three power system models as a function of the number of scenarios. As one can see, the computation time for the stochastic programming model increases quickly with the number of scenarios. Furthermore, the computation time also increases dramatically with the size of the considered network (note that a logarithmic scale is used for the y-axis in this figure). On the contrary, the robust optimization approach shows to be considerably less affected by the number of nodes in the power system model. Observe that the latter model shows better computational properties than the stochastic programming one from relatively small sizes of the scenario set.

@&#CONCLUSIONS@&#

In this work, we consider the problem of jointly determining day-ahead energy dispatch and reserve capacity in an electricity market with large penetration of stochastic generation sources. The problem is cast as an adaptive robust optimization model, the solution of which minimizes the system cost in terms of energy dispatch, reserve and energy redispatch in the worst-case realization of the uncertain production.

We propose a novel reformulation of the problem that allows us to consider polyhedral sets of any type to model the support of the uncertainty distribution. Such a reformulation is employed as the subproblem within a well-known cutting-plane algorithm for adaptive robust optimization problems with right-hand side uncertainty. The proposed scheme, besides providing more flexibility in modeling uncertainty with general polyhedral sets, e.g., by accounting for correlation between stochastic variables, retains properties of convergence to the global optimum as well as of tractability of the methods proposed in the literature on the subject.

Through a case-study based on the 24-node IEEE Reliability Test System, we assess the degree of suboptimality of the robust solution with respect to the stochastic programming approach. System cost increases in expectation by about 7.3 percent. However, part of this figure can be explained by the fact that, differently from models based on stochastic programming, no downward reserve is scheduled using the robust optimization approach. Compared to a stochastic programming model where only upward reserve can be dispatched, the gap in expectation reduces to 5.2 percent. This indicates that there is potential to improve the performance in expectation of the robust optimization approach by devising strategies to allocate downward reserve ex-post. This is left as a direction for future research. In turn, the robust optimization solution performs better both in terms of Conditional Value at Risk (CVaR) and of cost in the worst-case scenario, where the savings obtained reach about one fourth of the total worst-case cost for the stochastic programming solution. Furthermore, the case-study shows that robust optimization is a more suitable framework to account for the stochasticity related to production from renewable sources than deterministic models, where the amount of reserve is fixed in advance by heuristic criteria.

Further comparisons with risk-averse models based on stochastic programming show that the robust optimization approach has comparable performance in terms of expected value of the cost. However, the latter approach is characterized by a higher degree of conservatism that hedges the solution and, in the considered case-study, guarantees a better out-of-sample performance in terms of risk measures such as CVaR and the worst-case cost.

Finally, we show that the robust optimization approach has better computational properties than a reasonably sized equivalent stochastic programming model, and that it scales well with the size of the power system model. Indeed, the computation time in the cases considered in this paper is not highly affected by the number of nodes in the power system. These results are promising in view of the practical application of robust optimization approaches in electricity markets.

Future research on the topic may be carried out in different directions. Firstly, the complementary problem of modeling uncertainty sets from real-world data for spatially distributed stochastic production, which is considered in a simplified manner here, should be studied. In parallel, dynamic properties could also be considered in terms of modeling uncertainty sets in a multi-period setting. Note that there is no methodological difficulty involved in extending the proposed approach to the multi-period case, although there are computational challenges stemming from the consequent increase in model size. Finally, reformulations of the robust optimization problem should be thought of in order to account for uncertainty sets with different structure, e.g., ellipsoidal sets.

@&#ACKNOWLEDGEMENTS@&#

Marco Zugno would like to thank Juan Miguel Morales from the Department of Applied Mathematics and Computer Science and Pierre Pinson from the Center for Electrical power and Energy (CEE), both at the Technical University of Denmark, for their insightful comments on this work. Antonio J. Conejo is thankful to Dimitris Bertsimas for insightful comments and inspiring observations. The work of Marco Zugno is partly funded by the Danish Council for Strategic Research (DSF) through the ENSYMORA project, no. 10-093904/DSF, which is hereby acknowledged. Finally, the authors would like to thank the editor and the referees for providing relevant suggestions to improve this manuscript.

@&#REFERENCES@&#

