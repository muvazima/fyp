@&#MAIN-TITLE@&#The 3dSOBS+ algorithm for moving object detection

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A novel neural-based moving object detection algorithm is proposed.


                        
                        
                           
                           Main novelties: initial background estimation, shadow handling, spatial coherence.


                        
                        
                           
                           It accurately handles moving backgrounds, gradual light variations, and shadows.


                        
                        
                           
                           It provides robustness against false detections for different videos.


                        
                        
                           
                           A deep analysis of experimental results on the BMC dataset is reported.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Background subtraction

Motion detection

Neural network

Self organization

@&#ABSTRACT@&#


               
               
                  We propose the 3dSOBS+ algorithm, a newly designed approach for moving object detection based on a neural background model automatically generated by a self-organizing method. The algorithm is able to accurately handle scenes containing moving backgrounds, gradual illumination variations, and shadows cast by moving objects, and is robust against false detections for different types of videos taken with stationary cameras. Experimental results and comparisons conducted on the Background Models Challenge benchmark dataset demonstrate the improvements achieved by the proposed algorithm, that compares well with the state-of-the-art methods.
               
            

@&#INTRODUCTION@&#

Several methods have been proposed for moving object detection based on background subtraction [1–4]. Nonetheless, the best approach has not yet been devised, as also witnessed by recent activities aimed at comparing the state-of-the-art methods on publicly available video sequence datasets [5,6].

Moving object detection, as a specific case of object segmentation, can be viewed as a clustering problem in a feature space derived from the color and motion information, and therefore is well suited for unsupervised modeling approaches. Unsupervised learning is in general preferred over supervised learning because the latter requires a set of training samples, which may not be available, especially when the image features are unknown or when a certain degree of automation is desired [7].

Many approaches have been explored, including statistical background modeling (e.g., single Gaussian [8] or Mixture of Gaussians [9]), clustering-based background modeling (e.g., Codebook [10]), neural-based background modeling (e.g., [11]), eventually corroborated by the introduction of fuzzy concepts to handle imprecision and uncertainties [12,13]. Neural network-based solutions have received considerable attention due to the fact that these methods are usually more effective and efficient than traditional ones, relying on the well-known advantages of neural networks, such as adaptivity, parallelism, and learning [14]. Among the most recent results, the 3D Self-Organizing Background Subtraction algorithm [15] implements an approach for moving object detection based on a neural background model automatically generated by a self-organizing method, that accurately handles most of the well known background maintenance issues.

The main contribution of our paper relies on an enhanced version of the algorithm concerning the introduction of: (a) initial background estimation; (b) shadow detection and removal; and (c) spatial coherence. These enhancements lead to the 3dSOBS+ algorithm that can accurately handle scenes containing moving backgrounds, gradual illumination variations, and shadows cast by moving objects, and provides further robustness against false detections for different types of videos taken with stationary cameras. Experimental results and comparisons conducted on the Background Models Challenge (BMC) benchmark dataset [6] demonstrate the improvements achieved by the algorithm and that it compares well with the state-of-the-art methods.

The paper is organized as follows. In Section 2 we describe in a unified framework the neural background model adopted from [15] for moving object detection and its enhanced version here proposed, while in Section 3 we provide a thorough analysis of experimental results on the BMC dataset and comparisons with several state-of-the-art methods. Conclusions are drawn in Section 4.

The proposed algorithm relies on our main idea to adopt a biologically inspired problem-solving method based on visual attention mechanisms. The aim is to obtain objects that keep the user attention in accordance with a set of predefined features, including gray level, motion, and shape features. Our approach defines a method for the generation of an active attention focus to monitor dynamic scenes for surveillance purposes. The idea is to build the background model by learning in a self-organizing manner many background variations. Based on the learned background model through a map of motion and stationary patterns, our algorithm detects moving objects and selectively updates the background model. The obtained self-organizing neural network can be organized as a 2D grid of neurons [11] or a 3D grid of neurons [15], in both cases producing a representation of training samples with lower dimensionality, at the same time preserving topological neighborhood relations of the input patterns.

In the following we will describe the algorithm and how it is able to tackle the most frequent and difficult background maintenance problems [16], including bootstrapping, illumination changes, waving trees, cast shadows, and robustness against false detections.

Given an image sequence 
                           
                              
                                 
                                    
                                       
                                          
                                             I
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                              
                           
                        , for each pixel 
                           
                              x
                           
                         in the image domain, a neural map is built, consisting of n weight vectors 
                           
                              
                                 
                                    m
                                 
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              (
                              x
                              )
                              ,
                              i
                              =
                              1
                              ,
                              …
                              ,
                              n
                           
                        , which will be called a model for pixel 
                           
                              x
                           
                        . If each sequence frame has N rows and P columns, the complete set of models 
                           
                              
                                 
                                    M
                                 
                                 
                                    t
                                 
                              
                              (
                              x
                              )
                              =
                              (
                              
                                 
                                    m
                                 
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              (
                              x
                              )
                              ,
                              …
                              ,
                              
                                 
                                    m
                                 
                                 
                                    t
                                 
                                 
                                    n
                                 
                              
                              (
                              x
                              )
                              )
                           
                         for all pixels 
                           
                              x
                           
                         of the t-th sequence frame 
                           
                              
                                 
                                    I
                                 
                                 
                                    t
                                 
                              
                           
                         is organized as a 3D neural map 
                           
                              
                                 
                                    B
                                 
                                 
                                    t
                                 
                              
                           
                         with N rows, P columns, and n layers. Therefore, the neural background model 
                           
                              
                                 
                                    B
                                 
                                 
                                    t
                                 
                              
                           
                         consists of n images 
                           
                              
                                 
                                    L
                                 
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              ,
                              i
                              =
                              1
                              ,
                              …
                              ,
                              n
                           
                        , of the same size of image 
                           
                              
                                 
                                    I
                                 
                                 
                                    t
                                 
                              
                           
                        , which we call layers, and each layer 
                           
                              
                                 
                                    L
                                 
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                           
                         contains, for each pixel 
                           
                              x
                           
                        , the i-th weight vector 
                           
                              
                                 
                                    m
                                 
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              (
                              x
                              )
                           
                        . A pictorial representation of this 3D neural model can be found in [15].

In [15], the neural model is initialized by setting all the model layers equal to the first frame of the sequence. However, in order to better handle cases where also in the initial frames the background is occluded by foreground objects (the so-called bootstrapping problem [16]), in this paper we propose to adopt one of the methods for background estimation, such as those proposed in [17] and references therein, to achieve an initial estimate 
                           
                              
                                 
                                    E
                                 
                                 
                                    0
                                 
                              
                           
                         of the scene background. As an example, in our experiments we adopt the temporal median method [18], that consists in estimating the initial background 
                           
                              
                                 
                                    E
                                 
                                 
                                    0
                                 
                              
                           
                         as the temporal median over a subset of F initial sequence frames 
                           
                              
                                 
                                    I
                                 
                                 
                                    0
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    I
                                 
                                 
                                    F
                                    -
                                    1
                                 
                              
                           
                        . Then, the neural background model 
                           
                              
                                 
                                    B
                                 
                                 
                                    0
                                 
                              
                           
                         is initialized by setting all weight vectors related to a pixel 
                           
                              x
                           
                         equal to the pixel brightness value of the estimated background, that is,
                           
                              (1)
                              
                                 
                                    
                                       m
                                    
                                    
                                       0
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 
                                    
                                       E
                                    
                                    
                                       0
                                    
                                 
                                 (
                                 x
                                 )
                                 ,
                                 
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 n
                                 .
                              
                           
                        Therefore, the resulting initial neural map 
                           
                              
                                 
                                    B
                                 
                                 
                                    0
                                 
                              
                           
                         consists of n layers, each of which is a copy of the estimated background 
                           
                              
                                 
                                    E
                                 
                                 
                                    0
                                 
                              
                           
                        .

After initialization, at each time step t, background subtraction is achieved by comparing each pixel 
                           
                              x
                           
                         of the tth sequence frame 
                           
                              
                                 
                                    I
                                 
                                 
                                    t
                                 
                              
                           
                         with the pixel current model 
                           
                              
                                 
                                    M
                                 
                                 
                                    t
                                    -
                                    1
                                 
                              
                              (
                              x
                              )
                           
                        , in order to determine if there exists a best matching weight vector 
                           
                              
                                 
                                    m
                                 
                                 
                                    t
                                    -
                                    1
                                 
                                 
                                    b
                                 
                              
                              (
                              x
                              )
                           
                         that is close enough to it. If no acceptable matching weight vector exists, 
                           
                              x
                           
                         is detected as foreground; otherwise, 
                           
                              x
                           
                         is detected as a background pixel. In case of background pixels, further learning of the neural map enables the adaptation of the background model to slight scene modifications, such as gradual illumination changes. This learning is achieved by updating the neural weights according to a visual attention mechanism of reinforcement, where the best matching weight vectors, together with their neighborhood, are reinforced into the neural map.

The above described steps will be detailed in the following subsections, also extending the background model update in order to enhance robustness against false detections and to better handle cast shadows.

At time t, the value 
                              
                                 
                                    
                                       I
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 x
                                 )
                              
                            of each incoming pixel 
                              
                                 x
                              
                            of the t-th sequence frame 
                              
                                 
                                    
                                       I
                                    
                                    
                                       t
                                    
                                 
                              
                            is compared to the pixel current model 
                              
                                 
                                    
                                       M
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 (
                                 
                                    
                                       m
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 x
                                 )
                              
                           , …, 
                              
                                 
                                    
                                       m
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                    
                                       n
                                    
                                 
                                 (
                                 x
                                 )
                                 )
                              
                           , to determine the weight vector 
                              
                                 
                                    
                                       m
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                    
                                       b
                                    
                                 
                                 (
                                 x
                                 )
                              
                            that best matches it:
                              
                                 (2)
                                 
                                    d
                                    (
                                    
                                       
                                          m
                                       
                                       
                                          t
                                          -
                                          1
                                       
                                       
                                          b
                                       
                                    
                                    (
                                    x
                                    )
                                    ,
                                    
                                       
                                          I
                                       
                                       
                                          t
                                       
                                    
                                    (
                                    x
                                    )
                                    )
                                    =
                                    
                                       
                                          
                                             min
                                          
                                          
                                             i
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             n
                                          
                                       
                                    
                                    d
                                    (
                                    
                                       
                                          m
                                       
                                       
                                          t
                                          -
                                          1
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    x
                                    )
                                    ,
                                    
                                       
                                          I
                                       
                                       
                                          t
                                       
                                    
                                    (
                                    x
                                    )
                                    )
                                    ,
                                 
                              
                           where the metric 
                              
                                 d
                                 (
                                 ·
                                 ,
                                 ·
                                 )
                              
                            is suitably chosen according to the specific color space being considered. For the experiments reported in Section 3, the Euclidean distance of vectors in the HSV color hexcone, as suggested in [19], has been adopted, that gives the distance between a weight vector 
                              
                                 
                                    
                                       m
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 x
                                 )
                              
                            and a pixel value 
                              
                                 
                                    
                                       I
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 x
                                 )
                              
                            as:
                              
                                 (3)
                                 
                                    d
                                    (
                                    
                                       
                                          m
                                       
                                       
                                          t
                                          -
                                          1
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    x
                                    )
                                    ,
                                    
                                       
                                          I
                                       
                                       
                                          t
                                       
                                    
                                    (
                                    y
                                    )
                                    )
                                    =
                                    ‖
                                    (
                                    
                                       
                                          m
                                       
                                       
                                          V
                                       
                                    
                                    ·
                                    
                                       
                                          m
                                       
                                       
                                          S
                                       
                                    
                                    ·
                                    cos
                                    (
                                    
                                       
                                          m
                                       
                                       
                                          H
                                       
                                    
                                    )
                                    ,
                                    
                                       
                                          m
                                       
                                       
                                          V
                                       
                                    
                                    ·
                                    
                                       
                                          m
                                       
                                       
                                          S
                                       
                                    
                                    ·
                                    sin
                                    (
                                    
                                       
                                          m
                                       
                                       
                                          H
                                       
                                    
                                    )
                                    ,
                                    
                                       
                                          m
                                       
                                       
                                          V
                                       
                                    
                                    )
                                    -
                                    (
                                    
                                       
                                          I
                                       
                                       
                                          V
                                       
                                    
                                    ·
                                    
                                       
                                          I
                                       
                                       
                                          S
                                       
                                    
                                    ·
                                    cos
                                    (
                                    
                                       
                                          I
                                       
                                       
                                          H
                                       
                                    
                                    )
                                    ,
                                    
                                       
                                          I
                                       
                                       
                                          V
                                       
                                    
                                    ·
                                    
                                       
                                          I
                                       
                                       
                                          S
                                       
                                    
                                    ·
                                    sin
                                    (
                                    
                                       
                                          I
                                       
                                       
                                          H
                                       
                                    
                                    )
                                    ,
                                    
                                       
                                          I
                                       
                                       
                                          V
                                       
                                    
                                    )
                                    
                                       
                                          ‖
                                       
                                       
                                          2
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                 
                              
                           where 
                              
                                 (
                                 
                                    
                                       m
                                    
                                    
                                       H
                                    
                                 
                                 ,
                                 
                                    
                                       m
                                    
                                    
                                       S
                                    
                                 
                                 ,
                                 
                                    
                                       m
                                    
                                    
                                       V
                                    
                                 
                                 )
                              
                            and 
                              
                                 (
                                 
                                    
                                       I
                                    
                                    
                                       H
                                    
                                 
                                 ,
                                 
                                    
                                       I
                                    
                                    
                                       S
                                    
                                 
                                 ,
                                 
                                    
                                       I
                                    
                                    
                                       V
                                    
                                 
                                 )
                              
                            indicate the hue, saturation, and value components of 
                              
                                 
                                    
                                       m
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 x
                                 )
                              
                            and 
                              
                                 
                                    
                                       I
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 x
                                 )
                              
                           , respectively.

In order to adapt the neural background model to scene modifications, the model 
                              
                                 
                                    
                                       M
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                 
                                 (
                                 x
                                 )
                              
                            for pixel 
                              
                                 x
                              
                            at time t should be updated. The best matching weight vector 
                              
                                 
                                    
                                       m
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                    
                                       b
                                    
                                 
                                 (
                                 x
                                 )
                              
                            (computed according to Eq. (2)) and its neighboring weight vectors of the b-th layer of model 
                              
                                 
                                    
                                       B
                                    
                                    
                                       t
                                    
                                 
                              
                            are updated according to weighted running average:
                              
                                 (4)
                                 
                                    
                                       
                                          m
                                       
                                       
                                          t
                                       
                                       
                                          b
                                       
                                    
                                    (
                                    y
                                    )
                                    =
                                    (
                                    1
                                    -
                                    α
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    )
                                    
                                       
                                          m
                                       
                                       
                                          t
                                          -
                                          1
                                       
                                       
                                          b
                                       
                                    
                                    (
                                    y
                                    )
                                    +
                                    α
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    
                                       
                                          I
                                       
                                       
                                          t
                                       
                                    
                                    (
                                    y
                                    )
                                    ,
                                    
                                    ∀
                                    y
                                    ∈
                                    
                                       
                                          N
                                       
                                       
                                          x
                                       
                                    
                                    .
                                 
                              
                           Here 
                              
                                 
                                    
                                       N
                                    
                                    
                                       x
                                    
                                 
                                 =
                                 
                                    
                                       
                                          y
                                          :
                                          
                                             
                                                
                                                   x
                                                   -
                                                   y
                                                
                                             
                                          
                                          ⩽
                                          
                                             
                                                w
                                             
                                             
                                                2
                                                D
                                             
                                          
                                       
                                    
                                 
                              
                            is a 2D square spatial neighborhood of 
                              
                                 x
                              
                            with half-width 
                              
                                 
                                    
                                       w
                                    
                                    
                                       2
                                       D
                                    
                                 
                              
                            including 
                              
                                 x
                              
                           . Moreover,
                              
                                 (5)
                                 
                                    α
                                    (
                                    x
                                    ,
                                    y
                                    )
                                    =
                                    γ
                                    ·
                                    
                                       
                                          G
                                       
                                       
                                          2
                                          D
                                       
                                    
                                    (
                                    y
                                    -
                                    x
                                    )
                                    ·
                                    
                                       
                                          
                                             1
                                             -
                                             
                                                
                                                   D
                                                
                                                
                                                   t
                                                
                                             
                                             (
                                             x
                                             )
                                          
                                       
                                    
                                    ·
                                    
                                       
                                          
                                             1
                                             -
                                             
                                                
                                                   S
                                                
                                                
                                                   t
                                                
                                             
                                             (
                                             x
                                             )
                                          
                                       
                                    
                                    ,
                                 
                              
                           where 
                              
                                 γ
                              
                            represents the learning rate, 
                              
                                 
                                    
                                       G
                                    
                                    
                                       2
                                       D
                                    
                                 
                                 (
                                 ·
                                 )
                                 =
                                 N
                                 (
                                 ·
                                 ;
                                 0
                                 ,
                                 
                                    
                                       σ
                                    
                                    
                                       2
                                       D
                                    
                                    
                                       2
                                    
                                 
                                 I
                                 )
                              
                            is a 2D Gaussian low-pass filter [20] with zero mean and 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       2
                                       D
                                    
                                    
                                       2
                                    
                                 
                                 I
                              
                            variance, 
                              
                                 
                                    
                                       D
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 x
                                 )
                              
                            indicates the background subtraction mask value for pixel 
                              
                                 x
                              
                           , that will be described in Section 2.3.3, and 
                              
                                 
                                    
                                       S
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 x
                                 )
                              
                            is the shadow mask value indicating if pixel 
                              
                                 x
                              
                            belongs to the shadow cast by an object in the scene, that will be described in Section 2.3.4. The 
                              
                                 α
                                 (
                                 x
                                 ,
                                 y
                                 )
                              
                            values in Eq. (5) are weights that allow the neural model to smoothly take into account the spatial relationship between current pixel 
                              
                                 x
                              
                            and its neighboring pixels 
                              
                                 y
                                 ∈
                                 
                                    
                                       N
                                    
                                    
                                       x
                                    
                                 
                              
                           , thus preserving topological properties of the input (close inputs correspond to close outputs). The choice of the learning factor 
                              
                                 γ
                              
                            depends on the scene variability: large 
                              
                                 γ
                              
                            values enable the network to faster learn changes corresponding to the background, but also leading to false negatives, that is, inclusion into the background model of pixels belonging to foreground moving objects. On the contrary, lower learning rates make the network slower to adapt to rapid background changes, making the model more tolerant to errors due to false negatives through self-organization. Indeed, weight vectors of false negative pixels are readily smoothed out by the learning process itself.

The 2D update of Eq. (4) involves only model weight vectors lying in the same layer b as the best matching weight vector 
                              
                                 
                                    
                                       m
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                    
                                       b
                                    
                                 
                                 (
                                 x
                                 )
                              
                           . In order to further enable the reinforcement of 
                              
                                 
                                    
                                       m
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                    
                                       b
                                    
                                 
                                 (
                                 x
                                 )
                              
                            in the model for pixel 
                              
                                 x
                              
                           , also weight vectors of 
                              
                                 x
                              
                            belonging to layers close to layer b are updated. This further update is achieved by weighted running average:
                              
                                 (6)
                                 
                                    
                                       
                                          m
                                       
                                       
                                          t
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    x
                                    )
                                    =
                                    (
                                    1
                                    -
                                    δ
                                    (
                                    x
                                    )
                                    )
                                    
                                       
                                          m
                                       
                                       
                                          t
                                          -
                                          1
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    x
                                    )
                                    +
                                    δ
                                    (
                                    x
                                    )
                                    
                                       
                                          I
                                       
                                       
                                          t
                                       
                                    
                                    (
                                    x
                                    )
                                    ,
                                 
                              
                           that involves the weight vectors 
                              
                                 
                                    
                                       m
                                    
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 x
                                 )
                              
                            of 
                              
                                 x
                              
                            such that 
                              
                                 
                                    
                                       
                                          i
                                          -
                                          b
                                       
                                    
                                 
                                 ⩽
                                 
                                    
                                       w
                                    
                                    
                                       1
                                       D
                                    
                                 
                              
                           ; that is, it involves the weight vectors that belong to a 1D inter-layer neighborhood of 
                              
                                 
                                    
                                       m
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                    
                                       b
                                    
                                 
                                 (
                                 x
                                 )
                              
                            having half-width 
                              
                                 
                                    
                                       w
                                    
                                    
                                       1
                                       D
                                    
                                 
                              
                           . In Eq. (6), 
                              
                                 δ
                                 (
                                 x
                                 )
                              
                            is set as
                              
                                 (7)
                                 
                                    δ
                                    (
                                    x
                                    )
                                    =
                                    ν
                                    ·
                                    
                                       
                                          G
                                       
                                       
                                          1
                                          D
                                       
                                    
                                    (
                                    x
                                    )
                                    ·
                                    
                                       
                                          
                                             1
                                             -
                                             
                                                
                                                   D
                                                
                                                
                                                   t
                                                
                                             
                                             (
                                             x
                                             )
                                          
                                       
                                    
                                    ·
                                    
                                       
                                          
                                             1
                                             -
                                             
                                                
                                                   S
                                                
                                                
                                                   t
                                                
                                             
                                             (
                                             x
                                             )
                                          
                                       
                                    
                                    ,
                                 
                              
                           where 
                              
                                 ν
                              
                            is the learning rate (whose choice is based on the same mathematical ground as for the learning rate 
                              
                                 γ
                              
                            in Eq. (5)), 
                              
                                 
                                    
                                       G
                                    
                                    
                                       1
                                       D
                                    
                                 
                                 (
                                 ·
                                 )
                                 =
                                 N
                                 (
                                 ·
                                 ;
                                 0
                                 ,
                                 
                                    
                                       σ
                                    
                                    
                                       1
                                       D
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                            is a 1D Gaussian low-pass filter with zero mean and 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       1
                                       D
                                    
                                    
                                       2
                                    
                                 
                              
                            variance in the 1D inter-layer neighborhood, and 
                              
                                 
                                    
                                       D
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 x
                                 )
                              
                            and 
                              
                                 
                                    
                                       S
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 x
                                 )
                              
                            are the mask values already adopted in Eq. (5).

It is useful to think of spatial coherence in terms of the intensity difference between spatially contiguous pixels. This means that neighboring pixels showing small intensity differences are coherent, while neighboring pixels with high intensity differences are incoherent. In this paper, we exploit the spatial coherence of scene objects as compared with the scene background. It is introduced in the background model updating formula by computing the background subtraction mask value 
                              
                                 
                                    
                                       D
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 x
                                 )
                              
                            in Eqs. (4) and (6) as
                              
                                 (8)
                                 
                                    
                                       
                                          D
                                       
                                       
                                          t
                                       
                                    
                                    (
                                    x
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      1
                                                   
                                                   
                                                   
                                                      if
                                                      
                                                      
                                                         
                                                            NCF
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      (
                                                      x
                                                      )
                                                      ⩽
                                                      0.5
                                                   
                                                
                                                
                                                   
                                                      0
                                                   
                                                   
                                                   
                                                      otherwise
                                                   
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           The Neighborhood Coherence Factor 
                           
                              
                                 
                                    
                                       NCF
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 x
                                 )
                              
                            is defined as [21]:
                              
                                 (9)
                                 
                                    
                                       
                                          NCF
                                       
                                       
                                          t
                                       
                                    
                                    (
                                    x
                                    )
                                    =
                                    
                                       
                                          |
                                          
                                             
                                                Ω
                                             
                                             
                                                x
                                             
                                          
                                          |
                                       
                                       
                                          |
                                          
                                             
                                                H
                                             
                                             
                                                x
                                             
                                          
                                          |
                                       
                                    
                                    ,
                                 
                              
                           where 
                              
                                 |
                                 ·
                                 |
                              
                            refers to the set cardinality, 
                              
                                 
                                    
                                       H
                                    
                                    
                                       x
                                    
                                 
                                 =
                                 {
                                 y
                                 :
                                 |
                                 x
                                 -
                                 y
                                 |
                                 ⩽
                                 h
                                 }
                              
                            is a 2D spatial neighborhood of 
                              
                                 x
                              
                            of size (2h
                           +1)×(2h
                           +1) including 
                              
                                 x
                              
                           , and 
                              
                                 
                                    
                                       Ω
                                    
                                    
                                       x
                                    
                                 
                              
                            indicates the set of pixels 
                              
                                 y
                              
                            belonging to 
                              
                                 
                                    
                                       H
                                    
                                    
                                       x
                                    
                                 
                              
                            that have in their background model a best match that is close enough to their value 
                              
                                 
                                    
                                       I
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 y
                                 )
                              
                           :
                              
                                 (10)
                                 
                                    
                                       
                                          Ω
                                       
                                       
                                          x
                                       
                                    
                                    =
                                    {
                                    y
                                    ∈
                                    
                                       
                                          H
                                       
                                       
                                          x
                                       
                                    
                                    :
                                    d
                                    (
                                    
                                       
                                          m
                                       
                                       
                                          t
                                          -
                                          1
                                       
                                       
                                          b
                                       
                                    
                                    (
                                    y
                                    )
                                    ,
                                    
                                       
                                          I
                                       
                                       
                                          t
                                       
                                    
                                    (
                                    y
                                    )
                                    )
                                    ⩽
                                    ∊
                                    }
                                    .
                                 
                              
                           The threshold 
                              
                                 ∊
                              
                            enables the distinction between foreground and background pixels. It should be chosen taking into account that high values allow the model to include several observed pixel intensity variations, thus enriching it with the past history of observed background variations; on the other hand, lower values allow the model to avoid including foreground objects, thus leading to a more accurate background model.

The thresholding function 
                              
                                 
                                    
                                       D
                                    
                                    
                                       t
                                    
                                 
                              
                            defined in Eq. (8) ensures selectivity in the update of the background model, allowing it to adapt to scene modifications, but without introducing into it the contribution of pixels that do not belong to the background scene. Indeed, the Neighborhood Coherence Factor 
                              
                                 
                                    
                                       NCF
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 x
                                 )
                              
                            gives a relative measure of the number of pixels belonging to the spatial neighborhood 
                              
                                 
                                    
                                       H
                                    
                                    
                                       x
                                    
                                 
                              
                            of a given pixel 
                              
                                 x
                              
                           , whose value is well represented by the background model. If 
                              
                                 
                                    
                                       NCF
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 x
                                 )
                                 >
                                 0.5
                              
                           , most of the pixels in this neighborhood have values well represented by the background model, and this should imply that also the value of pixel 
                              
                                 x
                              
                            is well represented by the background model, and can thus be considered as a background pixel (mask value 0 in Eq. (8)). If, on the other side, 
                              
                                 
                                    
                                       NCF
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 x
                                 )
                                 ⩽
                                 0.5
                              
                           , most of the pixels in this neighborhood are not well represented by the background model, and also the pixel 
                              
                                 x
                              
                            should be considered as a foreground pixel (mask value 1 in Eq. (8)).

The introduction of spatial coherence in the updating formula allows the background subtraction algorithm to achieve higher robustness against false detections, as it will be verified through experimental results (see Section 3).

Shadows cast on the background by moving objects apparently behave themselves as moving. In order to accurately detect the moving object shape, if a pixel 
                              
                                 x
                              
                            is in the shadow cast by some object, then it should be considered as background; however, it should not be used to update the corresponding weight vectors, in order to avoid the reinforcement of shadow information into the background model. This selectivity in the background model update can be achieved by setting to one the binary mask value 
                              
                                 
                                    
                                       S
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 x
                                 )
                              
                            in Eqs. (5) and (7) in case 
                              
                                 x
                              
                            is a shadow pixel, and setting it to zero otherwise.

In order to discriminate shadow pixels, in this paper we extend the approach adopted in [11], based on the idea that a shadow cast on the background lowers its value and saturation, without significantly changing its hue. Therefore, given the current model 
                              
                                 
                                    
                                       M
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                 
                                 (
                                 x
                                 )
                              
                            for a pixel 
                              
                                 x
                              
                            of the tth sequence frame 
                              
                                 
                                    
                                       I
                                    
                                    
                                       t
                                    
                                 
                              
                           , the shadow mask value 
                              
                                 
                                    
                                       S
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 x
                                 )
                              
                            appearing in Eqs. (5) and (7) is set as
                              
                                 (11)
                                 
                                    
                                       
                                          S
                                       
                                       
                                          t
                                       
                                    
                                    (
                                    x
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      if
                                                      
                                                      ∃
                                                      
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            t
                                                            -
                                                            1
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      (
                                                      x
                                                      )
                                                      ∈
                                                      
                                                         
                                                            M
                                                         
                                                         
                                                            t
                                                            -
                                                            1
                                                         
                                                      
                                                      (
                                                      x
                                                      )
                                                      :
                                                      
                                                      
                                                         
                                                            
                                                               |
                                                               
                                                                  
                                                                     I
                                                                  
                                                                  
                                                                     H
                                                                  
                                                               
                                                               -
                                                               
                                                                  
                                                                     m
                                                                  
                                                                  
                                                                     H
                                                                  
                                                               
                                                               |
                                                               ⩽
                                                               
                                                                  
                                                                     τ
                                                                  
                                                                  
                                                                     H
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      ∧
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     I
                                                                  
                                                                  
                                                                     S
                                                                  
                                                               
                                                               -
                                                               
                                                                  
                                                                     m
                                                                  
                                                                  
                                                                     S
                                                                  
                                                               
                                                               ⩽
                                                               
                                                                  
                                                                     τ
                                                                  
                                                                  
                                                                     S
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      ∧
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     τ
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           V
                                                                        
                                                                        
                                                                           l
                                                                        
                                                                     
                                                                  
                                                               
                                                               ⩽
                                                               
                                                                  
                                                                     
                                                                        
                                                                           I
                                                                        
                                                                        
                                                                           V
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           m
                                                                        
                                                                        
                                                                           V
                                                                        
                                                                     
                                                                  
                                                               
                                                               ⩽
                                                               
                                                                  
                                                                     τ
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           V
                                                                        
                                                                        
                                                                           u
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      otherwise
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 (
                                 
                                    
                                       m
                                    
                                    
                                       H
                                    
                                 
                                 ,
                                 
                                    
                                       m
                                    
                                    
                                       S
                                    
                                 
                                 ,
                                 
                                    
                                       m
                                    
                                    
                                       V
                                    
                                 
                                 )
                              
                            and 
                              
                                 (
                                 
                                    
                                       I
                                    
                                    
                                       H
                                    
                                 
                                 ,
                                 
                                    
                                       I
                                    
                                    
                                       S
                                    
                                 
                                 ,
                                 
                                    
                                       I
                                    
                                    
                                       V
                                    
                                 
                                 )
                              
                            indicate the hue, saturation, and value components of 
                              
                                 
                                    
                                       m
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 x
                                 )
                              
                            and 
                              
                                 
                                    
                                       I
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 x
                                 )
                              
                           , respectively. Values for thresholds 
                              
                                 
                                    
                                       τ
                                    
                                    
                                       
                                          
                                             V
                                          
                                          
                                             l
                                          
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       τ
                                    
                                    
                                       
                                          
                                             V
                                          
                                          
                                             u
                                          
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       τ
                                    
                                    
                                       S
                                    
                                 
                              
                           , and 
                              
                                 
                                    
                                       τ
                                    
                                    
                                       H
                                    
                                 
                              
                            adopted in our experiments will be detailed in Section 3.1.

The background subtraction and update procedure described in the previous subsections can be sketched for each pixel 
                           
                              x
                           
                         as the 3dSOBS+ (Enhanced 3D Self-Organizing Background Subtraction) Algorithm reported in Fig. 1
                        .

@&#EXPERIMENTAL RESULTS@&#

Several experiments have been conducted to validate our extended approach for background subtraction and to compare its results with those achieved by other state-of-the-art methods. In the following, choice of parameter values, analysis of the improvements achieved by the proposed extensions, as well as qualitative and quantitative results, will be described for the BMC dataset
                        2
                        The Background Models Challenge (BMC 2012) benchmark dataset is publicly available at http://bmc.univ-bpclermont.fr.
                     
                     
                        2
                      described in [6].

Parameter values for the 3dSOBS+ algorithm have been chosen by experimentations on the learning set of the BMC dataset, consisting of ten synthetic video sequences, covering different event types (clouds, sun, fog, wind, both with and without acquisition noise). Values common for all the BMC sequences have been chosen as in Table 1
                        , where we report values for:
                           
                              •
                              background model representation (see Section 2.1): the number n of model layers;

background model initialization (see Section 2.2): the number F of initial frames for computing the temporal median;

background subtraction and model update (see Section 2.3):
                                    
                                       -
                                       thresholding: the segmentation threshold 
                                             
                                                ∊
                                             
                                           in Eq. (10);

spatial coherence: the half-width h of the 2D spatial neighborhood 
                                             
                                                
                                                   
                                                      H
                                                   
                                                   
                                                      x
                                                   
                                                
                                             
                                           in Eq. (9);

handling shadows: the thresholds 
                                             
                                                
                                                   
                                                      τ
                                                   
                                                   
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            l
                                                         
                                                      
                                                   
                                                
                                                ,
                                                
                                                   
                                                      τ
                                                   
                                                   
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            u
                                                         
                                                      
                                                   
                                                
                                                ,
                                                
                                                   
                                                      τ
                                                   
                                                   
                                                      S
                                                   
                                                
                                             
                                          , and 
                                             
                                                
                                                   
                                                      τ
                                                   
                                                   
                                                      H
                                                   
                                                
                                             
                                           in Eq. (11);

update: the half-widths 
                                             
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      2
                                                      D
                                                   
                                                
                                             
                                           and 
                                             
                                                
                                                   
                                                      w
                                                   
                                                   
                                                      1
                                                      D
                                                   
                                                
                                             
                                           of the neighborhoods for the intra-layer update of Eq. (4) and the inter-layer update of Eq. (6), respectively; the variances 
                                             
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      2
                                                      D
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                           and 
                                             
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      1
                                                      D
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                           of the 2D and 1D Gaussian low-pass filters, and the learning rates 
                                             
                                                γ
                                             
                                           and 
                                             
                                                ν
                                             
                                           in Eqs. (5) and (7), respectively.

The proposed initialization of the background model through background estimation (see Section 2.2) allows the model to better handle those cases where, during training, the background is occluded by foreground objects. This is the case, for example, in sequence video8 (Fig. 2
                        ), where the highway is never empty of moving cars. It can be observed that the 3dSOBS+ moving object mask (Fig. 2(c)), obtained by initializing the neural background model using the temporal median of the first 100 frames (Fig. 2(a)), is more accurate than the one shown in Fig. 2(d), obtained by initializing the neural background model with the first sequence frame and subsequently training the model on the same set of initial frames, as in [15]. The enhanced result can be better appreciated in the zoomed-in details reported in the second row of Fig. 2.

The introduction of spatial coherence into the updating formula (see Section 2.3.3) allows the algorithm to achieve higher robustness against false detections. As an example, Fig. 3
                         compares the moving object masks for one frame of the sequence video3 achieved by the 3dSOBS+ algorithm with and without taking into account spatial coherence. In the zoomed-in parts shown in the second row, higher accuracy can be appreciated due to the introduction of spatial coherence.

The introduction of shadow detection and removal into the background subtraction and update procedure (see Section 2.3.4) helps in achieving a more accurate detection of moving object shapes [22]. An example is reported in Fig. 4
                         for the sequence video1, where we compare the moving object masks achieved by the 3dSOBS+ algorithm with and without discriminating shadows.

Experimental results of the 3dSOBS+ algorithm have been obtained for the evaluation set of the BMC dataset, consisting of ten synthetic video sequences and nine real videos. The adopted metrics include Precision, Recall, F-measure, PSNR, SSIM, and D-Score, computed using the BMC Wizard software that can be downloaded from the BMC website. As detailed in [6], the first three metrics are well established measures for moving object detection accuracy; the last measures have been adopted in order to analyze the visual and perceptual aspects of background subtraction algorithms.

Accuracy results achieved on the ten synthetic evaluation video sequences are reported in Table 2
                        , where boldface values indicate the best accuracy results achieved for each of the considered metrics. Here, we can observe that generally high accuracy is attained by the 3dSOBS+ algorithm, in terms of all the considered metrics. Looking more into the details, extremely accurate results have been obtained for cloudy sequences (112, 122, 212, and 222), regardless of acquisition noise (see Fig. 5
                        , where no appreciable difference between the detection results on sequence 122 without acquisition noise and sequence 222 with acquisition noise can be observed). Slightly lower accuracy is attained for sunny sequences (312 and 322), due to sudden and strong illumination variations, that are sometimes detected as foreground objects. An example is given in Fig. 6
                        , where in frame 508 the right side of the pavement appears much brighter than in frame 400, and thus it is partially detected as foreground. Moreover, Precision values (and, consequently, also F-measure values) tend to become lower for sequences 412 and 422 (Fig. 7
                        ), where strong fog events are synthetically simulated. In frame 510 (Fig. 7(c)), a strong fog effect can be observed, that causes the back building and tree to be partly detected as foreground, as shown by the moving object detection mask obtained by 3dSOBS+ (Fig. 7(d)). Finally, in sequences 512 and 522, strong dynamic background events are synthetically simulated, as exemplified in Fig. 8
                        . Here we can observe that, starting from frame 500 (Fig. 8(c)), the strongly waving trees are poorly modeled by the neural background model, and therefore are erroneously detected as moving objects (Fig. 8(d)). Indeed, the movement of the waving tree is synthetically generated by having most part of the leaves moving coherently, as they were a single huge moving object. As it will be shown later, dynamic background problems for real sequences, showing as incoherent motion of background objects, are much better handled by the neural background model.

Accuracy results achieved on the nine real evaluation video sequences are reported in Table 3
                        , where, as before, boldface values indicate the best accuracy results achieved for each of the considered metrics. It can be observed that, also in the case of real video sequences, generally very high accuracy is attained by the 3dSOBS+ algorithm, in terms of all the considered metrics. Specifically, the 3dSOBS+ algorithm well handles typical background maintenance problems, such as gradual light changes (see Fig. 9
                        ), waving trees (see Figs. 9 and 16), and cast shadows (see Figs. 9 and 11), despite the size of the moving objects (both tiny moving objects, such as those in Figs. 12, 14 and 17, and large moving objects, such as those in Fig. 10
                        )
                        . Slightly lower accuracy values can be observed for some specific difficult situations. These include cases of “removed objects”, that is, stationary objects that were in the scene during the training phase and then move away. An example is given in Fig. 9 for video1, where the parked cars shown in frame 1013 (Fig. 9(a)) have left before frame 8179 (Fig. 9(c)). Indeed, when a background object leaves the scene, it uncovers a part of the background that has not been previously learned. The selective update of our background model does not allow us to detect such situations, nor to include the “uncovered background” into the background model. Further difficult situations include strong reflections, such as those on the pavement in video2 (Fig. 10), on the train in video7 (Fig. 15), and, to a lesser extent, also on the snow due to the torchlight in video5 (Fig. 13
                        )
                        
                        
                        .

In order to compare the achieved results with those of the state-of-the-art algorithms for background subtraction, we consider the average performance results, reported in Table 4
                        , achieved on all the nineteen BMC evaluation video sequences by the 3dSOBS+ algorithm, the algorithm in [15], and by several other methods. Specifically, results for MoG [9], MoG-SH [23], AMoG [24], and IIBM [25] are those reported in [25], while results for the methods in [26,27] are those reported by the authors themselves. In Table 4, boldface values for each of the considered metrics indicate the best accuracy results achieved by the compared methods. Moreover, for each method, the average rank (Rank) has been obtained by averaging the rank achieved according to each single metric. The reported results clearly highlight that the proposed 3dSOBS+ algorithm outperforms all the compared methods in terms of Recall and F-measure, and that it achieves accuracy values that are comparable to the other state-of-the-art methods also in terms of all the other metrics.

@&#CONCLUSIONS@&#

The 3dSOBS+ algorithm enhances the self-organizing background subtraction approach for moving object detection, introducing initial background estimation, spatial coherence, and shadow detection and removal. It robustly handles gradual light changes, waving trees, and cast shadows, both for tiny and large moving objects. Indeed, experimental results and comparisons conducted on the extensive Background Models Challenge benchmark dataset demonstrate that the proposed approach is accurate and compares well with the state-of-the-art methods.

Anyway, there is still room for improvements. Indeed, through experiments we highlighted some cases, such as sudden illumination variations and reflections, where the accuracy could be improved, basically by introducing higher level analysis, e.g., as in [28,29].

@&#REFERENCES@&#

