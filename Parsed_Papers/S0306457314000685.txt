@&#MAIN-TITLE@&#Human activity data discovery from triaxial accelerometer sensor: Non-supervised learning sensitivity to feature extraction parametrization

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           The presented study performs two different tests in intra and inter subject context.


                        
                        
                           
                           A set of 180 features is implemented to be selected based on clustering performance.


                        
                        
                           
                           Our algorithm searches for the best feature extraction parameter.


                        
                        
                           
                           A new clustering metric based on the construction of the confusion matrix is proposed.


                        
                        
                           
                           A novel gesture recognition system based on data from a single 3 dimensional accelerometer.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Human activity recognition

Interactive knowledge discovery

Feature extraction

Dimensionality reduction

Clustering algorithms

@&#ABSTRACT@&#


               
               
                  
                     Background: Our methodology describes a human activity recognition framework based on feature extraction and feature selection techniques where a set of time, statistical and frequency domain features taken from 3-dimensional accelerometer sensors are extracted. This framework specifically focuses on activity recognition using on-body accelerometer sensors. We present a novel interactive knowledge discovery tool for accelerometry in human activity recognition and study the sensitivity to the feature extraction parametrization. Results: The implemented framework achieved encouraging results in human activity recognition. We have implemented a new set of features extracted from wearable sensors that are ambitious from a computational point of view and able to ensure high classification results comparable with the state of the art wearable systems (Mannini et al. 2013). A feature selection framework is developed in order to improve the clustering accuracy and reduce computational complexity.
                        1
                        The software OpenSignals (Gomes, Nunes, Sousa, & Gamboa, 2012) was used for signal acquisition and signal processing algorithms were developed in Python Programming Language (Rossum & de Boer, 1991) and Orange Software (Curk et al., 2005).
                     
                     
                        1
                      Several clustering methods such as K-Means, Affinity Propagation, Mean Shift and Spectral Clustering were applied. The K-means methodology presented promising accuracy results for person-dependent and independent cases, with 99.29% and 88.57%, respectively. Conclusions: The presented study performs two different tests in intra and inter subject context and a set of 180 features is implemented which are easily selected to classify different activities. The implemented algorithm does not stipulate, a priori, any value for time window or its overlap percentage of the signal but performs a search to find the best parameters that define the specific data. A clustering metric based on the construction of the data confusion matrix is also proposed. The main contribution of this work is the design of a novel gesture recognition system based solely on data from a single 3-dimensional accelerometer.
               
            

@&#BACKGROUND@&#

The past two decades have seen an increase in research activity in the field of human activity recognition. With activity recognition having considerably growing so did the number of challenges in developing, implementing and evaluating solutions that may help the medical diagnosis of chronic motor diseases. A major challenge in our networked world is the increasing amount of data, which require efficient and user-friendly solutions with intuitive approaches of data visualization and extraction of relevant information.

The constant concern with the human physical and psychological well being has been the drive for research studies that have led to promising advances in medicine and engineering. In Biomedical Engineering, the demand for objectivity in clinical diagnosis of pathologies so subjective and hard to trace such as Obsessive Compulsive Disorder (National Institute of Mental Health, 2013) or Autism Spectrum Disorder (Simon, Errico, & Raffle, 2013), has been one of the greatest challenges. The physical activity disturbance is one of the essential signs of psychiatric disorders and many of these, including Depression (Song, Lee, Baek, & Miller, 2012) and Parkinson’s Disease (Palmerini, Mellone, Avanzolini, Valzania, & Chiari, 2013), exhibit diagnostic criteria that require an assessment of the motor activity changes of the patient. The behavioural classification usually relies on observation and therefore a highly experienced analyst is always needed. Analysing human action is particularly challenging due to its complexity in the non rigid and self occluding nature of articulated human motion. Human body movement shows up to 244 degrees of freedom (C.H., 2006), which leads the modelling of structural and dynamic features for human activity recognition to a complex task.

The current research arises the hypothesis of accelerometry (ACC) as suitable technique for monitoring movement patterns in freely moving subjects during long periods of time. This technique can be used to measure quantitative parameters which may provide clinical insight into the subject health.

This study aims to understand the signals produced by a triaxial accelerometer through the human movement interpretation and clinical relevant parameters identification from the data. Signal processing techniques are implemented with the purpose of examining accelerometer data and finding new information that is difficult to identify from the raw data. We present a method for convenient monitoring of ambulatory movements in daily life, using a portable measurement device employing a single triaxial accelerometer.

This tool is based on an architecture of signal sensor processing, feature extraction, feature selection and clustering algorithms. To achieve the proposed goals, the following steps were implemented:
                        
                           •
                           Acquire and analyse the data produced by a triaxial accelerometer, placed on different parts of the body, during human movement, creating a database and proposing an annotation structure for motion data;

Develop a framework for the interpretation of the data provided by an accelerometry monitoring system: design a set of time, statistical and frequency domain features from several research areas such as speech recognition and activity recognition;

Develop algorithms to extract relevant information from the data;

Apply clustering techniques based on feature representation of accelerometer data;

Explore the choice of features and signals window size on the performance of different clustering algorithms;

Develop a framework to differentiate human activities, such as sitting, walking, standing, running and lying;

Evaluate the use of the system in daily life settings and the data interpretation framework: intra and inter subject context discovery;

Implement a new metric based on classification performance evaluation: classification-based evaluation.

We present a method for convenient monitoring of detailed ambulatory movements in dailylife through a portable measurement device which employs a single triaxial accelerometer and machine learning techniques.

@&#RELATED WORK@&#

Most approaches to activity recognition, using body-worn accelerometers, involve a multi-stage process (Ghahramani, 2004). Firstly, the sensor signal is divided into a number of small time segments, referred to as windows, each of which is considered sequentially. For each window, one or more features are derived to characterize the signal. These features are then used as input to a clustering algorithm which associates each window with a cluster.

Before using the accelerometer system in any monitoring context, and before the algorithms development to interpret data recorded by the system, it is mandatory to understand the nature of the signals produced by the triaxial accelerometer unit. The signal measured by each fixed-body accelerometer is a linear sum of, approximately, three components (Mathie, 2003):
                           
                              •
                              Acceleration resulting from body movement – Body Acceleration Component;

Acceleration resulting from gravity – Gravitational Acceleration Component;

Noise intrinsic to the measurement system.

The first two components provide different information about the wearer of the device: the gravitational acceleration (GA) provides information about the space orientation of the device, and the body acceleration (BA) provides information about the movement of the device. The separation of the information regarding the movement of the device is important, however these two components have overlapping frequency spectra. According to previous studies, the BA component ranges from 0Hz to an estimation 20Hz, but it is mostly contained in the range above 0 and below 3Hz (Mathie, 2003). This range overlaps the area covered by the GA component, which goes from 0 to 0.3Hz. It is possible to approximately separate the BA and the GA components by filtering techniques. Fig. 1
                         represents the motion data processing of a typical recording from the accelerometer, showing several minutes of recorded data during a supervised test where the subject performs specific tasks. Mathie (2003) have tested a wide range of different filters types with different characteristics and different windowing percentages in order to determine their ability to differentiate the components of the acceleration signal. In the present study, in order to isolate the body acceleration component, a second-order Butterworth High-Pass filter with cut-off frequency of 0.25Hz was used, as in Mathie (2003).

@&#METHODOLOGY@&#

Triaxial accelerometers produce three separated accelerometer data time series, one time series for acceleration on each axis 
                        
                           
                              
                                 ACC
                              
                              
                                 x
                              
                           
                           ,
                           
                           
                              
                                 ACC
                              
                              
                                 y
                              
                           
                        
                      and 
                        
                           
                              
                                 ACC
                              
                              
                                 z
                              
                           
                        
                     . Complementary to the three axes data, an additional time series, 
                        
                           
                              
                                 ACC
                              
                              
                                 tot
                              
                           
                        
                     , have been obtained by computing the magnitude of the acceleration:
                        
                           (1)
                           
                              
                                 
                                    ACC
                                 
                                 
                                    tot
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          ACC
                                       
                                       
                                          x
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          ACC
                                       
                                       
                                          y
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          ACC
                                       
                                       
                                          z
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                        
                     Each time series 
                        
                           
                              
                                 ACC
                              
                              
                                 i
                              
                           
                        
                     , with i
                     =
                     x, y, z was filtered with a High-Pass Butterworth filter in order to separate the low frequency component and the high frequency component, as suggested in Mathie (2003) and Mannini and Sabatini (2010). This way, for each time series, three more time series 
                        
                           
                              
                                 BA
                              
                              
                                 i
                              
                           
                        
                      are obtained, with i
                     =
                     x, y, z, representing the time series for body acceleration component. Finally, the features for each time series are extracted.

Features can be defined as the abstractions of raw data since they are reduced sets of original raw data which represent main characteristics and behaviours of the signal (Ghahramani, 2004). The reduced subset of large input data can be called feature vector, it contains important hints for the activity to be recognized and it is the main input for clustering algorithms. Tests are performed in order to assess the following parameters:
                           
                              •
                              The influence of the signal window size on the clustering performance.

The influence of the free parameters in that same performance.

The best feature combination that leads to a better performance of the implemented algorithm.

The present study investigates a new method of feature extraction for clustering problems. A dictionary of features extracted from the motion data was created in JavaScript Object Notation (JSON) format (Crockford, 2006). For each feature, the following information is collected: Description, Imports, Use, Free Parameters, Parameters, Number of Features, Function, Source and Reference, as shown in Table 1
                        .

Recognizing human activities depends directly on the features extracted for motion analysis. People tend to perform the same movement in many different ways, which can lead to substantial variability in the features derived from body-fixed sensor data. Therefore, to achieve effective clustering, the identification of features with high discriminative ability is important. A good feature set should show little variation between repetitions of the same movements performed by the same individual but should vary between different subjects performing the same task. This set must also show considerable variations between different activities. Table 2
                         shows the list of features considered in this study.

The developed dictionary divides the features into the following categories: statistical, temporal and spectral. Some of them have been intensively investigated in previous studies and proved to be useful for activity recognition. Others, like an adapted Mel-frequency cepstral coefficients (MFCC) have appeared for the first time in activity recognition and have revealed to be quite promising due to the achieved performances. By manipulating this dictionary, it is possible to reproduce the clustering tests with different feature combinations. For each signal, three new vectors were created: one with the feature information per window, another with the names of the features that were extracted in the respective clustering test and another with the label of the activity that corresponds to each window (the available groundtruth). Therefore, a 180th – dimensional feature vector is obtained: from each one of the four signal vectors, we compute fifteen features with only one output and three features (histogram, cepstral coefficients and mel-frequency cepstral coefficients with ten outputs each. This feature vector has the ability to describe the characteristics of any instance. Features are then fed to a module which implements a specific clustering algorithm.

The obtained features all have different magnitudes. This can cause problems for some machine learning algorithms, where features with higher magnitude will, a priori, be given a higher emphasis. Applying a normalizing step before clustering can counter-act this unwanted effect. Because the scale factors and units of the described features are different, before proceeding to the feature selection stage, all features are normalized to zero mean and unit variance.

Previous studies investigated techniques for the visualization of time series data and evaluate their effect in value comparison tasks. Line charts were compared with horizon graphs – an efficient time series visualization technique across a range of chart sizes (Heer, Kong, & Agrawala, 2009). To study the behaviour of each feature throughout different activities, horizon graphs were used. This procedure ensures a visual perception of the features that better separate certain activities, those who do not change their value between activities and those who only add redundant information.

In a 180th-dimensional feature vector, it becomes difficult to have a relative perception of the importance of each feature to cluster different activities. Fig. 2
                         represents an example of a horizon graph generated for a feature vector, resulting from an ACC signal composed by seven distinct activities: standing, sitting, walking, running, lying down (belly up), lying down (right side down) and lying down (left side down). It is possible to analyse the behaviour of each feature in each activity. First, the area between data curve and zero y-axis is filled in so that dark reds are very negative and dark blues are very positive. Then, negative values are flipped and coloured red, cutting the chart height by half (Heer et al., 2009). Finally, the chart is divided into bands and overlaid, again halving the height.

To systematically assess the usefulness and identify the most important features to discriminate different activities, a simple feature selection technique was used. Not all features are equally important for a specific task and some of the variables may be redundant or even irrelevant.

The feature selection stage chooses a smaller subset of the original features, which is useful to identify the informative features, and to limit computational demands when executing the recognition system on new observations. A matrix with all possible combinations of the free parameters was created and for each signal, similarly to Holzinger et al. (2012), tests were made in order to infer the impact of the window size and to obtain a better performance of the implemented algorithm. The free parameters are those used as input to the features algorithms such as the number of bins in the histogram.

The choice of features acquired from a data set and the window length over which these features are computed is of high importance. For activity recognition, where accelerometer data from PA is windowed, the choice of the number of frames is guided by a trade-off between two aspects: information and resolution (Schindler & Van Gool, 2008). Instead of a window size preselection, a combination of different values distributed in a logarithmic scale were used. According to Table 3
                        , tests were performed with window size ranging from 1000 to 4000 samples, in a logarithmic scale due to its detailed study on the lower frequencies than in the higher frequencies. For each window size, different clustering performances were obtained that allow the choice of an appropriate window size to feature extraction.

In the present study, an aspect of activity recognition that was explored was the method applied to annotate sample data, which can be used to compute the performance of the activity model. Most of the researchers have published results of experiments in which the participants are required to manually annotate each activity performed in a given moment (Liao, Fox, & Kautz, 2005; Tapia, Intille, & Larson, 2004). In other cases, the experimenters told the participants in which order the specified activities should be performed, so the correct activity labels were identified before the sensor data was even collected. Still in other studies, the raw sensor data was manually inspected in order to annotate it with a corresponding activity label (Wren & Tapia, 2006). If true class labels (ground truth) are known, the validity of a clustering can be verified by comparing the predicted labels and the true labels. For each signal, an annotation, in JSON format (Crockford, 2006) was created, as shown in Fig. 1.

In the presented study, participants were continuously observed during experiments and an observer was stating starting/ending time of each activity. The subjects know in which order the specified activities should be performed and latter, raw sensor data was manually inspected in order to annotate it with a corresponding activity label. The annotation dictionary has information about the number and label of the movements that took place and the time intervals that delimit them. Each label corresponds to one, and only one, activity, regardless of the subject. To compute this annotation format, the implemented function receives an array with the initial and the final times of each activity. It also receives as input the window size of the signal whose features will be extracted and the overlap percentage of the signal to be considered.

Machine learning algorithms based on the feature representation of accelerometer data have become the most widely used approaches in activity prediction (Witten & Hall, 2011). In this study, unsupervised learning is used to distinguish different activities. Clustering mechanisms separate and organize unlabeled data into different groups whose members are similar to each other in some metric. A good clustering process returns a set of clusters in which the intra-class similarity is high and the inter-class similarity is low. In this study several clustering methods were tested: the K-Means, the Affinity Propagation, the Mean Shift and the Spectral Clustering techniques.

The K-Means clustering algorithm (Lloyd, 1982) gives a single set of clusters, with no particular organization or structure within them. The clustering tests were performed, individually, for each subject and with the respectively concatenated data. The affinity propagation method separates the dataset into clusters through messages between data samples which characterize the suitability for one data point to fit in the cluster of the other sample. These messages are updated in response to the values from other pairs till convergence (Walter, 2007). Similarly to the previous clustering method, the Mean Shift also infers the number of clusters and studies the features distribution as a probability density function, where each point with relative high density corresponds to the clusters centres. This method computes the mean between each maximum point and each data sample. The window between these two points is moved to the mean value. The process is iterative and ends when the final clustering is given (Boukir & Reinke, 2012). Finally, the Spectral Clustering requires the number of clusters and it uses the similarity matrix between data samples to compute the best eigenvalues for posterior clustering (Liao, 2005).

Evaluation of unsupervised approaches is usually difficult due to the lack of ground truth to which one can compare the discovered structure. The presented activity recognition method includes three stages:
                           
                              •
                              Clustering the data into homogeneous groups.

Creating rules that connect instances to the correct clusters.

Recognizing activities inside the clusters.

A confusion matrix contains information about true and predicted labels from a clustering system. The performance of such systems is commonly evaluated using the data in the matrix. Once the clustering algorithm randomly associates the clustering results to non-annotated groups, a novel algorithm, that links these groups to their corresponded activity, is implemented. This function receives the confusion matrix of random assignment and goes through each row of the matrix and stores the index that contains the maximum value of each row. It is checked whether the index is unique throughout the matrix. If the index is unique, it makes the direct correspondence between the vector of true and predicted labels. Otherwise, it checks the index with the maximum value, and assigns it. The process is recursively repeated. After obtaining the assignment vector, the matrix with the labels already associated is reconstructed (see Fig. 3
                        ).

In unsupervised learning, unlabelled data is grouped into different clusters that reflect the underlying structure of the data, based on similarity groups within the data. The input data points are allocated to one of the existing clusters according to the square of the Euclidean distance from the clusters, choosing the closest. This method receives the number of clusters to form as well as the number of centroids to generate. In the presented study, the number of clusters was defined, a priori, from the designed protocol of the  performed activities. Fig. 5
                         shows the structure of clusters according to some of the best set of features: mean, autocorrelation, root mean square and Mel-Frequency Cepstral Coefficients (MFCC).

Activities which are static in nature including postures, such as lying and standing, are easier to recognize than the activities which are periodic in nature, such as running and walking. However, postures that are highly similar, such as sitting and standing, are also very hard to discriminate as they overlap significantly in the feature space.

In the present study, the experiments have been carried out with a group of 8 volunteers within an age bracket of 16–44years. All procedures were approved by the Ethics Committee of the Champalimaud Foundation. The first test consisted in the performing of a gym circuit, in a supervised atmosphere and this signal acquisition stage used the software OpenSignals  (Gomes, Nunes, Sousa, & Gamboa, 2012).

Each person performs seven activities in sequence lasting about one minute each – standing, sitting, walking, running and lying down (belly up, right side down and left side down) – wearing an accelerometer on the waist and another on the wrist. Table 4
                      enumerates the recorded movements of this investigation. Using this system, data with 3-axial acceleration at a constant rate of 800Hz and 12bits of resolution was acquired (Motionplux, 2014).

Firstly, the clustering performance for each feature was obtained. Then, tests were carried out with the best set of features. Given the knowledge of the ground truth class assignments (labels true) and the clustering algorithm assignments of the same samples (labels predicted), the Adjusted Rand Index (ARI) is a function that measures the similarity of the two assignments, ignoring permutations and with chance normalization (Pedregosa et al., 2011).

Different segmentation methods can be applied to time-series data which enhance signal behaviour and enable the gathering of useful information from continuous stream of data. The first step in the feature extraction process is to divide the acceleration stream into frames. In this framework, each segment consists of 1000, 2000 or 4000 samples. This time interval proved to be sufficient for analysing the proposed activities (walking, sitting, standing, running, and lying down). Table 5
                         shows the obtained performance for each value of window size, considering the best implemented set of features: mean, autocorrelation, root mean square and MFCC. An average of the performances obtained for the 8 subjects was calculated.

Based on these results, the Human Activity Recognition (HAR) system reaches a clustering accuracy between 89.46±0.4% and 99.14±0.6%, with 1000 and 4000 samples, respectively, and a classification accuracy between 81.94±0.7% and 99.29±0.5%. If the subject is performing a single activity for a long time interval, a long window will include more information about that activity. In this study, the windowed data contains a single activity during about one minute, which is how laboratory data usually is collected (long bouts of a single activity) so a long time interval allows a better clustering performance.

@&#RESULTS AND DISCUSSION@&#

The performance of the proposed HAR system was validated in two studies: subject-independent context and subject-dependent context. Different features and free parameter combinations were explored in order to improve the classification accuracy on physical activity measured from waist accelerometer data. The conditions in which data was collected from movements performed in a supervised laboratory setting are described in this section.

The subject-independent performance was evaluated using the K-Means Clustering Algorithm. Even in the case of healthy people, the performed movements can be highly individualistic. Nonetheless, there are a set of basic parameters that are similar to all instances of these movements. A person-independent accuracy of 88.57% and standard deviation of 4.0% was obtained, with window size of 4000 samples and the best set of features: mean, autocorrelation, root mean square and MFCC. Compared to the subject-dependent case, the accuracy is much lower which can be explained by the variations in human motion for different subjects. Each experiment was repeated eight times.

In addition to the K-means application, other clustering methods have been used to corroborate the obtained results, such as the Affinity propagation, the Mean Shift and the Spectral Clustering (Fig. 4). The Affinity Propagation application presents 32.74%, the Mean Shift shows 44.01% and with the Spectral Clustering 45.74%, for inter subject context.

A confusion matrix contains information about true and predicted labels done by a clustering system. Table 6
                         shows the confusion matrix for all subjects data. The algorithm successfully distinguish all activities but in 28.3±6.9% of the cases, the algorithm confuses sitting with standing position.

This procedure investigates how the recognizer performs in a subject’s dependent context. To evaluate the subject-dependent accuracy of the proposed algorithm, the K-Means Clustering Algorithm (Pedregosa et al., 2011) was performed for each subject data. An average person-dependent accuracy of 99.29% and standard deviation of 0.5% were obtained, with window size of 4000 samples and the best set of features: mean, autocorrelation, root mean square and MFCC. On the other hand, the Affinity Propagation application shows 89.17±7.96%, the Mean Shift presents 53.04±20.71 % and with the Spectral Clustering 93.96±4.87 %.

@&#CONCLUSIONS@&#

The major achievements of this work are: the design of a gesture recognition system based solely on data from a single 3-dimensional accelerometer which finds the best free parameters and window sizes to clustering analysis; the new set of features extracted from wearable data able to ensure high classification results; and the clustering method application in intra and inter subject context.

The experimental results presented here suggest that using only one waist-worn accelerometer can adequately identify user’s activities. Using only a minimal number of sensors in wearable activity recognition system can be a key for the success in system acceptance. Furthermore, the present study investigated several combinations of features used for activity recognition to find the best features able to distinguish physical activities. A new set of features has been taken into account and compared to the most commonly features used in literature for activity recognition (Mannini et al., 2013). The techniques that operate on the statistical, time and frequency domains, as well as on data representations that can be used to discriminate between user activities such as Horizon Plot were described. A set of 180 features is implemented and these are easily selected to test different groups of subjects and different activities. The implemented algorithm does not stipulate, a priori, any value for window length, or overlap percentage, but searches the best parameters that define the specific data. A clustering metric based on the construction of the data confusion matrix is also proposed. The results of clustering accuracy of human activities recognition with ARI in K-means application were very encouraging. An average person-dependent ARI of 99.29% and a person-independent ARI of 88.57% were reached. Compared to the subject-dependent case, the accuracy of all subjects for the Affinity propagation, the Mean Shift and the Spectral Clustering applications is much lower as it was expected from the previous results with K-means. The obtained results may be explained by the variations in human motion for different subjects.

The authors declare that they have no competing interests.

IPM carried out the human activity recognition studies, participated in the algorithm implementation, performed the statistical analysis and drafted the manuscript. ALG participated in the algorithm implementation, statistical analysis and in the manuscript composition. HG conceived the study, and participated in its design and coordination and helped to draft the manuscript. VBP conceived the study, and participated in its design and coordination and helped to draft the manuscript. RMC participated in the design of the study and helped to draft the manuscript. All authors read and approved the final manuscript.

The algorithm described in the manuscript is available for testing by reviewers at: https://www.dropbox.com/sh/3fkil2tws7z101g/J0pTQTmCXw.

@&#ACKNOWLEDGEMENTS@&#

We thank Plux- Wireless Biosignals who provided the biosensors for the accelerometry signals acquisition. RMC and VBP are supported by Human Brain Project and BrainFlight grants.

@&#REFERENCES@&#

