@&#MAIN-TITLE@&#Simultaneous high-dimensional clustering and feature selection using asymmetric Gaussian mixture models

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We introduce the multidimensional asymmetric Gaussian mixture (AGGM).


                        
                        
                           
                           We propose two novel inference frameworks for unsupervised non-Gaussian feature selection.


                        
                        
                           
                           We have used these frameworks for challenging applications.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Asymmetric Gaussian distribution

Mixture modeling

Expectation-maximization (EM)

Rival penalized EM (RPEM)

Feature selection

Model selection

Minimum message length (MML)

Scene categorization

Facial expression recognition

@&#ABSTRACT@&#


               
               
                  Finite mixture models are broadly applied in a wide range of applications concerning density estimation and clustering due to their sound mathematical basis and to the interpretability of their results. Indeed, they permit the incorporation of domain knowledge which allows the provision of better insight into the nature of the clusters and then uncovers application-specific desirable patterns that the practitioner is looking for. However, most of the works done on mixture models, when applied to computer vision tasks, assume that per-component data follow a mixture of Gaussians which may not hold as data are generally non-Gaussian (for instance, it is well-known that the distribution of natural images is highly non-Gaussian). The effect of the Gaussian mixture is analogous to the deployment of Euclidean or Mahalanobis type distances for discrimination purposes. Thus, this mixture cannot be applied efficiently in several applications involving asymmetric shapes. In this paper, we overcome this problem by using the asymmetric Gaussian mixture (AGM) model. The AGM can change its shape to model non-symmetrical and heavy tailed real world data which make it a good choice for modeling data with outliers. Modern computer vision applications generally generate complex high-dimensional data and usually, some features are noisy, redundant, or uninformative which may affect the speed and also compromise the accuracy of the used learning algorithm. Therefore, this paper addresses also the problem of unsupervised feature selection when considering AGM models. We propose two approaches for learning the resulting statistical framework. The first approach is based on the minimization of a message length objective and the second one considers rival penalized competitive learning. Our extensive simulations and experiments involving two challenging tasks namely visual scene categorization and facial expression recognition indicate that the method developed in this paper is efficient and has merits.
               
            

@&#INTRODUCTION@&#

Mathematical models in general and statistical approaches in particular have been widely used for the development of useful computer vision, signal and image processing algorithms [1–3]. Many of these approaches are based on finite mixture models (i.e. a weighted sum of distributions) which have been the topic of extensive research in the past [4] and have been applied in several applications such as content-based images categorization and retrieval [5]. In the field of finite mixtures, Gaussian mixture model (GMM) has been widely considered, studied and used [6–8]. However, the Gaussian assumption is rarely justified and met in practice [9] and this is especially true in the case of natural images as shown by several studies and research works [10]. Gaussian density has several drawbacks such as its symmetry around the mean and the rigidity of its shape, which prevent it from having a good approximation to data with outliers. Therefore, in order to model data with different shapes many researchers have considered the generalized Gaussian density (GGD) [11,12]. The GGD is able to model data with various shapes thanks to its shape parameter that controls the tail of the distribution: the larger the value of this parameter is, the flatter is the distribution; the smaller is, the more peaked is the distribution. Despite the higher flexibility that GGD offers, it is still a symmetric distribution inappropriate to model non-symmetrical data. In this article, we suggest the consideration of the asymmetric Gaussian distribution (AGD) capable of modeling heavy and short tailed data [13,14]. The AGD uses two variance parameters for left and right parts of the distribution, which allow it not only to approximate a large class of statistical distributions but also to include the asymmetry. An important part of the mixture modeling problem concerns learning the model parameters and determining the number of consistent components (M) which best describes the data.

Concerning parameters estimation, the most popular approach is perhaps the one based on the maximization of the likelihood function through the expectation maximization (EM) framework [15]. It is well-known that the EM algorithm needs an appropriate predefined number of clusters. Therefore, in the past decades, a lot of research has been devoted to the automatic selection of the number of clusters which best describes a given data set and a lot of selection criteria have been proposed such as Akaike's information criterion (AIC), minimum description length (MDL), Laplace empirical criterion (LEC), and minimum message length (MML) [4,16]. In particular, the MML criterion has been shown to outperform the majority of existing selection criteria. Thus, we shall consider it in this work by comparing it to another approach based on the rival penalized competitive learning (RPCL) algorithm which has received a lot of attention [17,18]. The RPCL algorithm allows automatic selection of the number of clusters during learning via penalizing the rival in competition. Its basic idea is that for each input not only the winner of the input sample is updated to adapt to the input, but also its rival is de-learned by a smaller de-learning rate. Many experiments have shown that the RPCL can indeed automatically select the correct cluster number by gradually driving extra seed points far away from the input data set. However, its performance is sensitive to the selection of the de-learning rate, such that if it is not well selected, the RPCL may completely break down. In order to overcome this problem, the rival penalized controlled competitive learning (RPCCL) was introduced in [19]. This algorithm sets the de-learning rate at the same value as the learning rate, then dynamically adjust it based on the relative distance of the winner to the rival and the current input, respectively. In Ref. [20], the rival penalized EM (RPEM) algorithm was proposed for mixture-based clustering. The RPEM learns the model parameters by making the mixture components compete with each other at each time step; this can be done by not only updating the winning density component parameters to adapt to the input but also all rivals's parameters are penalized with the strength proportional to the corresponding posterior density probabilities. Therefore, the RPEM is able to automatically select an appropriate number of densities by fading out the redundant densities from a density mixture which can save the computing time. Thus, we propose to use the RPEM algorithm to perform model selection and parameters learning together in a single step for the AGM model.

Modern computer vision application generates high-dimensional vectors. Handling data defined in high-dimensional feature spaces is a difficult problem [21]. Theoretically, the more information we have about each pattern, the better a learning algorithm is expected to perform. However, in many cases, some features can be noisy or uninformative which can degrade clustering efficiency [22]. Thus, in order to achieve a good performance of data modeling, irrelevant features have to be discarded. An accurate feature selection (FS), the task of choosing the best feature subset, allows the improvement of the understandability, scalability, and accuracy of the resulting learned models that generalize better to unseen data. Indeed, several recent studies have shown that selecting relevant features allows more meaningful modeling results [23,24]. However, the problem is challenging especially in unsupervised settings because of the absence of class labels that could guide the selection process [25]. Therefore, there have been only few feature selection techniques that have been applied in mixture-based clustering [26–28] since the aim is to identify simultaneously two inter-related unknowns that are optimal feature subset and optimal number of clusters. In this article, and following recent approaches (see, for instance [26–28]), we perform unsupervised feature selection approach by casting it as an estimation problem, thus avoiding any combinatorial search. For each feature, we associate a relevance weight which measures the degree of its dependence with class labels.

The remainder of this paper is organized as follows: After the introduction we first describe our AGM model and then detail our feature selection approach in Section 2. In Section 3, we address the issue of identifying the model's order using the minimum message length approach. In Section 4, we integrate the concept of feature saliency into the RPEM algorithm for the AGM model. The subsequent Section 5 demonstrates some computer simulation and experimental results on challenging applications. Finally, the paper closes with a summary of the work and concluding remarks.

Formally we say that a D-dimensional random variable, the image feature vector in our case, 
                        
                           X
                           →
                        
                        =
                        
                           
                              
                                 X
                                 1
                              
                              …
                              
                                 X
                                 D
                              
                           
                           T
                        
                      follows a M-component mixture distribution if its probability density function can be written in the following form:
                        
                           (1)
                           
                              p
                              
                                 
                                    
                                       X
                                       →
                                    
                                    |
                                    Θ
                                 
                              
                              =
                              
                                 
                                    ∑
                                    
                                       j
                                       =
                                       1
                                    
                                    M
                                 
                                 
                              
                              
                                 p
                                 j
                              
                              p
                              
                                 
                                    
                                       X
                                       →
                                    
                                    |
                                    
                                       ξ
                                       j
                                    
                                 
                              
                           
                        
                     where ξ
                     
                        j
                      is the set of the parameters of the jth component, {p
                     
                        j
                     } are the mixing proportions which must be positive and sum to one, Θ
                     ={p
                     1,…,
                     p
                     
                        M
                     ,
                     ξ
                     1,…,
                     ξ
                     
                        M
                     } is the complete set of parameters fully characterizing the mixture, M
                     ≥1 is the number of components in the mixture. For the AGM, each component density 
                        p
                        
                           
                              
                                 X
                                 →
                              
                              |
                              
                                 ξ
                                 j
                              
                           
                        
                      is an asymmetric Gaussian distribution (AGD):
                        
                           (2)
                           
                              p
                              
                                 
                                    
                                       X
                                       →
                                    
                                    |
                                    
                                       ξ
                                       j
                                    
                                 
                              
                              =
                              
                                 
                                    ∏
                                    
                                       d
                                       =
                                       1
                                    
                                    D
                                 
                                 
                              
                              
                                 
                                    2
                                    π
                                 
                              
                              
                                 1
                                 
                                    
                                       
                                          σ
                                          
                                             l
                                             
                                                j
                                                d
                                             
                                          
                                       
                                       +
                                       
                                          σ
                                          
                                             r
                                             
                                                j
                                                d
                                             
                                          
                                       
                                    
                                 
                              
                              ×
                              
                                 
                                    
                                       
                                          exp
                                          
                                             
                                                −
                                                
                                                   
                                                      
                                                         
                                                            
                                                               X
                                                               d
                                                            
                                                            −
                                                            
                                                               μ
                                                               
                                                                  j
                                                                  d
                                                               
                                                            
                                                         
                                                      
                                                      2
                                                   
                                                   
                                                      2
                                                      
                                                         σ
                                                         
                                                            l
                                                            
                                                               j
                                                               d
                                                            
                                                         
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          if
                                          
                                          
                                             X
                                             d
                                          
                                          <
                                          
                                             μ
                                             
                                                j
                                                d
                                             
                                          
                                       
                                    
                                    
                                       
                                          exp
                                          
                                             
                                                −
                                                
                                                   
                                                      
                                                         
                                                            
                                                               X
                                                               d
                                                            
                                                            −
                                                            
                                                               μ
                                                               
                                                                  j
                                                                  d
                                                               
                                                            
                                                         
                                                      
                                                      2
                                                   
                                                   
                                                      2
                                                      
                                                         σ
                                                         
                                                            r
                                                            
                                                               j
                                                               d
                                                            
                                                         
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          if
                                          
                                          
                                             X
                                             d
                                          
                                          ≥
                                          
                                             μ
                                             
                                                j
                                                d
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           ξ
                           j
                        
                        =
                        
                           
                              
                                 μ
                                 →
                              
                              j
                           
                           
                              
                                 σ
                                 →
                              
                              
                                 l
                                 j
                              
                           
                           
                              
                                 σ
                                 →
                              
                              
                                 r
                                 j
                              
                           
                        
                      is the set of the parameters of component j where 
                        
                           
                              μ
                              →
                           
                           j
                        
                        =
                        
                           
                              μ
                              
                                 j
                                 1
                              
                           
                           …
                           
                              μ
                              
                                 j
                                 D
                              
                           
                        
                        ,
                        
                           
                              σ
                              →
                           
                           
                              l
                              j
                           
                        
                        =
                        
                           
                              
                                 σ
                                 →
                              
                              
                                 l
                                 
                                    j
                                    1
                                 
                              
                           
                           …
                           
                              
                                 σ
                                 →
                              
                              
                                 l
                                 
                                    j
                                    D
                                 
                              
                           
                        
                     , and 
                        
                           
                              σ
                              →
                           
                           
                              r
                              j
                           
                        
                        =
                        
                           
                              
                                 σ
                                 →
                              
                              
                                 r
                                 
                                    j
                                    1
                                 
                              
                           
                           …
                           
                              
                                 σ
                                 →
                              
                              
                                 r
                                 
                                    j
                                    D
                                 
                              
                           
                        
                      are the mean, the left standard deviation, and the right standard deviation of the D-dimensional AGD, respectively. The AGD is chosen to be able to fit, in analytically simple and realistic way, symmetric or non-symmetric data by the combination of the left and right variances.

Let 
                        X
                        =
                        
                           
                              
                                 X
                                 →
                              
                              1
                           
                           …
                           
                              
                                 X
                                 →
                              
                              N
                           
                        
                      be a set of N independent and identically distributed vectors, assumed to arise from a finite AGM model with M components. Thus, its likelihood function can be expressed as follows:
                        
                           (3)
                           
                              p
                              
                                 
                                    X
                                    |
                                    Θ
                                 
                              
                              =
                              
                                 
                                    ∏
                                    
                                       i
                                       =
                                       1
                                    
                                    N
                                 
                                 
                              
                              
                                 
                                    ∑
                                    
                                       j
                                       =
                                       1
                                    
                                    M
                                 
                                 
                              
                              
                                 p
                                 j
                              
                              p
                              
                                 
                                    
                                       
                                          X
                                          →
                                       
                                       i
                                    
                                    |
                                    
                                       ξ
                                       j
                                    
                                 
                              
                           
                        
                     
                  

We introduce stochastic indicator variables, Z
                     
                        i
                     
                     =(Z
                     
                        i1,…,
                     Z
                     
                        iM
                     ), one for each observation, whose role is to encode to which component the observation belongs. In other words, Zij
                     , the unobserved or missing vector, equals 1 if 
                        
                           
                              X
                              →
                           
                           i
                        
                      belongs to class j and 0, otherwise. The complete-data likelihood for this case is then:
                        
                           (4)
                           
                              p
                              
                                 
                                    X
                                    ,
                                    Z
                                    |
                                    Θ
                                 
                              
                              =
                              
                                 
                                    ∏
                                    
                                       i
                                       =
                                       1
                                    
                                    N
                                 
                                 
                              
                              
                                 
                                    ∏
                                    
                                       j
                                       =
                                       1
                                    
                                    M
                                 
                                 
                              
                              
                                 
                                    
                                       
                                          p
                                          j
                                       
                                       p
                                       
                                          
                                             
                                                
                                                   X
                                                   →
                                                
                                                i
                                             
                                             |
                                             
                                                ξ
                                                j
                                             
                                          
                                       
                                    
                                 
                                 
                                    Z
                                    
                                       i
                                       j
                                    
                                 
                              
                              .
                           
                        
                     where Z
                     ={Z
                     1,…,
                     Z
                     
                        N
                     }. Taking the logarithm of Eq. (4) we can get the complete data log-likelihood by:
                        
                           (5)
                           
                              logp
                              
                                 
                                    X
                                    ,
                                    Z
                                    |
                                    Θ
                                 
                              
                              =
                              
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    N
                                 
                                 
                              
                              
                                 
                                    ∑
                                    
                                       j
                                       =
                                       1
                                    
                                    M
                                 
                                 
                              
                              
                                 Z
                                 
                                    i
                                    j
                                 
                              
                              log
                              
                                 
                                    
                                       p
                                       j
                                    
                                    p
                                    
                                       
                                          
                                             
                                                X
                                                →
                                             
                                             i
                                          
                                          |
                                          
                                             ξ
                                             j
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

The expectation-maximization (EM) algorithm is the main framework to find the maximum likelihood estimate of the parameters of a probabilistic data generation process characterized by the presence of incomplete (or missing) data in general and the parameters of an underlying finite mixture model in particular.

It is noteworthy that the previous model in Eq. (1) supposes actually that the D features have the same importance and carry pertinent information which is not generally the case, since many of which can be irrelevant for the classification task. In order to take into account the potential presence of irrelevant features, it is possible to represent irrelevant features by background Gaussian distribution with parameter 
                        
                           λ
                           →
                        
                        =
                        
                           
                              η
                              →
                           
                           
                              δ
                              →
                           
                        
                      for all classes, where 
                        
                           η
                           →
                        
                        =
                        
                           
                              η
                              1
                           
                           …
                           
                              η
                              D
                           
                        
                      and 
                        
                           δ
                           →
                        
                        =
                        
                           
                              δ
                              1
                           
                           …
                           
                              δ
                              D
                           
                        
                      represent the mean and standard deviation of the Gaussian distribution, respectively. We adopt the feature relevancy approach suggested in Ref. [26] in the case of the finite Gaussian mixture, because it is suitable for unsupervised learning. The main idea is to consider the dth feature as irrelevant if its distribution is independent of the class labels and can follow our common Gaussian density p(X
                     
                        d
                     |λ
                     
                        d
                     ). Then, the mixture density in Eq. (1) can be written as:
                        
                           (6)
                           
                              p
                              
                                 
                                    
                                       X
                                       →
                                    
                                    |
                                    Θ
                                    ,
                                    
                                       λ
                                       →
                                    
                                    ,
                                    
                                       φ
                                       →
                                    
                                 
                              
                              =
                              
                                 
                                    ∑
                                    
                                       j
                                       =
                                       1
                                    
                                    M
                                 
                                 
                              
                              
                                 p
                                 j
                              
                              
                                 
                                    ∏
                                    
                                       d
                                       =
                                       1
                                    
                                    D
                                 
                                 
                              
                              p
                              
                                 
                                    
                                       
                                          X
                                          d
                                       
                                       |
                                       
                                          ξ
                                          
                                             j
                                             d
                                          
                                       
                                    
                                 
                                 
                                    φ
                                    d
                                 
                              
                              p
                              
                                 
                                    
                                       
                                          X
                                          d
                                       
                                       |
                                       
                                          λ
                                          d
                                       
                                    
                                 
                                 
                                    1
                                    −
                                    
                                       φ
                                       d
                                    
                                 
                              
                           
                        
                     where λ
                     
                        d
                     
                     =(η
                     
                        d
                     ,
                     δ
                     
                        d
                     ) and 
                        
                           φ
                           →
                        
                        =
                        
                           
                              
                                 φ
                                 1
                              
                              …
                              
                                 φ
                                 D
                              
                           
                           T
                        
                      is a set of binary parameters, such that φ
                     
                        d
                     
                     =1 if the dth feature is relevant and φ
                     
                        d
                     
                     =0, otherwise. Note that, {φ
                     
                        d
                     } can be considered as missing variables. Thus, the resulting model can be given by Ref. [26]:
                        
                           (7)
                           
                              p
                              
                                 
                                    
                                       X
                                       →
                                    
                                    |
                                    
                                       Θ
                                       M
                                    
                                 
                              
                              =
                              
                                 
                                    ∑
                                    
                                       j
                                       =
                                       1
                                    
                                    M
                                 
                                 
                              
                              
                                 p
                                 j
                              
                              
                                 
                                    ∏
                                    
                                       d
                                       =
                                       1
                                    
                                    D
                                 
                                 
                              
                              
                                 
                                    
                                       ω
                                       d
                                    
                                    p
                                    
                                       
                                          
                                             X
                                             d
                                          
                                          |
                                          
                                             ξ
                                             
                                                j
                                                d
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          1
                                          −
                                          
                                             ω
                                             d
                                          
                                       
                                    
                                    p
                                    
                                       
                                          
                                             X
                                             d
                                          
                                          |
                                          
                                             λ
                                             d
                                          
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           Θ
                           M
                        
                        =
                        
                           Θ
                           
                              ω
                              →
                           
                           
                              λ
                              →
                           
                        
                      is the complete set of parameters fully characterizing the mixture. We suppose that not all the features of an observation are important, through the weight relevancy of these features. That is, the weight is denoted as ω
                     =[ω
                     1,…,
                     ω
                     
                        D
                     ]
                        T
                      with 0≤
                     ω
                     
                        d
                     
                     ≤1, where ωd
                      represents the probability that the dth feature is relevant to all the clusters (ω
                     
                        d
                     
                     =
                     p(φ
                     
                        d
                     
                     =1)). Therefore, the irrelevant features have little contribution to a given cluster in the subspace, thus their distributions are common to all the clusters in this case. We finally note that the previous model is reduced to the one in Eq. (1) when all the features are considered as relevant.

First, we suppose that the number of mixture components M is known and we use the EM algorithm to estimate the model's parameters. Then, we use the MML criterion to choose the optimal number of classes M.

By treating M as known, we can derive the following EM algorithm for parameters estimation:
                           
                              •
                              Expectation step:
                                    
                                       (8)
                                       
                                          h
                                          
                                             
                                                j
                                                |
                                                
                                                   
                                                      X
                                                      →
                                                   
                                                   i
                                                
                                                ,
                                                
                                                   Θ
                                                   M
                                                
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   p
                                                   j
                                                
                                                
                                                   
                                                      ∏
                                                      
                                                         d
                                                         =
                                                         1
                                                      
                                                      D
                                                   
                                                   
                                                
                                                
                                                   ζ
                                                   
                                                      i
                                                      j
                                                      d
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         j
                                                         =
                                                         1
                                                      
                                                      M
                                                   
                                                   
                                                      
                                                         p
                                                         j
                                                      
                                                   
                                                
                                                
                                                   
                                                      ∏
                                                      
                                                         d
                                                         =
                                                         1
                                                      
                                                      D
                                                   
                                                   
                                                      
                                                         ζ
                                                         
                                                            i
                                                            j
                                                            d
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              

where ζ
                                 
                                    ijd
                                 
                                 =
                                 ω
                                 
                                    d
                                 
                                 p(X
                                 
                                    id
                                 |ξ
                                 
                                    jd
                                 )+(1−
                                 ω
                                 
                                    d
                                 )p(X
                                 
                                    id
                                 |λ
                                 
                                    d
                                 )

Maximization step:
                                    
                                       (9)
                                       
                                          
                                             p
                                             j
                                             new
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      N
                                                   
                                                   
                                                      h
                                                      
                                                         
                                                            j
                                                            |
                                                            
                                                               
                                                                  X
                                                                  →
                                                               
                                                               i
                                                            
                                                            ,
                                                            
                                                               Θ
                                                               M
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             N
                                          
                                       
                                    
                                 
                                 
                                    
                                       (10)
                                       
                                          
                                             μ
                                             
                                                j
                                                d
                                             
                                             new
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      N
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               ω
                                                               d
                                                            
                                                            p
                                                            
                                                               
                                                                  
                                                                     X
                                                                     id
                                                                  
                                                                  |
                                                                  
                                                                     ξ
                                                                     
                                                                        j
                                                                        d
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            ζ
                                                            
                                                               i
                                                               j
                                                               d
                                                            
                                                         
                                                      
                                                      h
                                                      
                                                         
                                                            j
                                                            |
                                                            
                                                               
                                                                  X
                                                                  →
                                                               
                                                               i
                                                            
                                                            ,
                                                            
                                                               Θ
                                                               M
                                                            
                                                         
                                                      
                                                      
                                                         X
                                                         id
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   N
                                                
                                                
                                                   
                                                      
                                                         
                                                            ω
                                                            d
                                                         
                                                         p
                                                         
                                                            
                                                               
                                                                  X
                                                                  id
                                                               
                                                               |
                                                               
                                                                  ξ
                                                                  
                                                                     j
                                                                     d
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         ζ
                                                         
                                                            i
                                                            j
                                                            d
                                                         
                                                      
                                                   
                                                   h
                                                   
                                                      
                                                         j
                                                         |
                                                         
                                                            
                                                               X
                                                               →
                                                            
                                                            i
                                                         
                                                         ,
                                                         
                                                            Θ
                                                            M
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       (11)
                                       
                                          
                                             σ
                                             
                                                l
                                                
                                                   j
                                                   d
                                                
                                             
                                             new
                                          
                                          =
                                          
                                             σ
                                             
                                                l
                                                
                                                   j
                                                   d
                                                
                                             
                                             old
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ∂
                                                               2
                                                            
                                                            L
                                                            
                                                               X
                                                               
                                                                  Θ
                                                                  M
                                                               
                                                               Z
                                                               φ
                                                            
                                                         
                                                         
                                                            ∂
                                                            
                                                               σ
                                                               
                                                                  l
                                                                  
                                                                     j
                                                                     d
                                                                  
                                                               
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∂
                                                         L
                                                         
                                                            X
                                                            
                                                               Θ
                                                               M
                                                            
                                                            Z
                                                            φ
                                                         
                                                      
                                                      
                                                         ∂
                                                         
                                                            σ
                                                            
                                                               l
                                                               
                                                                  j
                                                                  d
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       (12)
                                       
                                          
                                             σ
                                             
                                                r
                                                
                                                   j
                                                   d
                                                
                                             
                                             new
                                          
                                          =
                                          
                                             σ
                                             
                                                r
                                                
                                                   j
                                                   d
                                                
                                             
                                             old
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ∂
                                                               2
                                                            
                                                            L
                                                            
                                                               X
                                                               
                                                                  Θ
                                                                  M
                                                               
                                                               Z
                                                               φ
                                                            
                                                         
                                                         
                                                            ∂
                                                            
                                                               σ
                                                               
                                                                  r
                                                                  
                                                                     j
                                                                     d
                                                                  
                                                               
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∂
                                                         L
                                                         
                                                            X
                                                            
                                                               Θ
                                                               M
                                                            
                                                            Z
                                                            φ
                                                         
                                                      
                                                      
                                                         ∂
                                                         
                                                            σ
                                                            
                                                               r
                                                               
                                                                  j
                                                                  d
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       (13)
                                       
                                          
                                             η
                                             d
                                             new
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      N
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               ∑
                                                               
                                                                  j
                                                                  =
                                                                  1
                                                               
                                                               M
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           1
                                                                           −
                                                                           
                                                                              ω
                                                                              d
                                                                           
                                                                        
                                                                     
                                                                     p
                                                                     
                                                                        
                                                                           
                                                                              X
                                                                              id
                                                                           
                                                                           |
                                                                           
                                                                              λ
                                                                              d
                                                                           
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     ζ
                                                                     
                                                                        i
                                                                        j
                                                                        d
                                                                     
                                                                  
                                                               
                                                               h
                                                               
                                                                  
                                                                     j
                                                                     |
                                                                     
                                                                        
                                                                           X
                                                                           →
                                                                        
                                                                        i
                                                                     
                                                                     ,
                                                                     
                                                                        Θ
                                                                        M
                                                                     
                                                                  
                                                               
                                                               ]
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   X
                                                   id
                                                
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   N
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                         
                                                            j
                                                            =
                                                            1
                                                         
                                                         M
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     1
                                                                     −
                                                                     
                                                                        ω
                                                                        d
                                                                     
                                                                  
                                                               
                                                               p
                                                               
                                                                  
                                                                     
                                                                        X
                                                                        id
                                                                     
                                                                     |
                                                                     
                                                                        λ
                                                                        d
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               ζ
                                                               
                                                                  i
                                                                  j
                                                                  d
                                                               
                                                            
                                                         
                                                         h
                                                         
                                                            
                                                               j
                                                               |
                                                               
                                                                  
                                                                     X
                                                                     →
                                                                  
                                                                  i
                                                               
                                                               ,
                                                               
                                                                  Θ
                                                                  M
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       (14)
                                       
                                          
                                             δ
                                             d
                                             
                                                2
                                                new
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      N
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               ∑
                                                               
                                                                  j
                                                                  =
                                                                  1
                                                               
                                                               M
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           1
                                                                           −
                                                                           
                                                                              ω
                                                                              d
                                                                           
                                                                        
                                                                     
                                                                     p
                                                                     
                                                                        
                                                                           
                                                                              X
                                                                              id
                                                                           
                                                                           |
                                                                           
                                                                              λ
                                                                              d
                                                                           
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     ζ
                                                                     
                                                                        i
                                                                        j
                                                                        d
                                                                     
                                                                  
                                                               
                                                               h
                                                               
                                                                  
                                                                     j
                                                                     |
                                                                     
                                                                        
                                                                           X
                                                                           →
                                                                        
                                                                        i
                                                                     
                                                                     ,
                                                                     
                                                                        Θ
                                                                        M
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            X
                                                            id
                                                         
                                                         −
                                                         
                                                            η
                                                            d
                                                         
                                                      
                                                   
                                                   2
                                                
                                             
                                             
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   N
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                         
                                                            j
                                                            =
                                                            1
                                                         
                                                         M
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     1
                                                                     −
                                                                     
                                                                        ω
                                                                        d
                                                                     
                                                                  
                                                               
                                                               p
                                                               
                                                                  
                                                                     
                                                                        X
                                                                        id
                                                                     
                                                                     |
                                                                     
                                                                        λ
                                                                        d
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               ζ
                                                               
                                                                  i
                                                                  j
                                                                  d
                                                               
                                                            
                                                         
                                                         h
                                                         
                                                            
                                                               j
                                                               |
                                                               
                                                                  
                                                                     X
                                                                     →
                                                                  
                                                                  i
                                                               
                                                               ,
                                                               
                                                                  Θ
                                                                  M
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       (15)
                                       
                                          
                                             ω
                                             d
                                             new
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      N
                                                   
                                                   
                                                      
                                                         
                                                            ∑
                                                            
                                                               j
                                                               =
                                                               1
                                                            
                                                            M
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     ω
                                                                     d
                                                                  
                                                                  p
                                                                  
                                                                     
                                                                        
                                                                           X
                                                                           id
                                                                        
                                                                        |
                                                                        
                                                                           ξ
                                                                           
                                                                              j
                                                                              d
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                               
                                                                  ζ
                                                                  
                                                                     i
                                                                     j
                                                                     d
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                h
                                                
                                                   
                                                      j
                                                      |
                                                      
                                                         
                                                            X
                                                            →
                                                         
                                                         i
                                                      
                                                      ,
                                                      
                                                         Θ
                                                         M
                                                      
                                                   
                                                
                                             
                                             N
                                          
                                       
                                    
                                 
                              

where 
                                    L
                                    
                                       X
                                       
                                          Θ
                                          M
                                       
                                       Z
                                       φ
                                    
                                  is the model's complete data log-likelihood 
                                    L
                                    
                                       X
                                       
                                          Θ
                                          M
                                       
                                       Z
                                       φ
                                    
                                 , and we have
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∂
                                                         L
                                                         
                                                            X
                                                            
                                                               Θ
                                                               M
                                                            
                                                            Z
                                                            φ
                                                         
                                                      
                                                      
                                                         ∂
                                                         
                                                            σ
                                                            
                                                               l
                                                               
                                                                  j
                                                                  d
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         N
                                                      
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            ω
                                                            d
                                                         
                                                         p
                                                         
                                                            
                                                               
                                                                  X
                                                                  id
                                                               
                                                               |
                                                               
                                                                  ξ
                                                                  
                                                                     j
                                                                     d
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         ζ
                                                         
                                                            i
                                                            j
                                                            d
                                                         
                                                      
                                                   
                                                   h
                                                   
                                                      
                                                         j
                                                         |
                                                         
                                                            
                                                               X
                                                               →
                                                            
                                                            i
                                                         
                                                         ,
                                                         
                                                            Θ
                                                            M
                                                         
                                                      
                                                   
                                                   
                                                      ϑ
                                                      
                                                         l
                                                         
                                                            i
                                                            j
                                                            d
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                            2
                                                         
                                                         L
                                                         
                                                            X
                                                            
                                                               Θ
                                                               M
                                                            
                                                            Z
                                                            φ
                                                         
                                                      
                                                      
                                                         ∂
                                                         
                                                            σ
                                                            
                                                               l
                                                               
                                                                  j
                                                                  d
                                                               
                                                            
                                                            2
                                                         
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         N
                                                      
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            ω
                                                            d
                                                         
                                                         p
                                                         
                                                            
                                                               
                                                                  X
                                                                  id
                                                               
                                                               |
                                                               
                                                                  ξ
                                                                  
                                                                     j
                                                                     d
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         ζ
                                                         
                                                            i
                                                            j
                                                            d
                                                         
                                                      
                                                   
                                                   h
                                                   
                                                      
                                                         j
                                                         |
                                                         
                                                            
                                                               X
                                                               →
                                                            
                                                            i
                                                         
                                                         ,
                                                         
                                                            Θ
                                                            M
                                                         
                                                      
                                                   
                                                   
                                                      ϑ
                                                      
                                                         l
                                                         
                                                            i
                                                            j
                                                            d
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            ρ
                                                            
                                                               l
                                                               
                                                                  i
                                                                  j
                                                                  d
                                                               
                                                            
                                                         
                                                         +
                                                         
                                                            ϑ
                                                            
                                                               l
                                                               
                                                                  i
                                                                  j
                                                                  d
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     1
                                                                     −
                                                                     
                                                                        ω
                                                                        d
                                                                     
                                                                  
                                                               
                                                               p
                                                               
                                                                  
                                                                     
                                                                        X
                                                                        id
                                                                     
                                                                     |
                                                                     
                                                                        λ
                                                                        d
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               ζ
                                                               
                                                                  i
                                                                  j
                                                                  d
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         ∂
                                                         L
                                                         
                                                            X
                                                            
                                                               Θ
                                                               M
                                                            
                                                            Z
                                                            φ
                                                         
                                                      
                                                      
                                                         ∂
                                                         
                                                            σ
                                                            
                                                               r
                                                               
                                                                  j
                                                                  d
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         N
                                                      
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            ω
                                                            d
                                                         
                                                         p
                                                         
                                                            
                                                               
                                                                  X
                                                                  id
                                                               
                                                               |
                                                               
                                                                  ξ
                                                                  
                                                                     j
                                                                     d
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         ζ
                                                         
                                                            i
                                                            j
                                                            d
                                                         
                                                      
                                                   
                                                   h
                                                   
                                                      
                                                         j
                                                         |
                                                         
                                                            
                                                               X
                                                               →
                                                            
                                                            i
                                                         
                                                         ,
                                                         
                                                            Θ
                                                            M
                                                         
                                                      
                                                   
                                                   
                                                      ϑ
                                                      
                                                         r
                                                         
                                                            i
                                                            j
                                                            d
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                            2
                                                         
                                                         L
                                                         
                                                            X
                                                            
                                                               Θ
                                                               M
                                                            
                                                            Z
                                                            φ
                                                         
                                                      
                                                      
                                                         ∂
                                                         
                                                            σ
                                                            
                                                               r
                                                               
                                                                  j
                                                                  d
                                                               
                                                            
                                                            2
                                                         
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         N
                                                      
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            ω
                                                            d
                                                         
                                                         p
                                                         
                                                            
                                                               
                                                                  X
                                                                  id
                                                               
                                                               |
                                                               
                                                                  ξ
                                                                  
                                                                     j
                                                                     d
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         ζ
                                                         
                                                            i
                                                            j
                                                            d
                                                         
                                                      
                                                   
                                                   h
                                                   
                                                      
                                                         j
                                                         |
                                                         
                                                            
                                                               X
                                                               →
                                                            
                                                            i
                                                         
                                                         ,
                                                         
                                                            Θ
                                                            M
                                                         
                                                      
                                                   
                                                   
                                                      ϑ
                                                      
                                                         r
                                                         
                                                            i
                                                            j
                                                            d
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            ρ
                                                            
                                                               r
                                                               
                                                                  i
                                                                  j
                                                                  d
                                                               
                                                            
                                                         
                                                         +
                                                         
                                                            ϑ
                                                            
                                                               r
                                                               
                                                                  i
                                                                  j
                                                                  d
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     1
                                                                     −
                                                                     
                                                                        ω
                                                                        d
                                                                     
                                                                  
                                                               
                                                               p
                                                               
                                                                  
                                                                     
                                                                        X
                                                                        id
                                                                     
                                                                     |
                                                                     
                                                                        λ
                                                                        d
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               ζ
                                                               
                                                                  i
                                                                  j
                                                                  d
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              

where
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ϑ
                                                      
                                                         l
                                                         
                                                            i
                                                            j
                                                            d
                                                         
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              X
                                                                              id
                                                                           
                                                                           −
                                                                           
                                                                              μ
                                                                              
                                                                                 j
                                                                                 d
                                                                              
                                                                           
                                                                        
                                                                     
                                                                     2
                                                                  
                                                                  
                                                                     σ
                                                                     
                                                                        l
                                                                        
                                                                           j
                                                                           d
                                                                        
                                                                     
                                                                     3
                                                                  
                                                               
                                                               −
                                                               
                                                                  1
                                                                  
                                                                     
                                                                        
                                                                           σ
                                                                           
                                                                              l
                                                                              
                                                                                 j
                                                                                 d
                                                                              
                                                                           
                                                                        
                                                                        +
                                                                        
                                                                           σ
                                                                           
                                                                              r
                                                                              
                                                                                 j
                                                                                 d
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               if
                                                               
                                                               
                                                                  X
                                                                  id
                                                               
                                                               <
                                                               
                                                                  μ
                                                                  
                                                                     j
                                                                     d
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               −
                                                               
                                                                  1
                                                                  
                                                                     
                                                                        
                                                                           σ
                                                                           
                                                                              l
                                                                              
                                                                                 j
                                                                                 d
                                                                              
                                                                           
                                                                        
                                                                        +
                                                                        
                                                                           σ
                                                                           
                                                                              r
                                                                              
                                                                                 j
                                                                                 d
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               if
                                                               
                                                               
                                                                  X
                                                                  id
                                                               
                                                               ≥
                                                               
                                                                  μ
                                                                  
                                                                     j
                                                                     d
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   ;
                                                
                                                
                                                   
                                                      ϑ
                                                      
                                                         r
                                                         
                                                            i
                                                            j
                                                            d
                                                         
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         
                                                            
                                                               −
                                                               
                                                                  1
                                                                  
                                                                     
                                                                        
                                                                           σ
                                                                           
                                                                              l
                                                                              
                                                                                 j
                                                                                 d
                                                                              
                                                                           
                                                                        
                                                                        +
                                                                        
                                                                           σ
                                                                           
                                                                              r
                                                                              
                                                                                 j
                                                                                 d
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               if
                                                               
                                                               
                                                                  X
                                                                  id
                                                               
                                                               <
                                                               
                                                                  μ
                                                                  
                                                                     j
                                                                     d
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              X
                                                                              id
                                                                           
                                                                           −
                                                                           
                                                                              μ
                                                                              
                                                                                 j
                                                                                 d
                                                                              
                                                                           
                                                                        
                                                                     
                                                                     2
                                                                  
                                                                  
                                                                     σ
                                                                     
                                                                        r
                                                                        
                                                                           j
                                                                           d
                                                                        
                                                                     
                                                                     3
                                                                  
                                                               
                                                               −
                                                               
                                                                  1
                                                                  
                                                                     
                                                                        
                                                                           σ
                                                                           
                                                                              l
                                                                              
                                                                                 j
                                                                                 d
                                                                              
                                                                           
                                                                        
                                                                        +
                                                                        
                                                                           σ
                                                                           
                                                                              r
                                                                              
                                                                                 j
                                                                                 d
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               if
                                                               
                                                               
                                                                  X
                                                                  id
                                                               
                                                               ≥
                                                               
                                                                  μ
                                                                  
                                                                     j
                                                                     d
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                ρ
                                                
                                                   l
                                                   
                                                      i
                                                      j
                                                      d
                                                   
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         
                                                            1
                                                            
                                                               
                                                                  
                                                                     
                                                                        σ
                                                                        
                                                                           l
                                                                           
                                                                              j
                                                                              d
                                                                           
                                                                        
                                                                     
                                                                     +
                                                                     
                                                                        σ
                                                                        
                                                                           r
                                                                           
                                                                              j
                                                                              d
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                               2
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               3
                                                               
                                                                  
                                                                     
                                                                        
                                                                           X
                                                                           id
                                                                        
                                                                        −
                                                                        
                                                                           μ
                                                                           
                                                                              j
                                                                              d
                                                                           
                                                                        
                                                                     
                                                                  
                                                                  2
                                                               
                                                            
                                                            
                                                               σ
                                                               
                                                                  l
                                                                  
                                                                     j
                                                                     d
                                                                  
                                                               
                                                               4
                                                            
                                                         
                                                      
                                                      
                                                         if
                                                         
                                                         
                                                            X
                                                            id
                                                         
                                                         <
                                                         
                                                            μ
                                                            
                                                               j
                                                               d
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            1
                                                            
                                                               
                                                                  
                                                                     
                                                                        σ
                                                                        
                                                                           l
                                                                           
                                                                              j
                                                                              d
                                                                           
                                                                        
                                                                     
                                                                     +
                                                                     
                                                                        σ
                                                                        
                                                                           r
                                                                           
                                                                              j
                                                                              d
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                               2
                                                            
                                                         
                                                      
                                                      
                                                         if
                                                         
                                                         
                                                            X
                                                            id
                                                         
                                                         ≥
                                                         
                                                            μ
                                                            
                                                               j
                                                               d
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ρ
                                                
                                                   r
                                                   
                                                      i
                                                      j
                                                      d
                                                   
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         
                                                            1
                                                            
                                                               
                                                                  
                                                                     
                                                                        σ
                                                                        
                                                                           l
                                                                           
                                                                              j
                                                                              d
                                                                           
                                                                        
                                                                     
                                                                     +
                                                                     
                                                                        σ
                                                                        
                                                                           r
                                                                           
                                                                              j
                                                                              d
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                               2
                                                            
                                                         
                                                      
                                                      
                                                         if
                                                         
                                                         
                                                            X
                                                            id
                                                         
                                                         <
                                                         
                                                            μ
                                                            
                                                               j
                                                               d
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            1
                                                            
                                                               
                                                                  
                                                                     
                                                                        σ
                                                                        
                                                                           l
                                                                           
                                                                              j
                                                                              d
                                                                           
                                                                        
                                                                     
                                                                     +
                                                                     
                                                                        σ
                                                                        
                                                                           r
                                                                           
                                                                              j
                                                                              d
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                               2
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               3
                                                               
                                                                  
                                                                     
                                                                        
                                                                           X
                                                                           id
                                                                        
                                                                        −
                                                                        
                                                                           μ
                                                                           
                                                                              j
                                                                              d
                                                                           
                                                                        
                                                                     
                                                                  
                                                                  2
                                                               
                                                            
                                                            
                                                               σ
                                                               
                                                                  r
                                                                  
                                                                     j
                                                                     d
                                                                  
                                                               
                                                               4
                                                            
                                                         
                                                      
                                                      
                                                         if
                                                         
                                                         
                                                            X
                                                            id
                                                         
                                                         ≥
                                                         
                                                            μ
                                                            
                                                               j
                                                               d
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              

Note that the gradients with respect to 
                           
                              σ
                              
                                 l
                                 
                                    j
                                    d
                                 
                              
                           
                         and 
                           
                              σ
                              
                                 r
                                 
                                    j
                                    d
                                 
                              
                           
                         are non-linear, therefore we have decided to use the Newton–Raphson method, based on the first and second gradients of 
                           L
                           
                              X
                              
                                 Θ
                                 M
                              
                              Z
                              φ
                           
                        , for estimation.

Generally, the maximum likelihood estimate favors higher values for M which leads to overfitting. Therefore, a model selection criterion is needed to estimate the number of components of a mixture model. The MML approach is based on evaluating statistical models according to their ability to compress a message containing the data (minimum coding length criterion). High compression is obtained by building a short code for your data. Therefore, in the case of MML, the optimal number of classes in the mixture is obtained by minimizing the following cost function [29]:
                           
                              (16)
                              
                                 MessLens
                                 ≈
                                 −
                                 logp
                                 
                                    
                                       θ
                                       M
                                    
                                 
                                 +
                                 
                                    c
                                    2
                                 
                                 
                                    
                                       1
                                       +
                                       log
                                       
                                          1
                                          12
                                       
                                    
                                 
                                 +
                                 
                                    1
                                    2
                                 
                                 log
                                 |
                                 I
                                 
                                    
                                       Θ
                                       M
                                    
                                 
                                 |
                                 −
                                 logp
                                 
                                    
                                       X
                                       |
                                       
                                          θ
                                          M
                                       
                                    
                                 
                              
                           
                        
                     

where p(θ
                        
                           M
                        ), I(Θ
                        
                           M
                        ), and 
                           p
                           
                              
                                 X
                                 |
                                 
                                    θ
                                    M
                                 
                              
                           
                         denote the prior distribution, the Fisher information matrix, and the likelihood, respectively. The constant c
                        =
                        M
                        +
                        D
                        +3DM
                        +2D represents the total number of parameters, and |.| denotes the determinant. Note that the information matrix of the model is very difficult to obtained analytically, therefore, we assume the independence of the different groups of parameters, which allows the factorization of both p(θ
                        
                           M
                        ) and |I(Θ
                        
                           M
                        )|. Furthermore, we approximate the Fisher information |I(Θ
                        
                           M
                        )| using the complete likelihood which assumes labeled observations. Additionally, since we have no knowledge about the parameters, we adopt the uninformative Jeffrey's prior for each group of parameters as prior distribution. From this, we obtain the following objective:
                           
                              (17)
                              
                                 
                                    
                                       
                                          MessLens
                                          ≈
                                          
                                             c
                                             2
                                          
                                          
                                             
                                                1
                                                +
                                                log
                                                
                                                   1
                                                   12
                                                
                                             
                                          
                                          +
                                          
                                             c
                                             2
                                          
                                          
                                             logN
                                          
                                          +
                                          
                                             
                                                3
                                                M
                                             
                                             2
                                          
                                          
                                             
                                                ∑
                                                
                                                   d
                                                   =
                                                   1
                                                
                                                D
                                             
                                             
                                          
                                          log
                                          
                                             ω
                                             d
                                          
                                          +
                                          
                                             
                                                3
                                                D
                                             
                                             2
                                          
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                M
                                             
                                             
                                          
                                          log
                                          
                                             p
                                             j
                                          
                                       
                                    
                                    
                                       
                                          
                                          +
                                          
                                             
                                                ∑
                                                
                                                   d
                                                   =
                                                   1
                                                
                                                D
                                             
                                             
                                          
                                          log
                                          
                                             
                                                1
                                                −
                                                
                                                   ω
                                                   d
                                                
                                             
                                          
                                          −
                                          logp
                                          
                                             
                                                X
                                                |
                                                
                                                   θ
                                                   M
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        which we minimize under the constraints 0<
                        p
                        
                           j
                        
                        ≤1, 0<
                        ω
                        
                           d
                        
                        ≤1, and ∑
                           j
                           =1
                        
                           M
                        
                        p
                        
                           j
                        
                        =1 in a manner similar to the one followed in Ref. [26]. In order to use the MML approached the EM algorithm undergoes a minor modification in the calculation of the mixing proportions pj
                         and the feature relevancy ωd
                        :
                           
                              (18)
                              
                                 
                                    p
                                    j
                                    new
                                 
                                 =
                                 
                                    
                                       max
                                       
                                          
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                N
                                             
                                             
                                                h
                                                
                                                   
                                                      j
                                                      |
                                                      
                                                         
                                                            X
                                                            →
                                                         
                                                         i
                                                      
                                                      ,
                                                      
                                                         Θ
                                                         M
                                                      
                                                   
                                                
                                                −
                                                
                                                   
                                                      3
                                                      D
                                                   
                                                   2
                                                
                                                ,
                                                0
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                j
                                                =
                                                1
                                             
                                             M
                                          
                                          
                                             max
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                N
                                             
                                             
                                                h
                                                
                                                   
                                                      j
                                                      |
                                                      
                                                         
                                                            X
                                                            →
                                                         
                                                         i
                                                      
                                                      ,
                                                      
                                                         Θ
                                                         M
                                                      
                                                   
                                                
                                                −
                                                
                                                   
                                                      3
                                                      D
                                                   
                                                   2
                                                
                                                ,
                                                0
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (19)
                              
                                 
                                    ω
                                    d
                                    new
                                 
                                 =
                                 
                                    
                                       max
                                       
                                          
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                N
                                             
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         j
                                                         =
                                                         1
                                                      
                                                      M
                                                   
                                                   
                                                      
                                                         a
                                                         
                                                            i
                                                            j
                                                            d
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            3
                                                            M
                                                         
                                                         2
                                                      
                                                      ,
                                                      0
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       max
                                       
                                          
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                N
                                             
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         j
                                                         =
                                                         1
                                                      
                                                      M
                                                   
                                                   
                                                      
                                                         a
                                                         
                                                            i
                                                            j
                                                            d
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            3
                                                            M
                                                         
                                                         2
                                                      
                                                      ,
                                                      0
                                                   
                                                
                                             
                                          
                                       
                                       +
                                       max
                                       
                                          
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                N
                                             
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         j
                                                         =
                                                         1
                                                      
                                                      M
                                                   
                                                   
                                                      
                                                         b
                                                         
                                                            i
                                                            j
                                                            d
                                                         
                                                      
                                                      −
                                                      1
                                                      ,
                                                      0
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where
                           
                              (20)
                              
                                 
                                    a
                                    
                                       i
                                       j
                                       d
                                    
                                 
                                 =
                                 h
                                 
                                    
                                       j
                                       |
                                       
                                          
                                             X
                                             →
                                          
                                          i
                                       
                                       ,
                                       
                                          Θ
                                          M
                                       
                                    
                                 
                                 
                                    
                                       
                                          ω
                                          d
                                       
                                       p
                                       
                                          
                                             
                                                X
                                                id
                                             
                                             |
                                             
                                                ξ
                                                
                                                   j
                                                   d
                                                
                                             
                                          
                                       
                                    
                                    
                                       ζ
                                       
                                          i
                                          j
                                          d
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (21)
                              
                                 
                                    b
                                    
                                       i
                                       j
                                       d
                                    
                                 
                                 =
                                 h
                                 
                                    
                                       j
                                       |
                                       
                                          
                                             X
                                             →
                                          
                                          i
                                       
                                       ,
                                       
                                          Θ
                                          M
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             1
                                             −
                                             
                                                ω
                                                d
                                             
                                          
                                       
                                       p
                                       
                                          
                                             
                                                X
                                                id
                                             
                                             |
                                             
                                                λ
                                                d
                                             
                                          
                                       
                                    
                                    
                                       ζ
                                       
                                          i
                                          j
                                          d
                                       
                                    
                                 
                              
                           
                        
                     

The following script summarizes the main steps of the algorithm used for the AGM parameters estimation and model selection
                           
                              1.
                              Initialize Θ
                                 
                                    M
                                 :
                                    
                                       •
                                       The feature relevancy is set to ωd
                                          
                                          =0.5.

The number of parameters M
                                          =
                                          Mmax
                                          
                                          =10.

The AGM parameters Θ are initialized using the Fuzzy C-means. Note that, we initialized both the left and right standard deviations with the standard deviation values obtained from the Fuzzy C-means.

Perform the common Gaussian density 
                                             
                                                λ
                                                →
                                             
                                           parameters estimation to cover the whole data.

Implement the EM+MML approach


                                 While 
                                 M
                                 <
                                 Mmax
                                  
                                 do {
                                 
                                    
                                       (a)
                                       
                                          While not converged do {
                                          
                                             
                                                i.
                                                Perform E-Step according to Eq. (8)
                                                

Perform M-Step according to Eqs. (10) to (14), (18) and (19).


                                                   If 
                                                   pj
                                                   
                                                   =0, Then the jth
                                                    component is eliminated.


                                                   If 
                                                   ωd
                                                   
                                                   =0, Then the (X
                                                   
                                                      id
                                                   |ξ
                                                   
                                                      jd
                                                   ) is eliminated.


                                                   If 
                                                   ωd
                                                   
                                                   =1, Then the p(X
                                                   
                                                      id
                                                   |λ
                                                   
                                                      d
                                                   ) is eliminated.


                                                   }End While
                                                

Calculate the associated message length Eq. (17).

Remove the component j with smallest pj
                                          .


                                          }End While
                                       

Return the model parameters with the smallest message length.

The main learning purpose is to estimate the parameters Θ
                     
                        M
                      from N observations, denoted as 
                        X
                        =
                        
                           
                              
                                 X
                                 →
                              
                              1
                           
                           …
                           
                              
                                 X
                                 →
                              
                              N
                           
                        
                     . Then, the rival penalized EM (RPEM) algorithm [20,30] is developed from the maximum weighted likelihood framework via maximizing the following weighted likelihood:
                        
                           (22)
                           
                              Q
                              
                                 
                                    Θ
                                    M
                                 
                                 X
                              
                              =
                              
                                 1
                                 N
                              
                              
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    N
                                 
                                 
                              
                              ℳ
                              
                                 
                                    Θ
                                    M
                                 
                                 
                                    
                                       X
                                       →
                                    
                                    i
                                 
                              
                           
                        
                     with
                        
                           
                              M
                              
                                 
                                    Θ
                                    M
                                 
                                 
                                    
                                       X
                                       →
                                    
                                    i
                                 
                              
                              =
                              
                                 
                                    ∑
                                    
                                       j
                                       =
                                       1
                                    
                                    M
                                 
                                 
                              
                              g
                              
                                 
                                    j
                                    |
                                    
                                       
                                          X
                                          →
                                       
                                       i
                                    
                                    ,
                                    
                                       Θ
                                       M
                                    
                                 
                              
                              ln
                              
                                 
                                    
                                       p
                                       j
                                    
                                    
                                       
                                          ∏
                                          
                                             d
                                             =
                                             1
                                          
                                          D
                                       
                                       
                                    
                                    
                                       
                                          
                                             ω
                                             d
                                          
                                          p
                                          
                                             
                                                
                                                   X
                                                   id
                                                
                                                |
                                                
                                                   ξ
                                                   
                                                      j
                                                      d
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                1
                                                −
                                                
                                                   ω
                                                   d
                                                
                                             
                                          
                                          p
                                          
                                             
                                                
                                                   X
                                                   id
                                                
                                                |
                                                
                                                   λ
                                                   d
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              −
                              
                                 
                                    ∑
                                    
                                       j
                                       =
                                       1
                                    
                                    M
                                 
                                 
                              
                              g
                              
                                 
                                    j
                                    |
                                    
                                       
                                          X
                                          →
                                       
                                       i
                                    
                                    ,
                                    
                                       Θ
                                       M
                                    
                                 
                              
                              l
                              n
                              h
                              
                                 
                                    j
                                    |
                                    
                                       
                                          X
                                          →
                                       
                                       i
                                    
                                    ,
                                    
                                       Θ
                                       M
                                    
                                 
                              
                           
                        
                     
                  

where 
                        g
                        
                           
                              j
                              |
                              
                                 
                                    X
                                    →
                                 
                                 i
                              
                              ,
                              
                                 Θ
                                 M
                              
                           
                        
                      is a designable weight, which can embody the model selection in the learning process, satisfying the two constraints: 
                        
                           
                              ∑
                              
                                 j
                                 =
                                 1
                              
                              M
                           
                           
                        
                        g
                        
                           
                              j
                              |
                              
                                 
                                    X
                                    →
                                 
                                 i
                              
                              ,
                              
                                 Θ
                                 M
                              
                           
                        
                        =
                        1
                      and 
                        ∀
                        j
                        
                        g
                        
                           
                              j
                              |
                              
                                 
                                    X
                                    →
                                 
                                 i
                              
                              ,
                              
                                 Θ
                                 M
                              
                           
                        
                        =
                        0
                      if 
                        h
                        
                           
                              j
                              |
                              
                                 
                                    X
                                    →
                                 
                                 i
                              
                              ,
                              
                                 Θ
                                 M
                              
                           
                        
                        =
                        0
                     . Thus, the weight 
                        g
                        
                           
                              j
                              |
                              
                                 
                                    X
                                    →
                                 
                                 i
                              
                              ,
                              
                                 Θ
                                 M
                              
                           
                        
                      can be expressed by:
                        
                           (23)
                           
                              g
                              
                                 
                                    j
                                    |
                                    
                                       
                                          X
                                          →
                                       
                                       i
                                    
                                    ,
                                    
                                       Θ
                                       M
                                    
                                 
                              
                              =
                              
                                 
                                    1
                                    +
                                    ε
                                 
                              
                              I
                              
                                 
                                    j
                                    |
                                    
                                       
                                          X
                                          →
                                       
                                       i
                                    
                                    ,
                                    
                                       Θ
                                       M
                                    
                                 
                              
                              −
                              ε
                              h
                              
                                 
                                    j
                                    |
                                    
                                       
                                          X
                                          →
                                       
                                       i
                                    
                                    ,
                                    
                                       Θ
                                       M
                                    
                                 
                              
                           
                        
                     where ε is a small positive quantity which we took as 1. Moreover,
                        
                           (24)
                           
                              I
                              
                                 
                                    j
                                    |
                                    
                                       
                                          X
                                          →
                                       
                                       i
                                    
                                    ,
                                    
                                       Θ
                                       M
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          1
                                       
                                       
                                          if
                                          
                                          j
                                          =
                                          c
                                       
                                    
                                    
                                       
                                          0
                                       
                                       
                                          if
                                          
                                          j
                                          ≠
                                          c
                                       
                                    
                                 
                              
                           
                        
                     and 
                        c
                        =
                        arg
                        
                        m
                        a
                        
                           x
                           
                              
                                 1
                                 ≤
                                 j
                                 ≤
                                 M
                              
                           
                        
                        
                        h
                        
                           
                              j
                              |
                              
                                 
                                    X
                                    →
                                 
                                 i
                              
                              ,
                              
                                 Θ
                                 M
                              
                           
                        
                     . Thus, the feature weighted RPEM (FW-RPEM) algorithm for the AGM can be implemented in the following steps:
                        
                           1.
                           Initialize Θ
                              
                                 M
                              :
                                 
                                    •
                                    The feature relevancy is set to ωd
                                       
                                       =0.5.

The number of parameters M
                                       =
                                       Mmax
                                       
                                       =10.

The AGM parameters Θ are initialized using the Fuzzy C-means algorithm. Note that, we initialized both the left and right standard deviations with the standard deviation values obtained from the Fuzzy C-means.

Perform the common Gaussian density 
                                 
                                    λ
                                    →
                                 
                               parameters estimation:
                                 
                                    (25)
                                    
                                       
                                          η
                                          d
                                       
                                       =
                                       
                                          1
                                          N
                                       
                                       
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             N
                                          
                                          
                                       
                                       
                                          X
                                          id
                                       
                                    
                                 
                              
                              
                                 
                                    (26)
                                    
                                       
                                          δ
                                          d
                                          2
                                       
                                       =
                                       
                                          1
                                          N
                                       
                                       
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             N
                                          
                                          
                                       
                                       
                                          
                                             
                                                
                                                   X
                                                   id
                                                
                                                −
                                                
                                                   η
                                                   d
                                                
                                             
                                          
                                          2
                                       
                                    
                                 
                              
                           

Repeated until convergence for each 
                                 
                                    
                                       X
                                       →
                                    
                                    i
                                 
                                 ,
                                 i
                                 =
                                 
                                    
                                       1
                                       ,
                                       …
                                       N
                                    
                                 
                              
                              
                                 
                                    •
                                    Expectation step
                                          
                                             (27)
                                             
                                                
                                                   
                                                      
                                                         h
                                                         
                                                            
                                                               j
                                                               |
                                                               
                                                                  
                                                                     X
                                                                     →
                                                                  
                                                                  i
                                                               
                                                               ,
                                                               
                                                                  Θ
                                                                  M
                                                               
                                                            
                                                         
                                                         =
                                                         
                                                            
                                                               
                                                                  p
                                                                  j
                                                               
                                                               
                                                                  
                                                                     ∏
                                                                     
                                                                        d
                                                                        =
                                                                        1
                                                                     
                                                                     D
                                                                  
                                                                  
                                                                     
                                                                        ζ
                                                                        
                                                                           i
                                                                           j
                                                                           d
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     ∑
                                                                     
                                                                        j
                                                                        =
                                                                        1
                                                                     
                                                                     M
                                                                  
                                                                  
                                                                     
                                                                        p
                                                                        j
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     ∏
                                                                     
                                                                        d
                                                                        =
                                                                        1
                                                                     
                                                                     D
                                                                  
                                                                  
                                                                     
                                                                        ζ
                                                                        
                                                                           i
                                                                           j
                                                                           d
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         g
                                                         
                                                            
                                                               j
                                                               |
                                                               
                                                                  
                                                                     X
                                                                     →
                                                                  
                                                                  i
                                                               
                                                               ,
                                                               
                                                                  Θ
                                                                  M
                                                               
                                                            
                                                         
                                                         =
                                                         
                                                            
                                                               
                                                                  
                                                                     2
                                                                     −
                                                                     h
                                                                     
                                                                        
                                                                           j
                                                                           |
                                                                           
                                                                              
                                                                                 X
                                                                                 →
                                                                              
                                                                              i
                                                                           
                                                                           ,
                                                                           
                                                                              Θ
                                                                              M
                                                                           
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     if
                                                                     
                                                                     j
                                                                     =
                                                                     c
                                                                  
                                                               
                                                               
                                                                  
                                                                     −
                                                                     h
                                                                     
                                                                        
                                                                           j
                                                                           |
                                                                           
                                                                              
                                                                                 X
                                                                                 →
                                                                              
                                                                              i
                                                                           
                                                                           ,
                                                                           
                                                                              Θ
                                                                              M
                                                                           
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     if
                                                                     
                                                                     j
                                                                     ≠
                                                                     c
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    

Maximization step
                                          
                                             (28)
                                             
                                                
                                                   β
                                                   j
                                                   new
                                                
                                                =
                                                
                                                   β
                                                   j
                                                   old
                                                
                                                +
                                                
                                                   γ
                                                   β
                                                
                                                
                                                   
                                                      ∂
                                                      M
                                                      
                                                         
                                                            Θ
                                                            M
                                                         
                                                         
                                                            
                                                               X
                                                               →
                                                            
                                                            i
                                                         
                                                      
                                                   
                                                   
                                                      ∂
                                                      
                                                         β
                                                         j
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                         
                                                            Θ
                                                            M
                                                            old
                                                         
                                                      
                                                      =
                                                      
                                                         β
                                                         j
                                                         old
                                                      
                                                      +
                                                      
                                                         γ
                                                         β
                                                      
                                                      
                                                         
                                                            g
                                                            
                                                               
                                                                  j
                                                                  |
                                                                  
                                                                     
                                                                        X
                                                                        →
                                                                     
                                                                     i
                                                                  
                                                                  ,
                                                                  
                                                                     Θ
                                                                     M
                                                                  
                                                               
                                                            
                                                            −
                                                            
                                                               p
                                                               j
                                                               old
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             (29)
                                             
                                                
                                                   μ
                                                   
                                                      j
                                                      d
                                                   
                                                   new
                                                
                                                =
                                                
                                                   μ
                                                   
                                                      j
                                                      d
                                                   
                                                   old
                                                
                                                +
                                                γ
                                                
                                                   
                                                      ∂
                                                      M
                                                      
                                                         
                                                            Θ
                                                            M
                                                         
                                                         
                                                            
                                                               X
                                                               →
                                                            
                                                            i
                                                         
                                                      
                                                   
                                                   
                                                      ∂
                                                      
                                                         μ
                                                         
                                                            j
                                                            d
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                         
                                                            
                                                            
                                                               Θ
                                                               M
                                                               old
                                                            
                                                         
                                                      
                                                      =
                                                      
                                                         μ
                                                         
                                                            j
                                                            d
                                                         
                                                         old
                                                      
                                                      +
                                                      γ
                                                      g
                                                      
                                                         
                                                            j
                                                            |
                                                            
                                                               
                                                                  X
                                                                  →
                                                               
                                                               i
                                                            
                                                            ,
                                                            
                                                               Θ
                                                               M
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      ω
                                                      d
                                                      old
                                                   
                                                   
                                                      ζ
                                                      
                                                         i
                                                         j
                                                         d
                                                      
                                                   
                                                
                                                
                                                   
                                                      ∂
                                                      p
                                                      
                                                         
                                                            
                                                               X
                                                               id
                                                            
                                                            |
                                                            
                                                               ξ
                                                               
                                                                  j
                                                                  d
                                                               
                                                               old
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      ∂
                                                      
                                                         μ
                                                         
                                                            j
                                                            d
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             (30)
                                             
                                                
                                                   S
                                                   
                                                      l
                                                      
                                                         j
                                                         d
                                                      
                                                   
                                                   new
                                                
                                                =
                                                
                                                   S
                                                   
                                                      l
                                                      
                                                         j
                                                         d
                                                      
                                                   
                                                   old
                                                
                                                +
                                                γ
                                                
                                                   
                                                      ∂
                                                      M
                                                      
                                                         
                                                            Θ
                                                            M
                                                         
                                                         
                                                            
                                                               X
                                                               →
                                                            
                                                            i
                                                         
                                                      
                                                   
                                                   
                                                      ∂
                                                      
                                                         S
                                                         
                                                            l
                                                            
                                                               j
                                                               d
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                         
                                                            Θ
                                                            M
                                                            old
                                                         
                                                      
                                                      =
                                                      
                                                         S
                                                         
                                                            l
                                                            
                                                               j
                                                               d
                                                            
                                                         
                                                         old
                                                      
                                                      +
                                                      γ
                                                      g
                                                      
                                                         
                                                            j
                                                            |
                                                            
                                                               
                                                                  X
                                                                  →
                                                               
                                                               i
                                                            
                                                            ,
                                                            
                                                               Θ
                                                               M
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      ω
                                                      d
                                                      old
                                                   
                                                   
                                                      ζ
                                                      
                                                         i
                                                         j
                                                         d
                                                      
                                                   
                                                
                                                
                                                   
                                                      ∂
                                                      p
                                                      
                                                         
                                                            
                                                               X
                                                               id
                                                            
                                                            |
                                                            
                                                               ξ
                                                               
                                                                  j
                                                                  d
                                                               
                                                               old
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      ∂
                                                      
                                                         S
                                                         
                                                            l
                                                            
                                                               j
                                                               d
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             (31)
                                             
                                                
                                                   S
                                                   
                                                      r
                                                      
                                                         j
                                                         d
                                                      
                                                   
                                                   new
                                                
                                                =
                                                
                                                   S
                                                   
                                                      r
                                                      
                                                         j
                                                         d
                                                      
                                                   
                                                   old
                                                
                                                +
                                                γ
                                                
                                                   
                                                      ∂
                                                      M
                                                      
                                                         
                                                            Θ
                                                            M
                                                         
                                                         
                                                            
                                                               X
                                                               →
                                                            
                                                            i
                                                         
                                                      
                                                   
                                                   
                                                      ∂
                                                      
                                                         S
                                                         
                                                            r
                                                            
                                                               j
                                                               d
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                         
                                                            
                                                            
                                                               Θ
                                                               M
                                                               old
                                                            
                                                         
                                                      
                                                      =
                                                      
                                                         S
                                                         
                                                            r
                                                            
                                                               j
                                                               d
                                                            
                                                         
                                                         old
                                                      
                                                      +
                                                      γ
                                                      g
                                                      
                                                         
                                                            j
                                                            |
                                                            
                                                               
                                                                  X
                                                                  →
                                                               
                                                               i
                                                            
                                                            ,
                                                            
                                                               Θ
                                                               M
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      ω
                                                      d
                                                      old
                                                   
                                                   
                                                      ζ
                                                      
                                                         i
                                                         j
                                                         d
                                                      
                                                   
                                                
                                                
                                                   
                                                      ∂
                                                      p
                                                      
                                                         
                                                            
                                                               X
                                                               id
                                                            
                                                            |
                                                            
                                                               ξ
                                                               
                                                                  j
                                                                  d
                                                               
                                                               old
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      ∂
                                                      
                                                         S
                                                         
                                                            r
                                                            
                                                               j
                                                               d
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             (32)
                                             
                                                
                                                   
                                                      
                                                         
                                                            ω
                                                            d
                                                            new
                                                         
                                                         =
                                                         
                                                            ω
                                                            d
                                                            old
                                                         
                                                         +
                                                         
                                                            γ
                                                            ω
                                                         
                                                         
                                                            
                                                               ∂
                                                               M
                                                               
                                                                  
                                                                     Θ
                                                                     M
                                                                  
                                                                  
                                                                     
                                                                        X
                                                                        →
                                                                     
                                                                     i
                                                                  
                                                               
                                                            
                                                            
                                                               ∂
                                                               
                                                                  ω
                                                                  d
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                  
                                                                     
                                                                     
                                                                        Θ
                                                                        M
                                                                        old
                                                                     
                                                                  
                                                               
                                                               =
                                                               
                                                                  ω
                                                                  d
                                                                  old
                                                               
                                                               +
                                                               
                                                                  γ
                                                                  ω
                                                               
                                                               
                                                                  
                                                                     ∑
                                                                     
                                                                        j
                                                                        =
                                                                        1
                                                                     
                                                                     M
                                                                  
                                                                  
                                                               
                                                               g
                                                               
                                                                  
                                                                     j
                                                                     |
                                                                     
                                                                        
                                                                           X
                                                                           →
                                                                        
                                                                        i
                                                                     
                                                                     ,
                                                                     
                                                                        Θ
                                                                        M
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               υ
                                                               
                                                                  i
                                                                  j
                                                                  d
                                                               
                                                            
                                                            
                                                               ζ
                                                               
                                                                  i
                                                                  j
                                                                  d
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  if
                                                               
                                                               
                                                                  
                                                                     ω
                                                                     d
                                                                  
                                                                  >
                                                                  1
                                                               
                                                               
                                                                  then
                                                               
                                                               
                                                                  
                                                                     ω
                                                                     d
                                                                  
                                                                  =
                                                                  1
                                                               
                                                            
                                                            
                                                               
                                                                  if
                                                               
                                                               
                                                                  
                                                                     ω
                                                                     d
                                                                  
                                                                  <
                                                                  0
                                                               
                                                               
                                                                  then
                                                               
                                                               
                                                                  
                                                                     ω
                                                                     d
                                                                  
                                                                  =
                                                                  0
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    

where
                                          
                                             (33)
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ∂
                                                               p
                                                               
                                                                  
                                                                     
                                                                        X
                                                                        id
                                                                     
                                                                     |
                                                                     
                                                                        ξ
                                                                        
                                                                           j
                                                                           d
                                                                        
                                                                        old
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               ∂
                                                               
                                                                  μ
                                                                  
                                                                     j
                                                                     d
                                                                  
                                                               
                                                            
                                                         
                                                         =
                                                         p
                                                         
                                                            
                                                               
                                                                  X
                                                                  id
                                                               
                                                               |
                                                               
                                                                  ξ
                                                                  
                                                                     j
                                                                     d
                                                                  
                                                                  old
                                                               
                                                            
                                                         
                                                         
                                                            κ
                                                            
                                                               i
                                                               j
                                                               d
                                                            
                                                         
                                                         ;
                                                      
                                                      
                                                         
                                                            
                                                               ∂
                                                               p
                                                               
                                                                  
                                                                     
                                                                        X
                                                                        id
                                                                     
                                                                     |
                                                                     
                                                                        ξ
                                                                        
                                                                           j
                                                                           d
                                                                        
                                                                        old
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               ∂
                                                               
                                                                  S
                                                                  
                                                                     l
                                                                     
                                                                        j
                                                                        d
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         =
                                                         p
                                                         
                                                            
                                                               
                                                                  X
                                                                  id
                                                               
                                                               |
                                                               
                                                                  ξ
                                                                  
                                                                     j
                                                                     d
                                                                  
                                                                  old
                                                               
                                                            
                                                         
                                                         
                                                            τ
                                                            
                                                               l
                                                               
                                                                  i
                                                                  j
                                                                  d
                                                               
                                                            
                                                         
                                                         ;
                                                      
                                                      
                                                         
                                                            
                                                               ∂
                                                               p
                                                               
                                                                  
                                                                     
                                                                        X
                                                                        id
                                                                     
                                                                     |
                                                                     
                                                                        ξ
                                                                        
                                                                           j
                                                                           d
                                                                        
                                                                        old
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               ∂
                                                               
                                                                  S
                                                                  
                                                                     r
                                                                     
                                                                        j
                                                                        d
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         =
                                                         p
                                                         
                                                            
                                                               
                                                                  X
                                                                  id
                                                               
                                                               |
                                                               
                                                                  ξ
                                                                  
                                                                     j
                                                                     d
                                                                  
                                                                  old
                                                               
                                                            
                                                         
                                                         
                                                            τ
                                                            
                                                               r
                                                               
                                                                  i
                                                                  j
                                                                  d
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             (34)
                                             
                                                
                                                   
                                                      
                                                         
                                                            S
                                                            
                                                               l
                                                               
                                                                  j
                                                                  d
                                                               
                                                            
                                                         
                                                         =
                                                         
                                                            1
                                                            
                                                               σ
                                                               
                                                                  l
                                                                  
                                                                     j
                                                                     d
                                                                  
                                                               
                                                               2
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            S
                                                            
                                                               r
                                                               
                                                                  j
                                                                  d
                                                               
                                                            
                                                         
                                                         =
                                                         
                                                            1
                                                            
                                                               σ
                                                               
                                                                  r
                                                                  
                                                                     j
                                                                     d
                                                                  
                                                               
                                                               2
                                                            
                                                         
                                                         ;
                                                      
                                                      
                                                         
                                                            p
                                                            j
                                                         
                                                         =
                                                         
                                                            
                                                               exp
                                                               
                                                                  
                                                                     β
                                                                     j
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     ∑
                                                                     
                                                                        j
                                                                        =
                                                                        1
                                                                     
                                                                     M
                                                                  
                                                                  
                                                               
                                                               exp
                                                               
                                                                  
                                                                     β
                                                                     j
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         f
                                                         o
                                                         r
                                                      
                                                      
                                                         1
                                                         ≤
                                                         j
                                                         ≤
                                                         M
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             (35)
                                             
                                                
                                                   
                                                      
                                                         
                                                            υ
                                                            
                                                               i
                                                               j
                                                               d
                                                            
                                                         
                                                         =
                                                         p
                                                         
                                                            
                                                               
                                                                  X
                                                                  id
                                                               
                                                               |
                                                               
                                                                  ξ
                                                                  
                                                                     j
                                                                     d
                                                                  
                                                               
                                                            
                                                         
                                                         −
                                                         p
                                                         
                                                            
                                                               
                                                                  X
                                                                  id
                                                               
                                                               |
                                                               
                                                                  λ
                                                                  d
                                                               
                                                            
                                                         
                                                         ;
                                                      
                                                      
                                                         
                                                            κ
                                                            
                                                               i
                                                               j
                                                               d
                                                            
                                                         
                                                         =
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        S
                                                                        
                                                                           l
                                                                           
                                                                              j
                                                                              d
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           
                                                                              X
                                                                              id
                                                                           
                                                                           −
                                                                           
                                                                              μ
                                                                              
                                                                                 j
                                                                                 d
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     if
                                                                     
                                                                     
                                                                        X
                                                                        id
                                                                     
                                                                     <
                                                                     
                                                                        μ
                                                                        
                                                                           j
                                                                           d
                                                                        
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     
                                                                        S
                                                                        
                                                                           r
                                                                           
                                                                              j
                                                                              d
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           
                                                                              X
                                                                              id
                                                                           
                                                                           −
                                                                           
                                                                              μ
                                                                              
                                                                                 j
                                                                                 d
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     if
                                                                     
                                                                     
                                                                        X
                                                                        id
                                                                     
                                                                     ≥
                                                                     
                                                                        μ
                                                                        
                                                                           j
                                                                           d
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             (36)
                                             
                                                
                                                   τ
                                                   
                                                      l
                                                      
                                                         i
                                                         j
                                                         d
                                                      
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                         
                                                            
                                                               1
                                                               2
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        S
                                                                        
                                                                           r
                                                                           
                                                                              j
                                                                              d
                                                                           
                                                                        
                                                                        
                                                                           1
                                                                           /
                                                                           2
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           S
                                                                           
                                                                              l
                                                                              
                                                                                 j
                                                                                 d
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 S
                                                                                 
                                                                                    l
                                                                                    
                                                                                       j
                                                                                       d
                                                                                    
                                                                                 
                                                                                 
                                                                                    1
                                                                                    /
                                                                                    2
                                                                                 
                                                                              
                                                                              +
                                                                              
                                                                                 S
                                                                                 
                                                                                    r
                                                                                    
                                                                                       j
                                                                                       d
                                                                                    
                                                                                 
                                                                                 
                                                                                    1
                                                                                    /
                                                                                    2
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                                  −
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              X
                                                                              id
                                                                           
                                                                           −
                                                                           
                                                                              μ
                                                                              
                                                                                 j
                                                                                 d
                                                                              
                                                                           
                                                                        
                                                                     
                                                                     2
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            if
                                                            
                                                            
                                                               X
                                                               id
                                                            
                                                            <
                                                            
                                                               μ
                                                               
                                                                  j
                                                                  d
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  S
                                                                  
                                                                     r
                                                                     
                                                                        j
                                                                        d
                                                                     
                                                                  
                                                                  
                                                                     1
                                                                     /
                                                                     2
                                                                  
                                                               
                                                               
                                                                  2
                                                                  
                                                                     S
                                                                     
                                                                        l
                                                                        
                                                                           j
                                                                           d
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           S
                                                                           
                                                                              l
                                                                              
                                                                                 j
                                                                                 d
                                                                              
                                                                           
                                                                           
                                                                              1
                                                                              /
                                                                              2
                                                                           
                                                                        
                                                                        +
                                                                        
                                                                           S
                                                                           
                                                                              r
                                                                              
                                                                                 j
                                                                                 d
                                                                              
                                                                           
                                                                           
                                                                              1
                                                                              /
                                                                              2
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            if
                                                            
                                                            
                                                               X
                                                               id
                                                            
                                                            ≥
                                                            
                                                               μ
                                                               
                                                                  j
                                                                  d
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             (37)
                                             
                                                
                                                   τ
                                                   
                                                      r
                                                      
                                                         i
                                                         j
                                                         d
                                                      
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  S
                                                                  
                                                                     l
                                                                     
                                                                        j
                                                                        d
                                                                     
                                                                  
                                                                  
                                                                     1
                                                                     /
                                                                     2
                                                                  
                                                               
                                                               
                                                                  2
                                                                  
                                                                     S
                                                                     
                                                                        r
                                                                        
                                                                           j
                                                                           d
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           S
                                                                           
                                                                              l
                                                                              
                                                                                 j
                                                                                 d
                                                                              
                                                                           
                                                                           
                                                                              1
                                                                              /
                                                                              2
                                                                           
                                                                        
                                                                        +
                                                                        
                                                                           S
                                                                           
                                                                              r
                                                                              
                                                                                 j
                                                                                 d
                                                                              
                                                                           
                                                                           
                                                                              1
                                                                              /
                                                                              2
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            if
                                                            
                                                            
                                                               X
                                                               id
                                                            
                                                            <
                                                            
                                                               μ
                                                               
                                                                  j
                                                                  d
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               1
                                                               2
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        S
                                                                        
                                                                           l
                                                                           
                                                                              j
                                                                              d
                                                                           
                                                                        
                                                                        
                                                                           1
                                                                           /
                                                                           2
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           S
                                                                           
                                                                              r
                                                                              
                                                                                 j
                                                                                 d
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 S
                                                                                 
                                                                                    l
                                                                                    
                                                                                       j
                                                                                       d
                                                                                    
                                                                                 
                                                                                 
                                                                                    1
                                                                                    /
                                                                                    2
                                                                                 
                                                                              
                                                                              +
                                                                              
                                                                                 S
                                                                                 
                                                                                    r
                                                                                    
                                                                                       j
                                                                                       d
                                                                                    
                                                                                 
                                                                                 
                                                                                    1
                                                                                    /
                                                                                    2
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                                  −
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              X
                                                                              id
                                                                           
                                                                           −
                                                                           
                                                                              μ
                                                                              
                                                                                 j
                                                                                 d
                                                                              
                                                                           
                                                                        
                                                                     
                                                                     2
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            if
                                                            
                                                            
                                                               X
                                                               id
                                                            
                                                            ≥
                                                            
                                                               μ
                                                               
                                                                  j
                                                                  d
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    

Note that, we have used the inverse variances (S
                     
                        l
                      and S
                     
                        r
                     ) in order to ensure that the learning of the model standard deviations are more stable. Also, the learning rates γ
                     
                        β
                     , γ, and γ
                     
                        ω
                      are taken as 0.0001, 0.001, and 0.0001, respectively.

@&#EXPERIMENTAL RESULTS@&#

In this section, the effectiveness of the two proposed frameworks for learning the AGM model with feature selection are tested on two real-world applications namely scene categorization and facial expression recognition.

One of the most impressive feats of the human visual system is how rapidly, accurately and comprehensively it can recognize and understand a complex scene [31]. This remarkable ability, known as “visual recognition”, has recently drawn considerable interest and has been successfully applied in various applications such as the automatic understanding of images, object recognition, image database browsing and content-based image annotation, suggestion and retrieval [32–40]. In this section, we build a method for recognizing scene categories by imitating the human perception. Thus, our approach can be divided into three main components: feature extraction, image representation, and scene classification. In feature extraction, we normalize the images then we represent each image by a collection of local image patches. In addition, we scan local image patches and extract their low level feature vectors. Then, we use the bag of visual words (BOW) approach to have an overall representation for each image [41]. The last step in our image representation step is to apply a probabilistic Latent Semantic Analysis (pLSA) to the obtained histograms to represent each image by a D-dimensional vector where D is the number of latent aspects [42]. Our final goal is to classify the overall image to its right group using our AGM model.

The remainder of this section is organized as follows, first we represent some related works for scene classification. Then, we introduce the databases used in this application. Later, we describe the three components of our algorithm. Finally, we evaluate the performance of our algorithm for scene classification.

@&#RELATED WORKS@&#

Classifying images into semantic types of scenes [43–51] is a classical image understanding problem. Automatic techniques for recognizing scenes have an enormous impact for improving the performance of other computer vision applications such as browsing, retrieval and object recognition. However, scenes classification is not an easy task owing to their variability, ambiguity, and the wide range of illumination and scale conditions that may apply. In Ref. [52], the authors presented a stratified approach to both binary (outdoor–indoor) and multiple category of scene classification. Their idea was to learn mixture models for 20 basic classes of local image content based on color and texture information. Then, they applied these models to the test image in order to produce 20 probability density response maps (PDRMs) indicating the likelihood that each image region was produced by each class. Later, they extracted some very simple features from those PDRMs, and used them to train a bagged LDA classifier for 10 scene categories. In Ref. [43], the authors used a simplified low-level feature set to predict multiple semantic scene attributes that are integrated probabilistically to obtain a final indoor/outdoor scene classification. An initial indoor/outdoor prediction is obtained by using support vector machines for classifying computationally efficient, low-dimensional color and wavelet texture features. Furthermore, they used the same low-level features to explicitly predict the presence of semantic features including grass and sky. The semantic scene attributes are then integrated using a Bayesian network designed for improved indoor/outdoor scene classification. In Ref. [53], the authors proposed a hierarchical generative model that classifies the overall scene, recognizes and segments each object component, as well as annotates the image with a list of tags. Visually relevant objects are represented by regions and patches, while visually irrelevant textual annotations are influenced directly by the overall scene class. However, these methods use manually annotated patches which may be time consuming and unpractical. The authors in Ref. [42] proposed the use of pLSA to discover object categories in images using the bag-of-words document representation. Then, they used the nearest neighbor classifier for scenes classification. Our research efforts are focused on extending this last approach in order to construct a robust system capable of classifying images into different scenes.

In this section, we test our approach on two well-known data sets. Our first dataset contains 1579 diverse scene images from 8 categories [53]: rowing (250 images), badminton (200 images), polo (182 images), bocce (137 images), snowboarding (190 images), croquet (236 images), sailing (190 images), and rock climbing (194 images). This data set is very challenging because most images have highly cluttered and diverse background, and object classes are highly diverse. In addition, object sizes and poses are very different in each image. The second data set contains 15 categories of natural scenes [54,55]: highway (260 images), inside of cities (308 images), tall buildings (356 images), streets (292 images), suburb residence (241 images), forest (328 images), coast (360 images), mountain (374 images), open country (410 images), bedroom (174 images), kitchen (151 images), livingroom (289 images), office (216 images), store (315 images), and industrial (311 images). The major sources of the pictures in the data set include the COREL collection, personal photographs, and Google image search. The average size of each image is approximately 250×300pixels. Figs. 1 and 2
                           
                            show example images from the two data sets under consideration.

Representing an image by a collection of local image patches of certain size has become very popular and achieved certain success in visual recognition, image retrieval, scene modeling/categorization, etc., due to its robustness to occlusions, geometric deformations and illumination variations. In addition, the strategy of dense sampling has been shown to provide better performance than interest points for scene classification [54]. Furthermore, SIFT descriptor is robust to illumination, clutter and scale changes. Therefore in this paper we use dense SIFT descriptors of 16×16pixel patches computed over a grid with spacing of 8pixels.

Inspired by the huge success of the bag of words (BOW) method in scenes classification, we decided to employ it in order to represent each image by a feature vector [41]. In order to build the dictionary of the bag of words, also known as codebook, we use a K-means algorithm to cluster our training-set descriptors in a vocabulary of V visual words. Then, for each SIFT point in an input image, the nearest neighbor in the vocabulary is calculated; based on this statistics a V-dimensional feature vector is built collecting the number of points in the image that can be approximated by each of the V visual words. Thus, each image can be represented as a frequency histogram over the V visual words. Then, we apply the pLSA model to the bag of visual words representation which allows the description of each image as a D-dimensional vector, where D is the number of aspects (or learned topics). In order to evaluate the sensitivity of our approaches for the chosen V and D, we have applied our algorithms for various V and D values. From Fig. 3
                           , we notice that the classification accuracy does not change much after using fifty topics because our feature selection approach identified most of the extra features as irrelevant. Therefore, we fixed V and D for the rest of the evaluations to 900 and 50, respectively.

The goal of classification is to estimate the most likely scene class. While classification might be easy for human beings it is very hard for machines. Recently, several classification methods were introduced and most of them fall into two broad classes: deterministic and probabilistic classification. Deterministic approaches classify each image to one of a number of classes. This is done by considering some metric that defines the distance between classes and by defining the class boundaries. On the other hand, the probabilistic method classifies each image by calculating its probabilities of belonging to each class of interest. We believe that a probabilistic classification approach is more suitable because of its robustness to measurement error and its effectiveness in identifying similar characteristics from supervised training images. Therefore, we use our AGM to model the training images of each class. Then, for each input image, we calculate its likelihood of being generated from each class. Finally, we classify each image to the class that maximizes more its likelihood. Fig. 4
                            shows the average number of relevant features for both datasets under consideration when the RPEM and the EM-MML are used for learning the AGM parameters.

For the UIUC sports event data set, we have used a color SIFT descriptor in order to incorporate color information. The only difference between the color SIFT and the regular gray SIFT is the number of input channels (one versus three). Therefore, we represented each image using the HSV (Hue, Saturation, and Value) color space. For each event class, 70 randomly selected images are used for training and 60 are used for testing. Note that, we evaluated the performance of the proposed algorithm by running it 20 times, as well as using the RPEM and the EM
                           +
                           MML for the unsupervised learning of the AGM parameters. The confusion matrices calculated by the AGM
                           +
                           EM
                           +
                           MML and the AGM
                           +
                           RPEM are shown in Tables 1 and 2
                           
                           , respectively. Note that, we found the maximum classification variance under the 20 runs for each category to be 3.33% and 5.00% for the AGM
                           −
                           RPEM and the AGM
                           −
                           EM
                           −
                           MML, respectively.

Moreover, we can notice a lower accuracy for Bocce and Croquet classes. However, we found that both classes have lower classification rates for all the other methods under consideration which is mainly due to the inefficiency of the extracted features to discriminate between these two classes and the rest. Excluding the pre-processing time of feature detection and visual vocabulary formation, it takes about 5 and 7min to train the AGM models on the training images using RPEM and EM-MML, respectively (Matlab implementation on an Intel Core i7-3610QM CPU with 2.3GHz).

For the 15 scene category data set, we are using 100 images per class for training and the rest for testing as suggested in Refs. [54,55]. Note that, we evaluated the performance of the proposed algorithm by running it 20 times, as well as using the RPEM and the EM
                           +
                           MML for the unsupervised learning of the AGM parameters. The confusion matrices calculated by the AGM
                           +
                           EM
                           +
                           MML and the AGM
                           +
                           RPEM are shown in Tables 3 and 4
                           
                           , respectively. Note that, we found the maximum classification variance under the 20 runs for each category to be 1.97% and 2.16% for the AGM
                           −
                           RPEM and the AGM
                           −
                           EM
                           −
                           MML, respectively. Excluding the pre-processing time of feature detection and visual vocabulary formation, it takes about 11 and 13min to train the AGM models on the training images using RPEM and EM-MML, respectively (Matlab implementation on an Intel Core i7-3610QM CPU with 2.3GHz).

In order to evaluate the performance of both of our algorithms, we compare them with a number of state-of-the-art approaches:
                              
                                 •
                                 GMM-EM-MML [26] and GMM-RPEM [30]: We use the same proposed method with the Gaussian mixture model for classification. Note that, we use the EM
                                    +
                                    MML and the RPEM for the unsupervised learning of the GMM parameters in the case of the GMM-EM-MML and GMM-RPEM, respectively.

GIST [56]: A spatial envelope that represents the dominant spatial structure of a scene is proposed then for classification the K nearest neighbors (KNN) classifier is used. It is noteworthy that each image is divided into 16 sub-images or blocks, then, a Gabor filter with 4 scales and 8 orientations is applied to create a 512 feature vector representing the gist of the scene. Finally, Principal Component Analysis (PCA) is used to reduce the feature vector size to 80 and the KNN classifier is used for classification.

Hierarchical [54]: The image is represented by a collection of local regions denoted as codewords using evenly sampled grid spaced at 10×10 then each patch is described by a 128-dimensional SIFT vector. Furthermore, the codebook is learned by performing K-means algorithm. Then, latent dirichlet allocation (LDA) algorithm is used to identify the different themes of the image. Finally, each image is classified to the class having the highest likelihood. Note that, the 20 highest themes for each category were used for classification.

Probabilistic [57]: A probabilistic model for jointly modeling the image, its class label, and its annotations is introduced. For feature extraction 128-dimensional SIFT region descriptors selected by a sliding grid of size 5×5 were used. Then, the k-means algorithm is used to learn a codebook of 240 codewords. Moreover, image annotation is performed by choosing the terms that occurred more than 8 times. Then, two multi-class supervised topic modeling (sLDA) are learned on labeled and annotated images.

SPM [55]: Spatial pyramid matching (SPM) partitions the image into increasingly fine sub-regions, then computes histograms of local features found inside each sub-region. Therefore, it represents an extension of the orderless bag-of-feature image representation. In this method, SIFT descriptors of 16×16pixel patches computed over a grid with spacing 8pixels were used to build a codebook of 400 words. Furthermore, a three level pyramid (three resolutions) is used to count the features that fall in each spatial bin. Finally, a multi-class SVM is used for classification.

BOW [41]: This method is similar to our method except the difference of Gaussian (DoG) detector with SIFT descriptor is used as input for the bag of words method and SVM is applied for classification.

Scene-objects [53]: An integrative model is used to classify events by integrating scene and object categorization. This method assumes that objects and scenes are independent given the event category and that there is no spatial relationship between objects. Furthermore, it extracts as much information as possible by extracting 12×12 patches by a sampling grid of size 10×10. Then, for each of the 200,000 extracted patches, a 128-dim SIFT vector is used to represent it. Then, a codebook of 300 visual words is built by applying K-means on the extracted SIFT vectors. To represent the geometry or layout information each pixel is given one of the three geometry labels namely: ground plane, vertical structure and sky. Note that, each patch is assigned to a geometry membership by the major vote of the pixels within.

MLE-Scene [58] and MM-Scene [58]: This method presents a well-balanced joint latent topic discovery and prediction model estimation. It employs the maximum likelihood estimation (MLE-Scene) and the max-margin learning (MM-Scene) to learn an upstream scene model. Starting from a set of seed points, an algorithm for constructing Voronoi tessellations with respect to a distance defined by the Ultrametric Contour Map (UCM) is used to segment the input images into small regions based on color, brightness and texture homogeneity. For each region, color, texture and location features are extracted and quantized into 120 codewords, respectively. Similarly, the SIFT features extracted from the small patches within each region are quantized into 300 SIFT codewords. Furthermore, GIST features [56] are used in order to have a global representation. Finally, two scene models trained with max-margin and MLE are used for classification.

OB-SVM [59]: The object Bank method represents an image as a scale-invariant response map of a large number of pre-trained generic object detectors and uses the SVM algorithm to classify it. Note that, for this application 200 object detectors at 12 detection scales and 3 spatial pyramid levels were used resulting in an object filter map of 50,400 grids.


                           Table 5
                            shows the average classification rates for the methods under consideration.

From both evaluations, we can conclude that our method with both learning algorithms can achieve good results for the task of scenes categorization. Also, we found that the RPEM approach achieves higher results than the EM-MML.

The interpretation of face images has been the topic of extensive research in the past [60,61]. Indeed, the face is the most important object in the field of human information processing. In particular, it allows the extraction of rich information about human emotion which plays a crucial role in human communications, cognitive processes, neural, social interaction and psychological studies [62–65]. For this reason, facial expression analysis and recognition have been the topic of extensive research (see, for instance, [66–72]) due to the increased demand for emotion analysis, human behavior interpretation, biometrics, and image retrieval to ensure security and safety. The main goal of theses researches is to create a computer system capable of automatically detecting the emotional state of any person. Thus, face expression recognition (FER) is based on applying machine vision and pattern recognition algorithms on both still images and/or image video sequences in order to extract emotional content from visual patterns of a person's face. Despite the progress made in recognizing facial expressions, reliable and accurate automatic FER is still an evolving research subject taking into account the expressiveness of the human face and to the subtlety, complexity and variability of facial expressions [73,74]. In this section we present a novel system for facial expressions recognition that considers both shape and texture information to represent facial emotions. Research has been mainly based on distinguishing between seven kinds of fundamental expressions (Anger, Disgust, Fear, Joy, Sadness, Surprise with the Neutral expression) [75,76]. We are mainly interested in recognizing these seven facial expressions, also. Fig. 5
                         shows a sample image from each of the seven facial expressions.

Normally, any FER system consists of two main components namely pre-processing and processing. In the pre-processing part, detection and location of faces in a cluttered scene are carried out, then a normalization process aiming to align these extracted face images is performed. On the other hand, the processing part aims to extract specific facial features from the pre-processed output images, then, uses them to recognize different facial expressions. Thus, our algorithm can be divided into three main parts: face detection and normalization, feature selection, and facial expression recognition.

Face acquisition, the first part of any FER system, is concerned with identifying and locating human faces under realistic environment regardless of their positions, scales, orientations, poses, and illumination. In [77], the authors used a retinally connected neural network to examine small windows of an image and decide whether each window contains a face. The work in Ref. [78] presented a novel approach for face detection with the use of support vector machines (SVM). In this section, we use the method introduced in [79] for its small computational time and high detection accuracy. The method can be summarized in the following algorithm:
                              
                                 1.
                                 Get the integral image, where the integral image at location (x, y) contains the sum of the pixels above and to the left of (x, y).

Compute the rectangle features (Haar features) using the integral image from step (1).

Use AdaBoost learning to select a small number of critical visual features.

Apply a cascade of weak classifiers for the final face detection.

Note that in step (2) the three rectangular features used are: 1 — Two-rectangle feature which computes the difference between the sum of the pixels within two rectangular regions, 2 — Three-rectangle feature which calculates the sum within two outside rectangles subtracted from the sum in a center rectangle, and 3 — Four-rectangle feature which computes the difference between diagonal pairs of rectangles. The importance of these features is that they can be evaluated at any scale and location in a few operations. Using the above method we can easily and accurately identify all faces in the input image data set, as shown in Fig. 6
                           . Then, we normalize all faces detected to 140×106 for all images.

In order to decrease the dimensionality of the detected faces, they are usually represented in terms of low-level feature vectors in lower dimensional feature space [80,81]. Extracting facial feature is an important step and essential requirement in automated facial expression recognition and has been widely studied in the literature [82–88,75,89]. The extracted features affect generally the capability of recognition methods. In facial feature extraction for expression analysis, there are two common approaches: geometric feature-based methods and appearance-based methods. Geometric facial feature approaches extract the shape and locations of facial components (such as mouth, eyes, or nose) to form a feature vector that represents the face geometry. In Ref. [90], the authors have implemented a geometric feature-based method and applied it for facial expression recognition. However, geometric feature-based methods require accurate and reliable facial feature detection and tracking, which is hard to accommodate in many situations. Appearance-based methods apply image filters to either the whole face or specific regions in a face image to extract a feature vector [91,92]. However, appearance-based methods usually convolve face images with a bank of Gabor filters to extract multi-scale and multi-orientational coefficients, which is time and memory intensive. In this work, we use local binary pattern (LBP) features introduced for texture analysis [93,94] due to their tolerance against illumination changes and their computational simplicity. The main idea was to label the pixels of an image by thresholding the 3×3-neighbourhood of each pixel with the center value and considering the result as a binary number, then, the histogram of the labels can be used as a texture descriptor. Fig. 7
                            shows an illustration of the basic LBP operator.

Later the operator was extended to use uniform patterns which are LBP that contain at most two bitwise transitions from 0 to 1 or vice versa. For example 00000000, 00010000, and 01000100 are considered uniform patterns. The advantage of using uniform patterns is that uniform patterns account for a bit less than 90% of all patterns while can be represented by only 59 bins [94]. Hence, using only uniform patterns and labeling all remaining patterns with a single label can decrease our feature vectors greatly. The only disadvantage of using the LBP histograms is that it only encodes the occurrences of the micro-patterns without any indication about their locations. In order to overcome this issue, we divided the face image into 48 regions, each of 17×17pixels as shown in Fig. 8
                           . It is known that useful information for expression classification lie in regions such as eye and mouth regions. Thus, we are only interested with the LBP for these regions as illustrated in Fig. 8.

In order to differentiate between different facial expressions, various machine learning methods were introduced to perform facial expression recognition using facial features such as support vector machine (SVM), linear discriminant analysis (LDA), and linear programming technique (see, for instance, [95–97]). In this section, we will use our AGM model for this purpose. Our idea is to use training data from the seven expressions to build a classifier. Thus, we group all the training images coming from the same class together, then apply the face recognition and feature selection methods in order to represent each image in the training set by 14 LBP histograms. Then, we grouped all the LBP histograms coming from the same region for each emotion together and modeled them with the AGM. Note that, we used 14 AGMs for each emotion (an AGM per region). Then, in the classification stage, we use the majority vote to classify the data into the right facial expression.

@&#RESULTS@&#

In order to evaluate our approach we have used the Cohn–Kanade database [98] because it is one of the most widely used test-beds for facial expression algorithm development and evaluation. This database consists of 97 university students between the ages of 18 and 50years, of which 69% are female, 13% are African-American, 81% are Euro-American, and 6% are from other groups. Subjects were instructed to perform a series of 23 facial displays, six of which were based on description of prototypic emotions, where each display began and ended with a neutral face. In addition, image sequences were digitized into 640×490pixel arrays with 8-bit precision for grayscale values.

For our experiments, we selected 320 image sequences where each comes from one of the six basic emotions. The sequences come from 96 subjects, with 1–6 emotions per subject. For each sequence, the neutral face and three peak frames were used for expression recognition, resulting in 1280 images (108 Anger, 120 Disgust, 99 Fear, 282 Joy, 126 Sadness, 225 Surprise and 320 Neutral). To evaluate the performance of our algorithms (RPEM and EM
                           +
                           MML) we adopted a 10 cross validation testing scheme repeated for 10 times in our experiments. The confusion matrices for the Cohn–Kanade data set for our algorithms are shown in Tables 6 and 7
                           
                           .

Note that, we found the maximum classification variance under the 10 runs for each category to be 1.56% and 1.42% for the AGM
                           −
                           RPEM and the AGM
                           −
                           EM
                           −
                           MML, respectively. Furthermore, the time complexity of our approaches, excluding pre-processing time of feature detection, takes about 14 and 17min to train the AGM models on the training images using RPEM and EM-MML, respectively (Matlab implementation on an Intel Core i7-3610QM CPU with 2.3GHz). In order to evaluate the performance of both of our algorithms, we compare them with a number of state-of-the-art approaches:
                              
                                 •
                                 GMM-EM-MML [26] and GMM-RPEM [30]: We use the same proposed method with the Gaussian mixture model for classification. Note that, we use the EM
                                    +
                                    MML and the RPEM for the unsupervised learning of the GMM parameters for the GMM-EM-MML and GMM-RPEM, respectively.

TAN [90]: A tree-augmented naive-Bayes classifier is trained on some geometric facial features (eyebrows, eyelids and mouth).

LBP-χ
                                    2, LBP-SVM, LBP-PolySVM, LBP-RBFSVM, and LBP-LP [72,99]: First, each face image is divided into 42 (6×7) regions of 18×21pixels each. Then, the extended LBP features are extracted from each region. Finally, the χ
                                    2 is used for template matching in the case of LBP-χ
                                    2. On the other hand, linear SVM, polynomial SVM, SVM with Radial Basis Function (RBF) kernel, and linear programming technique are used for classification in the case of the LBP-SVM, LBP-PolySVM, LBP-RBFSVM, and LBP-LP, respectively.

GW-SVM, GW-PolySVM, and GW-RBFSVM [91,92]: The facial images were converted into a Gabor magnitude representation using a bank of 40 Gabor filters. Then, linear SVM, polynomial SVM, and SVM with Radial Basis Function (RBF) kernel are used for classification in the case of the GW-SVM, GW-PolySVM, and GW-RBFSVM, respectively.

PCA-LDA-NN, and PCA-LDA-SVM [80,81]: The training faces are first projected into a PCA subspace to have a number of eigenvectors that ranges from 405-431. Then, an LDA is trained to recognize different expressions. Finally, a nearest neighbor classifier or support vector machine (SVM) classifier is used for classification in the case of PCA-LDA-NN, and PCA-LDA-SVM, respectively.


                           Table 8
                            shows the average classification rates for the methods under consideration. From both evaluations, we can conclude that our method with both learning algorithms can achieve good results for the task of facial expression recognition. Also, we found that the RPEM approach achieves slightly higher results than the EM-MML for the asymmetric Gaussian mixture.

@&#CONCLUSION@&#

Four of the critical issues that arise when clustering and modeling objects using finite mixtures are: (1) determination of what features best discriminate among the different clusters, (2) choice of the probability density functions, (3) estimation of the mixture parameters and (4) automatic determination of the number of mixture components. Toward objects clustering goal, we have proposed in this paper two unified statistical learning frameworks based on finite AGM models that tackle all these problems simultaneously. The first learning algorithm is based on the optimization of a message length objective and the second one learns the AGM model via an RPEM technique which allows simultaneous parameters estimation and model selection. Also, for both algorithms, we tackled the problem of noisy and uninformative features by determining a set of relevant features for each data cluster. The merits of the proposed work have been shown through a complicated computer vision application, involving high-dimensional feature vectors and large number of classes, namely scenes categorization. Moreover, we have tackled an important research topic in computer vision which is determining the emotional state of the face regardless of its identity. We have focused on the recognition of some basic expressions. From experimental results, we can observe the higher accuracy of the AGM model when compared to the GMM. Having an extra parameter, the AGM was able to increase the GMM accuracy by 3% and 4% for facial expression recognition and scene categorization, respectively. This is due to its asymmetrical property and its ability to model different shapes which represents a good choice for high dimensional data. Future works could be devoted to the extension of this work for the recognition of other expressions which may have applications in automated behavioral analysis, video conference, human–machine interface, face recognition and animation, and affective computing, etc. Indeed, human emotion is composed of thousands of expressions. Future works could be devoted also to the development of a Bayesian or variational approach to learn the proposed model and its application to other image and signal processing applications.

@&#ACKNOWLEDGMENT@&#

The completion of this research was made possible thanks to the Natural Sciences and Engineering Research Council of Canada (NSERC). The authors would like to thank the anonymous referees and the associate editor for their comments.

@&#REFERENCES@&#

