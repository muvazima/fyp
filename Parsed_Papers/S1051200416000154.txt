@&#MAIN-TITLE@&#Performance of a digital transmitter leakage LMS-based cancellation algorithm for multi-standard radio-frequency transceivers

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We study the performance of a Tx Leakage compensation algorithm.


                        
                        
                           
                           The baseband model is parametrized by a complex gain and a fractional delay.


                        
                        
                           
                           A recursive online joint estimation (complex gain, fractional delay) is proposed.


                        
                        
                           
                           All theoretical asymptotic performance and optimal step formulae are derived.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

FDD transceiver

Radio frequency impairment

Tx leakage

Digital cancellation

Least-mean-square (LMS) algorithm

@&#ABSTRACT@&#


               
               
                  This paper deals with a joint estimation algorithm that is dedicated to digital compensation of transmitter leakage pollution in frequency division duplexing transceivers. These transceivers are affected by transmitter to receiver signal leakage. Combined with the nonlinearity of amplifying components in the receiver path, the baseband signal received can be severely polluted by a baseband polluting term. This term is based on the square modulus of the transmitted signal, and it depends on the equivalent transmitter leakage channel which models leakages and the receiver path. Here, we consider a nonconvolutive, time-varying channel that is modeled by a time-varying complex gain and the presence of a fractional delay, modeling the propagation effects into the receiver. The complex gain is a sum of two components, a constant term that models static effects, and a first-order autoregressive model that approximates the time variation of the transmitter leakage channel. We focus here on a fully digital approach, using digital signal processing techniques and knowledge of the transmitted samples to mitigate the pollution. We first express the asymptotic performance of a transmitter leakage gain estimator piloted by a reference-based least-mean-square (LMS) approach in the synchronized case, and then we derive the influence of the fractional delay. We show that, in practice, the fractional delay cannot be neglected, and we propose a joint estimation of the fractional delay and the transmitter leakage gain to perform digital compensation. The proposed method is adaptive, recursive and online, and it has low complexity. This algorithm, that is developed for a flat transmitter leakage channel case, is seen to be robust in a typical selective channel simulation case, and more suitable than a classic multi-tap LMS scheme proposed in the literature.
               
            

@&#INTRODUCTION@&#

In wireless communication systems, transmission and reception can be based on time division duplexing or on frequency division duplexing (FDD). In the first case, the transmission and the reception are temporally separated, leading to a time slot that is dedicated to transmission and another that is dedicated to reception [2]. However, for a FDD framework which is the case of the study presented here, the transmission and the reception are simultaneous, using two different carrier frequencies [3].

As a common antenna is used for both transmission and reception, a duplexer is used to connect the receiver (Rx) path and the transmitter (Tx) path [4] (see Fig. 1
                     ). In practice, as only an average of 50 dB attenuation can be achieved in the duplexer, the isolation between the Tx path and the Rx path is far from infinite [5]. Thus, the transmitted signal can leak into the Rx path, which leads to the so-called Tx leakage (TxL) phenomenon. As the uplink and the downlink bands are spectrally separated, the received signal will not be impaired directly by the leakage of the transmitted signal, as the low-pass filter (LPF) located after the demodulation stage will remove all of it from the band signals. However, an image of the transmitted signal can pollute the received signal in the baseband, due to nonlinearities and imperfections in the components in the Rx stage; especially the low-noise amplifier (LNA) [6] and the demodulator [7]. These aforementioned imperfections lead to second-order intermodulation products that shift downward to the baseband square component of the TxL signal [8]. In practical cases, this polluting signal can be neglected, except when the receiver is far from the transmitter (which corresponds to the cell edge context in cellular communications), as the power of the received signal is weak, and the power of the transmitted signal is strong [9].

To avoid this pollution, analog methods can be implemented. Such mitigation methods consist of the addition of a band-pass filter in the Rx stage before [10] or after the LNA [11]. Other techniques consist of the combination of the Tx path multiplied by a calibrated analog gain to the Rx path, to suppress the pollution at high frequency [12]. However, RF transceivers contain more and more digital parts, and signal-processing techniques are becoming an area of interest for radio-frequency impairment problems [13]. In perfect agreement with the dirty RF paradigm, several digital-compensation methods have been investigated in the past few years for TxL compensation [5,9,14,15].

These methods are based on the knowledge of the transmitted signal and require the estimation of the so-called TxL channel that characterizes the Tx-Rx isolation of the duplexer and the Rx path. Different channel models are used in the literature, from a single constant coefficient [5,16], to an exponential decay filter [17], or a more general finite impulse response filter [9]. However, literature methods do not take into account that the duplexer isolation is time varying, as showed by [18]. Furthermore, under the flat TxL channel assumption, the existence of a fractional delay in the reception stage due to digital blocks, analog blocks and propagation into the receiver, has not been considered. Also, a steady-state analysis of a LMS-based algorithm was described by [19] to reduce the impact of the spurs (which are narrowband pollutions due to leakage of clock harmonics), and a similar approach can be investigated for a wideband polluting signal.

In this paper, we propose a digital compensation scheme for the TxL problem. Our method exploits the knowledge of the transmitted signal as a reference, and estimates both the TxL channel that is assumed to be frequency flat and to follow a first-order auto-regressive model (AR1), and the fractional delay introduced by the transceiver. We first study the synchronized case (where the fractional delay is assumed to be perfectly known), and we derive the asymptotic performance of the channel complex gain estimator, based on the LMS algorithm. Then, through the derivation of the analytic formula of the asymptotic performance of the algorithm in the presence of noncompensated fractional delay, we show that the fractional delay must be compensated for beforehand. We propose a joint estimation algorithm for the estimation of both the channel gain and the fractional delay. Before the compensation part, the estimation part of our algorithm has similitudes with a data-aided algorithm that was designed for phase and timing synchronization as well as for automatic gain control [20], although here the Rx signal is considered as noise for the estimation process. To be suitable for hardware implementation, this algorithm is adaptive, online, and recursive, and has low complexity. The algorithm is proposed under the flat TxL channel assumption, but we will see in the simulation part that the method is robust against a typical frequency-selective TxL channel, and is more suitable than a classical multi-tap LMS approach when the fractional delay is not negligible. We complete and extend the initial work proposed by [1], providing here all of the proofs, additional extensive simulations, comparisons with the literature, and interpretations. The main contributions of the present paper can be summarized as:
                        
                           •
                           Proposition of a baseband digital model for TxL pollution, which takes into account the time variation of the polluting channel and the propagation delay to the receiver. The link between the parameters of the (AR1-based) model and physical values (e.g., interference level, normalized Doppler frequency, and others) is analytically established.

Proposition of a joint estimation algorithm to both estimate the time-varying complex gain and the fractional delay, before performing TxL compensation. This LMS-based compensation is piloted by a reference synthesized from the transmitted samples.

Derivation of the closed-form asymptotic performance of the algorithm when the fractional delay is assumed to be perfectly known. This can be used to tune the step-size parameters of the algorithm, as well as to predict the signal interference ratio (SIR) performance with respect to the TxL channel properties. The impact of a noncompensated fractional delay on the asymptotic performance is also derived, which shows that the fractional delay must be compensated for beforehand.

Simulation and comparison between the proposed joint estimation scheme and a classical literature method for the case of a frequency selective TxL channel, which shows the robustness and effectiveness of the proposed algorithm.

This paper is organized as follows. We give the baseband polluting model in Section 2. We derive the asymptotic performance of the LMS algorithm for the channel gain estimation process in the synchronized case in Section 3. We derive the analytic formulae of the influence of the fractional delay in Section 4. We propose a joint channel gain and fractional delay in Section 5. Section 6 validates our method and theoretical results through simulations.

As, the baseband polluting model involves several signals from both Tx and Rx stages, the main signals (and their definitions) are synthesized in Table 1
                        , and also mentioned in Fig. 1. We consider a classical FDD scheme where transmission and reception are simultaneous, at the frequency 
                           
                              
                                 f
                              
                              
                                 Tx
                              
                           
                         for transmission, and 
                           
                              
                                 f
                              
                              
                                 Rx
                              
                           
                         for reception. The transmitted signal 
                           
                              
                                 x
                              
                              
                                 Tx
                              
                              
                                 HF
                              
                           
                           (
                           t
                           )
                         has a bandwidth 
                           
                              
                                 B
                              
                              
                                 T
                                 x
                              
                           
                         around 
                           
                              
                                 f
                              
                              
                                 Tx
                              
                           
                         (i.e. the bandwidth of 
                           
                              
                                 x
                              
                              
                                 Tx
                              
                              
                                 HF
                              
                           
                           (
                           t
                           )
                         is from 
                           
                              
                                 f
                              
                              
                                 Tx
                              
                           
                           −
                           
                              
                                 B
                              
                              
                                 T
                                 x
                              
                           
                           /
                           2
                         to 
                           
                              
                                 f
                              
                              
                                 Tx
                              
                           
                           +
                           
                              
                                 B
                              
                              
                                 T
                                 x
                              
                           
                           /
                           2
                        ), and can be expressed as:
                           
                              (1)
                              
                                 
                                    
                                       x
                                    
                                    
                                       Tx
                                    
                                    
                                       HF
                                    
                                 
                                 (
                                 t
                                 )
                                 =
                                 ℜ
                                 {
                                 
                                    
                                       
                                          
                                             s
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       Tx
                                    
                                 
                                 (
                                 t
                                 )
                                 
                                    
                                       e
                                    
                                    
                                       2
                                       j
                                       π
                                       
                                          
                                             f
                                          
                                          
                                             Tx
                                          
                                       
                                       t
                                       +
                                       j
                                       
                                          
                                             ϕ
                                          
                                          
                                             Tx
                                          
                                       
                                    
                                 
                                 }
                                  
                                 ,
                              
                           
                         where 
                           ℜ
                           
                              {
                              }
                           
                         is the real part operator, and where:
                           
                              (2)
                              
                                 
                                    
                                       
                                          
                                             s
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       Tx
                                    
                                 
                                 (
                                 t
                                 )
                                 =
                                 
                                    
                                       s
                                    
                                    
                                       
                                          
                                             Tx
                                          
                                          
                                             I
                                          
                                       
                                    
                                 
                                 (
                                 t
                                 )
                                 +
                                 j
                                 
                                    
                                       s
                                    
                                    
                                       
                                          
                                             Tx
                                          
                                          
                                             Q
                                          
                                       
                                    
                                 
                                 (
                                 t
                                 )
                                  
                                 ,
                              
                           
                         is the complex baseband Tx signal. Here, we assume a purely linear power amplifier with gain 
                           
                              
                                 g
                              
                              
                                 PA
                              
                           
                        , and the signal at the duplexer input can be expressed as
                           
                              (3)
                              
                                 
                                    
                                       x
                                    
                                    
                                       Tx
                                    
                                    
                                       PA
                                    
                                 
                                 (
                                 t
                                 )
                                 =
                                 
                                    
                                       g
                                    
                                    
                                       PA
                                    
                                 
                                 ×
                                 
                                    
                                       x
                                    
                                    
                                       Tx
                                    
                                    
                                       HF
                                    
                                 
                                 (
                                 t
                                 )
                                  
                                 .
                              
                           
                         In a classical FDD transceiver, TxL is due to the cascade of several impairments:
                           
                              •
                              The finite isolation between the Tx path and Rx path at the duplexer implies leakage of the transmitted signal into the Rx path (see Fig. 1). If we denote 
                                    
                                       
                                          h
                                       
                                       
                                          TxL
                                       
                                    
                                    (
                                    t
                                    )
                                  as the duplexer equivalent channel, and introduce the power amplifier gain 
                                    
                                       
                                          g
                                       
                                       
                                          PA
                                       
                                    
                                  into the duplexer response, the TxL signal in the Rx path can be expressed as
                                    
                                       (4)
                                       
                                          
                                             
                                                s
                                             
                                             
                                                TxL
                                             
                                             
                                                HF
                                             
                                          
                                          (
                                          t
                                          )
                                          =
                                          
                                             
                                                h
                                             
                                             
                                                TxL
                                             
                                          
                                          (
                                          t
                                          )
                                          ⁎
                                          
                                             
                                                x
                                             
                                             
                                                Tx
                                             
                                             
                                                HF
                                             
                                          
                                          (
                                          t
                                          )
                                           
                                          ,
                                       
                                    
                                  where ⁎ is the convolution operator. The signal at the input of the LNA 
                                    
                                       
                                          x
                                       
                                       
                                          LNA
                                       
                                    
                                    (
                                    t
                                    )
                                  is a mixture between the desired high-frequency signal 
                                    
                                       
                                          s
                                       
                                       
                                          Rx
                                       
                                       
                                          HF
                                       
                                    
                                    (
                                    t
                                    )
                                  and the TxL signal 
                                    
                                       
                                          s
                                       
                                       
                                          TxL
                                       
                                       
                                          HF
                                       
                                    
                                    (
                                    t
                                    )
                                 . It can be noted that, in practice, the level of the received signal 
                                    
                                       
                                          s
                                       
                                       
                                          Rx
                                       
                                       
                                          HF
                                       
                                    
                                    (
                                    t
                                    )
                                  can be much lower than the level of the leaked transmitted signal 
                                    
                                       
                                          s
                                       
                                       
                                          TxL
                                       
                                       
                                          HF
                                       
                                    
                                    (
                                    t
                                    )
                                 , especially in a cell edge.
                                    
                                       (5)
                                       
                                          
                                             
                                                x
                                             
                                             
                                                LNA
                                             
                                          
                                          (
                                          t
                                          )
                                          =
                                          
                                             
                                                s
                                             
                                             
                                                Rx
                                             
                                             
                                                HF
                                             
                                          
                                          (
                                          t
                                          )
                                          +
                                          
                                             
                                                s
                                             
                                             
                                                TxL
                                             
                                             
                                                HF
                                             
                                          
                                          (
                                          t
                                          )
                                       
                                    
                                 
                              

The LNA that amplifies the received signal regarding the noise is not perfectly linear [21]. As a consequence, intermodulation products located at the LNA create second-order baseband components. Assuming a LNA with a nonlinearity of order II, the output of the LNA can be expressed as:
                                    
                                       
                                          
                                             
                                                y
                                             
                                             
                                                LNA
                                             
                                          
                                          (
                                          t
                                          )
                                          =
                                          
                                             
                                                α
                                             
                                             
                                                1
                                             
                                             
                                                LNA
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                LNA
                                             
                                          
                                          (
                                          t
                                          )
                                          +
                                          
                                             
                                                α
                                             
                                             
                                                2
                                             
                                             
                                                LNA
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                LNA
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          t
                                          )
                                       
                                    
                                  By introducing 
                                    
                                       
                                          z
                                       
                                       
                                          Rx
                                       
                                    
                                    (
                                    t
                                    )
                                  as the analytic signal associated with the received signal 
                                    
                                       
                                          s
                                       
                                       
                                          Rx
                                       
                                       
                                          HF
                                       
                                    
                                    (
                                    t
                                    )
                                  [and with a baseband complex envelop 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          Rx
                                       
                                    
                                    (
                                    t
                                    )
                                 ], and 
                                    
                                       
                                          z
                                       
                                       
                                          TxL
                                       
                                    
                                    (
                                    t
                                    )
                                  as the analytic signal of 
                                    
                                       
                                          s
                                       
                                       
                                          TxL
                                       
                                       
                                          HF
                                       
                                    
                                    (
                                    t
                                    )
                                  [with a baseband complex envelop 
                                    
                                       
                                          
                                             
                                                s
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          TxL
                                       
                                    
                                    (
                                    t
                                    )
                                 ], defined as:
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         Rx
                                                      
                                                   
                                                   (
                                                   t
                                                   )
                                                
                                                
                                                   =
                                                
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         Rx
                                                      
                                                   
                                                   (
                                                   t
                                                   )
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         2
                                                         j
                                                         π
                                                         
                                                            
                                                               f
                                                            
                                                            
                                                               Rx
                                                            
                                                         
                                                         t
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         TxL
                                                      
                                                   
                                                   (
                                                   t
                                                   )
                                                
                                                
                                                   =
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               s
                                                            
                                                            
                                                               ˜
                                                            
                                                         
                                                      
                                                      
                                                         TxL
                                                      
                                                   
                                                   (
                                                   t
                                                   )
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         2
                                                         j
                                                         π
                                                         
                                                            
                                                               f
                                                            
                                                            
                                                               Tx
                                                            
                                                         
                                                         t
                                                      
                                                   
                                                    
                                                   ,
                                                
                                             
                                          
                                       
                                    
                                  the link with the high-frequency signals can be expressed as:
                                    
                                       (6)
                                       
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   Rx
                                                
                                                
                                                   HF
                                                
                                             
                                             (
                                             t
                                             )
                                             =
                                             
                                                
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         Rx
                                                      
                                                   
                                                   (
                                                   t
                                                   )
                                                   +
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         Rx
                                                      
                                                      
                                                         ⁎
                                                      
                                                   
                                                   (
                                                   t
                                                   )
                                                
                                                2
                                             
                                             =
                                             ℜ
                                             {
                                             
                                                
                                                   z
                                                
                                                
                                                   Rx
                                                
                                             
                                             (
                                             t
                                             )
                                             }
                                          
                                       
                                    
                                 
                                 
                                    
                                       (7)
                                       
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   TxL
                                                
                                                
                                                   HF
                                                
                                             
                                             (
                                             t
                                             )
                                             =
                                             
                                                
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         TxL
                                                      
                                                   
                                                   (
                                                   t
                                                   )
                                                   +
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         TxL
                                                      
                                                      
                                                         ⁎
                                                      
                                                   
                                                   (
                                                   t
                                                   )
                                                
                                                2
                                             
                                             =
                                             ℜ
                                             {
                                             
                                                
                                                   z
                                                
                                                
                                                   TxL
                                                
                                             
                                             (
                                             t
                                             )
                                             }
                                              
                                             ,
                                          
                                       
                                    
                                 
                              

A leakage can appear at the demodulator stage, between the input and the output of the demodulator [6]. As a consequence, baseband signals (due to intermodulation products) will pollute the desired noisy signal that is translated from 
                                    
                                       
                                          f
                                       
                                       
                                          Rx
                                       
                                    
                                  to baseband by the demodulator. If we denote 
                                    
                                       
                                          g
                                       
                                       
                                          OL
                                       
                                    
                                  as the static gain of the leakage, and 
                                    
                                       
                                          h
                                       
                                       
                                          Rx
                                       
                                    
                                    (
                                    t
                                    )
                                  as the low-pass filter located after the demodulation stage, the final baseband polluting term is:
                                    
                                       (9)
                                       
                                          
                                             
                                                s
                                             
                                             
                                                TxL
                                             
                                             
                                                BB
                                             
                                          
                                          (
                                          t
                                          )
                                          =
                                          
                                             
                                                g
                                             
                                             
                                                OL
                                             
                                          
                                          ×
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   2
                                                
                                                
                                                   LNA
                                                
                                             
                                             2
                                          
                                          ×
                                          
                                             
                                                h
                                             
                                             
                                                Rx
                                             
                                          
                                          (
                                          t
                                          )
                                          ⁎
                                          |
                                          
                                             
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                TxL
                                             
                                          
                                          (
                                          t
                                          )
                                          
                                             
                                                |
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              

Here, as we will apply digital compensation to mitigate the impact of the TxL pollution, we need a digital pollution model for the TxL. The polluting term after the analog-to-digital converter can be expressed as:
                           
                              (10)
                              
                                 
                                    
                                       s
                                    
                                    
                                       T
                                       x
                                       L
                                    
                                 
                                 (
                                 n
                                 )
                                 =
                                 
                                    
                                       [
                                       
                                          
                                             s
                                          
                                          
                                             TxL
                                          
                                          
                                             BB
                                          
                                       
                                       (
                                       t
                                       )
                                       ]
                                    
                                    
                                       t
                                       =
                                       n
                                       
                                          
                                             T
                                          
                                          
                                             R
                                             x
                                          
                                       
                                    
                                 
                              
                           
                         where 
                           
                              
                                 T
                              
                              
                                 Rx
                              
                           
                           =
                           1
                           /
                           
                              
                                 F
                              
                              
                                 Rx
                              
                           
                         is the sampling period. Here, for the theoretical analysis, we assume that the duplexer is frequency flat, and that the Rx chain introduces a complex gain due to mismatch, as has been widely assumed in the literature, as in [5,16,22].

Due to digital and analog blocks, the polluting signal has a delay 
                           Δ
                           =
                           (
                           D
                           +
                           δ
                           )
                           
                              
                                 T
                              
                              
                                 Rx
                              
                           
                        , which is composed of an integer part D and a fractional part δ. From (9) and (10), the polluting term becomes:
                           
                              (11)
                              
                                 
                                    
                                       s
                                    
                                    
                                       T
                                       x
                                       L
                                    
                                 
                                 (
                                 n
                                 ;
                                 Δ
                                 )
                                 =
                                 
                                    
                                       β
                                    
                                    
                                       TxL
                                    
                                 
                                 (
                                 n
                                 )
                                 ×
                                 
                                    
                                       [
                                       
                                          
                                             h
                                          
                                          
                                             Rx
                                          
                                       
                                       (
                                       t
                                       −
                                       Δ
                                       )
                                       ⁎
                                       |
                                       
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             T
                                             x
                                          
                                       
                                       (
                                       t
                                       −
                                       Δ
                                       )
                                       
                                          
                                             |
                                          
                                          
                                             2
                                          
                                       
                                       ]
                                    
                                    
                                       t
                                       =
                                       n
                                       
                                          
                                             T
                                          
                                          
                                             R
                                             x
                                          
                                       
                                    
                                 
                              
                           
                         where 
                           
                              
                                 β
                              
                              
                                 TxL
                              
                           
                           (
                           n
                           )
                         models the global TxL complex channel gain at time index n (modeling the impact of both the duplexer, the Rx chain, and the demodulator). The TxL channel gain is time varying [18], and can be expressed as:
                           
                              (12)
                              
                                 
                                    
                                       β
                                    
                                    
                                       TxL
                                    
                                 
                                 (
                                 n
                                 )
                                 =
                                 
                                    
                                       β
                                    
                                    
                                       
                                          
                                             0
                                          
                                          
                                             TxL
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       α
                                    
                                    
                                       TxL
                                    
                                 
                                 (
                                 n
                                 )
                                  
                                 ,
                              
                           
                         where 
                           
                              
                                 β
                              
                              
                                 
                                    
                                       0
                                    
                                    
                                       TxL
                                    
                                 
                              
                           
                         is a complex constant that is linked to the interference level, and 
                           
                              
                                 α
                              
                              
                                 TxL
                              
                           
                           (
                           n
                           )
                         is the time-varying channel evolution. For the complex gain evolution, we use a first-order auto-regressive process that is a simple but widely used model in the communications literature used to approximate time-varying channels [23,24], and is defined by:
                           
                              (13)
                              
                                 
                                    
                                       α
                                    
                                    
                                       TxL
                                    
                                 
                                 (
                                 n
                                 )
                                 =
                                 γ
                                 
                                    
                                       α
                                    
                                    
                                       TxL
                                    
                                 
                                 (
                                 n
                                 −
                                 1
                                 )
                                 +
                                 
                                    
                                       ξ
                                    
                                    
                                       TxL
                                    
                                 
                                 (
                                 n
                                 )
                                  
                                 ,
                              
                           
                         initialized by 
                           
                              
                                 α
                              
                              
                                 TxL
                              
                           
                           (
                           0
                           )
                           =
                           0
                        , where 
                           0
                           <
                           γ
                           <
                           1
                         and 
                           
                              
                                 ξ
                              
                              
                                 TxL
                              
                           
                           (
                           n
                           )
                         is circular complex zero-mean white Gaussian state noise, with variance:
                           
                              (14)
                              
                                 
                                    
                                       σ
                                    
                                    
                                       
                                          
                                             ξ
                                          
                                          
                                             TxL
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 (
                                 1
                                 −
                                 
                                    
                                       γ
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 
                                    
                                       σ
                                    
                                    
                                       
                                          
                                             α
                                          
                                          
                                             TxL
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 .
                              
                           
                         As the channel is composed of a static term and a complex Gaussian dynamic term, we denote K as the power ratio of the fixed and scattered components (in the same way as for a Ricean wireless channel model):
                           
                              (15)
                              
                                 K
                                 =
                                 
                                    
                                       |
                                       
                                          
                                             β
                                          
                                          
                                             
                                                
                                                   0
                                                
                                                
                                                   TxL
                                                
                                             
                                          
                                       
                                       
                                          
                                             |
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       
                                          σ
                                       
                                       
                                          
                                             
                                                α
                                             
                                             
                                                TxL
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                         The case 
                           K
                           →
                           ∞
                         corresponds to a nonvarying channel, whereas 
                           K
                           →
                           0
                         corresponds to a varying channel with a negligible constant interference level.

We assume that the integer part of the delay is known, as in practice it can be easily estimated with a correlation process or with a parallel structure, as described by [5], and without loss of generality, we take 
                           D
                           =
                           0
                        . In the baseband receiver part, the discrete time observed signal 
                           d
                           (
                           n
                           )
                         becomes:
                           
                              (16)
                              
                                 d
                                 (
                                 n
                                 )
                                 =
                                 x
                                 (
                                 n
                                 )
                                 +
                                 b
                                 (
                                 n
                                 )
                                 +
                                 
                                    
                                       s
                                    
                                    
                                       T
                                       x
                                       L
                                    
                                 
                                 (
                                 n
                                 ;
                                 δ
                                 )
                                  
                                 ,
                              
                           
                         where 
                           x
                           (
                           n
                           )
                         is the desired signal, which is assumed to be stationary uncorrelated
                           1
                        
                        
                           1
                           This strong hypothesis is only made to derive theoretical performance formulae, but we will see in the simulation section that the results can be applied to some typical communication signals (that are cyclostationary and slightly correlated by the waveforms).
                         and zero-mean, of variance 
                           
                              
                                 σ
                              
                              
                                 x
                              
                              
                                 2
                              
                           
                        , 
                           b
                           (
                           n
                           )
                         is the white additive Gaussian noise, of variance 
                           
                              
                                 σ
                              
                              
                                 b
                              
                              
                                 2
                              
                           
                        , and 
                           
                              
                                 s
                              
                              
                                 T
                                 x
                                 L
                              
                           
                           (
                           n
                           ;
                           δ
                           )
                         is the TxL polluting signal defined in (11).

The TxL canceller is not intended to cancel the additive noise term. As we focus here on the performance of the TxL canceller, and not on the impact of the additive white noise, we consider for the performance measurement that the noise is part of the desired signal. In other words, regarding the TxL cancellation algorithm, the desired signal is the observed signal without the TxL polluting term 
                           
                              
                                 s
                              
                              
                                 T
                                 x
                                 L
                              
                           
                           (
                           n
                           ;
                           δ
                           )
                        . We denote 
                           
                              
                                 x
                              
                              
                                 b
                              
                           
                           (
                           n
                           )
                         as the desired noisy signal, which is a white zero-mean signal, of variance 
                           
                              
                                 σ
                              
                              
                                 
                                    
                                       x
                                    
                                    
                                       b
                                    
                                 
                              
                              
                                 2
                              
                           
                        , and the observation model becomes:
                           
                              (17)
                              
                                 d
                                 (
                                 n
                                 )
                                 =
                                 
                                    
                                       x
                                    
                                    
                                       b
                                    
                                 
                                 (
                                 n
                                 )
                                 +
                                 
                                    
                                       s
                                    
                                    
                                       T
                                       x
                                       L
                                    
                                 
                                 (
                                 n
                                 ;
                                 δ
                                 )
                                  
                                 .
                              
                           
                         The influence of the TxL in terms of the SIR, expressed in dB, is:
                           
                              (18)
                              
                                 
                                    
                                       SIR
                                    
                                    
                                       init
                                    
                                 
                                 =
                                 −
                                 10
                                 
                                    
                                       log
                                    
                                    
                                       10
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             P
                                          
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   T
                                                   x
                                                   L
                                                
                                             
                                          
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   b
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                    )
                                 
                                  
                                 ,
                              
                           
                         where 
                           
                              
                                 P
                              
                              
                                 
                                    
                                       s
                                    
                                    
                                       T
                                       x
                                       L
                                    
                                 
                              
                           
                         is the power of the polluting term 
                           
                              
                                 s
                              
                              
                                 T
                                 x
                                 L
                              
                           
                           (
                           n
                           ;
                           δ
                           )
                        .

To proceed to the compensation, we synthesize a reference 
                           u
                           (
                           n
                           )
                         as a perfect image of the baseband intermodulation product that takes into account the impact of the Rx chain:
                           
                              (19)
                              
                                 u
                                 (
                                 n
                                 )
                                 =
                                 
                                    
                                       [
                                       
                                          
                                             h
                                          
                                          
                                             Rx
                                          
                                       
                                       (
                                       t
                                       )
                                       ⁎
                                       |
                                       
                                          
                                             s
                                          
                                          
                                             T
                                             x
                                          
                                       
                                       (
                                       t
                                       )
                                       
                                          
                                             |
                                          
                                          
                                             2
                                          
                                       
                                       ]
                                    
                                    
                                       t
                                       =
                                       n
                                       
                                          
                                             T
                                          
                                          
                                             R
                                             x
                                          
                                       
                                    
                                 
                              
                           
                         This reference of power 
                           
                              
                                 P
                              
                              
                                 u
                              
                           
                         is synthesized in the reference generator (see Fig. 1) from the baseband Tx samples, and it can be noted that in practice, it might need additional processing, such as an upsampler, filters, and a resampler. Based on the observation model described in (17), the TxL channel evolution described in (12) and (13), and the reference in (19), the estimation process consists of the estimation of the time-varying complex gain 
                           
                              
                                 β
                              
                              
                                 TxL
                              
                           
                           (
                           n
                           )
                         and the fractional delay δ.

The estimation error is defined by:
                           
                              (20)
                              
                                 ϵ
                                 (
                                 n
                                 )
                                 =
                                 e
                                 (
                                 n
                                 )
                                 −
                                 
                                    
                                       x
                                    
                                    
                                       b
                                    
                                 
                                 (
                                 n
                                 )
                                 ,
                                  
                              
                           
                         where 
                           e
                           (
                           n
                           )
                         is the output of the TxL compensation structure (see Fig. 1), and the asymptotic performance of the algorithm will be described by the SIR after compensation:
                           
                              (21)
                              
                                 
                                    
                                       SIR
                                    
                                    
                                       comp
                                    
                                 
                                 =
                                 −
                                 10
                                 
                                    
                                       log
                                    
                                    
                                       10
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             P
                                          
                                          
                                             ϵ
                                          
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   b
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                    )
                                 
                                  
                                 ,
                              
                           
                         where 
                           
                              
                                 P
                              
                              
                                 ϵ
                              
                           
                         is the mean square error.

The baseband model of the complex gain 
                           
                              
                                 β
                              
                              
                                 TxL
                              
                           
                           (
                           n
                           )
                         is function of several parameters, synthesized in Table 2
                        . In addition to the overall parameters, that are necessary to establish the model and to derive the analytical study, the model also depends on the so-called primary parameters that characterizes the AR1 mathematical model (see Table 2). Besides, instead of using the primary parameters, physical interpretation of the baseband polluting model and characterization of the parameters can alternatively be done through the initial SIR (that defines the interference level at the entry of the digital front end), the ratio K, and the normalized Doppler frequency 
                           
                              
                                 f
                              
                              
                                 d
                              
                           
                           
                              
                                 T
                              
                              
                                 Rx
                              
                           
                        . These parameters are denoted as associated physical parameters in Table 2.

The output of the AR1 model can be viewed as the low-pass filtering of the state noise 
                           
                              
                                 ξ
                              
                              
                                 TxL
                              
                           
                           (
                           n
                           )
                        , and we denote 
                           L
                           (
                           z
                           )
                         as the z transform of this filter. From (13), we have:
                           
                              (22)
                              
                                 L
                                 (
                                 z
                                 )
                                 =
                                 
                                    1
                                    
                                       1
                                       −
                                       γ
                                       
                                          
                                             z
                                          
                                          
                                             −
                                             1
                                          
                                       
                                    
                                 
                                  
                                 ,
                              
                           
                         and the coherence time 
                           
                              
                                 T
                              
                              
                                 corr
                              
                           
                        , defined here as the inverse of the 3-dB cut-off frequency of 
                           L
                           (
                           z
                           )
                        , can be approximated as:
                           
                              (23)
                              
                                 
                                    
                                       T
                                    
                                    
                                       corr
                                    
                                 
                                 ≈
                                 
                                    
                                       2
                                       γ
                                       π
                                       
                                          
                                             T
                                          
                                          
                                             Rx
                                          
                                       
                                    
                                    
                                       1
                                       −
                                       γ
                                    
                                 
                              
                           
                         The channel variation is slow in terms of the Rx sampling time 
                           
                              
                                 T
                              
                              
                                 Rx
                              
                           
                        , and we assume 
                           
                              
                                 T
                              
                              
                                 corr
                              
                           
                           ≫
                           
                              
                                 T
                              
                              
                                 Rx
                              
                           
                        ; the AR1 parameter γ can be approximated as:
                           
                              (24)
                              
                                 γ
                                 ≈
                                 
                                    
                                       
                                          T
                                       
                                       
                                          corr
                                       
                                    
                                    
                                       
                                          
                                             T
                                          
                                          
                                             corr
                                          
                                       
                                       +
                                       2
                                       π
                                       
                                          
                                             T
                                          
                                          
                                             Rx
                                          
                                       
                                    
                                 
                                  
                                 .
                              
                           
                         Reintroducing (24) in (14), and introducing the normalized Doppler frequency 
                           
                              
                                 f
                              
                              
                                 d
                              
                           
                           
                              
                                 T
                              
                              
                                 Rx
                              
                           
                           =
                           
                              
                                 
                                    T
                                 
                                 
                                    Rx
                                 
                              
                              
                                 
                                    T
                                 
                                 
                                    corr
                                 
                              
                           
                           ≪
                           1
                        , we finally have:
                           
                              (25)
                              
                                 
                                    
                                       σ
                                    
                                    
                                       
                                          
                                             ξ
                                          
                                          
                                             TxL
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 ≈
                                 4
                                 π
                                 
                                    
                                       σ
                                    
                                    
                                       
                                          
                                             α
                                          
                                          
                                             TxL
                                          
                                       
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       d
                                    
                                 
                                 
                                    
                                       T
                                    
                                    
                                       Rx
                                    
                                 
                                  
                                 ,
                              
                           
                         and finally, the constant interference level 
                           
                              
                                 β
                              
                              
                                 
                                    
                                       0
                                    
                                    
                                       TxL
                                    
                                 
                              
                           
                         and the channel variance 
                           
                              
                                 σ
                              
                              
                                 
                                    
                                       α
                                    
                                    
                                       TxL
                                    
                                 
                              
                              
                                 2
                              
                           
                         are defined by the initial SIR and the ratio K:
                           
                              (26)
                              
                                 
                                    |
                                    
                                       
                                          β
                                       
                                       
                                          
                                             
                                                0
                                             
                                             
                                                TxL
                                             
                                          
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   b
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       
                                          2
                                          
                                             
                                                P
                                             
                                             
                                                u
                                             
                                          
                                       
                                    
                                    
                                       K
                                       
                                          1
                                          +
                                          K
                                       
                                    
                                    
                                       
                                          10
                                       
                                       
                                          −
                                          
                                             
                                                SIR
                                             
                                             
                                                init
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (27)
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          
                                             
                                                α
                                             
                                             
                                                TxL
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          |
                                          
                                             
                                                β
                                             
                                             
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      TxL
                                                   
                                                
                                             
                                          
                                          
                                             
                                                |
                                             
                                             
                                                2
                                             
                                          
                                       
                                       K
                                    
                                     
                                    .
                                 
                              
                           
                        
                     

As in classical literature articles related to channel estimation modeled by auto-regressive models, the theoretical performance formulae in the rest of the paper are expressed in terms of 
                           
                              
                                 β
                              
                              
                                 
                                    
                                       0
                                    
                                    
                                       TxL
                                    
                                 
                              
                           
                        , 
                           
                              
                                 σ
                              
                              
                                 
                                    
                                       ξ
                                    
                                    
                                       TxL
                                    
                                 
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 σ
                              
                              
                                 
                                    
                                       α
                                    
                                    
                                       TxL
                                    
                                 
                              
                              
                                 2
                              
                           
                         that define the baseband polluting model described in (12)–(15). It corresponds to the primary parameters described in Table 2 that can be associated to practical physical parameters (see Table 2) with (25)–(27).

In this part, we assume that δ is known and we synthesize the fractionally delayed reference 
                        
                           
                              u
                           
                           
                              δ
                           
                        
                        (
                        n
                        )
                      from (19):
                        
                           (28)
                           
                              
                                 
                                    u
                                 
                                 
                                    δ
                                 
                              
                              (
                              n
                              )
                              =
                              
                                 
                                    [
                                    
                                       
                                          h
                                       
                                       
                                          Rx
                                       
                                    
                                    (
                                    t
                                    )
                                    ⁎
                                    |
                                    
                                       
                                          s
                                       
                                       
                                          T
                                          x
                                       
                                    
                                    (
                                    t
                                    )
                                    
                                       
                                          |
                                       
                                       
                                          2
                                       
                                    
                                    ]
                                 
                                 
                                    t
                                    =
                                    n
                                    
                                       
                                          T
                                       
                                       
                                          R
                                          x
                                       
                                    
                                    +
                                    δ
                                 
                              
                               
                              .
                           
                        
                      Note that with a perfect interpolator, we would have:
                        
                           (29)
                           
                              
                                 
                                    s
                                 
                                 
                                    TxL
                                 
                              
                              (
                              n
                              ,
                              δ
                              )
                              =
                              
                                 
                                    β
                                 
                                 
                                    TxL
                                 
                              
                              (
                              n
                              )
                              
                                 
                                    u
                                 
                                 
                                    δ
                                 
                              
                              (
                              n
                              )
                               
                              ,
                           
                        
                      and it can also be noted that in practical cases, a Lagrangian interpolator of size L can be implemented [25,26]. The compensation idea, as depicted in Fig. 2
                     , is to obtain the compensated signal 
                        e
                        (
                        n
                        )
                      by subtracting the estimated TxL component from the input sample 
                        d
                        (
                        n
                        )
                     . This component is obtained by multiplying the reference signal 
                        
                           
                              u
                           
                           
                              δ
                           
                        
                        (
                        n
                        )
                      by a complex adaptive coefficient 
                        
                           
                              
                                 
                                    β
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              T
                              x
                              L
                           
                        
                        (
                        n
                        )
                      (estimation of the TxL channel), which is updated using 
                        e
                        (
                        n
                        )
                      with a LMS algorithm [27]:
                        
                           (30)
                           
                              
                                 
                                    
                                       
                                          
                                             s
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       TxL
                                    
                                 
                                 (
                                 n
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       TxL
                                    
                                 
                                 (
                                 n
                                 )
                                 
                                    
                                       u
                                    
                                    
                                       δ
                                    
                                 
                                 (
                                 n
                                 )
                              
                           
                        
                     
                     
                        
                           (31)
                           
                              
                                 e
                                 (
                                 n
                                 )
                                 =
                                 d
                                 (
                                 n
                                 )
                                 −
                                 
                                    
                                       
                                          
                                             s
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       TxL
                                    
                                 
                                 (
                                 n
                                 )
                              
                           
                        
                     
                     
                        
                           (32)
                           
                              
                                 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       TxL
                                    
                                 
                                 (
                                 n
                                 +
                                 1
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       TxL
                                    
                                 
                                 (
                                 n
                                 )
                                 +
                                 μ
                                 
                                    
                                       u
                                    
                                    
                                       δ
                                    
                                 
                                 (
                                 n
                                 )
                                 e
                                 (
                                 n
                                 )
                                  
                                 ,
                              
                           
                        
                      where μ is the constant step size of the algorithm. The asymptotic performance of the algorithm can be derived as (see Appendix A):
                        
                           (33)
                           
                              
                                 
                                    SIR
                                 
                                 
                                    comp
                                 
                              
                              =
                              −
                              10
                              
                                 
                                    log
                                 
                                 
                                    10
                                 
                              
                              
                                 [
                                 
                                    
                                       μ
                                       
                                          
                                             P
                                          
                                          
                                             u
                                          
                                       
                                    
                                    
                                       2
                                       −
                                       μ
                                       
                                          
                                             P
                                          
                                          
                                             u
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       Q
                                       (
                                       
                                          
                                             P
                                          
                                          
                                             u
                                          
                                       
                                       ,
                                       
                                          
                                             σ
                                          
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   TxL
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       γ
                                       )
                                    
                                    
                                       μ
                                       
                                          
                                             σ
                                          
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   b
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       2
                                       −
                                       μ
                                       
                                          
                                             P
                                          
                                          
                                             u
                                          
                                       
                                       )
                                    
                                 
                                 ]
                              
                               
                              ,
                           
                        
                      where
                        
                           (34)
                           
                              Q
                              (
                              
                                 
                                    P
                                 
                                 
                                    u
                                 
                              
                              ,
                              
                                 
                                    σ
                                 
                                 
                                    
                                       
                                          α
                                       
                                       
                                          TxL
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              ,
                              γ
                              )
                              =
                              
                                 
                                    2
                                    μ
                                    
                                       
                                          P
                                       
                                       
                                          u
                                       
                                    
                                    
                                       
                                          σ
                                       
                                       
                                          
                                             
                                                α
                                             
                                             
                                                TxL
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    
                                       (
                                       1
                                       −
                                       γ
                                       )
                                    
                                 
                                 
                                    1
                                    −
                                    γ
                                    
                                       (
                                       1
                                       −
                                       μ
                                       
                                          
                                             P
                                          
                                          
                                             u
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        
                      models the impact of channel variations on performance. It can be noted that the asymptotic performance has a form that is similar to the performance of the spur canceller in [19]. The asymptotic SIR is composed of a static term (due to the presence of the input signal 
                        
                           
                              x
                           
                           
                              b
                           
                        
                        (
                        n
                        )
                     ) and a dynamic term (34) due to channel variations. The global form of this asymptotic SIR is linked to the stochastic gradient approach, and the difference lies in the use of different pollution models.

From the previous result, an optimal functional point can be deduced. First, with (14), we can relate γ to 
                        
                           
                              σ
                           
                           
                              
                                 
                                    ξ
                                 
                                 
                                    TxL
                                 
                              
                           
                           
                              2
                           
                        
                      and 
                        
                           
                              σ
                           
                           
                              
                                 
                                    α
                                 
                                 
                                    TxL
                                 
                              
                           
                           
                              2
                           
                        
                     :
                        
                           (35)
                           
                              γ
                              =
                              
                                 
                                    1
                                    −
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             
                                                
                                                   ξ
                                                
                                                
                                                   TxL
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   TxL
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                               
                              ,
                           
                        
                      with 
                        γ
                        ≈
                        1
                      as we assume 
                        
                           
                              σ
                           
                           
                              
                                 
                                    ξ
                                 
                                 
                                    TxL
                                 
                              
                           
                           
                              2
                           
                        
                        ≪
                        
                           
                              σ
                           
                           
                              
                                 
                                    α
                                 
                                 
                                    TxL
                                 
                              
                           
                           
                              2
                           
                        
                     . If we additionally assume that 
                        μ
                        
                           
                              P
                           
                           
                              u
                           
                        
                        ≪
                        1
                     , the SIR can be approximated by:
                        
                           (36)
                           
                              
                                 
                                    SIR
                                 
                                 
                                    comp
                                 
                              
                              ≈
                              −
                              10
                              
                                 
                                    log
                                 
                                 
                                    10
                                 
                              
                              
                                 [
                                 
                                    
                                       μ
                                       
                                          
                                             P
                                          
                                          
                                             u
                                          
                                       
                                    
                                    2
                                 
                                 +
                                 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   TxL
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          1
                                          −
                                          
                                             
                                                1
                                                −
                                                
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         
                                                            
                                                               ξ
                                                            
                                                            
                                                               TxL
                                                            
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         
                                                            
                                                               α
                                                            
                                                            
                                                               TxL
                                                            
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          )
                                       
                                    
                                    
                                       μ
                                       
                                          
                                             σ
                                          
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   b
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 ]
                              
                               
                              .
                           
                        
                      From (36), an optimal step size can be deduced:
                        
                           (37)
                           
                              
                                 
                                    μ
                                 
                                 
                                    opt
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          2
                                          
                                             
                                                σ
                                             
                                             
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      TxL
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          
                                             
                                                P
                                             
                                             
                                                u
                                             
                                          
                                          
                                             
                                                σ
                                             
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      b
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                       (
                                       1
                                       −
                                       
                                          
                                             1
                                             −
                                             
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      
                                                         
                                                            ξ
                                                         
                                                         
                                                            TxL
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      
                                                         
                                                            α
                                                         
                                                         
                                                            TxL
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       )
                                    
                                 
                              
                               
                              ,
                           
                        
                      and reintroducing (37) in (36) leads to the maximal SIR reachable for a given AR1 channel modeling the TxL impact:
                        
                           (38)
                           
                              
                                 
                                    SIR
                                 
                                 
                                    comp
                                 
                                 
                                    max
                                 
                              
                              =
                              −
                              
                                 1
                                 2
                              
                              10
                              
                                 
                                    log
                                 
                                 
                                    10
                                 
                              
                              
                                 [
                                 
                                    
                                       2
                                       
                                          
                                             σ
                                          
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   TxL
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             P
                                          
                                          
                                             u
                                          
                                       
                                       
                                          (
                                          1
                                          −
                                          
                                             
                                                1
                                                −
                                                
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         
                                                            
                                                               ξ
                                                            
                                                            
                                                               TxL
                                                            
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         
                                                            
                                                               α
                                                            
                                                            
                                                               TxL
                                                            
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          )
                                       
                                    
                                    
                                       
                                          σ
                                       
                                       
                                          
                                             
                                                x
                                             
                                             
                                                b
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                                 ]
                              
                           
                        
                     
                  

In the previous section, we assumed that the fractional delay δ was perfectly known. In this section, we study the impact of a non-compensated fractional delay on the performance of the complex gain estimator. If we use in the algorithm a reference that is not fractionally delayed, the estimation process of the polluting term 
                        
                           
                              
                                 
                                    s
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              TxL
                           
                        
                        (
                        n
                        )
                      would be 
                        
                           
                              
                                 
                                    β
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              TxL
                           
                        
                        (
                        n
                        )
                        u
                        (
                        n
                        )
                      [with 
                        u
                        (
                        n
                        )
                      defined in (19)], and not 
                        
                           
                              
                                 
                                    β
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              TxL
                           
                        
                        (
                        n
                        )
                        
                           
                              u
                           
                           
                              δ
                           
                        
                        (
                        n
                        )
                      [as in (30)].

Thus, the reference used in the algorithm would not longer be a perfect image of the polluting term (see (29)) and in this case, the LMS algorithm becomes:
                        
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             TxL
                                          
                                       
                                       (
                                       n
                                       )
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             TxL
                                          
                                       
                                       (
                                       n
                                       )
                                       u
                                       (
                                       n
                                       )
                                    
                                 
                                 
                                    
                                       e
                                       (
                                       n
                                       )
                                    
                                    
                                       =
                                    
                                    
                                       
                                          [
                                          
                                             
                                                x
                                             
                                             
                                                b
                                             
                                          
                                          (
                                          n
                                          )
                                          +
                                          
                                             
                                                β
                                             
                                             
                                                TxL
                                             
                                          
                                          (
                                          n
                                          )
                                          
                                             
                                                u
                                             
                                             
                                                δ
                                             
                                          
                                          (
                                          n
                                          )
                                          ]
                                       
                                       −
                                       
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             TxL
                                          
                                       
                                       (
                                       n
                                       )
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             TxL
                                          
                                       
                                       (
                                       n
                                       +
                                       1
                                       )
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             TxL
                                          
                                       
                                       (
                                       n
                                       )
                                       +
                                       μ
                                       u
                                       (
                                       n
                                       )
                                       e
                                       (
                                       n
                                       )
                                        
                                       ,
                                    
                                 
                              
                           
                        
                      and we introduce:
                        
                           (39)
                           
                              
                                 
                                    η
                                 
                                 
                                    TxL
                                 
                              
                              (
                              n
                              )
                              =
                              
                                 
                                    u
                                 
                                 
                                    δ
                                 
                              
                              (
                              n
                              )
                              −
                              u
                              (
                              n
                              )
                               
                              ,
                           
                        
                      as the difference between the perfect reference and the used reference. We assume that 
                        
                           
                              η
                           
                           
                              TxL
                           
                        
                        (
                        n
                        )
                      can be modeled as white Gaussian noise, of variance 
                        
                           
                              σ
                           
                           
                              
                                 
                                    η
                                 
                                 
                                    TxL
                                 
                              
                           
                           
                              2
                           
                        
                     . On a first approximation (assuming linear interpolation), the variance of 
                        
                           
                              η
                           
                           
                              TxL
                           
                        
                      can be expressed as (see Appendix B):
                        
                           (40)
                           
                              
                                 
                                    σ
                                 
                                 
                                    
                                       
                                          η
                                       
                                       
                                          TxL
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              ≈
                              
                                 
                                    δ
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    P
                                 
                                 
                                    u
                                 
                              
                              .
                           
                        
                      In the case of a non-compensated fractional delay, the asymptotic performance of the system is a function of the AR1 parameters and the variance of the noise introduced in (39), and it can be expressed as (see Appendix C):
                        
                           (41)
                           
                              
                                 
                                    
                                       
                                          
                                             SIR
                                          
                                          
                                             comp
                                          
                                       
                                       ≈
                                       −
                                       10
                                       
                                          
                                             log
                                          
                                          
                                             10
                                          
                                       
                                       
                                          [
                                          
                                             
                                                μ
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      u
                                                   
                                                
                                             
                                             
                                                2
                                                −
                                                μ
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      u
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                Q
                                                (
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      u
                                                   
                                                
                                                ,
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      
                                                         
                                                            α
                                                         
                                                         
                                                            TxL
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ,
                                                γ
                                                )
                                             
                                             
                                                μ
                                                (
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      x
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      b
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                                (
                                                2
                                                −
                                                μ
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      u
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       +
                                       
                                          
                                             μ
                                             
                                                
                                                   P
                                                
                                                
                                                   u
                                                
                                             
                                             
                                                (
                                                |
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      
                                                         
                                                            0
                                                         
                                                         
                                                            TxL
                                                         
                                                      
                                                   
                                                
                                                )
                                                
                                                   
                                                      |
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      
                                                         
                                                            α
                                                         
                                                         
                                                            TxL
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   σ
                                                
                                                
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         TxL
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         b
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                (
                                                2
                                                −
                                                μ
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      u
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          +
                                          
                                             (
                                             |
                                             
                                                
                                                   β
                                                
                                                
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         TxL
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   |
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   σ
                                                
                                                
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         TxL
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         TxL
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   σ
                                                
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         b
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          ]
                                       
                                       .
                                    
                                 
                              
                           
                        
                      The asymptotic SIR is composed of four terms: the first and the second are relative to the synchronized LMS performance, and linked to the static error and the dynamic error (due to the AR1 channel), and the two last are due to the non-compensation of the fractional delay. It can be noted that the fractional delay has a non-negligible impact on the asymptotic performance, and it must be compensated for upstream. As δ can be unknown in practice, a joint estimation scheme must be investigated.

To jointly estimate the complex channel gain 
                        
                           
                              β
                           
                           
                              TxL
                           
                        
                        (
                        n
                        )
                      and the fractional delay δ, we propose the joint estimation process depicted in Fig. 3
                     .

The reference 
                        
                           
                              u
                           
                           
                              
                                 
                                    δ
                                 
                                 
                                    n
                                 
                              
                           
                        
                        (
                        n
                        )
                      used in the gain estimator algorithm defined in (31)–(32) is obtained from 
                        u
                        (
                        n
                        )
                     , which is delayed with a fractional delay 
                        
                           
                              δ
                           
                           
                              n
                           
                        
                     , with (28). Then, using the output 
                        e
                        (
                        n
                        )
                      of the gain estimator block, the channel estimate 
                        
                           
                              
                                 
                                    β
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              TxL
                           
                        
                        (
                        n
                        )
                     , the reference 
                        u
                        (
                        n
                        )
                     , and the fractionally delayed reference 
                        
                           
                              u
                           
                           
                              
                                 
                                    δ
                                 
                                 
                                    n
                                 
                              
                           
                        
                        (
                        n
                        )
                     , the update of the fractional delay estimate 
                        
                           
                              δ
                           
                           
                              n
                              +
                              1
                           
                        
                      is performed with another LMS algorithm. The updated fractional delay estimate 
                        
                           
                              δ
                           
                           
                              n
                              +
                              1
                           
                        
                      is then used in the next iteration of the compensation scheme.

The fractional delay estimation algorithm is based on the minimization of the instantaneous square error 
                        |
                        e
                        (
                        n
                        )
                        
                           
                              |
                           
                           
                              2
                           
                        
                      to which a gradient is applied (see Appendix D):
                        
                           (42)
                           
                              
                                 
                                    
                                       Δ
                                    
                                    
                                       u
                                    
                                 
                                 (
                                 n
                                 )
                                 =
                                 u
                                 (
                                 n
                                 −
                                 1
                                 )
                                 −
                                 u
                                 (
                                 n
                                 )
                              
                           
                        
                     
                     
                        
                           (43)
                           
                              
                                 
                                    
                                       
                                          
                                             δ
                                          
                                          
                                             n
                                             +
                                             1
                                          
                                       
                                    
                                    
                                       =
                                       
                                          
                                             δ
                                          
                                          
                                             n
                                          
                                       
                                       +
                                       ν
                                       ℜ
                                       
                                          {
                                          
                                             [
                                             
                                                
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   T
                                                   x
                                                   L
                                                
                                             
                                             (
                                             n
                                             )
                                             
                                                
                                                   Δ
                                                
                                                
                                                   u
                                                
                                             
                                             (
                                             n
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                   
                                                   
                                                      T
                                                   
                                                
                                             
                                             +
                                             
                                                
                                                   u
                                                
                                                
                                                   
                                                      
                                                         δ
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                
                                             
                                             (
                                             n
                                             )
                                             L
                                             (
                                             n
                                             )
                                             ]
                                          
                                          
                                             
                                                e
                                             
                                             
                                                ⁎
                                             
                                          
                                          (
                                          n
                                          )
                                          }
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (44)
                           
                              
                                 
                                    
                                       L
                                       (
                                       n
                                       +
                                       1
                                       )
                                    
                                    
                                       =
                                       
                                          (
                                          1
                                          −
                                          μ
                                          
                                             
                                                u
                                             
                                             
                                                
                                                   
                                                      δ
                                                   
                                                   
                                                      n
                                                   
                                                
                                             
                                          
                                          
                                             
                                                (
                                                n
                                                )
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       L
                                       (
                                       n
                                       )
                                       −
                                       μ
                                       d
                                       (
                                       n
                                       )
                                       
                                          
                                             Δ
                                          
                                          
                                             u
                                          
                                       
                                       (
                                       n
                                       )
                                    
                                 
                                 
                                    
                                    
                                       +
                                       2
                                       μ
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             TxL
                                          
                                       
                                       (
                                       n
                                       )
                                       
                                          
                                             u
                                          
                                          
                                             
                                                
                                                   δ
                                                
                                                
                                                   n
                                                
                                             
                                          
                                       
                                       (
                                       n
                                       )
                                       
                                          
                                             Δ
                                          
                                          
                                             u
                                          
                                       
                                       (
                                       n
                                       )
                                        
                                       ,
                                    
                                 
                              
                           
                        
                      where 
                        L
                        (
                        n
                        )
                        =
                        ∂
                        
                           
                              
                                 
                                    β
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              TxL
                           
                        
                        (
                        n
                        )
                        /
                        ∂
                        δ
                      and ν, the constant step size of the fractional delay estimator. In practice, ν can be chosen in a wide range, but must be normalized by the power of the signal 
                        
                           
                              σ
                           
                           
                              
                                 
                                    x
                                 
                                 
                                    b
                                 
                              
                           
                           
                              2
                           
                        
                     .

The final joint estimation algorithm is composed of (31)–(32), (42)–(44), and it can be expressed as:
                        
                           
                              
                                 
                                    
                                       e
                                       (
                                       n
                                       )
                                    
                                    
                                       =
                                    
                                    
                                       d
                                       (
                                       n
                                       )
                                       −
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             TxL
                                          
                                       
                                       (
                                       n
                                       )
                                       
                                          
                                             u
                                          
                                          
                                             
                                                
                                                   δ
                                                
                                                
                                                   n
                                                
                                             
                                          
                                       
                                       (
                                       n
                                       )
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             TxL
                                          
                                       
                                       (
                                       n
                                       +
                                       1
                                       )
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             TxL
                                          
                                       
                                       (
                                       n
                                       )
                                       +
                                       μ
                                       
                                          
                                             u
                                          
                                          
                                             
                                                
                                                   δ
                                                
                                                
                                                   n
                                                
                                             
                                          
                                       
                                       (
                                       n
                                       )
                                       e
                                       (
                                       n
                                       )
                                    
                                 
                                 
                                    
                                       
                                          
                                             Δ
                                          
                                          
                                             u
                                          
                                       
                                       (
                                       n
                                       )
                                    
                                    
                                       =
                                    
                                    
                                       u
                                       (
                                       n
                                       −
                                       1
                                       )
                                       −
                                       u
                                       (
                                       n
                                       )
                                    
                                 
                                 
                                    
                                       
                                          
                                             δ
                                          
                                          
                                             n
                                             +
                                             1
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             δ
                                          
                                          
                                             n
                                          
                                       
                                       +
                                       ν
                                       ℜ
                                       
                                          {
                                          
                                             [
                                             
                                                
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   T
                                                   x
                                                   L
                                                
                                             
                                             (
                                             n
                                             )
                                             
                                                
                                                   Δ
                                                
                                                
                                                   u
                                                
                                             
                                             (
                                             n
                                             )
                                             +
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             
                                                
                                                   u
                                                
                                                
                                                   
                                                      
                                                         δ
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                
                                             
                                             (
                                             n
                                             )
                                             L
                                             (
                                             n
                                             )
                                             ]
                                          
                                          
                                             
                                                e
                                             
                                             
                                                ⁎
                                             
                                          
                                          (
                                          n
                                          )
                                          }
                                       
                                    
                                 
                                 
                                    
                                       L
                                       (
                                       n
                                       +
                                       1
                                       )
                                    
                                    
                                       =
                                    
                                    
                                       
                                          (
                                          1
                                          −
                                          μ
                                          
                                             
                                                u
                                             
                                             
                                                
                                                   
                                                      δ
                                                   
                                                   
                                                      n
                                                   
                                                
                                             
                                          
                                          
                                             
                                                (
                                                n
                                                )
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       L
                                       (
                                       n
                                       )
                                       −
                                       μ
                                       d
                                       (
                                       n
                                       )
                                       
                                          
                                             Δ
                                          
                                          
                                             u
                                          
                                       
                                       (
                                       n
                                       )
                                    
                                 
                                 
                                    
                                    
                                    
                                       +
                                       2
                                       μ
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             TxL
                                          
                                       
                                       (
                                       n
                                       )
                                       
                                          
                                             u
                                          
                                          
                                             
                                                
                                                   δ
                                                
                                                
                                                   n
                                                
                                             
                                          
                                       
                                       (
                                       n
                                       )
                                       
                                          
                                             Δ
                                          
                                          
                                             u
                                          
                                       
                                       (
                                       n
                                       )
                                        
                                       .
                                    
                                 
                              
                           
                        
                      It can be seen that this algorithm is recursive, online (as it provides a compensated output 
                        e
                        (
                        n
                        )
                      at each iteration), and with low complexity. A computational complexity comparison is done at the end of Section 6.

The performance of the proposed algorithm, and the influence of both channel variations and constant fractional delay are further analyzed by simulations. In this section, the results are presented with respect to the physical parameters given in Table 2 (i.e. the normalized Doppler frequency 
                        
                           
                              f
                           
                           
                              d
                           
                        
                        
                           
                              T
                           
                           
                              Rx
                           
                        
                     , the initial SIR and the Ricean factor K). The links between the primary set of parameters (the variance of the time varying channel 
                        
                           
                              σ
                           
                           
                              
                                 
                                    α
                                 
                                 
                                    TxL
                                 
                              
                           
                           
                              2
                           
                        
                     , the constant interference level 
                        
                           
                              β
                           
                           
                              
                                 
                                    0
                                 
                                 
                                    TxL
                                 
                              
                           
                        
                      and the speed of the AR1 process 
                        
                           
                              σ
                           
                           
                              
                                 
                                    ξ
                                 
                                 
                                    TxL
                                 
                              
                           
                           
                              2
                           
                        
                     ) and the physical parameters are done with (25), (26) and (27). Besides, the parametrization of the model depends on the variance of the transmitted samples, assumed to be unitary in the rest of the paper (i.e. 
                     
                        
                           
                              σ
                           
                           
                              Tx
                           
                           
                              2
                           
                        
                        =
                        1
                      that leads to 
                        
                           
                              P
                           
                           
                              u
                           
                        
                        =
                        2
                      with (19) under the assumption of a normalized Rx filter 
                        
                           
                              h
                           
                           
                              Rx
                           
                        
                        (
                        t
                        )
                     ). Finally, as TxL is detrimental for the cell edges, where the power of the input signal is low [9] and thus the interference level is strong, we consider an initial SIR of 0 dB with 
                        
                           
                              σ
                           
                           
                              
                                 
                                    x
                                 
                                 
                                    b
                                 
                              
                           
                           
                              2
                           
                        
                        =
                        
                           
                              10
                           
                           
                              −
                              8
                           
                        
                     .

We first consider the synchronized case, in Fig. 4
                        , where the TxL channel is assumed to follow an AR1 model added to a constant value, as described in (12) and (13), and where the fractional delay is assumed to be perfectly known. The K factor defined in (15) is set to 10. We compare the asymptotic theoretical SIR to a simulated one versus the step size of the gain estimation algorithm, for several values of normalized Doppler frequency 
                           
                              
                                 f
                              
                              
                                 d
                              
                           
                           
                              
                                 T
                              
                              
                                 Rx
                              
                           
                        , and with the optimal step value described in (37). The range of normalized Doppler frequency is set to have a coherence time from approximatively 1 ms (related to worst case scenario in [18]) to several hundred seconds. It is shown that the simulated performance is coherent with the theory, and that the channel influence limits the asymptotic performance.


                        Fig. 5
                         shows the evolution of the simulated maximal SIR versus the normalized Doppler frequency of the AR1 channel, with the Ricean factor 
                           K
                           =
                           10
                        , and it validates the theory elaborated in (38). As seen in (25), the faster the channel, the lower the performance. In practice, assuming the knowledge of the statistics of the channel (AR1 variance 
                           
                              
                                 σ
                              
                              
                                 
                                    
                                       α
                                    
                                    
                                       TxL
                                    
                                 
                              
                              
                                 2
                              
                           
                        , and state noise variance 
                           
                              
                                 σ
                              
                              
                                 
                                    
                                       ξ
                                    
                                    
                                       TxL
                                    
                                 
                              
                              
                                 2
                              
                           
                         through 
                           
                              
                                 f
                              
                              
                                 d
                              
                           
                           
                              
                                 T
                              
                              
                                 Rx
                              
                           
                         with (25)), the gain estimation process can be optimally tuned to provide the best asymptotic performance.


                        Fig. 6
                         shows the performance of the LMS algorithm versus the step size of the algorithm for several values of K (which represents the ratio between the static and dynamic parts of the TxL channel, expressed in dB). We still consider an AR1 model to approximate the time-varying TxL channel, with 
                           
                              
                                 f
                              
                              
                                 d
                              
                           
                           
                              
                                 T
                              
                              
                                 Rx
                              
                           
                         of 
                           
                              
                                 10
                              
                              
                                 −
                                 8
                              
                           
                        . It is shown that the simulation agrees with the theory expressed in (33), and that in the case of a purely static channel (
                           K
                           →
                           ∞
                        ), the performance of the LMS algorithm becomes linear with respect to the step size, as in this case, 
                           Q
                           (
                           
                              
                                 P
                              
                              
                                 u
                              
                           
                           ,
                           
                              
                                 σ
                              
                              
                                 
                                    
                                       α
                                    
                                    
                                       TxL
                                    
                                 
                              
                              
                                 2
                              
                           
                           ,
                           γ
                           )
                         is negligible. If the static part becomes negligible with respect to the dynamic part (when K, expressed in dB, is negative), the performance reaches a boundary due to the impact of the factor 
                           Q
                           (
                           
                              
                                 P
                              
                              
                                 u
                              
                           
                           ,
                           
                              
                                 σ
                              
                              
                                 
                                    
                                       α
                                    
                                    
                                       TxL
                                    
                                 
                              
                              
                                 2
                              
                           
                           ,
                           γ
                           )
                        .

We now consider the impact of noncompensation of the fractional delay and the asymptotic performance of the joint estimation scheme. We still use an AR1 model for the TxL channel, as in (13), and 
                           
                              
                                 f
                              
                              
                                 d
                              
                           
                           
                              
                                 T
                              
                              
                                 Rx
                              
                           
                           =
                           
                              
                                 10
                              
                              
                                 −
                                 9
                              
                           
                        . Fig. 7
                         shows the asymptotic performance of the LMS versus the step size, for several values of fractional delay, and we compare this to the synchronized asymptotic performance (33). Again, agreement with the theory described in (41) is shown, and it can be noted that in practice, a fractional delay will severely degrade the performance of the algorithm if it exceeds 0.02, which means 2 percent of the Rx sampling time.

This justifies that a joint estimation scheme must be investigated if the fractional delay is unknown. Fig. 7 shows the asymptotic performance of the joint estimation algorithm versus the step size of the gain estimator process, for 
                           ν
                           =
                           
                              
                                 10
                              
                              
                                 −
                                 6
                              
                           
                           /
                           
                              
                                 σ
                              
                              
                                 
                                    
                                       x
                                    
                                    
                                       b
                                    
                                 
                              
                              
                                 2
                              
                           
                        . It is shown that this algorithm provides a very good asymptotic performance for different values of fractional delay, as it almost reaches the boundary defined by the theoretical synchronized performance (33). It is also shown that the performance of the proposed algorithm is independent from the FD value, as the performance with the joint estimation algorithm is similar in the range of the simulated FDs.

From Fig. 4 to Fig. 6, the desired signal was a complex Gaussian white signal. We recall that the assumption of an uncorrelated (stationary) signal has been made to derive the analytic performance formulae, and we propose in Fig. 8
                         to validate also the theoretical performance on a typical (cyclostationary) signal used in communication systems. We use an orthogonal multiplexing division multiplexing (OFDM) signal with 72 quadrature phase-shift keying (QPSK) subcarriers, a fast Fourier transform of size of 128, and a cyclic prefix of size nine samples for both transmission and reception. We display the asymptotic simulated performances for different fractional delays versus the step-size of the joint estimation algorithm. It is shown that, for this particular use-case, the simulated results corroborate with the theory that was obtained for a white signal in (41).

Up to now, we have discussed the performance in terms of the SIR for both correlated and uncorrelated signals. We now look at bit error rate simulations. For this, we assume a FDD framework where the Tx and Rx signals share the same modulation parameters, and where the TxL channel is assumed to be a complex AR1 channel with a fractional delay between the Rx path and the Tx path of 0.2 samples. We synthesize a reference 
                           u
                           (
                           n
                           )
                         following (19) with power of 2 (as 
                           
                              
                                 σ
                              
                              
                                 Tx
                              
                              
                                 2
                              
                           
                           =
                           1
                        ), and we assume a power entry signal of 
                           −
                           80
                            
                           dB
                         (cell edge context) with 
                           K
                           =
                           10
                         and 
                           
                              
                                 f
                              
                              
                                 d
                              
                           
                           
                              
                                 T
                              
                              
                                 Rx
                              
                           
                           =
                           
                              
                                 10
                              
                              
                                 −
                                 9
                              
                           
                        .

We first consider a WCDMA framework based on quadrature phase-shift keying modulation. The code is an orthogonal variable spreading factor code of length 16, and a scrambling sequence of size 
                              38
                              
                              400
                            is also used. Square root raised cosine filters are used both in transmission and reception, with a roll-off factor of 0.22. We show in Fig. 9
                            the results of the bit error rate performance without the compensation system and with a joint estimation compensation scheme (with 
                              μ
                              =
                              2
                              ⋅
                              
                                 
                                    10
                                 
                                 
                                    −
                                    5
                                 
                              
                            and 
                              η
                              =
                              
                                 
                                    10
                                 
                                 
                                    −
                                    6
                                 
                              
                           ) for different values of 
                              E
                              b
                              /
                              N
                              o
                            (where Eb is the energy per bit, and 
                              
                                 
                                    N
                                 
                                 
                                    0
                                 
                              
                            is the white additive noise spectral density), and for different SIRs. Here, the initial SIRs are computed from only the power of the desired signal, without taking into account the additive white noise, to have constant TxL pollution power versus the channel signal-to-noise ratio. We show that our method greatly reduces the bit error rate, and that the compensated bit error rate comes close to the ideal channel influence 
                              Q
                              
                                 (
                                 
                                    
                                       2
                                       
                                          
                                             E
                                          
                                          
                                             b
                                          
                                       
                                       /
                                       
                                          
                                             N
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 )
                              
                           .

We now compare the bit error rate for the case of simplified long-term evolution (LTE) modulation that is based on the third generation partnership project model [28]. The data signal follows LTE 1.4 MHz bandwidth specifications based on OFDM, with 72 quadrature phase-shift keying subcarriers, a fast Fourier transform of size 128, and a cyclic prefix of length of nine samples. The bit error-rate is computed on the uncoded bits of the data and through an additive white Gaussian noise channel with various signal-to-noise ratios. We consider that the noisy signal is polluted by TxL and that the transmitted signal has the same modulation parameters. Fig. 10
                            shows the results of the bit error rate without compensation and with the joint estimation scheme (with 
                              μ
                              =
                              2
                              ⋅
                              
                                 
                                    10
                                 
                                 
                                    −
                                    5
                                 
                              
                            and 
                              η
                              =
                              
                                 
                                    10
                                 
                                 
                                    −
                                    6
                                 
                              
                           ) for different values of the channel signal-to-noise ratio and for different SIRs. The theoretical performance without TxL (i.e., only the influence of the channel) is shown in black in Fig. 10. Again, it shows that TxL has a detrimental impact on performance, and that the proposed system greatly reduces the bit error rate.

In this paper, we have assumed a frequency flat channel for the duplexer that is equivalent to consider a Dirac distribution as a time impulse response. As a consequence, the compensation scheme aims to estimate the amplitude of this Dirac and its fractional delay. Frequency flat duplexer channels are often used in the literature, as for example by [16,5,29,22], and this hypothesis can be partially justified through a typical isolation profile, as described for example by [30], which shows only a little attenuation variation in the transmission and reception bands (typically less than 2 dB). However, a purely frequency flat channel is a limiting case, and as in practice, it is equivalent to an estimation of only the mean contribution of the filter, with the other contributions of the TxL filter being neglected. A more realistic assumption would be to consider a quasi-flat TxL channel i.e., a filter with a main but nonunique component in its time impulse response.

From the initial profile, we propose to synthesize a filter that respects the initial pattern proposed by [30]. We next apply our method on a polluting model, where the complex gain is replaced by the synthesized filter. We assume here nontime-varying filter coefficients and an important oversampling factor. The frequency and time impulse responses obtained are shown in the Fig. 11
                        .

The synthesized time impulse response is narrow with respect to the receiver sampling time 
                           
                              
                                 T
                              
                              
                                 Rx
                              
                           
                        , which is coherent with a quasi-flat channel assumption. The proposed joint estimation algorithm estimates and suppresses the most important component of the filter impulse response, and we show in Fig. 12
                         the convergence of the complex gain and the fractional delay, and the mean performance of the structure. This shows that even in a quasi-flat channel, the proposed structure has good performance and can reduce the influence of the TxL pollution. In such a case, the fractional delay estimated by our algorithm is expected to converge to the position of the maximum of the time impulse response of the synthesized filter (this position is denoted as ‘expected fractional delay’). We want to now compare our method with the TxL compensation method presented by [15] (and variations of this method can be found in [16,22,31]), based on a multitap LMS canceller. Fig. 13
                         compares the performances of this multitap-LMS (with 8 taps) and the performance of the proposed scheme for the synthesized filter, with several values of the expected fractional delay. It can be seen that the proposed scheme has better asymptotic performance than the multitap LMS, especially in the case of a nonnegligible fractional delay value. We finally compare in Table 3
                         the complexity (real operators) of the proposed JE algorithm, in terms of additions, multiplications and shifts (as the steps μ and η are tuned to a power of 2) and a comparison with the classical multi-tap LMS versus the number of the taps and applied for 8 taps, as used in Fig. 13. It is shown that the proposed method, in addition to have better asymptotic performance than classical multi-tap approach even in the proposed frequency selective TxL channel scenario, also offers a lower computational complexity.

@&#CONCLUSION@&#

This study focuses on joint estimation of fractional delay and channel gain for compensation for TxL pollution in FDD transceivers. We consider a time-varying TxL channel that is assumed to follow a first-order auto-regressive model added to a constant value, and we consider the presence of a fractional delay to model propagation effects of the analog and digital parts. We first derived analytic formulae of the asymptotic signal-to-interference ratio of a gain estimator based on a LMS approach in the synchronized case, and we have shown that the time-varying channel limits the asymptotic performance. Then, we expressed the influence of the fractional delay in terms of asymptotic SIR, to show that it must be estimated upstream in the compensation stage. We finally proposed a compensation algorithm based on joint estimation of the fractional delay and the complex channel gain. This adaptive algorithm is recursive and online, and it proposes good asymptotic performance with low complexity. We also tested the behavior of the proposed method in the case of a selective TxL channel case, and we have shown that the method is robust and provides better performance than a classical multi-tap LMS approach. As a perspective to this work, the model of the Tx-leakage channel could be completed to take into account the delay spread of this channel, in addition to the coherence time. This could be useful when the TxL channel exhibits a strong frequency selectivity.

We introduce the difference between the ideal coefficient 
                        
                           
                              β
                           
                           
                              TxL
                           
                        
                        (
                        n
                        )
                      and the iterative coefficient 
                        
                           
                              
                                 
                                    β
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              TxL
                           
                        
                        (
                        n
                        )
                     , called the misalignment error 
                        v
                        (
                        n
                        )
                      
                     [32]:
                        
                           (45)
                           
                              v
                              (
                              n
                              )
                              =
                              
                                 
                                    
                                       
                                          β
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    TxL
                                 
                              
                              (
                              n
                              )
                              −
                              
                                 
                                    β
                                 
                                 
                                    TxL
                                 
                              
                              (
                              n
                              )
                               
                              .
                           
                        
                      From (45) using (20), (17), (29) and (31), 
                        ϵ
                        (
                        n
                        )
                      can be expressed as
                        
                           (46)
                           
                              ϵ
                              (
                              n
                              )
                              =
                              −
                              v
                              (
                              n
                              )
                              
                                 
                                    u
                                 
                                 
                                    δ
                                 
                              
                              (
                              n
                              )
                               
                              ,
                           
                        
                      and the SIR can be expressed as a function of the mean square misalignment:
                        
                           (47)
                           
                              
                                 
                                    SIR
                                 
                                 
                                    comp
                                 
                              
                              =
                              −
                              10
                              
                                 
                                    log
                                 
                                 
                                    10
                                 
                              
                              
                                 [
                                 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             u
                                          
                                       
                                       
                                          
                                             P
                                          
                                          
                                             v
                                          
                                       
                                    
                                    
                                       
                                          σ
                                       
                                       
                                          
                                             
                                                x
                                             
                                             
                                                b
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                                 ]
                              
                               
                           
                        
                      where 
                        
                           
                              P
                           
                           
                              u
                           
                        
                      is the power of the reference defined in (19), and 
                        
                           
                              P
                           
                           
                              v
                           
                        
                      is the mean square misalignment. With (12), (13), (17)–(32), the recursive expression of the misalignment is:
                        
                           (48)
                           
                              
                                 
                                    
                                       v
                                       (
                                       n
                                       +
                                       1
                                       )
                                    
                                    
                                       =
                                    
                                    
                                       (
                                       1
                                       −
                                       μ
                                       |
                                       
                                          
                                             u
                                          
                                          
                                             δ
                                          
                                       
                                       (
                                       n
                                       )
                                       
                                          
                                             |
                                          
                                          
                                             2
                                          
                                       
                                       )
                                       v
                                       (
                                       n
                                       )
                                       +
                                       μ
                                       
                                          
                                             u
                                          
                                          
                                             δ
                                          
                                       
                                       (
                                       n
                                       )
                                       
                                          
                                             x
                                          
                                          
                                             b
                                          
                                       
                                       (
                                       n
                                       )
                                    
                                 
                                 
                                    
                                    
                                    
                                       −
                                       
                                          
                                             ξ
                                          
                                          
                                             TxL
                                          
                                       
                                       (
                                       n
                                       +
                                       1
                                       )
                                       +
                                       (
                                       1
                                       −
                                       γ
                                       )
                                       
                                          
                                             α
                                          
                                          
                                             TxL
                                          
                                       
                                       (
                                       n
                                       )
                                        
                                       .
                                    
                                 
                              
                           
                        
                      As 
                        
                           
                              ξ
                           
                           
                              TxL
                           
                        
                        (
                        n
                        )
                      and 
                        
                           
                              x
                           
                           
                              b
                           
                        
                        (
                        n
                        )
                      are assumed to be white uncorrelated processes, the mean square misalignment can be expressed as:
                        
                           (49)
                           
                              
                                 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             v
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             (
                                             1
                                             −
                                             μ
                                             
                                                
                                                   P
                                                
                                                
                                                   u
                                                
                                             
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             P
                                          
                                          
                                             v
                                          
                                       
                                       +
                                       
                                          
                                             μ
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             P
                                          
                                          
                                             u
                                          
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   b
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       2
                                       
                                          (
                                          1
                                          −
                                          γ
                                          )
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   TxL
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       +
                                       2
                                       
                                          (
                                          1
                                          −
                                          μ
                                          
                                             
                                                P
                                             
                                             
                                                u
                                             
                                          
                                          )
                                       
                                       
                                          (
                                          1
                                          −
                                          γ
                                          )
                                       
                                       E
                                       
                                          [
                                          |
                                          
                                             
                                                α
                                             
                                             
                                                TxL
                                             
                                          
                                          (
                                          n
                                          )
                                          v
                                          (
                                          n
                                          )
                                          |
                                          ]
                                       
                                        
                                       .
                                    
                                 
                              
                           
                        
                      Using both recursive expressions of 
                        
                           
                              α
                           
                           
                              TxL
                           
                        
                        (
                        n
                        )
                      and 
                        v
                        (
                        n
                        )
                     , defined in (13) and (48), respectively, we have:
                        
                           (50)
                           
                              E
                              
                                 [
                                 |
                                 
                                    
                                       α
                                    
                                    
                                       TxL
                                    
                                 
                                 (
                                 n
                                 )
                                 v
                                 (
                                 n
                                 )
                                 |
                                 ]
                              
                              =
                              
                                 
                                    −
                                    
                                       (
                                       1
                                       −
                                       γ
                                       )
                                    
                                    
                                       
                                          σ
                                       
                                       
                                          
                                             
                                                α
                                             
                                             
                                                TxL
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                                 
                                    1
                                    −
                                    γ
                                    
                                       (
                                       1
                                       −
                                       μ
                                       
                                          
                                             P
                                          
                                          
                                             u
                                          
                                       
                                       )
                                    
                                 
                              
                               
                              ,
                           
                        
                      and replacing (50) in (49), we have
                        
                           
                              
                                 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             v
                                          
                                       
                                       
                                          [
                                          μ
                                          
                                             
                                                P
                                             
                                             
                                                u
                                             
                                          
                                          (
                                          2
                                          −
                                          μ
                                          
                                             
                                                P
                                             
                                             
                                                u
                                             
                                          
                                          )
                                          ]
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             μ
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             P
                                          
                                          
                                             u
                                          
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   b
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       2
                                       
                                          (
                                          1
                                          −
                                          γ
                                          )
                                       
                                       ×
                                       
                                          [
                                          
                                             
                                                σ
                                             
                                             
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      TxL
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          −
                                          
                                             
                                                
                                                   (
                                                   1
                                                   −
                                                   μ
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   )
                                                
                                                
                                                   (
                                                   1
                                                   −
                                                   γ
                                                   )
                                                
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      
                                                         
                                                            α
                                                         
                                                         
                                                            TxL
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                1
                                                −
                                                γ
                                                
                                                   (
                                                   1
                                                   −
                                                   μ
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          ]
                                       
                                    
                                 
                              
                           
                        
                      which is equivalent to
                        
                           
                              
                                 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             v
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             μ
                                             
                                                
                                                   σ
                                                
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         b
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             2
                                             −
                                             μ
                                             
                                                
                                                   P
                                                
                                                
                                                   u
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             2
                                             
                                                
                                                   σ
                                                
                                                
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         TxL
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                (
                                                1
                                                −
                                                γ
                                                )
                                             
                                          
                                          
                                             μ
                                             
                                                
                                                   P
                                                
                                                
                                                   u
                                                
                                             
                                             (
                                             2
                                             −
                                             μ
                                             
                                                
                                                   P
                                                
                                                
                                                   u
                                                
                                             
                                             )
                                             (
                                             1
                                             −
                                             γ
                                             
                                                (
                                                1
                                                −
                                                μ
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      u
                                                   
                                                
                                                )
                                             
                                             )
                                          
                                       
                                       ×
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          [
                                          1
                                          −
                                          γ
                                          
                                             (
                                             1
                                             −
                                             μ
                                             
                                                
                                                   P
                                                
                                                
                                                   u
                                                
                                             
                                             )
                                          
                                          −
                                          (
                                          1
                                          −
                                          μ
                                          
                                             
                                                P
                                             
                                             
                                                u
                                             
                                          
                                          )
                                          (
                                          1
                                          −
                                          γ
                                          )
                                          ]
                                       
                                        
                                       ,
                                    
                                 
                              
                           
                        
                      and the final expression of the mean square misalignment is finally
                        
                           (51)
                           
                              
                                 
                                    
                                       P
                                    
                                    
                                       v
                                    
                                 
                                 =
                                 
                                    
                                       μ
                                       
                                          
                                             σ
                                          
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   b
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       2
                                       −
                                       μ
                                       
                                          
                                             P
                                          
                                          
                                             u
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       2
                                       
                                          
                                             σ
                                          
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   TxL
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          1
                                          −
                                          γ
                                          )
                                       
                                       μ
                                       
                                          
                                             P
                                          
                                          
                                             u
                                          
                                       
                                    
                                    
                                       μ
                                       
                                          
                                             P
                                          
                                          
                                             u
                                          
                                       
                                       (
                                       2
                                       −
                                       μ
                                       
                                          
                                             P
                                          
                                          
                                             u
                                          
                                       
                                       )
                                       (
                                       1
                                       −
                                       γ
                                       
                                          (
                                          1
                                          −
                                          μ
                                          
                                             
                                                P
                                             
                                             
                                                u
                                             
                                          
                                          )
                                       
                                       )
                                    
                                 
                                  
                                 .
                              
                           
                        
                      Finally, by reintroducing (51) in (47), we obtain the asymptotic SIR defined in (33) and the channel variations impact factor 
                        Q
                        (
                        
                           
                              P
                           
                           
                              u
                           
                        
                        ,
                        
                           
                              σ
                           
                           
                              
                                 
                                    α
                                 
                                 
                                    TxL
                                 
                              
                           
                           
                              2
                           
                        
                        ,
                        γ
                        )
                      described in (34).

If we assume linear interpolation for 
                        
                           
                              u
                           
                           
                              δ
                           
                        
                        (
                        n
                        )
                     , we have:
                        
                           (52)
                           
                              
                                 
                                    u
                                 
                                 
                                    
                                       
                                          δ
                                       
                                       
                                          n
                                       
                                    
                                 
                              
                              (
                              n
                              )
                              =
                              (
                              1
                              −
                              δ
                              )
                              u
                              (
                              n
                              )
                              +
                              δ
                              u
                              (
                              n
                              −
                              1
                              )
                           
                        
                      and from (39), we also have:
                        
                           (53)
                           
                              
                                 
                                    η
                                 
                                 
                                    TxL
                                 
                              
                              (
                              n
                              )
                              =
                              
                                 
                                    u
                                 
                                 
                                    
                                       
                                          δ
                                       
                                       
                                          n
                                       
                                    
                                 
                              
                              (
                              n
                              )
                              −
                              u
                              (
                              n
                              )
                              =
                              −
                              δ
                              
                                 [
                                 u
                                 (
                                 n
                                 )
                                 −
                                 u
                                 (
                                 n
                                 −
                                 1
                                 )
                                 ]
                              
                           
                        
                      From the reference generation of (19), as the reference is a chi-squared distributed, we have 
                        E
                        [
                        |
                        u
                        (
                        n
                        )
                        |
                        ]
                        =
                        
                           
                              σ
                           
                           
                              Tx
                           
                           
                              2
                           
                        
                      and 
                        
                           
                              P
                           
                           
                              u
                           
                        
                        =
                        2
                        
                           
                              σ
                           
                           
                              Tx
                           
                           
                              4
                           
                        
                     , with 
                        
                           
                              σ
                           
                           
                              Tx
                           
                           
                              2
                           
                        
                      as the variance of the transmitted samples. Thus:
                        
                           
                              
                                 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             
                                                
                                                   η
                                                
                                                
                                                   TxL
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       E
                                       
                                          [
                                          |
                                          
                                             
                                                η
                                             
                                             
                                                TxL
                                             
                                          
                                          (
                                          n
                                          )
                                          
                                             
                                                |
                                             
                                             
                                                2
                                             
                                          
                                          ]
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             δ
                                          
                                          
                                             2
                                          
                                       
                                       E
                                       
                                          [
                                          |
                                          u
                                          (
                                          n
                                          )
                                          −
                                          u
                                          (
                                          n
                                          −
                                          1
                                          )
                                          
                                             
                                                |
                                             
                                             
                                                2
                                             
                                          
                                          ]
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             δ
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          E
                                          
                                             [
                                             |
                                             u
                                             (
                                             n
                                             )
                                             
                                                
                                                   |
                                                
                                                
                                                   2
                                                
                                             
                                             ]
                                          
                                          +
                                          E
                                          
                                             [
                                             |
                                             u
                                             (
                                             n
                                             −
                                             1
                                             )
                                             
                                                
                                                   |
                                                
                                                
                                                   2
                                                
                                             
                                             ]
                                          
                                          −
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          2
                                          E
                                          
                                             [
                                             |
                                             u
                                             (
                                             n
                                             )
                                             u
                                             (
                                             n
                                             −
                                             1
                                             )
                                             |
                                             ]
                                          
                                          )
                                       
                                    
                                 
                              
                           
                        
                      Assuming independence between 
                        u
                        (
                        n
                        )
                      and 
                        u
                        (
                        n
                        −
                        1
                        )
                     ,
                        
                           
                              
                                 
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             
                                                
                                                   η
                                                
                                                
                                                   TxL
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             δ
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   E
                                                   
                                                      [
                                                      |
                                                      u
                                                      (
                                                      n
                                                      )
                                                      
                                                         
                                                            |
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      ]
                                                   
                                                
                                                ︸
                                             
                                             
                                                2
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      Tx
                                                   
                                                   
                                                      4
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   E
                                                   
                                                      [
                                                      |
                                                      u
                                                      (
                                                      n
                                                      −
                                                      1
                                                      )
                                                      
                                                         
                                                            |
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      ]
                                                   
                                                
                                                ︸
                                             
                                             
                                                2
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      Tx
                                                   
                                                   
                                                      4
                                                   
                                                
                                             
                                          
                                          −
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          2
                                          
                                             
                                                
                                                   E
                                                   
                                                      [
                                                      |
                                                      u
                                                      (
                                                      n
                                                      )
                                                      |
                                                      ]
                                                   
                                                
                                                ︸
                                             
                                             
                                                
                                                   σ
                                                
                                                
                                                   Tx
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                
                                                   E
                                                   
                                                      [
                                                      |
                                                      u
                                                      (
                                                      n
                                                      −
                                                      1
                                                      )
                                                      |
                                                      ]
                                                   
                                                
                                                ︸
                                             
                                             
                                                
                                                   σ
                                                
                                                
                                                   Tx
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          )
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       2
                                       
                                          
                                             δ
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             Tx
                                          
                                          
                                             4
                                          
                                       
                                       =
                                       
                                          
                                             δ
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             P
                                          
                                          
                                             u
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

In the case of a noncompensated fractional delay, from (20) and (45), the estimation error becomes:
                        
                           (54)
                           
                              ϵ
                              (
                              n
                              )
                              =
                              −
                              v
                              (
                              n
                              )
                              u
                              (
                              n
                              )
                              +
                              
                                 
                                    β
                                 
                                 
                                    TxL
                                 
                              
                              (
                              n
                              )
                              
                                 
                                    η
                                 
                                 
                                    TxL
                                 
                              
                              (
                              n
                              )
                               
                              ,
                           
                        
                      and the SIR can be expressed as:
                        
                           (55)
                           
                              
                                 
                                    SIR
                                 
                                 
                                    comp
                                 
                              
                              =
                              −
                              10
                              
                                 
                                    log
                                 
                                 
                                    10
                                 
                              
                              
                                 [
                                 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             u
                                          
                                       
                                       
                                          
                                             P
                                          
                                          
                                             v
                                          
                                       
                                    
                                    
                                       
                                          σ
                                       
                                       
                                          
                                             
                                                x
                                             
                                             
                                                b
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                                 +
                                 
                                    (
                                    |
                                    
                                       
                                          β
                                       
                                       
                                          
                                             
                                                0
                                             
                                             
                                                TxL
                                             
                                          
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          σ
                                       
                                       
                                          
                                             
                                                α
                                             
                                             
                                                TxL
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          
                                             
                                                η
                                             
                                             
                                                TxL
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          σ
                                       
                                       
                                          
                                             
                                                x
                                             
                                             
                                                b
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                                 ]
                              
                               
                              .
                           
                        
                      With the same demonstration process that led to (48), the recursive expression of the misalignment can be expressed as:
                        
                           (56)
                           
                              
                                 
                                    
                                       v
                                       (
                                       n
                                       +
                                       1
                                       )
                                    
                                    
                                       =
                                    
                                    
                                       (
                                       1
                                       −
                                       μ
                                       |
                                       u
                                       (
                                       n
                                       )
                                       
                                          
                                             |
                                          
                                          
                                             2
                                          
                                       
                                       )
                                       v
                                       (
                                       n
                                       )
                                       +
                                       μ
                                       u
                                       (
                                       n
                                       )
                                       
                                          
                                             x
                                          
                                          
                                             b
                                          
                                       
                                       (
                                       n
                                       )
                                    
                                 
                                 
                                    
                                    
                                    
                                       −
                                       
                                          
                                             ξ
                                          
                                          
                                             TxL
                                          
                                       
                                       (
                                       n
                                       )
                                       +
                                       (
                                       1
                                       −
                                       γ
                                       )
                                       
                                          
                                             α
                                          
                                          
                                             TxL
                                          
                                       
                                       (
                                       n
                                       )
                                    
                                 
                                 
                                    
                                    
                                    
                                       +
                                       μ
                                       u
                                       (
                                       n
                                       )
                                       
                                          
                                             β
                                          
                                          
                                             TxL
                                          
                                       
                                       (
                                       n
                                       )
                                       
                                          
                                             η
                                          
                                          
                                             TxL
                                          
                                       
                                       (
                                       n
                                       +
                                       1
                                       )
                                       .
                                        
                                    
                                 
                              
                           
                        
                      Assuming that 
                        
                           
                              η
                           
                           
                              TxL
                           
                        
                        (
                        n
                        )
                      is white additive zero-mean Gaussian noise, of variance 
                        
                           
                              σ
                           
                           
                              
                                 
                                    η
                                 
                                 
                                    TxL
                                 
                              
                           
                           
                              2
                           
                        
                     , and with (34), the power of the misalignment can be expressed as:
                        
                           (57)
                           
                              
                                 
                                    
                                       
                                          
                                             P
                                          
                                          
                                             v
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             (
                                             1
                                             −
                                             μ
                                             
                                                
                                                   P
                                                
                                                
                                                   u
                                                
                                             
                                             )
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             P
                                          
                                          
                                             v
                                          
                                       
                                       +
                                       
                                          
                                             μ
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             P
                                          
                                          
                                             u
                                          
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   b
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       +
                                       
                                          
                                             μ
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             P
                                          
                                          
                                             u
                                          
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             
                                                
                                                   η
                                                
                                                
                                                   TxL
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   TxL
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       Q
                                       (
                                       
                                          
                                             P
                                          
                                          
                                             u
                                          
                                       
                                       ,
                                       
                                          
                                             σ
                                          
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   TxL
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       γ
                                       )
                                        
                                       ,
                                    
                                 
                              
                           
                        
                      and reintroducing (57) in (55) leads to the asymptotic SIR performance described in (41).

We use a stochastic gradient descent to update the fractional delay estimation, with the same cost function 
                        J
                        (
                        n
                        )
                      as in the gain estimator:
                        
                           (58)
                           
                              
                                 J
                                 (
                                 n
                                 )
                                 =
                                 E
                                 
                                    [
                                    |
                                    e
                                    (
                                    n
                                    )
                                    
                                       
                                          |
                                       
                                       
                                          2
                                       
                                    
                                    ]
                                 
                              
                           
                        
                     
                     
                        
                           (59)
                           
                              
                                 
                                    
                                       δ
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       δ
                                    
                                    
                                       n
                                    
                                 
                                 −
                                 ν
                                 
                                    
                                       ∂
                                       J
                                       (
                                       n
                                       )
                                    
                                    
                                       ∂
                                       δ
                                    
                                 
                              
                           
                        
                      with ν the constant step size of the fractional delay estimation process. By minimizing the instantaneous power of the output 
                        e
                        (
                        n
                        )
                      which is a complex signal [33], the update becomes:
                        
                           (60)
                           
                              
                                 
                                    
                                       
                                          
                                             ∂
                                             J
                                             (
                                             n
                                             )
                                          
                                          
                                             ∂
                                             δ
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       2
                                       ℜ
                                       
                                          (
                                          
                                             
                                                e
                                             
                                             
                                                ⁎
                                             
                                          
                                          (
                                          n
                                          )
                                          
                                             
                                                e
                                                (
                                                n
                                                )
                                             
                                             
                                                ∂
                                                δ
                                             
                                          
                                          )
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       −
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             T
                                             x
                                             L
                                          
                                       
                                       (
                                       n
                                       )
                                       
                                          
                                             ∂
                                             
                                                
                                                   u
                                                
                                                
                                                   
                                                      
                                                         δ
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                
                                             
                                             (
                                             n
                                             )
                                          
                                          
                                             ∂
                                             δ
                                          
                                       
                                       −
                                       
                                          
                                             u
                                          
                                          
                                             
                                                
                                                   δ
                                                
                                                
                                                   n
                                                
                                             
                                          
                                       
                                       (
                                       n
                                       )
                                       
                                          
                                             ∂
                                             
                                                
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   T
                                                   x
                                                   L
                                                
                                             
                                             (
                                             n
                                             )
                                          
                                          
                                             ∂
                                             δ
                                          
                                       
                                       .
                                    
                                 
                              
                           
                        
                      We consider the approximation:
                        
                           (61)
                           
                              
                                 
                                    ∂
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                δ
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                    (
                                    n
                                    )
                                 
                                 
                                    ∂
                                    δ
                                 
                              
                              ≈
                              
                                 
                                    Δ
                                 
                                 
                                    u
                                 
                              
                              (
                              n
                              )
                              =
                              u
                              (
                              n
                              −
                              1
                              )
                              −
                              u
                              (
                              n
                              )
                               
                              ,
                           
                        
                      which is the first-order Taylor decomposition of the derivative component 
                        ∂
                        
                           
                              u
                           
                           
                              
                                 
                                    δ
                                 
                                 
                                    n
                                 
                              
                           
                        
                        (
                        n
                        )
                        /
                        ∂
                        δ
                     . We denote 
                        L
                        (
                        n
                        )
                        =
                        ∂
                        
                           
                              
                                 
                                    β
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              T
                              x
                              L
                           
                        
                        (
                        n
                        )
                        /
                        ∂
                        δ
                     , and the recursive expression of 
                        L
                        (
                        n
                        )
                      can be obtain with (32) as:
                        
                           (62)
                           
                              
                                 
                                    
                                       L
                                       (
                                       n
                                       +
                                       1
                                       )
                                    
                                    
                                       =
                                    
                                    
                                       
                                          (
                                          1
                                          −
                                          μ
                                          |
                                          
                                             
                                                u
                                             
                                             
                                                
                                                   
                                                      δ
                                                   
                                                   
                                                      n
                                                   
                                                
                                             
                                          
                                          (
                                          n
                                          )
                                          
                                             
                                                |
                                             
                                             
                                                2
                                             
                                          
                                          )
                                       
                                       L
                                       (
                                       n
                                       )
                                       +
                                       2
                                       μ
                                       
                                          
                                             u
                                          
                                          
                                             
                                                
                                                   δ
                                                
                                                
                                                   n
                                                
                                             
                                          
                                       
                                       (
                                       n
                                       )
                                       
                                          
                                             Δ
                                          
                                          
                                             u
                                          
                                       
                                       (
                                       n
                                       )
                                    
                                 
                                 
                                    
                                    
                                    
                                       −
                                       μ
                                       d
                                       (
                                       n
                                       )
                                       
                                          
                                             Δ
                                          
                                          
                                             u
                                          
                                       
                                       (
                                       n
                                       )
                                       .
                                    
                                 
                              
                           
                        
                      From (59) and (60), the update of the fractional delay estimation is:
                        
                           (63)
                           
                              
                                 
                                    δ
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    δ
                                 
                                 
                                    n
                                 
                              
                              +
                              ν
                              ℜ
                              
                                 {
                                 
                                    [
                                    
                                       
                                          
                                             
                                                β
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          T
                                          x
                                          L
                                       
                                    
                                    (
                                    n
                                    )
                                    
                                       
                                          Δ
                                       
                                       
                                          u
                                       
                                    
                                    (
                                    n
                                    )
                                    +
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                δ
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                    (
                                    n
                                    )
                                    L
                                    (
                                    n
                                    )
                                    ]
                                 
                                 
                                    
                                       e
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 n
                                 )
                                 }
                              
                               
                              .
                           
                        
                      And finally, the fractional delay estimation algorithm is set from (61)–(63).

@&#REFERENCES@&#

