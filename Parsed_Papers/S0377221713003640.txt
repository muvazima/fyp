@&#MAIN-TITLE@&#Linear models for the approximate solution of the problem of packing equal circles into a given domain

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Linear model for circles packing problem to the given domain is proposed.


                        
                        
                           
                           Heuristic algorithm using linear models for packing circles is proposed.


                        
                        
                           
                           Effectiveness of the linear models for packing circles is demonstrated.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Packing problem

Linear models for packing

Packing circles into a given domain

@&#ABSTRACT@&#


               
               
                  The linear models for the approximate solution of the problem of packing the maximum number of equal circles of the given radius into a given closed bounded domain G are proposed. We construct a grid in G; the nodes of this grid form a finite set of points T, and it is assumed that the centers of circles to be packed can be placed only at the points of T. The packing problems of equal circles with the centers at the points of T are reduced to 0–1 linear programming problems. A heuristic algorithm for solving the packing problems based on linear models is proposed. This algorithm makes it possible to solve packing problems for arbitrary connected closed bounded domains independently of their shape in a unified manner. Numerical results demonstrating the effectiveness of this approach are presented.
               
            

@&#INTRODUCTION@&#

The problem of packing circles in the plane or into a square, triangle, or circle and other geometric configurations in the plane is studied by many researchers; various approaches to the solution of such problems have been developed, see Birgin and Gentil [1], Birgin et al. [2], Castillo et al. [3], Cui and Xu [4], Grosso et al. [8], Hifi and M’Hallah [10], Huang and Ye [11], Locatelli and Raber [12], Lubachevsky and Graham [15], Specht [17] and Szabó et al. [18]. The interest in the packing problem and the closely related covering problem is due to important applications in various practical fields. Applications of these problems are discussed in the works Hamacher and Drezner [9], Love et al. [14] and ReVelle and Eiselt [16].

Presently, various models of packing problems are developed that often reduce the packing problem to nonlinear programming problems (see Birgin et al. [2], Huang and Ye [11], Locatelli and Raber [12], Castillo et al. [3]) and in the case of packing rectangles, to a linear programming problem (e.g., see the use of linear programming in the work Lodi et al. [13]). There is a series of studies considering the packing of circles into a rectangle, packing into a triangle, into a circle, into a strip, etc. We do not analyze the literature on packing problems in this paper but only mention some publications where one can find reviews of these problems (e.g., see Hifi and M’Hallah [10], Lodi et al. [13], the book by Szabó et al. [18] and the references therein).

The circle packing problem is most often formulated as packing n circles of the maximum possible radius (not known in advance) into a given geometric figure. In problems of practical importance, the radius of the circles to be packed is typically given, and it is required to pack in a given domain as many such circles as possible. We consider the packing problems in which the circle radius is given.

In this paper, we propose linear models for determining the maximum number of congruent circles of the given radius that can be packed into a given connected closed bounded domain G. We construct a grid in G; the nodes of this grid form a finite set of points T, and it is assumed that the centers of circles to be packed can be placed only at the points of T. The packing problems of equal circles with the centers at the points of T are reduced to 0–1 linear programming problems. A heuristic algorithm for solving the packing problems based on linear models is proposed. Numerical results demonstrate the effectiveness (performance) of this approach. It is important that the proposed approach is fairly general – it provides a unified method for solving the equal circle packing problem for arbitrary connected closed bounded domains independently of their shape.

Let G be a connected closed bounded domain on the plane P with a nonempty interior. A system of n equal open circles K
                     
                        j
                     , 1⩽
                     j
                     ⩽
                     n, forms a packing in the set G, if each circle K
                     
                        j
                      is contained in G, 1⩽
                     j
                     ⩽
                     n, and each point s of G belongs to at most one of these circles.

Packing density is the ratio of the sum of areas of packing circles to the area of G. The packing density is denoted by p.

Here is the problem we intend to solve.
                        Problem Z1
                        Determine the maximum number of equal open circles of the given radius r that can be packed into the domain G and determine the location of their centers.

We assume that the Cartesian frame of reference xOy is defined on the plane P. We denote by d(s,
                     t) the Euclidean distance between the points s and t. Let G
                     ∗ (G
                     ∗
                     ⊂
                     G) be the set of all points s of G such that the distance from s to the nearest point of the boundary of G (frG) is not less than r: G
                     ∗
                     ={s
                     ∈
                     G: min
                     
                        t∈frG
                     
                     
                     d(s,
                     t)⩾
                     r}. We assume that G
                     ∗ is not empty. It is clear that G
                     ∗ is a closed set, which can be unconnected and contain isolated points. It is easy to verify that every open circle K of radius r with the center in G
                     ∗ consists only of the interior points of G; therefore, it lies entirely inside G: K
                     ⊂
                     G. Obviously, the converse is also true; more precisely, the center of every open circle of radius r contained in G belongs to G
                     ∗.

Let Q be the minimal rectangle containing the set G
                     ∗, and let its sides be parallel to the coordinate axes. On the set Q, we construct the rectangular grid of size Δ along both axes x and y. We assume that Δ divides r; that is, r
                     =
                     kΔ, where k
                     ⩾1 is an integer. The nodes of this grid are denoted by s
                     1,
                     s
                     2,…,
                     s
                     
                        N
                     , N
                     ⩾1. A small cell formed by the grid has a diagonal size equal to 
                        
                           
                              
                                 2
                              
                           
                           
                           Δ
                        
                     . The closed circles V
                     
                        i
                      of radius 
                        
                           
                              
                                 2
                              
                           
                           
                           Δ
                           /
                           2
                        
                      centered at the points s
                     
                        i
                      (1⩽
                     i
                     ⩽
                     N) form a covering of the set Q and, therefore, of the set G
                     ∗. We construct the set T(Δ) using the following procedure.


                     
                        Procedure 1
                     :
                        
                           1.
                           
                              T(Δ) is the empty set.

For each i (1⩽
                              i
                              ⩽
                              N), if V
                              
                                 i
                              
                              ∩
                              G
                              ∗
                              =∅, then go to the next value of i; if V
                              
                                 i
                              
                              ∩
                              G
                              ∗
                              ≠∅, then do the following:
                                 
                                    (a)
                                    if s
                                       
                                          i
                                       
                                       ∈
                                       G
                                       ∗, then add s
                                       
                                          i
                                        to the set T(Δ);

if s
                                       
                                          i
                                       
                                       ∉
                                       G
                                       ∗, then take the closest to s
                                       
                                          i
                                        point s in G
                                       ∗ and add it to T(Δ) if it is not yet contained in this set.

As a result of applying Procedure 1, we obtain a set of n points T(Δ)={t
                     1,
                     t
                     2,…,
                     t
                     
                        n
                     }. The coordinates x
                     
                        i
                      and y
                     
                        i
                      of the points t
                     
                        i
                      (1⩽
                     i
                     ⩽
                     n) are found in an obvious way. Each point t
                     
                        i
                      (1⩽
                     i
                     ⩽
                     n) belongs to the set G
                     ∗.

If a grid of size Δ and a grid of size Δ/2 are constructed, then we assume that the sets T(Δ) and T(Δ/2) are constructed using procedure 1; then, we complete the definition as follows: T(Δ/2)≔
                     T(Δ)∪
                     T(Δ/2). Similarly, we construct T(Δ/2
                        k
                     ) using procedure 1 and then join it with the preceding set T(Δ/2
                        k−1).

The grid on G may be fairly arbitrary or points in the set T(Δ)={t
                     1,
                     t
                     2,…,
                     t
                     
                        n
                     } may be chosen without using the grid nodes or the grid nodes may be used partially but each point t
                     
                        i
                      (1⩽
                     i
                     ⩽
                     n) belongs to the set G
                     ∗.

Let the set T(Δ) be constructed.
                        Problem Z2
                        Determine the maximum number of equal open non-overlapping into G circles of the given radius r centered at the points of the set T(Δ) and determine the location of their centers.

Below, we solve problem Z2 instead of Z1. It is clear that the resultant packing gives an approximate solution of problem Z1; such a solution is acceptable in many engineering calculations.
                        Remark 1
                        For a given radius r and an optimal packing into G (in the case of problem Z1), the centers of the circles are not necessarily at the points of T(Δ) for the given Δ. In this case, the numbers of the packed circles in problems Z1 and Z2 can be different.

We illustrate this fact by a simple example. Consider the problem of packing three circles of the maximum possible radius r
                     3 into a unit square V. The known optimal packing is shown in Fig. 1
                     . The set V
                     ∗ of possible locations of the circle centers is the square abcd with the side 1–2r
                     3. This square is shown in Fig. 1 in a dashed line.

Let the points a, E, and F be the circle centers in the optimal packing. To obtain this optimal packing using the proposed method, it is required that some grid nodes coincide with the points a, E and F. If a rectangular grid is constructed in the square abcd by dividing its sides into equal parts, the points E and F cannot coincide (for finite number of steps) with the grid nodes because bF
                     =(1−2r
                     3) tan (π/12) and 
                        
                           
                              
                                 r
                              
                              
                                 3
                              
                           
                           =
                           1
                           /
                           
                              
                                 
                                    2
                                    +
                                    1
                                    /
                                    
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          6
                                       
                                    
                                    /
                                    2
                                 
                              
                           
                           =
                           0.25433309503
                        
                      (e.g., see [18]). As a result, when a rectangular uniform grid is constructed, the number of packed circles is two rather than three. Let us construct a grid in which one set of lines forms the angle of π/12 with the axis x, while the other set of lines forms the angle of π/12 with the axis y. Then, the points E and F coincide with certain grid nodes, and the number of packed circles is three. Therefore, the result depends on how the grid is constructed.

This is a drawback of the approach under consideration. However, this approach is effective in some cases.

Consider two variants of the grid:
                        
                           (1)
                           uniform rectangular grid, where one of the lines forming the grid is parallel to the x-axis, and the other-to the y-axis, and these lines are drawn at the equal distances Δ;

oblique grid, when one of the lines forming the grid is parallel to the vector (0,2) and the other is parallel to the vector 
                                 
                                    
                                       
                                          
                                             1
                                             ,
                                             
                                             
                                                
                                                   3
                                                
                                             
                                          
                                       
                                    
                                 
                              , and these lines are drawn at equal distances Δ, that measure out along each generating line. As is known, such oblique grid nodes determine the optimal packing of equal circles on the whole plane.

Find out whether one of these grids could be replaced with the other with some error.

Consider a uniform rectangular grid. Let Δ satisfies r
                     =
                     kΔ, where r is the radius of the packing circles, k is an integer, k
                     >0. Suppose that we have a packing, shown in Fig. 2
                     a, in which the centers of circles of radius r form an equilateral triangle ABC, the sides of which are equal to 2r. Now let centers of packing circles be situated at nodes of a rectangular grid, constructed by the step Δ, and points A
                     ∗, B
                     ∗ and C
                     ∗ are centers of these circles, see Fig. 2b.

Then, for Fig. 2b, we have: 
                        
                           
                              
                                 A
                              
                              
                                 ∗
                              
                           
                           
                              
                                 C
                              
                              
                                 ∗
                              
                           
                           =
                           
                              
                                 
                                    
                                       (
                                       
                                          
                                             A
                                          
                                          
                                             ∗
                                          
                                       
                                       
                                          
                                             D
                                          
                                          
                                             ∗
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       (
                                       
                                          
                                             C
                                          
                                          
                                             ∗
                                          
                                       
                                       
                                          
                                             D
                                          
                                          
                                             ∗
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           =
                           
                              
                                 
                                    
                                       (
                                       k
                                       Δ
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       (
                                       m
                                       Δ
                                       )
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           =
                           Δ
                           
                              
                                 
                                    
                                       k
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       m
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        
                     , where m is the smallest integer such that A
                     ∗
                     C
                     ∗
                     ⩾
                     AC
                     =2kΔ. Consequently, the value m is the smallest integer that is not less than 
                        
                           
                              
                                 3
                              
                           
                           k
                        
                     . For different values of k it is easy to find the appropriate value of m. For example, if k is 2, 3, 4, 5, 6, 7 and 8, the values of m are equal to 4, 6, 7, 9, 11, 13 and 14, respectively. Now we can calculate the difference between the values of A
                     ∗
                     C
                     ∗ and AC, i.e. find out a distance d
                     
                        R
                     
                     =
                     A
                     ∗
                     C
                     ∗
                     −
                     AC. These values are given in Table 1
                      for different k.

Now we consider the oblique grid and find out how to get a packing in which the centers of circles are one above the other, that is, on a line parallel to the axis y. Let, as above, Δ satisfy r
                     =
                     kΔ, where r is the radius of the packing circles, k is an integer, k
                     >0, and let m be an integer, m
                     ⩾0. Let C
                     ∗ be the intersection point of lines A
                     ∗
                     C
                     ∗ and E
                     ∗
                     C
                     ∗, see Fig. 2c. If the points A
                     ∗ and E
                     ∗ are oblique grid nodes, it is clear that the point C
                     ∗ is also an oblique grid node. We have: 
                        
                           
                              
                                 A
                              
                              
                                 ∗
                              
                           
                           
                              
                                 E
                              
                              
                                 ∗
                              
                           
                           
                              
                                 3
                              
                           
                           =
                           
                              
                                 A
                              
                              
                                 ∗
                              
                           
                           
                              
                                 C
                              
                              
                                 ∗
                              
                           
                        
                     . Then the distance 
                        
                           
                              
                                 d
                              
                              
                                 U
                              
                           
                           =
                           
                              
                                 A
                              
                              
                                 ∗
                              
                           
                           
                              
                                 C
                              
                              
                                 ∗
                              
                           
                           -
                           2
                           k
                           Δ
                           =
                           
                              
                                 3
                              
                           
                           (
                           k
                           +
                           m
                           )
                           
                           Δ
                           -
                           2
                           k
                           Δ
                        
                     , where m is the smallest integer such that 
                        
                           
                              
                                 3
                              
                           
                           (
                           k
                           +
                           m
                           )
                           
                           Δ
                           ⩾
                           2
                           k
                           Δ
                        
                     . We count the distances d
                     
                        U
                      and record them in Table 1.

These results imply that if the value of Δ decreases then the values of d
                     
                        R
                      and d
                     
                        U
                      can increase, for example, if Δ=
                     r/4, then d
                     
                        R
                     
                     =0.01556r, and if Δ=
                     r/7, we have d
                     
                        R
                     
                     =0.10926r, similarly, if Δ=
                     r/6, d
                     
                        U
                     
                     =0.02073r, and if Δ=
                     r/7, we have d
                     
                        U
                     
                     =0.22692r.


                     Table 1 shows that the value of d
                     
                        R
                      in most cases is less than the value of d
                     
                        U
                     . It follows that this rectangular grid is better suited for the approximation of an oblique grid than an oblique grid to the approximation of a rectangular grid. Thus, a rectangular grid is more admissible.

For a rectangular grid the value of d
                     
                        R
                      does not increase in case of dividing the value of Δ in half, therefore, it is better to change the Δ, dividing it in half.

It is clear from the above discussion that the rectangular grid is more suitable for the solving of a packing problem in approximate way than the oblique grid (by the specified distances).

Let n(Δ) (n(Δ/2)) be the maximal number of circles of a given radius r that can be packed into a given set G when the centers of these circles are at the points of the set T(Δ) (T(Δ/2)). Each packing of circles of radius r centered in T(Δ) is a packing of these circles centered in T(Δ/2); therefore, we have
                        
                           
                              n
                              (
                              Δ
                              )
                              ⩽
                              n
                              (
                              Δ
                              /
                              2
                              )
                              .
                           
                        
                     Assume that m is the maximal number of circles K
                     
                        j
                      of radius r that can be packed into G if their centers c
                     
                        j
                      (1⩽
                     j
                     ⩽
                     m) are located arbitrarily in G. Suppose that the size Δ of the rectangular grid is chosen and the set T(Δ) is constructed. Let us shift each center c
                     
                        j
                      (1⩽
                     j
                     ⩽
                     m) that is not in T(Δ) to the nearest point in T(Δ). The shift length is not greater than 
                        
                           
                              
                                 2
                              
                           
                           Δ
                           /
                           2
                        
                     . Then, reduce the radius of all the circles in the packing by 
                        
                           
                              
                                 2
                              
                           
                           Δ
                           /
                           2
                        
                     . The resultant open circles 
                        
                           
                              
                                 K
                              
                              
                                 j
                              
                              
                                 ∗
                              
                           
                           ,
                           
                           1
                           ⩽
                           j
                           ⩽
                           m
                        
                     , lie in G and do not overlap with one another; therefore, they form a packing in G.

Let n(Δ) be the maximal number of circles K
                     
                        j
                      of radius r that can be packed into G if their centers belong to T(Δ), and let n
                     ∗(Δ) be the maximal number of circles 
                        
                           
                              
                                 K
                              
                              
                                 j
                              
                              
                                 ∗
                              
                           
                        
                      of radius 
                        
                           
                              
                                 r
                              
                              
                                 1
                              
                           
                           =
                           r
                           -
                           
                              
                                 2
                              
                           
                           Δ
                           /
                           2
                        
                      that can be packed into G if their centers belong to T(Δ). Then, we obviously have
                        
                           
                              n
                              (
                              Δ
                              )
                              ⩽
                              m
                              ⩽
                              
                                 
                                    n
                                 
                                 
                                    ∗
                                 
                              
                              (
                              Δ
                              )
                              .
                           
                        
                     Thus, we can evaluate the maximum number of circles K
                     
                        j
                      of radius r that can be packed into G.

The area of G is also denoted by G. Obviously, that m
                     ⩽[G/(πr
                     2)], where [x] is integer part of x. If G is a convex domain, then an estimate of the value of m can be improved by using the well-known theorem: if a convex domain of area F contains at least two congruent non-overlapping circles, then the sum of their areas S satisfies the inequality 
                        
                           S
                           <
                           π
                           F
                           /
                           
                              
                                 12
                              
                           
                        
                      (see Fejes Tóth [5]); a tighter bound can be obtained using the results in Folkman and Graham [6]; for the cases of a square and an equilateral triangle, the results in Gáspár and Tarnai [7] help obtain a better bound.

In this paper, unless otherwise specified, we construct a uniform rectangular grid (all the grid cells have the same size). It is clear that this is not the only possible way to construct a grid. In many respects, the form of this grid depends on the domain G, and we believe that there is no universal method for constructing such a grid.

Let the set G into which the circles of radius r should be packed be given, the grid size Δ be chosen, and the set T(Δ)={t
                     1,
                     t
                     2,…,
                     t
                     
                        n
                     } be constructed.

Let c
                     
                        i
                      be the center of the ith circle being packed, where 1⩽
                     i
                     ⩽
                     m and m
                     ⩾1. Define the variables
                        
                           (1)
                           
                              
                                 
                                    z
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                1
                                                ,
                                             
                                             
                                                if
                                                
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                coincides with
                                                
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                             
                                          
                                          
                                             
                                                0
                                                ,
                                             
                                             
                                                otherwise,
                                             
                                          
                                       
                                    
                                 
                              
                              ,
                              1
                              ⩽
                              i
                              ⩽
                              n
                              .
                           
                        
                     Let the center c
                     
                        i
                      of the circle K
                     
                        i
                      coincide with the point t
                     
                        i
                     ; that is, z
                     
                        i
                     
                     =1 for 1⩽
                     i
                     ⩽
                     n. In order for K
                     
                        i
                      to be non-overlapping with the other circles being packed, it is necessary that z
                     
                        j
                     
                     =0 for all the points t
                     
                        j
                      (i
                     ≠
                     j) that are closer to t
                     
                        i
                      than 2r.

Suppose that for the given point t
                     
                        i
                      we have m
                     
                        i
                      points t
                     
                        j
                      (i
                     ≠
                     j,1⩽
                     j
                     ⩽
                     n) for which d(t
                     
                        i
                     ,
                     t
                     
                        j
                     )<2r. We can write non-overlapping condition in the form
                        
                           (2)
                           
                              If
                              
                              
                                 
                                    z
                                 
                                 
                                    i
                                 
                              
                              =
                              1
                              
                              then
                              
                              for
                              
                              all
                              
                              j
                              :
                              
                              d
                              (
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                              
                                 
                                    t
                                 
                                 
                                    j
                                 
                              
                              )
                              <
                              2
                              r
                              ,
                              
                              we
                              
                              have
                              
                              
                                 
                                    z
                                 
                                 
                                    j
                                 
                              
                              =
                              0
                              ,
                              
                              i
                              
                              ≠
                              
                              j
                              ,
                              
                              1
                              ⩽
                              j
                              ⩽
                              n
                              .
                           
                        
                     
                     
                        Proposition 1
                        
                           Condition 
                           
                              (2)
                            
                           is equivalent to the condition
                           
                              
                                 (3)
                                 
                                    
                                       
                                          m
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          z
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             :
                                             d
                                             (
                                             
                                                
                                                   t
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   j
                                                
                                             
                                             )
                                             <
                                             2
                                             r
                                             ,
                                             i
                                             ≠
                                             j
                                          
                                       
                                    
                                    
                                       
                                          z
                                       
                                       
                                          j
                                       
                                    
                                    ⩽
                                    
                                       
                                          m
                                       
                                       
                                          i
                                       
                                    
                                    .
                                 
                              
                           
                        

Let condition (2) be fulfilled. Let z
                           
                              i
                           
                           =1, then the first term on the left side of (3) is m
                           
                              i
                           
                           z
                           
                              i
                           
                           =
                           m
                           
                              i
                           . The remaining term on the left side of (3) are equal to zero by (2). Hence, we have the condition (3).

Conversely, let condition (3) be fulfilled. Then, if z
                     
                        i
                     
                     =1, then we have z
                     
                        j
                     
                     =0 (i
                     ≠
                     j,1⩽
                     j
                     ⩽
                     n) for all j such that d(t
                     
                        i
                     ,
                     t
                     
                        j
                     )<2r. Hence, we get the condition (2). Notice that, if z
                     
                        i
                     
                     =0, then inequality (3) holds true for all z
                     
                        j
                      under the summation sign. □

The fulfillment of condition (2) (or (3)) implies that, if the center of a circle of radius r is at the point t
                     
                        i
                      (1⩽
                     i
                     ⩽
                     n), then any other circle can be centered only at the points t
                     
                        j
                      (i
                     ≠
                     j,1⩽
                     j
                     ⩽
                     n) that are at the distance not less than 2r from t
                     
                        i
                     . Therefore, under this condition, the open circles of radius r centered at t
                     
                        i
                      and t
                     
                        j
                      do not intersect.

Let, as above, each point t
                     
                        i
                      have m
                     
                        i
                      points t
                     
                        j
                      (i
                     ≠
                     j,1⩽
                     j
                     ⩽
                     n) for which d(t
                     
                        i
                     ,
                     t
                     
                        j
                     )<2r.

Define the coefficients
                        
                           
                              
                                 
                                    
                                       
                                          
                                             a
                                          
                                          
                                             ij
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         1
                                                         ,
                                                      
                                                      
                                                         if
                                                         
                                                         d
                                                         (
                                                         
                                                            
                                                               t
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               t
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         )
                                                         <
                                                         2
                                                         r
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                         ,
                                                      
                                                      
                                                         if
                                                         
                                                         d
                                                         (
                                                         
                                                            
                                                               t
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               t
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         )
                                                         ⩾
                                                         2
                                                         r
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       ,
                                       i
                                       
                                       ≠
                                       
                                       j
                                       ,
                                       
                                       1
                                       ⩽
                                       i
                                       ,
                                       
                                       j
                                       ⩽
                                       n
                                       ;
                                    
                                 
                                 
                                    
                                       
                                          
                                             a
                                          
                                          
                                             ii
                                          
                                       
                                       =
                                       
                                          
                                             m
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                       1
                                       ⩽
                                       i
                                       ⩽
                                       n
                                       .
                                    
                                 
                              
                           
                        
                     It is clear that, for the chosen i, condition (2) (and, hence, condition (3)) can be written in the form
                        
                           
                              
                                 
                                    a
                                 
                                 
                                    i
                                    1
                                 
                              
                              
                                 
                                    z
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 
                                    a
                                 
                                 
                                    i
                                    2
                                 
                              
                              
                                 
                                    z
                                 
                                 
                                    2
                                 
                              
                              +
                              ⋯
                              +
                              
                                 
                                    a
                                 
                                 
                                    in
                                 
                              
                              
                                 
                                    z
                                 
                                 
                                    n
                                 
                              
                              ⩽
                              
                                 
                                    m
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                              1
                              ⩽
                              i
                              ⩽
                              n
                           
                        
                     Let A be the n
                     ×
                     n matrix with the elements a
                     
                        ij
                     , 1⩽
                     i, j
                     ⩽
                     n, Z and M be the vectors Z
                     =(z
                     1,
                     z
                     2,…,
                     z
                     
                        n
                     )
                        T
                      and M
                     =(m
                     1,
                     m
                     2,…,
                     m
                     
                        n
                     )
                        T
                     , respectively and z
                     
                        i
                     , 1⩽
                     i
                     ⩽
                     n, are defined by (1).

We consider the problem:
                        
                           (4)
                           
                              subject
                              
                              to
                              
                              
                                 
                                    
                                       N
                                       =
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                n
                                             
                                          
                                       
                                       
                                          
                                             z
                                          
                                          
                                             i
                                          
                                       
                                       →
                                       
                                          max
                                       
                                    
                                 
                                 
                                    
                                       Az
                                       ⩽
                                       M
                                       ,
                                    
                                 
                                 
                                    
                                       
                                          
                                             z
                                          
                                          
                                             i
                                          
                                       
                                       ∈
                                       {
                                       0
                                       ,
                                       1
                                       }
                                       ,
                                       1
                                       ⩽
                                       i
                                       ⩽
                                       n
                                       .
                                    
                                 
                              
                           
                        
                     This problem is to maximize the number of variables z
                     
                        i
                      taking the value 1 and such that z
                     
                        i
                      and z
                     
                        j
                      are equal to 1 if d(t
                     
                        i
                     ,
                     t
                     
                        j
                     )⩾
                     2r. Therefore, the open circles with centers at the points t
                     
                        i
                      and t
                     
                        j
                      are mutually disjoint. Consequently, the problem (4) is a packing problem in G with the largest number of circles of radius r with centers in some of the points of T.

Solving problem (4), we find the number N of the circles of radius r, and the values z
                     
                        i
                      thus obtained determine the circle centers.

The relaxation of problem (4) is obtained if the conditions z
                     
                        i
                     
                     ∈{0,1}, 1⩽
                     i
                     ⩽
                     n, are replaced by the conditions: 0⩽
                     z
                     
                        i
                     
                     ⩽ 1, 1⩽
                     i
                     ⩽
                     n:
                        
                           (5)
                           
                              subject
                              
                              to
                              
                              
                                 
                                    
                                       N
                                       =
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                n
                                             
                                          
                                       
                                       
                                          
                                             z
                                          
                                          
                                             i
                                          
                                       
                                       →
                                       
                                          max
                                       
                                    
                                 
                                 
                                    
                                       Az
                                       ⩽
                                       M
                                       ,
                                    
                                 
                                 
                                    
                                       0
                                       ⩽
                                       
                                          
                                             z
                                          
                                          
                                             i
                                          
                                       
                                       ⩽
                                       1
                                       ,
                                       1
                                       ⩽
                                       i
                                       ⩽
                                       n
                                       .
                                    
                                 
                              
                           
                        
                     Sometimes, the relaxation of the problem of type (4) is used to evaluate the value of the objective function and to approximate values of the variables z
                     
                        j
                     , 1⩽
                     j
                     ⩽
                     n, of problem (4). In this case, it cannot be done because of the following. It is easy to see that the vector z
                     =(1/2,1/2,…,1/2)
                        T
                      is a feasible solution of problem (5). Therefore, we find that N
                     ∗
                     ⩾
                     n/2. Thus, the value N
                     ∗ for (5) can be very large (for large values of n), even if we find that N
                     =1 for (4). Consequently, values of the objective function of the integer problem (4) and the relaxed problem (5) can differ very significantly. This implies that the relaxed problem does not allow us to estimate the value of the objective function of the original problem, and it is not yet clear how the solution of problem (5) can be used to solve problem (4).

Problem (4) stated in the preceding statement is an integer linear program. It is clear that when the grid size Δ is reduced, the probability of obtaining an acceptable packing increases; however, as Δ decreases, the size of the problem (the number of variables) increases.

Obviously, we can solve problem (4) by any method (algorithm) designed for integer linear programs if the solution time is acceptable. If the size of problem (4) is large, the time needed to solve it by available exact methods is long (often unacceptably long). In this case, one can use the methods based on directed search or the methods that use stochastic or heuristic approaches and the like. In this paper, we propose a heuristic method based on a natural packing procedure in which the packing is performed step-by-step—first, several (may be three or four) layers of circles are packed, then some more layers with regard to the circles already packed, etc.

Before presenting a detailed description of this heuristic algorithm, we carry out some additional reasoning.

Suppose that we want to pack the maximum possible number of open congruent circles of radius 1 into a rectangle R of width 4 and height 3. It is clear that only two such circles can be packed into R. This solution can be obtained by constructing model (4). Take the grid size Δ=1; then, the set T(Δ) consists of six point: T(Δ)={t
                     1,
                     t
                     2,…,
                     t
                     6} (see Fig. 3
                     ). Then, problem (4) is written as
                        
                           (6)
                           
                              
                                 
                                    N
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    z
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 
                                    z
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    z
                                 
                                 
                                    3
                                 
                              
                              +
                              
                                 
                                    z
                                 
                                 
                                    4
                                 
                              
                              +
                              
                                 
                                    z
                                 
                                 
                                    5
                                 
                              
                              +
                              
                                 
                                    z
                                 
                                 
                                    6
                                 
                              
                              →
                              
                                 max
                              
                           
                        
                     subject to the constraints
                        
                           (7)
                           
                              
                                 
                                    
                                    
                                       
                                          3
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          +
                                          
                                             
                                                z
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                z
                                             
                                             
                                                4
                                             
                                          
                                          +
                                          
                                             
                                                z
                                             
                                             
                                                5
                                             
                                          
                                          ⩽
                                          3
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          +
                                          5
                                          
                                             
                                                z
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                z
                                             
                                             
                                                3
                                             
                                          
                                          +
                                          
                                             
                                                z
                                             
                                             
                                                4
                                             
                                          
                                          +
                                          
                                             
                                                z
                                             
                                             
                                                5
                                             
                                          
                                          +
                                          
                                             
                                                z
                                             
                                             
                                                6
                                             
                                          
                                          ⩽
                                          5
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                z
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          3
                                          
                                             
                                                z
                                             
                                             
                                                3
                                             
                                          
                                          +
                                          
                                             
                                                z
                                             
                                             
                                                5
                                             
                                          
                                          +
                                          
                                             
                                                z
                                             
                                             
                                                6
                                             
                                          
                                          ⩽
                                          3
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          +
                                          
                                             
                                                z
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          3
                                          
                                             
                                                z
                                             
                                             
                                                4
                                             
                                          
                                          +
                                          
                                             
                                                z
                                             
                                             
                                                5
                                             
                                          
                                          ⩽
                                          3
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          +
                                          
                                             
                                                z
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                z
                                             
                                             
                                                3
                                             
                                          
                                          +
                                          
                                             
                                                z
                                             
                                             
                                                4
                                             
                                          
                                          +
                                          5
                                          
                                             
                                                z
                                             
                                             
                                                5
                                             
                                          
                                          +
                                          
                                             
                                                z
                                             
                                             
                                                6
                                             
                                          
                                          ⩽
                                          3
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                z
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                z
                                             
                                             
                                                3
                                             
                                          
                                          +
                                          
                                             
                                                z
                                             
                                             
                                                5
                                             
                                          
                                          +
                                          3
                                          
                                             
                                                z
                                             
                                             
                                                6
                                             
                                          
                                          ⩽
                                          3
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                z
                                             
                                             
                                                i
                                             
                                          
                                          ∈
                                          {
                                          0
                                          ,
                                          1
                                          }
                                          ,
                                          1
                                          ⩽
                                          i
                                          ⩽
                                          6
                                          .
                                       
                                    
                                 
                              
                           
                        
                     By solving problem (6), (7), we conclude that the maximum value of N
                     1 is 2, and the circle centers can be at the points either t
                     1 and t
                     3, or t
                     1 and t
                     6, or t
                     3 and t
                     4, or t
                     4 and t
                     6.

If we want the circles to be as low in R as possible, then we should modify the model (6) and (7). For that purpose, we assume that the points t
                     1, t
                     2, and t
                     3 are at the second level (tier), while the points t
                     4, t
                     5, and t
                     6 are at the first level. The levels are counted from the bottom to the top. The points of the same level have identical y coordinates. We want to place the circle centers as low as possible. For that reason, we multiply the variables corresponding to the first-level points by a constant (weight) c
                     1 that is more than the weight c
                     2 multiplying the variables corresponding to the second-level points. Set c
                     1
                     =2 and c
                     2
                     =1. Then, we can write
                        
                           (8)
                           
                              
                                 
                                    N
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    z
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 
                                    z
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    z
                                 
                                 
                                    3
                                 
                              
                              +
                              2
                              
                                 
                                    z
                                 
                                 
                                    4
                                 
                              
                              +
                              2
                              
                                 
                                    z
                                 
                                 
                                    5
                                 
                              
                              +
                              2
                              
                                 
                                    z
                                 
                                 
                                    6
                                 
                              
                              →
                              
                                 max
                              
                           
                        
                     instead of (6). Solving problem (8) subject to constraints (7), we conclude that the maximum value of N
                     2 is 4, and two circles can be centered only at the points t
                     4 and t
                     6. Therefore, by a proper selection of weights for different levels, we can ensure that the circle centers are at the desired level.

Determining the level weights is a nontrivial problem because no optimal packing can be obtained if the weights are inappropriate. We illustrate this fact using a simple example. Suppose that we want to pack circles of radius 1 into a rectangle of width 4 and height H. Consider two packings shown in Fig. 4
                     .

In Fig. 4a, we assume that the grid nodes coincide with the intersection points of the horizontal and vertical dashed lines. In the case of Fig. 4a, this set of nodes consists of 15 points on five levels. Similarly, for Fig. 4b we obtain 15 grid points formed by the intersection of the horizontal and vertical dashed lines.

Let c
                     
                        j
                      be the weight of the jth level, where 1⩽
                     j
                     ⩽5. Then, the objective function of problem (4) with regard to the tier weights can be written as
                        
                           
                              N
                              =
                              
                                 
                                    c
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    z
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 
                                    c
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    z
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    c
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    z
                                 
                                 
                                    3
                                 
                              
                              +
                              
                                 
                                    c
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    z
                                 
                                 
                                    4
                                 
                              
                              +
                              
                                 
                                    c
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    z
                                 
                                 
                                    5
                                 
                              
                              +
                              
                                 
                                    c
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    z
                                 
                                 
                                    6
                                 
                              
                              +
                              ⋯
                              +
                              
                                 
                                    c
                                 
                                 
                                    5
                                 
                              
                              
                                 
                                    z
                                 
                                 
                                    13
                                 
                              
                              +
                              
                                 
                                    c
                                 
                                 
                                    5
                                 
                              
                              
                                 
                                    z
                                 
                                 
                                    14
                                 
                              
                              +
                              
                                 
                                    c
                                 
                                 
                                    5
                                 
                              
                              
                                 
                                    z
                                 
                                 
                                    15
                                 
                              
                           
                        
                     Set the following values for the weights: c
                     1
                     =1.3, c
                     2
                     =1.2, c
                     3
                     =1.18, c
                     4
                     =1.08, and c
                     5
                     =1.05. Then, the value of the objective function for the packing shown in Fig. 4a is 6.01; for the packing shown in Fig. 4b, it is 5.96. Therefore, the packing in Fig. 4a is preferable to the one in Fig. 4b, which is an ambiguous conclusion. Therefore, when the weights of levels are selected, it is important to take into account which packing is adequate to the purpose of the study.

Now, let us find out which effect can be achieved by introducing subsets in the set G.

Suppose that the coordinate y of the points in G satisfies the condition α
                     ⩽
                     y
                     ⩽
                     β and the coordinate y of the points in G
                     ∗ satisfies the condition α
                     ∗
                     ⩽
                     y
                     ⩽
                     β
                     ∗. Take α
                     1 such that α
                     1
                     ⩾
                     α
                     ∗
                     +4r and α
                     1
                     ⩽
                     β, where r is the radius of the circles to be packed. Define the set D
                     
                        α1 as the subset of points in G that are below the line y
                     =
                     α
                     1. For D
                     
                        α1, we construct 
                        
                           
                              
                                 D
                              
                              
                                 α
                                 1
                              
                              
                                 ∗
                              
                           
                        
                      in the same way as G
                     ∗ was constructed for 
                        
                           G
                           :
                           
                           
                              
                                 D
                              
                              
                                 α
                                 1
                              
                              
                                 ∗
                              
                           
                           =
                           {
                           s
                           ∈
                           
                              
                                 D
                              
                              
                                 α
                                 1
                              
                           
                           :
                           
                           
                              
                                 min
                              
                              
                                 t
                                 ∈
                                 
                                    
                                       frD
                                    
                                    
                                       α
                                       1
                                    
                                 
                              
                           
                           d
                           (
                           s
                           ,
                           t
                           )
                           ⩾
                           r
                           }
                        
                     . Next, we define on 
                        
                           
                              
                                 D
                              
                              
                                 α
                                 1
                              
                              
                                 ∗
                              
                           
                        
                      a grid whose nodes generate the set T
                     
                        α1(Δ)={t
                     1,
                     t
                     2,…,
                     t
                     
                        n1} consisting of n1 elements. The points t
                     
                        j
                      with the same coordinate y
                     
                        i
                      (1⩽
                     j
                     ⩽
                     n1) are assumed to be on the same level. The set T
                     
                        α1(Δ)={t
                     1,
                     t
                     2,…,
                     t
                     
                        n1} constructed for 
                        
                           
                              
                                 D
                              
                              
                                 α
                                 1
                              
                              
                                 ∗
                              
                           
                        
                      can contain points that are on k (k
                     ⩾1) levels (the levels are counted from the bottom to the top). Define k weights for these tiers: c
                     1
                     ⩾
                     c
                     2
                     ⩾⋯⩾
                     c
                     
                        k
                     . Let c
                     
                        j
                      be the weight for level j. The variables z
                     
                        j
                      in the objective function are multiplied by the weight corresponding to the level on which the point t
                     
                        j
                      (1⩽
                     j
                     ⩽
                     n1) resides. As a result, we obtain a new objective function, while the constraints are constructed as for problem (4) but using the set D
                     
                        α1. The resultant problem with account for the level weights is considered as an auxiliary problem. The solutions to this problem are considered to be solutions for the set D
                     
                        α1. As a result of the solution, we obtain a packing of circles into D
                     
                        α1 for the subset D
                     
                        α1
                     ⊆
                     G. This packing is denoted by P
                     
                        α1.

Let D
                     
                        α(i−1) be constructed and a packing P
                     
                        α(i−1) found for this subset. The boundary of D
                     
                        αi
                     (i
                     ⩾2) consists of the following parts:
                        
                           –
                           segments of the lines y
                              =
                              α
                              
                                 i
                               and y
                              =
                              α
                              
                                 i−1
                              −2r
                              −Δ lying within G,

segments of the boundary of G between these lines,

if the line y
                              =
                              α
                              
                                 i−1 is the uppermost one among the lines of this kind, then the segment of the line y
                              =
                              α
                              
                                 i−1
                              −2r
                              −Δ lying inside G and the boundary of G lying above y
                              =
                              α
                              
                                 i−1
                              −2r
                              −Δ are considered to be the boundary of D
                              
                                 αi
                              .

The set 
                        
                           
                              
                                 D
                              
                              
                                 α
                                 i
                              
                              
                                 ∗
                              
                           
                        
                      is constructed as follows:
                        
                           
                              
                                 
                                    D
                                 
                                 
                                    α
                                    i
                                 
                                 
                                    ∗
                                 
                              
                              =
                              {
                              s
                              ∈
                              G
                              :
                              (
                              
                                 
                                    
                                       min
                                    
                                    
                                       t
                                       ∈
                                       
                                          
                                             frD
                                          
                                          
                                             α
                                             i
                                          
                                       
                                    
                                 
                              
                              d
                              (
                              s
                              ,
                              t
                              )
                              ⩾
                              r
                              )
                              &
                              (
                              
                                 
                                    
                                       min
                                    
                                    
                                       
                                          
                                             K
                                          
                                          
                                             j
                                          
                                       
                                       ∈
                                       
                                          
                                             P
                                          
                                          
                                             α
                                             (
                                             i
                                             -
                                             1
                                             )
                                          
                                       
                                    
                                 
                              
                              d
                              (
                              s
                              ,
                              
                                 
                                    q
                                 
                                 
                                    j
                                 
                              
                              )
                              ⩾
                              2
                              r
                              )
                              }
                              ,
                           
                        
                     Here, q
                     
                        j
                      is the center of the circle K
                     
                        j
                      belonging to the packing P
                     
                        α(i−1). Therefore, when constructing 
                        
                           
                              
                                 D
                              
                              
                                 α
                                 i
                              
                              
                                 ∗
                              
                           
                        
                      (1<
                     i
                     ⩽
                     m), we use the packing P
                     
                        α(i−1) constructed for the subset D
                     
                        α(i−1). Next, we construct on the set 
                        
                           
                              
                                 D
                              
                              
                                 α
                                 k
                              
                              
                                 ∗
                              
                           
                        
                      a grid whose nodes generate the set T
                     
                        αi
                     (Δ). Then, we use T
                     
                        αi
                     (Δ) to set up an auxiliary problem with account for the weights of levels. The solution of this problem gives the packing P
                     
                        αi
                      for D
                     
                        αi
                     .

Let the grid size of Δ be specified, the set G
                     ∗ for G be found, and set T(Δ) be constructed on G
                     ∗ using the grid nodes and procedure 1. Assume that the same grid size Δ is established for all the sets 
                        
                           
                              
                                 D
                              
                              
                                 α
                                 i
                              
                              
                                 ∗
                              
                           
                        
                     , and the corresponding sets T
                     
                        αi
                     (Δ) (1⩽
                     i
                     ⩽
                     m) are constructed one after another. Let n be the number of elements in T(Δ) and n
                     
                        i
                      be the number of elements in T
                     
                        αi
                     (Δ), 1⩽
                     i
                     ⩽
                     m. It is important that each n
                     
                        i
                      (1⩽
                     i
                     ⩽
                     m) is less than n and, furthermore, the sum of all n
                     
                        i
                      is also less than n. Thus, the sizes of the auxiliary problems for 
                        
                           
                              
                                 D
                              
                              
                                 α
                                 i
                              
                              
                                 ∗
                              
                           
                        
                      are less than the size of problem (4) for the entire set G.

We assume that, if the number of variables (the problem size) in (4) is n
                     ∗, then, this problem can be solved in an acceptable amount of time.
                        Algorithm A
                        
                           
                              
                                 1.
                                 For the set G find G
                                    ∗. Select the size Δ of the grid and construct the set T(Δ)={t
                                    1,
                                    t
                                    2,…,
                                    t
                                    
                                       n
                                    }.

If the number of elements (n) in T(Δ) is acceptable (n
                                    ⩽
                                    n
                                    ∗), then construct and solve problem (4) and terminate the algorithm; otherwise, go to step 3.

If n
                                    >
                                    n
                                    ∗, then construct m subsets D
                                    
                                       αi
                                     (1⩽
                                    i
                                    ⩽
                                    m) of G such that the auxiliary problems for them are of acceptable size. Solving the auxiliary problems one after another for each subset beginning with D
                                    
                                       α1, produce packings in these subsets. The union of the packings thus obtained is considered as a solution of the packing problem for G. Terminate the algorithm.

It is clear that the packings for the individual subsets D
                                    
                                       αi
                                     (1⩽
                                    i
                                    ⩽
                                    m) are not independent. The solution for each subset, beginning with the second one, depends on the preceding subsets. Even if the packing for each subset is optimal, the overall result is not necessarily optimal. However, test computations showed that the algorithm produces acceptable results in reasonable time, which makes the algorithm quite effective.

Algorithm A1 has the following parameters:
                        
                           •
                           the number (m) of subsets D
                              
                                 αi
                               (1⩽
                              i
                              ⩽
                              m) constructed for the original set G,

the quantities α
                              1,
                              α
                              2,…,
                              α
                              
                                 m−1, which determine m subsets of G,

grid size for each subset of G,

the weight c
                              
                                 ji
                               of level i (1⩽
                              i
                              ⩽
                              l
                              
                                 j
                              ), where l
                              
                                 j
                               is the number of levels in the jth subset of G (1⩽
                              j
                              ⩽
                              m).

In the next section, we analyze the influence of these parameters on the results produced by the algorithm.

It is clear that, instead of pressing the circles at the bottom (by selecting the tier weights), we could press them at the top, or (and) right, or left.


                     
                        
                           1.
                           The number m of subsets D
                              
                                 αi
                               is mainly chosen so as to make it possible to solve the auxiliary problem for each D
                              
                                 αi
                               (1⩽
                              i
                              ⩽
                              m). This depends on the size of the 0–1 linear program. It is important to select the grid size Δ for D
                              
                                 αi
                               (1⩽
                              i
                              ⩽
                              m) simultaneously. An effective approach is at first select m so as to ensure that the number of circles packed into G could be quickly determined for the given grid size Δ; then, the grid size Δ/2 is tried, and so on while the number of circles changes. Upon determining the grid size (after which the number of packed circles stops to change), we start to improve the solution. For that purpose, we construct subsets D
                              
                                 αi
                               (1⩽
                              i
                              ⩽
                              m) for a lower m such that the size of the problems on D
                              
                                 αi
                               (1⩽
                              i
                              ⩽
                              m) remains acceptable.

Next, α
                              1,
                              α
                              2,…,
                              α
                              
                                 m−1, which determine the subsets D
                              
                                 αi
                               (1⩽
                              i
                              ⩽
                              m
                              −1) and D
                              
                                 αm
                              , are chosen. Initially, these parameters are chosen taking into account the conditions described in item 1. After the grid size Δ has been refined, α
                              1,
                              α
                              2,…,
                              α
                              
                                 m−1 can be locally optimized as follows.

For the chosen α
                              
                                 i
                               and the set D
                              
                                 αi
                               (1⩽
                              i
                              ⩽
                              m
                              −1), solve problem (4) without level weights. As a result, we obtain a packing for D
                              
                                 αi
                               that contains, say, q
                              
                                 i
                               circles in D
                              
                                 αi
                              , D
                              
                                 αi
                              
                              ⊆
                              G. Then, iteratively reduce α
                              
                                 i
                               by Δα while the number of circles packed into D
                              
                                 αi
                               remains equal to q
                              
                                 i
                              . When this number changes, return to the preceding iteration step and subtract Δα/2 from α
                              
                                 i
                              . When the number of packed circles changes again, subtract Δα/4 from α
                              
                                 i
                              , and so on. Thus, we fit α
                              
                                 i
                               to the desired accuracy. Before fitting the next α
                              
                                 i+1, the auxiliary problem with level weights (with the fitted α
                              
                                 i
                              ) must be solved for D
                              
                                 αi
                               so that the circles are as low as possible. Then, α
                              
                                 i+1 is improved, and so on. This fitting procedure is not needed if the computations show that the resultant number of packed circles is independent of the specific values of α
                              1,
                              α
                              2,…,
                              α
                              
                                 m−1.

Fitting the grid size was discussed above in item 1.

Fitting the weights of levels in the subsets D
                              
                                 αj
                               (1⩽
                              j
                              ⩽
                              m). Suppose that there are l
                              
                                 j
                               levels in D
                              
                                 αj
                               (l
                              
                                 j
                              
                              ⩾1, 1⩽
                              j
                              ⩽
                              m). If the parameters α
                              1,
                              α
                              2,…,
                              α
                              
                                 m−1 were fitted using the improvement procedure described in item 2 above, then the weights are selected so as not to change the number of circles q
                              
                                 i
                               in D
                              
                                 αi
                              ; however, the lower is the level, the higher its weight should be. If the parameters were chosen without the use of the improvement procedure, then the level weights significantly affect the solution. For example, a certain selection of weights yields that the packing shown in Fig. 4a is optimal. For the other weights, the packing shown in Fig. 4b can turn out to be optimal (with a greater value of the objective function). This is important if this packing was obtained for D
                              
                                 αj
                               with 1⩽
                              j
                              ⩽
                              m
                              −1. For the set D
                              
                                 αj
                               with j
                              =
                              m, this is of no importance because we want to find the number of packed circles. In this study, we selected the level weights for D
                              
                                 αj
                               by the formula
                                 
                                    (9)
                                    
                                       
                                          
                                             c
                                          
                                          
                                             ji
                                          
                                       
                                       =
                                       1
                                       +
                                       τ
                                       (
                                       
                                          
                                             α
                                          
                                          
                                             j
                                          
                                       
                                       -
                                       
                                          
                                             y
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       ,
                                       
                                       1
                                       ⩽
                                       i
                                       ⩽
                                       
                                          
                                             l
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                    
                                 
                              where c
                              
                                 ji
                               is the weight of level i in D
                              
                                 αj
                              , τ is a fitted parameter, α
                              
                                 j
                               is the parameter determining the subset D
                              
                                 αj
                              , y
                              
                                 i
                               is the coordinate y of tier i in D
                              
                                 αj
                              , and l
                              
                                 j
                               is the number of levels in D
                              
                                 αj
                               (1⩽
                              j
                              ⩽
                              m), where the level indexes are counted from the bottom to the top. The quantity τ in (9) was chosen in the interval [0.1,0.35].

We considered the packing of circles into three geometric configurations:

The first non-convex figure B is shown in Fig. 5
                     . The size of B can be easily determined from Fig. 5a taking into account the fact that B contains three circles of radius 1.

The second configuration is the rectangle of width 3 and height 6; it is denoted by R (see Fig. 6
                     ).

The third configuration is the rectangle R from which two circles of radii 0.625 and 0.5 are cut out; we denote it by R
                     
                        d
                     . In Figs. 7 and 8
                     
                     , the parts that were cut out from R
                     
                        d
                      are shown in gray.

Our studies are motivated by the need of cutting out from a steel sheet as many circles (discs) of a given radius as possible taking into account that the steel sheet can be partially used. Therefore the rectangle R and figure R
                     
                        d
                      were chosen. Sizes of the rectangle R are thus selected that R was similar to the figure of a real metal sheet. Figure B (bootee) was chosen to show the potential of the method for the packing of equal circles in a non-convex domain. Note that the packing in the rectangular area was considered in many papers; see, for example, the works Bergin and Gentil [1], Bergin et al. [2], Lubachevsky and Graham [15] and the references therein. We want to pack as many circles of a given radius as possible into these configurations.

Consider the packing of congruent circles into the figure B. If the radius is equal to 1, then it is clear that three circles can be packed. This obvious solution can be obtained as follows. Let Δ=1 and the set T(Δ) consist of five points: T(Δ)={t
                     1,…,
                     t
                     5} (see Fig. 5a). Problem (4) is
                        
                           
                              N
                              =
                              
                                 
                                    z
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 
                                    z
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    z
                                 
                                 
                                    3
                                 
                              
                              +
                              
                                 
                                    z
                                 
                                 
                                    4
                                 
                              
                              +
                              
                                 
                                    z
                                 
                                 
                                    5
                                 
                              
                              →
                              
                                 max
                              
                           
                        
                     subject to
                        
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          +
                                          
                                             
                                                z
                                             
                                             
                                                2
                                             
                                          
                                          
                                          ⩽
                                          1
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                z
                                             
                                             
                                                1
                                             
                                          
                                          +
                                          3
                                          
                                             
                                                z
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                z
                                             
                                             
                                                3
                                             
                                          
                                          +
                                          
                                             
                                                z
                                             
                                             
                                                4
                                             
                                          
                                          
                                          ⩽
                                          3
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                z
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          2
                                          
                                             
                                                z
                                             
                                             
                                                3
                                             
                                          
                                          +
                                          
                                             
                                                z
                                             
                                             
                                                4
                                             
                                          
                                          
                                          ⩽
                                          2
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                z
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                z
                                             
                                             
                                                3
                                             
                                          
                                          +
                                          3
                                          
                                             
                                                z
                                             
                                             
                                                4
                                             
                                          
                                          +
                                          
                                             
                                                z
                                             
                                             
                                                5
                                             
                                          
                                          
                                          ⩽
                                          3
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                z
                                             
                                             
                                                4
                                             
                                          
                                          +
                                          
                                             
                                                z
                                             
                                             
                                                5
                                             
                                          
                                          
                                          ⩽
                                          1
                                          ,
                                          
                                          
                                             
                                                z
                                             
                                             
                                                i
                                             
                                          
                                          ∈
                                          {
                                          0
                                          ,
                                          1
                                          }
                                          ,
                                          
                                          1
                                          ⩽
                                          i
                                          ⩽
                                          5
                                          .
                                       
                                    
                                 
                              
                           
                        
                     By solving this problem, we obtain the desired solution z
                     1
                     =
                     z
                     3
                     =
                     z
                     5
                     =1, z
                     2
                     =
                     z
                     4
                     =0. Hence, the circle centers are at the points t
                     1, t
                     3, and t
                     5. To solve the problem of packing into B, R, and R
                     
                        d
                     , a computer program based on CPLEX-11.2 was developed.

Consider the figure B. First, we solve the packing problem for the entire set B assuming that the weight of each level is unity; then, we solve the same problem using the construction of the subsets D
                     
                        αi
                      (1⩽
                     i
                     ⩽
                     m) on the set B and different level weights. The problem is solved using Algorithm A.

Let the circle radius be r
                     =0.375 and Δ=0.09375 (Δ=
                     r/4). Construct a rectangular grid on B
                     ∗. The grid nodes generate the set T(Δ)={t
                     1,
                     t
                     2,…,
                     t
                     767} consisting of 767 points. Therefore, the size of problem (4) in this case is 767. The solution of this problem on the computer at our disposal (Intel Core2Duo CPU T7300 with frequency 2.00GHz, RAM 2.00Gb, OS Windows 7) took 58s (s) and produced the packing of 17 circles shown in Fig. 5b. Now, let Δ=0.046875 (Δ=
                     r/8). Then, the size of problem (4) is 2986, the solution takes 4h and produces the packing of 18 circles shown in Fig. 5c. Fig. 5d shows the packing of 81 circles obtained for the circle of radius 0.1875.

Let h
                     
                        i
                      be the time needed to find the packing for the set D
                     
                        αi
                      (1⩽
                     i
                     ⩽
                     m); H
                     
                        s
                      be the total time needed to find the packing using the sets D
                     
                        αi
                      (1⩽
                     i
                     ⩽
                     m), that is, 
                        
                           
                              
                                 H
                              
                              
                                 s
                              
                           
                           =
                           
                              
                                 ∑
                              
                              
                                 i
                                 =
                                 1
                              
                              
                                 m
                              
                           
                           
                              
                                 h
                              
                              
                                 i
                              
                           
                           +
                           
                              
                                 t
                              
                              
                                 s
                              
                           
                        
                     , where t
                     
                        s
                      is the time needed for preparatory computations; and H be the time needed to find the packing without the use of the sets D
                     
                        αi
                      (1⩽
                     i
                     ⩽
                     m). The computation time is given accurate to seconds.

The computation results for the set B and various radii of circles are presented in Table 2
                     . The columns in Table 2 contain the following data:
                        
                           •
                           Column 1 contains the circle radius;

Column 2 contains the grid size Δ;

Column 3 contains the number of variables (size of the problem) for the packing problem solved on the entire set B; the number of variables in the case when the problem is solved on the subsets D
                              
                                 αi
                               (1⩽
                              i
                              ⩽
                              m) separated by the symbol «/»is shown in parentheses;

Column 4 contains two numbers separated by «/». The first number is the number of the packed circles obtained using the subsets D
                              
                                 αi
                              , 1⩽
                              i
                              ⩽
                              m, and the second one is the number of the packed circles obtained without using D
                              
                                 αI
                               (without using our heuristic Algorithm A) The dash «-»indicates that the second number was not obtained because of too large computation time or the lack of memory.

Column 5 contains the obtained density of packing (p);

Column 6 contains the quantities α
                              1,
                              α
                              2,…,
                              α
                              
                                 m−1 used for the construction of the subsets D
                              
                                 αi
                               (1⩽
                              i
                              ⩽
                              m). For the case of two subsets D
                              
                                 αi
                               (1⩽
                              i
                              ⩽
                              m, m
                              =2), α
                              1 is shown; if three or more D
                              
                                 αi
                               (1⩽
                              i
                              ⩽
                              m) are constructed, then α
                              1,
                              α
                              2,…,
                              α
                              
                                 m−1 are separated by the symbol «/»;

Column 7 contains the computation time for the subsets D
                              
                                 αi
                               (1⩽
                              i
                              ⩽
                              m) separated by «/». Here, as everywhere, «h», «m» and «s» are the hour, minute and second, respectively. The computation time is given accurate to seconds;

Column 8 contains the total computation time with account for preparatory operations;

Column 9 contains the computation time spent on solving the packing problem without using the subsets D
                              
                                 αi
                               (1⩽
                              i
                              ⩽
                              m) with the unit weight for each level. The computation was interrupted if the computation time for the entire configuration exceeded 12h;

Column 10 contains the ratio of the computation times (H/H
                              
                                 s
                              ) without the use of the sets D
                              
                                 αi
                               (1⩽
                              i
                              ⩽
                              m) and with the use of the sets D
                              
                                 αi
                               (1⩽
                              i
                              ⩽
                              m).

The columns in Tables 3 and 4
                     
                      contain the same parameters as those in Table 2 for packings into R and R
                     
                        d
                     , respectively.

It is seen from Table 2 that the number of packed circles obtained with the use of D
                     
                        αI
                     , 1⩽
                     i
                     ⩽
                     m, (using our heuristic Algorithm A) is the same as that obtained without the use of these subsets. However, the computation times are significantly different (if H were obtained). For example, for the radius 0.375 the computation time (H) for the set B without using D
                     
                        αi
                      is by a factor of 19 more than the computation time (H
                     
                        s
                     ) with the use of two subsets D
                     
                        α1 and D
                     
                        α2 on B.

When the time of the calculation H turned out more than 12h, the task was removed from the account. In these cases, the packing density allows to evaluate the quality of the packing. Note that if the account is stopped, then the ratio H/H
                     
                        s
                      can be much greater than what’s listed in the table.


                     Table 3 presents the computation results for packing the maximum number of circles into the rectangle R.

Let r be the radius of n circles packed into the rectangle R. Then, n circles of radius r/3 can be packed into the rectangle of width 1 and height 2; that is, they can be packed into the configuration formed by two unit squares put one on the top of the other. It is easy to verify that, for the circles of radii 0.5 and 0.25, the number of circles shown in Table 3 is exactly the doubled number of circles of radius r/3 that can be packed into a unit square (see Table 13.1 in [18], where the best known results concerning the packing of circles into a unit square are presented). This result implies that we cannot increase the number of packed circles by using the possible free space at the interface between the squares. For the case r
                     =0.275(r/3=0.09166667), the table in [18] mentioned above implies that at least 60 circles can be packed into two unit squares. The algorithm proposed in this paper packs 61 circles into R.

Let r
                     =0.1875 (r/3=0.0625). In [18] it is pointed that if the circle radius r
                     ∗
                     ≈0.06252008, then 68 circles can be packed into the unit square. In this case, the packing density is approximately equal to 0.835022. We have found that into R 140 (140=68+68+4) circles of radius r
                     =0.0625 are packed and the packing density is equals to 0.859, which is more than the packing density of 68 circles of radius r
                     ∗ in the unit square.


                     Fig. 6 shows the packing of 18, 74 and 140 circles obtained for packing into R.


                     Table 4 presents the computation results for packing the maximum number of circles into the configuration R
                     
                        d
                      (the rectangle from which two circles of a known radius are preliminary removed).

When calculating the packing density for R
                     
                        d
                      we considered area of R
                     
                        d
                      excluding the rectangle parts lying below a pre-cut circles.

The results for circles with radii of 0.275 and 0.1875 are presented in Table 4 for two cases when shaded circles are at the top and at the bottom of the figure. The obtained results for the case when the shaded circles are at the top of the figure are marked with an asterisk (∗).


                     Table 4, as the preceding tables, shows that the computation times needed to produce a packing using the subsets D
                     
                        αi
                      (1⩽
                     i
                     ⩽
                     m) and without using these subsets can be significantly different.

Weights of levels may be useful based on the following considerations. Fig. 7 shows packings of circles of radius 0.375 into the configuration R
                     
                        d
                     . The packing in Fig. 7a was obtained using weights of levels, while the packing in Fig. 7b was obtained without using such weights. In both cases, the number of circles is the same. However, the packing in Fig. 7a can be more practical because it leaves larger parts of the configuration (material) than the packing depicted in Fig. 7b, which may be used for other purposes.

In some cases, the packing result may depend on directions of circles pressing up or down, right or left. Packing into R
                     
                        d
                      can be solved by pressing the circles up or down due to the selection of level weights. For the figure R
                     
                        d
                      pressing up circles is equivalent to the fact that the pre-cut circles (shaded in the figures) are placed at the top of the rectangle, and the packed circles are being still pressed down. For circles of radius 0.625, 0.5625, 0.5, 0.4375, 0.375, 0.3125, and 0.25 the number of packing circles did not depend on whether gray circles were at the bottom or top of the rectangle. For circles of radius 0.275 and 0.1875 we received different numbers of packing circles, depending on where the gray circles were. This is due to the fact whether in the early stages of packing circles are packed more “correct” or not. Fig. 8 shows the packing of 111 and 118 circles obtained at different position pre-cut (gray) circles. In Fig. 8a gray circles are at the bottom, and in Fig. 8b—at the top.

The problem (4) for the region B was solved (at our not powerful computer) without using the heuristic algorithm when the number N of packing circles did not exceed 37 and the dimension of the problem (4) was not more than 1697 (see Table 2). Sometimes the solution for higher dimension is possible to find, for example, for the dimension of 2986 when N
                     =18. It depends on successful choice of execution path of the program CPLEX-11.2.

A time solution of the problem (4) depends not only on the dimension of the problem, but also on the particular problem. In each of Tables 2–4, we give the solution time both using heuristics and without dividing the area into parts. For example, for the domain B without dividing into parts we have the following. For each value of radius 0.625, 0.5625, 0.5, 0.4375 and 0.3125 the solution is obtained not more than 25min (see Table 2); for each of the radii 0.375 and 0.275 the solution was obtained in 4.5h.

For the rectangle R we were able to solve the problem (4) without using the heuristic algorithm when the number of circles did not exceed 18 and the dimension of the problem (4) was not more than 2449. As an exception, the solution was found without using a heuristic algorithm for N
                     =32, see Table 3. For the figure R
                     
                        d
                      solutions were obtained without involving heuristic algorithm when the number of circles did not exceed 39, see Table 4.

Note again that in all cases, when the problem (4) was solved both without the involvement of the heuristic algorithm and with the involvement of this algorithm, the numbers of packing circles were the same. For cases, when the problem (4) was solved only with heuristic algorithm, the quality of solution was characterized by the packing density. In particular, packing density for R was compared with the density of the best-known packings, see the explanation after Table 3.

The numerical results demonstrate the effectiveness of the proposed approach.

@&#CONCLUSIONS@&#

The proposed linear model of the packing of equal circles of a given radius allows to pack the maximal possible number of circles in a bounded domain. It is important that in the packaging process it’s possible to press packed discs to a selected side (selected sides) of the region or not to do it. The heuristic algorithm presented in this paper allows to find the approximate number of packed circles and their location for large dimensions of constructed linear models.

The obtained numerical results confirm the effectiveness of this method. Presently, the problem solution based on the proposed models may be inferior to some other approaches in terms of accuracy. However, these models provide universal engineering means for packing congruent circles of the given radius into arbitrary domains.

@&#ACKNOWLEDGMENTS@&#

We are grateful to three anonymous reviewers for useful remarks that helped to improve and elaborate this study.

@&#REFERENCES@&#

