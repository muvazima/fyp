@&#MAIN-TITLE@&#A multicut L-shaped based algorithm to solve a stochastic programming model for the mobile facility routing and scheduling problem

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We have studied the mobile facility routing and scheduling problem with stochastic demand.


                        
                        
                           
                           We have formulated the problem as a two-stage stochastic programming model.


                        
                        
                           
                           We have developed a multicut L-shaped based method to solve the problem.


                        
                        
                           
                           We have designed several lower bound inequalities to improve the speed of convergence.


                        
                        
                           
                           We have demonstrated that our approach can yield high-quality solutions with extensive experiments.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Facilities planning and design

Routing

Fleet management

Mobile facility

@&#ABSTRACT@&#


               
               
                  This paper considers the mobile facility routing and scheduling problem with stochastic demand (MFRSPSD). The MFRSPSD simultaneously determines the route and schedule of a fleet of mobile facilities which serve customers with uncertain demand to minimize the total cost generated during the planning horizon. The problem is formulated as a two-stage stochastic programming model, in which the first stage decision deals with the temporal and spatial movement of MFs and the second stage handles how MFs serve customer demands. An algorithm based on the multicut version of the L-shaped method is proposed in which several lower bound inequalities are developed and incorporated into the master program. The computational results show that the algorithm yields a tighter lower bound and converges faster to the optimal solution. The result of a sensitivity analysis further indicates that in dealing with stochastic demand the two-stage stochastic programming approach has a distinctive advantage over the model considering only the average demand in terms of cost reduction.
               
            

@&#INTRODUCTION@&#

The Facility Location Problem (FLP) and the Vehicle Routing Problem (VRP) are two well-studied problems in the field of operations research. The two problems are commonly coupled to deal with the process of delivery and pickup. For a conventional FLP, we usually consider facilities at fixed locations. The VRP is solved to handle the movement of items between facilities (e.g. depots or distribution centers) and customers (e.g. retailers). In reality, some vehicles behave in a way similar to traditional facilities when they are stationary except that they can move from one place to another if necessary. For instance, light trucks equipped with cellular base stations are able to provide cellular service to areas where the established cellular network temporarily fails (Halper & Raghavan, 2011); fast food service provided from vans can move to serve customers in different regions. In this paper, we use the term Mobile Facility (MF) to distinguish this “facility-like-vehicle” either from facility in the FLP or vehicle in the VRP. We define MF as a facility capable of moving from one place to another, providing certain real-time service to the customers in the vicinity of its location if and only if it is stationary.

The most distinct advantage of MFs over fixed facilities is their flexibility in moving to accommodate the change in the demand pattern over time and space. This can be illustrated with a simple example shown in Fig. 1
                     . Given two customer points (A and B) and three time periods (t
                     1,
                     t
                     2,
                     t
                     3), the amount of demand for each customer in each period is shown below the node inside the squared box. Only one MF is available and the demand at A (or B) can only be served by locating the MF at A (or B). Additionally, it takes one time period to travel from A to B. With a fixed facility either at A or B, the total demand that can be served is 3 units (Fig. 1(b) and (c)). Note that the demand in A is decreasing while the demand in B is increasing. It is thus more beneficial if the MF can move from A to B during the second period, resulting in an increase to 5 units of the total demand covered (Fig. 1(d)). In a situation with multiple MFs, an efficient and effective tactical plan, including the route and time schedule, is needed in order to realize the perceived total benefits.

In the paper, we present a stochastic version of the mobile facility routing and scheduling problem by explicitly handling the stochastic demand, called as MFRSPSD. The goal is to decide the route and time schedule simultaneously for a fleet of MFs over a prespecified planning horizon, assign customer demands to MFs, and determine the amount of demand to be outsourced so as to minimize the total expected system-wide cost.

The remainder of the paper is organized as follows. Section 2 provides the problem description of the MFRSPSD, including the basic features, assumptions, and the expected input and output of the model. In Section 3, a detailed literature review is performed for research relevant to the MFRSPSD. A formal two-stage stochastic programming formulation of the MFSPSD is presented in Section 4 and a multicut L-shaped based method is developed in Section 5 to solve the problem. In Section 6, we present the computational results demonstrating the performance of the proposed algorithm. This is followed by Section 7 with conclusions and directions for future research.

The MFRSPSD is defined on a directed network G(V,
                     E) with node set V
                     ={v
                     1,
                     v
                     2,…,
                     v
                     
                        n
                     } and edge set E
                     ={e
                     1,
                     e
                     2,…,
                     e
                     
                        m
                     }. We denote the subset I
                     ⊆
                     V as the set of all customers points and the subset of nodes where MFs can be located as J
                     ⊆
                     V. A distance matrix D
                     =(d
                     
                        ij
                     ) satisfying the triangle inequality is defined on E. The distances d
                     
                        ij
                      between any pair of nodes i and j are assumed to be deterministic and time-invariant. We assume that d
                     
                        ij
                     
                     =
                     d
                     
                        ji
                     , although it can be relaxed easily.

For simplicity in modeling, we divide the planning horizon into ∣T∣ identical time periods, T
                     ={t∣t
                     =1,2,…,∣T∣}. Here the length of a time period is assumed to be sufficiently short such that, without loss of generality, all parameters within a time period are static. The demand level of each customer i for each time period t, denoted as 
                        
                           
                              
                                 W
                              
                              
                                 i
                              
                              
                                 t
                              
                           
                           (
                           ω
                           )
                        
                     , is time-dependent and stochastic which follow certain probability distributions, where ω represents a particular realization of the random variables. Let Ω be the set of all possible realizations of random variables, ω
                     ∈
                     Ω.

Three important features of the MFRSPSD are considered: (a) the service equipment can be mounted on MFs which can move from one place to another, (b) the travel time of MF is explicitly accounted in the model and the service time are incurred only when MFs are not in motion and (c) the amount of demand to be served is proportional to the duration of the service time at the location serving the demand.

In addition, all MFs are assumed to be homogeneous providing the same service and traveling in the same speed. Denote the set of MFs as M, indexed by m. The travel time 
                        
                           
                              
                                 T
                              
                              
                                 
                                    
                                       jj
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                        
                      from location j to j′ is assumed to be measured as an integer multiplier of a single time period. The travel time matrices are identical for all MFs due to the homogeneity assumption. Considering the expense of purchasing or renting an MF, staffing cost, equipment investment and so on, a fixed operating cost f needs to be paid for using an MF. Moreover, we impose a capacity limit C on the amount of demand that can be served by an MF in a single time unit. Thus, there is a possibility that the demand cannot be fully served by MFs due to the random fluctuation in demand over time and the limited capacity. For the demands that are not served, we assume that they are outsourced to a third party and a penalty cost γ
                     ⩾0 is incurred for each unit of unmet demand. This penalty cost can either be considered as the opportunity cost for the loss of demands or regarded as an expense for outsourcing the excess demands to other companies.

Since an MF in motion is unable to provide service, it is undesirable to keep it moving for a long time, a potential loss of benefit. On the other hand, it is undesirable either to keep an MF stationary all the time, since it may lose the potential benefit resulting from making a strategic move to areas with more demands. Thus the major trade-off of the MFRSPSD involves the decision of moving or keeping stationary.

In some cases, moving would neither improve nor degrade the total performance. A traveling inconvenience cost α is thus introduced to discourage unnecessary moving in those cases. This is illustrated in Fig. 2
                     . The setting of the example is similar to the one in Fig. 1 except that the demands are changed. In Fig. 2(a), the MF travels from A to B, and in Fig. 2(b), it stays at A all the time. Three units of demands are served in both cases. By imposing a traveling inconvenience cost on traveling decisions, the case in Fig. 2(b) is chosen. It is assumed that the cost incurred is much lower than other costs such that its impact over the major trade-off is negligible.

We assume that the service quality a customer receives from an MF is inversely proportional to the distance between the two to account for the “access cost”. In fact, this feature is quite common in practice. Take a cellular service as an example. The closer the base station is located to a user, the stronger the signal the user can receive. The problem we deal with here is thus not a typical coverage problem in which demand is either “covered” or “not covered”. We consider a demand assignment cost here, which is assumed to be linearly proportional to the distance between the customer point and the location of an MF, i.e. βd
                     
                        ij
                     , where β
                     ⩾0. β is introduced as the assignment cost factor per demand unit and per distance unit.

We propose to model the MFRSPSD by applying the a priori optimization approach, which is also referred to as the two-stage stochastic programming method in this study. The first stage decision, the routing and scheduling plan of MFs during the planning horizon, is made as “a priori” solution before the customer demands are known. Then the realizations of stochastic demands are disclosed and an optimal recourse action (the second stage decision) is determined conditioning on the first stage solution.

It is well known that even under the deterministic condition, the MFRSP is NP-hard as it is reduced to the classic facility location problem. Furthermore, the incorporation of stochastic and time dependent customer demand will make the problem much more complicated to solve. A priori optimization has been an attractive approach in handling uncertainty because of its advantage in computational tractability in comparison with the Markov Decision Process (MDP) or the re-optimization approach (Bertsimas et al., 1990). More importantly, the a priori optimization approach has a managerial advantage since it guarantees the regularity of service which is beneficial for both customer and service provider. In our case, an a priori plan enables the service provider to be familiar with routes and schedules, and meanwhile allows the customer to know when and where to obtain service in a predictable way. From a computational perspective, an a priori output can be used as a heuristic solution for a more complex stochastic dynamic problem (Goodson et al., 2013; Novoa & Storer, 2009).

The output that we expect to obtain from the MFRSPSD mainly covers four parts: (a) the number of MFs to be used, (b) the routing plan for MFs, specifying the movement of MFs, (c) timetable of the routing plan and (d) assignment plan from facilities to customers for different realizations of demand patterns. Note that the first three outputs are commonly regarded as the first stage decisions as well, indicating the actions to be made before the demand pattern being realized. The fourth output is the recourse actions in regard to both the specified first stage decisions and the specific demand pattern. The objective of the MFSPSD is to minimize the cost of implementing first stage decisions (fixed operation cost), plus the expected cost of recourse activity (assignment cost and penalty cost).

@&#LITERATURE REVIEW@&#

Research appears to be limited despite the obvious advantage of MFs over stationary facilities in many situations. However, some relevant topics such as the Dynamic Facility Location Problem (DFLP), the Vehicle Routing Problem (VRP), the Covering Tour Problem (CTP) and the Team Orienteering Problem (TOP) have been well studied. The outcome of these studies can shed light on both constructing models and developing solution methods for our problem. We first review some related work and then present the comparison between the relevant research topics and the problem we deal with.

The concept of “mobile facility” was first introduced by Halper and Raghavan (2011). They presented a continuous time formulation to model the maximum covering mobile facility routing problem for both single facility and multiple facilities under deterministic circumstances. They developed several heuristic algorithms to solve the multiple facilities model which proved to be effective according to computational results. For our problem, with the consideration of demand uncertainty, the problem turns into a more complex stochastic problem. Moreover, considering the disadvantage of the coverage measure mentioned in Section 2, we intend to minimize the average cost of the entire system (based on the FLP using the “median” measure).

Considering the feature of making decisions over a time horizon, the MFRSPSD is similar to a well-studied branch of facility location problem: the DFLP. The DFLP seeks to locate and/or relocate the facilities over a multi-period planning horizon (Albareda-Sambola et al., 2009; Antunes et al., 2009; Ballou, 1968; Canel & Khumawala, 1997; Contreras et al., 2011; Dias et al., 2006; Drezner & Wesolowsky, 1991; Qiu & Sharkey, 2013; Sonmez & Lim, 2012; Torres-Soto & Üster, 2010; Van Roy & Erlenkotter, 1982; Wesolowsky, 1973; Wesolowsky & Truscott, 1975). To meet the changing demand and/or other factors along the timeline, some new facilities can be opened whereas some existing ones can be closed or relocated at certain relocation cost. One important assumption for the DFLP is that as the relocation time for traditional facilities is relatively short in comparison with the length of the planning horizon, the relocation activity can be regarded as accomplished instantaneously. This is also the major difference between the MFRSPSD and the DFLP since the relocation time of MFs must be explicitly taken into account in the MFRSPSD. Besides, in the MFRSPSD each MF needs to follow a specific route through the whole planning horizon. This is not a requirement in the DFLP. In the DFLP, once a facility is relocated or closed it is cleared instantly from the model and has no effect on the later decision making process.

The CTP assumes that only part of the nodes needs to be selected to visit and other nodes can be covered by the selected node within certain coverage (Current et al., 1985; Current & Schilling, 1989; Current & Schilling, 1994; Current et al., 1984; Current et al., 1994; Gendreau et al., 1997; Hachicha et al., 2000). Recently, Tricoire et al. (2012) formulated a bi-objective CTP with stochastic demand which aimed at minimizing vehicle routing cost and expected uncovered demand. In addition to the distinction between “covering” and “median” measures, one of the major differences is the CTP does not consider the change of demand over the planning horizon. In addition, the amount of demand to be met by vehicles in CTP is not related to the length of time the mobile spending at the stop.

The VRP, a widely studied topic in operations research, has similarity to the MFRSP as they both involve the routing of vehicles. The literature about the VRP and stochastic VRP are very rich. Laporte and Louveaux (1993) presented a generic integer L-shaped method for the stochastic VRP with complete recourse. New optimality cuts were derived and shown to be more efficient when random variables follow continuous distributions or have too many states. Several lower bounds on the second stage value function were additionally developed. Gendreau et al. (1995) proposed an integer L-shaped algorithm for the VRP with stochastic demands and customers whose recourse policy consists of return trips to the depot in case of failures. Laporte et al. (2002) improved the integer L-shaped algorithm by adding new lower bounds on the expected penalty for failures with respect to the Poisson and normal distributed demands. In addition, they provided some variants of the optimality cuts as well as an efficient heuristic for their generation. A survey of the stochastic VRP can be found in Gendreau et al. (1996), Bertsimas and Simchi-Levi (1996) and Cordeau et al. (2007). Here we state several differences between the VRP and the MFRP: (1) In the MFRSP, the customer demand can be met by a nearby MF which functions like a traditional facility, yet the demand of a customer in the VRP can only be met by a visit to the customer, (2) the amount of demand being served at each location in the MFRSP depends on the duration the MF stays there, which is a decision variable. In the VRP, however, the service time is usually fixed and (3) the VRP typically enforces that each customer to be visited exactly once in each route with the sub-tour elimination constraints, whereas the MFRSP allows zero or multiple visits to any customer in each route.

Another highly relevant problem is the team orienteering problem (TOP) or the selective vehicle routing problem (SVRP) (Chao et al., 1996; Erdogan & Laporte, 2013; Golden et al., 1987; Hu & Lim, 2014; Keller & Goodchild, 1988; Labadie et al., 2012; Laporte & Martello, 1990; Tsiligirides, 1984). The TOP originates from a treasure hunting game, where a group of players need to collect rewards at various places and try to maximize the team collected rewards via multiple tours without violating a certain time limit. For more details of the TOP one can refer to survey papers by Feillet et al. (2005) and Vansteenwegen et al. (2011). However, we have not found any literature discussing the stochastic TOP so far. For the stochastic single player orienteering problem (SSPOP), Teng et al. (2004), Campbell et al. (2011) and Evers et al. (2014) all used the two-stage recourse model for the time-constrained selective traveling salesman problem (a variant of the SSPOP). In particular, Teng et al. (2004) developed an integer L-shaped method to solve the model. İlhan et al. (2008) studied the SSPOP with stochastic profits and proposed a parametric formulation to maximize the probability of collecting more than a prespecified target level within a time limit. Papapanagiotou et al. (2014) studied the orienteering problem with stochastic travel and service times by developing an approximation technique in evaluating the objective function.

Research on solution methods for two-stage stochastic programming has grown very quickly in the past few decades. The fundamental work of Van Slyke and Wets (1969) proposed a cutting plane method known as the L-shaped method which had been widely applied as a solution method for the two-stage stochastic program. The idea of the method is essentially the same as Benders decomposition algorithm (Benders, 1962) yet the feasibility questions are further taken care of in the L-shaped method (Birge & Louveaux, 1997). Geoffrion and Graves (1974) developed a variant of Benders decomposition method known as ∊-optimal approach which does not solve the master problem to optimality but instead to terminate the process once a feasible solution within some tolerance value of the best upper bound is found. Wollmer (1980) and Laporte and Louveaux (1993) later extended the L-shaped method to apply it to two-stage recourse mixed-integer stochastic programs. Mir Hassani et al. (2000) used the Benders decomposition to solve the resulting stochastic integer program and improve the performance of the algorithm by applying alternative decomposition representations which take into consideration the structure of the master problem. They also show that reversing the sense of the master problem can speed up the solution process. Santoso et al. (2005) integrated the sample average approximation (SAA) scheme (Kleywegt et al., 2002) with an accelerated L-shaped algorithm to quickly compute high quality solutions to large-scale stochastic supply chain design problems with a huge number of scenarios.

The first stage decisions of the MFSPSD consider whether to use an MF or not, and if used, when and where to locate this MF. We denote the decision variables as follows:
                           
                              (1)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   y
                                                
                                                
                                                   m
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               1
                                                            
                                                            
                                                               if MF
                                                               
                                                               m
                                                               
                                                               is permitted to use
                                                            
                                                         
                                                         
                                                            
                                                               0
                                                            
                                                            
                                                               otherwise
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   jm
                                                
                                                
                                                   t
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               1
                                                            
                                                            
                                                               if MF
                                                               
                                                               m
                                                               
                                                               stays at location
                                                               
                                                               j
                                                               
                                                               at period
                                                               
                                                               t
                                                            
                                                         
                                                         
                                                            
                                                               0
                                                            
                                                            
                                                               otherwise
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The second stage decisions involve the recourse actions with respect to the first stage decisions for different realizations of random variables. In this study, the recourse actions are to determine how to assign the customer demands to the stationary MFs at the lowest possible cost. Define 
                           
                              
                                 
                                    z
                                 
                                 
                                    ijm
                                 
                                 
                                    t
                                 
                              
                              (
                              ω
                              )
                           
                         as the amount of demand of customer point i being served by MF m located at j in period t for ω. The total amount of unmet demands by MFs in time period t for ω is denoted by p
                        
                           t
                        (ω). The second stage decision variables are defined as follows:
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                z
                                             
                                             
                                                ijm
                                             
                                             
                                                t
                                             
                                          
                                          (
                                          ω
                                          )
                                          ⩾
                                          0
                                          ,
                                       
                                       
                                          ∀
                                          i
                                          ,
                                          j
                                          ,
                                          m
                                          ,
                                          t
                                          ,
                                          ω
                                       
                                    
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                t
                                             
                                          
                                          (
                                          ω
                                          )
                                          ⩾
                                          0
                                          ,
                                       
                                       
                                          ∀
                                          t
                                          ,
                                          ω
                                       
                                    
                                 
                              
                           
                        
                     

The requirement that an MF can only be in service when it is stationary can be realized with the following expression:
                           
                              (2)
                              
                                 
                                    
                                       x
                                    
                                    
                                       jm
                                    
                                    
                                       t
                                    
                                 
                                 +
                                 
                                    
                                       x
                                    
                                    
                                       
                                          
                                             j
                                          
                                          
                                             ′
                                          
                                       
                                       m
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 ⩽
                                 1
                                 ,
                                 
                                 ∀
                                 t
                                 ,
                                 m
                                 ,
                                 j
                                 ,
                                 
                                    
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 
                                 and
                                 
                                 j
                                 
                                 ≠
                                 
                                 
                                    
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       t
                                    
                                    
                                       ′
                                    
                                 
                                 ∈
                                 {
                                 t
                                 ,
                                 …
                                 ,
                                 
                                    min
                                 
                                 {
                                 t
                                 +
                                 
                                    
                                       T
                                    
                                    
                                       
                                          
                                             jj
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 |
                                 T
                                 |
                                 }
                                 }
                                 .
                              
                           
                        
                     

If 
                           
                              
                                 
                                    x
                                 
                                 
                                    jm
                                 
                                 
                                    t
                                 
                              
                              =
                              1
                           
                         i.e. MF m is stationary at location j in period t, it can only be available at location j′≠
                        j after a certain period of time, depending on the time it takes to travel from location j to location j′. This leads to 
                           
                              
                                 
                                    x
                                 
                                 
                                    
                                       
                                          j
                                       
                                       
                                          ′
                                       
                                    
                                    m
                                 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              =
                              0
                              ,
                              ∀
                              
                                 
                                    j
                                 
                                 
                                    ′
                                 
                              
                              
                              ≠
                              
                              j
                           
                         and 
                           
                              ∀
                              
                                 
                                    t
                                 
                                 
                                    ′
                                 
                              
                              ∈
                              {
                              t
                              ,
                              …
                              ,
                              min
                              {
                              t
                              +
                              
                                 
                                    T
                                 
                                 
                                    
                                       
                                          jj
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              ,
                              
                              |
                              T
                              |
                              }
                              }
                           
                        . It indicates that an earlier decision of deploying an MF at one location would directly affect future decisions both temporally and spatially. In fact, this correlation is the major source of complexity for optimizing the MFRSPSD.

Since the MF has to be in an active condition before providing service, it is necessary to impose the following constraints:
                           
                              (3)
                              
                                 
                                    
                                       x
                                    
                                    
                                       jm
                                    
                                    
                                       t
                                    
                                 
                                 ⩽
                                 
                                    
                                       y
                                    
                                    
                                       m
                                    
                                 
                                 ,
                                 
                                 ∀
                                 j
                                 ,
                                 m
                                 ,
                                 t
                                 .
                              
                           
                        It is easy to see that (2) and (3) can be considered jointly so that the two constraints can be combined into a more compact form:
                           
                              (4)
                              
                                 
                                    
                                       x
                                    
                                    
                                       jm
                                    
                                    
                                       t
                                    
                                 
                                 +
                                 
                                    
                                       x
                                    
                                    
                                       
                                          
                                             j
                                          
                                          
                                             ′
                                          
                                       
                                       m
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 ⩽
                                 
                                    
                                       y
                                    
                                    
                                       m
                                    
                                 
                                 ,
                                 
                                 ∀
                                 t
                                 ,
                                 m
                                 ,
                                 j
                                 ,
                                 
                                    
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 
                                 and
                                 
                                 j
                                 
                                 ≠
                                 
                                 
                                    
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       t
                                    
                                    
                                       ′
                                    
                                 
                                 ∈
                                 {
                                 t
                                 ,
                                 …
                                 ,
                                 
                                    min
                                 
                                 {
                                 t
                                 +
                                 
                                    
                                       T
                                    
                                    
                                       
                                          
                                             jj
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 |
                                 T
                                 |
                                 }
                                 }
                                 .
                              
                           
                        
                     

Once the first stage decisions are made, the second stage recourse actions can be decided and evaluated with respect to different realizations of randomness. For each realization ω, the second stage recourse problem (RP) is in essence a transportation problem which can be stated as a cost minimization problem as follows:
                           
                              (5)
                              
                                 [
                                 RP
                                 ]
                                 :
                                 Q
                                 (
                                 x
                                 ,
                                 ω
                                 )
                                 =
                                 
                                    min
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          m
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                       
                                    
                                 
                                 β
                                 
                                    
                                       d
                                    
                                    
                                       ij
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       ijm
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 ω
                                 )
                                 +
                                 γ
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                       
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 ω
                                 )
                                 .
                              
                           
                        
                        
                           
                              (6)
                              
                                 
                                 
                                 
                                 
                                 
                                 
                                 s.t
                                 .
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          m
                                       
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       ijm
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 ω
                                 )
                                 ⩽
                                 
                                    
                                       W
                                    
                                    
                                       i
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 ω
                                 )
                                 ,
                                 
                                 ∀
                                 i
                                 ,
                                 t
                                 .
                              
                           
                        
                        
                           
                              (7)
                              
                                 
                                 
                                 
                                 
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       ijm
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 ω
                                 )
                                 ⩽
                                 
                                    
                                       Cx
                                    
                                    
                                       jm
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                 ∀
                                 j
                                 ,
                                 m
                                 ,
                                 t
                                 .
                              
                           
                        
                        
                           
                              (8)
                              
                                 
                                 
                                 
                                 
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          m
                                       
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       ijm
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 ω
                                 )
                                 +
                                 
                                    
                                       p
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 ω
                                 )
                                 ⩾
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    
                                       W
                                    
                                    
                                       i
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 ω
                                 )
                                 ,
                                 
                                 ∀
                                 t
                                 .
                              
                           
                        
                        
                           
                              (9)
                              
                                 
                                 
                                 
                                 
                                 
                                 
                                    
                                       z
                                    
                                    
                                       ijm
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 ω
                                 )
                                 ⩾
                                 0
                                 ,
                                 
                                 ∀
                                 i
                                 ,
                                 j
                                 ,
                                 m
                                 ,
                                 t
                                 .
                              
                           
                        
                        
                           
                              (10)
                              
                                 
                                 
                                 
                                 
                                 
                                 
                                    
                                       p
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 ω
                                 )
                                 ⩾
                                 0
                                 ,
                                 
                                 ∀
                                 t
                                 .
                              
                           
                        
                     

The objective function (5) intends to minimize the total costs which include two parts: cost of assigning demands to the MFs and the penalty costs for unmet demands. Constraints (6) ensure that the demands of customer i to be served do not exceed the total demands at that point in each period. It also implies that it is possible that not all demands are served by MFs. Constraints (7) state the limit of the service capacity of MF m when it is stationary at location j in period t serving customer i. Constraints (8) ensure that all demands have to be met or the unmet part must be subject to a penalty cost. Constraints (9) and (10) are nonnegative requirements for second stage decision variables.

The total cost of the MFRSPSD generated during the planning horizon consists of three components: fixed operation cost of using of MFs, traveling inconvenience cost of MFs and the total expected cost of second stage recourse actions. The fixed operation cost part is 
                           
                              ∑
                              
                                 
                                    fy
                                 
                                 
                                    m
                                 
                              
                           
                        . As there is no decision variable depicting the travel of MF, some transformation needs to be made to describe the traveling inconvenience cost part. Since the minimization of the traveling inconvenience cost is equivalent to maximization of profit of keeping MFs stationary whenever possible, we can thus present the cost in the following form:
                           
                              
                                 
                                    max
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          m
                                       
                                    
                                 
                                 
                                    
                                       α
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       jm
                                    
                                    
                                       t
                                    
                                 
                              
                           
                        where α′=
                        α
                        ⩾0 is the profit weight factor. To be consistent with the sense of optimization, we transform the maximization into minimization as follows:
                           
                              
                                 
                                    min
                                 
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          m
                                       
                                    
                                 
                                 α
                                 
                                    
                                       x
                                    
                                    
                                       jm
                                    
                                    
                                       t
                                    
                                 
                                 .
                              
                           
                        
                     

Denote the second stage objective function as Φ(x)=
                        E
                        
                           ω
                         [Q(x,
                        ω)], where Φ(·) is defined as the expected recourse function which includes the shipping and shortage costs in the second stage, given x belongs to the first stage feasible region constrained by (1) and (4).

Together with the constraints discussed earlier, we come up with a two-stage stochastic programming formulation for the MFRSPSD as follows:
                           
                              (11)
                              
                                 [
                                 TS
                                 ]
                                 :
                                 
                                    min
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          m
                                       
                                    
                                 
                                 
                                    
                                       fy
                                    
                                    
                                       m
                                    
                                 
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          m
                                       
                                    
                                 
                                 α
                                 
                                    
                                       x
                                    
                                    
                                       jm
                                    
                                    
                                       t
                                    
                                 
                                 +
                                 Φ
                                 (
                                 x
                                 )
                                 .
                              
                           
                        
                        
                           
                              
                                 
                                 
                                 s
                                 .
                                 t
                                 .
                                 
                                 Constraints
                                 
                                 
                                    (1) and (4)
                                 
                              
                           
                        where
                           
                              (12)
                              
                                 Φ
                                 (
                                 x
                                 )
                                 =
                                 
                                    
                                       E
                                    
                                    
                                       ω
                                    
                                 
                                 [
                                 Q
                                 (
                                 x
                                 ,
                                 ω
                                 )
                                 ]
                                 .
                              
                           
                        
                     

Unfortunately, if we handle the stochastic demands by using time-dependent probability distributions directly, the scale of Ω will be prohibitively large (even infinite) such that the model becomes computationally intractable. To overcome this challenge, we propose to specify a set of scenarios for different demand patterns through a simple sampling approach, with each scenario associated with a prespecified probability of occurrence. Let Ξ denote the scenario set and each scenario ξ has a probability ρ(ξ) as 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    ξ
                                    ∈
                                    Ξ
                                 
                              
                              ρ
                              (
                              ξ
                              )
                              =
                              1
                           
                        . In our case, we assume that ρ(ξ)=1/∣Ξ∣, where ∣Ξ∣ is the cardinality of scenario set.

Given the limited number of scenarios and the associated probability of occurrence, the above TS formulation can be transformed into a mixed-integer programming problem which is often referred to as the Deterministic Equivalent Problem (DEP). We will use this formulation as the two-stage model shown as follows:
                           
                              (13)
                              
                                 [
                                 DEP
                                 ]
                                 :
                                 
                                    min
                                 
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          m
                                       
                                    
                                 
                                 
                                    
                                       fy
                                    
                                    
                                       m
                                    
                                 
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          m
                                       
                                    
                                 
                                 α
                                 
                                    
                                       x
                                    
                                    
                                       jm
                                    
                                    
                                       t
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          ξ
                                       
                                    
                                 
                                 ρ
                                 (
                                 ξ
                                 )
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   m
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   t
                                                
                                             
                                          
                                          β
                                          
                                             
                                                d
                                             
                                             
                                                ij
                                             
                                          
                                          
                                             
                                                z
                                             
                                             
                                                ijm
                                             
                                             
                                                t
                                             
                                          
                                          (
                                          ξ
                                          )
                                          +
                                          γ
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   t
                                                
                                             
                                          
                                          
                                             
                                                p
                                             
                                             
                                                t
                                             
                                          
                                          (
                                          ξ
                                          )
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (14)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                             
                                             s
                                             .
                                             t
                                             .
                                             
                                             Constraints
                                             
                                             
                                                (1) and (4)
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      j
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      m
                                                   
                                                
                                             
                                             
                                                
                                                   z
                                                
                                                
                                                   ijm
                                                
                                                
                                                   t
                                                
                                             
                                             (
                                             ξ
                                             )
                                             ⩽
                                             
                                                
                                                   W
                                                
                                                
                                                   i
                                                
                                                
                                                   t
                                                
                                             
                                             (
                                             ξ
                                             )
                                             ,
                                             
                                             ∀
                                             i
                                             ,
                                             t
                                             ,
                                             ξ
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (15)
                              
                                 
                                 
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       ijm
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 ξ
                                 )
                                 ⩽
                                 
                                    
                                       Cx
                                    
                                    
                                       jm
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                 ∀
                                 j
                                 ,
                                 m
                                 ,
                                 t
                                 ,
                                 ξ
                              
                           
                        
                        
                           
                              (16)
                              
                                 
                                 
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          m
                                       
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       ijm
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 ξ
                                 )
                                 +
                                 
                                    
                                       p
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 ξ
                                 )
                                 ⩾
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    
                                       W
                                    
                                    
                                       i
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 ξ
                                 )
                                 ,
                                 
                                 ∀
                                 t
                                 ,
                                 ξ
                              
                           
                        
                        
                           
                              (17)
                              
                                 
                                 
                                 
                                 
                                    
                                       z
                                    
                                    
                                       ijm
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 ξ
                                 )
                                 ⩾
                                 0
                                 ,
                                 
                                 ∀
                                 i
                                 ,
                                 j
                                 ,
                                 m
                                 ,
                                 t
                                 ,
                                 ξ
                              
                           
                        
                        
                           
                              (18)
                              
                                 
                                 
                                 
                                 
                                    
                                       p
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 ξ
                                 )
                                 ⩾
                                 0
                                 ,
                                 
                                 ∀
                                 t
                                 ,
                                 ξ
                              
                           
                        
                     

With the increase in the network size and the number of scenarios, the DEP can become prohibitively large and intractable to solve by directly using the commercially available optimization solver (e.g. CPLEX). The computational challenge motivates us to search for alternative approaches such as the decomposition method by exploiting the special structure of the problem so as to keep the computation time within an acceptable level.

To effectively and efficiently solve the DEP model, an L-shaped based method is developed with the following three enhancements: (1) adding additional lower bound inequalities to transmit more second stage information into the master problem with no significant increase in complexity, (2) generating the optimality cuts with respect to further decomposed second stage recourse problems to incorporate more specific information into the master problem in comparison with the conventional L-shaped method, and (3) adjusting the stopping criteria for the master problem by taking advantage of the special structure of the L-shaped method to speed up the computation time for solving the master problem. We denote this multicut L-shaped based method with problem specific valid inequalities and cuts as E-LS method (E stands for the above three enhancements).

In the following, we provide first a brief introduction of the classic L-shaped method (C-LS) and the multicut version L-shaped method (M-LS). A detailed discussion of these two methods can be found in Van Slyke and Wets (1969), Birge and Louveaux (1988) and Birge and Louveaux (1997).

Instead of solving the complete model of the MFRSPSD directly, the C-LS method iteratively solves a relaxed master problem (RMP) as follows:
                        
                           (19)
                           
                              [
                              RMP
                              ]
                              
                              
                                 min
                              
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       m
                                    
                                 
                              
                              
                                 
                                    fy
                                 
                                 
                                    m
                                 
                              
                              -
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       m
                                    
                                 
                              
                              α
                              
                                 
                                    x
                                 
                                 
                                    jm
                                 
                                 
                                    t
                                 
                              
                              +
                              θ
                           
                        
                     
                     
                        
                           (20)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                          
                                          s
                                          .
                                          t
                                          .
                                          
                                          Constraints
                                          
                                          
                                             (1) and (4)
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                          
                                          
                                          θ
                                          +
                                          C
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   ξ
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   t
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   m
                                                
                                             
                                          
                                          ρ
                                          (
                                          ξ
                                          )
                                          
                                             
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                jmt
                                             
                                             
                                                s
                                             
                                          
                                          (
                                          ξ
                                          )
                                          
                                             
                                                x
                                             
                                             
                                                jm
                                             
                                             
                                                t
                                             
                                          
                                          ⩾
                                          
                                             
                                                b
                                             
                                             
                                                s
                                             
                                          
                                          ,
                                          
                                          ∀
                                          s
                                          ∈
                                          S
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (21)
                           
                              
                              
                              
                              
                                 
                                    b
                                 
                                 
                                    s
                                 
                              
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       ξ
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                    
                                 
                              
                              ρ
                              (
                              ξ
                              )
                              
                                 
                                    W
                                 
                                 
                                    i
                                 
                                 
                                    t
                                 
                              
                              (
                              ξ
                              )
                              [
                              
                                 
                                    
                                       
                                          q
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    t
                                 
                                 
                                    s
                                 
                              
                              (
                              ξ
                              )
                              -
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    it
                                 
                                 
                                    s
                                 
                              
                              (
                              ξ
                              )
                              ]
                              ,
                              
                              ∀
                              s
                              ∈
                              S
                           
                        
                     
                     
                        
                           (22)
                           
                              [
                              RP
                              (
                              ξ
                              )
                              ]
                              
                              Q
                              (
                              x
                              ,
                              ξ
                              )
                              =
                              
                                 min
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       m
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                    
                                 
                              
                              β
                              
                                 
                                    d
                                 
                                 
                                    ij
                                 
                              
                              
                                 
                                    z
                                 
                                 
                                    ijm
                                 
                                 
                                    t
                                 
                              
                              (
                              ξ
                              )
                              +
                              γ
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                    
                                 
                              
                              
                                 
                                    p
                                 
                                 
                                    t
                                 
                              
                              (
                              ξ
                              )
                           
                        
                     
                     
                        
                           
                              
                              
                              s
                              .
                              t
                              .
                              
                              Constraints
                              
                              
                                 (14)–(17)
                              
                           
                        
                     
                  

The objective function (19) is equivalent to (13), where θ
                     ⩾
                     E
                     
                        ξ
                     [Q(x,
                     ξ)] and Q(x,
                     ξ) denotes the objective function of the RP (ξ). Constraints (1) and (4) come from the first stage problem. As the demands are the only stochastic parameters in the MFRSPSD and the unmet part can be penalized, the second stage recourse problems are inherently feasible no matter what the first stage decisions are. In stochastic programming, the MFRSPSD is considered to be a complete recourse two-stage stochastic program. Therefore, the feasibility checking process is unnecessary and no feasibility cuts exist in the RMP for the MFRSPSD. Denote S as the set of optimality cuts, indexed by s. Define b
                     
                        s
                      in (21) as the right hand side value of optimality cut s. Constraints (20) are the optimality cuts which are generated by utilizing the optimal simplex multipliers of the second stage recourse problem. For the optimality cut s, 
                        
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 it
                              
                              
                                 s
                              
                           
                           (
                           ξ
                           )
                           ,
                           
                              
                                 
                                    
                                       r
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 jmt
                              
                              
                                 s
                              
                           
                           (
                           ξ
                           )
                        
                      and 
                        
                           
                              
                                 
                                    
                                       q
                                    
                                    
                                       ¯
                                    
                                 
                              
                              
                                 t
                              
                              
                                 s
                              
                           
                           (
                           ξ
                           )
                        
                      represent the optimal simplex multipliers associated with constraints (14)–(16), respectively. A newly constructed optimality cut strengthen the feasible region of the RMP by cutting off the current non-optimal solution. The underlying mechanisms of constructing optimality cuts have been thoroughly discussed in Birge and Louveaux (1997) and thus we do not repeat them anymore.

The RMP is iteratively solved such that a lower bound of the optimal objective function of the MFRSPSD can be obtained. Given the feasible first stage decision values obtained from solving the RMP, the RPs turn into linear programs which can be easily solved to optimality. An upper bound can be therefore obtained as the summation of the expected second stage objective function values and the corresponding first stage objective function values. If the best lower bound and best upper bound are equal or close enough to each other, the algorithm solves the original problem to optimality/near optimality; otherwise, a new optimality cut will be added into the master problem and the next iteration will start over.

The M-LS method is a variant of the C-LS method which allows adding several cuts instead of only one in each iteration. The M-LS method generates a cut with respect to each scenario rather than aggregating them into a single optimality cut in each iteration. As the scenarios are the same and more cuts are incorporated into the master problem in each iteration, the bounding effect is at least equivalent to the C-LS method.

In this section, we aim at incorporating more second stage information into the first stage without adding optimality cuts into the master problem. This is done by adding several lower bound inequalities into the master problem. The lower bound inequalities are obtained by exploiting the specific characteristics of the second stage sub-problem. Observe that the second stage problem can be further decomposed into independent sub-problems with respect to scenarios and time periods. Thus, for simplicity, we consider a single scenario ξ
                        ∈
                        Ξ and a single time period t
                        ∈
                        T of the second stage problem RP (t,
                        ξ) in the following discussion.
                           
                              (23)
                              
                                 [
                                 RP
                                 (
                                 t
                                 ,
                                 ξ
                                 )
                                 ]
                                 
                                 
                                    min
                                 
                                 
                                 
                                    
                                       θ
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 ξ
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   m
                                                
                                             
                                          
                                          β
                                          
                                             
                                                d
                                             
                                             
                                                ij
                                             
                                          
                                          
                                             
                                                z
                                             
                                             
                                                ijm
                                             
                                             
                                                t
                                             
                                          
                                          (
                                          ξ
                                          )
                                          +
                                          γ
                                          
                                             
                                                p
                                             
                                             
                                                t
                                             
                                          
                                          (
                                          ξ
                                          )
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (24)
                              
                                 
                                 
                                 
                                 
                                 s.t.
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          m
                                       
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       ijm
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 ξ
                                 )
                                 ⩽
                                 
                                    
                                       W
                                    
                                    
                                       i
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 ξ
                                 )
                                 ,
                                 
                                 ∀
                                 i
                              
                           
                        
                        
                           
                              (25)
                              
                                 
                                 
                                 
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       ijm
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 ξ
                                 )
                                 ⩽
                                 
                                    
                                       Cx
                                    
                                    
                                       jm
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                 ∀
                                 j
                                 ,
                                 m
                              
                           
                        
                        
                           
                              (26)
                              
                                 
                                 
                                 
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          m
                                       
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       ijm
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 ξ
                                 )
                                 +
                                 
                                    
                                       p
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 ξ
                                 )
                                 ⩾
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    
                                       W
                                    
                                    
                                       i
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 ξ
                                 )
                              
                           
                        
                        
                           
                              (27)
                              
                                 
                                 
                                 
                                 
                                 
                                    
                                       z
                                    
                                    
                                       ijm
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 ξ
                                 )
                                 ⩾
                                 0
                                 ,
                                 
                                 ∀
                                 i
                                 ,
                                 j
                                 ,
                                 m
                              
                           
                        
                        
                           
                              (28)
                              
                                 
                                 
                                 
                                 
                                 
                                    
                                       p
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 ξ
                                 )
                                 ⩾
                                 0
                              
                           
                        
                        
                           Proposition 1
                           
                              The inequalities
                              
                                 
                                    (29)
                                    
                                       
                                          
                                             θ
                                          
                                          
                                             t
                                          
                                       
                                       (
                                       ξ
                                       )
                                       ⩾
                                       γ
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          
                                             W
                                          
                                          
                                             i
                                          
                                          
                                             t
                                          
                                       
                                       -
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                m
                                             
                                          
                                       
                                       C
                                       
                                          
                                             
                                                γ
                                                -
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      MIN
                                                   
                                                   
                                                      j
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             jm
                                          
                                          
                                             t
                                          
                                       
                                       (
                                       ξ
                                       )
                                       ,
                                       
                                       ∀
                                       t
                                       ,
                                       ξ
                                       .
                                    
                                 
                              
                              are lower bound inequalities for MFRSPSD, where
                              
                                 
                                    (30)
                                    
                                       
                                          
                                             d
                                          
                                          
                                             MIN
                                          
                                          
                                             j
                                          
                                       
                                       =
                                       
                                          min
                                       
                                       {
                                       γ
                                       ,
                                       
                                          
                                             
                                                min
                                             
                                             
                                                i
                                                ∈
                                                I
                                             
                                          
                                       
                                       β
                                       
                                          
                                             d
                                          
                                          
                                             ij
                                          
                                       
                                       }
                                       ,
                                       
                                       ∀
                                       j
                                       ∈
                                       J
                                       .
                                    
                                 
                              
                           

Note that the worst case for second stage recourse action is that all demands have to be outsourced. It follows that the maximum objective function value of RP (t,
                              ξ), i.e. an upper bound for RP (t,
                              ξ), cannot be larger than 
                                 
                                    
                                       
                                          
                                             
                                                θ
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          t
                                       
                                    
                                    (
                                    ξ
                                    )
                                    =
                                    γ
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          W
                                       
                                       
                                          i
                                       
                                       
                                          t
                                       
                                    
                                    (
                                    ξ
                                    )
                                 
                              , implying 
                                 
                                    
                                       
                                          θ
                                       
                                       
                                          t
                                       
                                    
                                    (
                                    ξ
                                    )
                                    ⩽
                                    
                                       
                                          
                                             
                                                θ
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          t
                                       
                                    
                                    (
                                    ξ
                                    )
                                 
                              .

This can only happen when there is no MF available at time t or the assignment cost for any demand from an available MF is greater or equal to the outsourcing cost. Assuming that MF m locating at j and customer i with βd
                              
                                 ij
                              
                              <
                              γ and 
                                 
                                    
                                       
                                          z
                                       
                                       
                                          ijm
                                       
                                       
                                          t
                                       
                                    
                                    (
                                    ξ
                                    )
                                    =
                                    
                                       
                                          W
                                       
                                       
                                          i
                                       
                                       
                                          t
                                       
                                    
                                    (
                                    ξ
                                    )
                                 
                              , there is a cost reduction 
                                 
                                    
                                       
                                          W
                                       
                                       
                                          i
                                       
                                       
                                          t
                                       
                                    
                                    (
                                    ξ
                                    )
                                    (
                                    γ
                                    -
                                    β
                                    
                                       
                                          d
                                       
                                       
                                          ij
                                       
                                    
                                    )
                                 
                               from the previous upper bound. The maximum amount of cost reduction from 
                                 
                                    
                                       
                                          
                                             
                                                θ
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          t
                                       
                                    
                                    (
                                    ξ
                                    )
                                 
                               is calculated by exploiting the full capacity of all stationary MFs in 
                                 
                                    
                                       
                                          
                                             m
                                             ∈
                                             M
                                             |
                                             
                                                
                                                   x
                                                
                                                
                                                   jm
                                                
                                                
                                                   t
                                                
                                             
                                             =
                                             1
                                          
                                       
                                    
                                 
                               at the lowest assignment cost for all customers to the location in 
                                 
                                    
                                       
                                          
                                             j
                                             ∈
                                             J
                                             |
                                             
                                                
                                                   x
                                                
                                                
                                                   jm
                                                
                                                
                                                   t
                                                
                                             
                                             =
                                             1
                                          
                                       
                                    
                                 
                              , which is (30). The maximum amount of cost reduction states as:
                                 
                                    (31)
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                m
                                             
                                          
                                       
                                       C
                                       
                                          
                                             
                                                r
                                                -
                                                
                                                   min
                                                
                                                
                                                   
                                                      
                                                         γ
                                                         ,
                                                         
                                                            
                                                               d
                                                            
                                                            
                                                               MIN
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             jm
                                          
                                          
                                             t
                                          
                                       
                                       .
                                    
                                 
                              Therefore, we can obtain a lower bound inequality as (29).□

It can also be considered as a lower bound obtained by relaxing the demand constraint (24), since we assume that total capacity of all stationary MFs is utilized at minimum assignment cost without concerning how many demands are actually there.


                              The inequalities
                              
                                 
                                    (32)
                                    
                                       
                                          
                                             θ
                                          
                                          
                                             t
                                          
                                       
                                       (
                                       ξ
                                       )
                                       ⩾
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             MIN
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             W
                                          
                                          
                                             i
                                          
                                          
                                             t
                                          
                                       
                                       (
                                       ξ
                                       )
                                       ,
                                       
                                       ∀
                                       t
                                       ,
                                       ξ
                                       .
                                    
                                 
                              
                              are lower bound inequalities for MFRSPSD, where 
                              
                                 
                                    
                                       
                                          J
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       
                                          
                                             j
                                             :
                                             
                                                
                                                   x
                                                
                                                
                                                   jm
                                                
                                                
                                                   t
                                                
                                             
                                             =
                                             1
                                          
                                       
                                    
                                 
                               
                              and
                              
                                 
                                    (33)
                                    
                                       
                                          
                                             d
                                          
                                          
                                             MIN
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       
                                          min
                                       
                                       {
                                       γ
                                       ,
                                       
                                          
                                             
                                                min
                                             
                                             
                                                j
                                                ∈
                                                
                                                   
                                                      J
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                       
                                       β
                                       
                                          
                                             d
                                          
                                          
                                             ij
                                          
                                       
                                       }
                                       ,
                                       
                                       ∀
                                       i
                                       ∈
                                       I
                                       .
                                    
                                 
                              
                           

If we relax the capacity limit of MFs and treat MFs as uncapacitated, the demand of customer i can be fully served at the lowest assignment cost or from its nearest location in 
                                 
                                    
                                       
                                          J
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       
                                          
                                             j
                                             :
                                             
                                                
                                                   x
                                                
                                                
                                                   jm
                                                
                                                
                                                   t
                                                
                                             
                                             =
                                             1
                                          
                                       
                                    
                                 
                              . We denote this lowest assignment cost as in (33). Therefore, θ
                              
                                 t
                              (ξ) must be at least equal to or larger than the cost if all demands are met at the lowest assignment cost. Similar to lower bound inequalities (29), the mathematical representation of the new lower bound inequalities can be expressed as (32).□


                              The inequalities
                              
                                 
                                    (34)
                                    
                                       
                                          
                                             θ
                                          
                                          
                                             t
                                          
                                       
                                       (
                                       ξ
                                       )
                                       ⩾
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             MIN
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             W
                                          
                                          
                                             i
                                          
                                          
                                             t
                                          
                                       
                                       (
                                       ξ
                                       )
                                       ,
                                       
                                       ∀
                                       t
                                       ,
                                       ξ
                                       .
                                    
                                 
                              
                              are lower bound inequalities for MFRSPSD, where:
                              
                                 
                                    (35)
                                    
                                       
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             MIN
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       
                                          min
                                       
                                       {
                                       γ
                                       ,
                                       
                                          
                                             
                                                min
                                             
                                             
                                                j
                                                ∈
                                                J
                                             
                                          
                                       
                                       β
                                       
                                          
                                             d
                                          
                                          
                                             ij
                                          
                                       
                                       }
                                       ,
                                       
                                       ∀
                                       i
                                       ∈
                                       I
                                       .
                                    
                                 
                              
                           

Denote the lowest assignment cost from all locations in J instead of 
                                 
                                    
                                       
                                          J
                                       
                                       
                                          ′
                                       
                                    
                                    =
                                    
                                       
                                          
                                             j
                                             :
                                             
                                                
                                                   x
                                                
                                                
                                                   jm
                                                
                                                
                                                   t
                                                
                                             
                                             =
                                             1
                                          
                                       
                                    
                                 
                               to customer i as in (33). As J′⊆
                              J, the new lowest assignment cost (35) can only be less than or equal to 
                                 
                                    
                                       
                                          d
                                       
                                       
                                          MIN
                                       
                                       
                                          i
                                       
                                    
                                 
                               in (33). Hence, the inequalities still hold to be correct, i.e. (34), if we substitute 
                                 
                                    
                                       
                                          d
                                       
                                       
                                          MIN
                                       
                                       
                                          i
                                       
                                    
                                 
                               with 
                                 
                                    
                                       
                                          
                                             
                                                d
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          MIN
                                       
                                       
                                          i
                                       
                                    
                                 
                               in the right-hand side of inequalities (32).□

Although the bounds given by inequalities (34) are no stronger than (32), the advantage of using inequalities (34) is for simplicity in computation. Since the right-hand sides of inequalities (34) are determined once the parameters of the problem are given, they can thus be readily added into the master problem at the beginning of the algorithm and no further modifications are needed throughout the whole solution process. This is in contrast to the use of lower bound inequality (32), which requires continuous modifications to the right hand side from iteration to iteration.

The lower bound inequalities (29) and (34) can be added into the two-stage stochastic programming problem formulation for the MFRSPSD without changing the optimal value of the model. More importantly, note that no second stage decision variables exist in these inequalities, thus it enables us to transmit some more specific information from the second stage into the first stage without introducing more decision variables.

The optimality cuts can be constructed specifically with respect to each scenario and each time period, which we call as disaggregated optimality cuts (DOCs). Different from the C-LS method, the optimal simplex multipliers are obtained by solving each sub-problem RP (t,
                        ξ) separately. The fundamental mechanism of constructing the DOCs is similar as how optimality cuts are generated in the C-LS method. The newly developed DOCs (37) are presented together with the modified master problem (RMP-1) as follows.
                           
                              (36)
                              
                                 [
                                 RMP-
                                 1
                                 ]
                                 
                                 
                                    min
                                 
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          m
                                       
                                    
                                 
                                 
                                    
                                       fy
                                    
                                    
                                       m
                                    
                                 
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          m
                                       
                                    
                                 
                                 α
                                 
                                    
                                       x
                                    
                                    
                                       jm
                                    
                                    
                                       t
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          ξ
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                       
                                    
                                 
                                 ρ
                                 (
                                 ξ
                                 )
                                 
                                    
                                       θ
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 ξ
                                 )
                              
                           
                        
                        
                           
                              (37)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                             
                                             
                                             s
                                             .
                                             t
                                             .
                                             
                                             Constraints
                                             
                                             
                                                (1), (4), (29) and (34)
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             
                                             
                                             
                                             
                                                
                                                   θ
                                                
                                                
                                                   t
                                                
                                             
                                             (
                                             ξ
                                             )
                                             +
                                             C
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      j
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      m
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   jmt
                                                
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         t
                                                         ξ
                                                      
                                                   
                                                
                                             
                                             (
                                             ξ
                                             )
                                             
                                                
                                                   x
                                                
                                                
                                                   jm
                                                
                                                
                                                   t
                                                
                                             
                                             ⩾
                                             
                                                
                                                   b
                                                
                                                
                                                   t
                                                
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         t
                                                         ξ
                                                      
                                                   
                                                
                                             
                                             (
                                             ξ
                                             )
                                             ,
                                             
                                             ∀
                                             ξ
                                             ,
                                             t
                                             
                                             and
                                             
                                             ∀
                                             
                                                
                                                   s
                                                
                                                
                                                   t
                                                   ξ
                                                
                                             
                                             ∈
                                             
                                                
                                                   S
                                                
                                                
                                                   t
                                                   ξ
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (38)
                              
                                 
                                 
                                 
                                 
                                 
                                    
                                       b
                                    
                                    
                                       t
                                    
                                    
                                       
                                          
                                             s
                                          
                                          
                                             t
                                             ξ
                                          
                                       
                                    
                                 
                                 (
                                 ξ
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    
                                       W
                                    
                                    
                                       i
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 ξ
                                 )
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                t
                                             
                                             
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      t
                                                      ξ
                                                   
                                                
                                             
                                          
                                          (
                                          ξ
                                          )
                                          -
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                it
                                             
                                             
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      t
                                                      ξ
                                                   
                                                
                                             
                                          
                                          (
                                          ξ
                                          )
                                       
                                    
                                 
                                 ,
                                 
                                 ∀
                                 
                                    
                                       s
                                    
                                    
                                       t
                                       ξ
                                    
                                 
                                 ∈
                                 
                                    
                                       S
                                    
                                    
                                       t
                                       ξ
                                    
                                 
                              
                           
                        
                     

The objective function (36) is equivalent to (19) as 
                           
                              θ
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    ξ
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    t
                                 
                              
                              ρ
                              (
                              ξ
                              )
                              
                                 
                                    θ
                                 
                                 
                                    t
                                 
                              
                              (
                              ξ
                              )
                           
                        . We use S
                        
                           tξ
                         to represent the optimality cut set with respect to each t and ξ, indexed by s
                        
                           tξ
                        . Denote 
                           
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    it
                                 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          t
                                          ξ
                                       
                                    
                                 
                              
                              (
                              ξ
                              )
                           
                        , 
                           
                              
                                 
                                    
                                       
                                          r
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    jmt
                                 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          t
                                          ξ
                                       
                                    
                                 
                              
                              (
                              ξ
                              )
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          q
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    t
                                 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          t
                                          ξ
                                       
                                    
                                 
                              
                              (
                              ξ
                              )
                           
                         as the optimal simplex multipliers associated with constraints (24)–(26) for the optimality cut s
                        
                           tξ
                        . The optimality cuts (37) are similarly constructed as the C-LS method. Constraints (38) present the right hand side value for the optimality cut (37).

Since the DOCs are more specifically generated, more or at least equally detailed information is transmitted from the second stage into the master problem compared with the C-LS and M-LS method. This may particularly improve the effect of lower bound and improve the convergence of the algorithm as a whole.

Preliminary tests using the C-LS and M-LS method revealed that the convergence speed slows down “exponentially” with the number of iterations. As an example, an instance with 10 customer points, 20 time periods and 100 scenarios is solved using the C-LS and M-LS methods. Since the trends for both methods are rather similar, we simply illustrate the gap values from iteration to iteration for the M-LS method in Fig. 3
                        . It shows that the algorithm converges quickly at the initial stage and is able to reach a small gap within a relatively short time, but after that it takes much longer time to reach the optimality. However, in practice, rather than spending great efforts on finding the optimal solution, it is more useful that we obtain a feasible solution in a reasonable time by knowing how far it is from optimality, i.e. an ∊-optimal solution, where ∊ is the gap between the best upper bound and the lower bound. In Fig. 3, we illustrate the computation time spent before and after the ∊-optimality achieved as regions A and B respectively. This tolerance gap can be applied to either the overall algorithm or the computation of the RMP of each iteration which we denote as ∊
                        RMP. The main purpose is to reduce the computational efforts spent after the ∊-optimality is achieved (i.e. region B in Fig. 3).

As the L-shaped method adds the optimality cuts iteration by iteration, the RMP does not contain much information from the second stage sub-problems in early iterations. Thus it is not necessary to spend too much time on solving the RMPs for early iterations. We can accomplish that by setting a relatively large optimality gap for the RMPs in initial iterations and then gradually decrease the gap in successive iterations. Denote the optimality gap of the RMP for the current iteration ν as 
                           
                              
                                 
                                    ∊
                                 
                                 
                                    RMP
                                 
                                 
                                    ν
                                 
                              
                           
                         and the gap between the upper bound and the lower bound of the algorithm obtained so far as Gap
                           ν−1.
                           Proposition 4
                           
                              
                                 
                                    (39)
                                    
                                       
                                          
                                             ∊
                                          
                                          
                                             RMP
                                          
                                          
                                             ν
                                          
                                       
                                       ⩽
                                       
                                          
                                             Gap
                                          
                                          
                                             ν
                                             -
                                             1
                                          
                                       
                                       .
                                    
                                 
                              
                           

Note that the best lower bound value of the RMP in the current iteration ν should be equal to or larger than the lower bound obtained in the algorithm so far, i.e. 
                                 
                                    
                                       
                                          LB
                                       
                                       
                                          RMP
                                       
                                       
                                          ν
                                       
                                    
                                    ⩾
                                    
                                       
                                          LB
                                       
                                       
                                          ν
                                          -
                                          1
                                       
                                    
                                 
                              . Meanwhile, the upper bound solution of the algorithm UB
                              
                                 ν−1 is also a feasible solution for the current RMP. It follows that the best upper bound value of the current RMP should be smaller than or equal to 
                                 
                                    
                                       
                                          UB
                                       
                                       
                                          RMP
                                       
                                       
                                          ν
                                       
                                    
                                    ⩽
                                    
                                       
                                          UB
                                       
                                       
                                          ν
                                          -
                                          1
                                       
                                    
                                 
                              . Hence 
                                 
                                    (
                                    
                                       
                                          UB
                                       
                                       
                                          RMP
                                       
                                       
                                          ν
                                       
                                    
                                    -
                                    
                                       
                                          LB
                                       
                                       
                                          RMP
                                       
                                       
                                          ν
                                       
                                    
                                    )
                                    ⩽
                                    (
                                    
                                       
                                          UB
                                       
                                       
                                          ν
                                          -
                                          1
                                       
                                    
                                    -
                                    
                                       
                                          LB
                                       
                                       
                                          ν
                                          -
                                          1
                                       
                                    
                                    )
                                 
                               or 
                                 
                                    
                                       
                                          ∊
                                       
                                       
                                          RMP
                                       
                                       
                                          ν
                                       
                                    
                                    ⩽
                                    
                                       
                                          Gap
                                       
                                       
                                          ν
                                          -
                                          1
                                       
                                    
                                 
                              .□

As 
                                 
                                    
                                       
                                          UB
                                       
                                       
                                          RMP
                                       
                                       
                                          ν
                                       
                                    
                                    ⩽
                                    
                                       
                                          UB
                                       
                                       
                                          ν
                                          -
                                          1
                                       
                                    
                                 
                              , it requires finding a new feasible solution in the current RMP which is different from the upper bound solution of the algorithm, and the objective function value of the RMP for this new feasible solution must be smaller than or equal to UB
                              
                                 ν−1.

In this section, we present the procedure of the E-LS method in detail. The iteration count is indexed by ν and the number of optimality cuts is denoted as 
                           
                              
                                 
                                    s
                                 
                                 
                                    k
                                 
                                 
                                    t
                                 
                              
                           
                         for each t and k. 
                           
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    ν
                                 
                              
                           
                         is the first stage feasible solution vector for decision variable 
                           
                              
                                 
                                    x
                                 
                                 
                                    jm
                                 
                                 
                                    t
                                 
                              
                           
                        . Denote the LB
                        
                           ν
                         as best lower bound value in iteration ν and UB
                        
                           ν
                         as best upper bound as well. RMP
                           ν
                         stands for the RMP-1 in iteration ν. We present the procedure of the E-LS method as follows:
                           
                              
                                 
                                    Step 0:
                                 
                              
                              (
                                    Initialization
                                 )
                                    
                                       Set 
                                             
                                                ν
                                                =
                                                k
                                                =
                                                0
                                                ,
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      k
                                                   
                                                   
                                                      t
                                                   
                                                
                                                =
                                                0
                                             
                                           for ∀t
                                          ∈
                                          T and ∀k
                                          ∈
                                          Ξ.

Set LB
                                          0
                                          =−∞, UB
                                          0
                                          =+∞

(
                                    Solve the master problem
                                 )
                                    
                                       Set ν
                                          =
                                          ν
                                          +1, solve the RMP
                                             ν
                                           to 
                                             
                                                
                                                   
                                                      ∊
                                                   
                                                   
                                                      RMP
                                                   
                                                   
                                                      ν
                                                   
                                                
                                             
                                          -optimality. Denote the best feasible solution by 
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                   
                                                      ν
                                                   
                                                
                                                ,
                                                
                                                   
                                                      
                                                         
                                                            θ
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                   
                                                      kt
                                                   
                                                   
                                                      ν
                                                   
                                                
                                                )
                                             
                                          . If 
                                             
                                                
                                                   
                                                      LB
                                                   
                                                   
                                                      RMP
                                                   
                                                   
                                                      ν
                                                   
                                                
                                                ⩾
                                                
                                                   
                                                      LB
                                                   
                                                   
                                                      ν
                                                      -
                                                      1
                                                   
                                                
                                             
                                          , set 
                                             
                                                
                                                   
                                                      LB
                                                   
                                                   
                                                      ν
                                                   
                                                
                                                =
                                                
                                                   
                                                      LB
                                                   
                                                   
                                                      RMP
                                                   
                                                   
                                                      ν
                                                   
                                                
                                             
                                          ; otherwise, LB
                                          
                                             ν
                                          
                                          =
                                          LB
                                          
                                             ν−1. If no optimality cut (41) is included in the RMP
                                             ν
                                          , i.e. 
                                             
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      k
                                                   
                                                   
                                                      t
                                                   
                                                
                                                =
                                                0
                                             
                                          , set 
                                             
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      k
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                           to be +∞.
                                             
                                                (40)
                                                
                                                   [
                                                   
                                                      
                                                         RMP
                                                      
                                                      
                                                         ν
                                                      
                                                   
                                                   ]
                                                   
                                                   
                                                      min
                                                   
                                                   
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         fy
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                   
                                                   α
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         jm
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ρ
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         k
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                (41)
                                                
                                                   
                                                      
                                                         
                                                         
                                                            
                                                               
                                                               
                                                               
                                                               s
                                                               .
                                                               t
                                                               .
                                                               
                                                               Constraints
                                                               
                                                               
                                                                  (1), (4), (29) and (34)
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                         
                                                            
                                                               
                                                               
                                                               
                                                               
                                                               
                                                                  
                                                                     θ
                                                                  
                                                                  
                                                                     k
                                                                  
                                                                  
                                                                     t
                                                                  
                                                               
                                                               ⩽
                                                               
                                                                  
                                                                     e
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           r
                                                                        
                                                                        
                                                                           k
                                                                        
                                                                        
                                                                           t
                                                                        
                                                                     
                                                                  
                                                               
                                                               -
                                                               
                                                                  
                                                                     E
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           r
                                                                        
                                                                        
                                                                           k
                                                                        
                                                                        
                                                                           t
                                                                        
                                                                     
                                                                  
                                                               
                                                               x
                                                               ,
                                                               
                                                               
                                                                  
                                                                     r
                                                                  
                                                                  
                                                                     k
                                                                  
                                                                  
                                                                     t
                                                                  
                                                               
                                                               =
                                                               1
                                                               ,
                                                               …
                                                               ,
                                                               
                                                                  
                                                                     s
                                                                  
                                                                  
                                                                     k
                                                                  
                                                                  
                                                                     t
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       


                                 
                                    (Optimality checking)
                                 
                                 
                                    
                                       For ∀k
                                          ∈
                                          Ξ, and ∀t
                                          ∈
                                          T, solve RP(t,
                                          ξ) for each t and each ξ. Denote the best objective function value of the current incumbent solution by 
                                             
                                                
                                                   
                                                      UB
                                                   
                                                   
                                                      RMP
                                                   
                                                   
                                                      ν
                                                   
                                                
                                             
                                          . Define
                                             
                                                (42)
                                                
                                                   
                                                      
                                                         E
                                                      
                                                      
                                                         
                                                            
                                                               s
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         +
                                                         1
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   =
                                                   C
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           r
                                                                        
                                                                        
                                                                           ¯
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     kt
                                                                  
                                                                  
                                                                     ν
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                (43)
                                                
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         
                                                            
                                                               s
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         +
                                                         1
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           q
                                                                        
                                                                        
                                                                           ¯
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     kt
                                                                  
                                                                  
                                                                     ν
                                                                  
                                                               
                                                               -
                                                               
                                                                  
                                                                     
                                                                        
                                                                           u
                                                                        
                                                                        
                                                                           ¯
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     kt
                                                                  
                                                                  
                                                                     ν
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         ξ
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       

Then compute the value 
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      kt
                                                   
                                                   
                                                      ν
                                                   
                                                
                                                =
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      +
                                                      1
                                                   
                                                   
                                                      t
                                                   
                                                
                                                -
                                                
                                                   
                                                      E
                                                   
                                                   
                                                      
                                                         
                                                            s
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      +
                                                      1
                                                   
                                                   
                                                      t
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                   
                                                      ν
                                                   
                                                
                                             
                                          .
                                             
                                                •
                                                If any sub-problem is unbounded, then the original MFRSPSD is unbounded. The procedure stops.

Otherwise all sub-problems are bounded. If 
                                                      
                                                         
                                                            
                                                               UB
                                                            
                                                            
                                                               RMP
                                                            
                                                            
                                                               ν
                                                            
                                                         
                                                         ⩽
                                                         
                                                            
                                                               UB
                                                            
                                                            
                                                               ν
                                                               -
                                                               1
                                                            
                                                         
                                                      
                                                   , set 
                                                      
                                                         
                                                            
                                                               UB
                                                            
                                                            
                                                               ν
                                                            
                                                         
                                                         =
                                                         
                                                            
                                                               UB
                                                            
                                                            
                                                               RMP
                                                            
                                                            
                                                               ν
                                                            
                                                         
                                                      
                                                   ; Otherwise, UB
                                                   
                                                      ν
                                                   
                                                   =
                                                   UB
                                                   
                                                      ν−1.
                                                      
                                                         –
                                                         If 
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              θ
                                                                           
                                                                           
                                                                              ¯
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        kt
                                                                     
                                                                     
                                                                        ν
                                                                     
                                                                  
                                                                  ⩾
                                                                  
                                                                     
                                                                        ϕ
                                                                     
                                                                     
                                                                        kt
                                                                     
                                                                     
                                                                        ν
                                                                     
                                                                  
                                                               
                                                             for all k and t, or if UB
                                                            
                                                               ν
                                                            
                                                            −
                                                            LB
                                                            
                                                               ν
                                                            
                                                            ⩽
                                                            ∊, stop and 
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              x
                                                                           
                                                                           
                                                                              ¯
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        ν
                                                                     
                                                                  
                                                               
                                                             is the optimal solution and UB
                                                            
                                                               ν
                                                             is the optimal objective function value;

Otherwise, if 
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              θ
                                                                           
                                                                           
                                                                              ¯
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        kt
                                                                     
                                                                     
                                                                        ν
                                                                     
                                                                  
                                                                  <
                                                                  
                                                                     
                                                                        ϕ
                                                                     
                                                                     
                                                                        kt
                                                                     
                                                                     
                                                                        ν
                                                                     
                                                                  
                                                               
                                                             for any k and t, set 
                                                               
                                                                  
                                                                     
                                                                        s
                                                                     
                                                                     
                                                                        k
                                                                     
                                                                     
                                                                        t
                                                                     
                                                                  
                                                                  =
                                                                  
                                                                     
                                                                        s
                                                                     
                                                                     
                                                                        k
                                                                     
                                                                     
                                                                        t
                                                                     
                                                                  
                                                                  +
                                                                  1
                                                               
                                                             and add the generated optimality cuts to the constraint set (41). Then return to step 1.

The primary objectives of this computational study are to quantify the benefits of the proposed enhancement and gain insight into: (1) how the algorithm E-LS performs comparing with the C-LS and M-LS method, (2) how the lower bound inequalities (29) and (34) affect the convergence of the proposed algorithm, and (3) the value of incorporating stochasticity in the model. The algorithm is coded in JAVA, and run on a 2.6gigahertz CPU with 16gigabytes RAM. The CPLEX 12.4 optimization package has been applied as the mixed-integer linear programming solver to compute the master and recourse problems.

For each test instance, a total of ∣I∣ vertices are generated as uniformly distributed random numbers on a 100 by 100 plane. We assume that each candidate location is also a customer point. The relationship between the number of customer points ∣I∣ and the number of candidate locations ∣J∣ is ∣J∣=⌊η∣I∣⌋, 
                           
                              η
                              ∈
                              (
                              0
                              ,
                              1
                              ]
                           
                        . Here, we set η to be 0.5 for all the following computational experiments.

The customers’ demand of each scenario and each time period is generated both independently and randomly with the lognormal distribution, which ensures the non-negativity property of demand. Kamath and Pakkala (2002) showed that the lognormal distribution is suitable for modeling stochastic demands in the economic context. The mean values of stochastic demand of customer i in period t over all scenarios, 
                           
                              E
                              
                                 
                                    
                                       
                                          
                                             W
                                          
                                          
                                             i
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                              
                           
                        , are randomly generated from a uniform distribution 
                           
                              U
                              [
                              W
                              ,
                              
                                 
                                    W
                                 
                                 
                                    ‾
                                 
                              
                              ]
                           
                        , where 
                           
                              0
                              ⩽
                              W
                              ⩽
                              
                                 
                                    W
                                 
                                 
                                    ‾
                                 
                              
                           
                        . In the following experiments, we set W to be 20 and 
                           
                              
                                 
                                    W
                                 
                                 
                                    ‾
                                 
                              
                           
                         to be 60. The standard deviation, 
                           
                              
                                 
                                    Var
                                    
                                       
                                          
                                             
                                                
                                                   W
                                                
                                                
                                                   i
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                         is obtained as a product of mean value 
                           
                              E
                              
                                 
                                    
                                       
                                          
                                             W
                                          
                                          
                                             i
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                              
                           
                         and coefficient λ, 
                           
                              
                                 
                                    Var
                                    
                                       
                                          
                                             
                                                
                                                   W
                                                
                                                
                                                   i
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              =
                              λ
                              E
                              
                                 
                                    
                                       
                                          
                                             W
                                          
                                          
                                             i
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                              
                           
                        . The lognormal distribution is determined by location parameters μ and scale parameter σ. These two parameters can be computed using formulas (44) and (45) below if the expected value 
                           
                              E
                              
                                 
                                    
                                       
                                          
                                             W
                                          
                                          
                                             i
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                              
                           
                         and variance 
                           
                              Var
                              
                                 
                                    
                                       
                                          
                                             W
                                          
                                          
                                             i
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                              
                           
                         are known.
                           
                              (44)
                              
                                 μ
                                 =
                                 ln
                                 
                                    
                                       
                                          E
                                          
                                             
                                                
                                                   
                                                      
                                                         W
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 -
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       σ
                                    
                                    
                                       2
                                    
                                 
                                 .
                              
                           
                        
                        
                           
                              (45)
                              
                                 
                                    
                                       σ
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 ln
                                 
                                    
                                       
                                          1
                                          +
                                          
                                             
                                                Var
                                                
                                                   
                                                      
                                                         
                                                            
                                                               W
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      (
                                                      E
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     W
                                                                  
                                                                  
                                                                     i
                                                                  
                                                                  
                                                                     t
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

We also assume that the total capacity of all candidate MFs should at least fulfill the maximum of expected value of demands of all customers over the planning horizon, i.e. 
                           
                              
                                 
                                    D
                                 
                                 
                                    max
                                 
                              
                              =
                              
                                 
                                    max
                                 
                                 
                                    t
                                    ∈
                                    |
                                    T
                                    |
                                 
                              
                              
                                 
                                    E
                                 
                                 
                                    ξ
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ∈
                                             I
                                          
                                       
                                       
                                          
                                             W
                                          
                                          
                                             i
                                          
                                          
                                             t
                                          
                                       
                                       (
                                       ξ
                                       )
                                    
                                 
                              
                           
                        . Thus, the cardinality of the set for MFs is determined by 
                           
                              |
                              M
                              |
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   D
                                                
                                                
                                                   max
                                                
                                             
                                          
                                          
                                             C
                                          
                                       
                                    
                                 
                              
                           
                        .

The cost parameters are all assumed to be calculated in terms of present monetary value. The fixed operation cost f is generated from a uniform distribution U[a,
                        b] where 0⩽
                        a
                        ⩽
                        b. The traveling inconvenience cost factor α is set to be 0.0001a. The assignment cost factor per unit distance per unit demand β is randomly generated from a uniform distribution U [0.0001a,0.0001b]. The penalty cost per unit demand γ is randomly generated from a uniform distribution U[0.01a,0.01b]. We set a
                        =1000 and b
                        =1500 in the experiments.

The number of customers considered here is not large. However, if we consider it in conjunction with the number of time periods, the problem size can grow very quickly. Consider test case 18 as an example. We have 15×20=300 customers, or 300 candidate sites for locating facilities. This is not a small problem even if the problem is treated as a static facility location problem. Nevertheless, for practical considerations, this type of model is only useful at a tactical level for generating a plan for the future planning horizon. In reality, parameters for the future planning horizon are subject to various degrees of uncertainty. With this consideration, we set the 3000 CPU seconds as our stopping criteria to generate some optimal or near optimal solutions.

We evaluate the performance of the E-LS method by generating test cases characterized by the value of the number of customer points (∣I∣∈{5,10,15}), the value of the number of time periods (∣T∣∈{10,20}), and the value of the number of scenarios (∣K∣∈{50,100,200}). Thus, with the values given, a total of 18 test cases can be generated. For example, we can have a particular test case with (∣I∣,∣T∣,∣K∣)=(10,10,100). The summary of these test cases is shown in Table 1a
                        . For each test case, 10 instances are randomly generated and the average is obtained to measure the performance of the algorithm. In all cases, the capacity parameter is set to 100 and the value of the variance λ
                        =2. The optimal gap ∊ is set to be 0%, 1% and 2% with respect to instances with 5, 10 and 15 customer points. During the first 5 iterations, we solve the RMP with early stopping gap of 10% and 5% for the next 5 iterations. After the first 10 iterations, the early stopping gap of the subsequent iteration is computed by multiplying the previous stopping gap by a factor 0.8 until it reaches the optimal gap ∊. Based on Proposition 4, the early stopping gap cannot be larger than the gap between the upper bound and lower bound values of the previous iteration.

In Table 1a, we show a comparison of computation time, iteration number and the final gap value of test instances by using the C-LS, M-LS and E-LS methods. The first column is the number of all data sets. The three columns under the parameter category display the values of (∣I∣,∣T∣,∣K∣). The rest of Table 1a is divided into three categories: the computational results using the C-LS and M-LS methods and the proposed E-LS method. The computation time, number of iterations and the relative gap are displayed for comparison for all test cases, showing the resulting average (A), largest (L) and smallest (S) values.

From Table 1a, we observe that the computation time of the C-LS method, M-LS method and E-LS method all tend to increase with the growth in the number of customers, time periods, and scenarios as expected. However, the E-LS method consistently yields better results in solving the MFRSPSD than those from the two other methods. For the E-LS method, in the cases where the product of the number of customers and time periods is under 100, the CPU time is on the average less than 1min. In the cases where the product is between 100 and 200, the average computation time is less than 5min when the number of scenarios is close to 100 and 10minutes when the number of scenarios is close to 200. If the product is over 200, the method can reach less than 2% gap in less than 30min for 100 scenarios, and reach less than 5% gap in about 30minutes for a case with 200 scenarios.

The percentage decrease in computation time, number of iterations and optimality gap value with the E-LS method compared with the C-LS and M-LS methods is summarized in Table 1b
                        . The percentage values are calculated using the average results from Table 1a. The E-LS method outperforms the classic and multicut version L-shaped method for all test cases in term of computation time and solution quality. The resulting improvement can be attributed to the better bounding effect resulting from the inclusion of more cuts. These cuts have greatly decreased the number of iterations required to converge to the ∊-optimality.

In Figs. 4 and 5
                        
                        , we take an example with 10 customer points, 10 time periods and 100 scenarios to illustrate the detail of the convergence process. Fig. 4 shows the gap values of each iteration and Fig. 5 presents the computation time spent in each iteration for the three methods. From Fig. 4, we observe that the E-LS method converges to optimality in just 8 iterations whereas the C-LS method fails to converge within 20% gap after 16 iterations. Though the M-LS method performs better than the C-LS method in this instance, it still cannot compete with the E-LS method. As shown in Fig. 5, the computation time of the E-LS method for solving the RMP in each iteration is relatively longer than the C-LS and M-LS method, since it involves more optimality cuts than the other two methods. However, as the number of iterations increases, the computation times of the C-LS and M-LS methods for solving the RMP increases significantly, while the E-LS method has already reached the optimality (in iteration 8 in this case). Therefore, the overall computation time is significantly reduced for the E-LS method, since the improved bounding effect with the E-LS method leads to a much smaller number of iterations, and in general the E-LS method converges much faster than the C-LS and M-LS method.

To test further the importance of lower bound inequalities (29) and (34), we applied the E-LS method to some test cases as shown in Table 2
                         with and without the lower bound inequalities to compare the performance of the algorithm in terms of the gap values and the lower bound values during the process of convergence. The results are displayed in Table 2. We observe that by including the lower bound inequalities, the computation time and the number of iterations can be reduced substantially when the algorithm reaches the identical gap values. Consider one of the test instances with 10 customer points, 10 time periods and 100 scenarios as an example. Fig. 6
                        (a) and (b) show the comparisons of the gap values and lower bound values over the entire process before and after the inequalities are added. It is easy to see that the algorithm converges much faster when the lower bound inequalities (29) and (34) are introduced into the master problem. The difference between the two is quite large especially in the first few iterations.

To test the effect of the scale of the scenario set on computation time and solution quality, we conduct a series of experiments by changing the number of scenarios while keeping the other parameters unchanged. That means all scenarios are sampled from the same probability distribution for the demands. The experiments are conducted by using the case with 10 customers and 20 time periods. First we solve the MFRSPSD with different number of scenarios to optimality, and then evaluate all of the first stage solutions over the same 500 scenarios to compare the total costs. The results are presented in Table 3
                        , in which the first column shows the number of scenarios used, the second and third columns are the computation time and iteration number to solve the problem and the last column presents the total costs obtained by evaluating the first stage solutions using the same 500 scenarios.

From Table 3, we can see that as the number of scenarios grows, the computation time increases quite rapidly. For cases with more than 300 scenarios, the proposed algorithm needs more than 2000seconds and for the case with 500 scenarios it needs more than 3000seconds to solve, showing the scale of the scenario set indeed has a great influence over the efficiency of the proposed algorithm. The total costs shown in the fourth column, obtained by evaluating the solutions over the common uncertainty set with 500 scenarios, appear to decrease as expected, since a larger scenario set usually yields a closer approximation of the 500 scenarios. However, the improvement over the solution quality is not that significant with a larger scenario set. For example, the total cost of the solution obtained by solving the case with 500 scenarios improves by only 5.5% compared with the case with 50 scenarios, yet the computation time is almost 10 times larger. These results demonstrate that the scenario set does not have to be very large to provide a reasonably good approximation of the original uncertainty set. Therefore, we are able to produce a solution with good quality within an acceptable amount of computation time.

To examine the value of incorporating stochasticity in the model, we conduct a simple analysis to assess the value of the stochastic solution (VSS), in which the cost of ignoring uncertainty in the decision making process is quantified. Solve the deterministic program by letting 
                           
                              
                                 
                                    ξ
                                 
                                 
                                    ¯
                                 
                              
                              =
                              E
                              (
                              ξ
                              )
                           
                         be the expected value of ξ. Then the expected value problem of the MFRSPSD is 
                           
                              EV
                              =
                              
                                 
                                    min
                                 
                                 
                                    x
                                 
                              
                              z
                              (
                              x
                              ,
                              
                                 
                                    ξ
                                 
                                 
                                    ¯
                                 
                              
                              )
                           
                        , where z(·) is the objective function value of the MFRSP. Denote the optimal solution of EV as 
                           
                              
                                 
                                    x
                                 
                                 
                                    ¯
                                 
                              
                              (
                              
                                 
                                    ξ
                                 
                                 
                                    ¯
                                 
                              
                              )
                           
                        . We use this solution as the first stage decision and then solve the second stage sub-problems for all scenarios. The total expected costs for the MFRSPSD using the EV solution is 
                           
                              EEV
                              =
                              
                                 
                                    E
                                 
                                 
                                    ξ
                                 
                              
                              [
                              z
                              (
                              
                                 
                                    x
                                 
                                 
                                    ¯
                                 
                              
                              (
                              
                                 
                                    ξ
                                 
                                 
                                    ¯
                                 
                              
                              )
                              ,
                              ξ
                              )
                              ]
                           
                        . After obtaining these two values, we can compute the value of the stochastic solution as VSS=EEV−RP, where the RP denotes the here-and-now solution corresponding to the two-stage recourse problem, i.e. RP=min
                           x
                        
                        E
                        
                           ξ
                        
                        z(x,
                        ξ). The value of stochastic solution is the indicator value of ignoring uncertainty in choosing a decision.

Results of several tests conducted to obtain the values of the EEV and the RP are listed in Table 4
                        . As we can see from the last two columns of the table, the decrease in the total expected costs is quite significant by solving a model formulated as a stochastic programming program compared with solving a deterministic model with expected value of demand as input. Furthermore, the advantage of applying the stochastic programming model in dealing with the MFRSPSD becomes more pronounced when the variance of uncertain demand is high.

@&#CONCLUSIONS@&#

In this paper, we discuss the MFRSP with stochastic demand by explicitly handling the uncertainty using a discrete number of scenarios. A mixed-integer and two-stage stochastic programming model of the MFSPSD is presented in which the first stage is to make a tactical decision for a fleet of MFs in a prespecified planning horizon. The goal of the model is to minimize the total expected system-wide cost of both two stages. Instead of simply obtaining a feasible solution by applying heuristics or meta-heuristics, we develop an exact algorithm so that we are able to get a solution which we know how good it is in an acceptable computation time. This is significantly important in determining the tactical level plan which cannot be changed too often to ensure a smooth daily operation. Based on the special structure of the MFRSPSD, we design a multicut L-shaped based method with additional problem specific valid inequalities and cuts, called the E-LS method, to obtain the solution with both upper bound and lower bound information. Lower bound inequalities are developed and integrated into the model to tighten the quality of lower bound. Through computational experiments, the algorithm proves to be both effective and efficient in solving the MFRSPSD with 15 customers, 20 time periods and 200 scenarios. If we account for the scale of the problem in the sense of static facility location problem, there are 15×20=300 customers considered in the computational experiments, which are sufficiently large for practical applications. The computational results show the lower bound inequalities are quite effective in tightening the lower bound which leads to significant reduction in both number of iterations and computation time.

For future research, we can consider more general cases in which some assumptions made in this paper can be relaxed. For example, the travel time can be treated as time-dependent and uncertain, which is a reasonable assumption for applications in urban areas. Moreover, by relaxing the homogeneity assumption of the MFs, we can treat the capacity of each MF as unknown, and thus make it into a decision variable in the model. Further improvement in both upper bounds and lower bounds can be explored. For the upper bounds, we plan to develop an efficient heuristic method to obtain a good feasible solution; for the lower bound, we will try to generate more problem specific optimality cuts to improve the quality of lower bounds by exploring the special structure of the problem.

@&#ACKNOWLEDGEMENTS@&#

This research is supported by National Natural Science Foundation of China (Grant No. 71272030). The support is gratefully acknowledged. The comments from two anonymous referees are greatly appreciated.

@&#REFERENCES@&#

