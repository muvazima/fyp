@&#MAIN-TITLE@&#Statistical adaptive metric learning in visual action feature set recognition

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A statistical adaptive metric learning (SAML) is proposed to classify action features.


                        
                        
                           
                           SAML explores multiple statistic combinations for feature sets in different scales.


                        
                        
                           
                           Discriminative statistic subspace is learned by a unified metric learning framework.


                        
                        
                           
                           High competitive performances are achieved by SAML on five benchmark databases.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Feature set classification

Hybrid statistic modeling

Metric learning

Manifold selection

@&#ABSTRACT@&#


               Graphical abstract
               
                  
                     
                        
                           
                        
                     
                  
               
            

@&#INTRODUCTION@&#

Set classification has been studied within computer vision communities for a long period of time. In gait recognition, for example, frame by frame static features of a certain object are considered as a feature set. Similarly in human action recognition, Spatial–Temporal features uniformly extracted from frames of an action atom are considered as a feature set [1]. In addition, image sets have been commonly used in face recognitions [2,3]. The task of feature set classification is to classify an input feature set to one of the sets in the training gallery [4]. Compared to image sets, feature sets are more diverse. They cannot be easily assumed to follow certain distribution or lie in some scale and affine invariant linear subspace. One of the effective techniques handling such problem is by using statistical representations to substitute the original feature samples. For action recognition in the wild scenarios, combinations of statistics from lower-order to higher-order have shown promising representation capabilities, while how to combine these multiple statistics in a near optimal way remains a technical challenge [4,5].

In general, three types of statistics have been commonly applied on set modeling, i.e. sample-based statistics (SAS) [6-9], subspace-based statistics (SUS) [10-16] and distribution-based statistics (DIS) [2,3]. Utilizing affine transformation and centroid of samples, sample-based statistics represent d-dimension feature sets with first-order statistics in the R
                     
                        d
                      space. A great advantage of SAS is that samples are considered as vectors so the nearest neighbor (NN) classification can be easily implemented with unified distance measures. But sample tests performed at every individual sample are often computationally expensive. Well-known sample-based methods include Minimum Mean Discrepancy (MMD) [17], Affine (Convex) Hull based Image Set Distance (AHISD, CHISD) [18], Set-to-Set Distance Metric Learning (SSDML) [9] and Information Theoretic Metric Learning (ITML) [19]. Differing from sample-based statistics, subspace-based statistics analyze sets lying on a specific Riemannian manifold. By learning the kernel functions or statistical metrics, the subspaces are projected back to the Euclidean spaces. The distance measures from the Riemannian manifold to the Euclidean space is often considered as the true geodesic distances, which lie in a Hilbert space [20]. Distance discriminant functions are then performed on the Hilbert space, and recognitions can finally be achieved by using Nearest Neighbors (NNs) method. Second-order statistic based methods have better representation of the data, but it is hard to design a discriminant function with a unified distance measure for the manifolds. Typical subspace-based methods include Mutual Subspace Method (MSM) [11], Discriminant Canonical Correlations (DCC) [10], Manifold Discriminant Analysis (MDA) [14], Grassmann Discriminant analysis (GDA) [13], Covariance Discriminative Learning (CDL) [15], Localized Multi-Kernel Metric Learning (LMKML) [16] etc. Distribution based statistic model each sample in the feature set with a distribution, which can be expressed as an expansion of the Riemannian manifold from the 2nd-order statistic space 
                        S
                        y
                        
                           
                              m
                           
                           
                              d
                           
                           
                              +
                           
                        
                      to 
                        S
                        y
                        
                           
                              m
                           
                           
                              d
                              +
                              1
                           
                           
                              +
                           
                        
                     . Such methods are often with 3rd-order statistics and may lead to complex parametric distribution comparison. Typical examples include Single Gaussian Models (SGM) [2], Gaussian Mixture Models (GMM) [3] and kernel version of ITML with DIS-based set model (DIS-ITML). Although 3rd-order statistics model sets with more consolidated representations, the hypothesis tests often require significant amount of computation in distribution comparisons.

More adaptive forms of set modeling methods have been proposed by combining multiple statistical metrics in certain heuristic ways. Some of the recent hybrid statistical models include Projection Metric Learning (PML) on Grassmann manifold and hybrid Euclidean-and-Riemannian Metric Learning (HERML) [21]. The main idea of multiple statistic combination is to project measurements from multiple heterogeneous spaces into high-dimensional Hilbert spaces. The key issue then becomes the learning of unified discriminant functions from the training sets. Due to the simplicity of the subspace mapping, discriminant functions can frequently be found from single statistics. For instance, Set-to-Set Distance Metric Learning (SSDML) learns a proper metric between pairs of single vectors in Euclidean space to obtain more accurate set-to-set affine hull based distance for classification; Localized Multi-Kernel Metric Learning (LMKML) maps the 3rd-order statistics into Euclidean spaces by learning a unified metric discriminant function through reproducing kernel Hilbert spaces (RKHS). While hybrid multiple statistics perform well in realistic outdoor scenarios, their unified discriminant functions are often more difficult to design. Addressing the subspace discrimination problems, Shao et al. proposed a kernelized multiview projection (KMP) for action feature set recognition. KMP discriminatively assigns weights to multiple kernelized sets with a single feature to achieve a low-dimensional subspace. However, weighting kernels directly in the linear subspaces is not an optimal way for learning kernelized sets with multiple features in different scales [22].

Aiming at classification for sets with multiple features, this paper proposes an adaptive subspace analysis method for learning hybrid statistical metrics. The analyzed single or multiple statistics can be used to classify sets through various feature combinations in different scales. Inspired by the discriminant function design in the second-order based methods, LogDet divergence is introduced as a unified discriminant function for our metric learning. With this discriminant function, our method effectively unifies different statistics into a common measurement. Thus nearest neighbor method can be easily performed for classification. The whole process of modeling and learning consists of several steps. Firstly, heterogeneous statistics including mean, covariance matrix and Gaussian distribution are introduced to project data into high-dimensional Hilbert spaces. Typically, d-dimensional mean vectors represent samples from R
                     
                        d
                      to 
                        S
                        y
                        
                           
                              m
                           
                           
                              d
                           
                           
                              +
                           
                        
                      expanded by a Point-to-Set projection; covariance matrices lie in Riemannian manifold 
                        S
                        y
                        
                           
                              m
                           
                           
                              d
                           
                           
                              +
                           
                        
                      and multivariate Gaussian distributions expand the second order statistics into Riemannian manifold 
                        S
                        y
                        
                           
                              m
                           
                           
                              d
                              +
                              1
                           
                           
                              +
                           
                        
                      expressed by relative entropy. Secondly, by embedding the heterogeneous spaces into high-dimensional Hilbert spaces, the Mahalanobis distance is introduced as our discriminant metric. Then, the Hilbert space selection is conducted based on the minimum Hilbert subspaces. The hybrid statistics are then reduced to single or multiple statistic combination. Finally, with LogDet divergence that maps all the Hilbert space points into R
                     
                        d
                     , a constrained kernel learning is performed. Recognitions are mainly conducted on video sequences in both static and dynamic scenarios using spatial image features such as edges, SIFT, HOG, and texture features.

Let X
                           =[X
                           1,…,X
                           
                              N
                           ] denotes the training set formed by N feature sets, where 
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                              
                              =
                              [
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    x
                                 
                                 
                                    M
                                 
                              
                              ]
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          i
                                       
                                    
                                    ×
                                    d
                                 
                              
                            indicates the i-th feature set, 1 ≤ i ≤ N, and n
                           
                              i
                            is the number of samples in this set. It is known that the kernel function is always defined by firstly mapping the original features to a high dimensional Hilbert space, that is ϕ : R
                           
                              d
                            → F or Sym
                           
                              + → F, and then calculating the dot product of high dimensional statistics Φ
                           
                              i
                            and Φ
                           
                              j
                            in the new space. Considering ϕ as an explicit mapping with the statistical kernels, 
                              
                                 
                                    Φ
                                 
                                 
                                    i
                                 
                                 
                                    r
                                 
                              
                            denotes the high dimensional feature of r-th statistics extracted from the feature set X
                           
                              i
                           . Here, 1 < r < R and R is the number of statistics being used.

We uniformly map feature set X
                           
                              i
                           ,1 ≤ i ≤ N with following three statistics: sample-based, subspace-based and distribution-based statistics.

Sample-based statistics (SAS): Supported by Bregman divergence, mean vector is considered as one of the important properties describing the probability distributions. It is often used to measure the central tendency of set of samples. Given sample x
                           
                              k
                            ∈ X
                           
                              i
                           , 1 ≤ k ≤ M, the mean vector μ
                           
                              i
                            of X
                           
                              i
                            is computed as: 
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    M
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    k
                                    =
                                    1
                                 
                                 
                                    M
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    k
                                 
                              
                           .

Subspace-based statistics (SUS): Within subspaces derived from eigen-decomposition, set variances are influenced by covariant matrix. Given sample x
                           
                              k
                            ∈ X
                           
                              i
                           , 1 ≤ k ≤ M, the covariant matrix C
                           
                              i
                            of X
                           
                              i
                            is computed as: 
                              
                                 
                                    C
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    M
                                    −
                                    1
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    k
                                    =
                                    1
                                 
                                 
                                    M
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    k
                                 
                              
                              −
                              
                                 
                                    μ
                                 
                                 
                                    i
                                 
                              
                              )
                              
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          k
                                       
                                    
                                    −
                                    
                                       
                                          μ
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 
                                    T
                                 
                              
                           .

Distribution-based statistics (DIS): Gaussian distribution is a very commonly occurring probability distribution, which is a continuous distribution with the maximum entropy for a given mean and variance. Therefore, the d-dimensional distribution of set X
                           
                              i
                            is modeled as a Single Gaussian Model (SGM) with an estimated d-dimensional mean vector 
                              
                                 
                                    
                                       
                                          m
                                       
                                       ^
                                    
                                 
                                 
                                    k
                                    ,
                                    i
                                 
                              
                              ,
                              1
                              ≤
                              k
                              ≤
                              d
                            and a covariance matrix 
                              
                                 
                                    Ĉ
                                 
                                 
                                    i
                                 
                              
                           : 
                              x
                              ∼
                              N
                              
                                 
                                    
                                       
                                          
                                             
                                                m
                                             
                                             ^
                                          
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          Ĉ
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           .

A point μ in the Euclidean space R
                           
                              d
                            can be mapped into a symmetrical positive definite matrix 
                              
                                 
                                    μ
                                    
                                       
                                          μ
                                       
                                       
                                          T
                                       
                                    
                                    |
                                    
                                       
                                          R
                                       
                                       
                                          d
                                          ×
                                          d
                                       
                                    
                                    ,
                                    |
                                    μ
                                    
                                       
                                          μ
                                       
                                       
                                          T
                                       
                                    
                                    |
                                    >
                                    0
                                 
                              
                              ∈
                              S
                              y
                              
                                 
                                    m
                                 
                                 
                                    d
                                 
                                 
                                    +
                                 
                              
                           . For DIS, the space of Gaussian distribution is able to be embedded into a Riemannian manifold 
                              S
                              y
                              
                                 
                                    m
                                 
                                 
                                    d
                                    +
                                    1
                                 
                                 
                                    +
                                 
                              
                           
                           [20].


                           
                              Theorem 1
                              
                                 Let G
                                    ={γ|dx|,x∈R
                                    
                                       d
                                    } be a space of normal distribution, where |dx| is Lebesgue measure. Then its positive definite affine space
                                 
                                    A
                                    f
                                    
                                       
                                          f
                                       
                                       
                                          d
                                       
                                       
                                          +
                                       
                                    
                                 
                                 has an explicit embedding
                                 
                                    A
                                    f
                                    
                                       
                                          f
                                       
                                       
                                          d
                                       
                                       
                                          +
                                       
                                    
                                    →
                                    S
                                    y
                                    
                                       
                                          m
                                       
                                       
                                          d
                                          +
                                          1
                                       
                                       
                                          +
                                       
                                    
                                 
                                 lying on the Riemannian symmetric space Sl
                                    
                                       d
                                       +1/SO
                                    
                                       d
                                       +1 .
                              


                           
                              Proof
                              Denote an affine group of G in R
                                 
                                    d
                                 : Aff
                                 
                                    d
                                 
                                 ={(m,Q)|x → Qx
                                 +
                                 m,Q ∈ G
                                 
                                    d
                                 ,m ∈ R
                                 
                                    d
                                 } acts transitively on G by γ|dx|→ (m,Q) ⊗ γ|dx|, where ⊗ denotes the transitive operator.

Assume 
                                    
                                       
                                          γ
                                       
                                       
                                          0
                                       
                                    
                                    |
                                    d
                                    x
                                    |
                                    =
                                    
                                       
                                          (
                                          2
                                          π
                                          )
                                       
                                       
                                          −
                                          d
                                          /
                                          2
                                       
                                    
                                    
                                       
                                          e
                                       
                                       
                                          −
                                          
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          |
                                          x
                                          
                                             
                                                |
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    |
                                    d
                                    x
                                    |
                                  as an standard Gaussian distribution on R
                                 
                                    d
                                 , where π
                                 
                                    −1(γ
                                 0|dx|)=
                                 O
                                 
                                    d
                                  is a positive measure. The transitive operation (m,Q) ⊗ γ|dx| can be explicitly written as
                                    
                                       (1)
                                       
                                          (
                                          m
                                          ,
                                          Q
                                          )
                                          ⊗
                                          γ
                                          |
                                          d
                                          x
                                          |
                                          =
                                          
                                             
                                                (
                                                2
                                                π
                                                )
                                             
                                             
                                                −
                                                d
                                                /
                                                2
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   d
                                                   e
                                                   t
                                                
                                                Q
                                                )
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                e
                                             
                                             
                                                −
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      2
                                                   
                                                
                                                |
                                                
                                                   
                                                      Q
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                (
                                                x
                                                −
                                                m
                                                )
                                                
                                                   
                                                      |
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          |
                                          d
                                          x
                                          |
                                       
                                    
                                 only when detQ > 0. Therefore, we add a restriction θ to keep affine group positive definite 
                                    θ
                                    :
                                    A
                                    f
                                    
                                       
                                          f
                                       
                                       
                                          d
                                       
                                       
                                          +
                                       
                                    
                                    =
                                    
                                       
                                          (
                                          m
                                          ,
                                          Q
                                          )
                                          |
                                          
                                             d
                                             e
                                             t
                                          
                                          Q
                                          >
                                          0
                                       
                                    
                                 . Since the restriction is also transitive on G, where 
                                    
                                       
                                          G
                                       
                                       
                                          d
                                       
                                    
                                    =
                                    A
                                    f
                                    
                                       
                                          f
                                       
                                       
                                          d
                                       
                                       
                                          +
                                       
                                    
                                    /
                                    S
                                    
                                       
                                          O
                                       
                                       
                                          d
                                       
                                    
                                 . Considering Aff
                                 
                                    d
                                  as a subgroup of a larger simple Lie group SL
                                 
                                    d
                                    +1
                                 ={V|V∈R
                                 
                                    d
                                    +1}, where Aff
                                 
                                    d
                                  ⊂ Sl
                                 
                                    d
                                    +1, (m,Q) can be embedded as 
                                    
                                       (2)
                                       
                                          A
                                          f
                                          
                                             
                                                f
                                             
                                             
                                                d
                                             
                                          
                                          →
                                          S
                                          
                                             
                                                l
                                             
                                             
                                                d
                                                +
                                                1
                                             
                                          
                                          ,
                                          (
                                          m
                                          ,
                                          Q
                                          )
                                          →
                                          V
                                          ,
                                          (
                                          m
                                          ,
                                          Q
                                          )
                                          →
                                          
                                             
                                                (
                                                
                                                   d
                                                   e
                                                   t
                                                
                                                Q
                                                )
                                             
                                             
                                                −
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      d
                                                      +
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         Q
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              

Since the simple Lie group Sl
                                 
                                    d
                                    +1 acts canonically on all symmetric definite positive matrices 
                                    S
                                    y
                                    
                                       
                                          m
                                       
                                       
                                          d
                                          +
                                          1
                                       
                                       
                                          +
                                       
                                    
                                  with determinant 1. In order to meet the restriction θ of the subgroup Aff
                                 
                                    d
                                 , the simple Lie group Sl
                                 
                                    d
                                    +1 is mapped to a symmetric definite positive space 
                                    
                                       
                                          θ
                                       
                                       ˜
                                    
                                    :
                                    S
                                    y
                                    
                                       
                                          m
                                       
                                       
                                          d
                                          +
                                          1
                                       
                                       
                                          +
                                       
                                    
                                    =
                                    
                                       V
                                       
                                          
                                             V
                                          
                                          
                                             T
                                          
                                       
                                       |
                                       V
                                       
                                          
                                             V
                                          
                                          
                                             T
                                          
                                       
                                       ∈
                                       
                                          
                                             R
                                          
                                          
                                             (
                                             d
                                             +
                                             1
                                             )
                                             ×
                                             (
                                             d
                                             +
                                             1
                                             )
                                          
                                       
                                       ,
                                       |
                                       V
                                       
                                          
                                             V
                                          
                                          
                                             T
                                          
                                       
                                       |
                                       >
                                       0
                                    
                                 , where 
                                    
                                       (3)
                                       
                                          S
                                          
                                             
                                                l
                                             
                                             
                                                d
                                                +
                                                1
                                             
                                          
                                          →
                                          S
                                          y
                                          
                                             
                                                m
                                             
                                             
                                                d
                                                +
                                                1
                                             
                                             
                                                +
                                             
                                          
                                          ,
                                          V
                                          →
                                          V
                                          
                                             
                                                V
                                             
                                             
                                                T
                                             
                                          
                                          ,
                                          (
                                          m
                                          ,
                                          Q
                                          )
                                          →
                                          
                                             
                                                (
                                                
                                                   d
                                                   e
                                                   t
                                                
                                                Q
                                                )
                                             
                                             
                                                −
                                                
                                                   
                                                      2
                                                   
                                                   
                                                      d
                                                      +
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         Q
                                                         
                                                            
                                                               Q
                                                            
                                                            
                                                               T
                                                            
                                                         
                                                         +
                                                         m
                                                         
                                                            
                                                               m
                                                            
                                                            
                                                               T
                                                            
                                                         
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               m
                                                            
                                                            
                                                               T
                                                            
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          .
                                          
                                       
                                    
                                 
                              

Then the transitive action of the restriction for the simple Lie group Sl
                                 
                                    d
                                    +1: G
                                 
                                    d
                                    +1
                                 =
                                 Sl
                                 
                                    d
                                    +1/SO
                                 
                                    d
                                    +1 lies on the Riemannian symmetric space with SO
                                 
                                    d
                                    +1 -principle bundle 
                                    
                                       
                                          θ
                                       
                                       ˜
                                    
                                    :
                                    S
                                    
                                       
                                          l
                                       
                                       
                                          d
                                          +
                                          1
                                       
                                    
                                    →
                                    S
                                    y
                                    
                                       
                                          m
                                       
                                       
                                          d
                                          +
                                          1
                                       
                                       
                                          +
                                       
                                    
                                    ,
                                    V
                                    →
                                    V
                                    
                                       
                                          V
                                       
                                       
                                          T
                                       
                                    
                                 
                              

Hence, Theorem 1 is proved.□

In DIS, 
                              Q
                              
                                 
                                    Q
                                 
                                 
                                    T
                                 
                              
                              =
                              
                                 
                                    C
                                 
                                 ^
                              
                            Therefore, after embedding, we have 3 statistical representations: 
                              
                                 (4)
                                 
                                    
                                       
                                          Φ
                                       
                                       
                                          S
                                          A
                                          S
                                       
                                    
                                    =
                                    
                                       
                                          μ
                                          
                                             
                                                μ
                                             
                                             
                                                T
                                             
                                          
                                          |
                                          μ
                                          
                                             
                                                μ
                                             
                                             
                                                T
                                             
                                          
                                          ∈
                                          
                                             
                                                R
                                             
                                             
                                                d
                                                ×
                                                d
                                             
                                          
                                          ,
                                          |
                                          μ
                                          
                                             
                                                μ
                                             
                                             
                                                T
                                             
                                          
                                          |
                                          >
                                          0
                                       
                                    
                                 
                              
                           
                           
                              
                                 (5)
                                 
                                    
                                       
                                          Φ
                                       
                                       
                                          S
                                          U
                                          S
                                       
                                    
                                    =
                                    
                                       
                                          C
                                          |
                                          C
                                          ∈
                                          
                                             
                                                R
                                             
                                             
                                                d
                                                ×
                                                d
                                             
                                          
                                          ,
                                          |
                                          C
                                          |
                                          >
                                          0
                                       
                                    
                                 
                              
                           
                           
                              
                                 (6)
                                 
                                    
                                       
                                          Φ
                                       
                                       
                                          D
                                          I
                                          S
                                       
                                    
                                    =
                                    
                                       
                                          V
                                          
                                             
                                                V
                                             
                                             
                                                T
                                             
                                          
                                          |
                                          V
                                          
                                             
                                                V
                                             
                                             
                                                T
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               C
                                                            
                                                            ^
                                                         
                                                         +
                                                         
                                                            
                                                               m
                                                            
                                                            ^
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     m
                                                                  
                                                                  ^
                                                               
                                                            
                                                            
                                                               T
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               m
                                                            
                                                            ^
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     m
                                                                  
                                                                  ^
                                                               
                                                            
                                                            
                                                               T
                                                            
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          ,
                                          V
                                          
                                             
                                                V
                                             
                                             
                                                T
                                             
                                          
                                          ∈
                                          
                                             
                                                R
                                             
                                             
                                                (
                                                d
                                                +
                                                1
                                                )
                                                ×
                                                (
                                                d
                                                +
                                                1
                                                )
                                             
                                          
                                          ,
                                          |
                                          V
                                          
                                             
                                                V
                                             
                                             
                                                T
                                             
                                          
                                          |
                                          >
                                          0
                                       
                                    
                                 
                              
                           where 
                              
                                 
                                    Φ
                                 
                                 
                                    S
                                    A
                                    S
                                 
                              
                              ∈
                              S
                              y
                              
                                 
                                    m
                                 
                                 
                                    d
                                 
                                 
                                    +
                                 
                              
                              ,
                              
                                 
                                    Φ
                                 
                                 
                                    S
                                    U
                                    S
                                 
                              
                              ∈
                              S
                              y
                              
                                 
                                    m
                                 
                                 
                                    d
                                 
                                 
                                    +
                                 
                              
                              ,
                              
                                 
                                    Φ
                                 
                                 
                                    D
                                    I
                                    S
                                 
                              
                              ∈
                              S
                              y
                              
                                 
                                    m
                                 
                                 
                                    d
                                    +
                                    1
                                 
                                 
                                    +
                                 
                              
                           . The SPD matrices lie in a specific Riemannian manifold, where tangent vector of Sym
                           
                              + is often utilized as a projection to R
                           
                              d
                           . For the three different embedded statistics and all their possible combinations, we examine logarithm Hilbert subspace through an eigen-decomposition: log(
                              Φ
                           )=
                           U(log(
                              Λ
                           ))U
                           
                              T
                            where 
                              Φ
                           
                           ={Φ
                           
                              SAS
                           ,Φ
                           
                              SUS
                           ,Φ
                           
                              DIS
                           ,Φ
                           
                              SAS
                           
                           Φ
                           
                              SUS
                           ,Φ
                           
                              SAS
                           
                           Φ
                           
                              DIS
                           ,Φ
                           
                              SUS
                           
                           Φ
                           
                              DIS
                           ,Φ
                           
                              SAS
                           
                           Φ
                           
                              SUS
                           ,Φ
                           
                              DIS
                           } indicates the set of all possible statistic combinations; 
                              Λ
                           
                           ={Λ
                           
                              SAS
                           ,Λ
                           
                              SUS
                           ,Λ
                           
                              DIS
                           ,Λ
                           
                              SAS
                           
                           Λ
                           
                              SUS
                           ,Λ
                           
                              SAS
                           
                           Λ
                           
                              DIS
                           ,Λ
                           
                              SUS
                           
                           Λ
                           
                              DIS
                           ,Λ
                           
                              SAS
                           
                           Λ
                           
                              SUS
                           
                           Λ
                           
                              DIS
                           } indicates the set of all the possible eigen-value matrices of 
                              Φ
                           , respectively; U is the decomposed projection matrices. Set 
                              Φ
                            describes eigen-spaces 
                              Λ
                            of all the possible statistic combinations. The last element utilizes all the statistics, while the first three have only single statistic. The logarithmic eigen-values measures the tangent subspaces of the symmetric positive definite Riemannian manifold. In the mutual subspace method (MSM) and Discriminant Canonical Correlations (DCC) method the diagonal eigen-matrix is also known as canonical correlations [10,23].

In our work, subspace with minimum deviation of the canonical correlations is selected from set Φ. The canonical correlation is computed as: cosΘ
                           =
                           diag(log 
                              Λ
                           ). Subspaces are selected by min {var(cosΘ)}, where var(⋅) calculates the deviation and diag(⋅) denotes the diagonal matrix.

After the subspace embedding and selection, N labeled training set X
                        ={X
                        1,…,X
                        
                           N
                        } becomes R
                        ×
                        N labeled statistical points 
                           Φ
                           =
                           
                           {
                           
                              
                                 Φ
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 Φ
                              
                              
                                 R
                              
                           
                           }
                           =
                           
                           
                              
                                 
                                    
                                       
                                          
                                             Φ
                                          
                                          
                                             1
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             Φ
                                          
                                          
                                             N
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       
                                          
                                             Φ
                                          
                                          
                                             1
                                          
                                          
                                             R
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             Φ
                                          
                                          
                                             N
                                          
                                          
                                             R
                                          
                                       
                                    
                                 
                              
                           
                         lying on Sym
                        
                           + Riemannian manifolds, where R is the number of selected statistics and N is the number of sets for training.

In the Lie group structure, the Log-Euclidean distance (LED) for X
                        
                           i
                        ,X
                        
                           j
                         ∈ Sym
                        
                           + is defined as LED (X
                        
                           i
                        ,X
                        
                           j
                        ,t)=exp((1−
                        t)log(X
                        
                           i
                        )+
                        tlog(X
                        
                           j
                        )) where exp(⋅) and log(⋅) are matrix exponential and logarithm operator. Assume two Riemaninan points for r-th statistic 
                           
                              
                                 Φ
                              
                              
                                 i
                              
                              
                                 r
                              
                           
                           ,
                           
                              
                                 Φ
                              
                              
                                 j
                              
                              
                                 r
                              
                           
                         has two linear discriminative mapping 
                           
                              
                                 Y
                              
                              
                                 i
                              
                              
                                 r
                              
                           
                           ,
                           
                              
                                 Y
                              
                              
                                 j
                              
                              
                                 r
                              
                           
                         on the domain of matrix logarithms where 
                           log
                           
                              
                                 
                                    Φ
                                 
                                 
                                    i
                                 
                                 
                                    r
                                 
                              
                           
                           
                              
                                 Y
                              
                              
                                 i
                              
                              
                                 r
                              
                           
                           ⊥
                           log
                           
                              
                                 
                                    Φ
                                 
                                 
                                    j
                                 
                                 
                                    r
                                 
                              
                           
                           
                              
                                 Y
                              
                              
                                 j
                              
                              
                                 r
                              
                           
                        , the geodesic distance between 
                           log
                           
                              
                                 
                                    Φ
                                 
                                 
                                    i
                                 
                                 
                                    r
                                 
                              
                           
                         and 
                           log
                           
                              
                                 
                                    Φ
                                 
                                 
                                    j
                                 
                                 
                                    r
                                 
                              
                           
                         after mapping is then computed by Euclidean distance in the domain of matrix logarithms: 
                           
                              (7)
                              
                                 
                                    
                                       
                                          d
                                          
                                             
                                                
                                                   
                                                      Φ
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      r
                                                   
                                                
                                                ,
                                                
                                                   
                                                      Φ
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      r
                                                   
                                                
                                             
                                          
                                       
                                       
                                          =
                                          ∥
                                          log
                                          
                                             
                                                
                                                   
                                                      Φ
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      r
                                                   
                                                
                                             
                                          
                                          
                                             
                                                Y
                                             
                                             
                                                i
                                             
                                             
                                                r
                                             
                                          
                                          −
                                          log
                                          
                                             
                                                
                                                   
                                                      Φ
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      r
                                                   
                                                
                                             
                                          
                                          
                                             
                                                Y
                                             
                                             
                                                j
                                             
                                             
                                                r
                                             
                                          
                                          
                                             
                                                ∥
                                             
                                             
                                                F
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                          t
                                          r
                                          
                                             
                                                
                                                   
                                                      log
                                                      
                                                         
                                                            
                                                               
                                                                  Φ
                                                               
                                                               
                                                                  i
                                                               
                                                               
                                                                  r
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            Y
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                      −
                                                      log
                                                      
                                                         
                                                            
                                                               
                                                                  Φ
                                                               
                                                               
                                                                  j
                                                               
                                                               
                                                                  r
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            Y
                                                         
                                                         
                                                            j
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            log
                                                            
                                                               
                                                                  
                                                                     
                                                                        Φ
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                     
                                                                        r
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  Y
                                                               
                                                               
                                                                  i
                                                               
                                                               
                                                                  r
                                                               
                                                            
                                                            −
                                                            log
                                                            
                                                               
                                                                  
                                                                     
                                                                        Φ
                                                                     
                                                                     
                                                                        j
                                                                     
                                                                     
                                                                        r
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  Y
                                                               
                                                               
                                                                  j
                                                               
                                                               
                                                                  r
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      T
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where ∥⋅∥
                           F
                         is the matrix Frobenius norm and tr(⋅) is the matrix trace. Fig. 1
                         shows the mapped subspaces graphically for a cannot-link (i,j) statistic pair. As Fig. 1 shows, θ
                        =
                        ∠u′Ov′ is the principle angle. The Riemannian distance actually measures the principle angle ||θ||2. If the two points are similar, the distance 
                           d
                           
                              
                                 
                                    Φ
                                 
                                 
                                    i
                                 
                                 
                                    r
                                 
                              
                              ,
                              
                                 
                                    Φ
                                 
                                 
                                    j
                                 
                                 
                                    r
                                 
                              
                           
                           =
                           1
                        . If they are dissimilar, distance 
                           d
                           
                              
                                 
                                    Φ
                                 
                                 
                                    i
                                 
                                 
                                    r
                                 
                              
                              ,
                              
                                 
                                    Φ
                                 
                                 
                                    j
                                 
                                 
                                    r
                                 
                              
                           
                           =
                           −
                           1
                        . The relationship holds only when the assumed linear mapping Y
                        
                           i
                         and Y
                        
                           j
                         are equally orthonormal where 
                           Y
                           =
                           
                              
                                 Y
                              
                              
                                 i
                              
                              
                                 r
                              
                           
                           =
                           
                              
                                 Y
                              
                              
                                 j
                              
                              
                                 r
                              
                           
                         and 
                           
                              
                                 Y
                              
                              
                                 i
                              
                              
                                 r
                              
                           
                           
                              
                                 Y
                              
                              
                                 j
                              
                              
                                 r
                              
                           
                           =
                           
                              
                                 I
                              
                              
                                 d
                              
                           
                        , I
                        
                           d
                         is a d
                        ×
                        d identity matrix.

Given a scale invariant positive definite matrix 
                           
                              
                                 A
                              
                              
                                 r
                              
                           
                           =
                           
                              
                                 Y
                              
                              
                                 i
                              
                              
                                 r
                              
                           
                           
                              
                                 Y
                              
                              
                                 j
                              
                              
                                 r
                              
                           
                        . It can be approximated with an identity matrix A
                        0
                        =
                        I
                        
                           d
                         with the distance measurement 
                           
                              
                                 d
                              
                              
                                 
                                    
                                       A
                                    
                                    
                                       r
                                    
                                 
                              
                           
                           
                              
                                 
                                    Φ
                                 
                                 
                                    i
                                 
                                 
                                    r
                                 
                              
                              ,
                              
                                 
                                    Φ
                                 
                                 
                                    j
                                 
                                 
                                    r
                                 
                              
                           
                         constrained by the must-link and cannot-link training pairs 
                           
                              
                                 
                                    Φ
                                 
                                 
                                    i
                                 
                                 
                                    r
                                 
                              
                              ,
                              
                                 
                                    Φ
                                 
                                 
                                    j
                                 
                                 
                                    r
                                 
                              
                           
                         for the r-th statistics. 
                           
                              (8)
                              
                                 
                                    
                                       d
                                    
                                    
                                       
                                          
                                             A
                                          
                                          
                                             r
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             Φ
                                          
                                          
                                             i
                                          
                                          
                                             r
                                          
                                       
                                       ,
                                       
                                          
                                             Φ
                                          
                                          
                                             j
                                          
                                          
                                             r
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       δ
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 t
                                 r
                                 
                                    
                                       
                                          
                                             A
                                          
                                          
                                             r
                                          
                                       
                                       
                                          
                                             log
                                             
                                                
                                                   
                                                      
                                                         Φ
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                
                                             
                                             −
                                             log
                                             
                                                
                                                   
                                                      
                                                         Φ
                                                      
                                                      
                                                         j
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   log
                                                   
                                                      
                                                         
                                                            
                                                               Φ
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               r
                                                            
                                                         
                                                      
                                                   
                                                   −
                                                   log
                                                   
                                                      
                                                         
                                                            
                                                               Φ
                                                            
                                                            
                                                               j
                                                            
                                                            
                                                               r
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             T
                                          
                                       
                                    
                                 
                              
                           
                        As a distance discriminant function, 
                           
                              
                                 d
                              
                              
                                 
                                    
                                       A
                                    
                                    
                                       r
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       Φ
                                    
                                    
                                       i
                                    
                                    
                                       r
                                    
                                 
                                 ,
                                 
                                    
                                       Φ
                                    
                                    
                                       j
                                    
                                    
                                       r
                                    
                                 
                              
                           
                         shows outstanding scale invariant properties ranging from [−1,1]. δ
                        
                           ij
                         is an indicator function for (i,j) pairs. If (i,j) is must-link, δ
                        
                           ij
                        
                        =1; if (i,j) cannot-link δ
                        
                           ij
                        
                        =−1. A
                        
                           r
                         is a Mahalanobis-like distance metric approximated with an identity matrix. After the approximation of A
                        
                           r
                        , the classification can be simply completed by nearest neighbor (NN) method using 
                           
                              
                                 d
                              
                              
                                 
                                    
                                       A
                                    
                                    
                                       r
                                    
                                 
                              
                           
                         as its distance discriminant function.

As discussed in Section 2.2, the learning problem is to approximate R Mahalanobis-like metrics A
                        ={A
                        1,…,A
                        
                           R
                        } with identity matrix A
                        0 for R selected statistics. Two properties must be kept during the matrix approximation: First, A
                        
                           r
                        ,r ∈ [1,R] must be scale invariant; second, A
                        
                           r
                         can be factorized as two linear mapping A
                        
                           r
                        
                        =
                        Y
                        
                           i
                        
                        Y
                        
                           j
                        . Accordingly, Log-Determinant divergence is introduced as our measurement for the positive definite matrix approximation. Log-Determinant divergence is a typical measurement for positive definite matrix nearness problem proved in [24], which has also been proved to be convex and scale-invariant in [25]. The optimization problem is considered as seeking R discriminant metrics to describe the statistical characteristics of the N
                        ×
                        R selected statistical feature sets. Finally, our metric learning problem is expressed as


                        
                           
                              (9)
                              
                                 
                                    
                                       
                                          
                                             
                                                min
                                             
                                             
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ≤
                                                0
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      r
                                                   
                                                
                                                ≤
                                                0
                                                ,
                                                ϵ
                                             
                                          
                                          
                                             
                                                1
                                             
                                             
                                                R
                                             
                                          
                                          
                                             
                                                ∑
                                             
                                             
                                                r
                                                =
                                                1
                                             
                                             
                                                R
                                             
                                          
                                          
                                             
                                                D
                                             
                                             
                                                l
                                                d
                                             
                                          
                                          (
                                          
                                             
                                                A
                                             
                                             
                                                r
                                             
                                          
                                          ,
                                          
                                             
                                                A
                                             
                                             
                                                0
                                             
                                          
                                          )
                                          +
                                          γ
                                          
                                             
                                                D
                                             
                                             
                                                l
                                                d
                                             
                                          
                                          (
                                          d
                                          i
                                          a
                                          g
                                          (
                                          ϵ
                                          )
                                          ,
                                          d
                                          i
                                          a
                                          g
                                          (
                                          
                                             
                                                ϵ
                                             
                                             
                                                0
                                             
                                          
                                          )
                                          )
                                       
                                    
                                    
                                       
                                          s
                                          .
                                          t
                                          .
                                          
                                          
                                             
                                                
                                                   
                                                      δ
                                                   
                                                   
                                                      i
                                                      j
                                                   
                                                
                                             
                                             
                                                R
                                             
                                          
                                          
                                             
                                                ∑
                                             
                                             
                                                r
                                                =
                                                1
                                             
                                             
                                                R
                                             
                                          
                                          
                                             
                                                d
                                             
                                             
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      r
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      Φ
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      r
                                                   
                                                
                                                ,
                                                
                                                   
                                                      Φ
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      r
                                                   
                                                
                                             
                                          
                                          ≤
                                          
                                             
                                                ϵ
                                             
                                             
                                                i
                                                j
                                             
                                          
                                          ∀
                                          (
                                          i
                                          ,
                                          j
                                          )
                                       
                                    
                                 
                              
                           
                        
                     


                        δ
                        
                           ij
                         denotes the similarity between i-th and j-th kernel. If they are similar, δ
                        
                           ij
                        
                        =1, otherwise δ
                        
                           ij
                        
                        =−1. D
                        
                           ld
                        (A
                        
                           r
                        ,A
                        0) is the LogDet divergence measuring the correlation between matrix A
                        
                           r
                         and A
                        0 where 
                           
                              
                                 D
                              
                              
                                 l
                                 d
                              
                           
                           (
                           
                              
                                 A
                              
                              
                                 r
                              
                           
                           ,
                           
                              
                                 A
                              
                              
                                 0
                              
                           
                           )
                           =
                           t
                           r
                           
                              
                                 
                                    A
                                 
                                 
                                    r
                                 
                              
                              ,
                              
                                 
                                    A
                                 
                                 
                                    0
                                 
                                 
                                    −
                                    1
                                 
                              
                           
                           −
                           log
                           
                              d
                              e
                              t
                           
                           
                              
                                 
                                    A
                                 
                                 
                                    r
                                 
                              
                              ,
                              
                                 
                                    A
                                 
                                 
                                    0
                                 
                                 
                                    −
                                    1
                                 
                              
                           
                           −
                           d
                        . d is the dimension of A. ϵ
                        
                           ij
                         denotes the boundaries of similarity and dissimilarity, which is introduced as an upper/lower bound for the i-th and j-th sample covariance [26]. While the covariance between different classes may not always be the same, a trade-off is the self-deviation between ϵ and optimal slack ϵ
                        0, which is supposed to be of unit at principle space. Thus, in order to control such a self-deviation, a second term is introduced as the trade-off correction term, where γ ≥ 0 is a parameter arbitrarily set before the computation. In Eq. (9), the first term of the minimization corresponds to the maximum of inter-class and the second term corresponds to the minimum of intra-class.


                        Fig. 2
                         gives a graphic illustration explaining the streamline of our methods. Firstly, various feature sets are mapped into their statistic subspaces; secondly, by constructing the multiple statistic combinations, some combination is selected based-on its canonical correlation. Then, Riemannian distance is used as a discriminant function measuring the different statistics in the selected combination separately in the heterogeneous Hilbert space. Finally, all the statistics are measured in the Euclidean space through Mahalanobis-like identity matrix approximation with Log-Determinant divergence.

The form of Eq. (9) can be considered as Bregman optimizations for R selected statistics [25,27]. With Bregman projection, Eq. (9) has the following Lagrange form: 
                        
                           (10)
                           
                              
                                 
                                    
                                       
                                          
                                             ∇
                                             
                                                
                                                   D
                                                
                                                
                                                   l
                                                   d
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         r
                                                      
                                                      
                                                         t
                                                         +
                                                         1
                                                      
                                                   
                                                
                                             
                                             =
                                             ∇
                                             
                                                
                                                   D
                                                
                                                
                                                   l
                                                   d
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         r
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                             +
                                             
                                                
                                                   δ
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             α
                                             
                                                log
                                                
                                                   
                                                      
                                                         Φ
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                
                                                −
                                                log
                                                
                                                   
                                                      
                                                         Φ
                                                      
                                                      
                                                         j
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      log
                                                      
                                                         
                                                            
                                                               Φ
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               r
                                                            
                                                         
                                                      
                                                      −
                                                      log
                                                      
                                                         
                                                            
                                                               Φ
                                                            
                                                            
                                                               j
                                                            
                                                            
                                                               r
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   T
                                                
                                             
                                          
                                       
                                       
                                          
                                             ∇
                                             
                                                
                                                   D
                                                
                                                
                                                   l
                                                   d
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         ϵ
                                                      
                                                      
                                                         i
                                                         j
                                                      
                                                      
                                                         t
                                                         +
                                                         1
                                                      
                                                   
                                                
                                             
                                             =
                                             ∇
                                             
                                                
                                                   D
                                                
                                                
                                                   l
                                                   d
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         ϵ
                                                      
                                                      
                                                         i
                                                         j
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                             −
                                             
                                                
                                                   δ
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             α
                                             /
                                             γ
                                          
                                       
                                    
                                 
                              
                           
                        
                     where α is the Lagrange multiplier. The first and the second equation are the Bregman projection with respect to the minimizers A
                     1,…,A
                     
                        R
                      and ϵ, respectively. Minimizer A
                     
                        r
                     (r
                     =1,…,R) and ϵ are then iteratively updated by solving Eq. (10)
                     
                        
                           (11)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   r
                                                
                                                
                                                   t
                                                   +
                                                   1
                                                
                                             
                                             =
                                             
                                                
                                                   A
                                                
                                                
                                                   r
                                                
                                                
                                                   t
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      
                                                         δ
                                                      
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                   α
                                                
                                                
                                                   1
                                                   −
                                                   
                                                      
                                                         δ
                                                      
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                   α
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               r
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               Φ
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               r
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               Φ
                                                            
                                                            
                                                               j
                                                            
                                                            
                                                               r
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   A
                                                
                                                
                                                   r
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                log
                                                
                                                   
                                                      
                                                         Φ
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                
                                                −
                                                log
                                                
                                                   
                                                      
                                                         Φ
                                                      
                                                      
                                                         j
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      log
                                                      
                                                         
                                                            
                                                               Φ
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               r
                                                            
                                                         
                                                      
                                                      −
                                                      log
                                                      
                                                         
                                                            
                                                               Φ
                                                            
                                                            
                                                               j
                                                            
                                                            
                                                               r
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   T
                                                
                                             
                                             
                                                
                                                   A
                                                
                                                
                                                   r
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ϵ
                                                
                                                
                                                   i
                                                   j
                                                
                                                
                                                   t
                                                   +
                                                   1
                                                
                                             
                                             =
                                             γ
                                             
                                                
                                                   ϵ
                                                
                                                
                                                   i
                                                   j
                                                
                                                
                                                   t
                                                
                                             
                                             /
                                             
                                                γ
                                                +
                                                α
                                                
                                                   
                                                      ϵ
                                                   
                                                   
                                                      i
                                                      j
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

Solution to Eq. (10) is provided in Appendix A. For solving the Lagrange multiplier, multiple inequality constrains of Eq. (9) have to be satisfied 
                        
                           
                              
                                 
                                    δ
                                 
                                 
                                    i
                                    j
                                 
                              
                           
                           
                              R
                           
                        
                        
                           
                              ∑
                           
                           
                              r
                              =
                              1
                           
                           
                              R
                           
                        
                        t
                        r
                        (
                        
                           
                              A
                           
                           
                              r
                           
                        
                        (
                        l
                        o
                        g
                        (
                        
                           
                              Φ
                           
                           
                              i
                           
                           
                              r
                           
                        
                        )
                        −
                        l
                        o
                        g
                        (
                        
                           
                              Φ
                           
                           
                              j
                           
                           
                              r
                           
                        
                        )
                        )
                        
                           
                              (
                              l
                              o
                              g
                              (
                              
                                 
                                    Φ
                                 
                                 
                                    i
                                 
                                 
                                    r
                                 
                              
                              )
                              −
                              l
                              o
                              g
                              (
                              
                                 
                                    Φ
                                 
                                 
                                    j
                                 
                                 
                                    r
                                 
                              
                              )
                              )
                           
                           
                              T
                           
                        
                        )
                        ≤
                        
                           
                              ϵ
                           
                           
                              i
                              j
                           
                        
                      for all (i,j). Thus we introduce dual variables 
                        
                           
                              λ
                           
                           
                              i
                              j
                           
                        
                        ≥
                        0
                     . By meeting the KKT condition, α can then be derived into a Euler–Lagrange equation with non-negative maintaining 
                        
                           (12)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         δ
                                                      
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                
                                                
                                                   R
                                                
                                             
                                             
                                                
                                                   ∑
                                                
                                                
                                                   r
                                                   =
                                                   1
                                                
                                                
                                                   R
                                                
                                             
                                             
                                                
                                                   d
                                                
                                                
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         r
                                                      
                                                      
                                                         t
                                                         +
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      Φ
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      r
                                                   
                                                
                                                ,
                                                
                                                   
                                                      Φ
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      r
                                                   
                                                
                                             
                                             =
                                             
                                                
                                                   ϵ
                                                
                                                
                                                   i
                                                   j
                                                
                                                
                                                   t
                                                   +
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             α
                                             =
                                             min
                                             
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                ,
                                                α
                                             
                                             ,
                                             
                                                
                                                   λ
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             =
                                             
                                                
                                                   λ
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             −
                                             α
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

The Lagrange multiplier α can be solved with Eq. (12). The proof of uniqueness and solution of α are provided in Appendix A. According to the optimization, statistical kernel A
                     
                        r
                     (1 ≤ r ≤ R) can be learned in the following algorithm:
                        Algorithm 1
                        Statistical adaptive metric learning
                              
                                 
                              
                           
                        

It is essential to point out that our method, statistical adaptive metric learning (SAML) is an adaptive version of hybrid statistical metric learning, e.g. Hybrid Euclidean-and-Riemannian Metric Learning (HERML). HERML individually fixes the number of learning Mahalanobis matrices as 3 for all kinds of feature sets. In HERML, 
                        
                           (13)
                           
                              min
                              {
                              
                                 v
                                 a
                                 r
                              
                              (
                              d
                              i
                              a
                              g
                              (
                              log
                              Λ
                              )
                              )
                              }
                              =
                              log
                              
                                 
                                    Φ
                                 
                                 
                                    S
                                    A
                                    S
                                 
                              
                              
                                 
                                    Φ
                                 
                                 
                                    S
                                    U
                                    S
                                 
                              
                              
                                 
                                    Φ
                                 
                                 
                                    D
                                    I
                                    S
                                 
                              
                              =
                              U
                              (
                              log
                              
                                 
                                    Λ
                                 
                                 
                                    S
                                    A
                                    S
                                 
                              
                              
                                 
                                    Λ
                                 
                                 
                                    S
                                    U
                                    S
                                 
                              
                              
                                 
                                    Λ
                                 
                                 
                                    D
                                    I
                                    S
                                 
                              
                              )
                              
                                 
                                    U
                                 
                                 
                                    T
                                 
                              
                              .
                              
                           
                        
                     
                  

Eq. (13) is arbitrarily set as an implicit condition. Only full statistic combination is used for their set modeling. Different from HERML, better statistic combinations are selected by analyzing the canonical correlations in SAML. Although the optimization looks similar, HERML is dealing with image sets while SAML is handling feature sets. Minor variations will usually not lead to large fluctuations in scale of images, but they may likely lead to large fluctuations in that of feature sets, e.g. HOG and SIFT. HERML individually combines all three metrics, while SAML explores the correlation among these metrics. Therefore, the subspace scaling and effective metric selection in SAML can achieve better performances for various feature sets.

Since our methods is described as a Mahalanobis-like metric learning, it is also essential to note that our method clearly has three advantages over ITML. Firstly, the data scale is better kept by the subspace mapping in our method. Secondly, multiple statistic combination makes our method more adaptive to various data than that of ITML. Thirdly, the measurement of Log-Determinant divergence provides a more uniformed framework for identity matrix approximation than the distribution analysis in ITML.

In ITML, a multivariate Gaussian distribution is defined directly on data as 
                        p
                        (
                        x
                        ;
                        A
                        )
                        =
                        
                           
                              1
                           
                           
                              Z
                           
                        
                        e
                        x
                        p
                        
                           −
                           
                              
                                 1
                              
                              
                                 2
                              
                           
                           
                              
                                 x
                              
                              
                                 T
                              
                           
                           A
                           x
                        
                     . Z is the normalizing constant. The probability density p(x;A
                     0) is approximated by the initial density distribution, where A
                     0 is the identity matrix. In ITML, the distance between the two distributions is formulated as the KL-divergence measuring the relative entropy: 
                        
                           (14)
                           
                              K
                              L
                              (
                              p
                              (
                              x
                              ;
                              
                                 
                                    A
                                 
                                 
                                    0
                                 
                              
                              )
                              ∥
                              p
                              (
                              x
                              ;
                              A
                              )
                              )
                              =
                              ∫
                              p
                              (
                              x
                              ;
                              
                                 
                                    A
                                 
                                 
                                    0
                                 
                              
                              )
                              log
                              
                                 
                                    p
                                    (
                                    x
                                    ;
                                    
                                       
                                          A
                                       
                                       
                                          0
                                       
                                    
                                    )
                                 
                                 
                                    p
                                    (
                                    x
                                    ;
                                    A
                                    )
                                 
                              
                              d
                              x
                              .
                              
                           
                        
                     Then the problem identity approximation is derived as a KL-divergence minimization for ∀(i,j) pairs. 
                        
                           (15)
                           
                              
                                 
                                    min
                                 
                                 
                                    A
                                    ≤
                                    0
                                 
                              
                              K
                              L
                              (
                              p
                              (
                              x
                              ;
                              
                                 
                                    A
                                 
                                 
                                    0
                                 
                              
                              )
                              ∥
                              p
                              (
                              x
                              ;
                              A
                              )
                              )
                              ,
                              
                              s
                              .
                              t
                              .
                              
                                 
                                    δ
                                 
                                 
                                    i
                                    j
                                 
                              
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                       
                                          T
                                       
                                    
                                    A
                                    
                                       
                                          x
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                              ≤
                              
                                 
                                    ϵ
                                 
                                 
                                    i
                                    j
                                 
                              
                              ,
                              
                              ∀
                              (
                              i
                              ,
                              j
                              )
                              .
                              
                           
                        
                     Finally, Eq. (15) is equivalent to the problem of Log-Determinant distance minimization: 
                        
                           (16)
                           
                              
                                 
                                    min
                                 
                                 
                                    A
                                    ≤
                                    0
                                 
                              
                              
                                 
                                    D
                                 
                                 
                                    l
                                    d
                                 
                              
                              (
                              A
                              ,
                              
                                 
                                    A
                                 
                                 
                                    0
                                 
                              
                              )
                              +
                              
                                 
                                    D
                                 
                                 
                                    l
                                    d
                                 
                              
                              (
                              d
                              i
                              a
                              g
                              (
                              ϵ
                              )
                              ,
                              d
                              i
                              a
                              g
                              (
                              
                                 
                                    ϵ
                                 
                                 
                                    0
                                 
                              
                              )
                              )
                              ,
                              s
                              .
                              t
                              .
                              
                              
                                 
                                    δ
                                 
                                 
                                    i
                                    j
                                 
                              
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                       
                                          T
                                       
                                    
                                    A
                                    
                                       
                                          x
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                              ≤
                              
                                 
                                    ϵ
                                 
                                 
                                    i
                                    j
                                 
                              
                              ∀
                              (
                              i
                              ,
                              j
                              )
                           
                        
                     where ϵ
                     
                        ij
                      is the slack variable for the (i,j) pairs and ϵ
                     0 is identity. δ
                     
                        ij
                      is the indicator function for (i,j). If (i,j) are similar, δ
                     
                        ij
                     
                     =1, if (i,j) are not similar, δ
                     
                        ij
                     
                     =−1. From Eq. (16), the minimization problem of Eq. (16) in ITML can only be used for learning a single Mahalanobis metric directly on input data. The extension of Eq. (16) is basically constrained by its distribution assumption in Eq. (14). Relative entropy can be computed only when all the data samples are in the same scale. Contrary to ITML, the learning problem proposed in SAML is handling multiple statistics in a uniformed minimization framework. Taking advantage of statistical subspace embedding and Log-Determinant divergence, a scale invariant framework of Eq. (9) proposed in our method is capable of minimizing R Mahalanobis-like matrices and leading to better classification than that of ITML.

@&#EXPERIMENTS@&#

As a statistic-based metric learning method, the proposed statistical adaptive metric learning (SAML) is mainly compared with two types of state-of-art methods in action visual feature set classification: 1) statistic-based methods; 2) metric learning methods. To obtain a comprehensive performance evaluation in action recognition, our method is also compared with some well-known Spatio-Temporal feature based methods.

The statistic-based methods include: 1) Sample-based methods: Maximum Mean Discrepancy (MMD) [17]; 2)subspace-based methods: Covariance Discriminant Learning (CDL) [15]; 3) distribution-based methods: Gaussian Mixture Model (GMM) [3] and Single Gaussian Model (SGM) [2].

The metric learning methods include: Information Theoretic Metric Learning (ITML) [19],Manifold Discriminant Analysis (MDA) [14], Hybrid Euclidean-and-Riemannian Metric Learning (HERML) [4] and Distribution-based ITML (DIS-ITML).

Some well-known methods using Spatio-Temporal feature for action recognition were proposed by Campos et al. [28], Wang and Chen [29], Fathi et al., Jhuang et al. [30], Wu et al. [31], Kovashka and Grauman [32], Liu et al. [33], Shao et al. [34] and Zhen et al. [35].

Static computer vision features are extracted frame by frame. In the case of set modeling, common scale invariant image features are employed, including Histogram of Gradients (HOG), Shift-invariant Feature Transformation (SIFT), Harris corners and Textures. All the features are clustered into 128 dimensions, while SIFT features are clustered into 128 points. Thus one frame generates a 128×
                           k feature set. For videos with different resolutions, we uniformly resize each frame into 320×240 at QVGA resolution. When compared with other methods, feature combination of SIFT+HOG+Corners is uniformly used. Average recognition rate is used to measure the accuracy. For statistic-based methods and metric learning methods, all the source codes of the compared methods are obtained from their original authors, except for SGM and GMM. We implemented SGM and GMM meticulously. For methods using Bregman optimization like ours, distance thresholds ρ is set as the mean distances, margin parameter τ is set as the standard deviations and tuning scale ς ∈ [0.0110]. Furthermore, since our experiments are tested on feature sets, we carefully tuned each models of all the methods to achieve the best possible recognition performance. For MMD, the number of iteration is set to 10. For ITML, we set the parameter of Bregman optimization as stated above. The parameter settings of MDA is according to [14]. For CDL we adopt the KLDA for the discriminant analysis and k-NN for classification. For Spatial–Temporal (ST) feature based methods, we obtain their best recognition rate from the referred publications.

Five famous human action data sets are used in our experiments: Weizmann human action, UCF101, KTH human action, YouTube and HMDB51. Among those five video data sets, Weizmann and KTH have very static backgrounds with different human actions, while YouTube and HMDB51 both have complex and varying backgrounds and dynamic scenarios with different humans. Experiments are conducted both on human verification and action recognition.

The KTH dataset is a simple human action dataset, which includes 600 black and white videos captured by stationary cameras in 6 classes of actions with resolution of 160*120. The Weizmann dataset include 10 classes of human actions with 90 videos at low resolution of 180*144. The UCF101 human action dataset is a large dataset with 13320 videos from 101 action categories. UCF101 provides a large diversity in term of action types and with large variations in camera motion, object appearance and pose, object scale, viewpoint, cluttered background, illumination conditions, etc. It is the most challenging data set to date. The action categories can be divided into five types: 1) Human–Object Interaction, 2) Body-Motion Only, 3) Human–Human Interaction, 4) Playing Musical Instruments, and 5) Sports. In our experiments we randomly select classes from all of the UCF101 categories. The YouTube dataset is a challenging and widely used video dataset. It has 1910 video clips of 47 subjects collected from YouTube. The HMDB51 dataset was collected by Kuehne et al., containing 6766 video clips in total. There are 51 action classes, each with at least 101 positive samples.

For smaller datasets with less than 20 classes we test on all classes. For larger datasets with more than 20 classes, we take a statistical sampling approach to evaluate the average performance. We conduct 20 trials on each of these large datasets. In each trial we randomly select 14 classes; and inside each class, we randomly select 10 video clips, 5 for training and 5 for testing. Thus 280 random action classes and 2800 random video clips are evaluated for each of these large action datasets. Average recognition rate over 20 trials is then calculated as the measure of performance. Fig. 3
                            illustrates the sampling procedure of our experiments on large datasets. A fixed number of frames and parameter values are selected in the experiments. The training gallery includes the same number of frames for each video sequence, and the test sets are extracted in the same way. The task is to recognize the input test set based on the training gallery.

@&#RESULTS AND ANALYSIS@&#

Performance comparisons are conducted with various statistic-based algorithms. Table 1
                            shows the performance comparison among different statistic-based methods. Three benchmark video analysis datasets are in use: UCF101, YouTube and HMDB51. Note that the video sequences in those datasets are not just with human action scenes, but also with more common and complicated shapes, streets and dynamic scenarios.

From Table 1, we can observe that the sample-based statistics have clear weakness on complex scenarios. Though supported by Bregman divergence, mean vectors focusing on the centroids are far from adequate to represent the feature set. With the addition of the 2nd-order statistic, subspace-based method achieves better recognition rates. Riemannian manifold and Grassmann affine spaces scatter the data with a scalable representation. 70.3% recognition rate is achieved by covariant discriminative learning (CDL). While the distribution-based methods perform better than sample-based methods on UCF101 data set with over 80% average recognition rate, and perform similar with sample-based methods on Youtube and HDBM51 data set with a relatively low recognition rate between 25% and 35%. The proposed SAML performs better than other statistic-based methods, with the highest average recognition rate on UCF101, Youtube and HMDB51 data set. Performances evaluated in Table 1 demonstrate that the proposed SAML performs better than statistic-based methods for action feature set recognition with complex background scenarios.


                           Table 2
                            shows the performance comparison among different metric learning methods. Average recognition rates are analyzed for action feature set recognition. UCF101, YouTube and HMDB51 are used. From Table 2, HERML and DIS-ITML have over 85% recognition rates on UCF101 dataset and over 70% recognition rates on YouTube dataset. The proposed SAML has better recognition performance than other metric learning methods on UCF101 and HMDB51. On YouTube data, SAML performs better than other metric learning methods, except HERML. The results in Tables 1 and 2 show that our method is able to adaptively take advantage of both statistic-based methods and metric learning methods, and consequently boost their performance to some extent. SAML achieves 95.5% average accuracy on UCF101 dataset, the second best performance on YouTube dataset, and the best performance on HMDB51 dataset in the state-of-art statistic-based and metric learning-based methods.


                           Table 3
                            compares our method with some well-known Spatial–Temporal (ST) feature based action recognition methods on KTH, Weizmann and UCF101 data set. Average recognition rate is used as the measure of accuracy. From Table 3, we observe that the recognition performance of SAML is better than other well-known methods. For human action recognition, the Spatial–Temporal features have clear advantages over large scale feature sets on modeling and optimization computation. The subspace mapping in the proposed SAML method takes advantage of scale invariant feature space and statistic combination, which leads to improved recognition accuracy. Our method is further compared with several ST feature based methods on HMDB51 and YouTube data set in Table 4
                           . The proposed SAML performed 20% better than the best results from other ST feature based methods on HDMB51. But SAML does not perform well on YouTube dataset. This is because the proposed SAML is developed for subspace analysis on visual feature sets in different scales, and static visual features such as HOG, SIFT and corners are adaptively combined to construct scale variant feature sets. For YouTube video data, the ST features such as HOG3D and CNN generally have very good representation already, and thus there is no clear advantage from SAML. Overall the proposed SAML has 100% accuracies on KTH and Weizmann, 95.5% accuracy on UCF101, 71.3% accuracy on HMDB51 and 70.83% accuracy on YouTube data set. Such results are the best on KTH, Weizmann, UCF101, HMDB51, and the second best on YouTube. In summary, the proposed SAML outperforms most of the state-of-art methods, including statistic-based methods, metric learning methods and ST feature-based methods, on five benchmark databases.

Furthermore, as a hybrid statistical metric learning, the proposed SAML is compared with other hybrid methods, i.e. HERML and DIS-ITML, in term of class-based classification accuracy. 14 action classes were randomly chosen from UCF101. For each class we randomly sampled 10 actions, 5 for training and 5 for testing. The average recognition rate is computed by averaging 10 trials of sampling. Fig. 4
                            shows the average classification accuracy over 14 randomly sampled action classes. For 14 classes with different statistic characters, the recognition rates of SAML is higher than that of others. More importantly, no class is classified with extremely low recognition rate. Such a result demonstrates that our method is robust to various kinds of action sets. In another words, SAML is more stable than other hybrid statistical metric learning methods, and would provide similar level of recognition rate uniformly over different human action types.

According to the experimental setup, two parameters of the algorithm and one variable of the video clips are to be evaluated. They are tuning scale ς, slack weights γ and frames in use for each video, respectively. In desirable circumstance, the classification performance should be robust to algorithm parameters. If more frames are used, which are considered as additional information, the recognition rate should also increase.


                           Fig. 5
                            compares the robustness of tuning scale ς, slack weights γ in SAML and that of HERML, which has similar optimization and parameter settings in the algorithm design. 5 human action classes in UCF dataset were tested for recognition accuracy in this experiment. Average recognition rate is calculated on each value of the parameter. From Fig. 5, we observe that the recognition rate of SAML becomes stable when zeta is no less than 0.3 and slack weights are no less than 0.1, so as the HERML. To sum up, both HERML and SAML have the similar level of parameter robustness.

Other than parameter robust evaluation, an evaluation of frame robustness is given by Fig. 6
                           
                           in term of average recognition rate w.r.t. number of frames. Three hybrid statistic metric learning methods are evaluated on three datasets: KTH, Weizmann and HMDB51. From Fig. 6, we observe that all the recognition rates are increasing among all three of the data set as the number of frames increases with SAML and HERML, while the classification rates of DIS-ITML on HMDB51 and Weizmann remain the same. Therefore in the case of feature set classification, our method and HERML are robust to the number of frames while DIS-ITML is not. In addition, Fig. 7
                            compares the average recognition rate w.r.t. number of frames among all the three hybrid statistic methods. Not only robust to frames, SAML also performs the best in this case.

Furthermore, we test our method on different feature combinations to evaluate the robustness of various features. Fig. 8
                            shows an example of recognition rate with 14 randomly action classes from Youtube database. With 5 available static features, the figure shows that the recognition rates of SAML are nearly the same among different combinations for each of the actions.

Finally, computational costs of our method on different data sets are also presented in Tables 5 and 6
                           
                           . In comparison, the computational cost of HERML is provided as well. All the classifications were set up as stated in Section 5.1. From Tables 5 and 6, we observe that both the training time and testing time of the proposed SAML are faster than those of HERML. Such acceleration is mainly due to the statistic kernel reduction introduced by our minimum Hilbert subspace selection. Classifications with only necessary statistic combination efficiently improve the computation and recognition.

In summary, our method performs well in human action recognition. It generally outperforms other hybrid statistic metric learning methods in terms of parameter robustness and computational efficiency.

@&#CONCLUSIONS@&#

In this paper, we proposed a statistical adaptive metric learning method for feature set modeling and classification. The extensive experiments have shown that our proposed method outperforms several state-of-the-art methods in human action recognition over a variety of public data sets. To our best knowledge, the optimal selection of metric learning combination in the Hilbert spaces has not been investigated before this work. In the future, it would be interesting to expand our method for other possible hybrid metric selections with more robust statistic modeling feature sets in different structures and real-world classifications.

@&#ACKNOWLEDGMENTS@&#

This work was supported in part by the National Science Foundation under grant 1350763.

Consider the following constrained minimization 
                        
                           (17)
                           
                              
                                 
                                    
                                       
                                          
                                             min
                                          
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   1
                                                
                                             
                                             ≤
                                             0
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   A
                                                
                                                
                                                   R
                                                
                                             
                                             ≤
                                             0
                                             ,
                                             ϵ
                                          
                                       
                                       
                                          
                                             1
                                          
                                          
                                             R
                                          
                                       
                                       
                                          
                                             ∑
                                          
                                          
                                             r
                                             =
                                             1
                                          
                                          
                                             R
                                          
                                       
                                       
                                          
                                             D
                                          
                                          
                                             l
                                             d
                                          
                                       
                                       (
                                       
                                          
                                             A
                                          
                                          
                                             r
                                          
                                       
                                       ,
                                       
                                          
                                             A
                                          
                                          
                                             0
                                          
                                       
                                       )
                                       +
                                       γ
                                       
                                          
                                             D
                                          
                                          
                                             l
                                             d
                                          
                                       
                                       (
                                       d
                                       i
                                       a
                                       g
                                       (
                                       ϵ
                                       )
                                       ,
                                       d
                                       i
                                       a
                                       g
                                       (
                                       
                                          
                                             ϵ
                                          
                                          
                                             0
                                          
                                       
                                       )
                                       )
                                    
                                 
                                 
                                    
                                       s
                                       .
                                       t
                                       .
                                       
                                       
                                          
                                             
                                                
                                                   δ
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                          
                                          
                                             R
                                          
                                       
                                       
                                          
                                             ∑
                                          
                                          
                                             r
                                             =
                                             1
                                          
                                          
                                             R
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   r
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   Φ
                                                
                                                
                                                   i
                                                
                                                
                                                   r
                                                
                                             
                                             ,
                                             
                                                
                                                   Φ
                                                
                                                
                                                   j
                                                
                                                
                                                   r
                                                
                                             
                                          
                                       
                                       ≤
                                       
                                          
                                             ϵ
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       ∀
                                       (
                                       i
                                       ,
                                       j
                                       )
                                    
                                 
                              
                           
                        
                     where A
                     
                        r
                     (r
                     =1,…,R) is additive separable for all R matrices. Thus R sub-minimizations w.r.t. A
                     
                        r
                      can be separated in the same form.
                        
                           (18)
                           
                              
                                 
                                    
                                       
                                          
                                             min
                                          
                                          
                                             A
                                             ≤
                                             0
                                             ,
                                             ϵ
                                          
                                       
                                       
                                          
                                             D
                                          
                                          
                                             l
                                             d
                                          
                                       
                                       (
                                       A
                                       ,
                                       
                                          
                                             A
                                          
                                          
                                             0
                                          
                                       
                                       )
                                       +
                                       γ
                                       
                                          
                                             D
                                          
                                          
                                             l
                                             d
                                          
                                       
                                       (
                                       d
                                       i
                                       a
                                       g
                                       (
                                       ϵ
                                       )
                                       ,
                                       d
                                       i
                                       a
                                       g
                                       (
                                       
                                          
                                             ϵ
                                          
                                          
                                             0
                                          
                                       
                                       )
                                       )
                                    
                                 
                                 
                                    
                                       s
                                       .
                                       t
                                       .
                                       
                                       
                                          
                                             
                                                
                                                   δ
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                          
                                          
                                             R
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             A
                                          
                                       
                                       
                                          
                                             
                                                Φ
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                Φ
                                             
                                             
                                                j
                                             
                                          
                                       
                                       ≤
                                       
                                          
                                             ϵ
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       ∀
                                       (
                                       i
                                       ,
                                       j
                                       )
                                    
                                 
                              
                           
                        
                     where 
                        
                           
                              d
                           
                           
                              A
                           
                        
                        
                           
                              
                                 Φ
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 Φ
                              
                              
                                 j
                              
                           
                        
                     
                     =
                     tr(A(log(Φ
                     
                        i
                     )−log(Φ
                     
                        j
                     ))(log(Φ
                     
                        i
                     )−log(Φ
                     
                        j
                     ))
                        T
                     ). The Mahalabonis distance matrix A is the primal minimizer.

Firstly, with Bregman projection with respect to A, 
                        
                           (19)
                           
                              
                                 
                                    
                                       ∇
                                       
                                          
                                             D
                                          
                                          
                                             l
                                             d
                                          
                                       
                                       (
                                       
                                          A
                                          
                                             t
                                             +
                                             1
                                          
                                       
                                       )
                                       =
                                       ∇
                                       
                                          
                                             D
                                          
                                          
                                             l
                                             d
                                          
                                       
                                       (
                                       
                                          A
                                          
                                             t
                                          
                                       
                                       )
                                       +
                                       
                                          
                                             
                                                δ
                                             
                                             
                                                i
                                                j
                                             
                                          
                                       
                                       α
                                       (
                                       log
                                       (
                                       
                                          
                                             Φ
                                          
                                          
                                             j
                                          
                                       
                                       )
                                       −
                                       log
                                       (
                                       
                                          
                                             Φ
                                          
                                          
                                             j
                                          
                                       
                                       )
                                       )
                                       
                                          
                                             (
                                             log
                                             (
                                             
                                                
                                                   Φ
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                             −
                                             log
                                             (
                                             
                                                
                                                   Φ
                                                
                                                
                                                   j
                                                
                                             
                                             )
                                             )
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             A
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                              
                           
                        
                     where α is the Lagrange multiplier, since 
                        
                           (20)
                           
                              
                                 
                                    
                                       ∇
                                       
                                          
                                             D
                                          
                                          
                                             l
                                             d
                                          
                                       
                                       (
                                       A
                                       )
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             ∇
                                          
                                          
                                             A
                                          
                                       
                                       (
                                       t
                                       r
                                       (
                                       A
                                       
                                          
                                             A
                                          
                                          
                                             0
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       )
                                       )
                                       −
                                       
                                          
                                             ∇
                                          
                                          
                                             A
                                          
                                       
                                       (
                                       log
                                       
                                          d
                                          e
                                          t
                                       
                                       (
                                       A
                                       
                                          
                                             A
                                          
                                          
                                             0
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       )
                                       )
                                       =
                                       
                                          
                                             A
                                          
                                          
                                             0
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         A
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               0
                                                            
                                                            
                                                               −
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   *
                                                
                                             
                                          
                                          
                                             
                                                d
                                                e
                                                t
                                             
                                             
                                                A
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             A
                                          
                                          
                                             0
                                          
                                          
                                             −
                                             1
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             A
                                          
                                          
                                             0
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             A
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       .
                                    
                                 
                              
                           
                        
                     
                  

Eq. (19) is derived to 
                        
                           (21)
                           
                              
                                 
                                    (
                                    
                                       
                                          A
                                       
                                       
                                          t
                                          +
                                          1
                                       
                                    
                                    )
                                 
                                 
                                    −
                                    1
                                 
                              
                              =
                              
                                 
                                    (
                                    
                                       
                                          A
                                       
                                       
                                          t
                                       
                                    
                                    )
                                 
                                 
                                    −
                                    1
                                 
                              
                              −
                              
                                 
                                    δ
                                 
                                 
                                    i
                                    j
                                 
                              
                              α
                              (
                              log
                              (
                              
                                 
                                    Φ
                                 
                                 
                                    i
                                 
                              
                              )
                              −
                              log
                              (
                              
                                 
                                    Φ
                                 
                                 
                                    j
                                 
                              
                              )
                              )
                              
                                 
                                    (
                                    log
                                    (
                                    
                                       
                                          Φ
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    −
                                    log
                                    (
                                    
                                       
                                          Φ
                                       
                                       
                                          j
                                       
                                    
                                    )
                                    )
                                 
                                 
                                    T
                                 
                              
                           
                        
                     
                     
                        
                           (22)
                           
                              
                                 
                                    A
                                 
                                 
                                    t
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    (
                                    
                                       
                                          (
                                          
                                             
                                                A
                                             
                                             
                                                t
                                             
                                          
                                          )
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    −
                                    
                                       
                                          δ
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    α
                                    (
                                    log
                                    (
                                    
                                       
                                          Φ
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    −
                                    log
                                    (
                                    
                                       
                                          Φ
                                       
                                       
                                          j
                                       
                                    
                                    )
                                    )
                                    
                                       
                                          (
                                          log
                                          (
                                          
                                             
                                                Φ
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          −
                                          log
                                          (
                                          
                                             
                                                Φ
                                             
                                             
                                                j
                                             
                                          
                                          )
                                          )
                                       
                                       
                                          T
                                       
                                    
                                    )
                                 
                                 
                                    −
                                    1
                                 
                              
                              .
                              
                           
                        
                     According to the Sherman–Morris inverse formula: 
                        
                           (23)
                           
                              
                                 
                                    (
                                    B
                                    +
                                    u
                                    
                                       
                                          v
                                       
                                       
                                          T
                                       
                                    
                                    )
                                 
                                 
                                    −
                                    1
                                 
                              
                              =
                              
                                 
                                    B
                                 
                                 
                                    −
                                    1
                                 
                              
                              −
                              
                                 
                                    
                                       
                                          B
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    u
                                    
                                       
                                          v
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          −
                                          1
                                       
                                    
                                 
                                 
                                    1
                                    +
                                    
                                       
                                          v
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    u
                                 
                              
                           
                        
                     where u,v is semi-positive definite matrix and B is symmetric positive definite (SPD) matrix. Eq. (22) is then derived in form of 
                        
                           (24)
                           
                              
                                 
                                    A
                                 
                                 
                                    t
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    A
                                 
                                 
                                    t
                                 
                              
                              +
                              
                                 
                                    
                                       
                                          δ
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    α
                                    
                                       
                                          A
                                       
                                       
                                          t
                                       
                                    
                                    (
                                    log
                                    (
                                    
                                       
                                          Φ
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    −
                                    log
                                    (
                                    
                                       
                                          Φ
                                       
                                       
                                          j
                                       
                                    
                                    )
                                    )
                                    
                                       
                                          (
                                          log
                                          (
                                          
                                             
                                                Φ
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          −
                                          log
                                          (
                                          
                                             
                                                Φ
                                             
                                             
                                                j
                                             
                                          
                                          )
                                          )
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          A
                                       
                                       
                                          t
                                       
                                    
                                 
                                 
                                    1
                                    −
                                    
                                       
                                          (
                                          log
                                          (
                                          
                                             
                                                Φ
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          −
                                          log
                                          (
                                          
                                             
                                                Φ
                                             
                                             
                                                j
                                             
                                          
                                          )
                                          )
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          A
                                       
                                       
                                          t
                                       
                                    
                                    (
                                    log
                                    (
                                    
                                       
                                          Φ
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    −
                                    log
                                    (
                                    
                                       
                                          Φ
                                       
                                       
                                          j
                                       
                                    
                                    )
                                    )
                                 
                              
                           
                        
                     
                  

Simplify Eq. (24) as 
                        
                           (25)
                           
                              
                                 
                                    
                                       
                                          
                                             A
                                          
                                          
                                             t
                                             +
                                             1
                                          
                                       
                                    
                                    
                                       =
                                       
                                          
                                             A
                                          
                                          
                                             t
                                          
                                       
                                       +
                                       
                                          
                                             
                                                
                                                   δ
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             α
                                          
                                          
                                             1
                                             −
                                             
                                                
                                                   δ
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             α
                                             t
                                             r
                                             (
                                             
                                                
                                                   A
                                                
                                                
                                                   t
                                                
                                             
                                             (
                                             log
                                             (
                                             
                                                
                                                   Φ
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                             −
                                             log
                                             (
                                             
                                                
                                                   Φ
                                                
                                                
                                                   j
                                                
                                             
                                             )
                                             )
                                             
                                                
                                                   (
                                                   log
                                                   (
                                                   
                                                      
                                                         Φ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                   −
                                                   log
                                                   (
                                                   
                                                      
                                                         Φ
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   )
                                                   )
                                                
                                                
                                                   T
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                       ⋅
                                       
                                          
                                             A
                                          
                                          
                                             t
                                          
                                       
                                       (
                                       log
                                       (
                                       
                                          
                                             Φ
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       −
                                       log
                                       (
                                       
                                          
                                             Φ
                                          
                                          
                                             j
                                          
                                       
                                       )
                                       )
                                       
                                          
                                             (
                                             log
                                             (
                                             
                                                
                                                   Φ
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                             −
                                             log
                                             (
                                             
                                                
                                                   Φ
                                                
                                                
                                                   j
                                                
                                             
                                             )
                                             )
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             A
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  


                     
                        
                           (26)
                           
                              
                                 
                                    
                                       
                                          
                                             A
                                          
                                          
                                             t
                                             +
                                             1
                                          
                                       
                                       =
                                       
                                          
                                             A
                                          
                                          
                                             t
                                          
                                       
                                       +
                                       
                                       
                                          
                                             
                                                
                                                   δ
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             α
                                          
                                          
                                             1
                                             −
                                             
                                                
                                                   δ
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             α
                                             
                                                
                                                   d
                                                
                                                
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                             (
                                             
                                                
                                                   Φ
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   Φ
                                                
                                                
                                                   j
                                                
                                             
                                             )
                                          
                                       
                                       
                                          
                                             A
                                          
                                          
                                             t
                                          
                                       
                                       (
                                       log
                                       (
                                       
                                          
                                             Φ
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                 
                                 
                                    
                                       −
                                       log
                                       (
                                       
                                          
                                             Φ
                                          
                                          
                                             j
                                          
                                       
                                       )
                                       )
                                       
                                          
                                             (
                                             log
                                             (
                                             
                                                
                                                   Φ
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                             −
                                             log
                                             (
                                             
                                                
                                                   Φ
                                                
                                                
                                                   j
                                                
                                             
                                             )
                                             )
                                          
                                          
                                             T
                                          
                                       
                                       
                                       
                                       
                                          
                                             A
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

The primal minimizer A is solved by Eq. (26). Secondly, after solving primal minimizer, look back at Eq. (18) for the solution of the other minimizer . With Bregman projection of Eq. (18) with respect to ϵ, 
                        
                           (27)
                           
                              ∇
                              
                                 
                                    D
                                 
                                 
                                    l
                                    d
                                 
                              
                              (
                              
                                 
                                    ϵ
                                 
                                 
                                    i
                                    j
                                 
                                 
                                    t
                                    +
                                    1
                                 
                              
                              )
                              =
                              ∇
                              
                                 
                                    D
                                 
                                 
                                    l
                                    d
                                 
                              
                              (
                              
                                 
                                    ϵ
                                 
                                 
                                    i
                                    j
                                 
                                 
                                    t
                                 
                              
                              )
                              −
                              
                                 
                                    
                                       
                                          δ
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    α
                                 
                                 
                                    γ
                                 
                              
                           
                        
                     
                     
                        
                           (28)
                           
                              
                                 
                                    
                                       ∇
                                       
                                          
                                             D
                                          
                                          
                                             l
                                             d
                                          
                                       
                                       (
                                       ϵ
                                       )
                                       =
                                       
                                          
                                             ∇
                                          
                                          
                                             ϵ
                                          
                                       
                                       [
                                       t
                                       r
                                       (
                                       d
                                       i
                                       a
                                       g
                                       (
                                       ϵ
                                       )
                                       ⋅
                                       d
                                       i
                                       a
                                       g
                                       
                                          
                                             (
                                             
                                                
                                                   ϵ
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       )
                                       ]
                                       −
                                       
                                          
                                             ∇
                                          
                                          
                                             ϵ
                                          
                                       
                                       [
                                       l
                                       o
                                       g
                                       d
                                       e
                                       t
                                       (
                                       d
                                       i
                                       a
                                       g
                                       (
                                       ϵ
                                       )
                                       )
                                       ⋅
                                       d
                                       i
                                       a
                                       g
                                       
                                          
                                             (
                                             
                                                
                                                   ϵ
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       )
                                       ]
                                    
                                 
                                 
                                    
                                       =
                                       d
                                       i
                                       a
                                       g
                                       
                                          
                                             (
                                             
                                                
                                                   ϵ
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       −
                                       d
                                       i
                                       a
                                       g
                                       
                                          
                                             (
                                             ϵ
                                             )
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       .
                                    
                                 
                              
                           
                        
                     
                  

Then Eq. (27) becomes 
                        
                           (29)
                           
                              
                                 
                                    
                                       d
                                       i
                                       a
                                       g
                                       (
                                       
                                          
                                             ϵ
                                          
                                          
                                             i
                                             j
                                          
                                          
                                             t
                                             +
                                             1
                                          
                                       
                                       )
                                    
                                    
                                       =
                                       
                                          
                                             
                                                
                                                   d
                                                   i
                                                   a
                                                   g
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     ϵ
                                                                  
                                                                  
                                                                     i
                                                                     j
                                                                  
                                                                  
                                                                     t
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         −
                                                         1
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         
                                                            
                                                               δ
                                                            
                                                            
                                                               i
                                                               j
                                                            
                                                         
                                                         α
                                                      
                                                      
                                                         γ
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             −
                                             1
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                       d
                                       i
                                       a
                                       g
                                       (
                                       
                                          
                                             ϵ
                                          
                                          
                                             i
                                             j
                                          
                                          
                                             t
                                          
                                       
                                       )
                                       +
                                       
                                          
                                             
                                                
                                                   δ
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             α
                                             ⋅
                                             d
                                             i
                                             a
                                             g
                                             
                                                
                                                   
                                                      
                                                         ϵ
                                                      
                                                      
                                                         i
                                                         j
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                             ⋅
                                             d
                                             i
                                             a
                                             g
                                             
                                                
                                                   
                                                      
                                                         ϵ
                                                      
                                                      
                                                         i
                                                         j
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             γ
                                             −
                                             
                                                
                                                   δ
                                                
                                                
                                                   i
                                                
                                             
                                             j
                                             α
                                             d
                                             i
                                             a
                                             g
                                             
                                                
                                                   
                                                      
                                                         ϵ
                                                      
                                                      
                                                         i
                                                         j
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       =
                                       
                                          
                                             γ
                                             d
                                             i
                                             a
                                             g
                                             
                                                
                                                   
                                                      
                                                         ϵ
                                                      
                                                      
                                                         i
                                                         j
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             γ
                                             −
                                             
                                                
                                                   δ
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             α
                                             d
                                             i
                                             a
                                             g
                                             
                                                
                                                   
                                                      
                                                         ϵ
                                                      
                                                      
                                                         i
                                                         j
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       ⇒
                                       
                                          
                                             ϵ
                                          
                                          
                                             i
                                             j
                                          
                                          
                                             t
                                             +
                                             1
                                          
                                       
                                       =
                                       
                                          
                                             γ
                                             
                                                
                                                   ϵ
                                                
                                                
                                                   i
                                                   j
                                                
                                                
                                                   t
                                                
                                             
                                          
                                          
                                             γ
                                             −
                                             
                                                
                                                   δ
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             α
                                             
                                                
                                                   ϵ
                                                
                                                
                                                   i
                                                   j
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           
                        
                     
                  

The updating of two minimizers ϵ and A can be re-written together as 
                        
                           (30)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   t
                                                   +
                                                   1
                                                
                                             
                                             
                                          
                                          
                                             =
                                             
                                                
                                                   A
                                                
                                                
                                                   t
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      
                                                         δ
                                                      
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                   α
                                                
                                                
                                                   1
                                                   −
                                                   
                                                      
                                                         δ
                                                      
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                   α
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         Φ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         Φ
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   A
                                                
                                                
                                                   t
                                                
                                             
                                             (
                                             log
                                             (
                                             
                                                
                                                   Φ
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                             −
                                             log
                                             (
                                             
                                                
                                                   Φ
                                                
                                                
                                                   j
                                                
                                             
                                             )
                                             )
                                             (
                                             log
                                             (
                                             
                                                
                                                   Φ
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                          
                                       
                                       
                                          
                                          
                                             
                                             
                                                
                                                   
                                                      
                                                         −
                                                         log
                                                         
                                                            
                                                               
                                                                  
                                                                     Φ
                                                                  
                                                                  
                                                                     j
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   T
                                                
                                             
                                             
                                                
                                                   A
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ϵ
                                                
                                                
                                                   i
                                                   j
                                                
                                                
                                                   t
                                                   +
                                                   1
                                                
                                             
                                             
                                          
                                          
                                             =
                                             
                                                
                                                   γ
                                                   
                                                      
                                                         ϵ
                                                      
                                                      
                                                         i
                                                         j
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                                
                                                   γ
                                                   −
                                                   
                                                      
                                                         δ
                                                      
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                   α
                                                   
                                                      
                                                         ϵ
                                                      
                                                      
                                                         i
                                                         j
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

Finally, given the updated minimizers, Lagrange multiplier α can be solved by the following Euler–Lagrange equation with a non-negative maintaining equation for α handling the inequality constrains 
                        
                           (31)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   δ
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             t
                                             r
                                             (
                                             
                                                
                                                   A
                                                
                                                
                                                   t
                                                   +
                                                   1
                                                
                                             
                                             (
                                             log
                                             (
                                             
                                                
                                                   Φ
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                             −
                                             log
                                             (
                                             
                                                
                                                   Φ
                                                
                                                
                                                   j
                                                
                                             
                                             )
                                             )
                                             
                                                
                                                   (
                                                   log
                                                   (
                                                   
                                                      
                                                         Φ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                   −
                                                   log
                                                   (
                                                   
                                                      
                                                         Φ
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   )
                                                   )
                                                
                                                
                                                   T
                                                
                                             
                                             )
                                             −
                                             
                                                
                                                   ϵ
                                                
                                                
                                                   i
                                                   j
                                                
                                                
                                                   t
                                                   +
                                                   1
                                                
                                             
                                             =
                                             0
                                          
                                       
                                       
                                          
                                             α
                                             =
                                             min
                                             (
                                             
                                                
                                                   λ
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             ,
                                             α
                                             )
                                             =
                                             
                                                
                                                   λ
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             −
                                             α
                                          
                                       
                                    
                                 
                              
                           
                        
                     where α is the Lagrange multiplier, r
                     =1,…,R, dual variable λ
                     
                        ij
                      ≤ 0. Note that for semi-positive definite matrix z and SPD matrix B, tr(Bzz
                     
                        T
                     )=
                     z
                     
                        T
                     
                     Bz . Thus, according to Eq. (31)
                  


                     
                        
                           (32)
                           
                              
                                 
                                    
                                       
                                          
                                             δ
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       [
                                       
                                          
                                             d
                                          
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                       (
                                       
                                          
                                             Φ
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             Φ
                                          
                                          
                                             j
                                          
                                       
                                       )
                                       +
                                       
                                          
                                             α
                                             
                                                
                                                   δ
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                                
                                                   d
                                                
                                                
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                             (
                                             
                                                
                                                   Φ
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   Φ
                                                
                                                
                                                   j
                                                
                                             
                                             )
                                             
                                                
                                                   d
                                                
                                                
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                             (
                                             
                                                
                                                   Φ
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   Φ
                                                
                                                
                                                   j
                                                
                                             
                                             )
                                          
                                          
                                             1
                                             −
                                             α
                                             
                                                
                                                   δ
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                                
                                                   d
                                                
                                                
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                             (
                                             
                                                
                                                   Φ
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   Φ
                                                
                                                
                                                   j
                                                
                                             
                                             )
                                          
                                       
                                       ]
                                       =
                                       
                                          
                                             γ
                                             
                                                
                                                   ϵ
                                                
                                                
                                                   i
                                                   j
                                                
                                                
                                                   t
                                                
                                             
                                          
                                          
                                             γ
                                             −
                                             α
                                             
                                                
                                                   δ
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                                
                                                   ϵ
                                                
                                                
                                                   i
                                                   j
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       ⇒
                                       
                                          
                                             δ
                                          
                                          
                                             i
                                             j
                                          
                                       
                                       
                                          
                                             
                                                
                                                   d
                                                
                                                
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                             (
                                             
                                                
                                                   Φ
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   Φ
                                                
                                                
                                                   j
                                                
                                             
                                             )
                                          
                                          
                                             1
                                             −
                                             α
                                             
                                                
                                                   δ
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                                
                                                   d
                                                
                                                
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                             (
                                             
                                                
                                                   Φ
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                                
                                                   Φ
                                                
                                                
                                                   j
                                                
                                             
                                             )
                                          
                                       
                                       =
                                       
                                          
                                             γ
                                             
                                                
                                                   ϵ
                                                
                                                
                                                   i
                                                   j
                                                
                                                
                                                   t
                                                
                                             
                                          
                                          
                                             γ
                                             −
                                             α
                                             
                                                
                                                   δ
                                                
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                                
                                                   ϵ
                                                
                                                
                                                   i
                                                   j
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           
                        
                     
                  

Since all the elements in 
                        
                           
                              d
                           
                           
                              
                                 
                                    A
                                 
                                 
                                    t
                                 
                              
                           
                        
                        (
                        
                           
                              Φ
                           
                           
                              i
                           
                        
                        ,
                        
                           
                              Φ
                           
                           
                              j
                           
                        
                        )
                        =
                        t
                        r
                        (
                        A
                        (
                        
                           
                              Φ
                           
                           
                              i
                           
                        
                        −
                        
                           
                              Φ
                           
                           
                              j
                           
                        
                        )
                        
                           
                              (
                              
                                 
                                    Φ
                                 
                                 
                                    i
                                 
                              
                              −
                              
                                 
                                    Φ
                                 
                                 
                                    j
                                 
                              
                              )
                           
                           
                              T
                           
                        
                        )
                      are either semi-positive definite or positive definite, 
                        
                           
                              d
                           
                           
                              
                                 
                                    A
                                 
                                 
                                    t
                                 
                              
                           
                        
                        >
                        0
                      . By adding the dual variables λ
                     
                        ij
                     ,ϵ > 0 . Therefore, with all these condition above, we can conclude that a unique solution of α exists. The Lagrange multiplier can be solved by Eq. (32).

In summary, the simplified single statistic minimization of Eq. (18) is solved by Eqs. (30) and (32). For r-th (r
                     =1,…,R) statistic, the solution of the minimizers can then be easily written as 
                        
                           (33)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   r
                                                
                                                
                                                   t
                                                   +
                                                   1
                                                
                                             
                                             =
                                          
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   r
                                                
                                                
                                                   t
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      
                                                         δ
                                                      
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                   α
                                                
                                                
                                                   1
                                                   −
                                                   
                                                      
                                                         δ
                                                      
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                   α
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         
                                                            
                                                               A
                                                            
                                                            
                                                               r
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               Φ
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               r
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               Φ
                                                            
                                                            
                                                               j
                                                            
                                                            
                                                               r
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   A
                                                
                                                
                                                   r
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   log
                                                   
                                                      
                                                         
                                                            
                                                               Φ
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               r
                                                            
                                                         
                                                      
                                                   
                                                   −
                                                   log
                                                   
                                                      
                                                         
                                                            
                                                               Φ
                                                            
                                                            
                                                               j
                                                            
                                                            
                                                               r
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             ×
                                             
                                                
                                                   
                                                      
                                                         log
                                                         
                                                            
                                                               
                                                                  
                                                                     Φ
                                                                  
                                                                  
                                                                     i
                                                                  
                                                                  
                                                                     r
                                                                  
                                                               
                                                            
                                                         
                                                         −
                                                         log
                                                         
                                                            
                                                               
                                                                  
                                                                     Φ
                                                                  
                                                                  
                                                                     j
                                                                  
                                                                  
                                                                     r
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   T
                                                
                                             
                                             
                                                
                                                   A
                                                
                                                
                                                   r
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   ϵ
                                                
                                                
                                                   i
                                                   j
                                                
                                                
                                                   t
                                                   +
                                                   1
                                                
                                             
                                             =
                                          
                                          
                                             
                                                
                                                   γ
                                                   
                                                      
                                                         ϵ
                                                      
                                                      
                                                         i
                                                         j
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                                
                                                   γ
                                                   −
                                                   
                                                      
                                                         δ
                                                      
                                                      
                                                         i
                                                         j
                                                      
                                                   
                                                   α
                                                   
                                                      
                                                         ϵ
                                                      
                                                      
                                                         i
                                                         j
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

With the Lagrange multiplier solved by 
                        
                           (34)
                           
                              
                                 
                                    d
                                 
                                 
                                    
                                       
                                          A
                                       
                                       
                                          r
                                       
                                       
                                          t
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    Φ
                                 
                                 
                                    i
                                 
                                 
                                    r
                                 
                              
                              ,
                              
                                 
                                    Φ
                                 
                                 
                                    j
                                 
                                 
                                    r
                                 
                              
                              )
                              +
                              
                                 
                                    
                                       
                                          δ
                                       
                                       
                                          i
                                          j
                                       
                                    
                                 
                                 
                                    R
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    r
                                    =
                                    1
                                 
                                 
                                    R
                                 
                              
                              
                                 
                                    α
                                    
                                       
                                          d
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                r
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                Φ
                                             
                                             
                                                i
                                             
                                             
                                                r
                                             
                                          
                                          ,
                                          
                                             
                                                Φ
                                             
                                             
                                                j
                                             
                                             
                                                r
                                             
                                          
                                       
                                    
                                 
                                 
                                    1
                                    −
                                    α
                                    
                                       
                                          d
                                       
                                       
                                          
                                             
                                                A
                                             
                                             
                                                r
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                Φ
                                             
                                             
                                                i
                                             
                                             
                                                r
                                             
                                          
                                          ,
                                          
                                             
                                                Φ
                                             
                                             
                                                j
                                             
                                             
                                                r
                                             
                                          
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    γ
                                    
                                       
                                          ϵ
                                       
                                       
                                          i
                                          j
                                       
                                       
                                          t
                                       
                                    
                                 
                                 
                                    γ
                                    −
                                    α
                                    
                                       
                                          δ
                                       
                                       
                                          i
                                          j
                                       
                                    
                                    
                                       
                                          ϵ
                                       
                                       
                                          i
                                          j
                                       
                                       
                                          t
                                       
                                    
                                 
                              
                              .
                              
                           
                        
                     
                  

@&#REFERENCES@&#

