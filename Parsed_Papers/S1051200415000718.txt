@&#MAIN-TITLE@&#Model-based approach for high-dimensional non-Gaussian visual data clustering and feature weighting

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We introduce the Multidimensional asymmetric generalized Gaussian Mixture (AGGM).


                        
                        
                           
                           We propose two novel inference frameworks for unsupervised non-Gaussian feature selection.


                        
                        
                           
                           We have used these frameworks for action and facial expression recognition.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Unsupervised learning

Feature selection

Clustering

Asymmetric generalized Gaussian

Action recognition

Facial expression recognition

@&#ABSTRACT@&#


               
               
                  Clustering is the task of classifying patterns or observations into clusters or groups. Generally, clustering in high-dimensional feature spaces has a lot of complications such as: the unidentified or unknown data shape which is typically non-Gaussian and follows different distributions; the unknown number of clusters in the case of unsupervised learning; and the existence of noisy, redundant, or uninformative features which normally compromise modeling capabilities and speed. Therefore, high-dimensional data clustering has been a subject of extensive research in data mining, pattern recognition, image processing, computer vision, and other areas for several decades. However, most of existing researches tackle one or two problems at a time which is unrealistic because all problems are connected and should be tackled simultaneously. Thus, in this paper, we propose two novel inference frameworks for unsupervised non-Gaussian feature selection, in the context of finite asymmetric generalized Gaussian (AGG) mixture-based clustering. The choice of the AGG distribution is mainly due to its ability not only to approximate a large class of statistical distributions (e.g. impulsive, Laplacian, Gaussian and uniform distributions) but also to include the asymmetry. In addition, the two frameworks simultaneously perform model parameters estimation as well as model complexity (i.e., both model and feature selection) determination in the same step. This was done by incorporating a minimum message length (MML) penalty in the model learning step and by fading out the redundant densities in the mixture using the rival penalized EM (RPEM) algorithm, for first and second frameworks, respectively. Furthermore, for both algorithms, we tackle the problem of noisy and uninformative features by determining a set of relevant features for each data cluster. The efficiencies of the proposed algorithms are validated by applying them to real challenging problems namely action and facial expression recognition.
               
            

@&#INTRODUCTION@&#

Clustering, a common technique for statistical data analysis, is one of the most important tools to find a structure in a collection of unlabeled data. It is used to group items that seem to fall naturally together [1]. A cluster is therefore a collection of objects which are similar between them and are dissimilar to the objects belonging to other clusters. Lately, the problem of clustering data into homogeneous groups has been widely studied due to its significance in a variety of areas such as image processing, data mining, and computer vision. The vast majority of these approaches are distance-based algorithms which partition the data set into subsets according to some defined distance measure. However, these algorithms perform poorly on high-dimensional data because distances between points become more uniform [2]. Therefore, some subspace clustering approaches were introduced in order to address this concern. Though, these approaches make strong assumptions about the distributions of the data, and rely on heuristics to find clusters satisfying the assumptions [3]. Furthermore, in high-dimensional data sets, traditional clustering algorithms tend to break down both in terms of accuracy, as well as efficiency, so-called curse of dimensionality [4]. Here, we present an alternative algorithm based on finite mixture model designed especially for high-dimensional clustering that makes reasonable distributional assumptions and provides satisfying theoretical guarantees.

Finite mixture models provide a natural representation of heterogeneity in a finite number of latent classes by modeling a statistical unknown distribution by a weighted sum of other distributions. Thus, lately, finite mixture models have been widely used to provide a formal framework for clustering. However, there are several challenges that should be handled when using finite mixture models such as the choice of the statistical distribution that represents each group or cluster and the learning algorithm used for mixture's parameters estimation, the selection of the model order (i.e. number of clusters), and the number of relevant features in high dimensional data. The main objective of this paper is to sum up all these challenging interrelated problems in one unified model. In the field of finite mixtures, the mixture of Gaussians is generally used for its simplicity, nonetheless, it has been observed that the Gaussian distribution is unsuitable for modeling data in complex real life applications [5] and especially in the case of computer vision problems [6]. Therefore, in order to overcome the rigidity of the Gaussian distribution, researchers were encouraged to exploit various distributions such as the generalized Gaussian distribution (GGD). The GGD is a continuous probability distribution capable of modeling data with different shapes [7–9]. The GGD includes the Laplacian and the Gaussian as special cases as well as the uniform distribution as limiting case [10] and has been employed in many challenging problems (see, for instance [11–14]). Even with the higher flexibility that GGD offers, it is still a symmetric distribution inappropriate to model non-symmetrical data. In this article, we suggest the use of the asymmetric generalized Gaussian distribution (AGGD) capable of modeling non-Gaussian asymmetrical data [15]. The AGGD has two variance parameters for left and right parts of the distribution, which allow it not only to approximate a large class of statistical distributions (e.g. impulsive, Laplacian, Gaussian and uniform distributions) but also to include the asymmetry.

A standard method to learn finite mixture models is maximum likelihood which generally estimates the parameters through the expectation maximization (EM) framework. The EM algorithm enables us to update the mixture parameters with respect to a data set. In order to use the EM algorithm, an appropriate number of clusters should be predefined, otherwise, the EM algorithm will lead to a poor result. Thus, another important part of the mixture modeling problem concerns determining the number of consistent components which best describes the data. For this purpose, many approaches have been suggested for automatic selection of the number of clusters (see, for instance, [16–18]). Examples of selection criteria include Akaike information criterion (AIC) [19], minimum description length (MDL) [20] and Laplace empirical criterion (LEC) [21]. These criteria, however, may overestimate or underestimate the number of clusters. Furthermore, they are time-consuming and may lead to a sub-optimal solution because model selection and parameters estimations are determined in two separate steps. In our first algorithm, we propose a learning method that can integrate simultaneously parameter estimation and model selection by implementing MML criterion [22] into an EM algorithm [23].

In [24], the authors used another clustering method, Rival Penalized Competitive Learning (RPCL), which could detect the real number of clusters with little prior knowledge. In RPCL, the assigned number of clusters must be bigger than the true number of clusters, then, the algorithm can automatically select the correct cluster number by gradually driving extra seed points far away from the input data set. However, its performance is sensitive to the selection of the de-learning rate, such that if it is not well selected, the RPCL may completely break down. In order to overcome this problem, the Rival Penalized EM (RPEM) algorithm was proposed for density mixture clustering [25]. The RPEM learns the model parameters by making the mixture components compete with each other at each time step; this can be done by not only updating the winning density component parameters to adapt to the input but also all rivals parameters are penalized with the strength proportional to the corresponding posterior density probabilities. Therefore, the RPEM is able to automatically select an appropriate number of densities by fading out the redundant densities from a density mixture which can save the computing time. To the best of our knowledge, this is the first attempt to employ the RPEM algorithm for AGGM model selection and parameter learning.

Feature selection, the task of identifying relevant or discriminative features, represents an essential step in high-dimensional data clustering. This is actually an important step, since the main goal is not only the determination of clusters and their parameters but also to provide the most parsimonious model that can accurately describe the data [26,27]. Furthermore, feature selection can speed up learning and improve model accuracy and generalization. Therefore, the selection of relevant features in multidimensional data represents a major concern in several image processing, computer vision and pattern recognition applications such as object detection [28], handwriting separation [29], image retrieval, categorization and recognition [30]. However, the majority of research in mixture models assume that all features have the same weight and use a pre-processing step such as principal components analysis to transform the original features into a new dimension-reduced space. The main drawback of that approach is that the physical meaning of the original features is generally lost [31]. Moreover, the learning of the mixture parameters (i.e. both model selection and parameters estimation) is greatly affected by the quality of the features used as shown for instance in [32,33]) where the authors considered the Gaussian assumption by assuming diagonal covariance matrices for all clusters. The work of [34] proposed a new feature selection method using Markov Blanket capable of eliminating irrelevant and redundant features. They integrated feature selection with RPEM for Gaussian mixtures clustering. Therefore, data clustering, model learning and feature selection were performed in a single learning algorithm. In [35], a novel approach to combine clustering and feature selection by implementing a wrapper strategy for feature selection was presented. Thus, features were directly selected by optimizing the discriminative power of the used partitioning algorithm. The authors in [36] presented an algebraic approach to variable weighting by maximizing a score based on the spectral properties of the kernel matrix. This work presented a definition of relevancy based on spectral properties of the Laplacian of the features measurement matrix. Then, the feature selection process is based on a continuous ranking of the features defined by a least-squares optimization process. Zeng et al. [37] associated a weight to each feature or kernel and incorporated it into the built-in regularization of the Learning-Based Clustering (LLC) [38] algorithm to take into account the relevance of each feature or kernel for clustering. Their idea was that the resulting weighted regularization with an additional constraint on the weights is equivalent to a known sparse-promoting penalty. Hence, the weights of those irrelevant features or kernels can be shrunk toward zero. In this article, and following recent approaches (see, for instance [30,32]), we approach the feature selection problem in unsupervised learning by casting it as an estimation problem, thus avoiding any combinatorial search. For each feature, we associate a relevance weight which measures the degree of its dependence on class labels.

The remainder of the paper is structured as follows: In Section 2 we review the feature selection model based on the asymmetric generalized Gaussian mixture. In Section 3, we propose our first learning algorithm by implementing MML criterion into an EM algorithm. In Section 4, we integrate the concept of feature saliency into the RPEM algorithm for the AGGM model. In Section 5, we assess the performance of our approach for action and facial expression recognition; while comparing them to other state-of-the-art methods. Our last section is devoted to the conclusion and some perspectives.

Recently, finite mixture models have attracted a great deal of interest as a powerful framework for probabilistic inference and allow for reasoning with incomplete data. Let 
                        X
                        =
                        {
                        
                           
                              
                                 
                                    X
                                 
                                 
                                    →
                                 
                              
                           
                           
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              
                                 
                                    X
                                 
                                 
                                    →
                                 
                              
                           
                           
                              N
                           
                        
                        }
                      be a collection of N data points to be clustered, where each 
                        
                           
                              
                                 
                                    X
                                 
                                 
                                    →
                                 
                              
                           
                           
                              i
                           
                        
                        ∈
                        
                           
                              R
                           
                           
                              d
                           
                        
                     ; 
                        i
                        ∈
                        {
                        1
                        ,
                        …
                        ,
                        N
                        }
                     ; is a vector of d dimensions. We aim to fit the data points in 
                        X
                      by a mixture model with M clusters. In this article, we specify the conditional density function 
                        p
                        (
                        
                           
                              X
                           
                           
                              →
                           
                        
                        |
                        
                           
                              ξ
                           
                           
                              j
                           
                        
                        )
                      for each cluster j; 
                        j
                        ∈
                        {
                        1
                        ,
                        …
                        ,
                        M
                        }
                     ; to follow an asymmetric generalized Gaussian distribution as follows:
                        
                           (1)
                           
                              p
                              (
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              |
                              
                                 
                                    ξ
                                 
                                 
                                    j
                                 
                              
                              )
                              =
                              
                                 ∏
                                 
                                    k
                                    =
                                    1
                                 
                                 d
                              
                              
                                 
                                    
                                       
                                          β
                                       
                                       
                                          j
                                          k
                                       
                                    
                                    
                                       
                                          [
                                          
                                             
                                                Γ
                                                (
                                                3
                                                /
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      j
                                                      k
                                                   
                                                
                                                )
                                             
                                             
                                                Γ
                                                (
                                                1
                                                /
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      j
                                                      k
                                                   
                                                
                                                )
                                             
                                          
                                          ]
                                       
                                       
                                          1
                                          /
                                          2
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          σ
                                       
                                       
                                          
                                             
                                                l
                                             
                                             
                                                j
                                                k
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          σ
                                       
                                       
                                          
                                             
                                                r
                                             
                                             
                                                j
                                                k
                                             
                                          
                                       
                                    
                                    )
                                    Γ
                                    (
                                    1
                                    /
                                    
                                       
                                          β
                                       
                                       
                                          j
                                          k
                                       
                                    
                                    )
                                 
                              
                              
                                 {
                                 
                                    
                                       
                                          exp
                                          ⁡
                                          [
                                          −
                                          A
                                          (
                                          
                                             
                                                β
                                             
                                             
                                                j
                                                k
                                             
                                          
                                          )
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            μ
                                                         
                                                         
                                                            j
                                                            k
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            i
                                                            k
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         
                                                            
                                                               l
                                                            
                                                            
                                                               j
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      j
                                                      k
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                       
                                          if
                                          
                                          
                                             
                                                X
                                             
                                             
                                                i
                                                k
                                             
                                          
                                          <
                                          
                                             
                                                μ
                                             
                                             
                                                j
                                                k
                                             
                                          
                                       
                                    
                                    
                                       
                                          exp
                                          ⁡
                                          [
                                          −
                                          A
                                          (
                                          
                                             
                                                β
                                             
                                             
                                                j
                                                k
                                             
                                          
                                          )
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            i
                                                            k
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            μ
                                                         
                                                         
                                                            j
                                                            k
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         
                                                            
                                                               r
                                                            
                                                            
                                                               j
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      j
                                                      k
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                       
                                          if
                                          
                                          
                                             
                                                X
                                             
                                             
                                                i
                                                k
                                             
                                          
                                          ≥
                                          
                                             
                                                μ
                                             
                                             
                                                j
                                                k
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                      where 
                        A
                        (
                        
                           
                              β
                           
                           
                              j
                              k
                           
                        
                        )
                        =
                        
                           
                              [
                              
                                 
                                    Γ
                                    (
                                    3
                                    /
                                    
                                       
                                          β
                                       
                                       
                                          j
                                          k
                                       
                                    
                                    )
                                 
                                 
                                    Γ
                                    (
                                    1
                                    /
                                    
                                       
                                          β
                                       
                                       
                                          j
                                          k
                                       
                                    
                                    )
                                 
                              
                              ]
                           
                           
                              
                                 
                                    β
                                 
                                 
                                    j
                                    k
                                 
                              
                              /
                              2
                           
                        
                     ; 
                        
                           
                              ξ
                           
                           
                              j
                           
                        
                        =
                        {
                        
                           
                              
                                 
                                    μ
                                 
                                 
                                    →
                                 
                              
                           
                           
                              j
                           
                        
                        ,
                        
                           
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          l
                                       
                                    
                                 
                                 
                                    →
                                 
                              
                           
                           
                              j
                           
                        
                        ,
                        
                           
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          r
                                       
                                    
                                 
                                 
                                    →
                                 
                              
                           
                           
                              j
                           
                        
                        ,
                        
                           
                              
                                 
                                    β
                                 
                                 
                                    →
                                 
                              
                           
                           
                              j
                           
                        
                        }
                     ; 
                        
                           
                              
                                 
                                    μ
                                 
                                 
                                    →
                                 
                              
                           
                           
                              j
                           
                        
                        =
                        (
                        
                           
                              μ
                           
                           
                              j
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              μ
                           
                           
                              j
                              d
                           
                        
                        )
                     , 
                        
                           
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          l
                                       
                                    
                                 
                                 
                                    →
                                 
                              
                           
                           
                              j
                           
                        
                        =
                        (
                        
                           
                              σ
                           
                           
                              
                                 
                                    l
                                 
                                 
                                    j
                                    1
                                 
                              
                           
                        
                        ,
                        …
                        ,
                        
                           
                              σ
                           
                           
                              
                                 
                                    l
                                 
                                 
                                    j
                                    d
                                 
                              
                           
                        
                        )
                     , and 
                        
                           
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          r
                                       
                                    
                                 
                                 
                                    →
                                 
                              
                           
                           
                              j
                           
                        
                        =
                        (
                        
                           
                              σ
                           
                           
                              
                                 
                                    r
                                 
                                 
                                    j
                                    1
                                 
                              
                           
                        
                        ,
                        …
                        ,
                        
                           
                              σ
                           
                           
                              
                                 
                                    r
                                 
                                 
                                    j
                                    d
                                 
                              
                           
                        
                        )
                      are the mean, the left standard deviation, and the right standard deviation of the d-dimensional AGGD, respectively. The parameter 
                        
                           
                              
                                 
                                    β
                                 
                                 
                                    →
                                 
                              
                           
                           
                              j
                           
                        
                        =
                        (
                        
                           
                              β
                           
                           
                              j
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              β
                           
                           
                              j
                              d
                           
                        
                        )
                      controls the tails of the pdf and determines whether it is peaked or flat: the larger the value of 
                        
                           
                              
                                 
                                    β
                                 
                                 
                                    →
                                 
                              
                           
                           
                              j
                           
                        
                     , the flatter the pdf, and the smaller 
                        
                           
                              
                                 
                                    β
                                 
                                 
                                    →
                                 
                              
                           
                           
                              j
                           
                        
                      is, the more peaked the pdf. The AGGD is chosen to be able to fit, in analytically simple and realistic way, symmetric or non-symmetric data by the combination of the left and right variances. Furthermore, the asymmetric Generalized Gaussian distribution (AGGD) can be reduced to the Generalized Gaussian distribution (GGD), the Laplace distribution (LD) as well as the Gaussian distribution (GD) as explained in Appendix A.

Here, we assume that each vector follows a mixture of asymmetric generalized Gaussian distributions:
                        
                           (2)
                           
                              p
                              (
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              |
                              Θ
                              )
                              =
                              
                                 ∑
                                 
                                    j
                                    =
                                    1
                                 
                                 M
                              
                              p
                              (
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              |
                              
                                 
                                    ξ
                                 
                                 
                                    j
                                 
                              
                              )
                              
                                 
                                    p
                                 
                                 
                                    j
                                 
                              
                           
                        
                      where 
                        
                           
                              p
                           
                           
                              j
                           
                        
                      are the mixing proportions which must be positive and sum to one and the set of parameters of the mixture with M classes is defined by 
                        Θ
                        =
                        (
                        
                           
                              
                                 
                                    μ
                                 
                                 
                                    →
                                 
                              
                           
                           
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              
                                 
                                    μ
                                 
                                 
                                    →
                                 
                              
                           
                           
                              M
                           
                        
                        ,
                        
                           
                              
                                 
                                    β
                                 
                                 
                                    →
                                 
                              
                           
                           
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              
                                 
                                    β
                                 
                                 
                                    →
                                 
                              
                           
                           
                              M
                           
                        
                        ,
                        
                           
                              
                                 
                                    σ
                                 
                                 
                                    →
                                 
                              
                           
                           
                              
                                 
                                    l
                                 
                                 
                                    1
                                 
                              
                           
                        
                        ,
                        …
                        ,
                        
                           
                              
                                 
                                    σ
                                 
                                 
                                    →
                                 
                              
                           
                           
                              
                                 
                                    l
                                 
                                 
                                    M
                                 
                              
                           
                        
                        ,
                        
                           
                              
                                 
                                    σ
                                 
                                 
                                    →
                                 
                              
                           
                           
                              
                                 
                                    r
                                 
                                 
                                    1
                                 
                              
                           
                        
                        ,
                        …
                        ,
                        
                           
                              
                                 
                                    σ
                                 
                                 
                                    →
                                 
                              
                           
                           
                              
                                 
                                    r
                                 
                                 
                                    M
                                 
                              
                           
                        
                        ,
                        
                           
                              p
                           
                           
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              p
                           
                           
                              M
                           
                        
                        )
                     . Thus, the likelihood corresponding to this case is:
                        
                           (3)
                           
                              p
                              (
                              X
                              |
                              Θ
                              )
                              =
                              
                                 ∏
                                 
                                    i
                                    =
                                    1
                                 
                                 N
                              
                              
                                 ∑
                                 
                                    j
                                    =
                                    1
                                 
                                 M
                              
                              p
                              (
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              |
                              
                                 
                                    ξ
                                 
                                 
                                    j
                                 
                              
                              )
                              
                                 
                                    p
                                 
                                 
                                    j
                                 
                              
                           
                        
                      For each variable 
                        
                           
                              
                                 
                                    X
                                 
                                 
                                    →
                                 
                              
                           
                           
                              i
                           
                        
                     , let 
                        
                           
                              Z
                           
                           
                              i
                           
                        
                      be an M dimensional vector known by the unobserved or missing vector that indicates to which component 
                        
                           
                              
                                 
                                    X
                                 
                                 
                                    →
                                 
                              
                           
                           
                              i
                           
                        
                      belongs, such that: 
                        
                           
                              Z
                           
                           
                              i
                              j
                           
                        
                      will be equal to 1 if 
                        
                           
                              
                                 
                                    X
                                 
                                 
                                    →
                                 
                              
                           
                           
                              i
                           
                        
                      belongs to class j or 0, otherwise. The complete-data likelihood is then
                        
                           (4)
                           
                              p
                              (
                              X
                              ,
                              Z
                              |
                              Θ
                              )
                              =
                              
                                 ∏
                                 
                                    i
                                    =
                                    1
                                 
                                 N
                              
                              
                                 ∏
                                 
                                    j
                                    =
                                    1
                                 
                                 M
                              
                              
                                 
                                    (
                                    
                                       
                                          p
                                       
                                       
                                          j
                                       
                                    
                                    p
                                    (
                                    
                                       
                                          
                                             
                                                X
                                             
                                             
                                                →
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    
                                       
                                          ξ
                                       
                                       
                                          j
                                       
                                    
                                    )
                                    )
                                 
                                 
                                    
                                       
                                          Z
                                       
                                       
                                          i
                                          j
                                       
                                    
                                 
                              
                           
                        
                      Note that Eq. (2) assumes that the d features have equal importance and carry pertinent information which is not usually the case, since many of which can be irrelevant for the intended application [39–42]. We approach this problem by assuming that irrelevant features follow a background Gaussian distribution with parameter 
                        
                           
                              λ
                           
                           
                              →
                           
                        
                        =
                        {
                        
                           
                              η
                           
                           
                              →
                           
                        
                        ,
                        
                           
                              δ
                           
                           
                              →
                           
                        
                        }
                      for all classes, where 
                        
                           
                              η
                           
                           
                              →
                           
                        
                      and 
                        
                           
                              δ
                           
                           
                              →
                           
                        
                      represent the mean and standard deviation of the Gaussian distribution, respectively. We adopt the feature relevancy approach suggested in [32], because it is suitable for unsupervised learning.

The main idea is to consider the 
                        k
                        th
                      feature as irrelevant if its distribution is independent of the class labels and can follow our common Gaussian density 
                        p
                        (
                        
                           
                              X
                           
                           
                              k
                           
                        
                        |
                        
                           
                              λ
                           
                           
                              k
                           
                        
                        )
                     . Then, the mixture density in Eq. (2) can be written as:
                        
                           (5)
                           
                              p
                              (
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              |
                              Θ
                              ,
                              
                                 
                                    λ
                                 
                                 
                                    →
                                 
                              
                              ,
                              
                                 
                                    φ
                                 
                                 
                                    →
                                 
                              
                              )
                              =
                              
                                 ∑
                                 
                                    j
                                    =
                                    1
                                 
                                 M
                              
                              
                                 
                                    p
                                 
                                 
                                    j
                                 
                              
                              
                                 ∏
                                 
                                    k
                                    =
                                    1
                                 
                                 d
                              
                              p
                              (
                              
                                 
                                    X
                                 
                                 
                                    i
                                    k
                                 
                              
                              
                                 
                                    |
                                    
                                       
                                          ξ
                                       
                                       
                                          j
                                          k
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          φ
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                              p
                              (
                              
                                 
                                    X
                                 
                                 
                                    i
                                    k
                                 
                              
                              
                                 
                                    |
                                    
                                       
                                          λ
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 
                                    1
                                    −
                                    
                                       
                                          φ
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                           
                        
                      where 
                        
                           
                              φ
                           
                           
                              →
                           
                        
                        =
                        (
                        
                           
                              φ
                           
                           
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              φ
                           
                           
                              d
                           
                        
                        )
                      is a set of binary parameters, such that 
                        
                           
                              φ
                           
                           
                              k
                           
                        
                        =
                        1
                      if the 
                        k
                        th
                      feature is relevant and 
                        
                           
                              φ
                           
                           
                              k
                           
                        
                        =
                        0
                      otherwise. Note that, 
                        
                           
                              φ
                           
                           
                              →
                           
                        
                      can be considered as missing variables. By assuming that all 
                        
                           
                              φ
                           
                           
                              k
                           
                        
                        s
                      are mutually independent and independent of the hidden component label Z, then:
                        
                           (6)
                           
                              p
                              (
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    φ
                                 
                                 
                                    →
                                 
                              
                              )
                              =
                              p
                              (
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              |
                              
                                 
                                    φ
                                 
                                 
                                    →
                                 
                              
                              )
                              p
                              (
                              
                                 
                                    φ
                                 
                                 
                                    →
                                 
                              
                              )
                              =
                              (
                              
                                 ∑
                                 
                                    j
                                    =
                                    1
                                 
                                 M
                              
                              
                                 
                                    p
                                 
                                 
                                    j
                                 
                              
                              
                                 ∏
                                 
                                    k
                                    =
                                    1
                                 
                                 d
                              
                              p
                              (
                              
                                 
                                    X
                                 
                                 
                                    i
                                    k
                                 
                              
                              
                                 
                                    |
                                    
                                       
                                          ξ
                                       
                                       
                                          j
                                          k
                                       
                                    
                                    )
                                 
                                 
                                    
                                       
                                          φ
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                              p
                              (
                              
                                 
                                    X
                                 
                                 
                                    i
                                    k
                                 
                              
                              
                                 
                                    |
                                    
                                       
                                          λ
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 
                                    1
                                    −
                                    
                                       
                                          φ
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                              )
                              (
                              
                                 ∏
                                 
                                    k
                                    =
                                    1
                                 
                                 d
                              
                              
                                 
                                    ω
                                 
                                 
                                    k
                                 
                                 
                                    
                                       
                                          φ
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                              
                                 
                                    (
                                    1
                                    −
                                    
                                       
                                          ω
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 
                                    (
                                    1
                                    −
                                    
                                       
                                          φ
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                              
                              )
                              =
                              
                                 ∑
                                 
                                    j
                                    =
                                    1
                                 
                                 M
                              
                              
                                 
                                    p
                                 
                                 
                                    j
                                 
                              
                              
                                 ∏
                                 
                                    k
                                    =
                                    1
                                 
                                 d
                              
                              
                                 
                                    (
                                    
                                       
                                          ω
                                       
                                       
                                          k
                                       
                                    
                                    p
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          i
                                          k
                                       
                                    
                                    |
                                    
                                       
                                          ξ
                                       
                                       
                                          j
                                          k
                                       
                                    
                                    )
                                    )
                                 
                                 
                                    
                                       
                                          φ
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                              
                                 
                                    (
                                    (
                                    1
                                    −
                                    
                                       
                                          ω
                                       
                                       
                                          k
                                       
                                    
                                    )
                                    p
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          i
                                          k
                                       
                                    
                                    |
                                    
                                       
                                          λ
                                       
                                       
                                          k
                                       
                                    
                                    )
                                    )
                                 
                                 
                                    (
                                    1
                                    −
                                    
                                       
                                          φ
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                              
                           
                        
                      Marginalizing over φ we get [32]:
                        
                           (7)
                           
                              p
                              (
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              |
                              
                                 
                                    Θ
                                 
                                 
                                    M
                                 
                              
                              )
                              =
                              
                                 ∑
                                 φ
                              
                              p
                              (
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    φ
                                 
                                 
                                    →
                                 
                              
                              )
                              =
                              
                                 ∑
                                 
                                    j
                                    =
                                    1
                                 
                                 M
                              
                              
                                 
                                    p
                                 
                                 
                                    j
                                 
                              
                              
                                 ∏
                                 
                                    k
                                    =
                                    1
                                 
                                 d
                              
                              
                                 ∑
                                 
                                    
                                       
                                          φ
                                       
                                       
                                          k
                                       
                                    
                                    =
                                    0
                                 
                                 1
                              
                              
                                 
                                    (
                                    
                                       
                                          ω
                                       
                                       
                                          k
                                       
                                    
                                    p
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          i
                                          k
                                       
                                    
                                    |
                                    
                                       
                                          ξ
                                       
                                       
                                          j
                                          k
                                       
                                    
                                    )
                                    )
                                 
                                 
                                    
                                       
                                          φ
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                              
                                 
                                    (
                                    (
                                    1
                                    −
                                    
                                       
                                          ω
                                       
                                       
                                          k
                                       
                                    
                                    )
                                    p
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          i
                                          k
                                       
                                    
                                    |
                                    
                                       
                                          λ
                                       
                                       
                                          k
                                       
                                    
                                    )
                                    )
                                 
                                 
                                    (
                                    1
                                    −
                                    
                                       
                                          φ
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                              
                              =
                              
                                 ∑
                                 
                                    j
                                    =
                                    1
                                 
                                 M
                              
                              
                                 
                                    p
                                 
                                 
                                    j
                                 
                              
                              
                                 ∏
                                 
                                    k
                                    =
                                    1
                                 
                                 d
                              
                              [
                              
                                 
                                    ω
                                 
                                 
                                    k
                                 
                              
                              p
                              (
                              
                                 
                                    X
                                 
                                 
                                    i
                                    k
                                 
                              
                              |
                              
                                 
                                    ξ
                                 
                                 
                                    j
                                    k
                                 
                              
                              )
                              +
                              (
                              1
                              −
                              
                                 
                                    ω
                                 
                                 
                                    k
                                 
                              
                              )
                              p
                              (
                              
                                 
                                    X
                                 
                                 
                                    i
                                    k
                                 
                              
                              |
                              
                                 
                                    λ
                                 
                                 
                                    k
                                 
                              
                              )
                              ]
                           
                        
                      where 
                        
                           
                              Θ
                           
                           
                              M
                           
                        
                        =
                        {
                        Θ
                        ,
                        
                           
                              ω
                           
                           
                              →
                           
                        
                        ,
                        
                           
                              λ
                           
                           
                              →
                           
                        
                        }
                      is the complete set of parameters fully characterizing the mixture. We suppose that not all the features of an observation are important, through the weight relevancy of these features. That is, the weight is denoted as 
                        ω
                        =
                        (
                        
                           
                              ω
                           
                           
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              ω
                           
                           
                              d
                           
                        
                        )
                      with 
                        0
                        ≤
                        
                           
                              ω
                           
                           
                              k
                           
                        
                        ≤
                        1
                     , where 
                        
                           
                              ω
                           
                           
                              k
                           
                        
                      represents the probability that the 
                        k
                        th
                      feature is relevant to all the clusters 
                        (
                        
                           
                              ω
                           
                           
                              k
                           
                        
                        =
                        p
                        (
                        
                           
                              φ
                           
                           
                              k
                           
                        
                        =
                        1
                        )
                        )
                     .

In the following, we present our first unsupervised learning approach for simultaneous clustering and feature selection. In particular, we propose an approach to find the optimal number of model components using MML and to estimate the different parameters using EM.

In this section, we develop the equations that learn the parameters of the AGGM while simultaneously consider the relevancy of features. To achieve this goal, we adopt common EM approach which generates a sequence of models with non-decreasing log-likelihood on the data. First, we suppose that the number of components M is known. The maximum likelihood method consists of getting the mixture parameters that maximize the log-likelihood function given by:
                           
                              (8)
                              
                                 L
                                 (
                                 X
                                 ,
                                 
                                    
                                       Θ
                                    
                                    
                                       M
                                    
                                 
                                 ,
                                 Z
                                 ,
                                 φ
                                 )
                                 =
                                 
                                    ∑
                                    
                                       i
                                       ,
                                       j
                                       ,
                                       φ
                                    
                                 
                                 p
                                 (
                                 
                                    
                                       Z
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 j
                                 ,
                                 φ
                                 |
                                 
                                    
                                       
                                          
                                             X
                                          
                                          
                                             →
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 {
                                 log
                                 ⁡
                                 
                                    
                                       p
                                    
                                    
                                       j
                                    
                                 
                                 +
                                 
                                    ∑
                                    k
                                 
                                 (
                                 
                                    
                                       φ
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 log
                                 ⁡
                                 p
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       i
                                       k
                                    
                                 
                                 |
                                 
                                    
                                       ξ
                                    
                                    
                                       j
                                       k
                                    
                                 
                                 )
                                 +
                                 log
                                 ⁡
                                 
                                    
                                       w
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 +
                                 (
                                 1
                                 −
                                 
                                    
                                       φ
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 (
                                 log
                                 ⁡
                                 p
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       i
                                       k
                                    
                                 
                                 |
                                 
                                    
                                       λ
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 +
                                 log
                                 ⁡
                                 (
                                 1
                                 −
                                 
                                    
                                       w
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 )
                                 )
                                 }
                                 =
                                 
                                    ∑
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 p
                                 (
                                 
                                    
                                       Z
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 j
                                 |
                                 
                                    
                                       
                                          
                                             X
                                          
                                          
                                             →
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 log
                                 ⁡
                                 
                                    
                                       p
                                    
                                    
                                       j
                                    
                                 
                                 +
                                 
                                    ∑
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 
                                    ∑
                                    k
                                 
                                 
                                    ∑
                                    
                                       
                                          
                                             φ
                                          
                                          
                                             k
                                          
                                       
                                       =
                                       0
                                    
                                    1
                                 
                                 p
                                 (
                                 
                                    
                                       Z
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 j
                                 ,
                                 
                                    
                                       φ
                                    
                                    
                                       k
                                    
                                 
                                 |
                                 
                                    
                                       
                                          
                                             X
                                          
                                          
                                             →
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 (
                                 
                                    
                                       φ
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 log
                                 ⁡
                                 p
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       i
                                       k
                                    
                                 
                                 |
                                 
                                    
                                       ξ
                                    
                                    
                                       j
                                       k
                                    
                                 
                                 )
                                 +
                                 log
                                 ⁡
                                 
                                    
                                       w
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 +
                                 (
                                 1
                                 −
                                 
                                    
                                       φ
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 (
                                 log
                                 ⁡
                                 p
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       i
                                       k
                                    
                                 
                                 |
                                 
                                    
                                       λ
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 +
                                 log
                                 ⁡
                                 (
                                 1
                                 −
                                 
                                    
                                       w
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 )
                                 )
                              
                           
                         Thus, following [32], the EM algorithm for parameter estimation can be given by:
                           
                              •
                              
                                 Expectation step:
                                 
                                    
                                       (9)
                                       
                                          
                                             
                                                ζ
                                             
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                          =
                                          
                                             
                                                ω
                                             
                                             
                                                k
                                             
                                          
                                          p
                                          (
                                          
                                             
                                                X
                                             
                                             
                                                i
                                                k
                                             
                                          
                                          |
                                          
                                             
                                                ξ
                                             
                                             
                                                j
                                                k
                                             
                                          
                                          )
                                          +
                                          (
                                          1
                                          −
                                          
                                             
                                                ω
                                             
                                             
                                                k
                                             
                                          
                                          )
                                          p
                                          (
                                          
                                             
                                                X
                                             
                                             
                                                i
                                                k
                                             
                                          
                                          |
                                          
                                             
                                                λ
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                    
                                 
                                 
                                    
                                       (10)
                                       
                                          h
                                          (
                                          j
                                          |
                                          
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      →
                                                   
                                                
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                Θ
                                             
                                             
                                                M
                                             
                                          
                                          )
                                          =
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      j
                                                   
                                                
                                                
                                                   
                                                      ∏
                                                   
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                   
                                                      d
                                                   
                                                
                                                
                                                   
                                                      ζ
                                                   
                                                   
                                                      i
                                                      j
                                                      k
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      j
                                                      =
                                                      1
                                                   
                                                   
                                                      M
                                                   
                                                
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      j
                                                   
                                                
                                                
                                                   
                                                      ∏
                                                   
                                                   
                                                      k
                                                      =
                                                      1
                                                   
                                                   
                                                      d
                                                   
                                                
                                                
                                                   
                                                      ζ
                                                   
                                                   
                                                      i
                                                      j
                                                      k
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              


                                 Maximization step:
                                 
                                    
                                       (11)
                                       
                                          
                                             
                                                p
                                             
                                             
                                                j
                                             
                                             
                                                new
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      N
                                                   
                                                
                                                h
                                                (
                                                j
                                                |
                                                
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            →
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   
                                                      Θ
                                                   
                                                   
                                                      M
                                                   
                                                
                                                )
                                             
                                             N
                                          
                                       
                                    
                                 
                                 
                                    
                                       (12)
                                       
                                          
                                             
                                                μ
                                             
                                             
                                                j
                                                k
                                             
                                             
                                                new
                                             
                                          
                                          =
                                          
                                             
                                                μ
                                             
                                             
                                                j
                                                k
                                             
                                             
                                                old
                                             
                                          
                                          −
                                          [
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      L
                                                      (
                                                      X
                                                      ,
                                                      
                                                         
                                                            Θ
                                                         
                                                         
                                                            M
                                                         
                                                      
                                                      ,
                                                      Z
                                                      ,
                                                      φ
                                                      )
                                                   
                                                   
                                                      ∂
                                                      
                                                         
                                                            μ
                                                         
                                                         
                                                            j
                                                            k
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          (
                                          
                                             
                                                ∂
                                                L
                                                (
                                                X
                                                ,
                                                
                                                   
                                                      Θ
                                                   
                                                   
                                                      M
                                                   
                                                
                                                ,
                                                Z
                                                ,
                                                φ
                                                )
                                             
                                             
                                                ∂
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      j
                                                      k
                                                   
                                                
                                             
                                          
                                          )
                                          ]
                                       
                                    
                                 
                                 
                                    
                                       (13)
                                       
                                          
                                             
                                                β
                                             
                                             
                                                j
                                                k
                                             
                                             
                                                new
                                             
                                          
                                          =
                                          
                                             
                                                β
                                             
                                             
                                                j
                                                k
                                             
                                             
                                                old
                                             
                                          
                                          −
                                          [
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      L
                                                      (
                                                      X
                                                      ,
                                                      
                                                         
                                                            Θ
                                                         
                                                         
                                                            M
                                                         
                                                      
                                                      ,
                                                      Z
                                                      ,
                                                      φ
                                                      )
                                                   
                                                   
                                                      ∂
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            j
                                                            k
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          (
                                          
                                             
                                                ∂
                                                L
                                                (
                                                X
                                                ,
                                                
                                                   
                                                      Θ
                                                   
                                                   
                                                      M
                                                   
                                                
                                                ,
                                                Z
                                                ,
                                                φ
                                                )
                                             
                                             
                                                ∂
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      j
                                                      k
                                                   
                                                
                                             
                                          
                                          )
                                          ]
                                       
                                    
                                 
                                 
                                    
                                       (14)
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      j
                                                      k
                                                   
                                                
                                             
                                             
                                                new
                                             
                                          
                                          =
                                          
                                             
                                                σ
                                             
                                             
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      j
                                                      k
                                                   
                                                
                                             
                                             
                                                old
                                             
                                          
                                          −
                                          [
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      L
                                                      (
                                                      X
                                                      ,
                                                      
                                                         
                                                            Θ
                                                         
                                                         
                                                            M
                                                         
                                                      
                                                      ,
                                                      Z
                                                      ,
                                                      φ
                                                      )
                                                   
                                                   
                                                      ∂
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            
                                                               
                                                                  l
                                                               
                                                               
                                                                  j
                                                                  k
                                                               
                                                            
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          (
                                          
                                             
                                                ∂
                                                L
                                                (
                                                X
                                                ,
                                                
                                                   
                                                      Θ
                                                   
                                                   
                                                      M
                                                   
                                                
                                                ,
                                                Z
                                                ,
                                                φ
                                                )
                                             
                                             
                                                ∂
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            j
                                                            k
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          )
                                          ]
                                       
                                    
                                 
                                 
                                    
                                       (15)
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      j
                                                      k
                                                   
                                                
                                             
                                             
                                                new
                                             
                                          
                                          =
                                          
                                             
                                                σ
                                             
                                             
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      j
                                                      k
                                                   
                                                
                                             
                                             
                                                old
                                             
                                          
                                          −
                                          [
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            ∂
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      L
                                                      (
                                                      X
                                                      ,
                                                      
                                                         
                                                            Θ
                                                         
                                                         
                                                            M
                                                         
                                                      
                                                      ,
                                                      Z
                                                      ,
                                                      φ
                                                      )
                                                   
                                                   
                                                      ∂
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            
                                                               
                                                                  r
                                                               
                                                               
                                                                  j
                                                                  k
                                                               
                                                            
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          (
                                          
                                             
                                                ∂
                                                L
                                                (
                                                X
                                                ,
                                                
                                                   
                                                      Θ
                                                   
                                                   
                                                      M
                                                   
                                                
                                                ,
                                                Z
                                                ,
                                                φ
                                                )
                                             
                                             
                                                ∂
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            j
                                                            k
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          )
                                          ]
                                       
                                    
                                 
                                 
                                    
                                       (16)
                                       
                                          
                                             
                                                η
                                             
                                             
                                                k
                                             
                                             
                                                new
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      N
                                                   
                                                
                                                [
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      j
                                                      =
                                                      1
                                                   
                                                   
                                                      M
                                                   
                                                
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      i
                                                      j
                                                      k
                                                   
                                                
                                                h
                                                (
                                                j
                                                |
                                                
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            →
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   
                                                      Θ
                                                   
                                                   
                                                      M
                                                   
                                                
                                                )
                                                ]
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      i
                                                      k
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      N
                                                   
                                                
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      j
                                                      =
                                                      1
                                                   
                                                   
                                                      M
                                                   
                                                
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      i
                                                      j
                                                      k
                                                   
                                                
                                                h
                                                (
                                                j
                                                |
                                                
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            →
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   
                                                      Θ
                                                   
                                                   
                                                      M
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       (17)
                                       
                                          
                                             
                                                δ
                                             
                                             
                                                k
                                             
                                             
                                                
                                                   
                                                      2
                                                   
                                                   
                                                      new
                                                   
                                                
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      N
                                                   
                                                
                                                [
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      j
                                                      =
                                                      1
                                                   
                                                   
                                                      M
                                                   
                                                
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      i
                                                      j
                                                      k
                                                   
                                                
                                                h
                                                (
                                                j
                                                |
                                                
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            →
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   
                                                      Θ
                                                   
                                                   
                                                      M
                                                   
                                                
                                                )
                                                ]
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            i
                                                            k
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            η
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      N
                                                   
                                                
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      j
                                                      =
                                                      1
                                                   
                                                   
                                                      M
                                                   
                                                
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      i
                                                      j
                                                      k
                                                   
                                                
                                                h
                                                (
                                                j
                                                |
                                                
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            →
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   
                                                      Θ
                                                   
                                                   
                                                      M
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       (18)
                                       
                                          
                                             
                                                ω
                                             
                                             
                                                k
                                             
                                             
                                                new
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      N
                                                   
                                                
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      j
                                                      =
                                                      1
                                                   
                                                   
                                                      M
                                                   
                                                
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      i
                                                      j
                                                      k
                                                   
                                                
                                                h
                                                (
                                                j
                                                |
                                                
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            →
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   
                                                      Θ
                                                   
                                                   
                                                      M
                                                   
                                                
                                                )
                                             
                                             N
                                          
                                       
                                    
                                 
                              

Usually, the maximum likelihood estimate favors higher values for M which leads to overfitting. Thus, a model selection criterion is needed to estimate the number of components in a mixture model. The MML is a model selection technique based on information theory that is used to evaluate statistical models according to their ability to compress a message containing the data. Its basic idea is to find a model that minimizes the total length of a two-part message, where the first part encodes the model using only prior information about the model and no information about the data and the second part encodes only the data in a way that makes use of the model encoded in the first part. Therefore, in the case of MML, the optimal number of classes in the mixture is obtained by minimizing the following cost function [22,23]:
                           
                              (19)
                              
                                 
                                    MessLens
                                 
                                 ≈
                                 −
                                 log
                                 ⁡
                                 p
                                 (
                                 
                                    
                                       Θ
                                    
                                    
                                       M
                                    
                                 
                                 )
                                 +
                                 
                                    c
                                    2
                                 
                                 (
                                 1
                                 +
                                 log
                                 ⁡
                                 
                                    1
                                    12
                                 
                                 )
                                 +
                                 
                                    1
                                    2
                                 
                                 log
                                 ⁡
                                 |
                                 I
                                 (
                                 
                                    
                                       Θ
                                    
                                    
                                       M
                                    
                                 
                                 )
                                 |
                                 −
                                 log
                                 ⁡
                                 p
                                 (
                                 X
                                 |
                                 
                                    
                                       Θ
                                    
                                    
                                       M
                                    
                                 
                                 )
                              
                           
                         where 
                           p
                           (
                           
                              
                                 θ
                              
                              
                                 M
                              
                           
                           )
                        , 
                           I
                           (
                           
                              
                                 Θ
                              
                              
                                 M
                              
                           
                           )
                        , and 
                           p
                           (
                           X
                           |
                           
                              
                                 θ
                              
                              
                                 M
                              
                           
                           )
                         denote the prior distribution, the Fisher information matrix, and the likelihood, respectively. The constant 
                           c
                           =
                           M
                           +
                           d
                           +
                           4
                           d
                           M
                           +
                           2
                           d
                         represents the total number of parameters, and 
                           |
                           .
                           |
                         denotes the determinant. Note that the information matrix of the model is very difficult to obtain analytically, therefore, we assume the independence of the different groups of parameters, which allows the factorization of both 
                           p
                           (
                           
                              
                                 Θ
                              
                              
                                 M
                              
                           
                           )
                         and 
                           |
                           I
                           (
                           
                              
                                 Θ
                              
                              
                                 M
                              
                           
                           )
                           |
                        . Furthermore, we approximate the Fisher information 
                           |
                           I
                           (
                           
                              
                                 Θ
                              
                              
                                 M
                              
                           
                           )
                           |
                         using the complete likelihood which assumes labeled observations. Additionally, since we have no knowledge about the parameters, we adopt the uninformative Jeffrey's prior for each group of parameters as prior distribution. From this, we obtain the following MML objective:
                           
                              (20)
                              
                                 
                                    MessLens
                                 
                                 ≈
                                 
                                    c
                                    2
                                 
                                 (
                                 1
                                 +
                                 log
                                 ⁡
                                 
                                    1
                                    12
                                 
                                 )
                                 +
                                 
                                    c
                                    2
                                 
                                 (
                                 log
                                 ⁡
                                 N
                                 )
                                 +
                                 2
                                 M
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    d
                                 
                                 log
                                 ⁡
                                 
                                    
                                       ω
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 2
                                 d
                                 
                                    ∑
                                    
                                       j
                                       =
                                       1
                                    
                                    M
                                 
                                 log
                                 ⁡
                                 
                                    
                                       p
                                    
                                    
                                       j
                                    
                                 
                                 +
                                 
                                    ∑
                                    
                                       k
                                       =
                                       1
                                    
                                    d
                                 
                                 log
                                 ⁡
                                 (
                                 1
                                 −
                                 
                                    
                                       ω
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 −
                                 log
                                 ⁡
                                 p
                                 (
                                 X
                                 |
                                 
                                    
                                       θ
                                    
                                    
                                       M
                                    
                                 
                                 )
                              
                           
                         which we minimize under the constraints 
                           0
                           <
                           
                              
                                 p
                              
                              
                                 j
                              
                           
                           ≤
                           1
                        , 
                           0
                           <
                           
                              
                                 ω
                              
                              
                                 k
                              
                           
                           ≤
                           1
                        , and 
                           
                              
                                 ∑
                              
                              
                                 j
                                 =
                                 1
                              
                              
                                 M
                              
                           
                           
                              
                                 p
                              
                              
                                 j
                              
                           
                           =
                           1
                         in a manner similar to [32]. In order to use the MML approach the EM algorithm undergoes a minor modification in the calculation of the mixing proportions 
                           
                              
                                 p
                              
                              
                                 j
                              
                           
                         and the feature relevancy 
                           
                              
                                 ω
                              
                              
                                 k
                              
                           
                        :
                           
                              (21)
                              
                                 
                                    
                                       p
                                    
                                    
                                       j
                                    
                                    
                                       new
                                    
                                 
                                 =
                                 
                                    
                                       max
                                       ⁡
                                       (
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             N
                                          
                                       
                                       h
                                       (
                                       j
                                       |
                                       
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   →
                                                
                                             
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             Θ
                                          
                                          
                                             M
                                          
                                       
                                       )
                                       −
                                       2
                                       d
                                       ,
                                       0
                                       )
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             M
                                          
                                       
                                       max
                                       ⁡
                                       (
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             N
                                          
                                       
                                       h
                                       (
                                       j
                                       |
                                       
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   →
                                                
                                             
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             Θ
                                          
                                          
                                             M
                                          
                                       
                                       )
                                       −
                                       2
                                       d
                                       ,
                                       0
                                       )
                                    
                                 
                              
                           
                        
                        
                           
                              (22)
                              
                                 
                                    
                                       ω
                                    
                                    
                                       k
                                    
                                    
                                       new
                                    
                                 
                                 =
                                 
                                    
                                       max
                                       ⁡
                                       (
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             N
                                          
                                       
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             M
                                          
                                       
                                       
                                          
                                             a
                                          
                                          
                                             i
                                             j
                                             k
                                          
                                       
                                       −
                                       2
                                       M
                                       ,
                                       0
                                       )
                                    
                                    T
                                 
                              
                           
                         where
                           
                              (23)
                              
                                 T
                                 =
                                 max
                                 ⁡
                                 (
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                    ∑
                                    
                                       j
                                       =
                                       1
                                    
                                    M
                                 
                                 
                                    
                                       a
                                    
                                    
                                       i
                                       j
                                       k
                                    
                                 
                                 −
                                 2
                                 M
                                 ,
                                 0
                                 )
                                 +
                                 max
                                 ⁡
                                 (
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                    ∑
                                    
                                       j
                                       =
                                       1
                                    
                                    M
                                 
                                 
                                    
                                       b
                                    
                                    
                                       i
                                       j
                                       k
                                    
                                 
                                 −
                                 1
                                 ,
                                 0
                                 )
                              
                           
                        
                        
                           
                              (24)
                              
                                 
                                    
                                       a
                                    
                                    
                                       i
                                       j
                                       k
                                    
                                 
                                 =
                                 h
                                 (
                                 j
                                 |
                                 
                                    
                                       
                                          
                                             X
                                          
                                          
                                             →
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       Θ
                                    
                                    
                                       M
                                    
                                 
                                 )
                                 
                                    
                                       
                                          
                                             ω
                                          
                                          
                                             k
                                          
                                       
                                       p
                                       (
                                       
                                          
                                             X
                                          
                                          
                                             i
                                             k
                                          
                                       
                                       |
                                       
                                          
                                             ξ
                                          
                                          
                                             j
                                             k
                                          
                                       
                                       )
                                    
                                    
                                       
                                          ζ
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (25)
                              
                                 
                                    
                                       b
                                    
                                    
                                       i
                                       j
                                       k
                                    
                                 
                                 =
                                 h
                                 (
                                 j
                                 |
                                 
                                    
                                       
                                          
                                             X
                                          
                                          
                                             →
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       Θ
                                    
                                    
                                       M
                                    
                                 
                                 )
                                 
                                    
                                       (
                                       1
                                       −
                                       
                                          
                                             ω
                                          
                                          
                                             k
                                          
                                       
                                       )
                                       p
                                       (
                                       
                                          
                                             X
                                          
                                          
                                             i
                                             k
                                          
                                       
                                       |
                                       
                                          
                                             λ
                                          
                                          
                                             k
                                          
                                       
                                       )
                                    
                                    
                                       
                                          ζ
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                 
                              
                           
                        
                     

The following instructions summarize the main steps of the algorithm used for the AGGM parameters estimation and model selection
                           
                              1.
                              Initialize 
                                    
                                       
                                          Θ
                                       
                                       
                                          M
                                       
                                    
                                 :
                                    
                                       •
                                       The feature relevancy 
                                             
                                                
                                                   ω
                                                
                                                
                                                   →
                                                
                                             
                                             =
                                             
                                                
                                                   0.5
                                                
                                                
                                                   →
                                                
                                             
                                          .

The number of parameters 
                                             M
                                             =
                                             
                                                
                                                   M
                                                
                                                
                                                   max
                                                
                                             
                                          .

The AGGM parameters Θ are initialized using the Fuzzy C-means. Note that, we initialized both the left and right standard deviations with the standard deviation values obtained from the Fuzzy C-means and the shape parameters 
                                             
                                                
                                                   β
                                                
                                                
                                                   →
                                                
                                             
                                             =
                                             2
                                          .

Perform the common Gaussian density 
                                             
                                                
                                                   λ
                                                
                                                
                                                   →
                                                
                                             
                                           parameters estimation to cover the whole data.

Implement the 
                                    EM
                                    +
                                    MML
                                  approach


                                 While 
                                 
                                    M
                                    <
                                    
                                       
                                          M
                                       
                                       
                                          max
                                       
                                    
                                  
                                 do{
                                 
                                    
                                       (a)
                                       
                                          While not converged do {
                                          
                                             
                                                i.
                                                Perform E-step according to Eqs. (9) and (10).

Perform M-step according to Eqs. (12) to (17), (21) and (22)
                                                


                                                   If 
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      =
                                                      0
                                                   , Then the 
                                                      j
                                                      th
                                                    component is eliminated


                                                   If 
                                                   
                                                      
                                                         
                                                            ω
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      =
                                                      0
                                                   , Then 
                                                   
                                                      p
                                                      (
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            i
                                                            k
                                                         
                                                      
                                                      |
                                                      
                                                         
                                                            ξ
                                                         
                                                         
                                                            j
                                                            k
                                                         
                                                      
                                                      )
                                                    is eliminated


                                                   If 
                                                   
                                                      
                                                         
                                                            ω
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      =
                                                      1
                                                   , Then 
                                                   
                                                      p
                                                      (
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            i
                                                            k
                                                         
                                                      
                                                      |
                                                      
                                                         
                                                            λ
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      )
                                                    is eliminated

Calculate the associated message length using Eq. (20)
                                       

Remove the component j with the smallest 
                                             
                                                
                                                   p
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       

Return the model parameters with the smallest message length.

Recently, the RPEM algorithm [25] has been suggested to determine the model order automatically together with the estimation of the model parameters. This algorithm introduces unequal weights into the likelihood; thus the weighted likelihood in our case is written below:
                        
                           (26)
                           
                              Q
                              (
                              
                                 
                                    Θ
                                 
                                 
                                    M
                                 
                              
                              ,
                              X
                              )
                              =
                              
                                 1
                                 N
                              
                              
                                 ∑
                                 
                                    i
                                    =
                                    1
                                 
                                 N
                              
                              M
                              (
                              
                                 
                                    Θ
                                 
                                 
                                    M
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              )
                           
                        
                      with
                        
                           (27)
                           
                              M
                              (
                              
                                 
                                    Θ
                                 
                                 
                                    M
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              )
                              =
                              
                                 ∑
                                 
                                    j
                                    =
                                    1
                                 
                                 M
                              
                              g
                              (
                              j
                              |
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    Θ
                                 
                                 
                                    M
                                 
                              
                              )
                              ln
                              ⁡
                              {
                              
                                 
                                    p
                                 
                                 
                                    j
                                 
                              
                              
                                 ∏
                                 
                                    k
                                    =
                                    1
                                 
                                 d
                              
                              [
                              
                                 
                                    ω
                                 
                                 
                                    k
                                 
                              
                              p
                              (
                              
                                 
                                    X
                                 
                                 
                                    i
                                    k
                                 
                              
                              |
                              
                                 
                                    ξ
                                 
                                 
                                    j
                                    k
                                 
                              
                              )
                              +
                              (
                              1
                              −
                              
                                 
                                    ω
                                 
                                 
                                    k
                                 
                              
                              )
                              p
                              (
                              
                                 
                                    X
                                 
                                 
                                    i
                                    k
                                 
                              
                              |
                              
                                 
                                    λ
                                 
                                 
                                    k
                                 
                              
                              )
                              ]
                              }
                              −
                              
                                 ∑
                                 
                                    j
                                    =
                                    1
                                 
                                 M
                              
                              g
                              (
                              j
                              |
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    Θ
                                 
                                 
                                    M
                                 
                              
                              )
                              ln
                              ⁡
                              h
                              (
                              j
                              |
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    Θ
                                 
                                 
                                    M
                                 
                              
                              )
                           
                        
                      where 
                        g
                        (
                        j
                        |
                        
                           
                              
                                 
                                    X
                                 
                                 
                                    →
                                 
                              
                           
                           
                              i
                           
                        
                        ,
                        
                           
                              Θ
                           
                           
                              M
                           
                        
                        )
                     , 
                        j
                        =
                        [
                        1
                        ,
                        …
                        ,
                        M
                        ]
                     , are designable weight functions, satisfying the two constraints below:
                        
                           (28)
                           
                              
                                 ∑
                                 
                                    j
                                    =
                                    1
                                 
                                 M
                              
                              g
                              (
                              j
                              |
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    Θ
                                 
                                 
                                    M
                                 
                              
                              )
                              =
                              1
                           
                        
                     
                     
                        
                           (29)
                           
                              ∀
                              j
                              
                              g
                              (
                              j
                              |
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    Θ
                                 
                                 
                                    M
                                 
                              
                              )
                              =
                              0
                              
                              if
                              
                              h
                              (
                              j
                              |
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    Θ
                                 
                                 
                                    M
                                 
                              
                              )
                              =
                              0
                           
                        
                      Thus, following [25], the weight 
                        g
                        (
                        j
                        |
                        
                           
                              
                                 
                                    X
                                 
                                 
                                    →
                                 
                              
                           
                           
                              i
                           
                        
                        ,
                        
                           
                              Θ
                           
                           
                              M
                           
                        
                        )
                      can be expressed by:
                        
                           (30)
                           
                              g
                              (
                              j
                              |
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    Θ
                                 
                                 
                                    M
                                 
                              
                              )
                              =
                              (
                              1
                              +
                              ε
                              )
                              I
                              (
                              j
                              |
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    Θ
                                 
                                 
                                    M
                                 
                              
                              )
                              −
                              ε
                              h
                              (
                              j
                              |
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    Θ
                                 
                                 
                                    M
                                 
                              
                              )
                           
                        
                      where ε is a small positive quantity which we took as 1. Also
                        
                           (31)
                           
                              I
                              (
                              j
                              |
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    Θ
                                 
                                 
                                    M
                                 
                              
                              )
                              =
                              
                                 {
                                 
                                    
                                       
                                          1
                                       
                                       
                                          if
                                          
                                          j
                                          =
                                          c
                                       
                                    
                                    
                                       
                                          0
                                       
                                       
                                          if
                                          
                                          j
                                          ≠
                                          c
                                       
                                    
                                 
                              
                           
                        
                      and 
                        c
                        =
                        arg
                        ⁡
                        
                           
                              max
                           
                           
                              {
                              1
                              ≤
                              j
                              ≤
                              M
                              }
                           
                        
                      
                     
                        h
                        (
                        j
                        |
                        
                           
                              
                                 
                                    X
                                 
                                 
                                    →
                                 
                              
                           
                           
                              i
                           
                        
                        ,
                        
                           
                              Θ
                           
                           
                              M
                           
                        
                        )
                     . More details about RPEM can be found in [25]. In the following, we summarize the steps for the AGGM feature weighted RPEM (FW-RPEM) algorithm [43].
                        
                           1.
                           Initialize 
                                 
                                    
                                       Θ
                                    
                                    
                                       M
                                    
                                 
                              :
                                 
                                    •
                                    The feature relevancy 
                                          
                                             
                                                ω
                                             
                                             
                                                →
                                             
                                          
                                          =
                                          
                                             
                                                0.5
                                             
                                             
                                                →
                                             
                                          
                                       .

The number of parameters 
                                          M
                                          =
                                          
                                             
                                                M
                                             
                                             
                                                max
                                             
                                          
                                       .

The AGGM parameters Θ are initialized using the Fuzzy C-means. Note that, we initialized both the left and right standard deviations with the standard deviation values obtained from the Fuzzy C-means and the shape parameters 
                                          
                                             
                                                β
                                             
                                             
                                                →
                                             
                                          
                                          =
                                          2
                                       .

Perform the common Gaussian density 
                                 
                                    
                                       λ
                                    
                                    
                                       →
                                    
                                 
                               parameters estimation:
                                 
                                    (32)
                                    
                                       
                                          
                                             η
                                          
                                          
                                             k
                                          
                                       
                                       =
                                       
                                          1
                                          N
                                       
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          N
                                       
                                       
                                          
                                             X
                                          
                                          
                                             i
                                             k
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (33)
                                    
                                       
                                          
                                             δ
                                          
                                          
                                             k
                                          
                                          
                                             2
                                          
                                       
                                       =
                                       
                                          1
                                          N
                                       
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          N
                                       
                                       
                                          
                                             (
                                             
                                                
                                                   X
                                                
                                                
                                                   i
                                                   k
                                                
                                             
                                             −
                                             
                                                
                                                   η
                                                
                                                
                                                   k
                                                
                                             
                                             )
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                           

Repeated until convergence for each 
                                 
                                    
                                       
                                          
                                             X
                                          
                                          
                                             →
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                              , 
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 N
                              
                              
                                 
                                    •
                                    
                                       Expectation step
                                       
                                          
                                             
                                                h
                                                (
                                                j
                                                |
                                                
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            →
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   
                                                      Θ
                                                   
                                                   
                                                      M
                                                   
                                                
                                                )
                                                =
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      
                                                         
                                                            ∏
                                                         
                                                         
                                                            k
                                                            =
                                                            1
                                                         
                                                         
                                                            d
                                                         
                                                      
                                                      
                                                         
                                                            ζ
                                                         
                                                         
                                                            i
                                                            j
                                                            k
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            j
                                                            =
                                                            1
                                                         
                                                         
                                                            M
                                                         
                                                      
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      
                                                         
                                                            ∏
                                                         
                                                         
                                                            k
                                                            =
                                                            1
                                                         
                                                         
                                                            d
                                                         
                                                      
                                                      
                                                         
                                                            ζ
                                                         
                                                         
                                                            i
                                                            j
                                                            k
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             (34)
                                             
                                                g
                                                (
                                                j
                                                |
                                                
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            →
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   
                                                      Θ
                                                   
                                                   
                                                      M
                                                   
                                                
                                                )
                                                =
                                                
                                                   {
                                                   
                                                      
                                                         
                                                            2
                                                            −
                                                            h
                                                            (
                                                            j
                                                            |
                                                            
                                                               
                                                                  
                                                                     
                                                                        X
                                                                     
                                                                     
                                                                        →
                                                                     
                                                                  
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  Θ
                                                               
                                                               
                                                                  M
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            if
                                                            
                                                            j
                                                            =
                                                            c
                                                         
                                                      
                                                      
                                                         
                                                            −
                                                            h
                                                            (
                                                            j
                                                            |
                                                            
                                                               
                                                                  
                                                                     
                                                                        X
                                                                     
                                                                     
                                                                        →
                                                                     
                                                                  
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            ,
                                                            
                                                               
                                                                  Θ
                                                               
                                                               
                                                                  M
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            if
                                                            
                                                            j
                                                            ≠
                                                            c
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    


                                       Maximization step
                                       
                                          
                                             (35)
                                             
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      new
                                                   
                                                
                                                =
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      old
                                                   
                                                
                                                +
                                                
                                                   
                                                      γ
                                                   
                                                   
                                                      ϕ
                                                   
                                                
                                                
                                                   
                                                      ∂
                                                      M
                                                      (
                                                      
                                                         
                                                            Θ
                                                         
                                                         
                                                            M
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            
                                                               
                                                                  X
                                                               
                                                               
                                                                  →
                                                               
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      ∂
                                                      
                                                         
                                                            ϕ
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      |
                                                   
                                                   
                                                      
                                                         
                                                            Θ
                                                         
                                                         
                                                            M
                                                         
                                                         
                                                            old
                                                         
                                                      
                                                   
                                                
                                                =
                                                
                                                   
                                                      ϕ
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      old
                                                   
                                                
                                                +
                                                
                                                   
                                                      γ
                                                   
                                                   
                                                      ϕ
                                                   
                                                
                                                (
                                                g
                                                (
                                                j
                                                |
                                                
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            →
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   
                                                      Θ
                                                   
                                                   
                                                      M
                                                   
                                                
                                                )
                                                −
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      old
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             (36)
                                             
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      j
                                                      k
                                                   
                                                   
                                                      new
                                                   
                                                
                                                =
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      j
                                                      k
                                                   
                                                   
                                                      old
                                                   
                                                
                                                +
                                                γ
                                                
                                                   
                                                      ∂
                                                      M
                                                      (
                                                      
                                                         
                                                            Θ
                                                         
                                                         
                                                            M
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            
                                                               
                                                                  X
                                                               
                                                               
                                                                  →
                                                               
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      ∂
                                                      
                                                         
                                                            μ
                                                         
                                                         
                                                            j
                                                            k
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      |
                                                   
                                                   
                                                      
                                                         
                                                            Θ
                                                         
                                                         
                                                            M
                                                         
                                                         
                                                            old
                                                         
                                                      
                                                   
                                                
                                                =
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      j
                                                      k
                                                   
                                                   
                                                      old
                                                   
                                                
                                                +
                                                γ
                                                g
                                                (
                                                j
                                                |
                                                
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            →
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   
                                                      Θ
                                                   
                                                   
                                                      M
                                                   
                                                
                                                )
                                                
                                                   
                                                      
                                                         ω
                                                      
                                                      
                                                         k
                                                      
                                                      
                                                         old
                                                      
                                                   
                                                   
                                                      
                                                         ζ
                                                      
                                                      
                                                         i
                                                         j
                                                         k
                                                      
                                                   
                                                
                                                
                                                   
                                                      ∂
                                                      p
                                                      (
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            i
                                                            k
                                                         
                                                      
                                                      |
                                                      
                                                         
                                                            ξ
                                                         
                                                         
                                                            j
                                                            k
                                                         
                                                         
                                                            old
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      ∂
                                                      
                                                         
                                                            μ
                                                         
                                                         
                                                            j
                                                            k
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             (37)
                                             
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      j
                                                      k
                                                   
                                                   
                                                      new
                                                   
                                                
                                                =
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      j
                                                      k
                                                   
                                                   
                                                      old
                                                   
                                                
                                                +
                                                γ
                                                
                                                   
                                                      ∂
                                                      M
                                                      (
                                                      
                                                         
                                                            Θ
                                                         
                                                         
                                                            M
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            
                                                               
                                                                  X
                                                               
                                                               
                                                                  →
                                                               
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      ∂
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            j
                                                            k
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      |
                                                   
                                                   
                                                      
                                                         
                                                            Θ
                                                         
                                                         
                                                            M
                                                         
                                                         
                                                            old
                                                         
                                                      
                                                   
                                                
                                                =
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      j
                                                      k
                                                   
                                                   
                                                      old
                                                   
                                                
                                                +
                                                γ
                                                g
                                                (
                                                j
                                                |
                                                
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            →
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   
                                                      Θ
                                                   
                                                   
                                                      M
                                                   
                                                
                                                )
                                                
                                                   
                                                      
                                                         ω
                                                      
                                                      
                                                         k
                                                      
                                                      
                                                         old
                                                      
                                                   
                                                   
                                                      
                                                         ζ
                                                      
                                                      
                                                         i
                                                         j
                                                         k
                                                      
                                                   
                                                
                                                
                                                   
                                                      ∂
                                                      p
                                                      (
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            i
                                                            k
                                                         
                                                      
                                                      |
                                                      
                                                         
                                                            ξ
                                                         
                                                         
                                                            j
                                                            k
                                                         
                                                         
                                                            old
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      ∂
                                                      
                                                         
                                                            β
                                                         
                                                         
                                                            j
                                                            k
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             (38)
                                             
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            j
                                                            k
                                                         
                                                      
                                                   
                                                   
                                                      new
                                                   
                                                
                                                =
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            j
                                                            k
                                                         
                                                      
                                                   
                                                   
                                                      old
                                                   
                                                
                                                +
                                                γ
                                                
                                                   
                                                      ∂
                                                      M
                                                      (
                                                      
                                                         
                                                            Θ
                                                         
                                                         
                                                            M
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            
                                                               
                                                                  X
                                                               
                                                               
                                                                  →
                                                               
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      ∂
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            
                                                               
                                                                  l
                                                               
                                                               
                                                                  j
                                                                  k
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      |
                                                   
                                                   
                                                      
                                                         
                                                            Θ
                                                         
                                                         
                                                            M
                                                         
                                                         
                                                            old
                                                         
                                                      
                                                   
                                                
                                                =
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            j
                                                            k
                                                         
                                                      
                                                   
                                                   
                                                      old
                                                   
                                                
                                                +
                                                γ
                                                g
                                                (
                                                j
                                                |
                                                
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            →
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   
                                                      Θ
                                                   
                                                   
                                                      M
                                                   
                                                
                                                )
                                                
                                                   
                                                      
                                                         ω
                                                      
                                                      
                                                         k
                                                      
                                                      
                                                         old
                                                      
                                                   
                                                   
                                                      
                                                         ζ
                                                      
                                                      
                                                         i
                                                         j
                                                         k
                                                      
                                                   
                                                
                                                
                                                   
                                                      ∂
                                                      p
                                                      (
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            i
                                                            k
                                                         
                                                      
                                                      |
                                                      
                                                         
                                                            ξ
                                                         
                                                         
                                                            j
                                                            k
                                                         
                                                         
                                                            old
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      ∂
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            
                                                               
                                                                  l
                                                               
                                                               
                                                                  j
                                                                  k
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             (39)
                                             
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            j
                                                            k
                                                         
                                                      
                                                   
                                                   
                                                      new
                                                   
                                                
                                                =
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            j
                                                            k
                                                         
                                                      
                                                   
                                                   
                                                      old
                                                   
                                                
                                                +
                                                γ
                                                
                                                   
                                                      ∂
                                                      M
                                                      (
                                                      
                                                         
                                                            Θ
                                                         
                                                         
                                                            M
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            
                                                               
                                                                  X
                                                               
                                                               
                                                                  →
                                                               
                                                            
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      ∂
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            
                                                               
                                                                  r
                                                               
                                                               
                                                                  j
                                                                  k
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      |
                                                   
                                                   
                                                      
                                                         
                                                            Θ
                                                         
                                                         
                                                            M
                                                         
                                                         
                                                            old
                                                         
                                                      
                                                   
                                                
                                                =
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            j
                                                            k
                                                         
                                                      
                                                   
                                                   
                                                      old
                                                   
                                                
                                                +
                                                γ
                                                g
                                                (
                                                j
                                                |
                                                
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            →
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   
                                                      Θ
                                                   
                                                   
                                                      M
                                                   
                                                
                                                )
                                                
                                                   
                                                      
                                                         ω
                                                      
                                                      
                                                         k
                                                      
                                                      
                                                         old
                                                      
                                                   
                                                   
                                                      
                                                         ζ
                                                      
                                                      
                                                         i
                                                         j
                                                         k
                                                      
                                                   
                                                
                                                
                                                   
                                                      ∂
                                                      p
                                                      (
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            i
                                                            k
                                                         
                                                      
                                                      |
                                                      
                                                         
                                                            ξ
                                                         
                                                         
                                                            j
                                                            k
                                                         
                                                         
                                                            old
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      ∂
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            
                                                               
                                                                  r
                                                               
                                                               
                                                                  j
                                                                  k
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             (40)
                                             
                                                
                                                   
                                                      
                                                         ω
                                                      
                                                      
                                                         k
                                                      
                                                      
                                                         new
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         ω
                                                      
                                                      
                                                         k
                                                      
                                                      
                                                         old
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         γ
                                                      
                                                      
                                                         ω
                                                      
                                                   
                                                   
                                                      
                                                         ∂
                                                         M
                                                         (
                                                         
                                                            
                                                               Θ
                                                            
                                                            
                                                               M
                                                            
                                                         
                                                         ,
                                                         
                                                            
                                                               
                                                                  
                                                                     X
                                                                  
                                                                  
                                                                     →
                                                                  
                                                               
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         ∂
                                                         
                                                            
                                                               ω
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         |
                                                      
                                                      
                                                         
                                                            
                                                               Θ
                                                            
                                                            
                                                               M
                                                            
                                                            
                                                               old
                                                            
                                                         
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         ω
                                                      
                                                      
                                                         k
                                                      
                                                      
                                                         old
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         γ
                                                      
                                                      
                                                         ω
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         j
                                                         =
                                                         1
                                                      
                                                      M
                                                   
                                                   g
                                                   (
                                                   j
                                                   |
                                                   
                                                      
                                                         
                                                            
                                                               X
                                                            
                                                            
                                                               →
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         Θ
                                                      
                                                      
                                                         M
                                                      
                                                   
                                                   )
                                                   
                                                      
                                                         
                                                            υ
                                                         
                                                         
                                                            i
                                                            j
                                                            k
                                                         
                                                      
                                                      
                                                         
                                                            ζ
                                                         
                                                         
                                                            i
                                                            j
                                                            k
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            if
                                                            
                                                            
                                                               
                                                                  ω
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                            >
                                                            1
                                                            
                                                            then
                                                            
                                                            
                                                               
                                                                  ω
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                            =
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            if
                                                            
                                                            
                                                               
                                                                  ω
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                            <
                                                            0
                                                            
                                                            then
                                                            
                                                            
                                                               
                                                                  ω
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                            =
                                                            0
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                        where
                                          
                                             (41)
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      j
                                                   
                                                
                                                =
                                                
                                                   
                                                      exp
                                                      ⁡
                                                      (
                                                      
                                                         
                                                            ϕ
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            j
                                                            =
                                                            1
                                                         
                                                         
                                                            M
                                                         
                                                      
                                                      exp
                                                      ⁡
                                                      (
                                                      
                                                         
                                                            ϕ
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                for
                                                
                                                1
                                                ≤
                                                j
                                                ≤
                                                M
                                             
                                          
                                       
                                       
                                          
                                             (42)
                                             
                                                
                                                   
                                                      υ
                                                   
                                                   
                                                      i
                                                      j
                                                      k
                                                   
                                                
                                                =
                                                p
                                                (
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      i
                                                      k
                                                   
                                                
                                                |
                                                
                                                   
                                                      ξ
                                                   
                                                   
                                                      j
                                                      k
                                                   
                                                
                                                )
                                                −
                                                p
                                                (
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      i
                                                      k
                                                   
                                                
                                                |
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                          
                                        and 
                                          
                                             
                                                ∂
                                                p
                                                (
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      i
                                                      k
                                                   
                                                
                                                |
                                                
                                                   
                                                      ξ
                                                   
                                                   
                                                      j
                                                      k
                                                   
                                                   
                                                      old
                                                   
                                                
                                                )
                                             
                                             
                                                ∂
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      j
                                                      k
                                                   
                                                
                                             
                                          
                                       , 
                                          
                                             
                                                ∂
                                                p
                                                (
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      i
                                                      k
                                                   
                                                
                                                |
                                                
                                                   
                                                      ξ
                                                   
                                                   
                                                      j
                                                      k
                                                   
                                                   
                                                      old
                                                   
                                                
                                                )
                                             
                                             
                                                ∂
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      j
                                                      k
                                                   
                                                
                                             
                                          
                                       , 
                                          
                                             
                                                ∂
                                                p
                                                (
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      i
                                                      k
                                                   
                                                
                                                |
                                                
                                                   
                                                      ξ
                                                   
                                                   
                                                      j
                                                      k
                                                   
                                                   
                                                      old
                                                   
                                                
                                                )
                                             
                                             
                                                ∂
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            j
                                                            k
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       , and 
                                          
                                             
                                                ∂
                                                p
                                                (
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      i
                                                      k
                                                   
                                                
                                                |
                                                
                                                   
                                                      ξ
                                                   
                                                   
                                                      j
                                                      k
                                                   
                                                   
                                                      old
                                                   
                                                
                                                )
                                             
                                             
                                                ∂
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            j
                                                            k
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                        are given in Appendix C.

@&#EXPERIMENTAL RESULTS@&#

In this section, the effectiveness of the two proposed frameworks for learning the AGGM model are tested on two real-world applications namely action and facial expression recognition. It is noteworthy, that we have chosen 
                        
                           
                              M
                           
                           
                              max
                           
                        
                      to be 10 in all our experiments. Also, we have found, according to our experiments, that the shape parameter takes values in the range of [1.33–2.91].

The rapid spread of digital equipments has increased the number of video collections more and more. Thus, a crucial problem is the categorization and analysis of this content which has been the topic of extensive research in the past. With thousands of videos readily available, grouping them according to their contents is highly important for a variety of visual tasks such as event analysis, video indexing, browsing and retrieval, and digital libraries organization [44]. In particular, automatically recognizing human motion and activity in videos has gained a lot of interest because of its potential number of applications such as motion capture, medical bio-mechanical analysis, ergonomic analysis, environmental control and monitoring, sports and entertainment analysis, surveillance, and human–computer interaction. However, automatically inferring activity from video in order to have a rich high-level understanding of video remains a challenge due to cluttered background, occlusion, geometric and photometric variances of objects, illumination variation, and camera motion [45,46].

The goal of this section is to investigate the problem of human action categorization in video sequences using different local feature detectors and descriptors with our AGGM model used for classification. The problem of human actions categorization in a given video can be viewed as the process that given an unknown input video, the system reveals the classes of the actions present in this video. This process is generally based on three main tasks: features extraction, video representation, and action recognition. The features extraction step is mainly used in order to decrease the dimensionality of videos and this can be done by representing each video as a feature vector. Recently several feature extraction approaches have been introduced, these methods can be roughly classified into four categories: motion-based [45,47], appearance-based [48,49], space–time volume-based [50,51], and space–time interest points and local feature-based [52,53]. In this section, we are interested with local spatial temporal features because they can be extracted directly from video and therefore avoid possible failures of other pre-processing methods such as motion segmentation and tracking. Furthermore, local space–time features capture characteristic shape and motion in video and provide relatively independent representation of events with respect to their spatio-temporal shifts and scales as well as background clutter and multiple motions in the scene. Generally, the feature extraction step consists of two main components: feature detectors [52,54,55] and descriptors [52,53,56]. Feature detectors usually determine spatio-temporal locations and scales in video by maximizing specific saliency functions. Then, feature descriptors are used to capture shape and motion in the neighborhoods of selected points using image measurements such as spatial or spatio-temporal image gradients and optical flow. Thus, several evaluations of local space–time features have been reported in the past. In [57], the authors assessed the repeatability of space–time interest points and its associated accuracy for action recognition under changes in spatial and temporal video resolution as well as under camera motion. Similarly, [55] analyzed the repeatability of detected features under scale changes, in-plane rotations, video compression and camera motion. The work in [58] evaluated different local space time descriptors that include families of higher-order derivatives (local jets), image gradients and optical flow. In addition, local descriptors were compared in terms of image brightness, gradient and optical flow in [52] and in terms of the magnitude and orientation of space–time gradients as well as optical flow in [59]. Furthermore, [60] evaluated the 3D-SIFT descriptor and its two-dimensional variants and [56] compared space–time HOG descriptor with HOG and HOF descriptors [53]. Ref. [55] evaluated the extended SURF descriptor. Therefore, in this section, we evaluate the performance of several local space–time detectors and descriptors. The detectors used are:


                        Harris3D: Harris3D detector was proposed in [54] as an extension of the normal Harris detector [61] in the case of videos. Thus, a spatio-temporal second-moment matrix at each video point is computed and the final locations of space–time interest points are chosen to maximize a pre-defined function. We use the original implementation available on-line
                           1
                        
                        
                           1
                           
                              http://www.di.ens.fr/~laptev/download.html#stip.
                         with points extracted at multiple scales based on a regular sampling of the spatial and temporal scales (
                           
                              
                                 σ
                              
                              
                                 2
                              
                           
                           =
                           {
                           4
                           ,
                           8
                           ,
                           16
                           ,
                           32
                           ,
                           64
                           ,
                           128
                           }
                         and 
                           
                              
                                 τ
                              
                              
                                 2
                              
                           
                           =
                           {
                           2
                           ,
                           4
                           }
                        , respectively).


                        Cuboid: Cuboid detector was introduced in [52] and is based on temporal Gabor filters. This method was shown to produce a high number of detections in [62]. For implementation, we use the code from the authors' website
                           2
                        
                        
                           2
                           
                              http://vision.ucsd.edu/~pdollar/research.html.
                         using spatial and temporal scales as 2 and 4, respectively.


                        Dense: Dense sampling has been shown to provide better performance than interest points [63] for scene classification. Generally, dense sampling approaches sample the patches either randomly or uniformly from the image and then extract the local descriptors from these patches. Thus, for videos, dense sampling should be used to extract video blocks at regular positions and scales in space and time. Therefore, we use the same method in [64] where the patch size is 
                           18
                           ×
                           18
                         taken each 10 frames while having 50% overlap for both spatial and temporal sampling. In total, we consider all combinations of 8 spatial and 2 temporal scales, thus, we sample each video 16 times.

After detecting our features, the second step is to describe them using different feature descriptors. Normally, the input for the descriptor for each detected point is a five dimensional vector 
                           {
                           x
                           ,
                           y
                           ,
                           t
                           ,
                           σ
                           ,
                           τ
                           }
                         where 
                           {
                           x
                           ,
                           y
                           ,
                           t
                           }
                         is the 3D patch center and 
                           {
                           σ
                           ,
                           τ
                           }
                         are the spatial and temporal scale under consideration. Therefore, the descriptor spatial size 
                           
                              
                                 δ
                              
                              
                                 x
                              
                           
                           (
                           σ
                           )
                        , 
                           
                              
                                 δ
                              
                              
                                 y
                              
                           
                           (
                           σ
                           )
                         is a function of σ and its temporal length 
                           
                              
                                 δ
                              
                              
                                 t
                              
                           
                           (
                           τ
                           )
                         a function of τ. For our application we use the following descriptors:


                        HOG/HOF: The HOG/HOF descriptors were introduced in [53] and are similar in spirit to the well known SIFT descriptor. To characterize local motion and appearance, the authors calculated histograms of spatial gradient and optic flow accumulated in space–time neighborhoods of detected interest points. For the combination of HOG/HOF descriptors with interest point detectors, the descriptor size is defined by 
                           
                              
                                 δ
                              
                              
                                 x
                              
                           
                           (
                           σ
                           )
                           =
                           
                              
                                 δ
                              
                              
                                 y
                              
                           
                           (
                           σ
                           )
                           =
                           18
                           σ
                         and 
                           
                              
                                 δ
                              
                              
                                 t
                              
                           
                           (
                           τ
                           )
                           =
                           8
                           τ
                        . Then, each volume is subdivided into a number of 3D cells and a 4-bin histogram of gradient orientations (HOG) and a 5-bin histogram of optic flow (HOF) are computed for each cell. Finally, normalized histograms are concatenated together to form our final feature vector. In our evaluation we used the same grid parameters used in [53] as well as their online code.
                           1
                        
                     

For the scale parameters we used the same parametrization as in [64].


                        Cuboid: This descriptor was introduced in [52] along with the Cuboid detector with sizes 
                           
                              
                                 δ
                              
                              
                                 x
                              
                           
                           (
                           σ
                           )
                           =
                           
                              
                                 δ
                              
                              
                                 y
                              
                           
                           (
                           σ
                           )
                           =
                           2
                           ×
                           ceil
                           (
                           3
                           σ
                           )
                           +
                           1
                         and 
                           
                              
                                 δ
                              
                              
                                 t
                              
                           
                           (
                           τ
                           )
                           =
                           2
                           ×
                           ceil
                           (
                           3
                           τ
                           )
                           +
                           1
                        . Then, the gradients computed for each pixel in the patch is concatenated together to form a single vector. Finally, principal component analysis (PCA) is used to project the feature vector to a lower dimensional space. The code can be downloaded from the author website.
                           2
                         Note that, we used the Cuboid descriptor only with the Cuboid detector in our experiments.


                        HOG3D: This descriptor was proposed in [56] and is based on histograms of 3D gradient orientations. Gradients are computed using an integral video representation. Then, regular polyhedrons are used to uniformly quantize the orientation of spatio-temporal gradients. Thus, the descriptor combines shape and motion information at the same time. We use the code available at the authors website
                           3
                        
                        
                           3
                           
                              http://lear.inrialpes.fr/people/klaeser/software.
                         and apply their recommended parametric settings for all feature detectors. Therefore, we end up with seven detector–descriptor combinations namely Harris3D–HOG/HOF, Harris3D–HOG3D, Cuboid–HOG/HOF, Cuboid–Cuboid, Cuboid–HOG3D, Dense–HOG/HOF, Dense–HOG3D.

For video representation, we decided to use the well-known bag-of-features approach. Thus, given a set of training videos we learn the vocabulary of spatial–temporal words. This vocabulary (or codebook) is constructed by applying the k-means algorithm with Euclidean distance as the clustering metric. The center of each resulting cluster is used to represent a spatial–temporal word (or codeword). Thus, each detected interest point can be assigned a unique cluster membership, allowing each video to be represented as a collection of spatial–temporal words from the codebook. Then, the pLSA model [65] was adopted to represent each video sequence by a 75-dimensional proportional vector. Finally, our developed AGGM model can be used to cluster the set of action categories.

In order to evaluate our two classifiers (AGGM-EM-MML and AGGM-RPEM), we compared them to the well known support vector machine SVM with 
                           
                              
                                 χ
                              
                              
                                 2
                              
                           
                        -kernel [53] as well as the Gaussian mixture models learned with the EM-MML [32] and RPEM approaches [43] (namely GMM-EM-MML and GMM-RPEM), the Generalized Gaussian mixture models learned with the EM-MML and RPEM approaches (namely GGM-EM-MML and GGM-RPEM), and the Laplace mixture models learned with the EM-MML and RPEM approaches (namely LMM-EM-MML and LMM-RPEM). We have used two well-known metrics, overall precision and recall, to quantify how well each algorithm works in classifying the data [66].
                           
                              (43)
                              
                                 
                                    Precision
                                 
                                 =
                                 
                                    1
                                    R
                                 
                                 
                                    ∑
                                    
                                       r
                                       =
                                       1
                                    
                                    R
                                 
                                 
                                    
                                       
                                          TP
                                       
                                       
                                          r
                                       
                                    
                                    
                                       
                                          
                                             TP
                                          
                                          
                                             r
                                          
                                       
                                       +
                                       
                                          
                                             FP
                                          
                                          
                                             r
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (44)
                              
                                 
                                    Recall
                                 
                                 =
                                 
                                    1
                                    R
                                 
                                 
                                    ∑
                                    
                                       r
                                       =
                                       1
                                    
                                    R
                                 
                                 
                                    
                                       
                                          TP
                                       
                                       
                                          r
                                       
                                    
                                    
                                       
                                          
                                             TP
                                          
                                          
                                             r
                                          
                                       
                                       +
                                       
                                          
                                             FN
                                          
                                          
                                             r
                                          
                                       
                                    
                                 
                              
                           
                         where R is the total number of classes in the data set, 
                           
                              
                                 TP
                              
                              
                                 r
                              
                           
                         is the number of images in the 
                           r
                           th
                         class that were correctly classified by the algorithm, 
                           
                              
                                 FP
                              
                              
                                 r
                              
                           
                         is the number of images from other classes that were classified to the 
                           r
                           th
                         class, and 
                           
                              
                                 FN
                              
                              
                                 r
                              
                           
                         is the number of images from the 
                           r
                           th
                         class that were wrongly classified with the algorithm.

In order to assess the effectiveness of our approaches, we perform experiments on six highly challenging action recognition data sets:


                        KTH 
                        
                           [67]
                        
                        : The KTH human motion data set is the most common data set used for human action categorization. It contains 2391 video sequences of six types of human actions performed several times by 25 subjects in four different scenarios: outdoors, outdoors with scale variation, outdoors with different clothes and indoors. All video samples were down sampled to the spatial resolution of 
                           160
                           ×
                           120
                         pixels and have a length of four seconds in average. Representative frames of this data set are shown in Fig. 1
                        . In order to build the codebook, we have used for each action two video scenarios performed by three subjects. Thus, we have used 6 videos per action in total for learning the codebook and kept these videos out of the training and testing sets, to avoid contamination in the data. Furthermore, we have learned seven different codebook sizes starting by 900 visual words with 50 visual words increase. However, we found that the accuracy decreases after considering more than 1050 visual words therefore we decided to use a codebook with 1050 visual words. Finally, we adopt the leave-one-out testing paradigm to evaluate the performance of our methods. Therefore, for each run of the learning algorithm, we use 24 subjects (except those videos used to build the codebook) to learn the model, as for testing, we use videos of the remaining subject. Table 1
                         represents average precision and recall for all methods under consideration when 1050 words are used to build the dictionary.


                        Weizmann 
                        
                           [51]
                        
                        : Weizmann human action data set contains 90 low-resolution video sequences taken with static camera and static background. These videos show nine different people performing 10 different actions. All frames have been normalized to 
                           90
                           ×
                           60
                        . Some example frames of each action class can be viewed in Fig. 2
                        . Since this data set is small and only has 90 sequences, we use all feature descriptors obtained from all the training video sequences to learn the codebook. We have tested seven dictionary sizes starting with 500 words and varying it by 50 each time. However, we found that the accuracy doesn't change after 700 visual words therefore we decided to use a codebook with 700 visual words. A leave-one-out setup is adopted for this data set to test the performance of our categorization approach, thus, each time we learn a model from the videos of eight subjects, and test those of the remaining subject. Note that, the result is reported as the average of nine runs. Table 2
                         shows average precision and recall for all methods under consideration when 700 words are used to build the codebook.


                        Hollywood2 
                        
                           [68]
                        
                        : Hollywood2 actions data set has been collected from 69 different Hollywood movies with 12 actions classes. Some sample frames from Hollywood2 data set are given in Fig. 3
                        . In our experiments, and following [64], we have used only the clean training data set. Thus, we have 1707 action samples divided into a training set (823 sequences) and a test set (884 sequences). Train and test sequences are obtained from different movies. The performance is evaluated by computing the mean for 10 runs. We have tested seven dictionary sizes starting with 1800 words and varying it by 50 each time. However, we found that the best results with respect to computational time are obtained with 2050 words. Table 3
                         shows average precision and recall for all methods under consideration when 2050 words are used to build the codebook.


                        UCF Sports 
                        
                           [69]
                        
                        : The UCF sports data set consists of 150 broadcast sports video sequences with 10 different actions as shown in Fig. 4
                        . It is a challenging data set with a wide range of scenes and viewpoints variability. We use all the training video sequences to build our codebook. We learn dictionaries with different seven sizes starting from an initial size of 1000 increased by 50 each time. Note that, we found that the best results with respect to computational time are obtained with 1200 words. In order to test the efficiency of our approaches for the recognition task, we adopt a leave-one-out setup. Table 4
                         shows average precision and recall for all methods under considerations.


                        UCF11 
                        
                           [70]
                        
                        : UCF11 data sets contains 1168 video sequences in total with 11 action categories where all the videos are converted to 29.97 fps. Sample frames from each action class are shown in Fig. 5
                        . This data set is very challenging due to large variations in camera motion, object appearance and pose, object scale, viewpoint, cluttered background, illumination conditions, etc. We have learned dictionaries with different seven sizes starting from an initial size of 2500 increased by 50 each time. Nevertheless, we found that the best results with respect to computational time are obtained with 2600 words. In order to evaluate our methods, we adopt leave-one-out and report the average accuracy over all runs. Table 5
                         shows average precision and recall for all methods under consideration.


                        UCF50 
                        
                           [71]
                        
                        : UCF50 data set consists of realistic videos taken from youtube of 50 action categories. The UCF50 data set is very challenging due to large variations in camera motion, object appearance and pose, object scale, viewpoint, cluttered background, illumination conditions, etc. For all the 50 categories, the videos are divided into 25 groups, where each group consists of more than 4 action clips. Furthermore, the video clips in the same group share some common features, such as the same person, similar background, similar viewpoint, etc. Fig. 6
                         shows some sample images from each category. The performance is evaluated by using a complete leave-one-out cross validation as in [71]. We have learned dictionaries with different seven sizes starting from an initial size of 2500 increased by 50 each time. Nevertheless, we found that the best results with respect to computational time are obtained with 2700 words. Table 6
                         shows average precision and recall for all methods under consideration. It is noteworthy that the average computational times excluding pre-processing time of feature detection and visual vocabulary formation of the LMM-EM-MML, LMM-RPEM, AGM-EM-MML, AGM-RPEM, AGGM-EM-ML, and AGGM-RPEM approaches running on Core i7-2.4 GHz processor are around (10, 9, 14, 12, 17, 14), (1, 1, 2, 2, 3, 2), (5, 4, 7, 6, 9, 7), (2, 1, 3, 2, 4, 3), (6, 5, 7, 5, 10, 6), and (39, 34, 42, 38, 53, 47) minutes for the training set of the KTH, Weizmann, Hollywood2, UCF Sports, UCF11, and UCF50 data set, respectively. From experimental results, we found that the Harris3D detector with the HOG/HOF descriptor and the Cuboid detector with the Cuboid descriptor achieves the best recall and precision for the simple data sets (Weizmann and KTH), respectively. In addition, we found that the Cuboid descriptor performs well for both metrics for the simple data sets (Weizmann and KTH). Furthermore, we found that the Dense detector outperform the rest for real data sets (Hollywood2, UCF Sports, UCF11, UCF50). Finally, we found that the use of the AGGM improved the classification accuracy and outperformed the SVM as well as the GMM for most of detectors/descriptor combination.

Facial expressions are the facial changes with regards to a person's internal emotional states, intentions, or social communications. The detection of faces and the interpretation of facial expression under varying conditions regardless of context, culture, and gender is an easy task for humans, however, it represents a difficult problem for computer based systems. Facial expression represents a very important task for humans for example the impression induced from a displayed expression will affect our interpretation of the spoken word and even our attitude towards the speaker himself. Furthermore, facial expression analysis can be applied in many areas such as emotion and paralinguistic communication, clinical psychology, psychiatry, neurology, pain assessment, lie detection, intelligent environments, and multimodal human computer interface (HCI). Therefore, facial expression analysis has been an active research topic for behavioral scientists since the work of Darwin in 1872 [72]. The authors in [73] introduced a method to automatically analyze facial expressions by tracking the motion of 20 identified spots on an image sequence. Thereafter, much progress has been made to build computer systems to help us understand and use this natural form of human communication [74–78]. The main goal of theses researches is to create a computer system capable of automatically detecting the emotional state of any person. Thus, face expression recognition (FER) is interested in applying machine vision and pattern recognition algorithms on both still images and/or video sequences in order to extract emotional content from visual patterns of a person's face. Despite the progress made in recognizing facial expressions, reliable and accurate automatic FER is still an evolving research subject due to the subtlety, complexity and variability of facial expressions. Facial expression analysis methods can be classified into image based and video based. Facial expression are dynamic in nature, as a result video based methods are more robust since they encode the facial dynamics which are not available in static. However, there are some scenarios when temporal data is not available and image based facial expression analysis are highly needed such as in classifying expressions in consumer level photographs, expression based album creation, and smile detection. Therefore, in this section, we present a novel real-time system for static facial expressions recognition capable of recognizing seven facial expressions (The six basic facial expressions: Anger, Disgust, Fear, Joy, Sadness, Surprise with the Neutral expression). Fig. 7
                         shows a sample image from each of the seven facial expressions.

Generally, the task of automatic facial expression analysis can be divided into three main steps: face detection, facial feature extraction, and classification into expressions. Face detection is used to recognize and locate face-like objects regardless of their positions, scales, orientations, poses, and illumination in the given image. Face detection is not straightforward due to various variations of image appearance, such as pose variation (front, non-front), occlusion, image orientation, and illuminating condition. Many novel methods have been proposed to automatically recognizing faces in images, such as motion detection (e.g. eye blinks), skin color segmentation and neural network based methods. However, motion based approaches are not applicable for our static case and skin tone detection does not perform equally well on different skin colors and is sensitive to changes in illumination. In this section, we are interested with real time system, therefore, we decided to use the method introduced in [79] for its small computational time and high detection accuracy. Their approach is capable of eliminating the need to compute a multi-scale image pyramid and thus reducing the time required for face detection significantly. The method can be divided into three main task; first, calculate the integral image where the integral image at a given location contains the sum of the pixels above and to the left of this location. Then, compute some rectangle features (Haar features) from this integral image and use AdaBoost for feature selection. Finally, a cascade of weak classifiers is employed for face detection. After faces are localized, facial feature extraction is performed on the cropped faces. Extracting facial feature is an important step and essential requirement in automated facial expression recognition and has been widely studied in the literature [74,80,81]. In this paper, we test different feature extraction methods:


                        LBP 
                        
                           [82]
                        
                        : The Local Binary Pattern (LBP) descriptor assigns binary labels to pixels by thresholding the neighborhood pixels with the central value. Later the operator was extended to use uniform patterns which are LBP that contain at most two bitwise transitions from 0 to 1 or vice versa. The advantage of using uniform patterns is that uniform patterns account for a bit less than 90% of all patterns while can be represented by only 59 bins [83]. Note that, we have used the code available online.
                           4
                        
                        
                           4
                           
                              http://www.cse.oulu.fi/CMV/Downloads/LBPMatlab.
                         Thus, in order to use the LBP descriptor, each facial image is segmented into a grid of 
                           5
                           ×
                           5
                         regions, then, we down-sampled the image into 3 resolutions with scale of 0.6. Therefore, we end up with a 4425-dimensional feature vector for each facial image (
                           3
                           ×
                           59
                           ×
                           25
                        ).


                        LPQ 
                        
                           [84,85]
                        
                        : The Local Phase Quantization (LPQ) is a novel descriptor for texture classification. The descriptor uses phase information computed locally in a window for every image position. The phases of the four low-frequency coefficients are de-correlated and uniformly quantized into eight-dimensional space. Then, a histogram of these integer values from all image positions is created and used as a feature for classification (we end up with 256 hypercubes in eight-dimensional space). Because only phase information is used, the method is also invariant to uniform illumination changes. Note that, we have used the code available online.
                           5
                        
                        
                           5
                           
                              http://www.cse.oulu.fi/CMV/Downloads/LPQMatlab.
                         For this descriptor the cropped faces were divided into 
                           5
                           ×
                           5
                         blocks and the neighborhood size was set to 8. Thus, we end up with a 6400-dimensional feature vector for each image (
                           256
                           ×
                           25
                        ).


                        HOG 
                        
                           [86]
                        
                        : HOG descriptor counts occurrences of gradient orientation in localized portions of an image. This method is similar to that of edge orientation histograms, scale-invariant feature transform descriptors, and shape contexts, but differs in that it is computed on a dense grid of uniformly spaced cells and uses overlapping local contrast normalization for improved accuracy. It is noteworthy, that the image is divided into 
                           5
                           ×
                           5
                         blocks, where each block is divided into 
                           2
                           ×
                           2
                         cells. Furthermore, we have used a 9 orientation bins, therefore, we end up with a 2916-feature vector for each facial image.


                        PHOG 
                        
                           [87]
                        
                        : Pyramid of Histogram of Oriented Gradients (PHOG) descriptor represents local image shape and its spatial layout by a spacial pyramid kernel. Note that, we have used the code available online.
                           6
                        
                        
                           6
                           
                              http://www.robots.ox.ac.uk/~vgg/research/caltech.
                         Thus, we used a three level pyramid with 8 bin length and [0–360] angle range for each of the 25 image blocks in our experiments. Therefore, we end up with a 4200-features vector for each image under consideration.


                        WLD 
                        
                           [88]
                        
                        : The Weber Local Descriptor (WLD) characterizes texture information of an image by considering the ratio of changes in pixel intensity. Different to LBP, it uses the gradient orientations to describe the direction of edges. For implementation, we use the code available online.
                           7
                        
                        
                           7
                           
                              http://vipl.ict.ac.cn/resources/codes.
                         Note that, we divided each face sample into 25 overlapping blocks. For each block, we computed a concatenated histogram with 6 sub-histograms. Each of the 6 sub-histograms is concatenated with 8 histogram patches, where each patch is represented by 6 bins. Thus, we end up with a 7200-feature vector. Then, the well established PCA technique is used to reduce the dimensionality scope. Note that, we have chosen the best 100 principal components in our experiments. The last step is facial expression classification which is used to identify the emotional state of the input person face by searching a database of known different emotional expressions. Over the years different classifiers were tested in facial expression recognition, however, we are interested with SVM and mixture models in this paper. Therefore, we decided to test three SVM classifiers: Linear (LSVM), polynomial (PolySVM), and SVM with Radial Basis Function (RBF) kernels (RBFSVM). In addition, for mixture based classifiers, we are using both the AGGM, Laplace mixture models (LMM), Generalized Gaussian mixture models and the Gaussian mixture model (GMM) for comparison purposes. Furthermore, we employ the RPEM and the EM with MML approaches for model learning.

We have experimented the various algorithms on three well known databases:


                        JAFFE 
                        
                           [89]
                        
                        : The Japanese Female Facial Expression (JAFFE) is one of the earliest static facial expressions databases. It contains 219 images of 10 Japanese females performing the 7 facial expressions under consideration. It has been extensively used in expression research. However, it has been created in a lab controlled environment with a limited number of samples. Fig. 7 shows some sample images from this data set. For our experiments, we have used a five-fold cross validation script, which creates five subsets of the data set.


                        Cohn–Kanade 
                        
                           [90]
                        
                        : Cohn–Kanade database is one of the most widely used test-beds for facial expression algorithm development and evaluation. This database consists of 97 university students between the ages of 18 to 50 years, of which 69% are female, 13% are African–American, 81% are Euro-American, and 6% are from other groups. Subjects were instructed to perform a series of 23 facial displays, six of which were based on description of prototypic emotions, where each display began and ended with a neutral face. In addition, Image sequences were digitized into 
                           640
                           ×
                           490
                         pixel arrays with 8-bit precision for grayscale values. Fig. 7 shows some sample images from this data set. For our experiments, we selected 320 image sequences where each come from one of the six basic emotions. The sequences come from 96 subjects, with 1–6 emotions per subject. For each sequence, the neutral face and three peak frames were used for expression recognition, resulting in 1280 images (108 Anger, 120 Disgust, 99 Fear, 282 Joy, 126 Sadness, 225 Surprise and 320 Neutral). To evaluate the performance of the algorithms under consideration, we adopted a 10 cross validation testing scheme repeated for 10 times in our experiments.


                        SFEW 
                        
                           [91,78]
                        
                        : Static Facial Expression in the Wild (SFEW) has been developed by selecting frames from Acted Facial Expressions in the Wild (AFEW) database. The database covers unconstrained facial expressions, varied head poses, large age range, occlusions, varied focus, different resolution of face and close to real world illumination. Frames were extracted from AFEW sequences and labeled based on the label of the sequence. In total, SFEW contains 700 images that have been labeled for the seven facial expressions by two independent labelers. Fig. 7 shows some sample images from this data set. For the purpose of consistent evaluation of different algorithms, the images are divided into two sets of 346 images and 354 images, respectively. The sets are created in a strict person independent manner. Then, we use the first and second set to train and test our algorithms and vice versa.

In order to evaluate the performance of these algorithms, we have used the two metrics used for human action recognition: precision and Recall. Tables 7, 8, and 9
                        
                        
                         show the various precision and recall of all descriptor/classifier combinations for the JAFFE, Cohn–Kanade, and SFEW databases, respectively.

It is noteworthy that the average computational times excluding pre-processing time of feature extraction of the LMM-EM-MML, LMM-RPEM, AGM-EM-MML, AGM-RPEM, AGGM-EM-ML, and AGGM-RPEM approaches running on Core i7-2.4 GHz processor are around (2, 2, 3, 2, 4, 2), (7, 6, 9, 7, 12, 10), and (4, 3, 5, 4, 7, 5) minutes for the training set of the JAFFE, Cohn–Kanade, and SFEW database, respectively. From our experimental results, we found that both WLD and PHOG descriptors achieve the highest results for all classifiers, and that the AGGM model outperforms the rest in classification.

@&#CONCLUSION@&#

In this paper, we have presented two approaches for clustering high dimensional data using mixture models. Our approaches consider that data arises from a mixture of asymmetric generalized Gaussian distributions which represents a good choice for high dimensional data due to its asymmetrical property and its ability to model different shapes. Furthermore, they tackled the problem of noisy and uninformative features by determining a set of relevant features for each data cluster. For model learning, the RPEM is used to allow simultaneous parameters estimation and model selection for the first approach and the expectation-maximization was penalized with the minimum message length criterion for the second approach. The merits of the proposed work are shown through complicated computer vision examples and applications, involving high-dimensional data and large number of classes,namely human action detection and facial expression recognition. From experimental results, we can conclude that both algorithms are effective in clustering, however, we favor the RPEM due to its lower computational time. Future works could be devoted to the development of a variational approach to learn the proposed model and its application to other image processing and computer vision applications.

@&#ACKNOWLEDGEMENT@&#

The completion of this research was made possible thanks to the Natural Sciences and Engineering Research Council of Canada (NSERC). The authors would like to thank the anonymous referees and the associate editor for their comments.

If X follows an asymmetric Generalized Gaussian distribution (AGGD), then:
                        
                           (A.1)
                           
                              p
                              (
                              X
                              |
                              μ
                              ,
                              β
                              ,
                              
                                 
                                    σ
                                 
                                 
                                    l
                                 
                              
                              ,
                              
                                 
                                    σ
                                 
                                 
                                    r
                                 
                              
                              )
                              =
                              
                                 
                                    β
                                    
                                       
                                          [
                                          
                                             
                                                Γ
                                                (
                                                3
                                                /
                                                β
                                                )
                                             
                                             
                                                Γ
                                                (
                                                1
                                                /
                                                β
                                                )
                                             
                                          
                                          ]
                                       
                                       
                                          1
                                          /
                                          2
                                       
                                    
                                 
                                 
                                    (
                                    
                                       
                                          σ
                                       
                                       
                                          l
                                       
                                    
                                    +
                                    
                                       
                                          σ
                                       
                                       
                                          r
                                       
                                    
                                    )
                                    Γ
                                    (
                                    1
                                    /
                                    β
                                    )
                                 
                              
                              
                                 {
                                 
                                    
                                       
                                          exp
                                          ⁡
                                          [
                                          −
                                          
                                             
                                                (
                                                
                                                   
                                                      Γ
                                                      (
                                                      3
                                                      /
                                                      β
                                                      )
                                                   
                                                   
                                                      Γ
                                                      (
                                                      1
                                                      /
                                                      β
                                                      )
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   β
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      μ
                                                      −
                                                      X
                                                   
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         l
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                β
                                             
                                          
                                          ]
                                       
                                       
                                          if
                                          
                                          X
                                          <
                                          μ
                                       
                                    
                                    
                                       
                                          exp
                                          ⁡
                                          [
                                          −
                                          
                                             
                                                (
                                                
                                                   
                                                      Γ
                                                      (
                                                      3
                                                      /
                                                      β
                                                      )
                                                   
                                                   
                                                      Γ
                                                      (
                                                      1
                                                      /
                                                      β
                                                      )
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   β
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      X
                                                      −
                                                      μ
                                                   
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                β
                                             
                                          
                                          ]
                                       
                                       
                                          if
                                          
                                          X
                                          ≥
                                          μ
                                       
                                    
                                 
                              
                           
                        
                      Assuming that the left and right standard deviation are equal 
                        
                           
                              σ
                           
                           
                              l
                           
                        
                        =
                        
                           
                              σ
                           
                           
                              r
                           
                        
                        =
                        σ
                     , then we get the Generalized Gaussian distribution (GGD):
                        
                           (A.2)
                           
                              p
                              (
                              X
                              |
                              μ
                              ,
                              β
                              ,
                              σ
                              )
                              =
                              
                                 
                                    β
                                    
                                       
                                          [
                                          
                                             
                                                Γ
                                                (
                                                3
                                                /
                                                β
                                                )
                                             
                                             
                                                Γ
                                                (
                                                1
                                                /
                                                β
                                                )
                                             
                                          
                                          ]
                                       
                                       
                                          1
                                          /
                                          2
                                       
                                    
                                 
                                 
                                    2
                                    σ
                                    Γ
                                    (
                                    1
                                    /
                                    β
                                    )
                                 
                              
                              exp
                              ⁡
                              [
                              −
                              
                                 
                                    (
                                    
                                       
                                          Γ
                                          (
                                          3
                                          /
                                          β
                                          )
                                       
                                       
                                          Γ
                                          (
                                          1
                                          /
                                          β
                                          )
                                       
                                    
                                    )
                                 
                                 
                                    
                                       β
                                       2
                                    
                                 
                              
                              |
                              
                                 
                                    X
                                    −
                                    μ
                                 
                                 σ
                              
                              
                                 
                                    |
                                 
                                 
                                    β
                                 
                              
                              ]
                           
                        
                      Furthermore, by assuming that 
                        β
                        =
                        1
                      and 
                        β
                        =
                        2
                     , we get the Laplace distribution (LD) and the Gaussian distribution (GD), respectively:
                        
                           (A.3)
                           
                              p
                              (
                              X
                              |
                              μ
                              ,
                              σ
                              )
                              =
                              
                                 1
                                 
                                    
                                       2
                                    
                                    σ
                                 
                              
                              exp
                              ⁡
                              [
                              −
                              
                                 
                                    
                                       2
                                    
                                    |
                                    X
                                    −
                                    μ
                                    |
                                 
                                 σ
                              
                              ]
                           
                        
                     
                     
                        
                           (A.4)
                           
                              p
                              (
                              X
                              |
                              μ
                              ,
                              σ
                              )
                              =
                              
                                 1
                                 
                                    
                                       
                                          2
                                          π
                                       
                                    
                                    σ
                                 
                              
                              exp
                              ⁡
                              [
                              −
                              
                                 
                                    
                                       (
                                       X
                                       −
                                       μ
                                       )
                                    
                                    
                                       2
                                    
                                 
                                 
                                    2
                                    
                                       
                                          σ
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              ]
                           
                        
                     
                  


                     
                        
                           (B.1)
                           
                              
                                 
                                    ∂
                                    L
                                    (
                                    X
                                    ,
                                    
                                       
                                          Θ
                                       
                                       
                                          M
                                       
                                    
                                    ,
                                    Z
                                    ,
                                    φ
                                    )
                                 
                                 
                                    ∂
                                    
                                       
                                          μ
                                       
                                       
                                          j
                                          k
                                       
                                    
                                 
                              
                              =
                              
                                 ∑
                                 
                                    i
                                    =
                                    1
                                 
                                 N
                              
                              
                                 
                                    
                                       
                                          ω
                                       
                                       
                                          k
                                       
                                    
                                    p
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          i
                                          k
                                       
                                    
                                    |
                                    
                                       
                                          ξ
                                       
                                       
                                          j
                                          k
                                       
                                    
                                    )
                                 
                                 
                                    
                                       ζ
                                    
                                    
                                       i
                                       j
                                       k
                                    
                                 
                              
                              h
                              (
                              j
                              |
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    Θ
                                 
                                 
                                    M
                                 
                              
                              )
                              A
                              (
                              
                                 
                                    β
                                 
                                 
                                    j
                                    k
                                 
                              
                              )
                              
                                 {
                                 
                                    
                                       
                                          −
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   j
                                                   k
                                                
                                             
                                             
                                                
                                                   σ
                                                
                                                
                                                   
                                                      
                                                         l
                                                      
                                                      
                                                         j
                                                         k
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            μ
                                                         
                                                         
                                                            j
                                                            k
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            i
                                                            k
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         
                                                            
                                                               l
                                                            
                                                            
                                                               j
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      j
                                                      k
                                                   
                                                
                                                −
                                                1
                                             
                                          
                                       
                                       
                                          if
                                          
                                          
                                             
                                                X
                                             
                                             
                                                i
                                                k
                                             
                                          
                                          <
                                          
                                             
                                                μ
                                             
                                             
                                                j
                                                k
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   j
                                                   k
                                                
                                             
                                             
                                                
                                                   σ
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         j
                                                         k
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            i
                                                            k
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            μ
                                                         
                                                         
                                                            j
                                                            k
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         
                                                            
                                                               r
                                                            
                                                            
                                                               j
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      j
                                                      k
                                                   
                                                
                                                −
                                                1
                                             
                                          
                                       
                                       
                                          if
                                          
                                          
                                             
                                                X
                                             
                                             
                                                i
                                                k
                                             
                                          
                                          ≥
                                          
                                             
                                                μ
                                             
                                             
                                                j
                                                k
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (B.2)
                           
                              
                                 
                                    
                                       
                                          ∂
                                       
                                       
                                          2
                                       
                                    
                                    L
                                    (
                                    X
                                    ,
                                    
                                       
                                          Θ
                                       
                                       
                                          M
                                       
                                    
                                    ,
                                    Z
                                    ,
                                    φ
                                    )
                                 
                                 
                                    ∂
                                    
                                       
                                          μ
                                       
                                       
                                          j
                                          k
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              =
                              −
                              
                                 ∑
                                 
                                    i
                                    =
                                    1
                                 
                                 N
                              
                              
                                 
                                    
                                       
                                          ω
                                       
                                       
                                          k
                                       
                                    
                                    p
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          i
                                          k
                                       
                                    
                                    |
                                    
                                       
                                          ξ
                                       
                                       
                                          j
                                          k
                                       
                                    
                                    )
                                 
                                 
                                    
                                       ζ
                                    
                                    
                                       i
                                       j
                                       k
                                    
                                 
                              
                              h
                              (
                              j
                              |
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    Θ
                                 
                                 
                                    M
                                 
                              
                              )
                              A
                              (
                              
                                 
                                    β
                                 
                                 
                                    j
                                    k
                                 
                              
                              )
                              
                                 
                                    β
                                 
                                 
                                    j
                                    k
                                 
                              
                              
                                 {
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      j
                                                      k
                                                   
                                                
                                                −
                                                1
                                             
                                             
                                                
                                                   σ
                                                
                                                
                                                   
                                                      
                                                         l
                                                      
                                                      
                                                         j
                                                         k
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            μ
                                                         
                                                         
                                                            j
                                                            k
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            i
                                                            k
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         
                                                            
                                                               l
                                                            
                                                            
                                                               j
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      j
                                                      k
                                                   
                                                
                                                −
                                                2
                                             
                                          
                                       
                                       
                                          if
                                          
                                          
                                             
                                                X
                                             
                                             
                                                i
                                                k
                                             
                                          
                                          <
                                          
                                             
                                                μ
                                             
                                             
                                                j
                                                k
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      j
                                                      k
                                                   
                                                
                                                −
                                                1
                                             
                                             
                                                
                                                   σ
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         j
                                                         k
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            i
                                                            k
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            μ
                                                         
                                                         
                                                            j
                                                            k
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         
                                                            
                                                               r
                                                            
                                                            
                                                               j
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      j
                                                      k
                                                   
                                                
                                                −
                                                2
                                             
                                          
                                       
                                       
                                          if
                                          
                                          
                                             
                                                X
                                             
                                             
                                                i
                                                k
                                             
                                          
                                          ≥
                                          
                                             
                                                μ
                                             
                                             
                                                j
                                                k
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (B.3)
                           
                              
                                 
                                    ∂
                                    L
                                    (
                                    X
                                    ,
                                    
                                       
                                          Θ
                                       
                                       
                                          M
                                       
                                    
                                    ,
                                    Z
                                    ,
                                    φ
                                    )
                                 
                                 
                                    ∂
                                    
                                       
                                          β
                                       
                                       
                                          j
                                          k
                                       
                                    
                                 
                              
                              =
                              
                                 ∑
                                 
                                    i
                                    =
                                    1
                                 
                                 N
                              
                              
                                 
                                    
                                       
                                          ω
                                       
                                       
                                          k
                                       
                                    
                                    p
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          i
                                          k
                                       
                                    
                                    |
                                    
                                       
                                          ξ
                                       
                                       
                                          j
                                          k
                                       
                                    
                                    )
                                 
                                 
                                    
                                       ζ
                                    
                                    
                                       i
                                       j
                                       k
                                    
                                 
                              
                              h
                              (
                              j
                              |
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    Θ
                                 
                                 
                                    M
                                 
                              
                              )
                              {
                              
                                 1
                                 
                                    
                                       β
                                    
                                    
                                       j
                                       k
                                    
                                 
                              
                              +
                              
                                 3
                                 2
                              
                              (
                              
                                 
                                    ψ
                                    (
                                    1
                                    /
                                    
                                       
                                          β
                                       
                                       
                                          j
                                          k
                                       
                                    
                                    )
                                    −
                                    ψ
                                    (
                                    3
                                    /
                                    
                                       
                                          β
                                       
                                       
                                          j
                                          k
                                       
                                    
                                    )
                                 
                                 
                                    
                                       β
                                    
                                    
                                       j
                                       k
                                    
                                    
                                       2
                                    
                                 
                              
                              )
                              −
                              
                                 
                                    f
                                 
                                 
                                    i
                                    j
                                    k
                                 
                              
                              }
                           
                        
                     
                     
                        
                           (B.4)
                           
                              
                                 
                                    
                                       
                                          ∂
                                       
                                       
                                          2
                                       
                                    
                                    L
                                    (
                                    X
                                    ,
                                    
                                       
                                          Θ
                                       
                                       
                                          M
                                       
                                    
                                    ,
                                    Z
                                    ,
                                    φ
                                    )
                                 
                                 
                                    ∂
                                    
                                       
                                          β
                                       
                                       
                                          j
                                          k
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              =
                              
                                 ∑
                                 
                                    i
                                    =
                                    1
                                 
                                 N
                              
                              
                                 
                                    
                                       
                                          ω
                                       
                                       
                                          k
                                       
                                    
                                    p
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          i
                                          k
                                       
                                    
                                    |
                                    
                                       
                                          ξ
                                       
                                       
                                          j
                                          k
                                       
                                    
                                    )
                                 
                                 
                                    
                                       ζ
                                    
                                    
                                       i
                                       j
                                       k
                                    
                                 
                              
                              h
                              (
                              j
                              |
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    Θ
                                 
                                 
                                    M
                                 
                              
                              )
                              {
                              
                                 
                                    −
                                    1
                                 
                                 
                                    
                                       β
                                    
                                    
                                       j
                                       k
                                    
                                    
                                       2
                                    
                                 
                              
                              +
                              
                                 3
                                 2
                              
                              (
                              
                                 
                                    3
                                    
                                       
                                          ψ
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    3
                                    /
                                    
                                       
                                          β
                                       
                                       
                                          j
                                          k
                                       
                                    
                                    )
                                    −
                                    
                                       
                                          ψ
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    1
                                    /
                                    
                                       
                                          β
                                       
                                       
                                          j
                                          k
                                       
                                    
                                    )
                                 
                                 
                                    
                                       β
                                    
                                    
                                       j
                                       k
                                    
                                    
                                       4
                                    
                                 
                              
                              )
                              −
                              3
                              (
                              
                                 
                                    ψ
                                    (
                                    1
                                    /
                                    
                                       
                                          β
                                       
                                       
                                          j
                                          k
                                       
                                    
                                    )
                                    −
                                    ψ
                                    (
                                    3
                                    /
                                    
                                       
                                          β
                                       
                                       
                                          j
                                          k
                                       
                                    
                                    )
                                 
                                 
                                    
                                       β
                                    
                                    
                                       j
                                       k
                                    
                                    
                                       3
                                    
                                 
                              
                              )
                              −
                              
                                 
                                    t
                                 
                                 
                                    i
                                    j
                                    k
                                 
                              
                              }
                           
                        
                     
                     
                        
                           (B.5)
                           
                              
                                 
                                    ∂
                                    L
                                    (
                                    X
                                    ,
                                    
                                       
                                          Θ
                                       
                                       
                                          M
                                       
                                    
                                    ,
                                    Z
                                    ,
                                    φ
                                    )
                                 
                                 
                                    ∂
                                    
                                       
                                          σ
                                       
                                       
                                          
                                             
                                                l
                                             
                                             
                                                j
                                                k
                                             
                                          
                                       
                                    
                                 
                              
                              =
                              
                                 ∑
                                 
                                    i
                                    =
                                    1
                                 
                                 N
                              
                              
                                 
                                    
                                       
                                          ω
                                       
                                       
                                          k
                                       
                                    
                                    p
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          i
                                          k
                                       
                                    
                                    |
                                    
                                       
                                          ξ
                                       
                                       
                                          j
                                          k
                                       
                                    
                                    )
                                 
                                 
                                    
                                       ζ
                                    
                                    
                                       i
                                       j
                                       k
                                    
                                 
                              
                              h
                              (
                              j
                              |
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    Θ
                                 
                                 
                                    M
                                 
                              
                              )
                              {
                              
                                 
                                    o
                                 
                                 
                                    
                                       
                                          l
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                 
                              
                              −
                              
                                 1
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          
                                             
                                                l
                                             
                                             
                                                j
                                                k
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          σ
                                       
                                       
                                          
                                             
                                                r
                                             
                                             
                                                j
                                                k
                                             
                                          
                                       
                                    
                                 
                              
                              }
                           
                        
                     
                     
                        
                           (B.6)
                           
                              
                                 
                                    
                                       
                                          ∂
                                       
                                       
                                          2
                                       
                                    
                                    L
                                    (
                                    X
                                    ,
                                    
                                       
                                          Θ
                                       
                                       
                                          M
                                       
                                    
                                    ,
                                    Z
                                    ,
                                    φ
                                    )
                                 
                                 
                                    ∂
                                    
                                       
                                          σ
                                       
                                       
                                          
                                             
                                                l
                                             
                                             
                                                j
                                                k
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              =
                              
                                 ∑
                                 
                                    i
                                    =
                                    1
                                 
                                 N
                              
                              
                                 
                                    
                                       
                                          ω
                                       
                                       
                                          k
                                       
                                    
                                    p
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          i
                                          k
                                       
                                    
                                    |
                                    
                                       
                                          ξ
                                       
                                       
                                          j
                                          k
                                       
                                    
                                    )
                                 
                                 
                                    
                                       ζ
                                    
                                    
                                       i
                                       j
                                       k
                                    
                                 
                              
                              h
                              (
                              j
                              |
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    Θ
                                 
                                 
                                    M
                                 
                              
                              )
                              {
                              
                                 1
                                 
                                    
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             
                                                
                                                   l
                                                
                                                
                                                   j
                                                   k
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             σ
                                          
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   j
                                                   k
                                                
                                             
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                              
                              −
                              
                                 
                                    s
                                 
                                 
                                    
                                       
                                          l
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                 
                              
                              }
                           
                        
                     
                     
                        
                           (B.7)
                           
                              
                                 
                                    ∂
                                    L
                                    (
                                    X
                                    ,
                                    
                                       
                                          Θ
                                       
                                       
                                          M
                                       
                                    
                                    ,
                                    Z
                                    ,
                                    φ
                                    )
                                 
                                 
                                    ∂
                                    
                                       
                                          σ
                                       
                                       
                                          
                                             
                                                r
                                             
                                             
                                                j
                                                k
                                             
                                          
                                       
                                    
                                 
                              
                              =
                              
                                 ∑
                                 
                                    i
                                    =
                                    1
                                 
                                 N
                              
                              
                                 
                                    
                                       
                                          ω
                                       
                                       
                                          k
                                       
                                    
                                    p
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          i
                                          k
                                       
                                    
                                    |
                                    
                                       
                                          ξ
                                       
                                       
                                          j
                                          k
                                       
                                    
                                    )
                                 
                                 
                                    
                                       ζ
                                    
                                    
                                       i
                                       j
                                       k
                                    
                                 
                              
                              h
                              (
                              j
                              |
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    Θ
                                 
                                 
                                    M
                                 
                              
                              )
                              {
                              
                                 
                                    o
                                 
                                 
                                    
                                       
                                          r
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                 
                              
                              −
                              
                                 1
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          
                                             
                                                l
                                             
                                             
                                                j
                                                k
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          σ
                                       
                                       
                                          
                                             
                                                r
                                             
                                             
                                                j
                                                k
                                             
                                          
                                       
                                    
                                 
                              
                              }
                           
                        
                     
                     
                        
                           (B.8)
                           
                              
                                 
                                    
                                       
                                          ∂
                                       
                                       
                                          2
                                       
                                    
                                    L
                                    (
                                    X
                                    ,
                                    
                                       
                                          Θ
                                       
                                       
                                          M
                                       
                                    
                                    ,
                                    Z
                                    ,
                                    φ
                                    )
                                 
                                 
                                    ∂
                                    
                                       
                                          σ
                                       
                                       
                                          
                                             
                                                r
                                             
                                             
                                                j
                                                k
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              =
                              
                                 ∑
                                 
                                    i
                                    =
                                    1
                                 
                                 N
                              
                              
                                 
                                    
                                       
                                          ω
                                       
                                       
                                          k
                                       
                                    
                                    p
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          i
                                          k
                                       
                                    
                                    |
                                    
                                       
                                          ξ
                                       
                                       
                                          j
                                          k
                                       
                                    
                                    )
                                 
                                 
                                    
                                       ζ
                                    
                                    
                                       i
                                       j
                                       k
                                    
                                 
                              
                              h
                              (
                              j
                              |
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          →
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    Θ
                                 
                                 
                                    M
                                 
                              
                              )
                              {
                              
                                 1
                                 
                                    
                                       (
                                       
                                          
                                             σ
                                          
                                          
                                             
                                                
                                                   l
                                                
                                                
                                                   j
                                                   k
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             σ
                                          
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   j
                                                   k
                                                
                                             
                                          
                                       
                                       )
                                    
                                    
                                       2
                                    
                                 
                              
                              −
                              
                                 
                                    s
                                 
                                 
                                    
                                       
                                          r
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                 
                              
                              }
                           
                        
                      where
                        
                           (B.9)
                           
                              
                                 
                                    f
                                 
                                 
                                    i
                                    j
                                    k
                                 
                              
                              =
                              A
                              (
                              
                                 
                                    β
                                 
                                 
                                    j
                                    k
                                 
                              
                              )
                              
                                 
                                    c
                                 
                                 
                                    i
                                    j
                                    k
                                 
                                 
                                    
                                       
                                          β
                                       
                                       
                                          j
                                          k
                                       
                                    
                                 
                              
                              {
                              ln
                              ⁡
                              
                                 
                                    c
                                 
                                 
                                    i
                                    j
                                    k
                                 
                              
                              +
                              
                                 
                                    d
                                 
                                 
                                    j
                                    k
                                 
                              
                              +
                              
                                 
                                    e
                                 
                                 
                                    j
                                    k
                                 
                              
                              }
                           
                        
                     
                     
                        
                           (B.10)
                           
                              
                                 
                                    t
                                 
                                 
                                    i
                                    j
                                    k
                                 
                              
                              =
                              A
                              (
                              
                                 
                                    β
                                 
                                 
                                    j
                                    k
                                 
                              
                              )
                              
                                 
                                    c
                                 
                                 
                                    i
                                    j
                                    k
                                 
                                 
                                    
                                       
                                          β
                                       
                                       
                                          j
                                          k
                                       
                                    
                                 
                              
                              {
                              
                                 
                                    9
                                    
                                       
                                          ψ
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    3
                                    /
                                    
                                       
                                          β
                                       
                                       
                                          j
                                          k
                                       
                                    
                                    )
                                    −
                                    
                                       
                                          ψ
                                       
                                       
                                          ′
                                       
                                    
                                    (
                                    1
                                    /
                                    
                                       
                                          β
                                       
                                       
                                          j
                                          k
                                       
                                    
                                    )
                                 
                                 
                                    2
                                    
                                       
                                          β
                                       
                                       
                                          j
                                          k
                                       
                                       
                                          3
                                       
                                    
                                 
                              
                              +
                              
                                 
                                    [
                                    ln
                                    ⁡
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                    +
                                    
                                       
                                          d
                                       
                                       
                                          j
                                          k
                                       
                                    
                                    +
                                    
                                       
                                          e
                                       
                                       
                                          j
                                          k
                                       
                                    
                                    ]
                                 
                                 
                                    2
                                 
                              
                              }
                           
                        
                     
                     
                        
                           (B.11)
                           
                              
                                 
                                    o
                                 
                                 
                                    
                                       
                                          l
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                 
                              
                              =
                              
                                 {
                                 
                                    
                                       
                                          A
                                          (
                                          
                                             
                                                β
                                             
                                             
                                                j
                                                k
                                             
                                          
                                          )
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   j
                                                   k
                                                
                                             
                                             
                                                
                                                   σ
                                                
                                                
                                                   
                                                      
                                                         l
                                                      
                                                      
                                                         j
                                                         k
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                c
                                             
                                             
                                                i
                                                j
                                                k
                                             
                                             
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      j
                                                      k
                                                   
                                                
                                             
                                          
                                       
                                       
                                          if
                                          
                                          
                                             
                                                X
                                             
                                             
                                                i
                                                k
                                             
                                          
                                          <
                                          
                                             
                                                μ
                                             
                                             
                                                j
                                                k
                                             
                                          
                                       
                                    
                                    
                                       
                                          0
                                       
                                       
                                          if
                                          
                                          
                                             
                                                X
                                             
                                             
                                                i
                                                k
                                             
                                          
                                          ≥
                                          
                                             
                                                μ
                                             
                                             
                                                j
                                                k
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (B.12)
                           
                              
                                 
                                    o
                                 
                                 
                                    
                                       
                                          r
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                 
                              
                              =
                              
                                 {
                                 
                                    
                                       
                                          0
                                       
                                       
                                          if
                                          
                                          
                                             
                                                X
                                             
                                             
                                                i
                                                k
                                             
                                          
                                          <
                                          
                                             
                                                μ
                                             
                                             
                                                j
                                                k
                                             
                                          
                                       
                                    
                                    
                                       
                                          A
                                          (
                                          
                                             
                                                β
                                             
                                             
                                                j
                                                k
                                             
                                          
                                          )
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   j
                                                   k
                                                
                                             
                                             
                                                
                                                   σ
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         j
                                                         k
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                c
                                             
                                             
                                                i
                                                j
                                                k
                                             
                                             
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      j
                                                      k
                                                   
                                                
                                             
                                          
                                       
                                       
                                          if
                                          
                                          
                                             
                                                X
                                             
                                             
                                                i
                                                k
                                             
                                          
                                          ≥
                                          
                                             
                                                μ
                                             
                                             
                                                j
                                                k
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (B.13)
                           
                              
                                 
                                    s
                                 
                                 
                                    
                                       
                                          l
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    o
                                 
                                 
                                    
                                       
                                          l
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                 
                              
                              
                                 
                                    (
                                    
                                       
                                          β
                                       
                                       
                                          j
                                          k
                                       
                                    
                                    +
                                    1
                                    )
                                 
                                 
                                    
                                       σ
                                    
                                    
                                       
                                          
                                             l
                                          
                                          
                                             j
                                             k
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (B.14)
                           
                              
                                 
                                    s
                                 
                                 
                                    
                                       
                                          r
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    o
                                 
                                 
                                    
                                       
                                          r
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                 
                              
                              
                                 
                                    (
                                    
                                       
                                          β
                                       
                                       
                                          j
                                          k
                                       
                                    
                                    +
                                    1
                                    )
                                 
                                 
                                    
                                       σ
                                    
                                    
                                       
                                          
                                             r
                                          
                                          
                                             j
                                             k
                                          
                                       
                                    
                                 
                              
                           
                        
                      and
                        
                           (B.15)
                           
                              
                                 
                                    c
                                 
                                 
                                    i
                                    j
                                    k
                                 
                              
                              =
                              
                                 {
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      j
                                                      k
                                                   
                                                
                                                −
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      i
                                                      k
                                                   
                                                
                                             
                                             
                                                
                                                   σ
                                                
                                                
                                                   
                                                      
                                                         l
                                                      
                                                      
                                                         j
                                                         k
                                                      
                                                   
                                                
                                             
                                          
                                          )
                                       
                                       
                                          if
                                          
                                          
                                             
                                                X
                                             
                                             
                                                i
                                                k
                                             
                                          
                                          <
                                          
                                             
                                                μ
                                             
                                             
                                                j
                                                k
                                             
                                          
                                       
                                    
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      i
                                                      k
                                                   
                                                
                                                −
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      j
                                                      k
                                                   
                                                
                                             
                                             
                                                
                                                   σ
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         j
                                                         k
                                                      
                                                   
                                                
                                             
                                          
                                          )
                                       
                                       
                                          if
                                          
                                          
                                             
                                                X
                                             
                                             
                                                i
                                                k
                                             
                                          
                                          ≥
                                          
                                             
                                                μ
                                             
                                             
                                                j
                                                k
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (B.16)
                           
                              
                                 
                                    d
                                 
                                 
                                    j
                                    k
                                 
                              
                              =
                              
                                 
                                    ψ
                                    (
                                    1
                                    /
                                    
                                       
                                          β
                                       
                                       
                                          j
                                          k
                                       
                                    
                                    )
                                    −
                                    3
                                    ψ
                                    (
                                    3
                                    /
                                    
                                       
                                          β
                                       
                                       
                                          j
                                          k
                                       
                                    
                                    )
                                 
                                 
                                    2
                                    
                                       
                                          β
                                       
                                       
                                          j
                                          k
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (B.17)
                           
                              
                                 
                                    e
                                 
                                 
                                    j
                                    k
                                 
                              
                              =
                              
                                 1
                                 2
                              
                              ln
                              ⁡
                              (
                              
                                 
                                    Γ
                                    (
                                    3
                                    /
                                    
                                       
                                          β
                                       
                                       
                                          j
                                          k
                                       
                                    
                                    )
                                 
                                 
                                    Γ
                                    (
                                    1
                                    /
                                    
                                       
                                          β
                                       
                                       
                                          j
                                          k
                                       
                                    
                                    )
                                 
                              
                              )
                           
                        
                     
                  


                     
                        
                           (C.1)
                           
                              
                                 
                                    ∂
                                    p
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          i
                                          k
                                       
                                    
                                    |
                                    
                                       
                                          ξ
                                       
                                       
                                          j
                                          k
                                       
                                       
                                          old
                                       
                                    
                                    )
                                 
                                 
                                    ∂
                                    
                                       
                                          μ
                                       
                                       
                                          j
                                          k
                                       
                                    
                                 
                              
                              =
                              p
                              (
                              
                                 
                                    X
                                 
                                 
                                    i
                                    k
                                 
                              
                              |
                              
                                 
                                    ξ
                                 
                                 
                                    j
                                    k
                                 
                                 
                                    old
                                 
                              
                              )
                              
                                 
                                    κ
                                 
                                 
                                    i
                                    j
                                    k
                                 
                              
                           
                        
                     
                     
                        
                           (C.2)
                           
                              
                                 
                                    ∂
                                    p
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          i
                                          k
                                       
                                    
                                    |
                                    
                                       
                                          ξ
                                       
                                       
                                          j
                                          k
                                       
                                       
                                          old
                                       
                                    
                                    )
                                 
                                 
                                    ∂
                                    
                                       
                                          β
                                       
                                       
                                          j
                                          k
                                       
                                    
                                 
                              
                              =
                              p
                              (
                              
                                 
                                    X
                                 
                                 
                                    i
                                    k
                                 
                              
                              |
                              
                                 
                                    ξ
                                 
                                 
                                    j
                                    k
                                 
                                 
                                    old
                                 
                              
                              )
                              
                                 
                                    ρ
                                 
                                 
                                    i
                                    j
                                    k
                                 
                              
                           
                        
                     
                     
                        
                           (C.3)
                           
                              
                                 
                                    ∂
                                    p
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          i
                                          k
                                       
                                    
                                    |
                                    
                                       
                                          ξ
                                       
                                       
                                          j
                                          k
                                       
                                       
                                          old
                                       
                                    
                                    )
                                 
                                 
                                    ∂
                                    
                                       
                                          σ
                                       
                                       
                                          
                                             
                                                l
                                             
                                             
                                                j
                                                k
                                             
                                          
                                       
                                    
                                 
                              
                              =
                              p
                              (
                              
                                 
                                    X
                                 
                                 
                                    i
                                    k
                                 
                              
                              |
                              
                                 
                                    ξ
                                 
                                 
                                    j
                                    k
                                 
                                 
                                    old
                                 
                              
                              )
                              
                                 
                                    τ
                                 
                                 
                                    
                                       
                                          l
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (C.4)
                           
                              
                                 
                                    ∂
                                    p
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          i
                                          k
                                       
                                    
                                    |
                                    
                                       
                                          ξ
                                       
                                       
                                          j
                                          k
                                       
                                       
                                          old
                                       
                                    
                                    )
                                 
                                 
                                    ∂
                                    
                                       
                                          σ
                                       
                                       
                                          
                                             
                                                r
                                             
                                             
                                                j
                                                k
                                             
                                          
                                       
                                    
                                 
                              
                              =
                              p
                              (
                              
                                 
                                    X
                                 
                                 
                                    i
                                    k
                                 
                              
                              |
                              
                                 
                                    ξ
                                 
                                 
                                    j
                                    k
                                 
                                 
                                    old
                                 
                              
                              )
                              
                                 
                                    τ
                                 
                                 
                                    
                                       
                                          r
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                 
                              
                           
                        
                      and
                        
                           (C.5)
                           
                              
                                 
                                    κ
                                 
                                 
                                    i
                                    j
                                    k
                                 
                              
                              =
                              
                                 {
                                 
                                    
                                       
                                          −
                                          A
                                          (
                                          
                                             
                                                β
                                             
                                             
                                                j
                                                k
                                             
                                          
                                          )
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   j
                                                   k
                                                
                                             
                                             
                                                
                                                   σ
                                                
                                                
                                                   
                                                      
                                                         l
                                                      
                                                      
                                                         j
                                                         k
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            μ
                                                         
                                                         
                                                            j
                                                            k
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            i
                                                            k
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         
                                                            
                                                               l
                                                            
                                                            
                                                               j
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      j
                                                      k
                                                   
                                                
                                                −
                                                1
                                             
                                          
                                       
                                       
                                          if
                                          
                                          
                                             
                                                X
                                             
                                             
                                                i
                                                k
                                             
                                          
                                          <
                                          
                                             
                                                μ
                                             
                                             
                                                j
                                                k
                                             
                                          
                                       
                                    
                                    
                                       
                                          A
                                          (
                                          
                                             
                                                β
                                             
                                             
                                                j
                                                k
                                             
                                          
                                          )
                                          
                                             
                                                
                                                   β
                                                
                                                
                                                   j
                                                   k
                                                
                                             
                                             
                                                
                                                   σ
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         j
                                                         k
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            i
                                                            k
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            μ
                                                         
                                                         
                                                            j
                                                            k
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         
                                                            
                                                               r
                                                            
                                                            
                                                               j
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      j
                                                      k
                                                   
                                                
                                                −
                                                1
                                             
                                          
                                       
                                       
                                          if
                                          
                                          
                                             
                                                X
                                             
                                             
                                                i
                                                k
                                             
                                          
                                          ≥
                                          
                                             
                                                μ
                                             
                                             
                                                j
                                                k
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (C.6)
                           
                              
                                 
                                    ρ
                                 
                                 
                                    i
                                    j
                                    k
                                 
                              
                              =
                              
                                 1
                                 
                                    
                                       β
                                    
                                    
                                       j
                                       k
                                    
                                 
                              
                              +
                              
                                 3
                                 2
                              
                              (
                              
                                 
                                    ψ
                                    (
                                    1
                                    /
                                    
                                       
                                          β
                                       
                                       
                                          j
                                          k
                                       
                                    
                                    )
                                    −
                                    ψ
                                    (
                                    3
                                    /
                                    
                                       
                                          β
                                       
                                       
                                          j
                                          k
                                       
                                    
                                    )
                                 
                                 
                                    
                                       β
                                    
                                    
                                       j
                                       k
                                    
                                    
                                       2
                                    
                                 
                              
                              )
                              −
                              
                                 
                                    f
                                 
                                 
                                    i
                                    j
                                    k
                                 
                              
                           
                        
                     
                     
                        
                           (C.7)
                           
                              
                                 
                                    τ
                                 
                                 
                                    
                                       
                                          l
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    o
                                 
                                 
                                    
                                       
                                          l
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                 
                              
                              −
                              
                                 1
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          
                                             
                                                l
                                             
                                             
                                                j
                                                k
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          σ
                                       
                                       
                                          
                                             
                                                r
                                             
                                             
                                                j
                                                k
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (C.8)
                           
                              
                                 
                                    τ
                                 
                                 
                                    
                                       
                                          r
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    o
                                 
                                 
                                    
                                       
                                          r
                                       
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                 
                              
                              −
                              
                                 1
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          
                                             
                                                l
                                             
                                             
                                                j
                                                k
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          σ
                                       
                                       
                                          
                                             
                                                r
                                             
                                             
                                                j
                                                k
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

@&#REFERENCES@&#

