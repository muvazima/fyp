@&#MAIN-TITLE@&#Calibration of mirror position and extrinsic parameters in axial non-central catadioptric systems

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We propose a novel calibration method for non-central catadioptric systems.


                        
                        
                           
                           We assume an axial symmetrical mirror and a pinhole camera placed on the mirror axis.


                        
                        
                           
                           The calibration estimates the camera/mirror position and the extrinsic parameters.


                        
                        
                           
                           The procedure requires a single image of a (possibly planar) calibration object.


                        
                        
                           
                           The Direct-Linear-Transformation algorithm and cross-ratio are used.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Non-central catadioptric vision systems

Calibration

Axial symmetric mirrors

@&#ABSTRACT@&#


               
               
                  We propose a novel calibration method for catadioptric systems made up of an axial symmetrical mirror and a pinhole camera with its optical center located at the mirror axis. The calibration estimates the relative camera/mirror position and the extrinsic rotation and translation w.r.t. the world frame. The procedure requires a single image of a (possibly planar) calibration object. We show how most of the calibration parameters can be estimated using linear methods (Direct-Linear-Transformation algorithm) and cross-ratio. Two remaining parameters are obtained by using non-linear optimization. We present experimental results on simulated and real images.
               
            

@&#INTRODUCTION@&#

Catadioptric vision systems use a combination of cameras and mirrors to acquire images. They can provide some advantages over more traditional camera systems, namely in terms of increased field-of-view (usually through reflection off curved mirrors) and/or single image multi-view geometry (with the use of multiple mirrors). Several configurations have been proposed and studied, alongside with tailor-made or more generic calibration methods.

Central catadioptric systems [1] allow for a single-viewpoint projection model, by the use of particular mirror shapes restrictively aligned with an orthographic or perspective camera. Calibration methods for these systems include using the image of lines in the scene [2–4], self-calibration using tracked point on several images [5,6] or using a calibration pattern [3,7–9]. A recent review and comparison of calibration techniques focusing on central systems can be found in [10].

Some calibration methods propose a general, un-parameterized, camera [11–13]. These can model central and non-central catadioptric systems, as well as more unconventional camera designs. The intrinsic calibration of the camera consists on associating a 3D direction with each pixel in image.

Most non-central catadioptric systems are modeled as a perspective camera and an axial symmetric mirror of conical section (sphere, paraboloid, ellipsoid and hyperboloid). The geometry of image formation is dependent on the intrinsic parameters of the camera, on the particular shape and relative position of the mirror. Some calibration methods assume an independent calibration of the perspective camera [14–16], which can be robustly achieved using well-established techniques for conventional cameras. Many consider the mirror shape to be accurately known from the manufacturing process [17–20]. The mirror pose w.r.t. the camera is often estimated by identifying the mirror boundaries in the image (usually a conic) [17,14,21,6,20].

Self-calibration approaches use point correspondences on several (at least two) images [22,17,23]. Caglioti et al. [24] used the reflected image of lines on axial-symmetric mirrors as the calibration object. Sagawa et al. [25] applied projected parallel light to estimate mirror location. Grossberg and Nayar [26] and Tardif and Sturm [27] used a computer screen and a projector to generate coded structured-light calibration patterns and achieve a dense mapping of the image pixels. Morel and Fofi [28] used polarized light.

A comprehensive survey of camera models used in panoramic image acquisition devices, as well as calibration approaches, is presented in [29].

@&#PROPOSED METHOD@&#

Our paper presents a novel calibration method for axial catadioptric systems. By “axial catadioptric” [21] we mean a vision system made up of a pinhole camera and a mirror, such that
                           
                              •
                              The mirror is rotationally symmetric around an axis.

The camera’s optical center is placed on the mirror’s axis.

There are no additional constraints on the relative position of the camera and mirror. The camera’s principal axis is not necessarily aligned with the axis of the mirror.

The constraint of placing the projective camera’s optical center on the mirror axis is acceptable for most systems. When using spherical mirrors, this constraint becomes irrelevant, as a symmetry axis passing through the camera always exists. We note that, although we focus on non-central systems, this model also includes central cameras. Our calibration technique can be easily applied to dioptric systems of similar characteristics, like fisheye lenses.

Our method is capable of calibrating
                           
                              •
                              The mirror position w.r.t. the pinhole camera.

The extrinsic parameters of the camera, i.e., pose w.r.t. world coordinates.

It uses a single image of a known point pattern, i.e., a calibration object. This calibration object can be planar, although, as we will show, additional processing is required in that case.

The method is divided in three steps, executed in sequence. The first step estimates the intersection point between the mirror axis and the image plane, which we will call the vertex point. In systems where the camera is aligned with the mirror, this point coincides with the image center. The calibration is achieved by using the cross-ratio as an invariant in our axial-symmetric projection model. This property was first noted by Wu and Hu in [30]. Although their paper was focused on central systems, the underlying principle is the same. We provide, however, proof of its applicability to our model, geometrical insight about the procedure (the solution is derived from the intersection of conical loci in the image) and additional techniques to deal we noise.

The second step estimates the extrinsic rotation and translation of the camera coordinate frame w.r.t. the world reference frame. The rotation matrix is completely determined while the translation vector is estimated up to one unknown component (the Z-component).

The method relies on establishing a linear projection from 3D world points to a 1D image feature, which is possible given the axial catadioptric geometry. A similar 3D–1D linear mapping was used by Thirthala and Pollefeys [31] in a self-calibration framework. Although it does not rely on knowledge of the scene structure, their method requires at least 15 point correspondences in 4 views (for non-central cameras).

We show how the Direct-Linear-Transformation (DLT) algorithm [32] can be used to recover the extrinsic parameters from a set of world-to-image point correspondences. No knowledge of the mirror shape (besides the axial symmetry) is needed at this stage. We assume, however, that the pinhole camera is internally calibrated (a common assumption, e.g. [33,14,18,34]).

The third and final step estimates the remaining calibration parameters: the distance from camera to mirror along the symmetry axis and the undetermined component of the extrinsic translation. It takes into account the complete (non-linear) projection geometry of the system and depends on the mirror shape, which is assumed to be known a priori. The procedure relies on non-linear optimization methods (e.g. Levenberg–Marquardt algorithm). Non-linear optimization and bundle-adjustment are recurring techniques in these types of systems (e.g. [23,22,17,21]), but we perform the optimization in a single parameter and show that a precise initial estimate is not required for convergence.

Some background concepts regarding cross-ratio and vector representation of conic curves are briefly reviewed in Appendix A. The notation used throughout the paper is now introduced.

Vectors are denoted by bold symbols. Homogeneous coordinates of points in 
                           
                              
                                 
                                    P
                                 
                                 
                                    3
                                 
                              
                           
                         are represented in upper-case bold symbols (e.g. X), points in 
                           
                              
                                 
                                    P
                                 
                                 
                                    2
                                 
                              
                           
                         are in lower-case (e.g. x) and points in 
                           
                              
                                 
                                    P
                                 
                                 
                                    1
                                 
                              
                           
                         are represent in lower-case with an overbar (e.g. 
                           
                              
                                 
                                    x
                                 
                                 
                                    ¯
                                 
                              
                           
                        ). A tilded symbol denotes an inhomogeneous vector (e.g. 
                           
                              
                                 
                                    X
                                 
                                 
                                    ∼
                                 
                              
                           
                        ).

Matrices are represented by symbols in sans serif font (e.g. R). The superscript “
                           r
                           
                              i
                           
                        ” denotes the ith row of a matrix, as in 
                           
                              
                                 
                                    R
                                 
                                 
                                    
                                       
                                          r
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                           
                        .

Equality of matrices or vectors up to a scalar factor is written as “∼”.

The following sections are organized as follows. Section 2 discusses the system geometry assumed by our method and deduces the linear projection equation that can be established from 3D world points to 1D image features. Section 3 describes the estimation of the vertex point (the intersection point between the image plane and the mirror axis), which is the first calibration parameter to be obtained. Section 4 shows how to estimate the extrinsic parameters, up to one unknown translation component, using a linear method based on the DLT algorithm. The estimation of the two remaining parameters, the distance between camera and mirror and the unknown translation component, is addressed in Section 5. Experimental results are presented in Section 6. Finally, Section 7 presents the conclusions.

We will now discuss the axial catadioptric geometry, and show how a linear projection equation can be established.

Consider Fig. 1
                        a. Let C be the camera’s optical center and X a point in the world. An incident ray from X intersects the mirror’s surface at point S and is reflected to the camera, forming the reflected image of the world point, denoted by s.

From the laws of reflection, we know that the incident ray, the reflected ray and the surface’s normal at point S must belong to the same plane. Also in this plane is the direct projection ray, i.e., the projective line, from X to C, that forms the real (not reflected) image of X, denoted by x. We refer to this plane as a projection plane, in the sense that it contains the direct and reflected projection rays of a given point in space.

As a consequence of the previous assumptions made on system geometry, every projection plane is part of a pencil of planes, with the mirror axis as the common intersection line. Furthermore, this pencil of planes is projected in the image plane as a pencil of lines, where the common point, o, is the image of the axis (see Fig. 1b). For every world point X, there is a line in the image passing through its reflected image s, its direct image x, and the image of the axis o (the vertex point).

Changes in camera orientation (i.e., rotation around the optical center) induce homographic transformations in the image (c.f. [32]) and, of course, do not affect the collinearity between s, x and o. Thus, the pencil of projection planes are always imaged as a pencil of lines, as long as the center of the camera is placed on the mirror axis. In the particular configuration where the camera’s principal axis is coincident with the mirror axis (which is of great practical interest, e.g., in central catadioptric systems), point o becomes the principal point of the image.

It should be noted that the direct image of a point, x, is in most practical situations not visible in the image, because it is out of the field-of-view or behind the camera. This fact does not change, obviously, the validity of the discussion. In the algorithms we present in this paper, the position of x is always assumed to be unknown.

Now, let 
                           
                              x
                              ∼
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   y
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    ⊤
                                 
                              
                           
                        and 
                           
                              s
                              ∼
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    ⊤
                                 
                              
                           
                        be the direct and reflected image of X, respectively, and 
                           
                              o
                              ∼
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         o
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         o
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    ⊤
                                 
                              
                           
                        be the vertex of pencil. Each line on the pencil can be specified by a single parameter, that we will define to be the line slope. Thus, the line containing point x and passing through the vertex o, is specified by the slope 
                           
                              
                                 
                                    x
                                    -
                                    
                                       
                                          o
                                       
                                       
                                          x
                                       
                                    
                                 
                                 
                                    y
                                    -
                                    
                                       
                                          o
                                       
                                       
                                          y
                                       
                                    
                                 
                              
                           
                        .

We define the 1D homogenous vector
                           
                              
                                 
                                    
                                       x
                                    
                                    
                                       ¯
                                    
                                 
                                 ∼
                                 
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                   -
                                                   
                                                      
                                                         o
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   y
                                                   -
                                                   
                                                      
                                                         o
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ∼
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                         -
                                                         
                                                            
                                                               o
                                                            
                                                            
                                                               x
                                                            
                                                         
                                                      
                                                      
                                                         y
                                                         -
                                                         
                                                            
                                                               o
                                                            
                                                            
                                                               y
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        as the reduced coordinates of point x. Vector 
                           
                              
                                 
                                    x
                                 
                                 
                                    ¯
                                 
                              
                           
                         uniquely specifies the line in the pencil that x belongs to. Note that, because 
                           
                              
                                 
                                    x
                                 
                                 
                                    ¯
                                 
                              
                           
                         is an homogenous vector, infinite slopes can be handled seamlessly.

Since s and x belong to the same line of the pencil, we have
                           
                              (1)
                              
                                 
                                    
                                       x
                                    
                                    
                                       ¯
                                    
                                 
                                 ∼
                                 
                                    
                                       s
                                    
                                    
                                       ¯
                                    
                                 
                                 ∼
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         o
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         o
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

The direct image of world point X is given by the projection equation
                           
                              
                                 x
                                 ∼
                                 K
                                 
                                    
                                       
                                          
                                             
                                                
                                                   R
                                                
                                                
                                                   T
                                                
                                             
                                          
                                       
                                    
                                 
                                 X
                                 ,
                              
                           
                        where K is the intrinsic parameter matrix, and R and T are the extrinsic rotation and translation relating the world reference frame with the camera frame.

Using Eq. (1) we can rewrite the projection equation as
                           
                              (2)
                              
                                 
                                    
                                       s
                                    
                                    
                                       ¯
                                    
                                 
                                 ∼
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               1
                                                            
                                                            
                                                               0
                                                            
                                                            
                                                               -
                                                               
                                                                  
                                                                     o
                                                                  
                                                                  
                                                                     x
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               0
                                                            
                                                            
                                                               1
                                                            
                                                            
                                                               -
                                                               
                                                                  
                                                                     o
                                                                  
                                                                  
                                                                     y
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             K
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               R
                                                            
                                                            
                                                               T
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             ︸
                                          
                                       
                                    
                                    
                                       ∼
                                       P
                                    
                                 
                                 X
                                 .
                              
                           
                        The 2×4 matrix P establishes a linear mapping between points in the world reference frame and a 1D image parameter computed from the image position of the reflected points.

Given enough known correspondences between X and s, matrix P can be obtained up to scale, from Eq. (2), by using the DLT algorithm (Direct Linear Transform) [32]. We note that in the case that all world points X lie in a single plane, the size of the recovered matrix P is reduced to 2×3. This particular case will be addressed in Section 4.4.

In this section we show how the cross-ratio can be used as an invariant under the axial catadioptric geometry to obtain the image of the mirror axis, the vertex point 
                     o. By determining its location, the axis direction w.r.t. the camera frame is immediately defined (assuming an internally calibrated camera).

Consider Fig. 2
                        a. Let A, B, C and D be four collinear 3D points. Consider a, b, c and d to be their reflected images and x
                        
                           a
                        , x
                        
                           b
                        , x
                        
                           c
                         and x
                        
                           d
                         their direct images (i.e., the direct projection in image, not reflected through the mirror).


                        Fig. 2b shows points in the image plane. Being the projection of collinear 3D points, x
                        
                           a
                        , x
                        
                           b
                        , x
                        
                           c
                         and x
                        
                           d
                         are also collinear. Since the cross-ratio is invariant under a projective transformation,
                           
                              
                                 {
                                 
                                    
                                       x
                                    
                                    
                                       a
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       b
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       c
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       d
                                    
                                 
                                 }
                                 =
                                 {
                                 ABCD
                                 }
                                 .
                              
                           
                        Each pair of reflected and direct images of a point (e.g., a and x
                        
                           a
                        ) is on a line that passes through the image of the mirror axis, o, so we can write
                           
                              (3)
                              
                                 {
                                 o
                                 ;
                                 abcd
                                 }
                                 =
                                 {
                                 
                                    
                                       x
                                    
                                    
                                       a
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       b
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       c
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       d
                                    
                                 
                                 }
                                 =
                                 {
                                 ABCD
                                 }
                                 .
                              
                           
                        We see, thus, that the cross-ratio of four collinear space points is the same as the cross-ratio of the lines through their reflected images and the common point o, which is the image of the mirror axis.

Assume that the cross-ratio of a 4-tuple of collinear world points is known, k
                        ={ABCD}. Given the reflected images of these points, a, b, c and d, the location of point o is restricted by (review Eq. (3)):
                           
                              (4)
                              
                                 {
                                 o
                                 ;
                                 abcd
                                 }
                                 =
                                 k
                                 .
                              
                           
                        We can see that, as a direct application of Chasles’ theorem [35], Eq. (4) defines a conic locus of possible solutions for o (see Fig. 3
                        a). It should be noted that the conic is completely defined by the four points, a, b, c and d (belonging to the conic), and the value of the cross-ratio, k.

We now show how to obtain the expression of the conic. Consider Fig. 3b. Let Ψ
                        1 and Ψ
                        2 be degenerate conics, defined by the line pairs (l
                        1, m
                        1) and (l
                        2, m
                        2), respectively, where
                           
                              
                                 
                                    
                                       l
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 a
                                 ×
                                 c
                                 ,
                                 
                                 
                                    
                                       m
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 d
                                 ×
                                 b
                                 ,
                                 
                                 
                                    
                                       l
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 a
                                 ×
                                 b
                                 ,
                                 
                                 
                                    
                                       m
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 c
                                 ×
                                 d
                              
                           
                        and with the conics given (in matrix form) by
                           
                              
                                 
                                    
                                       Ψ
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       l
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       m
                                    
                                    
                                       i
                                    
                                    
                                       ⊤
                                    
                                 
                                 +
                                 
                                    
                                       m
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       l
                                    
                                    
                                       i
                                    
                                    
                                       ⊤
                                    
                                 
                                 ,
                                 
                                 i
                                 =
                                 1
                                 ,
                                 2
                              
                           
                        It can be verified that the conic locus of point o can be obtained from these degenerate conics and the cross-ratio by the expression
                           1
                           This expression is valid for a cross-ratio calculated using the formula in (A.1). Alternative formulas for the cross-ratio produce different combinations of points in the expressions of l
                              
                                 i
                               and m
                              
                                 i
                              .
                        
                        
                           1
                        :
                           
                              (5)
                              
                                 Ω
                                 ∼
                                 k
                                 
                                 
                                    
                                       Ψ
                                    
                                    
                                       1
                                    
                                 
                                 -
                                 
                                    
                                       Ψ
                                    
                                    
                                       2
                                    
                                 
                              
                           
                        As an additional insight, the conic Ω in Eq. (5) can be viewed as a 1-parameter family of conics (passing through 4 fixed points, a, b, c and d), with that parameter being k, the desired value for the cross-ratio.

Given enough 4-tuples of points in the scene with known cross-ratio, a unique solution for o can be found, corresponding to the common intersection point of all the conic loci. The minimum number of sets of points required to obtain a single solution depends on their location and on the number of intersection points between the conics (as two conics can intersect in up to four points). Assuming general position, three sets of points will normally be sufficient to produce a single solution.

In the presence of noise, however, a common intersection point for the conics may not exist. We can, thus, obtain an estimate for o using the following procedure: Let 
                           ω
                        
                        
                           i
                         be the vector representation (review Eq. (A.2)) of conic Ω
                        
                           i
                        , corresponding to the ith 4-tuple of image points with known cross-ratio. Construct a matrix Q by stacking the conics 
                           ω
                        
                        
                           i
                         for all N sets of tuples:
                           
                              
                                 Q
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ω
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         ⊤
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ⋮
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         ω
                                                      
                                                      
                                                         N
                                                      
                                                      
                                                         ⊤
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        Without noise, the right null space of Q is the solution for o, i.e., 
                           
                              Q
                              
                              
                                 
                                    o
                                 
                                 
                                    ˆ
                                 
                              
                              =
                              0
                           
                        . The estimate for o can, thus, be obtained by picking the eigenvector corresponding to the smallest singular value associated with matrix Q. At least N
                        =6 tuples are required for building Q.


                        Fig. 4
                         shows examples, using real images, of conics generated from 4-tuples of image points and how the common intersection point is the vertex point 
                        o.

If an intersection point does not exist due to noise, the estimate for vector 
                           
                              
                                 
                                    o
                                 
                                 
                                    ˆ
                                 
                              
                           
                         will not belong to the subspace of lifted coordinates (Eq. (A.3)) and the extracted vertex o will be only an approximation. Furthermore, we have found that the cross-ratio conics 
                           ω
                         show a relatively high sensitivity to noise, which degrades the accuracy of the estimate of the vertex point. Fig. 5
                         quantifies this sensitivity. It plots the distance between the cross-ratio conic 
                           ω
                        , obtained from image points corrupted with noise, and the ground truth point o. Since point o should belong to the conic, the distance provides an error measurement.

To improve the accuracy of the estimation of the vertex point, we propose an additional refinement procedure using a non-linear optimization method. The computation of the reduced coordinates 
                        
                           
                              
                                 
                                    s
                                 
                                 
                                    ¯
                                 
                              
                           
                         of a given image point is a function of point o, i.e., 
                           
                              
                                 
                                    s
                                 
                                 
                                    ¯
                                 
                              
                              (
                              o
                              )
                           
                        . Let 
                           
                              {
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              (
                              o
                              )
                              ;
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                              
                              }
                              ,
                              
                              i
                              =
                              1
                              ,
                              .
                              .
                              ,
                              N
                           
                        , denote the set of N world-to-image point correspondences. As stated in the previous section (review Eq. (2)), a linear mapping can be estimated from the set of correspondences using the DLT algorithm.

Consider a function 
                           
                              
                                 
                                    SSV
                                 
                                 
                                    DLT
                                 
                              
                              (
                              {
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              (
                              o
                              )
                              ;
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                              
                              }
                              )
                           
                         that returns the smallest singular value obtained during the Singular-Value-Decomposition factorization of the DLT procedure. The closer to zero the value is, the better the linear mapping fits the set of points. Thus, function SSV
                           DLT
                         can be used to evaluate a candidate point o, quantifying how the estimates for the coordinates of that point fit into the linear projection model.

Starting at the initial solution obtain in the previous subsection, we can refine the estimate for point o by apply non-linear optimization to
                           
                              (6)
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          o
                                       
                                    
                                 
                                 
                                 
                                    
                                       SSV
                                    
                                    
                                       DLT
                                    
                                 
                                 (
                                 {
                                 
                                    
                                       
                                          
                                             s
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 o
                                 )
                                 ;
                                 
                                    
                                       X
                                    
                                    
                                       i
                                    
                                 
                                 }
                                 )
                                 .
                              
                           
                        
                     

In our implementation we used the Levenberg–Marquardt method. Additionally, we used the RANSAC algorithm [32] to handle outliers on the set of point correspondences 
                           
                              {
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              (
                              o
                              )
                              ;
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                              
                              }
                           
                        .


                        Fig. 6
                         shows an example, with a real image, of the output of function SSV
                           DLT
                        .

In this section we show how the extrinsic parameters can be obtained, up to one undetermined component of the translation vector, from a linear method and using a single image of a calibration object. We first consider a generic 3D calibration object, but then adapt the algorithm to handle the case, of practical interest, when all the calibration points belong to a single plane.

We assume that the position of the vertex point 
                     o (discussed in the last section) has already been determined, and that the pinhole camera is internally calibrated. In most cases, the camera can be previously calibrated (internally), without the mirror, using standard methods [36,37].

To derive the method to estimate the extrinsic parameters we assume that the camera is aligned with the mirror, i.e., the camera’s principal axis coincides with the symmetry axis of the mirror, with the camera pointing towards the mirror. This assumption does not imply a loss of generality since a pre-rotation can always be performed to align the camera axis.

Given an internally calibrated camera, the knowledge of point o provides, implicitly, the direction of the mirror axis in the camera reference frame. A rotation can then be calculated that would align the principal axis with that direction.

The alignment rotation is implemented by an homographic transformation in the image. This homography is called a conjugate rotation (c.f. [32], Section 8 and appendix A7) and is given by
                           
                              
                                 H
                                 =
                                 
                                    
                                       KRK
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 ,
                              
                           
                        where K is the intrinsic parameters matrix and R is the rotation matrix. All image points are transformed from their original positions into the aligned camera frame using the homography H. It should be noted that after the alignment the vertex point 
                        o is moved to the image center, i.e., 
                           
                              o
                              ∼
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    ⊤
                                 
                              
                           
                        . In subsequent sections, any reference to an image point (s) assumes an aligned camera.

In many applications (e.g., central systems) the camera is in fact aligned with the mirror, and this initial step is unnecessary.

Please recall that a point in the world reference frame is denoted by X. Point X has known position (belongs to the calibration object). Its projection in the image after reflection from the mirror is denoted by point s. Consider 
                           
                              T
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         z
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    ⊤
                                 
                              
                           
                         to be the extrinsic translation vector and let 
                           
                              
                                 
                                    R
                                 
                                 
                                    
                                       
                                          r
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                         denote the ith row of the extrinsic rotation matrix R.

Assuming that the camera is internally calibrated (K
                        =
                        I) and that the camera frame is aligned with the mirror axis (
                           
                              o
                              ∼
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   0
                                                
                                                
                                                   0
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    ⊤
                                 
                              
                           
                        ), the 2× 4 projection matrix of Eq. (2) is simplified to
                           
                              (7)
                              
                                 
                                    
                                       s
                                    
                                    
                                       ¯
                                    
                                 
                                 ∼
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     R
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           r
                                                                        
                                                                        
                                                                           1
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     t
                                                                  
                                                                  
                                                                     x
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     R
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           r
                                                                        
                                                                        
                                                                           2
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     t
                                                                  
                                                                  
                                                                     y
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             ︸
                                          
                                       
                                    
                                    
                                       ∼
                                       P
                                    
                                 
                                 X
                                 .
                              
                           
                        
                     

As previously discussed, given enough known correspondences between X and s, matrix P can be obtain up to scale, from Eq. (7), by using the DLT algorithm. It should be noted that, for the moment, we are considering a general non-planar calibration object. The case of a planar calibration pattern is analyzed in the next subsection.

Let p
                        
                           ij
                         denote the element of P at row i and column j. Noting that P is determined only up to a scale factor λ, the extrinsic parameters, with the exception of t
                        
                           z
                        , can be recovered from
                           
                              (8)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   R
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             =
                                             λ
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                                  
                                                                     11
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                                  
                                                                     12
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                                  
                                                                     13
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   R
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             =
                                             λ
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                                  
                                                                     21
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                                  
                                                                     22
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                                  
                                                                     23
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   R
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                
                                             
                                             =
                                             
                                                
                                                   R
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             ×
                                             
                                                
                                                   R
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   x
                                                
                                             
                                             =
                                             λ
                                             
                                                
                                                   p
                                                
                                                
                                                   14
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   y
                                                
                                             
                                             =
                                             λ
                                             
                                                
                                                   p
                                                
                                                
                                                   24
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

As 
                           
                              
                                 
                                    R
                                 
                                 
                                    
                                       
                                          r
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                           
                         and 
                           
                              
                                 
                                    R
                                 
                                 
                                    
                                       
                                          r
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                         are normal vectors, the value of λ is subjected to the constraint
                           
                              
                                 ‖
                                 λ
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         11
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         12
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         13
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ‖
                                 =
                                 ‖
                                 λ
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         21
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         22
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         23
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ‖
                                 =
                                 1
                                 ,
                              
                           
                        which yields
                           
                              (9)
                              
                                 λ
                                 =
                                 ±
                                 
                                    
                                       1
                                    
                                    
                                       ‖
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               11
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               12
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               13
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       ‖
                                    
                                 
                                 =
                                 ±
                                 
                                    
                                       1
                                    
                                    
                                       ‖
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               21
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               22
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                            
                                                               23
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       ‖
                                    
                                 
                                 .
                              
                           
                        
                     

The signal ambiguity of λ can be solved by means of a simple procedure, taking into consideration the geometric properties of image formation. Consider (X
                        
                           c
                        , Y
                        
                           c
                        , Z
                        
                           c
                        ) as the coordinates of X in the camera frame. We have that
                           
                              (10)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         c
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         Y
                                                      
                                                      
                                                         c
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         
                                                            
                                                               r
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         
                                                            
                                                               r
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   X
                                                
                                             
                                             
                                                
                                                   Y
                                                
                                             
                                             
                                                
                                                   Z
                                                
                                             
                                             
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where point (X
                        
                           c
                        , Y
                        
                           c
                        ) can be seen as the orthogonal projection of (X
                        
                           c
                        , Y
                        
                           c
                        , Z
                        
                           c
                        ) in the image plane.

Since we are considering an aligned camera frame, the image plane is perpendicular to the projection planes, and point (X
                        
                           c
                        , Y
                        
                           c
                        ) and the corresponding reflected image point (s
                        
                           x
                        , s
                        
                           y
                        ) are on a line that passes through the image origin (see Section 2). More so, in the presence of a convex mirror,
                           2
                           In the axial geometry we are considering, when the camera is pointing at a convex mirror, the reflection is seen on the same direction (or “side”) as the object is in the world. For a concave mirror, the opposite is true. In this algorithm we assume the convex case because of its far greater practical interest.
                        
                        
                           2
                         (X
                        
                           c
                        , Y
                        
                           c
                        ) and (s
                        
                           x
                        , s
                        
                           y
                        ) have the same direction w.r.t. the image origin. In other words, vectors (X
                        
                           c
                        , Y
                        
                           c
                        ) and (s
                        
                           x
                        , s
                        
                           y
                        ) must have the same orientation and direction.

The correct value for λ can, thus, be obtained using the following procedure:
                           
                              1.
                              Choose one known pair of correspondences X and s.

For both solutions of Eq. (9), +λ and −λ:
                                    
                                       •
                                       Compute R, t
                                          
                                             x
                                           and t
                                          
                                             y
                                           using (8).

Compute (X
                                          
                                             c
                                          , Y
                                          
                                             c
                                          ) using (10).

From the two opposing vectors resulting from step 2, (±X
                                 
                                    c
                                 , ±Y
                                 
                                    c
                                 ), choose the one pointing in the same direction as (s
                                 
                                    x
                                 , s
                                 
                                    y
                                 ) (in the presence of noise, choose the closest direction). The value of λ that corresponds to the correct vector is the solution.

It should be noted that, in the presence of noise, the recovered matrix R may not be a true rotation matrix. Using Singular-Value-Decomposition, R
                        =
                        UΣV
                        ⊤, R can be projected to a matrix R′ in orthonormal space by substituting all the singular values by 1, i.e., R′=
                        UV
                        ⊤. Matrix R′ is the closest orthonormal matrix to R in the sense that it minimizes the Frobenius norm ∥R
                        −
                        R′∥F.

We now show how the algorithm can be changed in order to allow for a planar calibration object.

We will assume, without loss of generality, that the calibration points belong to plane Z
                        =0 w.r.t. the world frame (in a similar manner as in [36]). Eq. (7) becomes
                           
                              (11)
                              
                                 
                                    
                                       s
                                    
                                    
                                       ¯
                                    
                                 
                                 ∼
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     r
                                                                  
                                                                  
                                                                     11
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     r
                                                                  
                                                                  
                                                                     12
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     t
                                                                  
                                                                  
                                                                     x
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     r
                                                                  
                                                                  
                                                                     21
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     r
                                                                  
                                                                  
                                                                     22
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     t
                                                                  
                                                                  
                                                                     y
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             ︸
                                          
                                       
                                    
                                    
                                       ∼
                                       P
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   X
                                                
                                             
                                             
                                                
                                                   Y
                                                
                                             
                                             
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where r
                        
                           ij
                         denotes the element of matrix R at row i and column j. With some abuse of notation, let us redefine P to be the 2×3 matrix mapping the planar world points to the 1D image feature.

Matrix P is, again, obtained up to a scale factor λ using the DLT algorithm. Similarly to Eq. (8), we have that
                           
                              (12)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   R
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             =
                                             λ
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                                  
                                                                     11
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                                  
                                                                     12
                                                                  
                                                               
                                                            
                                                            
                                                               a
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   R
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             =
                                             λ
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                                  
                                                                     21
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                                  
                                                                     22
                                                                  
                                                               
                                                            
                                                            
                                                               b
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        with λ, a and b to be determined.

Since 
                           
                              
                                 
                                    R
                                 
                                 
                                    
                                       
                                          r
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                           
                         and 
                           
                              
                                 
                                    R
                                 
                                 
                                    
                                       
                                          r
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                         are orthonormal we can write
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         11
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         12
                                                      
                                                   
                                                
                                                
                                                   a
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            11
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            12
                                                         
                                                      
                                                   
                                                   
                                                      a
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       ⊤
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         21
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         22
                                                      
                                                   
                                                
                                                
                                                   b
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            21
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            22
                                                         
                                                      
                                                   
                                                   
                                                      b
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       ⊤
                                    
                                 
                              
                           
                        and
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         11
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         12
                                                      
                                                   
                                                
                                                
                                                   a
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            21
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            22
                                                         
                                                      
                                                   
                                                   
                                                      b
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       ⊤
                                    
                                 
                                 =
                                 0
                                 .
                              
                           
                        It can be shown that these constraints generate 2 real solutions for a and b. The solutions are symmetric and will be denoted as {a
                        +; b
                        +} and {a
                        −; b
                        −}, where
                           
                              
                                 
                                    
                                       a
                                    
                                    
                                       ±
                                    
                                 
                                 =
                                 ±
                                 
                                    
                                       (
                                       
                                          
                                             k
                                          
                                          
                                             α
                                          
                                       
                                       -
                                       
                                          
                                             k
                                          
                                          
                                             γ
                                          
                                       
                                       )
                                    
                                    
                                       2
                                       
                                          
                                             k
                                          
                                          
                                             β
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   α
                                                
                                             
                                             +
                                             
                                                
                                                   k
                                                
                                                
                                                   γ
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 ;
                                 
                                 
                                    
                                       b
                                    
                                    
                                       ±
                                    
                                 
                                 =
                                 ±
                                 
                                    
                                       
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   α
                                                
                                             
                                             +
                                             
                                                
                                                   k
                                                
                                                
                                                   γ
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        with
                           
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   α
                                                
                                             
                                             =
                                             
                                                
                                                   r
                                                
                                                
                                                   11
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   r
                                                
                                                
                                                   12
                                                
                                                
                                                   2
                                                
                                             
                                             -
                                             
                                                
                                                   r
                                                
                                                
                                                   21
                                                
                                                
                                                   2
                                                
                                             
                                             -
                                             
                                                
                                                   r
                                                
                                                
                                                   22
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   β
                                                
                                             
                                             =
                                             
                                                
                                                   r
                                                
                                                
                                                   11
                                                
                                             
                                             
                                                
                                                   r
                                                
                                                
                                                   21
                                                
                                             
                                             +
                                             
                                                
                                                   r
                                                
                                                
                                                   12
                                                
                                             
                                             
                                                
                                                   r
                                                
                                                
                                                   22
                                                
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   γ
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         α
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   4
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         β
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The unknown scale factor λ is determined using Eq. (9), where variables p
                        13 and p
                        23 are substituted, respectively, by a
                        + and b
                        + (or by a
                        − and b
                        −, yielding the same result). The signal ambiguity of λ can, again, be solved with the procedure described in the previous subsection. It should be noted that in Eq. (10) we now have Z
                        =0, which causes the equation to be independent of the values of a and b, and so λ is still uniquely determined.

Two solutions are, thus, possible for the extrinsic rotation matrix R, obtained by substituting the values {λ; a
                        +; b
                        +} and {λ; a
                        −; b
                        −} in Eq. (12) (the procedure to determine the correct solution is discussed in the next subsection). The 3rd row of R is given by 
                           
                              
                                 
                                    R
                                 
                                 
                                    
                                       
                                          r
                                       
                                       
                                          3
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    R
                                 
                                 
                                    
                                       
                                          r
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              ×
                              
                                 
                                    R
                                 
                                 
                                    
                                       
                                          r
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                        .

The first two components of the extrinsic translation are determined without ambiguity and can be obtained from
                           
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   x
                                                
                                             
                                             =
                                             λ
                                             
                                                
                                                   p
                                                
                                                
                                                   13
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   y
                                                
                                             
                                             =
                                             λ
                                             
                                                
                                                   p
                                                
                                                
                                                   23
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Using a 3D (non-planar) calibration object produces a unique solution for the extrinsic rotation matrix R. Regarding the minimum number of world-to-image point correspondences required to apply the DLT algorithm to Eq. (7), it can be seen that each 
                           
                              
                                 
                                    s
                                 
                                 
                                    ¯
                                 
                              
                              ↔
                              X
                           
                         pair establishes two equations up to scale. Eliminating the unknown scale factor between them results in one constraint on the variables of P for every point correspondence. Since the 2×4 matrix P is recovered only up to scale, 7 independent variables need to be determined, which means that at least 7 world-to-image correspondences are required. The world points cannot be located on a single plane (i.e. the calibration object must be non-planar), or else one column of matrix P is left undetermined (Eq. (11)). Furthermore, to determine that column of P, at least two off-plane world points are needed to constrain the two variables in the column.

For a simpler experimental setup, the use of a planar calibration pattern is possible. A minimum of 5 point correspondences is needed in this case (a similar reasoning as in the previous case, now with a 2×3 matrix P). In this situation, two possible solutions are obtained for matrix R. This ambiguity can, however, be solved by carrying both solutions to the next step in the calibration procedure and performing a complete reprojection of the world object into the image. The correct solution is the one that produces the image closest to the original.

The t
                        
                           x
                         and t
                        
                           y
                         components of the extrinsic translation are unambiguously recovered, regardless of the use of a non-planar or planar calibration object. The t
                        
                           z
                         component is undetermined at this stage. The value of the translation vector T is, thus, restricted to a line space.

The previous sections described how to obtain most of the parameters related to the mirror position and to the extrinsic calibration: Section 3 showed how to determine the mirror axis direction w.r.t. the camera while Section 4 showed how to calculate the complete extrinsic rotation, and the extrinsic translation up to one component.

In this section we estimate the remaining parameters: the distance d between camera and mirror along the symmetry axis, and the last component of the extrinsic translation, t
                     
                        z
                     .

Previously, we have taken advantage of the axial geometry of the system and avoided the use of the non-linear reflections associated with a (possibly) non-central catadioptric system. From now on, we take into consideration mirror shape and reflection geometry in order to estimate d and t
                     
                        z
                     , using non-linear optimization methods. We show, given the previously calculated parameters, that the optimization is performed on a single variable.

Our method requires the computation of back-projection rays from the camera and mirror geometry. In Appendix B we briefly outline the procedure for a mirror with a conic section. The derivation is based on [21]. We note, however, that any mirror profile is admissible as long as it is known a priori so that back-projection rays can be calculated.

Let 
                           
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          ∼
                                       
                                    
                                 
                                 
                                    c
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         c
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         Y
                                                      
                                                      
                                                         c
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         Z
                                                      
                                                      
                                                         c
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    ⊤
                                 
                              
                           
                         be the inhomogeneous coordinates, in the aligned camera frame, of a known world point 
                           
                              
                                 
                                    X
                                 
                                 
                                    ∼
                                 
                              
                           
                         belonging to the calibration object. Point 
                           
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          ∼
                                       
                                    
                                 
                                 
                                    c
                                 
                              
                           
                         is obtained from the extrinsic parameters R and T by
                           
                              (13)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         c
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         Y
                                                      
                                                      
                                                         c
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         Z
                                                      
                                                      
                                                         c
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   R
                                                
                                                
                                                   T
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         ∼
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         
                                                            
                                                               r
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         ∼
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         
                                                            
                                                               r
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         ∼
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         y
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         
                                                            
                                                               r
                                                            
                                                            
                                                               3
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         ∼
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         z
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

Since the parameter t
                        
                           z
                         is not yet determined, the position of point 
                           
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          ∼
                                       
                                    
                                 
                                 
                                    c
                                 
                              
                           
                         is defined only up to a linear locus in space, which we denote as line L
                        
                           z
                        . The line is orthogonal to the image plane and intersects this plane at coordinates (X
                        
                           c
                        , Y
                        
                           c
                        ).

On the other hand, point 
                           
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          ∼
                                       
                                    
                                 
                                 
                                    c
                                 
                              
                           
                         must also belong to the back-projected ray obtained from its reflected image s. We denote that back-projected ray, after reflection on the mirror surface, as space line L
                        BP.

Consequently, space point 
                           
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          ∼
                                       
                                    
                                 
                                 
                                    c
                                 
                              
                           
                         can be reconstructed by intersecting both 3D lines, L
                        
                           z
                         and L
                        BP. While line L
                        
                           z
                         is fully defined (it is a function of the already estimated R, t
                        
                           x
                         and t
                        
                           y
                        ), line L
                        BP depends on the yet undetermined distance d (see Appendix B). It should be noted, however, that despite the fact that different values of d produce distinct back-projection rays, an intersection point between L
                        
                           z
                         and L
                        BP always exists, as both lines belong to the same projection plane (see Section 2).

Let {X
                        
                           i} and {s
                        
                           i}, with i
                        =1…N, denote the set of points from the calibration object, expressed in the world frame, and their reflected images. Consider, also, 
                           
                              {
                              
                                 
                                    X
                                 
                                 
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              }
                           
                         to be the set of points from the calibration object expressed in the camera frame coordinates. The problem of determining d can be stated in the following manner: Given a set of correspondences between world points {
                        X
                        
                           
                           i
                        } and image points {
                        s
                        
                           
                           i
                        }, and the knowledge of the extrinsic parameters 
                        R 
                        and 
                        T
                        , with the exception of t
                        
                           z
                        
                        , find the value of d that reconstructs the set of points 
                        
                           
                              {
                              
                                 
                                    X
                                 
                                 
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              }
                           
                         
                        in such a way that they “fit” the original pattern {
                        X
                        
                           
                           i
                        } from the calibration object. The evaluation function is, in general, a measure of how “well” {X
                        
                           i} and 
                           
                              {
                              
                                 
                                    X
                                 
                                 
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              }
                           
                         can be related by a rigid transformation, as both sets should represent the same object. Alternatively, other metric characteristics regarding shape, distances, angles, etc., can be used, depending on the specific geometric properties of the calibration object.

The well known Iterative Closest Point (ICP) [38] algorithm can be used to obtain the rotation and translation that registers the calibration object {X
                        
                           i} to its reconstruction 
                           
                              {
                              
                                 
                                    X
                                 
                                 
                                    
                                       
                                          c
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              }
                           
                        . The values of this rotation and translation will, of course, dependent on d, and we denote them as R
                        
                           d
                         and T
                        
                           d
                        , respectively.

The distance d can be obtained by minimizing
                           
                              (14)
                              
                                 
                                    
                                       
                                          min
                                       
                                       
                                          d
                                       
                                    
                                 
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                       
                                    
                                 
                                 ‖
                                 
                                    
                                       
                                          
                                             X
                                          
                                          
                                             ∼
                                          
                                       
                                    
                                    
                                       
                                          
                                             c
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 -
                                 (
                                 
                                    
                                       R
                                    
                                    
                                       d
                                    
                                 
                                 
                                    
                                       
                                          
                                             X
                                          
                                          
                                             ∼
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 
                                    
                                       T
                                    
                                    
                                       d
                                    
                                 
                                 )
                                 
                                    
                                       ‖
                                    
                                    
                                       2
                                    
                                 
                                 .
                              
                           
                        Once the value of d that achieves the minimization is found, the last unknown parameter t
                        
                           z
                         is obtained from the z-component of T
                        
                           d
                        .

Since the estimation of R
                        
                           d
                         and T
                        
                           d
                         relies on the ICP procedure, a closed-form solution for Eq. (14) cannot be easily obtained. However, standard non-linear optimization methods can be used (e.g. Levenberg–Marquardt algorithm). We have found that, even in the presence of noise, the minimization achieves convergence to the global minimum without an accurate initial estimate of d. In our experiments we considered d
                        =focallength (camera touching the mirror) as the initial estimate.

To provide intuition, Fig. 7
                         illustrates the idea behind the procedure by showing the effect that errors in d have on the shape of a reconstructed planar calibration pattern.

@&#EXPERIMENTAL RESULTS@&#

We now present experimental results obtained with the proposed method. First we show tests with simulated data and then results from real images. We also include a comparison with methods designed for central systems.

To provide an intuitive representation to the reader, rotation matrices are presented as a 3 element vector containing the corresponding Euler angles, in degrees. Rotation matrix R
                     =
                     R
                     
                        z
                     (θ
                     
                        z
                     )R
                     
                        y
                     (θ
                     
                        y
                     )R
                     
                        x
                     (θ
                     
                        x
                     ) is represented by r
                     =(θ
                     
                        x
                     , θ
                     
                        y
                     , θ
                     
                        z
                     ), where R
                     
                        a
                     (θ) denotes a rotation of angle θ along axis a
                     =
                     x, y, z.

We refer to the rotation error in the following terms: given a ground truth rotation matrix R
                     GT and the corresponding noise affected estimate R
                     est, the rotation error matrix R
                     err is defined as: R
                     est
                     =
                     R
                     err
                     R
                     GT.

Translation errors are quantified in two distinct values: an angle error, corresponding to the angle between the estimated and ground truth vectors, and as a length percentage error, given by the ratio ∥T
                     est
                     −
                     T
                     GT∥/∥T
                     GT∥, where T
                     est and T
                     GT are the estimated and ground truth translation vectors, respectively, and ∥·∥ denotes the L2-norm.

The simulations were run on three distinct setups. Each setup had different parameters regarding the mirror shape, mirror position, and pose of the calibration object. Table 1
                         summarizes the values of the parameters in each setup. The image size of the simulated camera was 1500×1500 pixels, with a focal length of 1200 pixels. The calibration pattern consisted of a planar square grid, with 8×8 points. The distance between adjacent points on the grid was 2 world metric units.

Gaussian noise of zero mean and σ standard deviation was added to the position of the image points before running the calibration procedure. For a given σ value, each of the setups was repeated 100 times and the data compiled from the 3 setups, to provide a statistical analysis on the estimation error. Fig. 8
                        a–d shows the root mean square (RMS) error, as a function of the noise level σ, in the extrinsic parameters R and T, and in mirror position parameters d and o.


                        Fig. 8e plots the reprojection error as a function of the noise level. Since our method does not rely on direct minimization of the reprojection error (like bundle adjustment techniques), this error can be considered as a measure of the overall quality of the calibration. Also shown in Fig. 8e is the result from repeating the simulations assuming that point o is known a priori (without noise), and estimating only the remaining parameters. This situation is relevant in systems where the camera is aligned with the mirror axis, and o corresponds to (or approximates) the image center. When using spherical mirrors, the vertex point can be estimated from the reflected image of the camera itself (if visible) as point o corresponds to the reflection of the optical center.

In additional simulations we studied the effect of using more than one image in the calibration procedure. For each simulation setup, the calibration pattern was rotated around the mirror axis, producing images with different extrinsic parameters, but with the camera/mirror relative position kept constant. The estimates for the vertex point 
                        o and for the mirror distance d were computed by the minimization of expression (6) (for o) and (14) (for d) taking into account all images simultaneously. Fig. 9
                         shows the estimation error as a function of the number of images used, for a fixed noise level of σ
                        =4 pixels. It is seen that the using multiple images (with different positions of the calibration pattern) can help reduce the effect of noise and increase the accuracy in the estimation of the mirror relative position.

As previously stated, although we focus on non-central catadioptric systems, our method can be applied to central systems. Using a simulated setup, we applied our technique to a central system and compared its performance with two widely used methods from Sacaramuzza et al. [8,39], and Mei and Rives [9], both available as OpenSource toolboxes [40,41]. The two methods use images of a planar calibration object.

We simulated a central system with an hyperbolic mirror (parameters [mm]: A
                        =−0.76; B
                        =0; C
                        =−600) and a pinhole camera (resolution of 1000×1000 pixels) placed at the focus of the hyperbola. A 9×10 point grid was placed in 10 positions around the mirror, generating 10 different calibration images. Gaussian noise of zero mean and 2 pixels standard deviation was added to the image position of each point. The toolboxes were modified to bypass any imaging processing and to use the simulated image points instead.

We applied our method in two distinct conditions. First with a complete calibration, and then assuming that the vertex point 
                        o was known a priori, and only estimating the remaining parameters. In a central system the camera is aligned with the mirror and point o corresponds to the image center.

The results are presented in Fig. 10
                        . Since our methods assumes a calibrated pinhole camera, we only compare the estimation of the extrinsic parameters, R and T, and the reprojection error. The values presented are the RMS errors obtained from the set of the 10 images.

We now present results obtained with real images. The experiments were setup as follows. The projective camera was previously (internally) calibrated using standard methods [37]. Two different mirrors were used, one spherical and one hyperbolic. An image containing two distinct planar calibration patterns was acquired for each mirror. We applied our method to each pattern separately, obtaining two independent results for each setup. Fig. 11
                         shows the test images acquired with both mirrors, and the calibration points used in each grid pattern. Each image has a resolution of 1600×1200 pixels.

To compare and evaluate the output of our algorithm, reference values for the calibration parameters were obtained independently, from direct measurement and from image analysis, using Bouguet’s camera calibration toolbox [37]. Each mirror was aligned with a third, auxiliary, grid pattern. The relative pose between the auxiliary patterns and the mirrors was calculated from the grid alignment and by direct measurement. Then, from an external projective image (capturing all the grids) the transformations between the mirror frame and the calibration grids were extracted using the toolbox.

In the spherical mirror setup, the camera was placed so that the auxiliary mirror grid was directly visible in the test image (alongside the mirror itself), and the camera/mirror pose was computed, again using [37]. In the hyperbolic mirror setup, due to the small mirror size and camera alignment, the auxiliary mirror grid was not directly visible in the image. In this case, we relied on careful camera placement and measurement to estimate the camera/mirror transformation.

Combining the camera/mirror relative pose with the information from the external image, the geometry of the scene was fully reconstructed for each setup, and reference values for the extrinsic parameters (R and T) and mirror position parameters (d and o) were obtained.


                        Table 2
                         summarizes the reference values and the estimation error (with respect to the reference values) obtained for each experiment.

@&#DISCUSSION@&#

The simulation results show that the method described in this paper allows the estimation of the calibration parameters with good accuracy. The values of the estimated parameters remain stable even in the presence of considerable noise (i.e., when σ
                        =5 pixels). At first sight, the value of the coordinates of image point o appears to be the most affected parameter, but the error loses relevance when compared to the full image resolution (for σ
                        =5, the position error in o is less than 2% of the image dimension).

Regarding the comparison with methods designed for central systems, we focused the analysis on the estimation of the extrinsic parameters as the remaining parameters differ from our model. Besides the extrinsic parameters, we aim at the reconstruction of the mirror/camera position while the method of Mei and Rives uses the spherical camera model [42,43] and the method of Scaramuzza et al. uses a distortion model for the image. Our method had a performance similar to the other techniques, especially when assuming that the vertex point was given a priori. The reprojection error was also presented to provide an overall evaluation, and all methods provided very similar results.

The experiments with real images demonstrate how a good estimation of the calibration parameters can be achieved from a very simple and practical setup, even with the highly non-linear image formation geometry of non-central catadioptric systems. We note, however, that in setup #4 (hyperbolic mirror, grid pattern 2) the estimation of d and T presented larger errors, which can be explained by the fact that the reflection of the grid pattern occupied a relatively small area of the mirror surface (see topmost pattern in Fig. 11b), making the calibration points more sensitive to noise.

@&#CONCLUSIONS@&#

We presented a method for the estimation of the mirror position and extrinsic parameters in axial non-central catadioptric systems, i.e., systems made up of an axial symmetric mirror and a projective camera with its optical center located along the symmetry axis (but not necessarily orientated with the axis). We assume an internally calibrated pinhole camera and require the use of a calibration object, that can be planar. A single image is sufficient to perform the calibration procedure.

The camera/mirror relative position is determined with two parameters: the image position of the intersection of the symmetry axis with the image plane and the distance from the camera center to the mirror. The extrinsic parameters are fully determined through a rotation matrix and a translation vector.

A linear projection equation is established between 3D points and 1D image features, which enables the use of the DLT algorithm in the estimation of the extrinsic rotation and translation, the latter up to one undetermined component. The cross-ratio is used as an invariant under the axial-symmetric geometry to determine the image of the axis. Non-linear optimization methods are applied in the estimation of the remaining parameters.

Regarding the estimation of mirror/camera relative position, our approach provides a significant alternative to methods that require the identification of the mirror boundary in the image (e.g. [17,14,21,6,34]). The calibration procedure is accurate and much easier to automate. Since the calibration object can be planar, the setup is easy to implement.

The estimation of the extrinsic parameters, up to one translation parameter, is achieved with a simple and linear procedure, even in the presence of a highly non-linear image formation geometry. In applications that do not require the z-component of the extrinsic translation to be determined, the extrinsic parameters are obtained without full knowledge of the vision system characteristics (unknown mirror shape and distance to mirror). As an example of one such application, consider a robot navigating on a plane, equipped with an omnidirectional vision system. If known landmarks (calibration points) are visible in the image, the robot’s pose (extrinsic parameters) can be fully retrieved using the method of Section 4, as the z-component of the translation is constrained by the plane on which the robot moves.

@&#ACKNOWLEDGEMENT@&#

Helder Araujo would like to thank the support of Project FCT/PTDC/EIA-EIA/122454/2010, funded by the Portuguese Science Foundation (FCT) by means of national funds (PIDDAC) and co-funded by the European Fund for Regional Development (FEDER) through COMPETE Operational Programme Competitive Factors (POFC). Luis Perdigoto acknowledges the support of the Portuguese Science Foundation through Grant SFRH/BD/50281/2009.

This appendix briefly reviews some background concepts used in the paper.

Consider four collinear points A, B, C and D. Their cross-ratio {ABCD} is defined as
                           
                              (A.1)
                              
                                 {
                                 ABCD
                                 }
                                 =
                                 
                                    
                                       |
                                       AB
                                       |
                                       
                                       |
                                       CD
                                       |
                                    
                                    
                                       |
                                       AC
                                       |
                                       
                                       |
                                       BD
                                       |
                                    
                                 
                                 ,
                              
                           
                        where ∣XY∣ denotes the (signed) distance between points X and Y.

Let O be the intersection point of four concurrent lines, with each line passing through A, B, C and D, respectively. The cross-ratio of the four lines is given by
                           
                              
                                 {
                                 O
                                 ;
                                 ABCD
                                 }
                                 =
                                 
                                    
                                       sin
                                       (
                                       AOB
                                       )
                                       
                                       sin
                                       (
                                       COD
                                       )
                                    
                                    
                                       sin
                                       (
                                       AOC
                                       )
                                       
                                       sin
                                       (
                                       BOD
                                       )
                                    
                                 
                                 ,
                              
                           
                        and we have that (c.f. [35], chapter 2)
                           
                              
                                 {
                                 ABCD
                                 }
                                 =
                                 {
                                 O
                                 ;
                                 ABCD
                                 }
                              
                           
                        
                     

Consider a 2D point, with homogeneous coordinates
                           
                              
                                 x
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      y
                                                   
                                                   
                                                      z
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       ⊤
                                    
                                 
                                 ,
                              
                           
                        and a conic curve represented by the symmetric matrix
                           
                              
                                 Ω
                                 ∼
                                 
                                    
                                       
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   b
                                                   /
                                                   2
                                                
                                                
                                                   d
                                                   /
                                                   2
                                                
                                             
                                             
                                                
                                                   b
                                                   /
                                                   2
                                                
                                                
                                                   c
                                                
                                                
                                                   e
                                                   /
                                                   2
                                                
                                             
                                             
                                                
                                                   d
                                                   /
                                                   2
                                                
                                                
                                                   e
                                                   /
                                                   2
                                                
                                                
                                                   f
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        Point x is on the conic curve iff
                        
                           
                              
                                 
                                    
                                       x
                                    
                                    
                                       ⊤
                                    
                                 
                                 Ω
                                 x
                                 =
                                 0
                                 .
                              
                           
                        This second order polynomial can be re-written in the following form
                           
                              (A.2)
                              
                                 
                                    
                                       ω
                                    
                                    
                                       ⊤
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       ˆ
                                    
                                 
                                 =
                                 0
                                 ,
                              
                           
                        with 
                           
                              
                                 
                                    x
                                 
                                 
                                    ˆ
                                 
                              
                           
                         being the lifted point coordinates of x
                        
                           
                              (A.3)
                              
                                 
                                    
                                       x
                                    
                                    
                                       ˆ
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                      xy
                                                   
                                                   
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                      xz
                                                   
                                                   
                                                      yz
                                                   
                                                   
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       ⊤
                                    
                                 
                                 ,
                              
                           
                        and 
                           ω
                         a vector representation of the conic curve
                           
                              
                                 ω
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      b
                                                   
                                                   
                                                      c
                                                   
                                                   
                                                      d
                                                   
                                                   
                                                      e
                                                   
                                                   
                                                      f
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       ⊤
                                    
                                 
                                 .
                              
                           
                        
                     

In this appendix we show how to obtain the back-projection ray described in Section 5.1. The derivation is based on the work of Agrawal, Taguchi and Ramalingam in [21]. That paper addressed the forward projection equations in axial catadiotric systems with conic section mirrors, but concerning back-projection, only the case with a spherical mirror was explicitly derived. We present the back-projection equations for a generic conic section mirror.

Consider Fig. 12
                     . The camera principal axis (z
                     
                        c
                     ) is aligned with the mirror symmetry axis (z
                     
                        m
                     ). The distance between the camera frame origin and the mirror frame origin is given by d. Vector v
                     
                        i
                      is the incident ray and v
                     
                        r
                      is the reflected ray. S is the reflection point on the surface of the mirror. n is the surface normal vector at point S.

The mirror is specified by three parameters, A, B and C, that define its conic section in the x
                     
                        m
                     
                     z
                     
                        m
                      plane:
                        
                           (B.1)
                           
                              
                                 
                                    Az
                                 
                                 
                                    m
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    x
                                 
                                 
                                    m
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    Bz
                                 
                                 
                                    m
                                 
                              
                              =
                              C
                              .
                           
                        
                     
                  

The incident ray direction for a image point q (in pixels) is given, in the camera reference frame, by s
                     =
                     K
                     −1
                     q, where K is the camera intrinsic calibration matrix. Let 
                        
                           s
                           =
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 ⊤
                              
                           
                        
                     . The inhomogeneous coordinates of the reflection point are given, in the camera reference frame, by 
                        
                           
                              
                                 S
                              
                              
                                 ∼
                              
                           
                           =
                           β
                           s
                        
                     , with βobtained from
                        
                           (B.2)
                           
                              β
                              =
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          3
                                       
                                    
                                    (
                                    B
                                    +
                                    2
                                    Ad
                                    )
                                    ±
                                    
                                       
                                          4
                                          
                                             
                                                
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         s
                                                      
                                                      
                                                         2
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          (
                                          -
                                          Bd
                                          -
                                          
                                             
                                                Ad
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          C
                                          )
                                          +
                                          
                                             
                                                s
                                             
                                             
                                                3
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          
                                             
                                                B
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          4
                                          AC
                                          )
                                       
                                    
                                 
                                 
                                    2
                                    
                                       
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   1
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   s
                                                
                                                
                                                   2
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   As
                                                
                                                
                                                   3
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              .
                           
                        
                     
                  

As can be seen from Eq. (B.2), β has, in general, two solutions, corresponding to two intersection points between the incident ray and the mirror surface. The smallest value of β that verifies βs
                     3
                     >0 is the one that corresponds to the reflection point closest to, and in front of, the camera.

Finally, using the laws of reflection, the direction of the reflected ray is obtained from
                        
                           
                              
                                 
                                    v
                                 
                                 
                                    r
                                 
                              
                              =
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                              -
                              
                                 
                                    2
                                    
                                       
                                          nn
                                       
                                       
                                          ⊤
                                       
                                    
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          ⊤
                                       
                                    
                                    n
                                 
                              
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                              ,
                           
                        
                     with the incident ray given by 
                        
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                           =
                           
                              
                                 S
                              
                              
                                 ∼
                              
                           
                        
                      and the normal vector at point 
                        
                           
                              
                                 S
                              
                              
                                 ∼
                              
                           
                           =
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      x
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      y
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      z
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 ⊤
                              
                           
                        
                      given by 
                        
                           n
                           =
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      x
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      y
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      AS
                                                   
                                                   
                                                      z
                                                   
                                                
                                                -
                                                Ad
                                                -
                                                B
                                                /
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 ⊤
                              
                           
                        
                     .

@&#REFERENCES@&#

