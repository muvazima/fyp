@&#MAIN-TITLE@&#Spectral gradient fields embedding for nonrigid shape matching

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           An embedding of 3D-shapes using spectral gradient fields (GFs).


                        
                        
                           
                           It is based on the inner and external products of pairs of eigenfunctions.


                        
                        
                           
                           The embedding naturally defines a distance measure between nonrigid shapes.


                        
                        
                           
                           The method achieves state-of-the-art performance on correspondence benchmarks.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Correspondence

Laplace–Beltrami operator

Shape embedding

@&#ABSTRACT@&#


               
               
                  A popular approach for finding the correspondence between two nonrigid shapes is to embed their two-dimensional surfaces into some common Euclidean space, defining the comparison task as a problem of rigid matching in that space. We propose to extend this line of thought and introduce a novel spectral embedding, which exploits gradient fields for point to point matching. With this new embedding, a fully automatic system for finding the correspondence between shapes is introduced. The method is demonstrated to accurately recover the natural maps between nearly isometric surfaces and shown to achieve state-of-the-art results on known shape matching benchmarks.
               
            

@&#INTRODUCTION@&#

The embedding of manifolds into some Euclidean space is often used for simplifying matching and comparison procedures [1–3]. A useful property of such a target metric space is that corresponding points of different isometric shapes are mapped to nearby points in the target space. In that case, the embedding of multiple isometric shapes into this common target space naturally leads to a distance between shapes that is easy to compute. Recently, attention has been given to the spectral type of embedding that use the eigenvalues and eigenfunctions of the Laplace–Beltrami operator of the shape as a target space [2,4–6]. The fact that the Laplace–Beltrami operator is invariant to isometric deformations makes spectral embedding well suited for comparing the same object in different poses and expressions.

Bérard et al. [1] exhibited the spectral embedding of Riemannian manifolds by their heat kernel. They embedded manifolds into a compatible common target space (infinite Hilbert space) and used the Hausdorff distance in that space to define a metric between isometry equivalent classes of Riemannian manifolds. It means, in particular, that two manifolds are at zero distance if and only if they are isometric.

Rustamov [4] introduced the global point signature (GPS) of a point on a shape. It encodes both the eigenvalues and the eigenfunctions of the Laplace–Beltrami operator evaluated at that point. The GPS kernel is, in essence, the integration over all scales of the heat kernel on the surface [7]. The GPS kernel coincides with the Green’s function, and in some sense measures the extent to which two points are geometrically connected. He showed that the GPS embedding of a surface without self-intersections has no self-intersections as well.

A different approach was introduced by Sun et al. [5] Their signature, called the heat kernel signature (HKS), is defined for every point of the shape, by observing the heat kernel in that point over time. The set of all HKS on a shape characterizes a given surface up to an isometry under the condition that the eigenvalues of the Laplace–Beltrami operator are non-repeating. The invariance of the heat kernel signature to isometric deformations ensures that this signature can be used to find correspondence between different poses of the same shape.

We propose a novel spectral embedding, using gradient fields (GFs) of the Laplace–Beltrami operator eigenfunctions, for correspondence detection. We call the gradient fields of the eigenfunctions, spectral gradient fields (or spectral GFs), and refer to the proposed embedding as the spectral gradient fields embedding. As Laplace–Beltrami eigenfunctions computed independently for different shapes are often incompatible with each other, the aim of our construction is to embed the shapes using the eigenfunctions that correspond to the lowest eigenvalues. While existing methods [1,4] use the eigenfunctions themselves to define the target space, we embed the shapes using pairs of eigenfunctions. Thereby, more information is being extracted from the interaction between the relatively stable first few eigenfunctions.

We propose to find correspondence by embedding the shapes using a point-wise feature vector, which is based on the inner and external products between the GFs of pairs of eigenfunctions. For each pair of eigenfunctions ϕi, ϕj
                        , that correspond to the eigenvalues λi, λj
                        , we calculate their respective gradient fields ∇ϕi
                        , ∇ϕj
                        , and compute the inner product 〈∇ϕi
                        , ∇ϕj
                        〉, and the external product taken as the cross product in the normal direction 
                           
                              (
                              
                                 (
                                 ∇
                                 
                                    ϕ
                                    i
                                 
                                 ×
                                 
                                 ∇
                                 
                                    ϕ
                                    j
                                 
                                 )
                              
                              ·
                              n
                              )
                           
                        . Fig. 1
                         presents two eigenfunctions and their corresponding spectral GFs inner and external products. Because the inner and external products depend on the eigenfunctions and the gradient operator, they are relatively stable under isometric deformations, different poses and articulations. These features enable us to extract fine geometric information from a pair of eigenfunctions, as well as obtaining the global structure of an object. For the human shape shown as an example in Fig. 1, the inner product (third column and enlarged figure) distinguishes between the neck’s left and right sides, while the external product (fourth column) partitions the body’s front and back.
                           
                              
                           
                        
                     

The proposed feature vector defines an embedding of shapes into Euclidean space. To the best of our knowledge, this is the first time that spectral gradient fields are used for such an embedding (see Table 1 for a summary of existing embedding methods). We prove that the proposed spectral gradient fields embedding is injective. Therefore, it naturally induces a distance function between any two points on the surface. In this metric space a distance between shapes is relatively simple to compute. We define such a distance measure, which we refer to as the spectral gradient fields distance, in a way similar to the definition of the spectral embedding distance defined by Bérard et al. [1]. In the classic spectral embedding, the target space is described by the eigenfunctions of the Laplace–Beltrami operator. In the proposed target space, we embed the shapes into a much richer space, by using the conformal-based inner product between GFs of the eigenfunctions [8]. We describe the properties of the proposed distance measure, and prove that it is a pseudometric.

A metric space (X, dX
                        ) is a pair, where X is a set and 
                           
                              
                                 d
                                 X
                              
                              :
                              X
                              ×
                              
                              X
                              →
                              
                                 R
                                 
                                    ≥
                                    0
                                 
                              
                           
                         is a well defined distance function, satisfying the symmetry property 
                           
                              
                                 d
                                 X
                              
                              
                                 (
                                 
                                    x
                                    1
                                 
                                 ,
                                 
                                    x
                                    2
                                 
                                 )
                              
                              =
                              
                                 d
                                 X
                              
                              
                                 (
                                 
                                    x
                                    2
                                 
                                 ,
                                 
                                    x
                                    1
                                 
                                 )
                              
                           
                        , the identity property 
                           
                              
                                 d
                                 X
                              
                              
                                 (
                                 
                                    x
                                    1
                                 
                                 ,
                                 
                                    x
                                    2
                                 
                                 )
                              
                              =
                              0
                           
                         iff 
                           
                              
                                 x
                                 1
                              
                              =
                              
                                 x
                                 2
                              
                           
                        , and the triangle inequality 
                           
                              
                                 d
                                 X
                              
                              
                                 (
                                 
                                    x
                                    1
                                 
                                 ,
                                 
                                    x
                                    3
                                 
                                 )
                              
                              ≤
                              
                                 d
                                 X
                              
                              
                                 (
                                 
                                    x
                                    1
                                 
                                 ,
                                 
                                    x
                                    2
                                 
                                 )
                              
                              +
                              
                                 d
                                 X
                              
                              
                                 (
                                 
                                    x
                                    2
                                 
                                 ,
                                 
                                    x
                                    3
                                 
                                 )
                              
                           
                         for any x
                        1, x
                        3 ∈ X. If the distance dX
                        (x
                        1, x
                        2) between two distinct points can be zero, then (X, dX
                        ) is called a pseudometric space.

Suppose A, B ∈ X are two closed subsets of a common bigger metric space (X, dX
                        ), and we want to compare A to B in order to decide whether they represent the same object or not, one might compute the Hausdorff distance 
                           
                              
                                 d
                                 H
                              
                              
                                 (
                                 A
                                 ,
                                 B
                                 )
                              
                           
                         between A and B
                        
                           
                              
                                 
                                    
                                       d
                                       H
                                    
                                    
                                       (
                                       A
                                       ,
                                       B
                                       )
                                    
                                    ≡
                                    
                                       APTARANORMAL
                                       max
                                    
                                    
                                       (
                                       
                                          
                                             sup
                                          
                                          
                                             a
                                             ∈
                                             A
                                          
                                       
                                       
                                       
                                          
                                             inf
                                          
                                          
                                             b
                                             ∈
                                             B
                                          
                                       
                                       
                                       
                                          d
                                          X
                                       
                                       
                                          (
                                          a
                                          ,
                                          b
                                          )
                                       
                                       ,
                                       
                                          
                                             sup
                                          
                                          
                                             b
                                             ∈
                                             B
                                          
                                       
                                       
                                       
                                          
                                             inf
                                          
                                          
                                             a
                                             ∈
                                             A
                                          
                                       
                                       
                                       
                                          d
                                          X
                                       
                                       
                                          (
                                          a
                                          ,
                                          b
                                          )
                                       
                                       )
                                    
                                    ,
                                 
                              
                           
                        and designate two objects A, B ∈ X as being identical, if 
                           
                              
                                 d
                                 H
                              
                              
                                 (
                                 A
                                 ,
                                 B
                                 )
                              
                              =
                              0
                           
                        .
                     

A different approach to compare objects, is to treat them as metric spaces, and check if these metric spaces are isometric or not. We say the metric spaces (X, dX
                        ) and (Y, dY
                        ) are isometric when there exists a bijective mapping φ: X → Y such that 
                           
                              
                                 d
                                 X
                              
                              
                                 (
                                 
                                    x
                                    1
                                 
                                 ,
                                 
                                    x
                                    2
                                 
                                 )
                              
                              =
                              
                                 d
                                 Y
                              
                              
                                 (
                                 φ
                                 
                                    (
                                    
                                       x
                                       1
                                    
                                    )
                                 
                                 ,
                                 φ
                                 
                                    (
                                    
                                       x
                                       2
                                    
                                    )
                                 
                                 )
                              
                           
                         for all x
                        1, ∈X. Such a φ is an isometry between (X, dX
                        ) and (Y, dY). In other words, an isometry between two shapes is a map between their two dimensional surfaces that preserves the distances between any two points.

For example, when considering shapes as two-dimensional Riemannian manifolds embedded in the three dimensional Euclidean space, and if one is interested in invariance to deformations of a surface that preserve the geodesic metric, then the surfaces can be treated as metric spaces equipped with the geodesic distances of the Riemannian manifold [9,10].

Let X be a Riemannian manifold. For any smooth function 
                           
                              f
                              :
                              X
                              →
                              R
                           
                         the gradient of f is the vector field ∇f defined through the Riemannian manifold’s inner product, such that for any vector field U,
                           
                              
                                 
                                    〈
                                    ∇
                                    f
                                    
                                       (
                                       x
                                       )
                                    
                                    ,
                                    U
                                    
                                       (
                                       x
                                       )
                                    
                                    〉
                                    =
                                    
                                       ∂
                                       U
                                    
                                    f
                                    
                                       (
                                       x
                                       )
                                    
                                    ,
                                 
                              
                           
                        where ∂
                           U
                        
                        f(x) is the directional derivative of f at x ∈ X, in the direction U(x).

The Laplace–Beltrami operator, denoted by Δ, is the divergence of the gradient
                           
                              
                                 
                                    
                                       Δ
                                    
                                    f
                                    ≡
                                    
                                       div
                                    
                                    
                                       
                                          0.35
                                          e
                                          m
                                       
                                       
                                          0
                                          e
                                          x
                                       
                                    
                                    
                                       grad
                                    
                                    
                                       
                                          0.12
                                          e
                                          m
                                       
                                       
                                          0
                                          e
                                          x
                                       
                                    
                                    f
                                    ,
                                 
                              
                           
                        and can be considered as a generalization of the standard notion of the Laplace operator to compact Riemannian manifolds [11–13]. The Laplace–Beltrami operator is invariant to geodesic-preserving deformations because it is defined in terms of the surface metric tensor which is isometry invariant.

The eigendecomposition of 
                           
                              −
                              
                                 Δ
                              
                           
                         consists of nonnegative eigenvalues 
                           
                              0
                              =
                              
                                 λ
                                 0
                              
                              <
                              
                                 λ
                                 1
                              
                              ≤
                              ⋯
                              ≤
                              
                                 λ
                                 i
                              
                              ≤
                              ⋯
                           
                        , satisfying
                           
                              
                                 
                                    −
                                    
                                       Δ
                                    
                                    
                                       ϕ
                                       i
                                    
                                    ≡
                                    
                                       λ
                                       i
                                    
                                    
                                       ϕ
                                       i
                                    
                                    .
                                 
                              
                           
                        The set of corresponding eigenfunctions given by
                           
                              
                                 
                                    Φ
                                    ≡
                                    {
                                    
                                       ϕ
                                       0
                                    
                                    ,
                                    
                                       ϕ
                                       1
                                    
                                    ,
                                    ⋯
                                    ,
                                    
                                       ϕ
                                       i
                                    
                                    ,
                                    ⋯
                                    }
                                    ,
                                 
                              
                           
                        forms an orthonormal eigenbasis, such that 
                           
                              
                                 ∫
                                 X
                              
                              
                                 ϕ
                                 i
                              
                              
                                 (
                                 x
                                 )
                              
                              
                                 ϕ
                                 j
                              
                              
                                 (
                                 x
                                 )
                              
                              d
                              
                                 V
                              
                              =
                              
                                 δ
                                 ij
                              
                           
                        , where dV is the volume element on the manifold X.

Bérard et al. [1] used the spectral properties of the heat operator e
                        
                           tΔ
                         to define a metric between two Riemannian manifolds 
                           
                              X
                              ,
                              Y
                              ∈
                              M
                           
                        . Here, 
                           M
                         is the set of all closed (i.e. compact without boundary) Riemannian manifolds of dimension n. Given a Riemannian manifold 
                           
                              X
                              ∈
                              M
                           
                         with volume Vol(X) and some t > 0, they based their metric on the eigendecomposition of the heat kernel and defined the spectral embedding 
                           
                              
                                 I
                                 
                                    t
                                 
                                 Φ
                              
                              :
                              X
                              →
                              
                                 
                                    ℓ
                                 
                                 2
                              
                           
                         from the Riemannian manifold X into the Hilbert space ℓ2 of real valued square-summable sequences
                           
                              
                                 
                                    
                                       I
                                       
                                          t
                                       
                                       Φ
                                    
                                    
                                       (
                                       x
                                       )
                                    
                                    ≡
                                    
                                       
                                          {
                                          
                                             
                                                
                                                   Vol
                                                
                                                (
                                                X
                                                )
                                             
                                          
                                          
                                             
                                                e
                                             
                                             
                                                −
                                                
                                                   λ
                                                   i
                                                
                                                t
                                                /
                                                2
                                             
                                          
                                          
                                             ϕ
                                             i
                                          
                                          
                                             (
                                             x
                                             )
                                          
                                          }
                                       
                                       
                                          i
                                          ≥
                                          1
                                       
                                    
                                    ,
                                 
                              
                           
                        utilizing the eigenfunctions ϕi
                         and eigenvalues λi
                         of the Laplace–Beltrami operator Δ.

Given a pair of eigenbases ΦX, ΦY
                        , they embedded the two Riemannian manifolds X and Y into 
                           
                              I
                              
                                 t
                              
                              
                                 
                                    Φ
                                 
                                 X
                              
                           
                         and 
                           
                              I
                              
                                 t
                              
                              
                                 
                                    Φ
                                 
                                 Y
                              
                           
                        , respectively. Then, they measured the Hausdorff distance 
                           
                              d
                              H
                           
                         between the manifolds in the common ℓ2 space. Bérard et al. defined the distance 
                           
                              
                                 d
                                 
                                    t
                                 
                                 
                                    EMB
                                 
                              
                              :
                              M
                              ×
                              
                              M
                              →
                              
                                 R
                                 
                                    ≥
                                    0
                                 
                              
                           
                         between the manifolds X, Y, as the upper-bound of the Hausdorff distance between any eigenbasis ΦX
                         and its closest counterpart ΦY
                        .
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   d
                                                   
                                                      t
                                                   
                                                   
                                                      EMB
                                                   
                                                
                                                
                                                   (
                                                   X
                                                   ,
                                                   Y
                                                   )
                                                
                                                ≡
                                                
                                                   APTARANORMAL
                                                   max
                                                
                                                
                                                   (
                                                   
                                                      d
                                                      
                                                         I
                                                         t
                                                      
                                                   
                                                   
                                                      (
                                                      X
                                                      ,
                                                      Y
                                                      )
                                                   
                                                   ,
                                                   
                                                      d
                                                      
                                                         I
                                                         t
                                                      
                                                   
                                                   
                                                      (
                                                      Y
                                                      ,
                                                      X
                                                      )
                                                   
                                                   )
                                                
                                                ,
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   d
                                                   
                                                      I
                                                      t
                                                   
                                                
                                                
                                                   (
                                                   X
                                                   ,
                                                   Y
                                                   )
                                                
                                                ≡
                                                
                                                   
                                                      sup
                                                   
                                                   
                                                      {
                                                      
                                                         
                                                            Φ
                                                         
                                                         X
                                                      
                                                      }
                                                   
                                                
                                                
                                                   
                                                      inf
                                                   
                                                   
                                                      {
                                                      
                                                         
                                                            Φ
                                                         
                                                         Y
                                                      
                                                      }
                                                   
                                                
                                                
                                                   d
                                                   H
                                                
                                                
                                                   (
                                                   
                                                      I
                                                      
                                                         t
                                                      
                                                      
                                                         
                                                            Φ
                                                         
                                                         X
                                                      
                                                   
                                                   ,
                                                   
                                                      I
                                                      
                                                         t
                                                      
                                                      
                                                         
                                                            Φ
                                                         
                                                         Y
                                                      
                                                   
                                                   )
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        We call 
                           
                              
                                 d
                                 
                                    t
                                 
                                 
                                    EMB
                                 
                              
                              
                                 (
                                 X
                                 ,
                                 Y
                                 )
                              
                           
                         the spectral embedding distance (for a detailed description of the spectral embedding distance, we refer the reader to [1]). They showed that for any fixed t > 0, the spectral embedding distance 
                           
                              d
                              
                                 t
                              
                              
                                 EMB
                              
                           
                         is a metric between isometry classes of Riemannian manifolds. In particular, 
                           
                              
                                 d
                                 
                                    t
                                 
                                 
                                    EMB
                                 
                              
                              
                                 (
                                 X
                                 ,
                                 Y
                                 )
                              
                              =
                              0
                           
                         if and only if the Riemannian manifolds X and Y are isometric.

A spectral gradient field is a tangent vector field defined as the gradient of an eigenfunction ∇ϕi
                        . The feature vector we define is based on the inner product between two spectral gradient fields, 
                           
                              
                                 ω
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              :
                              X
                              →
                              R
                           
                         for all i, j ≥ 1, where
                           
                              (1)
                              
                                 
                                    
                                       
                                          
                                             
                                                ω
                                                
                                                   i
                                                   ,
                                                   j
                                                
                                             
                                             
                                                (
                                                x
                                                )
                                             
                                             ≡
                                             
                                                Vol
                                             
                                             
                                                (
                                                X
                                                )
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               λ
                                                               i
                                                            
                                                            
                                                               λ
                                                               j
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             〈
                                             ∇
                                             
                                                ϕ
                                                i
                                             
                                             
                                                (
                                                x
                                                )
                                             
                                             ,
                                             ∇
                                             
                                                ϕ
                                                j
                                             
                                             
                                                (
                                                x
                                                )
                                             
                                             〉
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        For the special case that the Riemannian manifold is an oriented two-dimensional manifold embedded in 
                           
                              
                                 R
                              
                              3
                           
                        , we enrich the feature vector by using the cross product between two spectral GFs in the normal direction, 
                           
                              
                                 ν
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              :
                              X
                              →
                              R
                           
                         for all i, j ≥ 1, where
                           
                              (2)
                              
                                 
                                    
                                       
                                          
                                             
                                                ν
                                                
                                                   i
                                                   ,
                                                   j
                                                
                                             
                                             
                                                (
                                                x
                                                )
                                             
                                             ≡
                                             
                                                Vol
                                             
                                             
                                                (
                                                X
                                                )
                                             
                                             
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               λ
                                                               i
                                                            
                                                            
                                                               λ
                                                               j
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             
                                                (
                                                
                                                   (
                                                   ∇
                                                   
                                                      ϕ
                                                      i
                                                   
                                                   
                                                      (
                                                      x
                                                      )
                                                   
                                                   ×
                                                   
                                                   ∇
                                                   
                                                      ϕ
                                                      j
                                                   
                                                   
                                                      (
                                                      x
                                                      )
                                                   
                                                   )
                                                
                                                ·
                                                n
                                                
                                                   (
                                                   x
                                                   )
                                                
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Let us study the embedding and the distance between shapes that are induced by this feature vector. We limit our analysis to the inner product between the gradients of the eigenfunctions. Thus, we define the spectral GFs embedding
                        
                           
                              
                                 J
                                 
                                    t
                                 
                                 Φ
                              
                              :
                              X
                              →
                              
                                 
                                    ℓ
                                 
                                 2
                              
                           
                         as
                           
                              
                                 
                                    
                                       J
                                       
                                          t
                                       
                                       Φ
                                    
                                    
                                       (
                                       x
                                       )
                                    
                                    ≡
                                    
                                       
                                          {
                                          
                                             
                                                e
                                             
                                             
                                                −
                                                (
                                                
                                                   λ
                                                   i
                                                
                                                +
                                                
                                                   λ
                                                   j
                                                
                                                )
                                                t
                                                /
                                                2
                                             
                                          
                                          
                                             ω
                                             
                                                i
                                                ,
                                                j
                                             
                                          
                                          
                                             (
                                             x
                                             )
                                          
                                          }
                                       
                                       
                                          i
                                          ,
                                          j
                                          ≥
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          1
                                          e
                                          m
                                       
                                       
                                          0
                                          e
                                          x
                                       
                                    
                                    t
                                    >
                                    0
                                    .
                                 
                              
                           
                        
                        
                           Proposition 1
                           
                              Let x
                              1, ∈X be two distinct points on the Riemannian manifold
                              
                                 
                                    X
                                    ∈
                                    M
                                 
                              
                              . Then, there exists a smooth function f, such that
                              
                                 
                                    ∇
                                    f
                                    (
                                    
                                       x
                                       1
                                    
                                    )
                                    
                                       
                                          0.25
                                          e
                                          m
                                       
                                       
                                          0
                                          e
                                          x
                                       
                                    
                                    ≠
                                    
                                       
                                          0.25
                                          e
                                          m
                                       
                                       
                                          0
                                          e
                                          x
                                       
                                    
                                    0
                                 
                              
                              , and
                              
                                 
                                    ∇
                                    f
                                    (
                                    
                                       x
                                       2
                                    
                                    )
                                    =
                                    0
                                 
                              
                              .
                           

The proof of Proposition 1 is given in A.
                           Theorem 1
                           
                              For a Riemannian manifold
                              
                                 
                                    X
                                    ∈
                                    M
                                 
                              
                              , the embedding
                              
                                 
                                    
                                       J
                                       
                                          t
                                       
                                       Φ
                                    
                                    :
                                    X
                                    →
                                    
                                       
                                          ℓ
                                       
                                       2
                                    
                                 
                               
                              is injective, i.e.
                              
                                 
                                    
                                       x
                                       1
                                    
                                    
                                       
                                          0.25
                                          e
                                          m
                                       
                                       
                                          0
                                          e
                                          x
                                       
                                    
                                    ≠
                                    
                                       
                                          0.25
                                          e
                                          m
                                       
                                       
                                          0
                                          e
                                          x
                                       
                                    
                                    
                                       x
                                       2
                                    
                                    ⇔
                                    
                                       J
                                       
                                          t
                                       
                                       Φ
                                    
                                    
                                       (
                                       
                                          x
                                          1
                                       
                                       )
                                    
                                    
                                       
                                          0.25
                                          e
                                          m
                                       
                                       
                                          0
                                          e
                                          x
                                       
                                    
                                    ≠
                                    
                                       
                                          0.25
                                          e
                                          m
                                       
                                       
                                          0
                                          e
                                          x
                                       
                                    
                                    
                                       J
                                       
                                          t
                                       
                                       Φ
                                    
                                    
                                       (
                                       
                                          x
                                          2
                                       
                                       )
                                    
                                 
                              
                              .
                           

The proof is motivated by Rustamov’s analysis of his GPS embedding [4]. Suppose that for two different points x
                              1, ∈X, we have 
                                 
                                    
                                       J
                                       
                                          t
                                       
                                       Φ
                                    
                                    
                                       (
                                       
                                          x
                                          1
                                       
                                       )
                                    
                                    =
                                    
                                       J
                                       
                                          t
                                       
                                       Φ
                                    
                                    
                                       (
                                       
                                          x
                                          2
                                       
                                       )
                                    
                                 
                              . This means that for all i, j ≥ 1, we have 
                                 
                                    〈
                                    ∇
                                    
                                       ϕ
                                       i
                                    
                                    
                                       (
                                       
                                          x
                                          1
                                       
                                       )
                                    
                                    ,
                                    ∇
                                    
                                       ϕ
                                       j
                                    
                                    
                                       (
                                       
                                          x
                                          1
                                       
                                       )
                                    
                                    〉
                                    =
                                    〈
                                    ∇
                                    
                                       ϕ
                                       i
                                    
                                    
                                       (
                                       
                                          x
                                          2
                                       
                                       )
                                    
                                    ,
                                    ∇
                                    
                                       ϕ
                                       j
                                    
                                    
                                       (
                                       
                                          x
                                          2
                                       
                                       )
                                    
                                    〉
                                 
                              . Now, any smooth scalar function 
                                 
                                    f
                                    :
                                    X
                                    →
                                    R
                                 
                               can be represented as a linear combination of the eigenbasis 
                                 
                                    f
                                    =
                                    
                                       ∑
                                       i
                                    
                                    
                                       a
                                       i
                                    
                                    
                                       ϕ
                                       i
                                    
                                 
                              . We can thereby write the norm of the gradient as
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∥
                                                      ∇
                                                      f
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         1
                                                      
                                                      )
                                                   
                                                   
                                                      
                                                         ∥
                                                      
                                                      2
                                                   
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                   
                                                      a
                                                      i
                                                   
                                                   
                                                      a
                                                      j
                                                   
                                                   〈
                                                   ∇
                                                   
                                                      ϕ
                                                      i
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         1
                                                      
                                                      )
                                                   
                                                   ,
                                                   ∇
                                                   
                                                      ϕ
                                                      j
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         1
                                                      
                                                      )
                                                   
                                                   〉
                                                
                                             
                                          
                                          
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                   
                                                      a
                                                      i
                                                   
                                                   
                                                      a
                                                      j
                                                   
                                                   〈
                                                   ∇
                                                   
                                                      ϕ
                                                      i
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         2
                                                      
                                                      )
                                                   
                                                   ,
                                                   ∇
                                                   
                                                      ϕ
                                                      j
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         2
                                                      
                                                      )
                                                   
                                                   
                                                      〉
                                                      =
                                                      ∥
                                                      ∇
                                                      f
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         2
                                                      
                                                      )
                                                   
                                                   
                                                      
                                                         ∥
                                                      
                                                      2
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              On the other hand, using Proposition 1, there always exists a smooth function f, such that 
                                 
                                    
                                       ∥
                                       ∇
                                       f
                                    
                                    
                                       (
                                       
                                          x
                                          1
                                       
                                       )
                                    
                                    
                                       ∥
                                       
                                          
                                             0.25
                                             e
                                             m
                                          
                                          
                                             0
                                             e
                                             x
                                          
                                       
                                       ≠
                                       
                                          
                                             0.25
                                             e
                                             m
                                          
                                          
                                             0
                                             e
                                             x
                                          
                                       
                                       ∥
                                       ∇
                                       f
                                    
                                    
                                       (
                                       
                                          x
                                          2
                                       
                                       )
                                    
                                    
                                       ∥
                                    
                                 
                              , a contradiction. Therefore, 
                                 
                                    
                                       J
                                       
                                          t
                                       
                                       Φ
                                    
                                    
                                       (
                                       
                                          x
                                          1
                                       
                                       )
                                    
                                    
                                       
                                          0.25
                                          e
                                          m
                                       
                                       
                                          0
                                          e
                                          x
                                       
                                    
                                    ≠
                                    
                                       
                                          0.25
                                          e
                                          m
                                       
                                       
                                          0
                                          e
                                          x
                                       
                                    
                                    
                                       J
                                       
                                          t
                                       
                                       Φ
                                    
                                    
                                       (
                                       
                                          x
                                          2
                                       
                                       )
                                    
                                 
                              .
□


                              The family of maps
                              
                                 
                                    
                                       {
                                       
                                          J
                                          
                                             t
                                          
                                          Φ
                                       
                                       }
                                    
                                    
                                       t
                                       >
                                       0
                                    
                                 
                               
                              is invariant to global scaling of the metric.
                           

See Appendix B for a proof of this Theorem.

Given a Riemannian manifold 
                           
                              X
                              ∈
                              M
                           
                        , the embedding 
                           
                              
                                 J
                                 
                                    t
                                 
                                 Φ
                              
                              :
                              X
                              →
                              
                                 
                                    ℓ
                                 
                                 2
                              
                           
                         induces a metric 
                           
                              
                                 
                                    d
                                    ˜
                                 
                                 X
                              
                              :
                              X
                              ×
                              
                              X
                              →
                              
                                 R
                                 
                                    ≥
                                    0
                                 
                              
                           
                         on the manifold, in a way that the distance between any two points x
                        1, ∈X coincides with the distance between the images of these points in the ℓ2 space
                           
                              
                                 
                                    
                                       
                                          d
                                          ˜
                                       
                                       X
                                    
                                    
                                       (
                                       
                                          x
                                          1
                                       
                                       ,
                                       
                                          x
                                          2
                                       
                                       )
                                    
                                    
                                       ≡
                                       ∥
                                    
                                    
                                       J
                                       
                                          t
                                       
                                       Φ
                                    
                                    
                                       (
                                       
                                          x
                                          1
                                       
                                       )
                                    
                                    −
                                    
                                       J
                                       
                                          t
                                       
                                       Φ
                                    
                                    
                                       (
                                       
                                          x
                                          2
                                       
                                       )
                                    
                                    
                                       ∥
                                       
                                          
                                             ℓ
                                          
                                          2
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

The metric 
                           
                              
                                 
                                    d
                                    ˜
                                 
                                 X
                              
                              
                                 (
                                 
                                    x
                                    1
                                 
                                 ,
                                 
                                    x
                                    2
                                 
                                 )
                              
                           
                         is a well defined distance function which is invariant to the choice of the orthonormal eigenbasis Φ.

Let 
                           
                              X
                              ,
                              Y
                              ∈
                              M
                           
                         be the two closed Riemannian manifolds we would like to compare, and let us be given some t > 0. Given a pair of eigenbases ΦX, ΦY
                        , we embed the two Riemannian manifolds X and Y into 
                           
                              J
                              
                                 t
                              
                              
                                 
                                    Φ
                                 
                                 X
                              
                           
                         and 
                           
                              J
                              
                                 t
                              
                              
                                 
                                    Φ
                                 
                                 Y
                              
                           
                        , respectively, and measure the Hausdorff distance
                        
                           
                              d
                              H
                           
                         between the manifolds in the common ℓ2 space. We define the spectral gradient fields distance, denoted by 
                           
                              
                                 d
                                 
                                    t
                                 
                                 
                                    GF
                                 
                              
                              :
                              M
                              ×
                              
                              M
                              →
                              
                                 R
                                 
                                    ≥
                                    0
                                 
                              
                           
                        , as the supremum of the Hausdorff distance between any eigenbasis ΦX
                         and its closest counterpart ΦY
                        .
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   d
                                                   
                                                      t
                                                   
                                                   
                                                      GF
                                                   
                                                
                                                
                                                   (
                                                   X
                                                   ,
                                                   Y
                                                   )
                                                
                                                ≡
                                                
                                                   APTARANORMAL
                                                   max
                                                
                                                
                                                   (
                                                   
                                                      d
                                                      
                                                         J
                                                         t
                                                      
                                                   
                                                   
                                                      (
                                                      X
                                                      ,
                                                      Y
                                                      )
                                                   
                                                   ,
                                                   
                                                      d
                                                      
                                                         J
                                                         t
                                                      
                                                   
                                                   
                                                      (
                                                      Y
                                                      ,
                                                      X
                                                      )
                                                   
                                                   )
                                                
                                                ,
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   d
                                                   
                                                      J
                                                      t
                                                   
                                                
                                                
                                                   (
                                                   X
                                                   ,
                                                   Y
                                                   )
                                                
                                                ≡
                                                
                                                   
                                                      sup
                                                   
                                                   
                                                      {
                                                      
                                                         
                                                            Φ
                                                         
                                                         X
                                                      
                                                      }
                                                   
                                                
                                                
                                                   
                                                      inf
                                                   
                                                   
                                                      {
                                                      
                                                         
                                                            Φ
                                                         
                                                         Y
                                                      
                                                      }
                                                   
                                                
                                                
                                                   d
                                                   H
                                                
                                                
                                                   (
                                                   
                                                      J
                                                      
                                                         t
                                                      
                                                      
                                                         
                                                            Φ
                                                         
                                                         X
                                                      
                                                   
                                                   ,
                                                   
                                                      J
                                                      
                                                         t
                                                      
                                                      
                                                         
                                                            Φ
                                                         
                                                         Y
                                                      
                                                   
                                                   )
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

We say that X, Y are spectral gradient fields equivalent, if the metric spaces 
                           
                              
                                 (
                                 X
                                 ,
                                 
                                    
                                       d
                                       ˜
                                    
                                    X
                                 
                                 )
                              
                              ,
                              
                                 (
                                 Y
                                 ,
                                 
                                    
                                       d
                                       ˜
                                    
                                    Y
                                 
                                 )
                              
                           
                         are isometric and if 
                           
                              
                                 d
                                 
                                    t
                                 
                                 
                                    GF
                                 
                              
                              
                                 (
                                 X
                                 ,
                                 Y
                                 )
                              
                              =
                              0
                           
                        .
                           Theorem 3
                           
                              The spectral GFs distance
                              
                                 
                                    d
                                    
                                       t
                                    
                                    
                                       GF
                                    
                                 
                               
                              is a pseudometric between spectral GFs equivalent classes of Riemannian manifolds.
                           

The proof of Theorem 3 is given in C.
                           Remark
                           The use of the spectral GFs external product 
                                 
                                    (
                                    
                                       (
                                       ∇
                                       
                                          ϕ
                                          i
                                       
                                       ×
                                       
                                       ∇
                                       
                                          ϕ
                                          j
                                       
                                       )
                                    
                                    ·
                                    n
                                    
                                       (
                                       x
                                       )
                                    
                                    )
                                 
                               is obviously restricted to oriented two-dimensional surfaces embedded in the three-dimensional Euclidean space. Although the cross product of two tangent vectors is extrinsic in nature, its projection in the normal direction is invariant to isometric deformations. Consequently, for a two-dimensional surface embedded in 
                                 
                                    
                                       R
                                    
                                    3
                                 
                              , adding the elements 
                                 
                                    
                                       
                                          e
                                       
                                       
                                          −
                                          (
                                          
                                             λ
                                             
                                                i
                                             
                                             X
                                          
                                          +
                                          
                                             λ
                                             
                                                j
                                             
                                             Y
                                          
                                          )
                                          t
                                          /
                                          2
                                       
                                    
                                    
                                       ν
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                 
                               for all i, j ≥ 1 to the embedding 
                                 
                                    J
                                    
                                       t
                                    
                                    Φ
                                 
                              , leaves the above analysis unchanged. Hence, the statements of Theorems 1–3 hold for the extended feature vector as well.

The spectral GFs distance 
                                 
                                    d
                                    
                                       t
                                    
                                    
                                       GF
                                    
                                 
                               is a metric between spectral GFs equivalent classes of Riemannian manifolds.

We consider Conjecture 1 in C. We believe that a proof of this conjecture is beyond the scope of this paper and leave it to future work.

@&#EXPERIMENTS AND RESULTS@&#

Let us study the spectral GFs feature vector when we are restricted to using the N
                        0 eigenfunctions that correspond to the lowest eigenvalues. Remember that we are driven by the task of finding correspondence between two nearly isometric shapes. Because empirical evidence suggests that there are only a few eigenfunctions that are stable to approximately isometric deformations, for the shape matching application we prefer to avoid eigenfunctions that correspond to high eigenvalues.

In our analysis (and implementation) we use the plain vanilla feature vector 
                           
                              
                                 
                                    J
                                 
                                 Φ
                              
                              ≡
                              
                                 J
                                 
                                    ω
                                 
                                 Φ
                              
                              ∪
                              
                                 J
                                 
                                    ν
                                 
                                 Φ
                              
                           
                        , where 
                           
                              
                                 J
                                 
                                    ω
                                 
                                 Φ
                              
                              ≡
                              
                                 
                                    {
                                    
                                       ω
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    }
                                 
                                 
                                    1
                                    ≤
                                    i
                                    ≤
                                    j
                                    ≤
                                    
                                       N
                                       0
                                    
                                 
                              
                           
                         and 
                           
                              
                                 J
                                 
                                    ν
                                 
                                 Φ
                              
                              ≡
                              
                                 
                                    {
                                    
                                       ν
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    }
                                 
                                 
                                    1
                                    ≤
                                    i
                                    <
                                    j
                                    ≤
                                    
                                       N
                                       0
                                    
                                 
                              
                           
                         are the inner and external parts of the feature vector, respectively. JΦ
                         excludes the dependency on the parameter t. This feature vector is invariant to global scaling as shown in the proof of Theorem 2. Notice, that we have omitted some of the features because 
                           
                              
                                 ν
                                 
                                    i
                                    ,
                                    i
                                 
                              
                              =
                              0
                              ,
                              
                                 ν
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              =
                              −
                              
                                 ν
                                 
                                    j
                                    ,
                                    i
                                 
                              
                           
                         and 
                           
                              
                                 ω
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              =
                              
                                 ω
                                 
                                    j
                                    ,
                                    i
                                 
                              
                           
                         for all i, j. In that case, 
                           
                              
                                 |
                              
                              
                                 J
                                 
                                    ω
                                 
                                 Φ
                              
                              
                                 |
                                 =
                              
                              
                                 1
                                 2
                              
                              
                                 N
                                 0
                              
                              
                                 (
                                 
                                    N
                                    0
                                 
                                 −
                                 1
                                 )
                              
                              +
                              
                                 N
                                 0
                              
                           
                         and 
                           
                              
                                 |
                              
                              
                                 J
                                 
                                    ν
                                 
                                 Φ
                              
                              
                                 |
                                 =
                              
                              
                                 1
                                 2
                              
                              
                                 N
                                 0
                              
                              
                                 (
                                 
                                    N
                                    0
                                 
                                 −
                                 1
                                 )
                              
                           
                        . Therefore, the number of nontrivial and unique features in JΦ
                         is 
                           
                              N
                              
                                 0
                              
                              2
                           
                        .

As a case study, we analyze the spectral GFs embedding of a human shape. For this shape, assume we are given 
                           
                              
                                 N
                                 0
                              
                              =
                              6
                           
                         eigenfunctions. Accordingly, the size of the spectral GFs feature vector is 
                           
                              
                                 
                                    6
                                 
                                 2
                              
                              =
                              36
                           
                        . Since JΦ
                         is nonlinear in ϕ, it is interesting to visualize how the energy of the feature vector is distributed as a function of the eigenvalues. This spectral density S(λi
                        ) is calculated by
                           
                              
                                 
                                    S
                                    
                                       (
                                       
                                          λ
                                          i
                                       
                                       )
                                    
                                    ≡
                                    
                                       
                                          
                                             ∑
                                             n
                                          
                                          
                                             
                                                0.12
                                                e
                                                m
                                             
                                             
                                                0
                                                e
                                                x
                                             
                                          
                                          
                                             α
                                             
                                                n
                                                ,
                                                i
                                             
                                             2
                                          
                                       
                                       
                                          
                                             ∑
                                             
                                                n
                                                ,
                                                i
                                             
                                          
                                          
                                             
                                                0.12
                                                e
                                                m
                                             
                                             
                                                0
                                                e
                                                x
                                             
                                          
                                          
                                             α
                                             
                                                n
                                                ,
                                                i
                                             
                                             2
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          1
                                          e
                                          m
                                       
                                       
                                          0
                                          e
                                          x
                                       
                                    
                                    
                                       α
                                       
                                          n
                                          ,
                                          i
                                       
                                    
                                    ≡
                                    
                                       ∫
                                       X
                                    
                                    
                                       f
                                       n
                                    
                                    
                                       (
                                       x
                                       )
                                    
                                    
                                       ϕ
                                       i
                                    
                                    
                                       (
                                       x
                                       )
                                    
                                    da
                                    
                                       (
                                       x
                                       )
                                    
                                    ,
                                 
                              
                           
                        where fn
                        (x) is the nth
                         element of the feature vector. In Fig. 2
                        
                        
                        , we plot the energy of the spectral GFs features vector as a function of the eigenvalues, and compare it to the spectrum of the global point signature (GPS) feature vector. We see, that the spectrum of the inner and external products is more widely distributed, which means that they could reflect finer details of the surface structure.

The feature vector JΦ
                         induces a distance 
                           
                              
                                 
                                    d
                                    ˜
                                 
                                 X
                              
                              :
                              X
                              ×
                              
                              X
                              →
                              
                                 R
                                 
                                    ≥
                                    0
                                 
                              
                           
                         between points on the shape
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   d
                                                   ˜
                                                
                                                X
                                             
                                             
                                                (
                                                
                                                   x
                                                   1
                                                
                                                ,
                                                
                                                   x
                                                   2
                                                
                                                )
                                             
                                          
                                       
                                       
                                          ≡
                                       
                                       
                                          
                                             
                                                ∥
                                             
                                             
                                                
                                                   J
                                                
                                                Φ
                                             
                                             
                                                (
                                                
                                                   x
                                                   1
                                                
                                                )
                                             
                                             −
                                             
                                                
                                                   J
                                                
                                                Φ
                                             
                                             
                                                (
                                                
                                                   x
                                                   2
                                                
                                                )
                                             
                                             
                                                ∥
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   i
                                                   ,
                                                   j
                                                   =
                                                   1
                                                
                                                
                                                   N
                                                   0
                                                
                                             
                                             
                                                
                                                   (
                                                   
                                                      ω
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         1
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      ω
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         2
                                                      
                                                      )
                                                   
                                                   )
                                                
                                                2
                                             
                                             +
                                             
                                                
                                                   (
                                                   
                                                      ν
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         1
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      ν
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                   
                                                   
                                                      (
                                                      x
                                                      )
                                                   
                                                   )
                                                
                                                2
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     


                        Fig. 3 depicts the distance function 
                           
                              
                                 
                                    d
                                    ˜
                                 
                                 X
                              
                              
                                 (
                                 p
                                 ,
                                 x
                                 )
                              
                           
                        , between a fixed point p ∈ X on the front of the human shape to any other point x ∈ X. We observe that 
                           
                              
                                 
                                    d
                                    ˜
                                 
                                 X
                              
                              
                                 (
                                 p
                                 ,
                                 x
                                 )
                              
                           
                         is invariant to the isometric deformation, as expected.

For two shapes X, Y, let us assume we are given compatible eigenbases of size N
                        0, meaning that 
                           
                              
                                 ϕ
                                 
                                    i
                                 
                                 X
                              
                              
                                 (
                                 x
                                 )
                              
                              ≈
                              
                                 ϕ
                                 
                                    i
                                 
                                 Y
                              
                              
                                 (
                                 φ
                                 
                                    (
                                    x
                                    )
                                 
                                 )
                              
                              ,
                              ∀
                              
                                 
                                    0.12
                                    e
                                    m
                                 
                                 
                                    0
                                    e
                                    x
                                 
                              
                              i
                              ∈
                              
                                 {
                                 1
                                 ⋯
                                 
                                    N
                                    0
                                 
                                 }
                              
                           
                        , for all points x ∈ X. In the common embedding space, the distance 
                           
                              
                                 d
                                 
                                    X
                                    ,
                                    Y
                                 
                              
                              
                                 (
                                 x
                                 ,
                                 y
                                 )
                              
                              :
                              X
                              ×
                              
                              Y
                              →
                              R
                           
                         between a point on one shape to a point on the other shape is simply
                           
                              (3)
                              
                                 
                                    
                                       
                                          
                                             
                                                d
                                                
                                                   X
                                                   ,
                                                   Y
                                                
                                             
                                             
                                                (
                                                x
                                                ,
                                                y
                                                )
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                ∥
                                             
                                             
                                                
                                                   J
                                                
                                                
                                                   
                                                      Φ
                                                   
                                                   X
                                                
                                             
                                             
                                                (
                                                x
                                                )
                                             
                                             −
                                             
                                                
                                                   J
                                                
                                                
                                                   
                                                      Φ
                                                   
                                                   Y
                                                
                                             
                                             
                                                
                                                   (
                                                   y
                                                   )
                                                
                                                ∥
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   i
                                                   ,
                                                   j
                                                   =
                                                   1
                                                
                                                
                                                   N
                                                   0
                                                
                                             
                                             
                                                
                                                   (
                                                   
                                                      ω
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                      X
                                                   
                                                   
                                                      (
                                                      x
                                                      )
                                                   
                                                   −
                                                   
                                                      ω
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                      Y
                                                   
                                                   
                                                      (
                                                      y
                                                      )
                                                   
                                                   )
                                                
                                                2
                                             
                                             +
                                             
                                                
                                                   (
                                                   
                                                      ν
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                      X
                                                   
                                                   
                                                      (
                                                      x
                                                      )
                                                   
                                                   −
                                                   
                                                      ν
                                                      
                                                         i
                                                         ,
                                                         j
                                                      
                                                      Y
                                                   
                                                   
                                                      (
                                                      y
                                                      )
                                                   
                                                   )
                                                
                                                2
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

In Fig. 4 we visualize the distance d
                        
                           X, Y
                        (p, y) from the fixed point p ∈ X to all points y ∈ Y. We see (column 1), that points on surface Y that are close to the image of p, also have low values of 
                           
                              
                                 
                                    d
                                    ˜
                                 
                                 
                                    X
                                    ,
                                    Y
                                 
                              
                              
                                 (
                                 p
                                 ,
                                 y
                                 )
                              
                           
                        . Hence, for a point to point correspondence application, we should assign the corresponding point of p as the one with the smallest distance from p, in the common Euclidean space. Notice especially, that while the GPS embedding (column 4) makes points on the back mistakenly close to p, by using the spectral GFs feature vector this effect is diminished. This can be explained by the use of the ν
                        
                           i, j
                         features (column 3), that include the cross product operation which is an extrinsic operation. Pure intrinsic embeddings do not use this important attribute of the surface, so the embedding 
                           
                              J
                              
                                 ν
                              
                              Φ
                           
                         presents additional global features. Combined with the inner product based embedding 
                           
                              J
                              
                                 ω
                              
                              Φ
                           
                         which is more locally accurate (column 2), the spectral gradient fields embedding JΦ
                         is well suited for finding point to point correspondences.

For two nearly isometric shapes X, Y, one might say that the eigenfunction 
                           
                              ϕ
                              
                                 i
                              
                              X
                           
                         is matched to the eigenfunction 
                           
                              ϕ
                              
                                 j
                              
                              Y
                           
                         up to a sign, if the difference between 
                           
                              ϕ
                              
                                 i
                              
                              X
                           
                         and 
                           
                              
                                 ϕ
                                 
                                    j
                                 
                                 Y
                              
                              ∘
                              φ
                           
                        
                        
                           
                              (4)
                              
                                 
                                    
                                       
                                          
                                             E
                                             
                                                (
                                                i
                                                ,
                                                j
                                                )
                                             
                                             ≡
                                             
                                                
                                                   APTARANORMAL
                                                   min
                                                
                                                
                                                   s
                                                   ∈
                                                   {
                                                   +
                                                   1
                                                   ,
                                                   −
                                                   1
                                                   }
                                                
                                             
                                             
                                                ∫
                                                X
                                             
                                             
                                                |
                                             
                                             
                                                ϕ
                                                
                                                   i
                                                
                                                X
                                             
                                             
                                                (
                                                x
                                                )
                                             
                                             −
                                             s
                                             
                                                ϕ
                                                
                                                   j
                                                
                                                Y
                                             
                                             
                                                (
                                                φ
                                                
                                                   (
                                                   x
                                                   )
                                                
                                                )
                                             
                                             
                                                
                                                   |
                                                
                                                2
                                             
                                             da
                                             
                                                (
                                                x
                                                )
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        is lower than a certain threshold, where da is the area element of X. In Fig. 5, we see that for the databases we analyze [15,16], the probability of finding a match for the ith eigenfunction drops sharply as i increases beyond a certain point (the seventh eigenfunction for the databases we tested). This means that N
                        0, the number of eigenfunctions that is used for defining the common embedding, should be kept small.

@&#IMPLEMENTATION@&#

For the purpose of testing our ideas, we developed a holistic correspondence system. At the heart of the system we use the spectral GFs embedding, defined in Eqs. (1) and (2), and compute the inter-shape point to point distances d
                        
                           X, Y
                        (x, y) of Eq. (3), where we use 
                           
                              
                                 N
                                 0
                              
                              =
                              6
                           
                         compatible eigenfunctions that are found automatically (based on [17]). Then, we apply a nearest neighbor search to find the initial correspondence
                           
                              (5)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   φ
                                                   ^
                                                
                                                0
                                             
                                             
                                                (
                                                x
                                                )
                                             
                                             =
                                             
                                                
                                                   argmin
                                                
                                                
                                                   y
                                                   ∈
                                                   Y
                                                
                                             
                                             
                                                d
                                                
                                                   X
                                                   ,
                                                   Y
                                                
                                             
                                             
                                                (
                                                x
                                                ,
                                                y
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

As a preprocess step, pairs of points that have low possibility of being matched are filtered out by comparing a mix of global and local features, using the compatible eigenfunctions themselves and the wave kernel signature [6]. We filter out pairs of points if their feature vectors are too far in the L
                        2 sense. After applying the spectral GFs embedding method using Eq. (5), we refine the correspondence with the iterative closest spectral kernel maps (ICSKM) algorithm [18]. The alignment of the spectral kernels of the two shapes by the ICSKM algorithm, produces the final dense map 
                           
                              
                                 φ
                                 ^
                              
                              :
                              X
                              →
                              Y
                           
                        .
                     

We tested the proposed method on pairs of shapes represented by triangulated meshes from both the SCAPE database [15] and the TOSCA database [16]. The SCAPE dataset contains 71 registered meshes of a particular person in different poses. The TOSCA dataset contains 80 densely sampled synthetic human and animal surfaces, divided into several classes with given ground-truth point-to-point correspondences between the shapes within each class. We compare the results of our framework to several correspondence detection methods.
                           
                              •
                              Spectral GFs Embedding – the method proposed in this paper.

Spectral Maps – the correspondence system used in this paper, without the use of the spectral GFs embedding. At the preprocess stage we filter out all correspondences except one.

Blended – the method proposed by Kim et al. that uses a weighted combination of isometric maps [14].


                        Figs. 6 and 7
                        
                        
                         compare our correspondence method with existing methods on the SCAPE and TOSCA benchmarks, using the evaluation protocol proposed in [14]. For each method we plot the distortion curves with the ICSKM refinement procedure (solid), and without it (dotted). The distortion curves describe the percentage of surface points falling within a relative geodesic distance from what is assumed to be their true locations. For each shape, the geodesic distance is normalized by the square root of the shape’s area. It is evident from the benchmarks that the proposed method is well suited for finding maps between approximately isometric shapes, and together with the ICSKM algorithm achieves state-of-the-art results.

Intrinsic symmetry detection can be viewed as finding a map from a shape to itself [19]. When the shape has a reflective symmetry, its self-map flips the orientation of the surface. In that case, we can apply the proposed shape matching method, by adjusting the normal to the surface to point inward, and consequently change the external product features of the reflective shape to be 
                           
                              −
                              
                                 ν
                                 
                                    i
                                    ,
                                    j
                                 
                              
                           
                        . Then, we can use the estimated reflective self-map 
                           
                              
                                 
                                    φ
                                    ^
                                 
                                 R
                              
                              :
                              X
                              →
                              X
                           
                         to partition the shape into its two mirror halves. First, we find a point p that is well inside one of the two halves of the shape, for example by selecting a point that is as far as possible from its reflective image 
                           
                              
                                 φ
                                 ^
                              
                              
                                 (
                                 p
                                 )
                              
                           
                        , i.e. we find the point 
                           
                              p
                              =
                              
                                 
                                    argmax
                                 
                                 
                                    x
                                    ∈
                                    X
                                 
                              
                              g
                              
                                 (
                                 x
                                 ,
                                 
                                    
                                       φ
                                       ^
                                    
                                    R
                                 
                                 
                                    (
                                    x
                                    )
                                 
                                 )
                              
                           
                        , where 
                           
                              g
                              :
                              X
                              ×
                              
                              X
                              →
                              
                                 R
                                 
                                    ≥
                                    0
                                 
                              
                           
                         is the geodesic distance function between two points on the surface of the shape. Then, we check if each point x ∈ X belongs to the half of the shape that includes p. We assign x to this half if 
                           
                              g
                              
                                 (
                                 x
                                 ,
                                 p
                                 )
                              
                              +
                              g
                              (
                              
                                 
                                    φ
                                    ^
                                 
                                 R
                              
                              
                                 (
                                 x
                                 )
                              
                              ,
                              
                                 
                                    φ
                                    ^
                                 
                                 R
                              
                              
                                 (
                                 p
                                 )
                              
                              )
                           
                         is less than 
                           
                              g
                              
                                 (
                                 
                                    
                                       φ
                                       ^
                                    
                                    R
                                 
                                 
                                    (
                                    x
                                    )
                                 
                                 ,
                                 p
                                 )
                              
                              +
                              g
                              
                                 (
                                 x
                                 ,
                                 
                                    
                                       φ
                                       ^
                                    
                                    R
                                 
                                 
                                    (
                                    p
                                    )
                                 
                                 )
                              
                           
                        . In Fig. 8, we demonstrate the effectiveness of the proposed approach, by visualizing the bilateral symmetry for several shapes from the TOSCA database.

@&#CONCLUSIONS@&#

A new feature vector for embedding nonrigid shapes was introduced and integrated into a holistic shape matching system. The embedding, which is proved to be injective, induces a distance between points on the surface, and can be defined to measure a distance between shapes. We have demonstrated the effectiveness of the proposed approach by achieving state-of-the-art results on shape matching benchmarks.

In the future, we plan to examine the properties of the GFs embedding in conjunction with compatible functions on the two shapes, that are different from the eigenfunctions. For example, one may use the heat kernel signature (HKS), wave kernel signature (WKS) [6] or the heat kernel maps (HKM) [20] set with landmark correspondences. These options seem particularly useful when the shapes are noisy, or the deformations are large, making the eigenfunctions incompatible.

@&#ACKNOWLEDGMENT@&#

This work has been supported by Grant agreement No. 267414 of the European Community’s FP7-ERC program.

We need to prove that if x
                     1, are two distinct points on the Riemannian manifold, then, there exists a smooth function f, such that 
                        
                           ∇
                           f
                           (
                           
                              x
                              1
                           
                           )
                           
                              
                                 0.25
                                 e
                                 m
                              
                              
                                 0
                                 e
                                 x
                              
                           
                           ≠
                           
                              
                                 0.25
                                 e
                                 m
                              
                              
                                 0
                                 e
                                 x
                              
                           
                           0
                        
                     , and 
                        
                           ∇
                           f
                           (
                           
                              x
                              2
                           
                           )
                           =
                           0
                        
                     . We use two technical Lemmas.
                        Lemma 1
                        
                           Let U
                           1, U
                           2 
                           be two disjoint closed sets. Then, there exists a smooth function
                           
                              
                                 
                                    u
                                    1
                                 
                                 :
                                 X
                                 →
                                 
                                    R
                                    
                                       ≥
                                       0
                                    
                                 
                              
                           
                           , such that
                           
                              
                                 i.
                                 
                                    
                                       
                                          
                                             u
                                             1
                                          
                                          
                                             (
                                             x
                                             )
                                          
                                          =
                                          1
                                          ,
                                          ∀
                                          
                                             
                                                0.12
                                                e
                                                m
                                             
                                             
                                                0
                                                e
                                                x
                                             
                                          
                                          x
                                          ∈
                                          
                                             U
                                             1
                                          
                                       
                                    .


                                    
                                       
                                          
                                             u
                                             1
                                          
                                          
                                             (
                                             x
                                             )
                                          
                                          =
                                          0
                                          ,
                                          ∀
                                          
                                             
                                                0.12
                                                e
                                                m
                                             
                                             
                                                0
                                                e
                                                x
                                             
                                          
                                          x
                                          ∈
                                          
                                             U
                                             2
                                          
                                       
                                    .


                           U
                           1, U
                           2 are disjoint, thereby {Xâ§¹U
                           2, Xâ§¹U
                           1} is an open cover for X. Hence, there exists a partition of unity of nonnegative functions 
                              
                                 
                                    u
                                    1
                                 
                                 ,
                                 
                                    u
                                    2
                                 
                                 :
                                 X
                                 →
                                 
                                    R
                                    
                                       ≥
                                       0
                                    
                                 
                              
                           , such that the support of u
                           1 is contained in Xâ§¹U
                           2 and the support of u
                           2 is contained in Xâ§¹U
                           1. Moreover, 
                              
                                 
                                    u
                                    1
                                 
                                 +
                                 
                                    u
                                    2
                                 
                                 =
                                 1
                              
                            everywhere.
                              
                                 i.
                                 The support of u
                                    2 is contained in Xâ§¹U1, hence, 
                                       
                                          
                                             u
                                             2
                                          
                                          
                                             (
                                             x
                                             )
                                          
                                          =
                                          0
                                          ,
                                          
                                             
                                                0.15
                                                e
                                                m
                                             
                                             
                                                0
                                                e
                                                x
                                             
                                          
                                          ∀
                                          
                                             
                                                0.12
                                                e
                                                m
                                             
                                             
                                                0
                                                e
                                                x
                                             
                                          
                                          x
                                          ∈
                                          
                                             U
                                             1
                                          
                                       
                                    . Therefore, 
                                       
                                          
                                             u
                                             1
                                          
                                          
                                             (
                                             x
                                             )
                                          
                                          =
                                          1
                                          −
                                          
                                             u
                                             2
                                          
                                          
                                             (
                                             x
                                             )
                                          
                                          =
                                          1
                                          ,
                                          
                                             
                                                0.15
                                                e
                                                m
                                             
                                             
                                                0
                                                e
                                                x
                                             
                                          
                                          ∀
                                          
                                             
                                                0.12
                                                e
                                                m
                                             
                                             
                                                0
                                                e
                                                x
                                             
                                          
                                          x
                                          ∈
                                          
                                             U
                                             1
                                          
                                       
                                    .

Because the support of u
                                    1 is contained in Xâ§¹U
                                    2, it follows that 
                                       
                                          
                                             u
                                             1
                                          
                                          
                                             (
                                             x
                                             )
                                          
                                          =
                                          0
                                          ,
                                          ∀
                                          
                                             
                                                0.12
                                                e
                                                m
                                             
                                             
                                                0
                                                e
                                                x
                                             
                                          
                                          x
                                          ∈
                                          
                                             U
                                             2
                                          
                                       
                                    .


                           Let x
                           1, be two distinct points on the Riemannian manifold. Then, there exists a smooth function
                           
                              
                                 
                                    u
                                    1
                                 
                                 :
                                 X
                                 →
                                 
                                    R
                                    
                                       ≥
                                       0
                                    
                                 
                              
                           
                           , such that
                           
                              
                                 
                                    u
                                    1
                                 
                                 
                                    (
                                    
                                       x
                                       1
                                    
                                    )
                                 
                                 =
                                 1
                                 ,
                                 
                                    u
                                    1
                                 
                                 
                                    (
                                    
                                       x
                                       2
                                    
                                    )
                                 
                                 =
                                 0
                                 ,
                                 ∇
                                 
                                    u
                                    1
                                 
                                 
                                    (
                                    
                                       x
                                       1
                                    
                                    )
                                 
                                 =
                                 0
                              
                            
                           and
                           
                              
                                 ∇
                                 
                                    u
                                    1
                                 
                                 
                                    (
                                    
                                       x
                                       2
                                    
                                    )
                                 
                                 =
                                 0
                              
                           
                           .
                        

Construct two disjoint closed sets U
                           1, U
                           2, such that x
                           1 is in the interior of U
                           1, and x
                           2 is in the interior of U
                           2. Then, use Lemma 2 to make such u
                           1. 
□

Now, take a smooth function 
                        
                           g
                           :
                           X
                           →
                           R
                        
                     , with a non zero gradient at point x
                     1, i.e. 
                        
                           g
                           (
                           
                              x
                              1
                           
                           )
                           
                              
                                 0.25
                                 e
                                 m
                              
                              
                                 0
                                 e
                                 x
                              
                           
                           ≠
                           
                              
                                 0.25
                                 e
                                 m
                              
                              
                                 0
                                 e
                                 x
                              
                           
                           0
                        
                     . Using Lemma 2, construct the function 
                        
                           f
                           =
                           
                              u
                              1
                           
                           g
                        
                     . By the chain rule
                        
                           
                              
                                 
                                    
                                       
                                          
                                             ∇
                                             f
                                             
                                                (
                                                
                                                   x
                                                   1
                                                
                                                )
                                             
                                             =
                                             
                                                u
                                                1
                                             
                                             
                                                (
                                                
                                                   x
                                                   1
                                                
                                                )
                                             
                                             ∇
                                             g
                                             
                                                (
                                                
                                                   x
                                                   1
                                                
                                                )
                                             
                                             +
                                             g
                                             
                                                (
                                                
                                                   x
                                                   1
                                                
                                                )
                                             
                                             ∇
                                             
                                                u
                                                1
                                             
                                             
                                                (
                                                
                                                   x
                                                   1
                                                
                                                )
                                             
                                             =
                                             1
                                             ·
                                             ∇
                                             g
                                             
                                                (
                                                
                                                   x
                                                   1
                                                
                                                )
                                             
                                             +
                                             g
                                             
                                                (
                                                
                                                   x
                                                   1
                                                
                                                )
                                             
                                             ·
                                             0
                                             ,
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             ∇
                                             f
                                             
                                                (
                                                
                                                   x
                                                   2
                                                
                                                )
                                             
                                             =
                                             
                                                u
                                                1
                                             
                                             
                                                (
                                                
                                                   x
                                                   2
                                                
                                                )
                                             
                                             ∇
                                             g
                                             
                                                (
                                                
                                                   x
                                                   2
                                                
                                                )
                                             
                                             +
                                             g
                                             
                                                (
                                                
                                                   x
                                                   2
                                                
                                                )
                                             
                                             ∇
                                             
                                                u
                                                1
                                             
                                             
                                                (
                                                
                                                   x
                                                   2
                                                
                                                )
                                             
                                             =
                                             0
                                             ·
                                             ∇
                                             g
                                             
                                                (
                                                
                                                   x
                                                   2
                                                
                                                )
                                             
                                             +
                                             g
                                             
                                                (
                                                
                                                   x
                                                   2
                                                
                                                )
                                             
                                             ·
                                             0
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     We conclude that 
                        
                           ∇
                           f
                           (
                           
                              x
                              1
                           
                           )
                           
                              
                                 0.25
                                 e
                                 m
                              
                              
                                 0
                                 e
                                 x
                              
                           
                           ≠
                           
                              
                                 0.25
                                 e
                                 m
                              
                              
                                 0
                                 e
                                 x
                              
                           
                           0
                        
                      and that 
                        
                           ∇
                           f
                           (
                           
                              x
                              2
                           
                           )
                           =
                           0
                        
                     .


                     
                        Proof
                        If the Riemannian manifold 
                              
                                 X
                                 ¯
                              
                            is obtained by uniformly scaling the metric of the Riemannian manifold X by a factor α > 0, then, the eigenvalues of the Laplace–Beltrami operator are scaled according to 
                              
                                 
                                    λ
                                    
                                       i
                                    
                                    
                                       X
                                       ¯
                                    
                                 
                                 =
                                 
                                    
                                       α
                                    
                                    
                                       −
                                       2
                                    
                                 
                                 
                                    λ
                                    
                                       i
                                    
                                    X
                                 
                              
                           , the corresponding L
                           2-normalized eigenfunctions become 
                              
                                 
                                    ϕ
                                    
                                       i
                                    
                                    
                                       X
                                       ¯
                                    
                                 
                                 =
                                 
                                    
                                       α
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    ϕ
                                    
                                       i
                                    
                                    X
                                 
                              
                           , and the gradient operator reads 
                              
                                 
                                    
                                       ∇
                                    
                                    
                                       X
                                       ¯
                                    
                                 
                                 =
                                 
                                    
                                       α
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       ∇
                                    
                                    X
                                 
                              
                           . We have
                              
                                 
                                    
                                       
                                          
                                             
                                                ω
                                                
                                                   i
                                                   ,
                                                   j
                                                
                                                
                                                   X
                                                   ¯
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   Vol
                                                
                                                
                                                   (
                                                   
                                                      X
                                                      ¯
                                                   
                                                   )
                                                
                                                
                                                   
                                                      〈
                                                      
                                                         
                                                            ∇
                                                         
                                                         
                                                            X
                                                            ¯
                                                         
                                                      
                                                      
                                                         ϕ
                                                         
                                                            i
                                                         
                                                         
                                                            X
                                                            ¯
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            ∇
                                                         
                                                         
                                                            X
                                                            ¯
                                                         
                                                      
                                                      
                                                         ϕ
                                                         
                                                            j
                                                         
                                                         
                                                            X
                                                            ¯
                                                         
                                                      
                                                      〉
                                                   
                                                   
                                                      
                                                         
                                                            λ
                                                            
                                                               i
                                                            
                                                            
                                                               X
                                                               ¯
                                                            
                                                         
                                                         
                                                            λ
                                                            
                                                               j
                                                            
                                                            
                                                               X
                                                               ¯
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   
                                                      α
                                                   
                                                   2
                                                
                                                
                                                   Vol
                                                
                                                
                                                   (
                                                   X
                                                   )
                                                
                                                
                                                   
                                                      〈
                                                      
                                                         
                                                            α
                                                         
                                                         
                                                            −
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            ∇
                                                         
                                                         X
                                                      
                                                      
                                                         
                                                            α
                                                         
                                                         
                                                            −
                                                            1
                                                         
                                                      
                                                      
                                                         ϕ
                                                         
                                                            i
                                                         
                                                         X
                                                      
                                                      ,
                                                      
                                                         
                                                            α
                                                         
                                                         
                                                            −
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            ∇
                                                         
                                                         X
                                                      
                                                      
                                                         
                                                            α
                                                         
                                                         
                                                            −
                                                            1
                                                         
                                                      
                                                      
                                                         ϕ
                                                         
                                                            j
                                                         
                                                         X
                                                      
                                                      〉
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               α
                                                            
                                                            
                                                               −
                                                               2
                                                            
                                                         
                                                         
                                                            λ
                                                            
                                                               i
                                                            
                                                            X
                                                         
                                                         
                                                            
                                                               α
                                                            
                                                            
                                                               −
                                                               2
                                                            
                                                         
                                                         
                                                            λ
                                                            
                                                               j
                                                            
                                                            X
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   Vol
                                                
                                                
                                                   (
                                                   X
                                                   )
                                                
                                                
                                                   
                                                      〈
                                                      
                                                         
                                                            ∇
                                                         
                                                         X
                                                      
                                                      
                                                         ϕ
                                                         
                                                            i
                                                         
                                                         X
                                                      
                                                      ,
                                                      
                                                         
                                                            ∇
                                                         
                                                         X
                                                      
                                                      
                                                         ϕ
                                                         
                                                            j
                                                         
                                                         X
                                                      
                                                      〉
                                                   
                                                   
                                                      
                                                         
                                                            λ
                                                            
                                                               i
                                                            
                                                            X
                                                         
                                                         
                                                            λ
                                                            
                                                               j
                                                            
                                                            X
                                                         
                                                      
                                                   
                                                
                                                =
                                                
                                                   ω
                                                   
                                                      i
                                                      ,
                                                      j
                                                   
                                                   X
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           which means that 
                              
                                 ω
                                 
                                    i
                                    ,
                                    j
                                 
                                 X
                              
                            is global scale invariant. Now, if we set 
                              
                                 
                                    t
                                    ¯
                                 
                                 =
                                 
                                    
                                       α
                                    
                                    2
                                 
                                 t
                              
                           
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      J
                                                      
                                                         
                                                            t
                                                            ¯
                                                         
                                                      
                                                      
                                                         
                                                            Φ
                                                         
                                                         
                                                            X
                                                            ¯
                                                         
                                                      
                                                   
                                                   )
                                                
                                                
                                                   i
                                                   ,
                                                   j
                                                
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      −
                                                      
                                                         (
                                                         
                                                            λ
                                                            
                                                               i
                                                            
                                                            
                                                               X
                                                               ¯
                                                            
                                                         
                                                         +
                                                         
                                                            λ
                                                            
                                                               j
                                                            
                                                            
                                                               X
                                                               ¯
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         t
                                                         ¯
                                                      
                                                      /
                                                      2
                                                   
                                                
                                                
                                                   ω
                                                   
                                                      i
                                                      ,
                                                      j
                                                   
                                                   
                                                      X
                                                      ¯
                                                   
                                                
                                                =
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      −
                                                      
                                                         (
                                                         
                                                            
                                                               α
                                                            
                                                            
                                                               −
                                                               2
                                                            
                                                         
                                                         
                                                            λ
                                                            
                                                               i
                                                            
                                                            X
                                                         
                                                         +
                                                         
                                                            
                                                               α
                                                            
                                                            
                                                               −
                                                               2
                                                            
                                                         
                                                         
                                                            λ
                                                            
                                                               j
                                                            
                                                            X
                                                         
                                                         )
                                                      
                                                      
                                                         
                                                            α
                                                         
                                                         2
                                                      
                                                      t
                                                      /
                                                      2
                                                   
                                                
                                                
                                                   ω
                                                   
                                                      i
                                                      ,
                                                      j
                                                   
                                                   X
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      −
                                                      (
                                                      
                                                         λ
                                                         
                                                            i
                                                         
                                                         X
                                                      
                                                      +
                                                      
                                                         λ
                                                         
                                                            j
                                                         
                                                         X
                                                      
                                                      )
                                                      t
                                                      /
                                                      2
                                                   
                                                
                                                
                                                   ω
                                                   
                                                      i
                                                      ,
                                                      j
                                                   
                                                   X
                                                
                                                =
                                                
                                                   
                                                      (
                                                      
                                                         J
                                                         
                                                            t
                                                         
                                                         
                                                            
                                                               Φ
                                                            
                                                            X
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

We would like to show that the spectral gradient fields distance 
                        
                           
                              d
                              
                                 t
                              
                              
                                 GF
                              
                           
                           :
                           M
                           ×
                           
                           M
                           →
                           
                              R
                              
                                 ≥
                                 0
                              
                           
                        
                      satisfies the following properties of a pseudometric.
                        
                           P1:
                           Symmetry – 
                                 
                                    
                                       d
                                       
                                          t
                                       
                                       
                                          GF
                                       
                                    
                                    
                                       (
                                       X
                                       ,
                                       Y
                                       )
                                    
                                    =
                                    
                                       d
                                       
                                          t
                                       
                                       
                                          GF
                                       
                                    
                                    
                                       (
                                       Y
                                       ,
                                       X
                                       )
                                    
                                 
                               for every 
                                 
                                    X
                                    ,
                                    Y
                                    ∈
                                    M
                                 
                              .

Triangle-inequality – For every three Riemannian manifolds 
                                 
                                    X
                                    ,
                                    Y
                                    ,
                                    Z
                                    ∈
                                    M
                                 
                              ,
                                 
                                    
                                       
                                          
                                             d
                                             
                                                t
                                             
                                             
                                                GF
                                             
                                          
                                          
                                             (
                                             X
                                             ,
                                             Z
                                             )
                                          
                                          ≤
                                          
                                             d
                                             
                                                t
                                             
                                             
                                                GF
                                             
                                          
                                          
                                             (
                                             X
                                             ,
                                             Y
                                             )
                                          
                                          +
                                          
                                             d
                                             
                                                t
                                             
                                             
                                                GF
                                             
                                          
                                          
                                             (
                                             Y
                                             ,
                                             Z
                                             )
                                          
                                          .
                                       
                                    
                                 
                              
                           

Identity – If 
                                 
                                    X
                                    ,
                                    Y
                                    ∈
                                    M
                                 
                               are spectral GFs equivalent, then 
                                 
                                    
                                       d
                                       
                                          t
                                       
                                       GF
                                    
                                    
                                       (
                                       X
                                       ,
                                       Y
                                       )
                                    
                                    =
                                    0
                                 
                              .


                           For every three Riemannian manifolds
                           
                              
                                 X
                                 ,
                                 Y
                                 ,
                                 Z
                                 ∈
                                 M
                              
                           
                           ,
                           
                              
                                 
                                    
                                       
                                          d
                                          
                                             t
                                          
                                          
                                             GF
                                          
                                       
                                       
                                          (
                                          X
                                          ,
                                          Z
                                          )
                                       
                                       ≤
                                       
                                          d
                                          
                                             t
                                          
                                          
                                             GF
                                          
                                       
                                       
                                          (
                                          X
                                          ,
                                          Y
                                          )
                                       
                                       +
                                       
                                          d
                                          
                                             t
                                          
                                          
                                             GF
                                          
                                       
                                       
                                          (
                                          Y
                                          ,
                                          Z
                                          )
                                       
                                       .
                                    
                                 
                              
                           
                        

We denote
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      d
                                                      
                                                         X
                                                         ,
                                                         Y
                                                      
                                                   
                                                   
                                                      (
                                                      x
                                                      ,
                                                      y
                                                      )
                                                   
                                                   ≡
                                                   
                                                      ∥
                                                      
                                                         J
                                                         
                                                            t
                                                         
                                                         
                                                            
                                                               Φ
                                                            
                                                            X
                                                         
                                                      
                                                      
                                                         (
                                                         x
                                                         )
                                                      
                                                      −
                                                      
                                                         J
                                                         
                                                            t
                                                         
                                                         
                                                            
                                                               Φ
                                                            
                                                            Y
                                                         
                                                      
                                                      
                                                         (
                                                         y
                                                         )
                                                      
                                                      ∥
                                                   
                                                   ,
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      dis
                                                   
                                                   
                                                      (
                                                      φ
                                                      )
                                                   
                                                   ≡
                                                   
                                                      
                                                         sup
                                                      
                                                      
                                                         x
                                                         ∈
                                                         X
                                                      
                                                   
                                                   
                                                      d
                                                      
                                                         X
                                                         ,
                                                         Y
                                                      
                                                   
                                                   
                                                      (
                                                      x
                                                      ,
                                                      φ
                                                      
                                                         (
                                                         x
                                                         )
                                                      
                                                      )
                                                   
                                                   ,
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      dis
                                                   
                                                   
                                                      (
                                                      ψ
                                                      )
                                                   
                                                   ≡
                                                   
                                                      
                                                         sup
                                                      
                                                      
                                                         y
                                                         ∈
                                                         Y
                                                      
                                                   
                                                   
                                                      d
                                                      
                                                         X
                                                         ,
                                                         Y
                                                      
                                                   
                                                   
                                                      (
                                                      ψ
                                                      
                                                         (
                                                         y
                                                         )
                                                      
                                                      ,
                                                      y
                                                      )
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

The Hausdorff distance between 
                              
                                 J
                                 
                                    t
                                 
                                 
                                    
                                       Φ
                                    
                                    X
                                 
                              
                            and 
                              
                                 J
                                 
                                    t
                                 
                                 
                                    
                                       Φ
                                    
                                    Y
                                 
                              
                            is
                              
                                 
                                    
                                       
                                          d
                                          H
                                       
                                       
                                          (
                                          
                                             J
                                             
                                                t
                                             
                                             
                                                
                                                   Φ
                                                
                                                X
                                             
                                          
                                          ,
                                          
                                             J
                                             
                                                t
                                             
                                             
                                                
                                                   Φ
                                                
                                                Y
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          APTARANORMAL
                                          max
                                       
                                       
                                          (
                                          
                                             
                                                sup
                                             
                                             
                                                x
                                                ∈
                                                X
                                             
                                          
                                          
                                             
                                                inf
                                             
                                             
                                                y
                                                ∈
                                                Y
                                             
                                          
                                          
                                             d
                                             
                                                X
                                                ,
                                                Y
                                             
                                          
                                          
                                             (
                                             x
                                             ,
                                             y
                                             )
                                          
                                          ,
                                          
                                             
                                                sup
                                             
                                             
                                                y
                                                ∈
                                                Y
                                             
                                          
                                          
                                             
                                                inf
                                             
                                             
                                                x
                                                ∈
                                                X
                                             
                                          
                                          
                                             d
                                             
                                                X
                                                ,
                                                Y
                                             
                                          
                                          
                                             (
                                             x
                                             ,
                                             y
                                             )
                                          
                                          )
                                       
                                       .
                                    
                                 
                              
                           
                           
                              Lemma 3
                              
                                 if
                                 
                                    
                                       
                                          d
                                          H
                                       
                                       =
                                       ∈
                                    
                                 
                                 , then there exist φ: X → Y and ψ: Y → X such that
                                 
                                    
                                       
                                          d
                                          
                                             X
                                             ,
                                             Y
                                          
                                       
                                       
                                          (
                                          x
                                          ,
                                          φ
                                          
                                             (
                                             x
                                             )
                                          
                                          )
                                       
                                       ≤
                                       ∈
                                       ,
                                       ∀
                                       
                                          
                                             0.12
                                             e
                                             m
                                          
                                          
                                             0
                                             e
                                             x
                                          
                                       
                                       x
                                       ∈
                                       X
                                    
                                  
                                 and
                                 
                                    
                                       
                                          d
                                          
                                             X
                                             ,
                                             Y
                                          
                                       
                                       
                                          (
                                          ψ
                                          
                                             (
                                             y
                                             )
                                          
                                          ,
                                          y
                                          )
                                       
                                       ≤
                                       ∈
                                       ,
                                       ∀
                                       
                                          
                                             0.12
                                             e
                                             m
                                          
                                          
                                             0
                                             e
                                             x
                                          
                                       
                                       y
                                       ∈
                                       Y
                                    
                                 
                                 .
                              


                                 
                                    
                                       X
                                       ,
                                       Y
                                       ∈
                                       M
                                    
                                  are compact and 
                                    
                                       
                                          J
                                          
                                             t
                                          
                                          
                                             
                                                Φ
                                             
                                             X
                                          
                                       
                                       ,
                                       
                                          J
                                          
                                             t
                                          
                                          
                                             
                                                Φ
                                             
                                             Y
                                          
                                       
                                    
                                  are continuous one-to-one mappings. Thus, their images are also compact, which allows us to define 
                                    
                                       φ
                                       
                                          (
                                          x
                                          )
                                       
                                       =
                                       
                                          
                                             argmin
                                          
                                          
                                             y
                                             ∈
                                             Y
                                          
                                       
                                       
                                          d
                                          
                                             X
                                             ,
                                             Y
                                          
                                       
                                       
                                          (
                                          x
                                          ,
                                          y
                                          )
                                       
                                    
                                  and 
                                    
                                       ψ
                                       
                                          (
                                          y
                                          )
                                       
                                       =
                                       
                                          
                                             argmin
                                          
                                          
                                             x
                                             ∈
                                             X
                                          
                                       
                                       
                                          d
                                          
                                             X
                                             ,
                                             Y
                                          
                                       
                                       
                                          (
                                          x
                                          ,
                                          y
                                          )
                                       
                                    
                                 .
□

Now, if 
                              
                                 
                                    d
                                    
                                       t
                                    
                                    
                                       GF
                                    
                                 
                                 
                                    (
                                    X
                                    ,
                                    Y
                                    )
                                 
                                 ≤
                                 ∈
                              
                           , then, for any ΦX
                           , one can find ΦY
                           , φ, ψ (using Lemma 3) such that dis(φ) ≤ ∈, dis(ψ) ≤ ∈, i.e.
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      d
                                                      
                                                         X
                                                         ,
                                                         Y
                                                      
                                                   
                                                   
                                                      (
                                                      x
                                                      ,
                                                      φ
                                                      
                                                         (
                                                         x
                                                         )
                                                      
                                                      )
                                                   
                                                   ≤
                                                   ∈
                                                   ,
                                                   ∀
                                                   
                                                      
                                                         0.12
                                                         e
                                                         m
                                                      
                                                      
                                                         0
                                                         e
                                                         x
                                                      
                                                   
                                                   x
                                                   ,
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      d
                                                      
                                                         X
                                                         ,
                                                         Y
                                                      
                                                   
                                                   
                                                      (
                                                      ψ
                                                      
                                                         (
                                                         y
                                                         )
                                                      
                                                      ,
                                                      y
                                                      )
                                                   
                                                   ≤
                                                   ∈
                                                   ,
                                                   ∀
                                                   
                                                      
                                                         0.12
                                                         e
                                                         m
                                                      
                                                      
                                                         0
                                                         e
                                                         x
                                                      
                                                   
                                                   y
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           Let 
                              
                                 
                                    d
                                    
                                       t
                                    
                                    
                                       GF
                                    
                                 
                                 
                                    (
                                    X
                                    ,
                                    Y
                                    )
                                 
                                 =
                                 
                                    ∈
                                    1
                                 
                              
                            and 
                              
                                 
                                    d
                                    
                                       t
                                    
                                    
                                       GF
                                    
                                 
                                 
                                    (
                                    Y
                                    ,
                                    Z
                                    )
                                 
                                 =
                                 
                                    ∈
                                    2
                                 
                              
                           . Hence, for any ΦX
                           , there exist two eigenbases (ΦY, ΦZ
                           ), and two pairs of corresponding mappings (φ1: X → Y, ψ
                           1: Y → X) and (φ2: Y → Z, ψ
                           2: Z → Y) satisfying dis(φ1) ≤ ∈ 1, dis(ψ
                           1) ≤ ∈ 1, and dis(φ2) ≤ ∈ 2, dis(ψ
                           2) ≤ ∈ 2. Denote by 
                              
                                 φ
                                 =
                                 
                                    φ
                                    2
                                 
                                 ∘
                                 
                                    φ
                                    1
                                 
                                 :
                                 X
                                 →
                                 Z
                                 ,
                                 ψ
                                 =
                                 
                                    ψ
                                    1
                                 
                                 ∘
                                 
                                    ψ
                                    2
                                 
                                 :
                                 Z
                                 →
                                 X
                              
                           . Invoking the triangle inequality for ℓ2 spaces, one has
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      d
                                                      
                                                         X
                                                         ,
                                                         Z
                                                      
                                                   
                                                   
                                                      (
                                                      x
                                                      ,
                                                      φ
                                                      
                                                         (
                                                         x
                                                         )
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             ≤
                                          
                                          
                                             
                                                
                                                   d
                                                   
                                                      X
                                                      ,
                                                      Y
                                                   
                                                
                                                
                                                   (
                                                   x
                                                   ,
                                                   
                                                      φ
                                                      1
                                                   
                                                   
                                                      (
                                                      x
                                                      )
                                                   
                                                   )
                                                
                                                +
                                                
                                                   d
                                                   
                                                      Y
                                                      ,
                                                      Z
                                                   
                                                
                                                
                                                   (
                                                   
                                                      φ
                                                      1
                                                   
                                                   
                                                      (
                                                      x
                                                      )
                                                   
                                                   ,
                                                   φ
                                                   
                                                      (
                                                      x
                                                      )
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                             
                                          
                                          
                                             ≤
                                          
                                          
                                             
                                                
                                                   dis
                                                
                                                
                                                   (
                                                   
                                                      φ
                                                      1
                                                   
                                                   )
                                                
                                                +
                                                
                                                   dis
                                                
                                                
                                                   (
                                                   
                                                      φ
                                                      2
                                                   
                                                   )
                                                
                                                ≤
                                                
                                                   ∈
                                                   1
                                                
                                                +
                                                
                                                   ∈
                                                   2
                                                
                                                ,
                                                ∀
                                                
                                                   
                                                      0.12
                                                      e
                                                      m
                                                   
                                                   
                                                      0
                                                      e
                                                      x
                                                   
                                                
                                                x
                                                ∈
                                                X
                                                ,
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      d
                                                      
                                                         X
                                                         ,
                                                         Z
                                                      
                                                   
                                                   
                                                      (
                                                      ψ
                                                      
                                                         (
                                                         z
                                                         )
                                                      
                                                      ,
                                                      z
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             ≤
                                          
                                          
                                             
                                                
                                                   d
                                                   
                                                      X
                                                      ,
                                                      Y
                                                   
                                                
                                                
                                                   (
                                                   ψ
                                                   
                                                      (
                                                      z
                                                      )
                                                   
                                                   ,
                                                   
                                                      ψ
                                                      1
                                                   
                                                   
                                                      (
                                                      z
                                                      )
                                                   
                                                   )
                                                
                                                +
                                                
                                                   d
                                                   
                                                      Y
                                                      ,
                                                      Z
                                                   
                                                
                                                
                                                   (
                                                   
                                                      ψ
                                                      2
                                                   
                                                   
                                                      (
                                                      z
                                                      )
                                                   
                                                   ,
                                                   z
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                             
                                          
                                          
                                             ≤
                                          
                                          
                                             
                                                
                                                   dis
                                                
                                                
                                                   (
                                                   
                                                      ψ
                                                      1
                                                   
                                                   )
                                                
                                                +
                                                
                                                   dis
                                                
                                                
                                                   (
                                                   
                                                      ψ
                                                      2
                                                   
                                                   )
                                                
                                                ≤
                                                
                                                   ∈
                                                   1
                                                
                                                +
                                                
                                                   ∈
                                                   2
                                                
                                                ,
                                                ∀
                                                
                                                   
                                                      0.12
                                                      e
                                                      m
                                                   
                                                   
                                                      0
                                                      e
                                                      x
                                                   
                                                
                                                z
                                                ∈
                                                Z
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

This means that for any ΦX
                           , we can find ΦZ
                           , φ, ψ, such that d
                           
                              X, Z
                           (x, φ(x)) and d
                           
                              X, Z
                           (ψ(z), z) are bounded by 
                              
                                 
                                    ∈
                                    1
                                 
                                 +
                                 
                                    ∈
                                    2
                                 
                              
                           . Consequently,
                              
                                 
                                    
                                       
                                          
                                             inf
                                          
                                          
                                             {
                                             
                                                
                                                   Φ
                                                
                                                Z
                                             
                                             }
                                          
                                       
                                       
                                          d
                                          H
                                       
                                       
                                          (
                                          
                                             J
                                             
                                                t
                                             
                                             
                                                
                                                   Φ
                                                
                                                X
                                             
                                          
                                          ,
                                          
                                             J
                                             
                                                t
                                             
                                             
                                                
                                                   Φ
                                                
                                                Z
                                             
                                          
                                          )
                                       
                                       ≤
                                       
                                          ∈
                                          1
                                       
                                       +
                                       
                                          ∈
                                          2
                                       
                                       ,
                                       ∀
                                       
                                          
                                             0.12
                                             e
                                             m
                                          
                                          
                                             0
                                             e
                                             x
                                          
                                       
                                       
                                          
                                             Φ
                                          
                                          X
                                       
                                       .
                                    
                                 
                              
                           
                        

Clearly,
                              
                                 
                                    
                                       
                                          d
                                          
                                             J
                                             t
                                          
                                       
                                       
                                          (
                                          X
                                          ,
                                          Z
                                          )
                                       
                                       =
                                       
                                          
                                             sup
                                          
                                          
                                             {
                                             
                                                
                                                   Φ
                                                
                                                X
                                             
                                             }
                                          
                                       
                                       
                                          
                                             inf
                                          
                                          
                                             {
                                             
                                                
                                                   Φ
                                                
                                                Z
                                             
                                             }
                                          
                                       
                                       
                                          d
                                          H
                                       
                                       
                                          (
                                          
                                             J
                                             
                                                t
                                             
                                             
                                                
                                                   Φ
                                                
                                                X
                                             
                                          
                                          ,
                                          
                                             J
                                             
                                                t
                                             
                                             
                                                
                                                   Φ
                                                
                                                Z
                                             
                                          
                                          )
                                       
                                       ≤
                                       
                                          ∈
                                          1
                                       
                                       +
                                       
                                          ∈
                                          2
                                       
                                       .
                                    
                                 
                              
                           In the same way 
                              
                                 
                                    d
                                    
                                       J
                                       t
                                    
                                 
                                 
                                    (
                                    Z
                                    ,
                                    X
                                    )
                                 
                                 ≤
                                 
                                    ∈
                                    1
                                 
                                 +
                                 
                                    ∈
                                    2
                                 
                              
                           , implying 
                              
                                 
                                    d
                                    
                                       t
                                    
                                    
                                       GF
                                    
                                 
                                 
                                    (
                                    X
                                    ,
                                    Z
                                    )
                                 
                                 ≤
                                 
                                    ∈
                                    1
                                 
                                 +
                                 
                                    ∈
                                    2
                                 
                              
                           .□

We conclude that the distance 
                        
                           
                              d
                              
                                 t
                              
                              
                                 GF
                              
                           
                           
                              (
                              X
                              ,
                              Y
                              )
                           
                           :
                           M
                           ×
                           
                           M
                           →
                           
                              R
                              
                                 ≥
                                 0
                              
                           
                        
                      satisfies the properties of Theorem 3.
                        
                           P1:
                           Symmetry – by definition, the function 
                                 
                                    
                                       d
                                       
                                          t
                                       
                                       
                                          GF
                                       
                                    
                                    
                                       (
                                       X
                                       ,
                                       Y
                                       )
                                    
                                 
                               is invariant to permutation of X and Y.

Triangle-inequality – by Proposition 2.

Identity – X, Y cannot be spectral GFs equivalent if 
                                 
                                    
                                       d
                                       
                                          t
                                       
                                       
                                          GF
                                       
                                    
                                    
                                       (
                                       X
                                       ,
                                       Y
                                       )
                                    
                                    
                                       
                                          0.25
                                          e
                                          m
                                       
                                       
                                          0
                                          e
                                          x
                                       
                                    
                                    ≠
                                    
                                       
                                          0.25
                                          e
                                          m
                                       
                                       
                                          0
                                          e
                                          x
                                       
                                    
                                    0
                                 
                              .


                     Conjecture 1 states that the spectral GFs distance 
                        
                           d
                           
                              t
                           
                           
                              GF
                           
                        
                      is a metric between spectral GFs equivalent classes of Riemannian manifolds. This conjecture can be proved by assuming that 
                        
                           
                              d
                              
                                 t
                              
                              GF
                           
                           
                              (
                              X
                              ,
                              Y
                              )
                           
                           =
                           0
                        
                      implies that there exist eigenbases ΦX, ΦY
                      and maps φ: X → Y, ψ: Y → X, such that 
                        
                           
                              J
                              
                                 t
                              
                              
                                 
                                    Φ
                                 
                                 X
                              
                           
                           
                              (
                              x
                              )
                           
                           =
                           
                              J
                              
                                 t
                              
                              
                                 
                                    Φ
                                 
                                 Y
                              
                           
                           
                              (
                              φ
                              
                                 (
                                 x
                                 )
                              
                              )
                           
                           ,
                           ∀
                           
                              
                                 0.12
                                 e
                                 m
                              
                              
                                 0
                                 e
                                 x
                              
                           
                           x
                           ∈
                           X
                        
                      and 
                        
                           
                              J
                              
                                 t
                              
                              
                                 
                                    Φ
                                 
                                 X
                              
                           
                           
                              (
                              ψ
                              
                                 (
                                 y
                                 )
                              
                              )
                           
                           =
                           
                              J
                              
                                 t
                              
                              
                                 
                                    Φ
                                 
                                 Y
                              
                           
                           
                              (
                              y
                              )
                           
                           ,
                           ∀
                           
                              
                                 0.12
                                 e
                                 m
                              
                              
                                 0
                                 e
                                 x
                              
                           
                           y
                           ∈
                           Y
                        
                     .
                        Remark
                        To prove this assumption we suggest to follow the footsteps of Bérard et al. [1], but a rigorous proof of this hypothesis is left for future work.

Now, because 
                        
                           
                              J
                              
                                 t
                              
                              
                                 
                                    Φ
                                 
                                 X
                              
                           
                           
                              (
                              x
                              )
                           
                           =
                           
                              J
                              
                                 t
                              
                              
                                 
                                    Φ
                                 
                                 Y
                              
                           
                           
                              (
                              φ
                              
                                 (
                                 x
                                 )
                              
                              )
                           
                           ,
                           ∀
                           
                              
                                 0.12
                                 e
                                 m
                              
                              
                                 0
                                 e
                                 x
                              
                           
                           x
                           ∈
                           X
                        
                     , then for all x
                     1, ∈X we have
                        
                           
                              
                                 
                                    ∥
                                 
                                 
                                    J
                                    
                                       t
                                    
                                    
                                       
                                          Φ
                                       
                                       X
                                    
                                 
                                 
                                    (
                                    
                                       x
                                       1
                                    
                                    )
                                 
                                 −
                                 
                                    J
                                    
                                       t
                                    
                                    
                                       
                                          Φ
                                       
                                       X
                                    
                                 
                                 
                                    (
                                    
                                       x
                                       2
                                    
                                    )
                                 
                                 
                                    ∥
                                    
                                       
                                          ℓ
                                       
                                       2
                                    
                                 
                                 
                                    =
                                    ∥
                                 
                                 
                                    J
                                    
                                       t
                                    
                                    
                                       
                                          Φ
                                       
                                       Y
                                    
                                 
                                 
                                    (
                                    φ
                                    
                                       (
                                       
                                          x
                                          1
                                       
                                       )
                                    
                                    )
                                 
                                 −
                                 
                                    J
                                    
                                       t
                                    
                                    
                                       
                                          Φ
                                       
                                       Y
                                    
                                 
                                 
                                    (
                                    φ
                                    
                                       (
                                       
                                          x
                                          2
                                       
                                       )
                                    
                                    )
                                 
                                 
                                    ∥
                                    
                                       
                                          ℓ
                                       
                                       2
                                    
                                 
                                 .
                              
                           
                        
                     
                  

We also know that X, Y are equipped with the metrics 
                        
                           
                              
                                 d
                                 ˜
                              
                              X
                           
                           ,
                           
                              
                                 d
                                 ˜
                              
                              Y
                           
                        
                      derived from the distances in the common space
                        
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   d
                                                   ˜
                                                
                                                X
                                             
                                             
                                                (
                                                
                                                   x
                                                   1
                                                
                                                ,
                                                
                                                   x
                                                   2
                                                
                                                )
                                             
                                             
                                                =
                                                ∥
                                             
                                             
                                                J
                                                
                                                   t
                                                
                                                
                                                   
                                                      Φ
                                                   
                                                   X
                                                
                                             
                                             
                                                (
                                                
                                                   x
                                                   1
                                                
                                                )
                                             
                                             −
                                             
                                                J
                                                
                                                   t
                                                
                                                
                                                   
                                                      Φ
                                                   
                                                   X
                                                
                                             
                                             
                                                (
                                                
                                                   x
                                                   2
                                                
                                                )
                                             
                                             
                                                ∥
                                                
                                                   
                                                      ℓ
                                                   
                                                   2
                                                
                                             
                                             ,
                                             
                                                
                                                   0.15
                                                   e
                                                   m
                                                
                                                
                                                   0
                                                   e
                                                   x
                                                
                                             
                                             ∀
                                             
                                                
                                                   0.12
                                                   e
                                                   m
                                                
                                                
                                                   0
                                                   e
                                                   x
                                                
                                             
                                             
                                                x
                                                1
                                             
                                             ,
                                             
                                                x
                                                2
                                             
                                             ∈
                                             X
                                             ,
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   d
                                                   ˜
                                                
                                                Y
                                             
                                             
                                                (
                                                
                                                   y
                                                   1
                                                
                                                ,
                                                
                                                   y
                                                   2
                                                
                                                )
                                             
                                             
                                                =
                                                ∥
                                             
                                             
                                                J
                                                
                                                   t
                                                
                                                
                                                   
                                                      Φ
                                                   
                                                   Y
                                                
                                             
                                             
                                                (
                                                
                                                   y
                                                   1
                                                
                                                )
                                             
                                             −
                                             
                                                J
                                                
                                                   t
                                                
                                                
                                                   
                                                      Φ
                                                   
                                                   Y
                                                
                                             
                                             
                                                (
                                                
                                                   y
                                                   2
                                                
                                                )
                                             
                                             
                                                ∥
                                                
                                                   
                                                      ℓ
                                                   
                                                   2
                                                
                                             
                                             ,
                                             
                                                
                                                   0.15
                                                   e
                                                   m
                                                
                                                
                                                   0
                                                   e
                                                   x
                                                
                                             
                                             ∀
                                             
                                                
                                                   0.12
                                                   e
                                                   m
                                                
                                                
                                                   0
                                                   e
                                                   x
                                                
                                             
                                             
                                                y
                                                1
                                             
                                             ,
                                             
                                                y
                                                2
                                             
                                             ∈
                                             Y
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

Hence, φ is a distance preserving map
                        
                           
                              
                                 
                                    
                                       d
                                       ˜
                                    
                                    X
                                 
                                 
                                    (
                                    
                                       x
                                       1
                                    
                                    ,
                                    
                                       x
                                       2
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       d
                                       ˜
                                    
                                    Y
                                 
                                 
                                    (
                                    φ
                                    
                                       (
                                       
                                          x
                                          1
                                       
                                       )
                                    
                                    ,
                                    φ
                                    
                                       (
                                       
                                          x
                                          2
                                       
                                       )
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     
                  

In the same way
                        
                           
                              
                                 
                                    
                                       d
                                       ˜
                                    
                                    X
                                 
                                 
                                    (
                                    ψ
                                    
                                       (
                                       
                                          y
                                          1
                                       
                                       )
                                    
                                    ,
                                    ψ
                                    
                                       (
                                       
                                          y
                                          2
                                       
                                       )
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       d
                                       ˜
                                    
                                    Y
                                 
                                 
                                    (
                                    
                                       y
                                       1
                                    
                                    ,
                                    
                                       y
                                       2
                                    
                                    )
                                 
                                 .
                              
                           
                        
                     Moreover, 
                        
                           x
                           =
                           ψ
                           (
                           φ
                           (
                           x
                           )
                           )
                        
                      for all x ∈ X and 
                        
                           y
                           =
                           φ
                           (
                           ψ
                           (
                           y
                           )
                           )
                        
                      for all y ∈ Y, or else w.l.g.o. there would be two distinct points x
                     1, ∈X such that 
                        
                           
                              x
                              2
                           
                           =
                           ψ
                           
                              (
                              φ
                              
                                 (
                                 
                                    x
                                    1
                                 
                                 )
                              
                              )
                           
                        
                     . In that case 
                        
                           
                              J
                              
                                 t
                              
                              
                                 
                                    Φ
                                 
                                 X
                              
                           
                           
                              (
                              
                                 x
                                 1
                              
                              )
                           
                        
                      and 
                        
                           
                              J
                              
                                 t
                              
                              
                                 
                                    Φ
                                 
                                 X
                              
                           
                           
                              (
                              
                                 x
                                 2
                              
                              )
                           
                        
                      would both be equal to 
                        
                           
                              J
                              
                                 t
                              
                              
                                 
                                    Φ
                                 
                                 Y
                              
                           
                           
                              (
                              φ
                              
                                 (
                                 
                                    x
                                    1
                                 
                                 )
                              
                              )
                           
                        
                     , which contradicts the fact that 
                        
                           J
                           
                              t
                           
                           
                              
                                 Φ
                              
                              X
                           
                        
                      is injective. Therefore, φ, ψ are bijections and distance preserving, hence (if our assumption is true), X, Y are spectral GFs equivalent.

@&#REFERENCES@&#

