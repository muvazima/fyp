@&#MAIN-TITLE@&#Tying mechanism for airlines’ air cargo capacity allocation

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We model the problem of tying allocation of air cargo capacity.


                        
                        
                           
                           We propose a tying mechanism of capacity allocation for airlines.


                        
                        
                           
                           We elicit cost structures of forwarders and derive closed-form optimal solution.


                        
                        
                           
                           We examine the proposed mechanism with a case study.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

OR in airlines

Air cargo

Capacity allocation

Tying mechanism

@&#ABSTRACT@&#


               

               
                  Airlines commonly experience the problem that the sum of freight forwarders’ orders exceeds the airline's fixed capacity for hot-selling routes, while the orders are usually <50 percent for underutilized routes. Airlines cannot dynamically change flights to address the imbalance, since they have to serve passenger traffic when carrying cargo in the belly space of passenger flights. The imbalance problem is likely to become even more severe when the number of wide-body passenger aircraft increases in the near future, as expected by the International Air Transport Association (IATA). Motivated by a joint project with a large airline, we propose a tying mechanism for capacity allocation by integrating hot-selling routes and underutilized routes. The strategic foreclosure theory is adopted in the proposed mechanism. Some forwarders are selected as the partners to whom more capacity of hot-selling routes are allocated with the condition that they will order more underutilized routes. Other “excluded” forwarders temporarily operate underutilized routes. By observing the cost structure information of forwarders, we design the tying mechanism for air cargo capacity allocation and derive the closed-form optimal solution. Using data from the airline, we demonstrate that the proposed tying capacity allocation mechanism is very effective.
               
            

@&#INTRODUCTION@&#

Air cargo is an increasingly significant source of revenue for airlines. Worldwide, the air cargo transportation grew 50 percent faster than the passenger traffic (Wong, Zhang, Hui, & Leung, 2009). Boeing (2007) forecasts that the air cargo market will grow at 6.1 percent per year and triple by 2025. In particular, some markets are expected to grow even faster, for example, intra-Asian freight will grow at 8.6 percent per year and China is estimated to grow at over 15 percent. The dramatic growth in air cargo is attributable to many drivers, including increased global trade, greater demand for faster and timelier delivery, and firms’ efforts to keep inventory low through frequent replenishments (Li, Tao, & Wang, 2009; Ou, Hsu, & Li, 2010).

An air cargo service supply chain mainly consists of airlines, freight forwarders, and shippers. The shippers, who may be individual customers or companies (e.g., Toyota and Nokia), send their shipments to freight forwarders. The freight forwarders (e.g., UPS in the USA and Deppon in China) book cargo capacity from airlines and integrate and consolidate cargo to be shipped according to shippers’ requirements. Airlines operate dedicated freighters and passenger and cargo combination aircraft (or passenger flights) to provide cargo capacity to forwarders and shippers. In such a service supply chain, freight forwarders are often quite fragmented, and airlines often possess dominating power over forwarders, especially in the hub region within a hub-spoke network.

The airline sells cargo capacity
                        1
                     
                     
                        1
                        Air cargo capacity means the cargo space in units of tons, comprising the space in the belly of passenger flights and dedicated freighters. The cargo capacity on one route, in this paper, means the cargo space of a scheduled flight on a one-way origin and destination pair (OD pair).
                      to forwarders through pre-allocation, contract and spot market sales (see Gupta, 2008 for details). Although airlines may sell directly to shippers occasionally, more than 60 percent of domestic and 90 percent of international air cargo capacity is sold to forwarders (Amaruchkul, Cooper, & Gupta, 2011). The airline pre-allocates the planned capacity on each route to forwarders based on their performances in the preceding year. Forwarders need the allocation information to expand their warehouse and determine the fleet size of road feeder service for the next planning period. Forwarders usually enter into contracts with airlines for purchasing dedicated freighter capacity one season or half year ahead when they have stable cargo sources. In the spot market, forwarders book cargo capacity from airlines 5 hours to 1 week ahead. Considering the possible cancellation and variable tenders from forwarders, airlines overbook cargo capacity and adopt accept-or-reject policies to maximize the expected revenue after demand is forecasted (Amaruchkul, Cooper, & Gupta, 2007). Airlines manage network capacity via several branches, each of which operates its own regional business. For each branch, there are many representatives responsible for allocating and selling the capacities of 6–15 routes to forwarders. For each route, the airline usually collaborates with several forwarders to sell capacities. At the beginning of a planning period, the Department of Cargo Capacity Planning assigns network capacity to each branch. After that, each representative allocates the capacity on the managed routes to forwarders according to their performances in the preceding year. Once the forwarders accept capacity quotas, they have to commit to the allotments 12 months ahead (Amaruchkul et al., 2011).

Airlines often face the challenging problem that the capacity on some routes is insufficient to meet forwarders’ orders, while other routes have idle capacity. According to the Civil Aviation Administration of China, the capacity booking rate for hot-selling routes, which count for 24.5 percent of all routes, is over 100 percent, but the utilization rate for underutilized routes, which count for 33.6 percent of all routes, is <50 percent. For example, the cargo capacity of the early morning passenger flight from Guangzhou to Changsha is tight, while the cargo capacity of all passenger flights from Guangzhou to Sanya is idle. Multiple reasons contribute to this imbalance. The first is imbalanced interregional and international trade. Such an imbalance is apparent in cargo flows between Asia and North America. The second is that air cargo flows, unlike passenger flows, are unidirectional, which aggravates the effect due to the first reason. Another reason is the unmatched demands for passengers and cargos when carrying cargo in the belly space of passenger flights. Frequent flights established to serve strong passenger demand may cause a large amount of idle cargo capacity in the belly space. This problem is expected to worsen in the near future when the number of wide-body passenger aircraft will sharply increase (source: International Air Transport Association-IATA). The imbalanced cargo capacity utilization for different routes is a common challenge for airlines. To deal with the inevitable and intractable problem of imbalanced capacity utilization faced by many airlines, a joint research project was conducted with a large airline. We observed that, in reality, forwarders are thirsty for the capacity on hot-selling routes for their high margin. Forwarders would not accept any more capacity on underutilized routes when their marginal profit is equal to marginal cost in the pre-allocation stage. In such a situation, airlines can use tying mechanisms to make the allotment of tight capacity conditional upon ordering extra idle capacity. With a tying mechanism, a firm with a monopoly on one resource can use the leverage provided by this power to improve the sales of the second resource (Whinston, 1990). Doling out capacity through a tying mechanism has occurred in industries ranging from personal computer to digital video. For instance, Sony has tied one kind of unpopular digital camera with a very popular video camera when selling to its wholesalers (Sony, 2003).

Other possible strategies may be suggested to airlines to deal with such problems of imbalanced demand. The first possible solution is the pricing mechanism, which is necessary and effective, but has its own limitation. Ultimately, its effect depends on the price elasticity of demand. Furthermore, a deep cut in prices regarding the capacity on underutilized routes may result in very low, even unworthy, profit margins. The second possible approach is for airlines to conduct a combinatorial auction, requesting forwarders to submit bids for the combinations of different routes’ capacity. Although this may sound appealing, users encounter a number of difficulties (Pekec & Rothkopf, 2003). (1) The IT infrastructure and the implementation of a combinatorial auction will incur a significant cost. (2) The resulting revenue, though expected to be higher, is uncontrollable, which is typical of sophisticated game activities. (3) It is difficult for an airline to conduct such an auction. Forwarders dislike the complicated gaming activities.

Therefore, the suggested tying capacity allocation mechanism is effective and practical for airlines. The basic process of the tying capacity allocation works as follows. (1) Routes partition. Network-wide routes are partitioned into many blocks of routes. Each representative manages one block (i.e., 6–15 routes). (2) Routes tying. It is pragmatic to tie one hot-selling route (Route A) with one underutilized route (Route B). An effective rule is to tie the most hot-selling route with the most underutilized route, and then tie the second hot-selling one with the second underutilized one, and so on. (3) Allotment design. Representatives use the forwarder's performance in the preceding year to work out tied allotments for that year. Some promising forwarders are selected as partners, while others are temporarily “excluded” from Route A and only operate Route B. The partners are allocated more capacity for Route A (the share from the “excluded” forwarders) and allocated extra capacities for Route B without any loss of profit. By using the tying capacity allocation mechanism, airlines can increase their profit because Route B capacity is better utilized. The airline has dominating power to implement the tying capacity allocation because it is monopolistic within the hub region in a hub-and-spoke network. The “excluded” forwarders especially do not lose all the hot-selling routes due to their different strengths in different blocks of routes.

As far as we are aware, this is the first paper to model the problem of tying capacity allocation. Our model captures a primary issue—how to tie two types of capacities for allocation. A tying mechanism for air cargo capacity allocation is designed, and a closed-form optimal policy can be derived by our model. In addition, some important observations are reaped from the air cargo industry. We find different cost structures that the forwarders operate hot-selling and underutilized routes through an airline's dual-channel system of air cargo sales. In addition, we derive the cost parameters of forwarders from their purchasing records. Such information can then enable airlines to select partnering forwarders and tailor offers to forwarders.

The rest of the paper is organized as follows. In Section 2, we review the related literature. In Section 3, we define the problem and formulate it into a nonlinear programming model. In particular, we present the important observations that enable the estimation of the forwarder's cost structures and related parameters. In Section 4, we develop a solution procedure and derive the closed-form optimal solution. In Section 5, we discuss a few possible extensions of the basic model. A case is reported in Section 6. We then summarize the paper in Section 7.

@&#LITERATURE REVIEW@&#

Although there is considerable interest in tying capacity allocation mechanisms among practitioners, there is essentially no academic research that relates directly to this topic. The related literature is studies regarding air cargo capacity management, capacity allocation, and tying (or bundling) sales.

The existing air cargo capacity management literature contains studies on overbooking, accept-or-reject policies, and contracting, whereas research on air cargo capacity pre-allocation is extremely limited. A leading research stream is overbooking, in which the airline determines overbooking levels based on calculations of no-shows, cancellations, and variable tenders. For instance, Kasilingam (1997) proposed a model for optimal overbooking levels of air cargo with consideration of discrete and continuous probability distributions of capacity. Popescu, Keskinocak, Johnson, LaDue, and Kasilingam (2006) presented a nonparametric distribution estimation and forecasting method for calculating the show-up rate for cargo booking and compared the proposed discrete distribution with the normal distribution. Wang and Kao (2008) developed a fuzzy knowledge system to determine overbooking levels based on fuzzy reasoning. Another research stream investigated accept-or-reject policies, in which airlines accept or reject a booking request to optimize the expected revenue. Herein, Amaruchkul et al. (2007) proposed a single-leg Markov model to decide whether to accept or reject a request from a forwarder. As an improvement to Amaruchkul et al. (2007), Han, Tang, and Huang (2010) addressed the capacity allocation problem in single-leg air cargo revenue management by considering the profit rate of each type of cargo. Huang and Chang (2010) modeled the same decision problem and proposed a joint approximate algorithm to improve a de-coupling heuristic presented in Amaruchkul et al. (2007). The above overbooking and accept-or-reject policies are used for capacity management in the spot market, which is more in parallel with research on passenger revenue management. There are also a few studies on contracting in the medium-term market. For example, Hellermann (2006) and Gupta (2008) investigated capacity contracts between an airline and a forwarder under the symmetric information. Amaruchkul et al. (2011) improved capacity contracts to allow information asymmetry between an airline and a forwarder.

Our research focuses on the pre-allocation of capacity between one airline and multiple forwarders in the long-term market. This happens before the contract design between airlines and forwarders, which specifies payment and penalty terms.

Capacity allocation becomes an issue when one supplier sells capacity to multiple buyers and the sum of buyers’ orders exceeds the supplier's fixed capacity. Allocation mechanisms have been used for many products, such as personal computers, pharmaceuticals, digital video cameras, automobiles, semiconductors, and TV spectrum. Hwang and Valeriano (1992) first advocated capacity allocation mechanisms in practice so makers of nicotine patches based their allocations on sale histories and locations. Cachon and Lariviere (1999a) proposed the capacity allocation problem in a supply chain and examined how the choice of mechanisms impacts retailer actions and supply chain performances. Cachon and Lariviere (1999b) compared allocation mechanisms between turn-and-order and turn-and-earn. Their results show that turn-and-order makes retailers order more than they need to gain a more favorable allocation, whereas turn-and-earn helps in truth telling. Cachon and Lariviere (1999c) further conducted an equilibrium analysis of the linear, proportional, and uniform allocation of scarce capacity. They found that a unique Nash equilibrium exists for uniform allocation, whereas behaviors in either the proportional or linear allocation game are quite unpredictable. There are also some studies on capacity allocation for specific problems. For example, de Kok (2000) discussed the capacity allocation between postponement production and outsourcing in the packaging industry. Mallik and Harker (2004) designed a bonus scheme and a rule to allocate capacity to production managers in the semiconductor manufacturing industry. Karabuk and Wu (2005) investigated the same problem and proposed an incentive scheme to elicit private information from production managers. Feng and Xiao (2006) proposed a comprehensive model by integrating the price and capacity allocation to decide which micro-markets or customer classes should be served at what prices. Xu, Lui, and Chiu (2010) presented the problem of oligopoly spectrum allocation, in which primary users sell excess spectrum to secondary users.

The major difference from the literature is that only one type of capacity is studied in the existing capacity allocation literature, whereas two types of capacities are considered in our tying capacity allocation.

Tying means a firm makes the sale (or price) of one of its products conditional upon the purchaser also buying some other products (Nalebuff, 2004; Whinston, 1990). The pros and cons of tying sales have been debated in economics for decades; see Director and Levi (1956), Bowman (1957), and Posner (1976) for examples of the earliest studies. The economic studies reveal that tying sales offer a number of advantages to firms, such as the power of price discrimination (McAfee, McMillan, & Whinston, 1989), leveraging the market power of one product on another (Whinston, 1990), and deterring the entry of new competitors (Nalebuff, 2004).

Bundling is a more specific kind of tying. Bundling means suppliers select m from n goods to form a bundle to satisfy the customer's demands and to increase the supplier's profits. A number of studies have discussed the bundling problem, especially for information goods. For example, Hanson and Martin (1990) used mixed integer programming to determine the optimal prices and composition of product bundles for different market segments. Bakos and Brynijolfsson (1999) studied the strategies of bundling a large number of information goods. Hitt and Chen (2005) evaluated customized bundling, in which consumers can choose up to m goods from n different goods at a fixed price (m ≤ n). Ferrer, Mora, and Olivares (2010) investigated pricing decisions for bundles composed of a service and an associated product on a subscription basis, using a two-part tariff scheme.

The existing literature on tying sales explains the tying mechanism through which leverage occurs and a firm's welfare changes. However, bundling studies focus on which subset of goods should be bundled. However, the focus of our study is on the quantities of capacities (or goods) to be bundled to form different offers for different forwarders (or buyers).

Consider an air cargo supply chain in which one airline sells its air cargo capacity to multiple forwarders by the way of pre-allocation at the beginning of a planning period. Suppose the sum of forwarders’ orders exceeds the airline's fixed Route A capacity, whereas the orders are less than the fixed Route B capacity. For Route A, forwarders are thirsty for the capacity due to the high margin and because any amount of extra capacity means more profit. The airline cannot fully entertain the forwarder's orders for Route A because of the fixed capacity. For Route B, each forwarder places an order to maximize profit according to the rule that the marginal profit is equal to the marginal cost.

The airline uses the tying allocation mechanism for converting an infeasible set of orders for the capacities of the two routes into a feasible set of tied capacity allotments. The airline tailors offers for the tied capacities of routes A and B for forwarders using their performances of routes A and B in the preceding year. In the allotments, some partnering forwarders are allocated more Route A capacity and additional tie-in Route B capacity on the premise of no profit loss. The “excluded” forwarders forfeit their capacity shares on Route A and only keep their shares on Route B.

Assume there are M forwarders, varying in sizes and cost efficiencies. Denote the fixed capacities of routes A and B as ω
                     1 and ω
                     2, respectively. In the preceding period, the capacities of routes A and B received by forwarder i are denoted as αi
                      and βi
                     , respectively; naturally, 
                        
                           
                              ∑
                              
                                 i
                                 =
                                 1
                              
                              M
                           
                           
                              α
                              i
                           
                           =
                           
                              ω
                              1
                           
                           ,
                           
                           
                           
                           
                              ∑
                              
                                 i
                                 =
                                 1
                              
                              M
                           
                           
                              β
                              i
                           
                           <
                           
                              ω
                              2
                           
                        
                     . The airline sells Route A capacity to forwarders at price p
                     1, and Route B capacity at p
                     2.
                        2
                     
                     
                        2
                        Here we assume uniform prices for all forwarders. In practice, prices may vary slightly with forwarders, due to their different bargaining power, assuming uniform prices serve as a good approximation and simplify the analysis greatly. However, forwarder-dependent prices can also be handled, though with complicated notations.
                      Following the tying allocation mechanism, the airline allocates capacities xi
                      and yi
                      of routes A and B, respectively, to forwarder i in the current period. We also have 
                        
                           
                              ∑
                              
                                 i
                                 =
                                 1
                              
                              M
                           
                           
                              x
                              i
                           
                           ≤
                           
                              ω
                              1
                           
                        
                     , 
                        
                           
                              ∑
                              
                                 i
                                 =
                                 1
                              
                              M
                           
                           
                              y
                              i
                           
                           ≤
                           
                              ω
                              2
                           
                        
                     . The objective of the airline is to maximize 
                        
                           
                              ∑
                              
                                 i
                                 =
                                 1
                              
                              M
                           
                           
                              
                                 p
                                 1
                              
                              
                                 x
                                 i
                              
                           
                           +
                           
                              ∑
                              
                                 i
                                 =
                                 1
                              
                              M
                           
                           
                              
                                 p
                                 2
                              
                              
                                 y
                                 i
                              
                           
                        
                     , that is, the total revenue from selling the capacity on the two routes. The forwarder sells the capacities of routes A and B to shippers at price r
                     1 and r
                     2.

To have the forwarders accept the new allocation, the airline has to make sure the profit of partnering forwarders who order extra Route B capacity is not less than in the preceding period. Meanwhile, for the “excluded” forwarders, the airline has no need to guarantee anything since such forwarders will, according to their own interests, order the normal amount of Route B capacity anyway. In order to design offers that the forwarders are willing to take, the airline has to know the cost structures of the forwarders. Such information, though private to each forwarder, turns out to be estimable, as explained below.

The airline normally operates a dual-channel system of cargo capacity sales (indirect and direct)—mostly indirectly through forwarders to shippers—but also through a subsidiary to serve shippers directly. Airlines operate direct channels mainly not for profit but as a way to understand the forwarder market and observe and analyze forwarders’ cost structures. Approximately, the cost of forwarder i of Route A can be represented by the linear functionC
                     1(xi
                     ) = p
                     1
                     xi
                     . That is, the cost of Route A is mostly determined by the cost paid to the airline. Note here that we are only concerned with the cost incurred due to operating xi
                      amount of capacity; there might be, of course, other fixed administrative costs, which are irrelevant to our concerns. The cost of Route B of forwarder i can be represented by 
                        
                           
                              C
                              2
                           
                           
                              (
                              
                                 y
                                 i
                              
                              )
                           
                           =
                           
                              p
                              2
                           
                           
                              y
                              i
                           
                           +
                           
                              a
                              i
                           
                           
                              y
                              i
                              2
                           
                        
                     , ai
                      > 0, where the second term reflects some additional cost in running the business of Route B over Route A. Air cargo managers call this additional cost “piling cost”,
                        3
                     
                     
                        3
                        Piling cost is borrowed from the bridge construction industry. Bridge workers must first pile posts before they can pave a bridge. Simply put, Route B is a developing route, while Route A is a developed route. To operate Route B, the freight forwarders must spend extra money, relative to Route A, to develop this route.
                      which include extra expenses for advertising, sales promotion, public relations, etc. Usually, smaller and weaker forwarders bear higher piling cost than larger and stronger forwarders. Thus, ai
                      > 0 is a parameter reflecting the strength of forwarder i. With the following assumptions, we can then estimate ai
                      for each forwarder.

                        Assumption 1
                        
                           Each forwarder is profit-maximizing when ordering Route B capacity.


                           A forwarder’s orders of routes A and B capacities are independent.


                     Assumption 1 is intuitive. Assumption 2 is also easy to understand. If the orders of routes A and B are dependent, the imbalanced utilization problem for routes A and B will not occur.

                        Lemma 1
                        
                           ai can be estimated through observing βi, i.e.,
                           
                              
                                 
                                    a
                                    i
                                 
                                 =
                                 
                                    
                                       
                                          (
                                          
                                             r
                                             2
                                          
                                          −
                                          
                                             p
                                             2
                                          
                                          )
                                       
                                       
                                          2
                                          
                                             β
                                             i
                                          
                                       
                                    
                                 
                              
                           
                           .
                        

Since forwarder i is a profit maximizer, it solves the following maximization problem to determine the order quantity for the low-demand capacity: 
                              
                                 
                                    β
                                    i
                                 
                                 =
                                 arg
                                 
                                    max
                                    y
                                 
                                 
                                    r
                                    2
                                 
                                 y
                                 −
                                 
                                    (
                                    
                                       p
                                       2
                                    
                                    y
                                    +
                                    
                                       a
                                       i
                                    
                                    
                                       y
                                       2
                                    
                                    )
                                 
                              
                           . It is then easy to derive that 
                              
                                 
                                    a
                                    i
                                 
                                 =
                                 
                                    
                                       
                                          (
                                          
                                             r
                                             2
                                          
                                          −
                                          
                                             p
                                             2
                                          
                                          )
                                       
                                       
                                          2
                                          
                                             β
                                             i
                                          
                                       
                                    
                                 
                              
                           . □

To verify our assumptions on forwarders’ cost structures, we have obtained a data set regarding about 13 forwarders from the partnering airline. The airline operates a dual-channel sales system and thus has insights into the forwarders’ cost structures. According to our assumptions on the cost structures of forwarders, we can compute the “estimated” cost of forwarders. In addition, using the real data from the airline, we can derive the values of the “real” cost of forwarders. Table 1
                      and Fig. 1
                      present a comparison of the real and estimated costs of routes A and B for the 13 forwarders. It demonstrates that our assumptions are quite reliable. The percentage deviation of the estimated cost from the real cost is very small, mostly within 10 percent.

With our assumptions confirmed, we are now ready to present a nonlinear programming model for the tying capacity allocation problem. Define x = (x
                     1, …, xM
                     ) and y = (y
                     1, …, yM
                     ). The tying capacity allocation problem is to determine the optimal Route A capacity allocation vector 
                        
                           
                              
                                 x
                              
                              
                                 APTARABOLD
                                 *
                              
                           
                           =
                           
                              (
                              
                                 x
                                 1
                                 *
                              
                              ,
                              …
                              ,
                              
                                 x
                                 
                                    M
                                 
                                 *
                              
                              )
                           
                        
                      and Route B capacity allocation vector 
                        
                           
                              
                                 y
                              
                              
                                 APTARABOLD
                                 *
                              
                           
                           =
                           
                              (
                              
                                 y
                                 
                                    1
                                 
                                 *
                              
                              ,
                              …
                              ,
                              
                                 y
                                 
                                    M
                                 
                                 *
                              
                              )
                           
                        
                      to achieve the objective of maximizing the airline's revenue. We call this decision problem TCAP (the tying capacity allocation problem) and formulate it as follows.

TCAP-1:༚

                        
                           (1)
                           
                              
                                 max
                                 
                                 z
                                 
                                    (
                                    
                                       x
                                       ,
                                       y
                                    
                                    )
                                 
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    M
                                 
                                 
                                    
                                       p
                                       1
                                    
                                    
                                       x
                                       i
                                    
                                 
                                 +
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    M
                                 
                                 
                                    
                                       p
                                       2
                                    
                                    
                                       y
                                       i
                                    
                                 
                                 ,
                              
                           
                        
                     
                  


                     s.t.
                     
                        
                           (2)
                           
                              
                                 
                                    τ
                                    i
                                 
                                 =
                                 
                                    ⌈
                                    
                                       
                                          x
                                          i
                                       
                                       
                                          ω
                                          1
                                       
                                    
                                    ⌉
                                 
                                 ,
                                 
                                 
                                 
                                 
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 M
                                 ,
                              
                           
                        
                     
                     
                        
                           (3)
                           
                              
                                 
                                    
                                       
                                          
                                             (
                                             
                                                r
                                                1
                                             
                                             −
                                             
                                                p
                                                1
                                             
                                             )
                                          
                                          
                                             x
                                             i
                                          
                                       
                                    
                                    
                                       +
                                    
                                    
                                       
                                          
                                             (
                                             
                                                r
                                                2
                                             
                                             −
                                             
                                                p
                                                2
                                             
                                             )
                                          
                                          
                                             y
                                             i
                                          
                                          −
                                          
                                             a
                                             i
                                          
                                          
                                             y
                                             i
                                             2
                                          
                                          ≥
                                          
                                             τ
                                             i
                                          
                                          
                                             (
                                             
                                                r
                                                1
                                             
                                             −
                                             
                                                p
                                                1
                                             
                                             )
                                          
                                          
                                             α
                                             i
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       +
                                    
                                    
                                       
                                          
                                             (
                                             
                                                r
                                                2
                                             
                                             −
                                             
                                                p
                                                2
                                             
                                             )
                                          
                                          
                                             β
                                             i
                                          
                                          −
                                          
                                             a
                                             i
                                          
                                          
                                             β
                                             i
                                             2
                                          
                                          ,
                                          
                                          
                                          
                                          i
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          M
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (4)
                           
                              
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    M
                                 
                                 
                                    x
                                    i
                                 
                                 ≤
                                 
                                    ω
                                    1
                                 
                                 ,
                              
                           
                        
                     
                     
                        
                           (5)
                           
                              
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    M
                                 
                                 
                                    y
                                    i
                                 
                                 ≤
                                 
                                    ω
                                    2
                                 
                                 ,
                              
                           
                        
                     
                     
                        
                           (6)
                           
                              
                                 
                                    x
                                    i
                                 
                                 ,
                                 
                                    y
                                    i
                                 
                                 ≥
                                 0
                                 ,
                                 
                                 
                                 
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 M
                                 .
                              
                           
                        
                     Remember that, in the above, 
                        
                           
                              ∑
                              
                                 i
                                 =
                                 1
                              
                              M
                           
                           
                              α
                              i
                           
                           =
                           
                              ω
                              1
                           
                           ,
                           
                           
                           
                           
                              ∑
                              
                                 i
                                 =
                                 1
                              
                              M
                           
                           
                              β
                              i
                           
                           <
                           
                              ω
                              2
                           
                        
                     . In model TCAP-1, the objective function (1) is to maximize the total revenue derived from selling the capacities of routes A and B. Constraint (2) defines a binary variable, τi
                     , such that, if forwarder i is allocated some Route A capacities, that is, xi, τi
                      = 1; otherwise, τi
                      = 0. In other words, τi
                      is an indicator of whether forwarder i is selected as a partner by the airline. Constraint (3) ensures that, if forwarder i is selected as a partner, its profit will be at least the same as in the preceding period; otherwise, the profit of “excluded” forwarders i is no less than the profit derived from Route B in the preceding period. Constraints (4) and (5) ensure that the total fixed capacities of routes A and B are tied, although constraint (5), in many situations, is likely redundant since the Route B capacity may not be fully sold out even with the leveraging of Route A capacity.

TCAP-1 is a nonlinear integer programming model. In this section, we first derive some structural properties of the optimal solution and then propose a dynamic programming algorithm to solve the problem. We start with the following properties.

                        Lemma 2
                        
                           For any optimal solution to TCAP-1, there is always
                           
                              
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    M
                                 
                                 
                                    x
                                    i
                                    *
                                 
                                 =
                                 
                                    ω
                                    1
                                 
                              
                           
                           .
                        


                     Lemma 2 says all Route A capacities are allocated. With it, the objective function of the TCAP-1 model can be simplified to max 
                        
                           
                              ∑
                              
                                 i
                                 =
                                 1
                              
                              M
                           
                           
                              y
                              i
                           
                        
                     . Denote the model resulting from the removal of constraint (5) from TCAP-1 as the TCAP-2 model.

                        Lemma 3
                        
                           From any optimal solution to TCAP-2, we can construct an optimal solution to TCAP-1.
                        

Denote an optimal solution to TCAP-2 as (x
                           
                              *
                           ′, y
                           
                              *
                           ′) if 
                              
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    M
                                 
                                 
                                    y
                                    i
                                    
                                       *
                                       ′
                                    
                                 
                                 ≤
                                 
                                    ω
                                    2
                                 
                              
                           , (x
                           
                              *
                           ′, y
                           
                              *
                           ′) is naturally optimal for TCAP-1. Otherwise, we can reallocatey
                           
                              *
                           ′to create an optimal solution (x
                           
                              *
                           , y
                           
                              *
                           ) for TCAP-1. First, let x
                           
                              *
                           
                           =x
                           
                              *
                           ′. Second, for the forwarders with 
                              
                                 
                                    x
                                    i
                                    
                                       *
                                       ′
                                    
                                 
                                 =
                                 0
                              
                           , let 
                              
                                 
                                    y
                                    i
                                    *
                                 
                                 =
                                 
                                    β
                                    i
                                 
                              
                           . Finally, for the forwarders with 
                              
                                 
                                    x
                                    i
                                    
                                       *
                                       ′
                                    
                                 
                                 >
                                 0
                              
                           ,τi
                           =1, first let 
                              
                                 
                                    y
                                    i
                                    *
                                 
                                 =
                                 
                                    y
                                    i
                                    
                                       *
                                       ′
                                    
                                 
                              
                           , and then gradually reduce these 
                              
                                 y
                                 i
                                 *
                              
                            at the same time and at the same speed until 
                              
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    M
                                 
                                 
                                    y
                                    i
                                    *
                                 
                                 =
                                 
                                    ω
                                    2
                                 
                              
                           . Note that all the above steps will not affect the feasibility and optimality of the solution. The resulting solution must be an optimal solution. □

With the above two lemmas, solving TCAP-1 can be transformed into solving the following model.

TCAP-3:

                        
                           
                              
                                 max
                                 
                                 z
                                 
                                    (
                                    
                                       x
                                       ,
                                       y
                                    
                                    )
                                 
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    M
                                 
                                 
                                    y
                                    i
                                 
                              
                           
                        
                     
                  

subject to (2), (3), (4) and (6)

From now on, we will focus on solving TCAP-3.

                        Lemma 4
                        
                           There exists an optimal solution (
                           x
                           
                              *
                           , y
                           
                              *
                           
                           ) to TCAP-3 such that, if
                           
                              
                                 x
                                 i
                                 *
                              
                           
                           > 0, then
                           
                              
                                 
                                    x
                                    i
                                    *
                                 
                                 ≥
                                 
                                    α
                                    i
                                 
                              
                           
                           ,
                           
                              
                                 
                                    y
                                    i
                                    *
                                 
                                 ≥
                                 
                                    β
                                    i
                                 
                              
                           
                           ; if
                           
                              
                                 
                                    x
                                    i
                                    *
                                 
                                 =
                                 0
                              
                           
                           ,
                           
                              
                                 
                                    y
                                    i
                                    *
                                 
                                 =
                                 
                                    β
                                    i
                                 
                              
                           
                           .
                        

If 
                              
                                 
                                    x
                                    i
                                    *
                                 
                                 >
                                 0
                              
                           , τi
                            = 1. Constraint (3) changes to 
                              
                                 
                                    (
                                    
                                       r
                                       1
                                    
                                    −
                                    
                                       p
                                       1
                                    
                                    )
                                 
                                 
                                    x
                                    i
                                    *
                                 
                                 +
                                 
                                    (
                                    
                                       r
                                       2
                                    
                                    −
                                    
                                       p
                                       2
                                    
                                    )
                                 
                                 
                                    y
                                    i
                                    *
                                 
                                 −
                                 
                                    a
                                    i
                                 
                                 
                                    
                                       (
                                       
                                          y
                                          i
                                          *
                                       
                                       )
                                    
                                    2
                                 
                              
                            ≥

                              
                                 
                                    (
                                    
                                       r
                                       1
                                    
                                    −
                                    
                                       p
                                       1
                                    
                                    )
                                 
                                 
                                    α
                                    i
                                 
                                 +
                                 
                                    (
                                    
                                       r
                                       2
                                    
                                    −
                                    
                                       p
                                       2
                                    
                                    )
                                 
                                 
                                    β
                                    i
                                 
                                 −
                                 
                                    a
                                    i
                                 
                                 
                                    β
                                    i
                                    2
                                 
                              
                           . To ensure the inequality, since βi
                            maximizes forwarder i ’s profit on Route B, there must be 
                              
                                 
                                    x
                                    i
                                    *
                                 
                                 ≥
                                 
                                    α
                                    i
                                 
                              
                           ,
                              
                                 
                                    y
                                    i
                                    *
                                 
                                 ≥
                                 
                                    β
                                    i
                                 
                              
                           .

If 
                              
                                 
                                    x
                                    i
                                    *
                                 
                                 =
                                 0
                              
                           , constraint (3) reduces to 
                              
                                 
                                    (
                                    
                                       r
                                       2
                                    
                                    −
                                    
                                       p
                                       2
                                    
                                    )
                                 
                                 
                                    y
                                    i
                                    *
                                 
                                 −
                                 
                                    a
                                    i
                                 
                                 
                                    
                                       (
                                       
                                          y
                                          i
                                          *
                                       
                                       )
                                    
                                    2
                                 
                                 ≥
                              
                           
                           
                              
                                 
                                    (
                                    
                                       r
                                       2
                                    
                                    −
                                    
                                       p
                                       2
                                    
                                    )
                                 
                                 
                                    β
                                    i
                                 
                                 −
                                 
                                    a
                                    i
                                 
                                 
                                    β
                                    i
                                    2
                                 
                              
                           , and according to Assumption 1, βi
                            maximizes forwarder i’s profit on Route B, so there must be 
                              
                                 
                                    y
                                    i
                                    *
                                 
                                 =
                                 
                                    β
                                    i
                                 
                              
                           . □

Define 
                        
                           
                              
                                 x
                                 ^
                              
                              i
                           
                           =
                           
                              x
                              i
                           
                           −
                           
                              α
                              i
                           
                        
                     , 
                        
                           
                              
                                 y
                                 ^
                              
                              i
                           
                           =
                           
                              y
                              i
                           
                           −
                           
                              β
                              i
                           
                        
                     , 
                        
                           
                           i
                           =
                           1
                           ,
                           …
                           ,
                           M
                        
                     . If forwarder i is selected as a partner, constraint (3) changes to 
                        
                           
                              (
                              
                                 r
                                 1
                              
                              −
                              
                                 p
                                 1
                              
                              )
                           
                           
                              x
                              i
                           
                           +
                           
                              (
                              
                                 r
                                 2
                              
                              −
                              
                                 p
                                 2
                              
                              )
                           
                           
                              y
                              i
                           
                           −
                           
                              a
                              i
                           
                           
                              y
                              i
                              2
                           
                           ≥
                        
                     
                     
                        
                           
                              (
                              
                                 r
                                 1
                              
                              −
                              
                                 p
                                 1
                              
                              )
                           
                           
                              α
                              i
                           
                           +
                           
                              (
                              
                                 r
                                 2
                              
                              −
                              
                                 p
                                 2
                              
                              )
                           
                           
                              β
                              i
                           
                           −
                           
                              a
                              i
                           
                           
                              β
                              i
                              2
                           
                        
                     . With the new variables, it can be written as 
                        
                           
                              (
                              
                                 r
                                 1
                              
                              −
                              
                                 p
                                 1
                              
                              )
                           
                           
                              
                                 x
                                 ^
                              
                              i
                           
                           ≥
                        
                     
                     
                        
                           
                              a
                              i
                           
                           
                              
                                 y
                                 ^
                              
                              i
                              2
                           
                           +
                           
                              (
                              2
                              
                                 a
                                 i
                              
                              
                                 β
                                 i
                              
                              −
                              
                                 r
                                 2
                              
                              +
                              
                                 p
                                 2
                              
                              )
                           
                           
                              
                                 y
                                 ^
                              
                              i
                           
                        
                     . From Lemma 1, 2aiβi
                      − r
                     2 + p
                     2
 = 0. Therefore,

                        
                           
                              
                                 
                                    (
                                    
                                       r
                                       1
                                    
                                    −
                                    
                                       p
                                       1
                                    
                                    )
                                 
                                 
                                    
                                       x
                                       ^
                                    
                                    i
                                 
                                 ≥
                                 
                                    a
                                    i
                                 
                                 
                                    
                                       y
                                       ^
                                    
                                    i
                                    2
                                 
                              
                           
                        
                     
                  

Considering the objective of maximizing 
                        
                           
                              ∑
                              
                                 i
                                 =
                                 1
                              
                              M
                           
                           
                              y
                              i
                           
                        
                     , we have the following result.

                        Lemma 5
                        
                           There exists an optimal solution (
                           x
                           
                              *
                           , y
                           
                              *
                           
                           ) to TCAP-3, such that
                           
                              
                                 (7)
                                 
                                    
                                       
                                          
                                             y
                                             ^
                                          
                                          i
                                          *
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      r
                                                      1
                                                   
                                                   −
                                                   
                                                      p
                                                      1
                                                   
                                                
                                                
                                                   a
                                                   i
                                                
                                             
                                             
                                                
                                                   x
                                                   ^
                                                
                                                i
                                                *
                                             
                                          
                                       
                                       ,
                                       ∀
                                       i
                                       :
                                       
                                          x
                                          i
                                          *
                                       
                                       >
                                       0
                                    
                                 
                              
                           
                        


                           Without loss of generality, assume in the optimal solution that forwarders 1,2,…,L, 1 ≤ L ≤ M, are selected as partnering forwarders. The following equation holds for any two partnering forwarders.
                           
                              
                                 (8)
                                 
                                    
                                       
                                          a
                                          i
                                       
                                       
                                          
                                             x
                                             ^
                                          
                                          i
                                          *
                                       
                                       =
                                       
                                          a
                                          j
                                       
                                       
                                          
                                             x
                                             ^
                                          
                                          j
                                          *
                                       
                                       ,
                                       
                                       
                                       
                                       
                                       
                                       i
                                       ,
                                       j
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       L
                                    
                                 
                              
                           
                        

From Lemma 5, 
                              
                                 
                                    
                                       y
                                       ^
                                    
                                    i
                                    *
                                 
                                 
                                    (
                                    
                                       
                                          x
                                          ^
                                       
                                       i
                                       *
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   r
                                                   1
                                                
                                                −
                                                
                                                   p
                                                   1
                                                
                                             
                                             
                                                a
                                                i
                                             
                                          
                                       
                                       
                                          
                                             x
                                             ^
                                          
                                          i
                                          *
                                       
                                    
                                 
                              
                           . 
                              
                                 
                                    
                                       y
                                       ^
                                    
                                    i
                                    *
                                 
                                 
                                    (
                                    
                                       
                                          x
                                          ^
                                       
                                       i
                                       *
                                    
                                    )
                                 
                              
                            is concave in 
                              
                                 
                                    x
                                    ^
                                 
                                 i
                                 *
                              
                           , and its first-order derivative 
                              
                                 
                                    
                                       y
                                       ^
                                    
                                    i
                                    
                                       *
                                       ′
                                    
                                 
                                 
                                    (
                                    
                                       
                                          x
                                          ^
                                       
                                       i
                                       *
                                    
                                    )
                                 
                                 =
                                 
                                    1
                                    2
                                 
                                 
                                    
                                       
                                          
                                             
                                                r
                                                1
                                             
                                             −
                                             
                                                p
                                                1
                                             
                                          
                                          
                                             a
                                             i
                                          
                                       
                                    
                                 
                                 
                                    
                                       (
                                       
                                          
                                             x
                                             ^
                                          
                                          i
                                          *
                                       
                                       )
                                    
                                    
                                       −
                                       
                                          1
                                          /
                                          2
                                       
                                    
                                 
                              
                            is decreasing in 
                              
                                 
                                    x
                                    ^
                                 
                                 i
                                 *
                              
                           . In an optimal solution, the first-order derivatives must be equal, that is,
                              
                                 
                                    
                                       y
                                       ^
                                    
                                    i
                                    
                                       *
                                       ′
                                    
                                 
                                 
                                    (
                                    
                                       
                                          x
                                          ^
                                       
                                       i
                                       *
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       y
                                       ^
                                    
                                    j
                                    
                                       *
                                       ′
                                    
                                 
                                 
                                    (
                                    
                                       
                                          x
                                          ^
                                       
                                       j
                                       *
                                    
                                    )
                                 
                              
                           . Otherwise, whenever, say, 
                              
                                 
                                    
                                       y
                                       ^
                                    
                                    i
                                    
                                       *
                                       ′
                                    
                                 
                                 
                                    (
                                    
                                       
                                          x
                                          ^
                                       
                                       i
                                       *
                                    
                                    )
                                 
                              
                           >
                              
                                 
                                    
                                       y
                                       ^
                                    
                                    j
                                    
                                       *
                                       ′
                                    
                                 
                                 
                                    (
                                    
                                       
                                          x
                                          ^
                                       
                                       j
                                       *
                                    
                                    )
                                 
                              
                           , we can always improve the solution with a small perturbation, that is, increasing 
                              
                                 
                                    x
                                    ^
                                 
                                 i
                                 *
                              
                            by ɛ and decreasing 
                              
                                 
                                    x
                                    ^
                                 
                                 j
                                 *
                              
                            by ɛ, where ɛ is a positive infinitesimal quantity. With
                              
                                 
                                    
                                       y
                                       ^
                                    
                                    i
                                    
                                       *
                                       ′
                                    
                                 
                                 
                                    (
                                    
                                       
                                          x
                                          ^
                                       
                                       i
                                       *
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       y
                                       ^
                                    
                                    j
                                    
                                       *
                                       ′
                                    
                                 
                                 
                                    (
                                    
                                       
                                          x
                                          ^
                                       
                                       j
                                       *
                                    
                                    )
                                 
                              
                           , together with Lemma 5, we can show that, in an optimal solution, Eq. (8) must hold. □


                           Without loss of generality, assume that, in an optimal solution, forwarders 1,2 ,…, L, 1 ≤ L ≤ M, are selected as partnering forwarders. Denote
                           
                              
                                 π
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       L
                                       +
                                       1
                                    
                                    M
                                 
                                 
                                    α
                                    i
                                 
                              
                           
                           . Then
                           
                              
                                 
                                    x
                                    ^
                                 
                                 i
                                 *
                              
                           
                           ,
                           
                              
                                 
                                 
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 L
                              
                            
                           can be written as
                           
                              
                                 (9)
                                 
                                    
                                       
                                          
                                             x
                                             ^
                                          
                                          i
                                          *
                                       
                                       =
                                       π
                                       
                                          
                                             1
                                             /
                                             
                                                a
                                                i
                                             
                                          
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                L
                                             
                                             
                                                1
                                                /
                                                
                                                   a
                                                   j
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        


                     Lemma 7 naturally follows Lemma 6. Both lemmas suggest that the extra share of Route A capacity allocated to a selected forwarder depends on its cost efficiency; the smaller its ai
                     , the more it will receive. However, there is no guarantee that the forwarders with smaller ai
                      will be selected. Note that Eq. (9) holds generally when distributing an arbitrary amount π of Route A capacity among L selected forwarders.

According to Lemmas 4, 5, and 7, TCAP-3 can be reduced to the following problem.

                        
                           
                              
                                 
                                    
                                       
                                          
                                             max
                                             
                                                A
                                                ⊆
                                                (
                                                1
                                                ,
                                                2
                                                ,
                                                …
                                                ,
                                                M
                                                }
                                                )
                                             
                                          
                                          
                                          
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                A
                                             
                                          
                                          
                                             
                                                y
                                                ^
                                             
                                             i
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                i
                                                ∈
                                                A
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      r
                                                      1
                                                   
                                                   −
                                                   
                                                      p
                                                      1
                                                   
                                                
                                                
                                                   a
                                                   i
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      j
                                                      ∉
                                                      A
                                                   
                                                
                                                
                                                   α
                                                   j
                                                
                                                
                                                   
                                                      1
                                                      /
                                                      
                                                         a
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         ∑
                                                         
                                                            j
                                                            ∈
                                                            A
                                                         
                                                      
                                                      
                                                         1
                                                         /
                                                         
                                                            a
                                                            j
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             
                                                
                                                   r
                                                   1
                                                
                                                −
                                                
                                                   p
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      i
                                                      ∈
                                                      A
                                                   
                                                
                                                
                                                   1
                                                   /
                                                   
                                                      a
                                                      i
                                                   
                                                   
                                                      ∑
                                                      
                                                         j
                                                         ∉
                                                         A
                                                      
                                                   
                                                   
                                                      α
                                                      j
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     which is equivalent to

TCAP-4:

                        
                           
                              
                                 
                                    max
                                    
                                       A
                                       ⊆
                                       (
                                       1
                                       ,
                                       2
                                       ,
                                       …
                                       ,
                                       M
                                       }
                                       )
                                    
                                 
                                 
                                 
                                 
                                    ∑
                                    
                                       i
                                       ∈
                                       A
                                    
                                 
                                 
                                    1
                                    /
                                    
                                       a
                                       i
                                    
                                    
                                       ∑
                                       
                                          j
                                          ∉
                                          A
                                       
                                    
                                    
                                       α
                                       j
                                    
                                 
                                 .
                              
                           
                        
                     TCAP-4 can be interpreted as finding a subset, A, of forwarders such that 
                        
                           
                           
                              ∑
                              
                                 i
                                 ∈
                                 A
                              
                           
                           
                              1
                              /
                              
                                 a
                                 i
                              
                           
                           
                              ∑
                              
                                 j
                                 ∉
                                 A
                              
                           
                           
                              1
                              /
                              
                                 α
                                 i
                              
                           
                        
                      is maximized. Unfortunately, such a problem is NP-hard.

                        Theorem 1
                        
                           The problem defined by TCAP-4 is NP-hard.
                        

To show the NP-hardness of the problem defined by CCAP-4, we give a reduction from the well-known NP-hard 2-partition problem (Garey & Johnson, 1979): Given an integer set {k
                           1, k
                           2, …, kn
                           } with 
                              
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    n
                                 
                                 
                                    k
                                    i
                                 
                                 =
                                 2
                                 B
                              
                           , can we find a subset S such that 
                              
                                 
                                    ∑
                                    
                                       i
                                       ∈
                                       S
                                    
                                 
                                 
                                    k
                                    i
                                 
                                 =
                                 B
                              
                           ?

For such an instance of the 2-partition problem, we construct an instance of the problem defined by TCAP-4 as follows: let 
                        
                           
                              a
                              i
                           
                           =
                           1
                           /
                           
                              k
                              i
                           
                           ,
                           
                           
                           
                           
                           
                              α
                              i
                           
                           =
                           
                              k
                              i
                           
                           ,
                           
                           
                           
                           i
                           =
                           1
                           ,
                           …
                           ,
                           n
                        
                     . Then we have 
                        
                           
                           
                              ∑
                              
                                 i
                                 ∈
                                 A
                              
                           
                           
                              1
                              /
                              
                                 a
                                 i
                              
                           
                           
                              ∑
                              
                                 j
                                 ∉
                                 A
                              
                           
                           
                              α
                              i
                           
                           =
                           
                              ∑
                              
                                 i
                                 ∈
                                 A
                              
                           
                           
                              k
                              i
                           
                           
                              ∑
                              
                                 j
                                 ∉
                                 A
                              
                           
                           
                              k
                              j
                           
                           =
                           
                              ∑
                              
                                 i
                                 ∈
                                 A
                              
                           
                           
                              k
                              i
                           
                           
                              (
                              2
                              B
                              −
                              
                                 ∑
                                 
                                    i
                                    ∈
                                    A
                                 
                              
                              
                                 k
                                 i
                              
                              )
                           
                           ≤
                           
                              B
                              2
                           
                        
                     . Note that the equality holds only when 
                        
                           
                              ∑
                              
                                 i
                                 ∈
                                 A
                              
                           
                           
                              k
                              i
                           
                        
                     =B. Therefore, by solving the problem defined by TCAP-4, we will be able to solve the 2-partition problem: if the optimal objective function value for TCAP-4 is smaller than B
                     2, the 2-partition problem has no feasible solution. Otherwise, a feasible solution can be constructed following the solution to TCAP-4. Since 2-partition problem is NP-hard, so is the problem defined by TCAP-4. □

Given the NP-hardness of the problem, the best we can expect is an algorithm running in pseudo-polynomial time. Below, we provide a dynamic programming algorithm for the problem. Define 
                        
                           S
                           =
                           
                              ∑
                              
                                 i
                                 =
                                 1
                              
                              M
                           
                           
                              1
                              /
                              
                                 a
                                 i
                              
                           
                        
                     , 
                        
                           T
                           =
                           
                              ∑
                              
                                 i
                                 =
                                 1
                              
                              M
                           
                           
                              α
                              i
                           
                        
                     . Without loss of generality, we assume S ≤ T; the algorithm for the other case is very similar. Note that the data, both 1/ai
                      and αi
                     , may be rational numbers. To implement the algorithm, we need to fix a precision, say, Δ, which is the maximum possible value such that 
                        
                           (
                           
                              ∑
                              
                                 i
                                 =
                                 1
                              
                              j
                           
                           
                              1
                              /
                              
                                 a
                                 i
                              
                           
                           )
                           /
                           Δ
                        
                      
                     j = 1,…,M, are all integers. The dynamic programming algorithm works as follows.


                     Dynamic Programming for Solving TCAP-4.
                  


                     
                        
                           
                              
                              
                                 
                                    INITIALIZATION: 
                                          
                                             
                                                f
                                                2
                                             
                                             
                                                (
                                                0
                                                )
                                             
                                             =
                                             0
                                             ,
                                             
                                             
                                                g
                                                2
                                             
                                             
                                                (
                                                0
                                                )
                                             
                                             =
                                             
                                                α
                                                1
                                             
                                             +
                                             
                                                α
                                                2
                                             
                                             ;
                                             
                                             
                                                f
                                                2
                                             
                                             
                                                (
                                                1
                                                /
                                                
                                                   a
                                                   1
                                                
                                                +
                                                1
                                                /
                                                
                                                   a
                                                   2
                                                
                                                )
                                             
                                             =
                                             0
                                             ,
                                             
                                                g
                                                2
                                             
                                             
                                                (
                                                1
                                                /
                                                
                                                   a
                                                   1
                                                
                                                +
                                                1
                                                /
                                                
                                                   a
                                                   2
                                                
                                                )
                                             
                                             =
                                             0
                                             ;
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                f
                                                2
                                             
                                             
                                                (
                                                s
                                                )
                                             
                                             =
                                             −
                                             1
                                             ,
                                             
                                             
                                                g
                                                2
                                             
                                             
                                                (
                                                s
                                                )
                                             
                                             =
                                             −
                                             1
                                             ,
                                             
                                             s
                                             =
                                             Δ
                                             ,
                                             
                                             2
                                             Δ
                                             
                                             ,
                                             
                                             .
                                             .
                                             .
                                             
                                             ,
                                             1
                                             /
                                             
                                                a
                                                1
                                             
                                             +
                                             1
                                             /
                                             
                                                a
                                                2
                                             
                                             −
                                             Δ
                                          
                                       .
                                 
                                 
                                    IF 
                                          
                                             
                                                a
                                                1
                                             
                                             =
                                             
                                                a
                                                2
                                             
                                          
                                       
                                    
                                 
                                 
                                    THEN
                                 
                                 
                                     
                                       
                                          
                                             
                                                f
                                                2
                                             
                                             
                                                (
                                                1
                                                /
                                                
                                                   a
                                                   1
                                                
                                                )
                                             
                                             =
                                             max
                                             
                                                {
                                                
                                                   α
                                                   1
                                                
                                                ,
                                                
                                                   α
                                                   2
                                                
                                                }
                                             
                                             /
                                             
                                                a
                                                1
                                             
                                             ;
                                             
                                             
                                             
                                             
                                             
                                             
                                             
                                                g
                                                2
                                             
                                             
                                                (
                                                1
                                                /
                                                
                                                   a
                                                   1
                                                
                                                )
                                             
                                             =
                                             max
                                             
                                                {
                                                
                                                   α
                                                   1
                                                
                                                ,
                                                
                                                   α
                                                   2
                                                
                                                }
                                             
                                          
                                       
                                    
                                 
                                 
                                    ELSE
                                 
                                 
                                     
                                       
                                          
                                             
                                                f
                                                2
                                             
                                             
                                                (
                                                1
                                                /
                                                
                                                   a
                                                   1
                                                
                                                )
                                             
                                             =
                                             
                                                α
                                                2
                                             
                                             /
                                             
                                                a
                                                1
                                             
                                             ;
                                             
                                             
                                             
                                             
                                             
                                             
                                                g
                                                2
                                             
                                             
                                                (
                                                1
                                                /
                                                
                                                   a
                                                   1
                                                
                                                )
                                             
                                             =
                                             
                                                α
                                                2
                                             
                                             ;
                                             
                                             
                                             
                                             
                                             
                                             
                                                f
                                                2
                                             
                                             
                                                (
                                                1
                                                /
                                                
                                                   a
                                                   2
                                                
                                                )
                                             
                                             =
                                             
                                                α
                                                1
                                             
                                             /
                                             
                                                a
                                                2
                                             
                                             ;
                                             
                                             
                                             
                                             
                                             
                                             
                                             
                                                g
                                                2
                                             
                                             
                                                (
                                                1
                                                /
                                                
                                                   a
                                                   2
                                                
                                                )
                                             
                                             =
                                             
                                                α
                                                1
                                             
                                          
                                       
                                    
                                 
                                 
                                    ENDIF
                                 
                                 
                                    For i = 3 to M
                                    
                                 
                                 
                                     FOR s = 0 to 
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                i
                                             
                                             
                                                1
                                                /
                                                
                                                   a
                                                   i
                                                
                                             
                                          
                                        (increased by
                                          Δ
                                       in each step)
                                 
                                 
                                     BEGIN
                                 
                                 
                                      
                                       
                                          
                                             
                                                f
                                                i
                                             
                                             
                                                (
                                                s
                                                )
                                             
                                             =
                                             −
                                             1
                                             ;
                                             
                                             
                                                g
                                                i
                                             
                                             
                                                (
                                                s
                                                )
                                             
                                             =
                                             −
                                             1
                                          
                                       
                                    
                                 
                                 
                                      IF 
                                          
                                             s
                                             −
                                             1
                                             /
                                             
                                                a
                                                i
                                             
                                             ≥
                                             0
                                          
                                        and 
                                          
                                             
                                                g
                                                
                                                   i
                                                   −
                                                   1
                                                
                                             
                                             
                                                (
                                                s
                                                −
                                                1
                                                /
                                                
                                                   a
                                                   i
                                                
                                                )
                                             
                                             ≥
                                             0
                                          
                                       
                                    
                                 
                                 
                                      THEN 
                                          
                                             
                                                f
                                                i
                                             
                                             
                                                (
                                                s
                                                )
                                             
                                             =
                                             s
                                             *
                                             
                                                g
                                                
                                                   i
                                                   −
                                                   1
                                                
                                             
                                             
                                                (
                                                s
                                                −
                                                1
                                                /
                                                
                                                   a
                                                   i
                                                
                                                )
                                             
                                             ;
                                             
                                             
                                             
                                             
                                                g
                                                i
                                             
                                             
                                                (
                                                s
                                                )
                                             
                                             =
                                             
                                             
                                                g
                                                
                                                   i
                                                   −
                                                   1
                                                
                                             
                                             
                                                (
                                                s
                                                −
                                                1
                                                /
                                                
                                                   a
                                                   i
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                                 
                                      ENDIF
                                 
                                 
                                      IF 
                                          
                                             s
                                             <
                                             =
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                
                                                   i
                                                   −
                                                   1
                                                
                                             
                                             
                                                1
                                                /
                                                
                                                   a
                                                   i
                                                
                                             
                                          
                                       and 
                                          
                                             
                                                g
                                                
                                                   i
                                                   −
                                                   1
                                                
                                             
                                             
                                                (
                                                s
                                                )
                                             
                                             ≥
                                             0
                                          
                                       
                                    
                                 
                                 
                                      THEN
                                 
                                 
                                       IF
                                          
                                             
                                                f
                                                i
                                             
                                             
                                                (
                                                s
                                                )
                                             
                                             <
                                             s
                                             *
                                             
                                                (
                                                
                                                   g
                                                   
                                                      i
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   s
                                                   )
                                                
                                                +
                                                
                                                   α
                                                   i
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                                 
                                       THEN
                                          
                                             
                                                f
                                                i
                                             
                                             
                                                (
                                                s
                                                )
                                             
                                             =
                                             s
                                             *
                                             
                                                (
                                                
                                                   g
                                                   
                                                      i
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   s
                                                   )
                                                
                                                +
                                                
                                                   α
                                                   i
                                                
                                                )
                                             
                                             ;
                                             
                                             
                                                g
                                                i
                                             
                                             
                                                (
                                                s
                                                )
                                             
                                             =
                                             
                                             
                                                g
                                                
                                                   i
                                                   −
                                                   1
                                                
                                             
                                             
                                                (
                                                s
                                                )
                                             
                                             +
                                             
                                                α
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                       ENDIF
                                 
                                 
                                       ENDIF
                                 
                                 
                                      END
                                 
                                 
                                    END
                                 
                                 
                                    The optimal objective function value 
                                          
                                             
                                                f
                                                M
                                                *
                                             
                                             =
                                             
                                                max
                                                
                                                   s
                                                   =
                                                   0
                                                
                                                S
                                             
                                             
                                                f
                                                M
                                             
                                             
                                                (
                                                s
                                                )
                                             
                                          
                                       .
                                 
                              
                           
                        
                     
                  

In the above dynamic programming, 
                        
                           
                              f
                              i
                           
                           
                              (
                              s
                              )
                           
                           =
                           
                              max
                              
                                 
                                    A
                                    i
                                 
                                 ⊂
                                 
                                    {
                                    1
                                    ,
                                    2
                                    ,
                                    …
                                    ,
                                    i
                                    }
                                 
                              
                           
                           
                              ∑
                              
                                 j
                                 ∈
                                 
                                    A
                                    i
                                 
                              
                           
                           
                              1
                              /
                              
                                 a
                                 j
                              
                           
                           
                              ∑
                              
                                 j
                                 ∉
                                 
                                    A
                                    i
                                 
                              
                           
                           
                              α
                              j
                           
                        
                      such that 
                        
                           
                              ∑
                              
                                 j
                                 ∈
                                 
                                    A
                                    i
                                 
                              
                           
                           
                              1
                              /
                              
                                 a
                                 j
                              
                           
                           =
                           s
                        
                      and gi
                     (s)is the corresponding optimal value for 
                        
                           
                              ∑
                              
                                 j
                                 ∉
                                 
                                    A
                                    i
                                 
                              
                           
                           
                              α
                              j
                           
                        
                     . To recover the optimal solution from the above algorithm, we start with 
                        
                           
                              s
                              M
                              *
                           
                           =
                           arg
                           max
                           
                              ∑
                              
                                 s
                                 =
                                 0
                              
                              S
                           
                           
                              
                                 f
                                 M
                              
                              
                                 (
                                 s
                                 )
                              
                           
                        
                     . If 
                        
                           
                              f
                              M
                           
                           
                              (
                              
                                 s
                                 M
                                 *
                              
                              )
                           
                           /
                           
                              s
                              M
                              *
                           
                           =
                           
                              g
                              
                                 M
                                 −
                                 1
                              
                           
                           
                              (
                              
                                 s
                                 M
                                 *
                              
                              −
                              1
                              /
                              
                                 a
                                 M
                              
                              )
                           
                        
                     , then forwarder M is selected as a partnering forwarder and 
                        
                           
                              s
                              
                                 M
                                 −
                                 1
                              
                              *
                           
                           =
                           
                              s
                              M
                              *
                           
                           −
                           1
                           /
                           
                              a
                              M
                           
                        
                     . Otherwise, forwarder i is not selected, and 
                        
                           
                              s
                              
                                 M
                                 −
                                 1
                              
                              *
                           
                           =
                           
                              s
                              M
                              *
                           
                        
                     . Following the same idea, in general, if
                        
                           
                              f
                              i
                           
                           
                              (
                              
                                 s
                                 i
                                 *
                              
                              )
                           
                           /
                           
                              s
                              i
                              *
                           
                           =
                           
                              g
                              
                                 i
                                 −
                                 1
                              
                           
                           
                              (
                              
                                 s
                                 i
                                 *
                              
                              −
                              1
                              /
                              
                                 a
                                 i
                              
                              )
                           
                        
                     , forwarder i is selected; otherwise not. Then we have 
                        
                           
                              s
                              
                                 i
                                 −
                                 1
                              
                              *
                           
                           =
                           
                              s
                              i
                              *
                           
                        
                     . Repeat until i decreases to 2. There are four cases when i = 2: (1) if 
                        
                           
                              s
                              2
                              *
                           
                           =
                           1
                           /
                           
                              a
                              1
                           
                        
                     , forwarder 1 is selected; (2) if 
                        
                           
                              s
                              2
                              *
                           
                           =
                           1
                           /
                           
                              a
                              2
                           
                        
                     , forwarder 2 is selected; (3) if 
                        
                           
                              s
                              2
                              *
                           
                           =
                           1
                           /
                           
                              a
                              1
                           
                           +
                           1
                           /
                           
                              a
                              2
                           
                        
                     , both are selected; and (4) if 
                        
                           
                              s
                              2
                              *
                           
                           =
                           0
                        
                     , neither are selected. It is easy to verify that the complexity of the above algorithm is O(MS/Δ). Considering the possibility T < S, the complexity of the above algorithm, in general, is 
                        
                           O
                           (
                           M
                           
                           
                           min
                           
                              (
                              S
                              /
                              Δ
                              )
                           
                           ,
                           
                           
                           T
                           /
                           
                              Δ
                              ˜
                           
                           )
                           )
                        
                     , where 
                        
                           Δ
                           ˜
                        
                      is the maximum possible value such that 
                        
                           
                              (
                              
                                 ∑
                                 
                                    i
                                    =
                                    1
                                 
                                 j
                              
                              
                                 α
                                 i
                              
                              )
                           
                           /
                           
                              Δ
                              ˜
                           
                           ,
                           
                           j
                           =
                           1
                           ,
                           …
                           ,
                           M
                        
                     , are all integers.

Knowing which forwarders are the partners, we can then utilize Lemmas 5 and 7 to compute the optimal values for 
                        
                           
                              
                                 x
                                 ^
                              
                              i
                              *
                           
                           ,
                           
                              
                                 y
                                 ^
                              
                              i
                              *
                           
                        
                     , and correspondingly, 
                        
                           
                              x
                              i
                              *
                           
                           ,
                           
                              y
                              i
                              *
                           
                        
                     
                     
                        Theorem 2
                        
                           Let A* denote the optimal set of partnering forwarders. The optimal capacity allocation is specified as follows:
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                x
                                                i
                                                *
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   α
                                                   i
                                                
                                                +
                                                
                                                   1
                                                   
                                                      a
                                                      i
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                         
                                                            j
                                                            ∉
                                                            
                                                               A
                                                               *
                                                            
                                                         
                                                      
                                                      
                                                         α
                                                         j
                                                      
                                                   
                                                   
                                                      
                                                         ∑
                                                         
                                                            j
                                                            ∈
                                                            
                                                               A
                                                               *
                                                            
                                                         
                                                      
                                                      
                                                         1
                                                         /
                                                         
                                                            a
                                                            j
                                                         
                                                      
                                                   
                                                
                                                ,
                                                
                                                i
                                                f
                                                
                                                i
                                                ∉
                                                
                                                   A
                                                   *
                                                
                                                ;
                                                
                                                
                                                
                                                
                                                   x
                                                   i
                                                   *
                                                
                                                =
                                                0
                                                ,
                                                
                                                o
                                                .
                                                w
                                                .
                                                ,
                                             
                                          
                                       
                                       
                                          
                                             
                                                y
                                                i
                                                *
                                             
                                          
                                          
                                             =
                                          
                                          
                                             
                                                
                                                   β
                                                   i
                                                
                                                +
                                                
                                                   
                                                      
                                                         r
                                                         1
                                                      
                                                      −
                                                      
                                                         p
                                                         1
                                                      
                                                   
                                                
                                                
                                                   1
                                                   
                                                      a
                                                      i
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                            
                                                               j
                                                               ∉
                                                               
                                                                  A
                                                                  *
                                                               
                                                            
                                                         
                                                         
                                                            α
                                                            j
                                                         
                                                      
                                                      
                                                         
                                                            ∑
                                                            
                                                               j
                                                               ∈
                                                               
                                                                  A
                                                                  *
                                                               
                                                            
                                                         
                                                         
                                                            1
                                                            /
                                                            
                                                               a
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                                ,
                                                
                                                
                                                i
                                                f
                                                
                                                i
                                                ∉
                                                
                                                   A
                                                   *
                                                
                                                ;
                                                
                                                
                                                
                                                
                                                   y
                                                   i
                                                   *
                                                
                                                =
                                                
                                                   β
                                                   i
                                                
                                                ,
                                                
                                                o
                                                .
                                                w
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

In the above, we have assumed a quadratic cost function for Route B's capacity, that is, 
                           
                              
                                 C
                                 2
                              
                              
                                 (
                                 
                                    y
                                    i
                                 
                                 )
                              
                              =
                              
                                 p
                                 2
                              
                              
                                 y
                                 i
                              
                              +
                              
                                 a
                                 i
                              
                              
                                 y
                                 i
                                 2
                              
                           
                        . The quadratic functional form is based on observations of the interviewed airline and is exemplified with the data on thirteen forwarders. Even so, there is no theoretical proof that the quadratic form generally holds. What is generally true is that the cost function increases with the capacity in a convex way, namely, 
                           
                              
                                 C
                                 2
                              
                              
                                 (
                                 
                                    y
                                    i
                                 
                                 )
                              
                              =
                              
                                 p
                                 2
                              
                              
                                 y
                                 i
                              
                              +
                              
                                 a
                                 i
                              
                              
                                 y
                                 i
                                 q
                              
                           
                        ; q > 1.

Fortunately, the main idea of the proposed capacity allocation mechanism still works. In particular, Lemma 1, about estimating ai
                        , can be slightly revised as below.

                           Lemma 8
                           
                              ai can be estimated through observing βi,
                              
                                 
                                    
                                       a
                                       i
                                    
                                    =
                                    
                                       (
                                       
                                          r
                                          2
                                       
                                       −
                                       
                                          p
                                          2
                                       
                                       )
                                    
                                    /
                                    
                                       (
                                       q
                                       
                                          β
                                          i
                                          
                                             q
                                             −
                                             1
                                          
                                       
                                       )
                                    
                                 
                              .

Furthermore, the new model for the problem essentially follows the TCAP-1 model. Define Γ as a large number. The new model can then be written as follows.

TCAP-5:༚

                           
                              (10)
                              
                                 
                                    max
                                    
                                    z
                                    
                                       (
                                       
                                          x
                                          ,
                                          y
                                       
                                       )
                                    
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       M
                                    
                                    
                                       
                                          p
                                          1
                                       
                                       
                                          x
                                          i
                                       
                                    
                                    +
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       M
                                    
                                    
                                       
                                          p
                                          2
                                       
                                       
                                          y
                                          i
                                       
                                    
                                    ,
                                 
                              
                           
                        
                     


                        s.t.
                        
                           
                              (11)
                              
                                 
                                    
                                       x
                                       i
                                    
                                    ≤
                                    Γ
                                    
                                       τ
                                       i
                                    
                                    ,
                                    
                                    
                                    
                                    
                                    i
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    M
                                    ,
                                 
                              
                           
                        
                        
                           
                              (12)
                              
                                 
                                    
                                       
                                          
                                             
                                                (
                                                
                                                   r
                                                   1
                                                
                                                −
                                                
                                                   p
                                                   1
                                                
                                                )
                                             
                                             
                                                x
                                                i
                                             
                                          
                                       
                                       
                                          +
                                       
                                       
                                          
                                             
                                                (
                                                
                                                   r
                                                   2
                                                
                                                −
                                                
                                                   p
                                                   2
                                                
                                                )
                                             
                                             
                                                y
                                                i
                                             
                                             −
                                             
                                                a
                                                i
                                             
                                             
                                                y
                                                i
                                                q
                                             
                                             ≥
                                             
                                                τ
                                                i
                                             
                                             
                                                (
                                                
                                                   r
                                                   1
                                                
                                                −
                                                
                                                   p
                                                   1
                                                
                                                )
                                             
                                             
                                                α
                                                i
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          +
                                       
                                       
                                          
                                             
                                                (
                                                
                                                   r
                                                   2
                                                
                                                −
                                                
                                                   p
                                                   2
                                                
                                                )
                                             
                                             
                                                β
                                                i
                                             
                                             −
                                             
                                                a
                                                i
                                             
                                             
                                                β
                                                i
                                                q
                                             
                                             ,
                                             
                                             
                                             i
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             M
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (13)
                              
                                 
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       M
                                    
                                    
                                       x
                                       i
                                    
                                    ≤
                                    
                                       ω
                                       1
                                    
                                    ,
                                 
                              
                           
                        
                        
                           
                              (14)
                              
                                 
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       M
                                    
                                    
                                       y
                                       i
                                    
                                    ≤
                                    
                                       ω
                                       2
                                    
                                    ,
                                 
                              
                           
                        
                        
                           
                              (15)
                              
                                 
                                    
                                       x
                                       i
                                    
                                    ,
                                    
                                       y
                                       i
                                    
                                    ≥
                                    0
                                    ,
                                    
                                    
                                    
                                    i
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    M
                                    ,
                                 
                              
                           
                        
                        
                           
                              (16)
                              
                                 
                                    
                                       τ
                                       i
                                    
                                    ∈
                                    
                                       {
                                       0
                                       ,
                                       1
                                       }
                                    
                                    ,
                                    
                                    
                                    i
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    M
                                    ,
                                 
                              
                           
                        
                     

Constraints (11) and (16) ensure that τi
                         is 1 whenever xi
                         is positive; otherwise, it is 0 since the objective is to maximize yi
                        . TCAP-5 is a nonlinear integer programming model. Our approach, especially the dynamic programming algorithm, can be easily applied. If we relax constraint (16) to 0 ≤ τ ≤ 1, the resulting model, denoted as TCAP-6, no longer has integer variables. It is not difficult to verify the following.

                           Lemma 9
                           
                              TCAP-6 is a convex programming model.


                        Lemma 9 implies that TCAP-6 can be efficiently solved. A branch and bound framework incorporating TCAP-6 can be easily developed, although the solution procedure may take a slightly longer time when the number of forwarders is large.

In the proposed solution, forwarders are considered only according to their cost structures and current allotments. There is a tradeoff involved in selecting a larger forwarder as a partner. On the one hand, a larger forwarder usually enjoys a strong economy of scale, and parameter ai
                         is often smaller. Therefore, allocating the same amount of Route A capacity to a larger forwarder will generate more Route B capacity orders than to a smaller forwarder, as Lemma 5 indicates. On the other hand, a larger forwarder is typically allocated a larger share of Route A capacity in previous periods, and taking that share back and reallocating it to other forwarders will generate more sales of Route B capacity. Therefore, there is no guarantee whether a larger forwarder will be selected as a partner.

As a result, the optimal solution from our algorithm may suggest the withdrawal of Route A capacity from a forwarder, which is considered very important by the airline. There are two ways of handling this situation. One is that the airline can specify the forwarders that must be selected as partnering forwarders beforehand. This can be easily incorporated into the dynamic programming: if forwarder i is destined to be a partner, in computing fi
                        (s), one only needs to consider this single case. The other way is to process after the solution. For an important forwarder suggested to be “excluded” by the optimal solution, the airline can allow the forwarder to reserve a large portion of its current Route A capacity and allocate the rest to other forwarders. Note that the allocation will require another round of computation. In the new input to the dynamic programming, the concerned forwarder i is replaced with a new forwarder, which is destined not to be selected and whose αi
                         is the portion of the capacity to be given up. It is at the discretion of the airline which of the above two ways to adopt.

In this section, we test the proposed tying capacity allocation mechanism with sample data from the partnering airline. The purpose of this analysis is to demonstrate the applicability and the impact of the proposed tying capacity allocation mechanism.

The airline is one of the largest transportation firms in the world—the fourth worldwide and the first in Asia. In 2012, its revenue was over $15 billion. Cargo traffic was growing rapidly, and cargo revenue, which increased 86.9 percent over the last year, was becoming increasingly important to the airline. Among the routes served by the airline, about 20 percent are hot-selling routes, which contribute about 40 percent of the overall cargo revenue, while 30 percent are underutilized routes that threaten the bottom line of the airline. The airline considered leveraging the scarcity of hot-selling route capacities to generate more orders of underutilized routes.

The airline implemented the tying capacity allocation of hot-selling route GB and underutilized route GT as a demonstration project. First, according to Lemma 1, the airline estimated the cost parameters of the eleven forwarders involved in the two routes. The capacity allotment of the two routes among the 11 forwarders and cost parameter ai
                      is given in Table 2
                     . Note that the forwarders are indexed in the increasing order of ai
                     . The total capacities of GB and GT are ω
                     1 = 2663.8 T and ω
                     2 = 2785.5 T, respectively. The average prices of routes' GB and GT capacities charged to the forwarders by the airline are p
                     1= $625/T and p
                     2= $613/T. The average prices of routes' GB and GT capacities charged to shippers by the forwarders are r
                     1 = $656/T and r
                     2 = $638/T, respectively.


                     Table 3
                      shows the optimal tying capacity allocation of GB and GT routes. Six out of the eleven forwarders are selected as partners. It is noteworthy that forwarders 1 and 2, the “strongest” two forwarders, are not selected, and the selected forwarders are mostly middle-sized or small-sized. Surprisingly, this result is consistent with the manager's belief that large forwarders are actually taking advantage of the airline—they take too large a share of route GB capacity, whereas they contribute insufficiently to the sales of route GT capacity.


                     Table 4
                      shows the optimal set of partnering forwarders and the corresponding profit when the airline wants fewer or more partners. For Table 4, we solved the TCAP-4 model 10 times by varying the number of the selected partners from 1 to 10. Accordingly, we obtained 10 sets of optimal solutions and values. Fig. 2
                      plots the optimal revenue and the percentage increase over the last period with different numbers of partners. Note that the capacity utilization of the GT route increases from 32 percent in the last period to 78.7 percent in this period, and the corresponding revenue increases amounted to $0.797 million. In addition, it is desirable to see that the sales remain rather robust when the number of partners changes moderately, from 5 to 7.

The airline would implement the new mechanism into its network-wide routes, so we have also estimated the overall profitability of the mechanism. Following the suggested routes partition and tying ideas in Section 1, the airline paired hot-selling routes with underutilized routes in some branches. Fig. 3
                      shows the potential profit
                        4
                     
                     
                        4
                        Here we need to report profit instead of revenue. When multiple routes are involved, it is suitable to maximize profit instead of revenue since the profit margins of different routes are different. Note that, for the two-route problem, maximizing revenue is equivalent to maximizing profit.
                      increase when more pairs of routes are involved. Roughly speaking, the airline estimated that the profit would amount to $4 million (per sales season) if the tying mechanism would be applied to the entire air cargo network. It is evident that the tying capacity allocation mechanism is very profitable.

@&#SUMMARY@&#

To help airlines deal with the imbalance in the demand for different routes, we propose the tying capacity allocation mechanism. The mechanism enables airlines to use the leverage provided by a scarce resource to foreclose sales in, and thereby monopolize, an underutilized one. Airlines make the leverage work by excluding some forwarders from partial business temporarily and making the selected partners collaborate through good and bad conditions by rewarding them with scarcer resources. Airlines gain in terms of profitability by adjusting the resource allocation structure in light of resource utilization efficiency; that is, the enclosed forwarders have lower resource unitization efficiency from the selected forwarders. The effectiveness of the proposed mechanism has been validated with a case study. Both overall tonnage and revenue have recorded significant improvement.

The tying capacity allocation mechanism is pragmatic, and it works the simple way: the airline makes an offer to forwarders, “If you buy extra y units of Route B capacity, you will be rewarded by x units of Route A capacity.” The proposed solution in the paper is to optimize the offers so that forwarders are willing to take the offers and the airline's total revenue is maximal. The success of the proposal relies on observations that enable the airline to estimate the forwarder's cost functions and the related parameters. Considering the possible estimation errors, airlines may need to be more generous when making offers to forwarders.

It is worth mentioning that the problem studied in the paper is different from those in the existing cargo capacity management literature. The medium- to long-term capacity allocation problem happens first. In this stage, the airline tries to sell as much underutilized capacity as possible; this is the focus of the present paper. Next, the airline and forwarder need to reach an agreement on a particular contract for a particular route. The final stage is concerned with the spot market.

If airlines cannot derive the cost structures of forwarders by a dual-channel sales system, then a smarter tying mechanism needs to be designed for airlines. For example, motivated by the idea of “turn-and-earn” (Cachon & Lariviere, 1999b), airlines may allocate the tight capacity on Route A based on the forwarder's orders for the idle capacity on Route B. In addition, theoretically, the tying capacity allocation mechanism should be applicable to the network capacity management without consideration of business partition. To develop such a mechanism, however, two issues must be addressed. How can routes be tied with an actionable strategy, and what is the optimal capacity allocation policy among forwarders? We leave this to future research.

@&#ACKNOWLEDGMENTS@&#

Dr. Bo Feng acknowledges the support by the National Natural Science Foundation of China (Project nos. 71371076 and 71101032) and the New Century Excellent Talents Funds of Ministry of Education of the People's Republic of China (Project no. NCET-11-0151). Dr. Yanzhi Li is partially supported by the National Natural Science Foundation of China (Project no. 71390335). We also thank the three anonymous reviewers, the associate editor, and the editor for their constructive feedback and suggestions.

@&#REFERENCES@&#

