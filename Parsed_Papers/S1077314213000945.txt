@&#MAIN-TITLE@&#Multi-agent stochastic level set method in image segmentation

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A variational framework based on level set theory is introduced to find the global solution for image segmentation problem.


                        
                        
                           
                           A single and a multi-agent stochastic structure are studied in the aforementioned framework.


                        
                        
                           
                           Proof of convergence for single-agent model (active contour with stochastic fronts) is also provided in this article.


                        
                        
                           
                           Comparing with Chan–Vese model, higher chance to find the global solution is achieved.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Image segmentation

Multi-agent

Stochastic level set

Global solution

@&#ABSTRACT@&#


               
               
                  A stochastic structure for single and multi-agent level set method is investigated in this article in an attempt to overcome local optima problems in image segmentation. Like other global optimization methods that take advantage of random operators and multi-individual search algorithms, the best agent in this proposed algorithm plays the role of leader in order to enable the algorithm to find the global solution. To accomplish this, the procedure employs a set of stochastic partial differential equations (SPDE), each one of which evolves based on its own stochastic dynamics. The agents are then compelled to simultaneously converge to the best available topology. Moreover, the stochastic dynamics of each agent extends the stochastic level set approach by using a multi source structure. Each source is a delta function centered on a point of evolving front. Lastly, while the computational costs of these methods are higher than the region-based level set method, the probability of finding the global solution is significantly increased.
               
            

@&#INTRODUCTION@&#

Finding a precise, fast, automated and robust approach to segment each image into meaningful sections is crucial in image processing [1]. There are many classical [2] and advanced methods [3] currently available in image segmentation, including thresholding, clustering, histogram-based, region-growing, graph partitioning. However, among these, only a few can be applied in practical and non-ideal images. Several review papers on image segmentations [3–5] verify that there is no general computational method to cope with all practical images. Therefore, for each class of images, a method should be selected and tuned in order to achieve satisfactory results. Deformable models or active contours are relatively new approaches in image segmentation. As their names imply, active contours provide an explicit representation of the boundary and shape of objects. They have several desirable properties when compared to the aforementioned methods such as inherent connectivity and smoothness, and being capable of adding knowledge domain about the object of interest [6]. The level set method (LSM) [7–9] is one of the most important algorithms in deformable models and has been widely employed in many applications. It has several advantages over other active contour methods. These advantages include: (1) no need for parameterization of the contour; (2) flexibility in topology definition; (3) numerical stability; and (4) easiness of extension to higher dimensions [6,10,11]. Essentially, this method is an extension of steepest descent to the variational framework, and therefore this algorithm inherits the problem of getting trapped in local optima. As a result, the final solution is very sensitive to the initial guess [12].

This problem has been relentlessly investigated in recent researches. The aforementioned approaches can be grouped into two categories. The methods in the first category try to reformulate the objective functions used in image segmentation in order to improve the performance of the algorithm. Conversely, the methods in the second division focus on the optimization procedure and the evolution process in the level set method. Kichenassamy et al. [13] and Caselles et al. [14] proposed geodesic active contours as an energy-based algorithm for image segmentation, with intention to improve the capability of non-convex feature detection. Additionally, by this extension, the researchers improved the speed of convergence as well. An interesting review based on geodesic active contours can be found in [15], which evaluates the performance of this method on the convexification of the cost functions in image segmentation. Finding a pure convex function which is appropriate for segmentation is obviously not possible. As such, instead of evolving based on local edge information [16] (as well as other snake approaches [17]), the use of region-based cost functions [18] that have less local optima and consequently, segmentation procedure, would be far less sensitive to the initial guess. Region-based active contours were originated by Mumford–Shah [18]. In this research, they proposed a new segmentation framework in which the minimization of the functional in Eq. (1) was employed in order to segment the image, I, by using a set of contours, ∂Ω 
                     [6,18].
                        
                           (1)
                           
                              E
                              (
                              ∂
                              Ω
                              ,
                              f
                              )
                              =
                              α
                              
                                 ∫
                                 
                                    Ω
                                 
                              
                              
                                 
                                    (
                                    f
                                    -
                                    I
                                    )
                                 
                                 
                                    2
                                 
                              
                              dx
                              +
                              β
                              
                                 ∫
                                 
                                    Ω
                                    ⧹
                                    ∂
                                    Ω
                                 
                              
                              |
                              ∇
                              f
                              |
                              dx
                              +
                              
                                 
                                    H
                                 
                                 
                                    n
                                    -
                                    1
                                 
                              
                              (
                              ∂
                              Ω
                              )
                           
                        
                     where H
                     
                        n−1(∂Ω) is the (N
                     −1) dimensional Hausdorff measure and 
                        
                           α
                           ,
                           β
                           ∈
                           
                              
                                 R
                              
                              
                                 +
                              
                           
                        
                      are positive real coefficients, f is a smooth approximation of image I and Ω is the region surrounded by ∂Ω.

The main drawback of this method is its high sensitivity to in-homogeneities caused by noise and artifacts in practical images. In particular, moving organs in medical images exaggerate these in-homogeneities.

Using this framework, Chan and Vese created a new vision of “Active Contour without Edge” (ACWE) in a series of oft-cited papers [19–23]. For them, object detection is not necessarily performed by the gradient at its edges. Rather, the basic idea is based on the minimal partition problem in which the stopping criteria does not depend on the gradient of the image. The problem is not convex yet has less local optima. The level set method, which is a gradient-based algorithm, usually finds the global (or the best possible solution) topology that defines an accurate segmentation. The subsequent paragraphs provide a brief review of the second approach to improving the performance of the level set method.

There are some other models that sometimes demonstrate better responses than the Chan–Vese model such as the research by Bresson [24], this model has a different local optimal than ACWE and usually performs better than ACWE in terms of accuracy of segmentation, particularly when the images suffer from low contrast features. The basic idea behind it is to add an edge-based indicator into the region-based model. Obviously, since this method is founded on gradient flow, the algorithm may be stuck in local solutions. However, local solutions are usually more accurate than the solutions of ACWE in terms of indicating low contrast edges. Therefore, global solution is a better solution compared to ACWE. The original definition of global solution is somewhat different from how it is used in this paper. The current paper is looking for an active contour approach that does not get trapped in parts of the image and is capable of exploring the whole image.

The idea of stochastic flow, as proposed by Welsh [25], is based on stochastic partial differential equations. This concept has been employed in the modeling of physical phenomena and even computer vision. Yip [26] has performed a literature review on stochastic motion by mean curvature that shows the recent trends in this field. One of the most interesting set of works on the viscosity solution of a stochastic partial differential equation was done by Lions and Souganidis in a series of articles [27,28] that are very helpful for numerical implementation of the stochastic level set method.

A simple stochastic curve evolution has been implemented by Juan et al. [12] in a level set framework. By using a Stratonovich differential, the well-posedness of the evolution is achieved. In addition, the final solution almost becomes independent of the initial curve. The stochastic active contour proposed in this reference is able to deal with the local optima problem and even with a complicated circumstance wherein the derivation of the exact gradient is not possible. The only concern is that the general spatial-dependent formulation derived in this article is generally not convergent to the deterministic model.

A very comprehensive extension to this work has been done in [29], which investigates several aspects of the simulation of stochastic partial differential equations. In addition to the extension of previous work by Juan et al. [12], a set of definitions for numerical stability of stochastic partial differential equation (SPDE) has been suggested.

Law et al. [1] investigated the global minimization of the multi-phase piecewise constant Mumford–Shah model [18]. To do so, a hybrid method containing the gradient-based and stochastic method was proposed to deal with the dependency of the solution on initial guesses. The algorithm seems to be very successful compared to other stochastic algorithms such as simulated annealing.

Chen and Radke [30] extended the conventional random walk Metropolis–Hastings method to high-dimensional curves; while also proving the asymptotic convergence of the Markov chain. To accomplish this, the authors used an implicit representation of shapes instead of conventional explicit curve parameterization. They claim that their algorithm can be easily applied to 3D frameworks.

Pan and others in [31], proposed a new formulation for active contours, in which the conventional state estimation is employed for evolving the curves. As a result, a hybrid algorithm based on the level set method and particle filters has been created. Results show that this new algorithm works well for complex images. An interesting comparison has been made in [1] about various level set based methods. Based on this article, the pure stochastic level set algorithm has the best performance in most cases in terms of finding the most global solution. In comparison to other algorithms like Gradient Descent, Simulated Annealing, or a hybrid method called Multi-resolution Stochastic Level Set Method, the only drawback associated with the stochastic level set method is that it has no systematic procedure to control the random terms. As a result, this algorithm has to even search the solutions that significantly increase the cost function, thus slowing down the procedure. On the other hand, it is worth mentioning that although all of these algorithms employ stochastic operators in order to escape from local optima, finding the global solution is not yet guaranteed.

Unal et al. [32] presented some modifications to the active contour method to preserve certain features in images for noise removing purpose. These modifications consist of a tangential diffusion movement of the particles along the contour. This movement improves the original geometric approach to detect the sharp ends of the objects in the image without destroying the larger scale features.

Developing a special type of stochastic crystalline algorithm, Arous et al. [33] proposed a random particle system that evolves on a discretized unit circle. It has been shown that the stochastic evolution is convergent toward the deterministic baseline model. The baseline model for this article is the curve-shortening flows approach.

The problem of a global optimum point is one of the most challenging open problems in mathematics. Based on the existing algorithms in optimization theory, there are two main approaches to attacking the problem: using random operators and employing multi-individual (agents) based algorithms.

The first approach helps the procedure escape from the local optima it is trapped in, while the second one assists in the exploring of all feasible regions for a solution. Obviously, the more individuals (agents) are involved in the hunt, the higher the probability of finding the global optimum point. This point has been proven in all of the multi-individual (agent) based algorithms such as the GA and Particle Swarm optimization method (PSO), including multi-agent gradient-based methods [35].

Essentially, along with the aforementioned operators, an algorithm for convergence is also required. There is always a tendency for researchers to prove the convergence of their algorithm mathematically. In this regard, GA has a drawback in that there is no mathematical proof for its convergence. Even for PSO, the mathematical proofs cope with some simplified models. In level set, there is very strong mathematical proof, even in stochastic framework [27,28]. As long as some conditions are satisfied, the convergence of the stochastic level set method can be proven. Thus, for any further extension, one should ensure that the above-mentioned conditions are not violated.

In this article an extension to the stochastic level set method [12] is proposed in which a multi-agent-based random structure for Wiener random operator has been investigated. The main idea in escaping from the local edges is that the procedure starts with several agents (here, stochastic level set equations) that help the algorithms to explore the entire image. Each agent tries to segment the image based on its own stochastic algorithm. In addition, all of the agents are compelled to converge to the same topology.

Although the dynamic of each agent can be considered as a special case of the general spatial-dependent formulation in [12], the convergence of the stochastic equation is also proven in the present article. According to [37], the general equations derived in [27,28,12] are not necessarily convergent towards the solution of the deterministic part; the current extension in this article is. Obviously, the deterministic model is still very crucial for segmentation since the segmentation is defined by deterministic models and stochastic terms only help to find the best possible solution, so called global solution.

This article is organized as follows: Section 2 provides a brief background on edge-based, region-based formulation and stochastic level set method. Section 3 introduces the new algorithms and discusses their advantages with respect to other optimization methods. Section 4 investigates the results, and Section 5 provides a comprehensive conclusion.

The following section will provide a brief overview of edge-based level set method [7–9], re-formulation of LSM for Active Contours without edge [21–23], and stochastic level set method [12,1]. One way to address the segmentation problem is to find curve(s) or surface(s) that surround the region of interest in an image. Essentially, this is the primary idea behind active contours methods. However, in these algorithms, the curve(s) or surface(s) can be directly defined using control points, which can cause some issues in terms of the control points updating, merging, and splitting closed curve(s) or surface(s). Nevertheless, there are remedies for these issues, and level set method can easily cope with them. The concept behind the level set method is to embed the aforementioned curves in a surface, such that the evolution of the curve surrounding the objects in an image can be implicitly represented by the evolution of the surface. Fig. 1
                     a and b shows how a surface embedding a curve can be morphed in order to achieve a desired topology.

Implicit description of curves and surfaces is the main concept of the level set method. This capability allows the level set method to be used as a multi-dimensional tool to represent any complex topology. Changes in topology start from a zero level set or isophote as an initial guess, which continuously evolves through a Hamilton–Jacobi PDE formulation based on a certain cost function [7–9,18,19].

Let’s assume there is an implicit function, ϕ(x, t), in a given design domain, Ω, which satisfies
                           
                              (2)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ϕ
                                                   (
                                                   x
                                                   ,
                                                   t
                                                   )
                                                   >
                                                   0
                                                   ,
                                                
                                                
                                                   x
                                                   ∈
                                                   
                                                      
                                                         Ω
                                                      
                                                      
                                                         +
                                                      
                                                   
                                                   
                                                   Exterior
                                                
                                             
                                             
                                                
                                                   ϕ
                                                   (
                                                   x
                                                   ,
                                                   t
                                                   )
                                                   <
                                                   0
                                                   ,
                                                
                                                
                                                   x
                                                   ∈
                                                   
                                                      
                                                         Ω
                                                      
                                                      
                                                         -
                                                      
                                                   
                                                   
                                                   Interior
                                                
                                             
                                             
                                                
                                                   ϕ
                                                   (
                                                   x
                                                   ,
                                                   t
                                                   )
                                                   =
                                                   0
                                                   ,
                                                
                                                
                                                   x
                                                   ∈
                                                   ∂
                                                   Ω
                                                   
                                                   Boundaries
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        and also two other well-known Heaviside, H(s), and Dirac delta, δ(s), functions:
                           
                              (3)
                              
                                 H
                                 (
                                 s
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   s
                                                   ⩾
                                                   0
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   s
                                                   <
                                                   0
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (4)
                              
                                 δ
                                 (
                                 s
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   0
                                                
                                                
                                                   s
                                                   
                                                   ≠
                                                   
                                                   0
                                                
                                             
                                             
                                                
                                                   ∞
                                                
                                                
                                                   s
                                                   =
                                                   0
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The level set function is founded on the basis of the Hamilton–Jacobi equation [34]:
                           
                              (5)
                              
                                 
                                    
                                       ϕ
                                    
                                    
                                       t
                                    
                                 
                                 +
                                 
                                    
                                       V
                                    
                                    
                                       n
                                    
                                 
                                 |
                                 ∇
                                 ϕ
                                 |
                                 =
                                 0
                              
                           
                        The so-called V
                        
                           n
                         is known as a normal velocity of the evolving boundaries that control the speed evolution of the fronts, and ∣∇ϕ∣ is the amplitude of the gradient vector. Solving this partial differential equation starting from an initial guess transfers the segmentation problem to an initial value problem in PDE framework. A popular formulation [34] for V
                        
                           n
                         in Eq. (5) is as follows:
                           
                              (6)
                              
                                 ∇
                                 
                                    
                                       I
                                    
                                    
                                       G
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                I
                                             
                                             
                                                x
                                             
                                             
                                                G
                                             
                                          
                                          ,
                                          
                                             
                                                I
                                             
                                             
                                                y
                                             
                                             
                                                G
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (7)
                              
                                 
                                    
                                       V
                                    
                                    
                                       n
                                    
                                 
                                 =
                                 exp
                                 (
                                 -
                                 α
                                 |
                                 ∇
                                 
                                    
                                       I
                                    
                                    
                                       G
                                    
                                 
                                 |
                                 )
                              
                           
                        where I
                        
                           G
                         is the filtered image by a Gaussian filter G, α is the convergence rate V
                        
                           n
                         and 
                           
                              
                                 
                                    I
                                 
                                 
                                    x
                                 
                                 
                                    G
                                 
                              
                           
                         and 
                           
                              
                                 
                                    I
                                 
                                 
                                    y
                                 
                                 
                                    G
                                 
                              
                           
                         are the partial derivatives of Image, I, with respect to x and y respectively. As can be seen, V
                        
                           n
                         depends on a local gradient, which can lead to failure in inaccurate segmentation.

In the region-based LSM formulation, an energy functional contains the fitting energy and the energy associated with the length and the area of the initial contour 
                           
                              ∂
                              Ω
                              ,
                              ∂
                              Ω
                              ⊂
                              Ω
                              ,
                              ϕ
                              :
                              Ω
                              ⟶
                              R
                           
                         . This functional energy can be represented as follows [19–23]:
                           
                              (8)
                              
                                 E
                                 (
                                 ∂
                                 Ω
                                 )
                                 =
                                 
                                    
                                       F
                                    
                                    
                                       f
                                    
                                 
                                 +
                                 μ
                                 
                                    
                                       L
                                    
                                    
                                       ∂
                                       Ω
                                    
                                    
                                       p
                                    
                                 
                                 +
                                 υ
                                 
                                    
                                       A
                                    
                                    
                                       
                                          
                                             Ω
                                          
                                          
                                             -
                                          
                                       
                                    
                                 
                              
                           
                        where ∂Ω is the boundary of Ω, L
                        
                           ∂Ω
                         is the length of 
                           
                              ∂
                              Ω
                              ,
                              p
                              =
                              
                                 
                                    N
                                 
                                 
                                    N
                                    -
                                    1
                                 
                              
                              ,
                              N
                           
                         is the dimension of 
                           
                              
                                 
                                    R
                                 
                                 
                                    N
                                 
                              
                           
                        , and 
                           
                              
                                 
                                    A
                                 
                                 
                                    
                                       
                                          Ω
                                       
                                       
                                          -
                                       
                                    
                                 
                              
                           
                         is the area inside the ∂Ω.

The LSM as an optimization procedure will minimize the functional in Eq. (8) in order to segment the image. The fitting energy is defined as [19–23]:
                           
                              (9)
                              
                                 
                                    
                                       F
                                    
                                    
                                       f
                                    
                                 
                                 =
                                 
                                    
                                       F
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 ∂
                                 Ω
                                 )
                                 +
                                 
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 ∂
                                 Ω
                                 )
                                 =
                                 
                                    ∫
                                    
                                       
                                          
                                             Ω
                                          
                                          
                                             -
                                          
                                       
                                    
                                 
                                 |
                                 I
                                 -
                                 
                                    
                                       c
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       |
                                    
                                    
                                       2
                                    
                                 
                                 d
                                 Ω
                                 +
                                 
                                    ∫
                                    
                                       
                                          
                                             Ω
                                          
                                          
                                             +
                                          
                                       
                                    
                                 
                                 |
                                 I
                                 -
                                 
                                    
                                       c
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       |
                                    
                                    
                                       2
                                    
                                 
                                 d
                                 Ω
                              
                           
                        in which the c
                        1 and c
                        2 are the average of image I inside and outside of the ∂Ω, respectively.
                           
                              (10)
                              
                                 
                                    
                                       c
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 ϕ
                                 )
                                 =
                                 
                                    
                                       
                                          ∫
                                          
                                             Ω
                                          
                                       
                                       I
                                       
                                       (
                                       1
                                       -
                                       
                                          
                                             H
                                          
                                          
                                             ε
                                          
                                       
                                       (
                                       ϕ
                                       )
                                       )
                                       dx
                                       
                                       dy
                                    
                                    
                                       
                                          ∫
                                          
                                             Ω
                                          
                                       
                                       (
                                       1
                                       -
                                       
                                          
                                             H
                                          
                                          
                                             ε
                                          
                                       
                                       (
                                       ϕ
                                       )
                                       )
                                       dx
                                       
                                       dy
                                    
                                 
                              
                           
                        
                        
                           
                              (11)
                              
                                 
                                    
                                       c
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 ϕ
                                 )
                                 =
                                 
                                    
                                       
                                          ∫
                                          
                                             Ω
                                          
                                       
                                       I
                                       
                                       
                                          
                                             H
                                          
                                          
                                             ε
                                          
                                       
                                       (
                                       ϕ
                                       )
                                       dx
                                       
                                       dy
                                    
                                    
                                       
                                          ∫
                                          
                                             Ω
                                          
                                       
                                       
                                          
                                             H
                                          
                                          
                                             ε
                                          
                                       
                                       (
                                       ϕ
                                       )
                                       dx
                                       
                                       dy
                                    
                                 
                              
                           
                        
                     

To see how this formulation works, let us look at the following four options in Fig. 2
                        .

As can be seen, the fitting function is always positive except in a case where the evolving curve completely fits the objects in the image, and functional F
                        
                           f
                         is at its global minimum. Therefore, it can be claimed that minimization of the cost function leads to segmentation of the image. It is known that the steady state solution of Hamilton–Jacobi PDE, Eq. (1), is the optimum solution of the segmentation problem [7–9]. The Hamilton–Jacobi PDE can be re-written in Eq. (12) 
                        [19–23]:
                           
                              (12)
                              
                                 
                                    
                                       ∂
                                       ϕ
                                    
                                    
                                       ∂
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       δ
                                    
                                    
                                       ε
                                    
                                 
                                 (
                                 ϕ
                                 )
                                 
                                    
                                       
                                          μ
                                          p
                                          
                                             
                                                
                                                   
                                                      
                                                         ∫
                                                         
                                                            Ω
                                                         
                                                      
                                                      
                                                         
                                                            δ
                                                         
                                                         
                                                            ε
                                                         
                                                      
                                                      (
                                                      ϕ
                                                      )
                                                      |
                                                      ∇
                                                      ϕ
                                                      |
                                                      d
                                                      Ω
                                                   
                                                
                                             
                                             
                                                p
                                                -
                                                1
                                             
                                          
                                          div
                                          
                                             
                                                
                                                   
                                                      
                                                         ∇
                                                         ϕ
                                                      
                                                      
                                                         |
                                                         ∇
                                                         ϕ
                                                         |
                                                      
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   -
                                                   υ
                                                   -
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         (
                                                         I
                                                         -
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         (
                                                         I
                                                         -
                                                         
                                                            
                                                               c
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where the following conditions are held:
                           
                              (13)
                              
                                 
                                    
                                       
                                          
                                             p
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∫
                                                            
                                                               Ω
                                                            
                                                         
                                                         
                                                            
                                                               δ
                                                            
                                                            
                                                               ε
                                                            
                                                         
                                                         (
                                                         ϕ
                                                         )
                                                         |
                                                         ∇
                                                         ϕ
                                                         |
                                                      
                                                   
                                                
                                                
                                                   p
                                                   -
                                                   1
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         δ
                                                      
                                                      
                                                         ε
                                                      
                                                   
                                                   (
                                                   ϕ
                                                   )
                                                
                                                
                                                   |
                                                   ∇
                                                   ϕ
                                                   |
                                                
                                             
                                             
                                                
                                                   ∂
                                                   ϕ
                                                
                                                
                                                   ∂
                                                   n
                                                
                                             
                                             =
                                             0
                                          
                                       
                                       
                                          
                                             
                                             on
                                             
                                             ∂
                                             Ω
                                          
                                       
                                    
                                    
                                       
                                          
                                             ϕ
                                             (
                                             t
                                             ,
                                             x
                                             ,
                                             y
                                             )
                                             =
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   0
                                                
                                             
                                             (
                                             x
                                             ,
                                             y
                                             )
                                          
                                       
                                       
                                          
                                             
                                             in
                                             
                                             Ω
                                          
                                       
                                    
                                 
                              
                           
                        in which 
                           
                              υ
                              ,
                              μ
                              ,
                              
                                 
                                    λ
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    λ
                                 
                                 
                                    2
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    +
                                 
                              
                           
                         are fixed parameters, 
                           
                              n
                              ,
                              
                                 
                                    ∂
                                    ϕ
                                 
                                 
                                    ∂
                                    n
                                 
                              
                           
                         denotes the exterior vector normal to the boundary and the normal derivative of ϕrespectively, denotes boundary. δ
                        
                           ε
                        , H
                        
                           ε
                         are approximation for Dirac delta and Heaviside function as follows:
                           
                              (14)
                              
                                 
                                    
                                       δ
                                    
                                    
                                       ε
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       π
                                    
                                 
                                 
                                    
                                       ε
                                    
                                    
                                       
                                          
                                             ε
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (15)
                              
                                 
                                    
                                       H
                                    
                                    
                                       ε
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          1
                                          +
                                          
                                             
                                                2
                                             
                                             
                                                π
                                             
                                          
                                          arctan
                                          
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         ε
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        when ε is a tiny positive parameter and when ε
                        →0, these functions approach H(ϕ(x)), δ(ϕ (x)).

Stochastic differential equations (SDE) have been widely used in branches of studies such as biology, economics, finance, chemistry, MEMS and NEMS applications. Advanced probability and stochastic processes are the main prerequisites for complete understanding of SDE but this article will provide a very brief review on concepts. For more details, interested readers are encouraged to refer to more extensive sources such as [39,41,42]. Starting with the idea of Brownian motion, stochastic integration will be discussed as a key to solving the SDE. All the operators are defined in a standard probability space 
                           
                              (
                              ω
                              ,
                              F
                              ,
                              
                                 
                                    F
                                 
                                 
                                    t
                                 
                              
                              ,
                              P
                              )
                           
                        . For definitions of standard probability space and other introductory concepts, please refer to [39,41,42].

A common representation of stochastic differential equation is shown as [43]:
                              
                                 (16)
                                 
                                    
                                       
                                          dX
                                       
                                       
                                          t
                                       
                                    
                                    =
                                    G
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          t
                                       
                                    
                                    ,
                                    t
                                    )
                                    dt
                                    +
                                    H
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          t
                                       
                                    
                                    ,
                                    t
                                    )
                                    
                                       
                                          dW
                                       
                                       
                                          t
                                       
                                    
                                 
                              
                           where X
                           
                              t
                           
                           =
                           X
                           
                              t
                           (t) is a realization of the stochastic process. G(X
                           
                              t
                           , t) and H(X
                           
                              t
                           , t) are called drift and diffusion coefficient respectively. The drift coefficient is the deterministic part of the equation which determines the local trend of the process. Correspondingly the diffusion coefficient is the stochastic part of the coefficient that shows the average fluctuation of X
                           
                              t
                           . Assuming that the stochastic part obeys the necessary conditions for the Wiener process, one may be interested to solve the stochastic Eq. (16) in order to find at least one realization, X
                           
                              t
                           . To find the realization, one should integrate Eq. (16) as [43]:
                              
                                 (17)
                                 
                                    
                                       
                                          X
                                       
                                       
                                          t
                                       
                                    
                                    =
                                    
                                       
                                          X
                                       
                                       
                                          
                                             
                                                t
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    +
                                    
                                       ∫
                                       
                                          
                                             
                                                t
                                             
                                             
                                                0
                                             
                                          
                                       
                                       
                                          t
                                       
                                    
                                    G
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          s
                                       
                                    
                                    ,
                                    s
                                    )
                                    ds
                                    +
                                    
                                       ∫
                                       
                                          
                                             
                                                t
                                             
                                             
                                                0
                                             
                                          
                                       
                                       
                                          t
                                       
                                    
                                    H
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          s
                                       
                                    
                                    ,
                                    s
                                    )
                                    
                                       
                                          dW
                                       
                                       
                                          s
                                       
                                    
                                 
                              
                           The first integral in Eq. (17) is an ordinary Riemann integral. For the second integral, it should be noted that the Brownian processes are not differentiable. To cope with this situation, Ito, a Japanese mathematician, proposed the Ito Stochastic Integral in 1940, and 20years after that, a Russian physicist named R.L. Stratonovich suggested another stochastic integral to solve Eq. (16). To distinct between Ito and Stratonovich integrals, Stratonovich integral is usually shown by a specific operator “∘” [12].
                              
                                 (18)
                                 
                                    
                                       
                                          dX
                                       
                                       
                                          t
                                       
                                    
                                    =
                                    G
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          t
                                       
                                    
                                    ,
                                    t
                                    )
                                    dt
                                    +
                                    H
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          t
                                       
                                    
                                    ,
                                    t
                                    )
                                    ∘
                                    
                                       
                                          dW
                                       
                                       
                                          t
                                       
                                    
                                 
                              
                           and correspondingly the integral form can be represented as:
                              
                                 (19)
                                 
                                    
                                       
                                          X
                                       
                                       
                                          t
                                       
                                    
                                    =
                                    
                                       
                                          X
                                       
                                       
                                          
                                             
                                                t
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                    +
                                    
                                       ∫
                                       
                                          
                                             
                                                t
                                             
                                             
                                                0
                                             
                                          
                                       
                                       
                                          t
                                       
                                    
                                    G
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          s
                                       
                                    
                                    ,
                                    s
                                    )
                                    ds
                                    +
                                    
                                       ∫
                                       
                                          
                                             
                                                t
                                             
                                             
                                                0
                                             
                                          
                                       
                                       
                                          t
                                       
                                    
                                    H
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          s
                                       
                                    
                                    ,
                                    s
                                    )
                                    ∘
                                    
                                       
                                          dW
                                       
                                       
                                          s
                                       
                                    
                                 
                              
                           
                        

In general, the second integral can be reformulated as:
                              
                                 (20)
                                 
                                    
                                       ∫
                                       
                                          
                                             
                                                t
                                             
                                             
                                                0
                                             
                                          
                                       
                                       
                                          t
                                       
                                    
                                    H
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          s
                                       
                                    
                                    ,
                                    s
                                    )
                                    
                                       
                                          dW
                                       
                                       
                                          s
                                       
                                    
                                    =
                                    
                                       
                                          
                                             lim
                                          
                                          
                                             h
                                             →
                                             0
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             =
                                             0
                                          
                                          
                                             m
                                             -
                                             1
                                          
                                       
                                    
                                    H
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          
                                             
                                                τ
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          τ
                                       
                                       
                                          k
                                       
                                    
                                    )
                                    (
                                    W
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                    )
                                    -
                                    W
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          k
                                       
                                    
                                    )
                                    )
                                 
                              
                           in this equation h
                           =(t
                           
                              k+1
                           −
                           t
                           
                              k
                           ) with intermediary points τ
                           
                              k
                           
                           =(1−
                           λ)t
                           
                              k
                           
                           −
                           λt
                           
                              k+1, ∀ k
                           ∈{0,1,…,
                           m
                           −1}, λ
                           ∈[0,1]. Depending on how the parameters of λ are defined, different integrals are introduced. The instance of λ
                           =0 results in τ
                           
                              k
                           
                           =
                           t
                           
                              k
                           , meaning that the integral is evaluated at the start point of each interval. This method is called the Ito integral. Additionally, λ
                           =1/2 gives τ
                           
                              k
                           
                           =(t
                           
                              k+1
                           −
                           t
                           
                              k
                           )/2, which corresponds to the Stratonovich integral [43].

The Ito integral is usually employed in financial mathematics wherein only the information about the past is taken into account for modeling. In contrast, Stratonovich is very common in physical science modeling. Based on the aforementioned formulation, the Ito integral can be written as follows:
                              
                                 (21)
                                 
                                    
                                       ∫
                                       
                                          0
                                       
                                       
                                          T
                                       
                                    
                                    H
                                    (
                                    s
                                    )
                                    
                                       
                                          dW
                                       
                                       
                                          s
                                       
                                    
                                    =
                                    
                                       
                                          
                                             lim
                                          
                                          
                                             h
                                             →
                                             0
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             =
                                             0
                                          
                                          
                                             m
                                             -
                                             1
                                          
                                       
                                    
                                    H
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          k
                                       
                                    
                                    )
                                    (
                                    W
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                    )
                                    -
                                    W
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          k
                                       
                                    
                                    )
                                    )
                                 
                              
                           
                        

Similarly, in the case of Stratonovich, the next two integrals can be employed. The equality of these two integrals is proven [12].
                              
                                 (22)
                                 
                                    
                                       ∫
                                       
                                          0
                                       
                                       
                                          T
                                       
                                    
                                    H
                                    (
                                    s
                                    )
                                    ∘
                                    
                                       
                                          dW
                                       
                                       
                                          s
                                       
                                    
                                    =
                                    
                                       
                                          
                                             lim
                                          
                                          
                                             h
                                             →
                                             0
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             =
                                             0
                                          
                                          
                                             m
                                             -
                                             1
                                          
                                       
                                    
                                    H
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         k
                                                         +
                                                         1
                                                      
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    (
                                    W
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                    )
                                    -
                                    W
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          k
                                       
                                    
                                    )
                                    )
                                 
                              
                           
                           
                              
                                 (23)
                                 
                                    
                                       ∫
                                       
                                          0
                                       
                                       
                                          T
                                       
                                    
                                    H
                                    (
                                    s
                                    )
                                    ∘
                                    
                                       
                                          dW
                                       
                                       
                                          s
                                       
                                    
                                    =
                                    
                                       
                                          
                                             lim
                                          
                                          
                                             h
                                             →
                                             0
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             =
                                             0
                                          
                                          
                                             m
                                             -
                                             1
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   H
                                                   (
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   )
                                                   +
                                                   H
                                                   (
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         k
                                                         +
                                                         1
                                                      
                                                   
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    (
                                    W
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                    )
                                    -
                                    W
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          k
                                       
                                    
                                    )
                                    )
                                 
                              
                           
                        

According to Eq. (16), the modeling of stochastic processes is generally, based on a deterministic term (drift) and a stochastic term (diffusion). In stochastic flow modeling or curve evolution, the deterministic term can be shown as G
                           =
                           G(D
                           2
                           ϕ, Dϕ, x, t) in which ϕ is an implicit representation of the curve or surface, D is the gradient operator and D
                           2 denotes the Hessian matrix. The general form of a fully nonlinear stochastic partial differential equation in 
                              
                                 
                                    
                                       R
                                    
                                    
                                       N
                                    
                                 
                                 ×
                                 (
                                 0
                                 ,
                                 ∞
                                 )
                              
                            is [27,28] is:
                              
                                 (24)
                                 
                                    d
                                    ϕ
                                    =
                                    G
                                    (
                                    
                                       
                                          D
                                       
                                       
                                          2
                                       
                                    
                                    ϕ
                                    ,
                                    D
                                    ϕ
                                    ,
                                    x
                                    ,
                                    t
                                    )
                                    dt
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             m
                                          
                                       
                                    
                                    
                                       
                                          H
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    D
                                    ϕ
                                    ,
                                    x
                                    ,
                                    t
                                    )
                                    
                                       
                                          dW
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    x
                                    ,
                                    t
                                    )
                                 
                              
                           
                        

In a special case, stochastic model for curve evolution has been proposed as follows [12]:
                              
                                 (25)
                                 
                                    d
                                    ϕ
                                    =
                                    G
                                    (
                                    
                                       
                                          D
                                       
                                       
                                          2
                                       
                                    
                                    ϕ
                                    ,
                                    D
                                    ϕ
                                    ,
                                    x
                                    ,
                                    t
                                    )
                                    dt
                                    +
                                    |
                                    D
                                    ϕ
                                    |
                                    dW
                                    (
                                    t
                                    )
                                 
                              
                           
                        

One may notice that in Eq. (25), the Ito operator has been chosen implicitly. Obviously, Eq. (25) in Stratonovich sense can be shown as:
                              
                                 (26)
                                 
                                    d
                                    ϕ
                                    =
                                    G
                                    (
                                    
                                       
                                          D
                                       
                                       
                                          2
                                       
                                    
                                    ϕ
                                    ,
                                    D
                                    ϕ
                                    ,
                                    x
                                    ,
                                    t
                                    )
                                    dt
                                    +
                                    |
                                    D
                                    ϕ
                                    |
                                    ∘
                                    dW
                                    (
                                    t
                                    )
                                 
                              
                           
                        

As can be seen in Eqs. (25), (26), all points have an extra random force (second term) that is not explicitly a function of position because it only depends on ∣Dϕ∣ and Brownian process, which is a function of time. A more flexible structure can be achieved by replacing the Brownian motion, W(t), by a colored spatial noise.
                              
                                 (27)
                                 
                                    W
                                    (
                                    x
                                    ,
                                    t
                                    )
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             m
                                          
                                       
                                    
                                    
                                       
                                          ψ
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    x
                                    )
                                    
                                       
                                          W
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    t
                                    )
                                 
                              
                           where 
                              
                                 
                                    
                                       ψ
                                    
                                    
                                       i
                                    
                                 
                                 :
                                 
                                    
                                       R
                                    
                                    
                                       N
                                    
                                 
                                 ⟶
                                 R
                              
                            are smooth functions with compact support. Thus, the final stochastic evolution model is as follows [12]:
                              
                                 (28)
                                 
                                    d
                                    ϕ
                                    =
                                    G
                                    (
                                    
                                       
                                          D
                                       
                                       
                                          2
                                       
                                    
                                    ϕ
                                    ,
                                    D
                                    ϕ
                                    ,
                                    x
                                    ,
                                    t
                                    )
                                    dt
                                    +
                                    |
                                    D
                                    ϕ
                                    |
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             m
                                          
                                       
                                    
                                    
                                       
                                          ψ
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    x
                                    )
                                    ∘
                                    
                                       
                                          dW
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    t
                                    )
                                 
                              
                           
                        

In order to simplify the model, one can use the same type of function ψ at different centers. For example, ψ
                           
                              i
                           (x)=
                           ψ(x
                           −
                           x
                           
                              i
                           ), where ψ can be a convenient regular function.

A rigorous mathematical convergence analysis has been conducted by Lion and Souganidis [27,28] in which the authors have suggested the notion of stochastic viscosity solution for fully nonlinear, second order, possibly degenerate stochastic partial differential equations. The main result in [27] is presented in Appendix B.

As can be seen, the theorem can only guarantee the convergence of Eq. (28) when ψ
                           
                              i
                           
                           =1 or basically when the noise is not spatial-dependent [12]. The general case of this theorem is still an open problem in stochastic partial differential equation theory. Recently however, more general cases have been studied and luckily, these new studies can support our modified version of the stochastic level set method presented in Section 3.1.1. These theorems were not available when Juan et al. [12] published their paper. The newer theorems will be discussed in detail in Section 3.1.1.

As stated earlier, in contrast to the Ito integral, Stratonovich formulation does not have an explicit numerical scheme because it does not only depend on left value in each time interval. For more clarification, if one assumes the simple evolution dϕ
                           =∣Dϕ∣∘
                           dW(t), the corresponding method for its implicit update scheme would be:
                              
                                 (29)
                                 
                                    
                                       
                                          ϕ
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          ϕ
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    |
                                    D
                                    
                                       
                                          ϕ
                                       
                                       
                                          i
                                       
                                    
                                    |
                                    +
                                    |
                                    D
                                    
                                       
                                          ϕ
                                       
                                       
                                          i
                                          +
                                          1
                                       
                                    
                                    |
                                    )
                                    Δ
                                    
                                       
                                          W
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                        

To avoid encountering implicit update formulation such as Eq. (29), let’s consider the following equation in Stratonovich sense:
                              
                                 (30)
                                 
                                    d
                                    ϕ
                                    =
                                    H
                                    (
                                    D
                                    ϕ
                                    ,
                                    x
                                    )
                                    ∘
                                    dW
                                    (
                                    t
                                    )
                                 
                              
                           
                        

A typical example for H(p, x), a real valued function in 
                              
                                 
                                    
                                       R
                                    
                                    
                                       N
                                    
                                 
                                 ×
                                 R
                              
                           , is H(p, x)=∣p∣ψ(x). Here ψ is any regular smooth function. The expanded form of Eq. (30) in Stratonovich sense [12] is:
                              
                                 (31)
                                 
                                    d
                                    ϕ
                                    =
                                    H
                                    (
                                    D
                                    ϕ
                                    ,
                                    x
                                    )
                                    dW
                                    (
                                    t
                                    )
                                    +
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    d
                                    〈
                                    H
                                    (
                                    D
                                    ϕ
                                    ,
                                    x
                                    )
                                    ,
                                    W
                                    〉
                                    (
                                    t
                                    )
                                 
                              
                           
                        

This expansion shows that Stratonovich term is actually Ito term plus an additional term called drift.

The drift term, second term, can be obtained as follows [12]:
                              
                                 (32)
                                 
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    〈
                                    H
                                    (
                                    D
                                    ϕ
                                    ,
                                    x
                                    )
                                    ,
                                    W
                                    (
                                    t
                                    )
                                    〉
                                    (
                                    t
                                    )
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       ∫
                                       
                                          0
                                       
                                       
                                          t
                                       
                                    
                                    [
                                    
                                       
                                          D
                                       
                                       
                                          p
                                       
                                    
                                    H
                                    ·
                                    (
                                    
                                       
                                          D
                                       
                                       
                                          2
                                       
                                    
                                    ϕ
                                    
                                       
                                          D
                                       
                                       
                                          p
                                       
                                    
                                    H
                                    )
                                    +
                                    
                                       
                                          D
                                       
                                       
                                          p
                                       
                                    
                                    H
                                    ·
                                    
                                       
                                          D
                                       
                                       
                                          x
                                       
                                    
                                    H
                                    ]
                                    ds
                                 
                              
                           
                        

As it is assumed that H
                           =∣p∣ψ(x), the drift can be expanded to:
                              
                                 (33)
                                 
                                    〈
                                    H
                                    (
                                    D
                                    ϕ
                                    ,
                                    x
                                    )
                                    ,
                                    W
                                    (
                                    t
                                    )
                                    〉
                                    (
                                    t
                                    )
                                    =
                                    
                                       ∫
                                       
                                          0
                                       
                                       
                                          t
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   ψ
                                                
                                                
                                                   2
                                                
                                             
                                             (
                                             t
                                             )
                                             
                                                
                                                   D
                                                   ϕ
                                                
                                                
                                                   |
                                                   D
                                                   ϕ
                                                   |
                                                
                                             
                                             ·
                                             
                                                
                                                   D
                                                
                                                
                                                   2
                                                
                                             
                                             ϕ
                                             (
                                             x
                                             ,
                                             s
                                             )
                                             
                                                
                                                   D
                                                   ϕ
                                                
                                                
                                                   |
                                                   D
                                                   ϕ
                                                   |
                                                
                                             
                                             +
                                             ψ
                                             (
                                             x
                                             )
                                             D
                                             ψ
                                             (
                                             x
                                             )
                                             ·
                                             D
                                             ϕ
                                             (
                                             x
                                             ,
                                             s
                                             )
                                          
                                       
                                    
                                    ds
                                 
                              
                           
                        

The second order term in Eq. (33) can be simplified to [12]:
                              
                                 (34)
                                 
                                    
                                       
                                          D
                                          ϕ
                                       
                                       
                                          |
                                          D
                                          ϕ
                                          |
                                       
                                    
                                    ·
                                    
                                       
                                          D
                                       
                                       
                                          2
                                       
                                    
                                    ϕ
                                    (
                                    x
                                    ,
                                    s
                                    )
                                    
                                       
                                          D
                                          ϕ
                                       
                                       
                                          |
                                          D
                                          ϕ
                                          |
                                       
                                    
                                    =
                                    Δ
                                    ϕ
                                    -
                                    |
                                    D
                                    ϕ
                                    |
                                    
                                    div
                                    
                                       
                                          
                                             
                                                
                                                   D
                                                   ϕ
                                                
                                                
                                                   |
                                                   D
                                                   ϕ
                                                   |
                                                
                                             
                                          
                                       
                                    
                                    =
                                    Δ
                                    ϕ
                                    -
                                    |
                                    D
                                    ϕ
                                    |
                                    κ
                                 
                              
                           where “div” is divergence operator and κ is the mean curvature of level set. Eq. (33) is obtained based on this assumption that “m”, the number of Brownian motions, is 1. For a more general case in which the stochastic evolution PDE is of type:
                              
                                 (35)
                                 
                                    d
                                    ϕ
                                    =
                                    G
                                    (
                                    
                                       
                                          D
                                       
                                       
                                          2
                                       
                                    
                                    ϕ
                                    ,
                                    D
                                    ϕ
                                    ,
                                    x
                                    ,
                                    t
                                    )
                                    dt
                                    +
                                    |
                                    D
                                    ϕ
                                    |
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             m
                                          
                                       
                                    
                                    
                                       
                                          ψ
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    x
                                    )
                                    ∘
                                    
                                       
                                          dW
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    t
                                    )
                                 
                              
                           the expanded version of Eq. (35) can be represented as follows [12]:
                              
                                 (36)
                                 
                                    d
                                    ϕ
                                    =
                                    G
                                    (
                                    
                                       
                                          D
                                       
                                       
                                          2
                                       
                                    
                                    ϕ
                                    ,
                                    D
                                    ϕ
                                    ,
                                    x
                                    ,
                                    t
                                    )
                                    dt
                                    +
                                    |
                                    D
                                    ϕ
                                    |
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             m
                                          
                                       
                                    
                                    
                                       
                                          ψ
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    x
                                    )
                                    
                                       
                                          dW
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    t
                                    )
                                    +
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               i
                                                               =
                                                               1
                                                            
                                                            
                                                               m
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            ψ
                                                         
                                                         
                                                            i
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      (
                                                      x
                                                      )
                                                   
                                                
                                             
                                             (
                                             Δ
                                             ϕ
                                             -
                                             |
                                             D
                                             ϕ
                                             |
                                             κ
                                             )
                                             +
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               i
                                                               =
                                                               1
                                                            
                                                            
                                                               m
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            ψ
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      (
                                                      x
                                                      )
                                                      D
                                                      
                                                         
                                                            ψ
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      (
                                                      x
                                                      )
                                                   
                                                
                                             
                                             ·
                                             D
                                             ϕ
                                          
                                       
                                    
                                    dt
                                 
                              
                           
                        

One way to improve the chance of finding the global solution with an iterational minimization such as stochastic flows, is to only accept iterations that decrease the objective function. While it is good to escape from local optima, doing so may result in longer convergence time. One intermediate option is to accept iterations with higher objective functions by a slight chance that is exponentially related to how far the value of the current objective function is from the previous one. If the objective function is slightly higher than the previous iteration, it is more likely accepted than cases in which a big jump occurs and objective function increases dramatically. The combination of stochastic flows and annealing scheme is summarized in Table 1
                           . It should be noted that, just by employing the annealing scheme, there is still a chance of being stuck in a local optima when the process cannot find a better solution. Generally speaking, using delta function as weighting function in ACSF helps the active contour to have an independent source of noise at each point of the front, such that each point can find a better location at each iteration if possible.

In this scheme, Temp(i) is the annealing temperature, which is usually a monotically decreasing function of time (iteration). Here, this function is defined as:
                              
                                 (37)
                                 
                                    Temp
                                    (
                                    i
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                Temp
                                             
                                             
                                                0
                                             
                                          
                                       
                                       
                                          
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                           where i is the iteration number and i
                           =1⋯
                           N
                           
                              Itr
                            in which N
                           
                              Itr
                            is the maximum number of iterations.

One of the most important applications of stochastic partial differential equations is in image processing and segmentation [12]. By employing the stochastic level set method, fronts should be able to escape from local optima. However, the simulation shows that with small number of noise sources, it only works to capture the outer boundary of the features in the image. To improve the capability of the algorithm in bypassing the local edges, each point on the evolving curve should have an independent random jump. This independent jump is useful because during the process, each point on the front can move to a better position independently if possible (possibility will be determined by annealing scheme). Dependent source noise may create a situation in which only some points have this opportunity to select a better position, while other points on the front are forced to move to positions that are not necessarily better than before. This happens even if the overall objective function is finding its way toward a better value. By local edge, we are referring to situations where the evolving fronts are trapped at some locations and cannot evolve further. Additionally real edges are the edges that are detected by the algorithm and actually exist in the real image. It should be noted that, it is not a firm condition to escape from local solutions because the local edges are usually unstable (fake), the algorithm might be able to bypass the local edges by perturbing the edges,. In other cases, like Fig. 6d, although most of the detected edges are real, the algorithm fails to explore the entire image to detect all of the edges because it cannot evolve anymore.

One may argue that the final solution of ACWE can be improved in edge detection capability, by tuning the parameters in deterministic Eq. (8) or (12). This is especially true for μ, the coefficient of the length of evolving front. For example, the smaller the value of μ, the more details captured in the image. Nevertheless, in some cases like Fig. 6d, even if μ is set to zero, ACWE cannot detect entire strips on zebras’ bodies.

One way to perform this idea is to use the delta function as spatial weighting functions in Eq. (36). This way, each point over the front has an independent random jump. As the finite difference algorithm has been employed for numerical simulations, a delta function is assigned to every node on evolving contour. By substituting delta function and its derivative into Eq. (36), it can be re-written as Eq. (38) as long as ε is small enough.
                           
                              (38)
                              
                                 d
                                 ϕ
                                 =
                                 G
                                 (
                                 
                                    
                                       D
                                    
                                    
                                       2
                                    
                                 
                                 ϕ
                                 ,
                                 D
                                 ϕ
                                 ,
                                 x
                                 ,
                                 t
                                 )
                                 dt
                                 +
                                 |
                                 D
                                 ϕ
                                 |
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          l
                                          =
                                          1
                                       
                                       
                                          m
                                       
                                    
                                 
                                 
                                    
                                       δ
                                    
                                    
                                       ε
                                       ,
                                       l
                                    
                                 
                                 (
                                 x
                                 )
                                 
                                    
                                       dW
                                    
                                    
                                       l
                                    
                                 
                                 (
                                 t
                                 )
                                 +
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            l
                                                            =
                                                            1
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         δ
                                                      
                                                      
                                                         ε
                                                         ,
                                                         l
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   (
                                                   x
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                
                                                   Δ
                                                   ϕ
                                                   -
                                                   |
                                                   D
                                                   ϕ
                                                   |
                                                   κ
                                                
                                             
                                          
                                       
                                    
                                 
                                 dt
                                 +
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            l
                                                            =
                                                            1
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         δ
                                                      
                                                      
                                                         ε
                                                         ,
                                                         l
                                                      
                                                   
                                                   (
                                                   x
                                                   )
                                                   D
                                                   
                                                      
                                                         δ
                                                      
                                                      
                                                         ε
                                                         ,
                                                         l
                                                      
                                                   
                                                   (
                                                   x
                                                   )
                                                
                                             
                                          
                                          ·
                                          D
                                          ϕ
                                       
                                    
                                 
                                 dt
                              
                           
                        Here G(D
                        2
                        ϕ, Dϕ, x, t) is the deterministic model. This article uses the Chan–Vese model, Eq. (12), although any other model can be selected as well. Furthermore, m is the number of nodes on evolving contour that, by definition of ACSF, is equal to the number of the delta functions. δ
                        
                           ε,l
                        (x) is the Dirac delta function centered at lth node of the finite difference grid, l
                        =1⋯
                        m. An approximation for Dirac delta function with width of ε is represented in Eq. (39).
                           
                              (39)
                              
                                 
                                    
                                       δ
                                    
                                    
                                       ε
                                       ,
                                       l
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       π
                                    
                                 
                                 
                                    
                                       ε
                                    
                                    
                                       
                                          
                                             ε
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       
                                          
                                             (
                                             x
                                             -
                                             
                                                
                                                   x
                                                
                                                
                                                   l
                                                
                                             
                                             )
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Assuming ε
                        ≪
                        L
                        
                           e
                         where L
                        
                           e
                         is the minimum grid size, δ
                        
                           ε,l
                        (x) is almost zero in all nodes but lth node. Keeping this point in mind, Eq. (38). The original Eq. (28), can be rewritten in the following form:
                           
                              (40)
                              
                                 d
                                 ϕ
                                 =
                                 G
                                 (
                                 
                                    
                                       D
                                    
                                    
                                       2
                                    
                                 
                                 ϕ
                                 ,
                                 D
                                 ϕ
                                 ,
                                 x
                                 ,
                                 t
                                 )
                                 dt
                                 +
                                 D
                                 ϕ
                                 (
                                 x
                                 ,
                                 t
                                 )
                                 ·
                                 ϒ
                                 (
                                 x
                                 ,
                                 ε
                                 )
                                 ∘
                                 dW
                                 (
                                 t
                                 )
                              
                           
                        where ϒ
                        =[υ
                        
                           il
                        ] is a matrix of m
                        ×
                        m in which the entities are defined as:
                           
                              (41)
                              
                                 
                                    
                                       υ
                                    
                                    
                                       il
                                    
                                 
                                 =
                                 
                                    
                                       δ
                                    
                                    
                                       ε
                                       ,
                                       l
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 ,
                                 
                                 ∀
                                 i
                                 ,
                                 l
                                 =
                                 1
                                 ⋯
                                 m
                              
                           
                        
                     

One issue with this algorithm is that the edges continue wobbling for a relatively long time before the process reaches the steady state. As such, therefore an edge solidification expression should be added to the equation. An exponential term is employed here for this purpose. The modified equation is as follows:
                           
                              (42)
                              
                                 d
                                 ϕ
                                 =
                                 G
                                 (
                                 
                                    
                                       D
                                    
                                    
                                       2
                                    
                                 
                                 ϕ
                                 ,
                                 D
                                 ϕ
                                 ,
                                 x
                                 ,
                                 t
                                 )
                                 dt
                                 +
                                 
                                    
                                       e
                                    
                                    
                                       -
                                       
                                          
                                             t
                                          
                                          
                                             τ
                                          
                                       
                                    
                                 
                                 D
                                 ϕ
                                 (
                                 x
                                 ,
                                 t
                                 )
                                 ·
                                 ϒ
                                 (
                                 x
                                 ,
                                 ε
                                 )
                                 ∘
                                 dW
                                 (
                                 t
                                 )
                              
                           
                        in which 
                           
                              
                                 
                                    1
                                 
                                 
                                    τ
                                 
                              
                           
                         is the solidification rate and should be determined by trial and error to achieve better performance.

In the theorem proposed by Lion and Souganidis [27,28], the noise source has no spatial dependency. The general formulation in Eq. (36) is fully dependent on spatial terms represented by ψ
                           
                              i
                            functions. Basically, Theorem 4 cannot support any formulation with spatial-dependent noise. Eq. (42) obtains a simpler form which can luckily be supported by a recent theorem proposed by Caruana et al. in [37]. In spite of what is expected, it has been shown that in the presence of spatial term, the stochastic partial differential equation would not necessarily converge to the solution of the deterministic part. Although the form employed by [37] is not the general form, it can confirm that Theorem 4 is not valid for a general case where the spatial terms exist. To discuss the new theorem and its application in ACSF, some background information is required.

Given C
                              ∞-vector fields 
                                 
                                    
                                       
                                          H
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          H
                                       
                                       
                                          j
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    x
                                    )
                                    
                                       
                                          ∂
                                       
                                       
                                          ∂
                                          
                                             
                                                x
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                 
                              , 1⩽
                              i
                              ⩽
                              q on 
                                 
                                    
                                       
                                          R
                                       
                                       
                                          n
                                       
                                    
                                 
                              . Lets denote L(H
                              1,…,
                              H
                              
                                 q
                              ), the Lie sub-algebra of 
                                 
                                    I
                                    (
                                    
                                       
                                          R
                                       
                                       
                                          n
                                       
                                    
                                    )
                                 
                              , expanded by {H
                              1,…,
                              H
                              
                                 q
                              }. Here 
                                 
                                    I
                                    (
                                    
                                       
                                          R
                                       
                                       
                                          n
                                       
                                    
                                    )
                                 
                               is the Lie algebra of all C
                              ∞-vector fields on 
                                 
                                    
                                       
                                          R
                                       
                                       
                                          n
                                       
                                    
                                 
                              , in which the bracket product operator is defined as [45]:
                                 
                                    (43)
                                    
                                       [
                                       X
                                       ,
                                       Y
                                       ]
                                       =
                                       X
                                       ⊗
                                       Y
                                       -
                                       Y
                                       ⊗
                                       X
                                       ,
                                       
                                       X
                                       ,
                                       Y
                                       ∈
                                       I
                                       (
                                       
                                          
                                             R
                                          
                                          
                                             n
                                          
                                       
                                       )
                                    
                                 
                              This operator can be expanded as:
                                 
                                    (44)
                                    
                                       
                                          
                                             [
                                             X
                                             ,
                                             Y
                                             ]
                                          
                                          
                                             i
                                          
                                       
                                       =
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                k
                                                =
                                                1
                                             
                                             
                                                n
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      k
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            dY
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            dx
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                
                                                -
                                                
                                                   
                                                      Y
                                                   
                                                   
                                                      k
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            dX
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            dx
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                       where
                                       
                                       i
                                       ∈
                                       {
                                       1
                                       ,
                                       …
                                       ,
                                       q
                                       }
                                       ,
                                       
                                       q
                                       <
                                       n
                                    
                                 
                              Eq. (44) shows the ith entity of the vector field [X, Y].

A Lie algebra L is called Nilponent of step p if pth term of the series in Eq. (45) vanishes [45].
                                 
                                    (45)
                                    
                                       [
                                       L
                                       ,
                                       L
                                       ]
                                       ⊃
                                       [
                                       L
                                       ,
                                       [
                                       L
                                       ,
                                       L
                                       ]
                                       ]
                                       ⊃
                                       [
                                       L
                                       ,
                                       [
                                       L
                                       ,
                                       [
                                       L
                                       ,
                                       L
                                       ]
                                       ]
                                       ]
                                       ⊃
                                       ⋯
                                    
                                 
                              in which
                                 
                                    (46)
                                    
                                       ∀
                                       A
                                       ,
                                       B
                                       ⊂
                                       L
                                       :
                                       [
                                       A
                                       ,
                                       B
                                       ]
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                                [
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ]
                                                ;
                                                
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ∈
                                                A
                                                ,
                                                
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ∈
                                                B
                                                ,
                                                
                                                i
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                k
                                                ,
                                                
                                                k
                                                =
                                                1
                                                ,
                                                2
                                                ,
                                                …
                                             
                                          
                                       
                                    
                                 
                              
                           

In a paper by Caruana et al. [37] which was preceded by a set of papers by the last two authors [38,?], studied nonlinear parabolic evolution of the form ∂
                              
                                 t
                              
                              ϕ
                              =
                              G(D
                              2
                              ϕ, Dϕ, x, t) subject to noise of form H(Dϕ, x)∘
                              dB for linear H, with respect to Dϕ. As the authors stated this set of research is motivated by the work done by Lions and Souganidis [27,28] also mentioned in Theorem 4. To deal with the recent case, they proposed the use of rough path analysis suggested by Lyons [44]. The following theorem is the primary result of their work, which is very useful in the convergence analysis of ACSF.
                                 Theorem 1
                                 
                                    Let S
                                    
                                    =
                                    
                                    (S
                                    
                                       1
                                    
                                    ,
                                    …
                                    ,
                                    
                                    S
                                    
                                       m
                                    
                                    ) be a collection of C
                                    ∞
                                    -bounded vector fields on 
                                    
                                       
                                          
                                             
                                                R
                                             
                                             
                                                n
                                             
                                          
                                       
                                     
                                    and W a m-dimensional standard Brownian motions. Then, for every α
                                    
                                    =
                                    
                                    (α
                                    
                                       1
                                    
                                    ,
                                    …
                                    ,
                                    
                                    α
                                    
                                       N
                                    
                                    )
                                    ∈{1,
                                    …
                                    ,
                                    
                                    m}
                                       N
                                    
                                    , N
                                    ⩾
                                    2, there exist (piecewise) smooth approximations (z
                                    
                                       k
                                    
                                    ) to W, with each z
                                    
                                       k
                                     
                                    only dependent on {W(t): t
                                    ∈
                                    D
                                    
                                       k
                                    }, where D
                                    
                                       k
                                     
                                    is a sequence of dissection of [0, T] with mesh tending to zero, such that almost surely
                                    
                                       
                                          
                                             
                                                
                                                   z
                                                
                                                
                                                   k
                                                
                                             
                                             →
                                             W
                                             
                                             uniformly
                                             
                                             on
                                             
                                             [
                                             0
                                             ,
                                             T
                                             ]
                                          
                                       
                                    
                                    but u
                                    
                                       k
                                    
                                    , solution to
                                    
                                       
                                          (47)
                                          
                                             
                                                
                                                   
                                                   
                                                      
                                                         d
                                                         
                                                            
                                                               ϕ
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         =
                                                         G
                                                         (
                                                         
                                                            
                                                               D
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         
                                                            
                                                               ϕ
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         ,
                                                         D
                                                         
                                                            
                                                               ϕ
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         ,
                                                         x
                                                         ,
                                                         t
                                                         )
                                                         dt
                                                         -
                                                         D
                                                         
                                                            
                                                               ϕ
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         (
                                                         x
                                                         ,
                                                         t
                                                         )
                                                         ·
                                                         S
                                                         (
                                                         x
                                                         )
                                                         
                                                            
                                                               dz
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               ϕ
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                         (
                                                         0
                                                         ,
                                                         ·
                                                         )
                                                         =
                                                         
                                                            
                                                               ϕ
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                         ∈
                                                         BUC
                                                         (
                                                         
                                                            
                                                               R
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    converges almost surely locally uniformly to the solution of the “wrong” differential equation:
                                    
                                       
                                          (48)
                                          
                                             d
                                             ϕ
                                             =
                                             [
                                             G
                                             (
                                             
                                                
                                                   D
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   k
                                                
                                             
                                             ,
                                             D
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   k
                                                
                                             
                                             ,
                                             x
                                             ,
                                             t
                                             )
                                             -
                                             D
                                             ϕ
                                             (
                                             x
                                             ,
                                             t
                                             )
                                             ·
                                             
                                                
                                                   S
                                                
                                                
                                                   α
                                                
                                             
                                             (
                                             x
                                             )
                                             ]
                                             dt
                                             -
                                             D
                                             ϕ
                                             (
                                             x
                                             ,
                                             t
                                             )
                                             ·
                                             S
                                             (
                                             x
                                             )
                                             dW
                                          
                                       
                                    
                                    where S
                                    
                                       α
                                     
                                    is the bracket-vector field given by:
                                    
                                       
                                          
                                             
                                                
                                                   S
                                                
                                                
                                                   α
                                                
                                             
                                             =
                                             [
                                             
                                                
                                                   S
                                                
                                                
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             ,
                                             [
                                             
                                                
                                                   S
                                                
                                                
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             ,
                                             …
                                             ,
                                             [
                                             
                                                
                                                   S
                                                
                                                
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         N
                                                         -
                                                         1
                                                      
                                                   
                                                
                                             
                                             ,
                                             
                                                
                                                   S
                                                
                                                
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         N
                                                      
                                                   
                                                
                                             
                                             ]
                                             ]
                                             ]
                                             .
                                          
                                       
                                    
                                 

It can easily be shown that the preceding theorem is also valid when the Stratonovich differential ∘dW is replaced by dz for some 
                                       
                                          z
                                          ∈
                                          
                                             
                                                C
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          [
                                          0
                                          ,
                                          T
                                          ]
                                          ,
                                          
                                             
                                                R
                                             
                                             
                                                m
                                             
                                          
                                          )
                                       
                                    .

An outline of the proof for Theorem 1 and Remark 2 is available in [37]. Using this theorem and remark, one is able to verify the convergence of ACSF. The next section is devoted to the convergence analysis of ACSF.

A simple comparison between Eq. (40) defining the ACSF evolution equation and Eq. (47) in Theorem 1, shows that the equations have the same structure except that Eq. (40) is written in Stratonovich sense.

Considering Theorem 1 and Remark 2, one can conclude that assuming S(x)=−ϒ(x, ε), according to Theorem 1, the SPDE (42) will converge to a “wrong” differential equation such as:
                                 
                                    (49)
                                    
                                       d
                                       ϕ
                                       =
                                       (
                                       G
                                       (
                                       
                                          
                                             D
                                          
                                          
                                             2
                                          
                                       
                                       ϕ
                                       ,
                                       D
                                       ϕ
                                       ,
                                       x
                                       ,
                                       t
                                       )
                                       +
                                       D
                                       ϕ
                                       (
                                       x
                                       ,
                                       t
                                       )
                                       
                                          
                                             ϒ
                                          
                                          
                                             α
                                          
                                       
                                       (
                                       x
                                       ,
                                       ε
                                       )
                                       )
                                       dt
                                       +
                                       D
                                       ϕ
                                       (
                                       x
                                       ,
                                       t
                                       )
                                       ϒ
                                       (
                                       x
                                       ,
                                       ε
                                       )
                                       ∘
                                       dW
                                       (
                                       t
                                       )
                                    
                                 
                              where suppose ϒ
                              =[ϒ
                              1,…,
                              ϒ
                              
                                 m
                              ] then 
                                 
                                    
                                       
                                          ϒ
                                       
                                       
                                          α
                                       
                                    
                                    =
                                    [
                                    
                                       
                                          ϒ
                                       
                                       
                                          
                                             
                                                α
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    ,
                                    [
                                    
                                       
                                          ϒ
                                       
                                       
                                          
                                             
                                                α
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    ,
                                    …
                                    ,
                                    [
                                    
                                       
                                          ϒ
                                       
                                       
                                          
                                             
                                                α
                                             
                                             
                                                m
                                                -
                                                1
                                             
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          ϒ
                                       
                                       
                                          
                                             
                                                α
                                             
                                             
                                                m
                                             
                                          
                                       
                                    
                                    ]
                                    ]
                                    ]
                                 
                              , α
                              =(α
                              1,…,
                              α
                              
                                 m
                              )∈{1,…,
                              m}
                                 m
                              , which is basically a bracket-vector field made of Dirac delta functions and Lie bracket operator in Nilpotent fashion.

Now we want to show that in ACSF, ϒ
                              
                                 α
                               is always zero. In other words, the “wrong” differential equation becomes exactly the same as the initial equation, or the stochastic level set equation will converge to the solution of deterministic part, which is what we want.
                                 Theorem 3
                                 
                                    Given the stochastic differential Eq. 
                                    
                                       (40)
                                    
                                    , ACSF evolution equation converges to deterministic solution of Hamilton–Jacobi equation dϕ
                                    
                                    =
                                    
                                    G(D
                                    
                                       2
                                    
                                    ϕ, Dϕ, x, t)dt.
                                 

To proceed with the proof, lets focus on ϒ
                                    
                                       α
                                    . We claim that the Lie algebra, L, defined over 
                                       
                                          {
                                          
                                             
                                                ϒ
                                             
                                             
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          ,
                                          
                                             
                                                ϒ
                                             
                                             
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                ϒ
                                             
                                             
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      m
                                                      -
                                                      1
                                                   
                                                
                                             
                                          
                                          ,
                                          
                                             
                                                ϒ
                                             
                                             
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      m
                                                   
                                                
                                             
                                          
                                          }
                                       
                                     is Nilponent of step 1, or simply:
                                       
                                          (50)
                                          
                                             [
                                             
                                                
                                                   ϒ
                                                
                                                
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         m
                                                         -
                                                         1
                                                      
                                                   
                                                
                                             
                                             ,
                                             
                                                
                                                   ϒ
                                                
                                                
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                
                                             
                                             ]
                                             =
                                             0
                                             ,
                                             
                                             ∀
                                             
                                                
                                                   α
                                                
                                                
                                                   i
                                                
                                             
                                             ∈
                                             
                                                
                                                   {
                                                   1
                                                   ,
                                                   …
                                                   ,
                                                   m
                                                   }
                                                
                                                
                                                   m
                                                
                                             
                                          
                                       
                                    To show that this claim is true, lets recall Eqs. (41) and (44) for Dirac delta functions by which the expanded version of Lie bracket is defined.
                                       
                                          (51)
                                          
                                             
                                                
                                                   [
                                                   
                                                      
                                                         ϒ
                                                      
                                                      
                                                         
                                                            
                                                               α
                                                            
                                                            
                                                               m
                                                               -
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         ϒ
                                                      
                                                      
                                                         
                                                            
                                                               α
                                                            
                                                            
                                                               m
                                                            
                                                         
                                                      
                                                   
                                                   ]
                                                
                                                
                                                   i
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      l
                                                      =
                                                      1
                                                   
                                                   
                                                      m
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            υ
                                                         
                                                         
                                                            l
                                                            ,
                                                            
                                                               
                                                                  α
                                                               
                                                               
                                                                  m
                                                                  -
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            d
                                                            
                                                               
                                                                  υ
                                                               
                                                               
                                                                  i
                                                                  ,
                                                                  
                                                                     
                                                                        α
                                                                     
                                                                     
                                                                        m
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  dx
                                                               
                                                               
                                                                  l
                                                               
                                                            
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            υ
                                                         
                                                         
                                                            l
                                                            ,
                                                            
                                                               
                                                                  α
                                                               
                                                               
                                                                  m
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            d
                                                            
                                                               
                                                                  υ
                                                               
                                                               
                                                                  i
                                                                  ,
                                                                  
                                                                     
                                                                        α
                                                                     
                                                                     
                                                                        m
                                                                        -
                                                                        1
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  dx
                                                               
                                                               
                                                                  l
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      l
                                                      =
                                                      1
                                                   
                                                   
                                                      m
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            δ
                                                         
                                                         
                                                            ε
                                                            ,
                                                            l
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            
                                                               
                                                                  α
                                                               
                                                               
                                                                  m
                                                                  -
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                      )
                                                      
                                                         
                                                            d
                                                            
                                                               
                                                                  δ
                                                               
                                                               
                                                                  ε
                                                                  ,
                                                                  i
                                                               
                                                            
                                                            (
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  
                                                                     
                                                                        α
                                                                     
                                                                     
                                                                        m
                                                                     
                                                                  
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            
                                                               
                                                                  dx
                                                               
                                                               
                                                                  l
                                                               
                                                            
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            δ
                                                         
                                                         
                                                            ε
                                                            ,
                                                            l
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            
                                                               
                                                                  α
                                                               
                                                               
                                                                  m
                                                               
                                                            
                                                         
                                                      
                                                      )
                                                      
                                                         
                                                            d
                                                            
                                                               
                                                                  δ
                                                               
                                                               
                                                                  ε
                                                                  ,
                                                                  i
                                                               
                                                            
                                                            (
                                                            
                                                               
                                                                  x
                                                               
                                                               
                                                                  
                                                                     
                                                                        α
                                                                     
                                                                     
                                                                        m
                                                                        -
                                                                        1
                                                                     
                                                                  
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            
                                                               
                                                                  dx
                                                               
                                                               
                                                                  l
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    By investigation of Eq. (51), one can see that for each particular x, one of 
                                       
                                          δ
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      m
                                                      -
                                                      1
                                                   
                                                
                                             
                                          
                                          )
                                       
                                     or 
                                       
                                          δ
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      m
                                                   
                                                
                                             
                                          
                                          )
                                       
                                     is zero. This means that both terms inside the bracket in the last equation are zeros. Thus 
                                       
                                          
                                             
                                                [
                                                
                                                   
                                                      ϒ
                                                   
                                                   
                                                      
                                                         
                                                            α
                                                         
                                                         
                                                            m
                                                            -
                                                            1
                                                         
                                                      
                                                   
                                                
                                                ,
                                                
                                                   
                                                      ϒ
                                                   
                                                   
                                                      
                                                         
                                                            α
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                   
                                                
                                                ]
                                             
                                             
                                                i
                                             
                                          
                                       
                                    , an arbitrary element of 
                                       
                                          [
                                          
                                             
                                                ϒ
                                             
                                             
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      m
                                                      -
                                                      1
                                                   
                                                
                                             
                                          
                                          ,
                                          
                                             
                                                ϒ
                                             
                                             
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      m
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                     is always zero, and therefore the whole bracket in Eq. (50) is zero. It leads to this conclusion that the Lie algebra, L, is Nilponent of step 1. Based on this conclusion, the extra term in the deterministic part of the “wrong” Eq. (48) (second term in the bracket) compared to Eq. (40) is always zero for ACSF evolution. This can confirm that all of the performed simulations based on ACSF differential equations are at least a local solution of the original optimization problem.□

As discussed earlier, two approaches have been proposed in order to improve the performance of active contours in image segmentation: active contour without edges [19–23] and stochastic level set method [12,27,28]. The first approach omits the dependency of evolution of front on local image gradient, so it is very successful coping with the images corrupted with noise. However, in some cases the real edges within the image are barriers for evolution of active contour. A good example is the image shown in Fig. 6a. The strips on the zebras’ bodies prevent the contour from completely evolving and extracting the whole bodies. On the other hand, according to Theorem 1 from [37], the general model developed by [12] will converge to a “wrong” equation that is not the deterministic model. This is undesirable, since deterministic models are designed such that the optimization process converges to an accurate segmentation. Essentially, the stochastic algorithms should find the best solution of deterministic models.

Active Contour with Stochastic Fronts (ACSF) as a special case of model in [12], is an attempt to achieve all of the previously-mentioned advantages, while mitigating the flaws.

It uses both the formulation of region-based and the stochastic level set method. However, a simple but very effective change in order to extract all possible details within the image and outer boundaries. At the same time, the convergence of the resultant equation toward the deterministic solution is also guaranteed. In Section 4, this algorithm has been implemented and evaluated based on its effectiveness compared to the region-based level set method, Tables 2 and 3
                           
                           .

In global optimization theory, there are two main approaches to cope with local optima problems: stochastic operators and multi-agent systems. An interesting feature of the work in [12] is the combination of the stochastic operator with the level set method. This innovation creates a global optimization algorithm with the advantages of gradient-based methods. This section intends to use the second approach (multi-agent) while utilizing the advantages from the first approach. In doing so, instead of only one partial differential equation, a set of level set equations are employed. The main idea here is to make sure that the agents are capable of escaping from a local point. Therefore, instead of one H–J equation in Active Contour with Stochastic Front (ACSF), several SPDEs have been employed starting from different initial guesses. This can help the evolving front to escape from local edges when the stochastic term in Eq. (42) is not strong enough for this purpose.

Certainly, all of the agents have to converge to the best current topology. Namely, the leader has minimum energy, so the functional in Eq. (9) must be revised in order to make this condition. The revised equation is:
                           
                              (52)
                              
                                 
                                    
                                       F
                                    
                                    
                                       fj
                                    
                                 
                                 (
                                 ∂
                                 
                                    
                                       Ω
                                    
                                    
                                       l
                                    
                                 
                                 ,
                                 ∂
                                 
                                    
                                       Ω
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       F
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 ∂
                                 
                                    
                                       Ω
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 ∂
                                 
                                    
                                       Ω
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       lj
                                    
                                 
                                 
                                    
                                       F
                                    
                                    
                                       cj
                                    
                                 
                                 (
                                 ∂
                                 
                                    
                                       Ω
                                    
                                    
                                       l
                                    
                                 
                                 ,
                                 ∂
                                 
                                    
                                       Ω
                                    
                                    
                                       j
                                    
                                 
                                 )
                              
                           
                        where:
                           
                              (53)
                              
                                 
                                    
                                       F
                                    
                                    
                                       cj
                                    
                                 
                                 (
                                 ∂
                                 
                                    
                                       Ω
                                    
                                    
                                       l
                                    
                                 
                                 ,
                                 ∂
                                 
                                    
                                       Ω
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 =
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 (
                                 H
                                 (
                                 
                                    
                                       ϕ
                                    
                                    
                                       l
                                    
                                 
                                 )
                                 (
                                 1
                                 -
                                 H
                                 (
                                 
                                    
                                       ϕ
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 )
                                 +
                                 H
                                 (
                                 
                                    
                                       ϕ
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 (
                                 1
                                 -
                                 H
                                 (
                                 
                                    
                                       ϕ
                                    
                                    
                                       l
                                    
                                 
                                 )
                                 )
                                 )
                                 d
                                 Ω
                              
                           
                        The converging force F
                        
                           cj
                        (∂Ω
                        
                           l
                        , ∂Ω
                        
                           j
                        ) is simply a metric showing the region that is surrounded between the leader, lth agent and the agent jth, l
                        ≠
                        j, but does not include the intersection area. To achieve the same topology, the area of this region has to converge to zero. Fig. 3
                         shows the general surrounded area between the two agents, i and j. It is worth mentioning that although Eq. (52) is only written for two agents, (leader and an arbitrary individual), it can be employed for a system with any number of agents because the “converging force” is only applied between the leader and each individual. Obviously, the leader only evolves based on Eq. (12) and the converging force for this agent is equal to zero, F
                        
                           cl
                        (∂Ω
                        
                           l
                        , ∂Ω
                        
                           l
                        )=0.

As stated, the main problem in LSM, and in the stochastic level set method is that when the fronts converge to an edge, there is no guarantee that this edge is a real edge. Even if the edge is real, the segmentation may be stuck over that edge and cannot evolve to segment all of the features in the image. To increase the probability of finding a real edge, the zero level sets should start from different parts of the feasible region; consequently, a multi-agent system can overcome this problem.

In level set method, it is very common that one employs an initial level set such that it has enough holes in it. As the level set method is unable to make a new hole, having sufficient holes in the initial level set is crucial. It might seem that a stochastic level set method with multiple holes in initial guess, such as in Fig. 4
                           
                           , is a multi-agent stochastic system by itself, and there is no need for using a complicated system like the one we have proposed in this article. To clarify the difference between an ACSF algorithm initiated with a multiple holes zero level set and the multi-agent structure proposed here, one should notice that every single node on the front in the first case evolves independently. As such optimum solution for this case is similar to a case where one runs a gradient based optimization procedure with different initial guesses, resulting in each agent finding its own local optimum points. However, in the latter case because the agents are forced to finally converge to the same shape, the probability of finding the real edges in the image is higher than the first case. This is similar to the convergence of individuals in multi-agent optimization algorithms such as GA, PSO, and/or SBFO [35], in which each agent starts from different initial guess but they are all supposed to converge to the best possible solution. This approach is more probable to find the global solution than cases where each agent only finds its local solution depending upon the initial condition that it starts with. This point has been demonstrated by an example in Section 4.

In addition, using a multi-agent system helps to explore the whole feasible region, which clearly increases the chances of finding the global solution. Although the computational cost of this algorithm is higher than the previous ones, it can be performed in a decentralized fashion, since each agent evolves almost independently based on its own dynamics. Compared to other multi-individual optimization algorithms like GA or PSO, the convergence should be faster because this algorithm is an extension of a gradient-based algorithm called SBFO [35] to the variational framework.

In contradiction to GA, PSO, etc., the number of tunning parameters are extremely low, specifically the number of agents and weighting parameter λ
                           
                              lj
                            in Eq. (52).

@&#RESULTS@&#

To evaluate the procedures, a set of benchmark images have been selected, including a nature scene, Fig. 6
                     a, and some medical images [see Tables 2–5
                     
                     ]. The set of medical images is provided by [36]. This collection is a very good source of benchmark images for evaluation of segmentation algorithms. For this article, 10 images of cancerous breast tissues are selected.

Region-based level set, stochastic level set, active contour with stochastic fronts and multi-agent stochastic level set methods are applied to the first image and Fig. 6a to depict the performance of each algorithm. According to the results, Figs. 6b and 7
                     c, one can come to the conclusion that the multi-agent stochastic level set method has the best performance. The performance is defined based on Eq. (9).

The level set method is capable of finding the details within the image, but it gets stuck over some edges, leading to incomplete segmentation, as is Fig. 6d. The stochastic level set method usually finds a few details within the image, but is almost always able to find the outer boundaries. The results presented in Fig. 6b, Fig. 7c are achieved when five noise sources are considered for the stochastic level set method. It is worth mentioning that, as stochastic operators are used, each of the algorithms do not exactly converge to the same segmentation for different simulations. However, the latter algorithm (MSLSM) has far less deviation because the segmentation is very close to the, global solution, complete segmentation.

Depending on the selection of the solidification rate, the proposed algorithm may be able to find the outer and inner boundaries. However, it is a problem regarding compromise. Hence, the smaller the solidification rate, the longer the convergence time and the higher the probability to find more details that exist in the image. On the other hand, even a single stochastic LSM may be able to segment the benchmark image completely, but this does not always occur. For example, in Fig. 7a, the rear legs of both zebras are not segmented in single stochastic method.

Moreover, even by using a multi-agent system, there are some cases where the procedure cannot segment accurately. Therefore, we can only discuss the probability of finding the best segmentation (or global solution) that can be improved by increasing the number of agents to be the same as the number of individuals in Genetic Algorithm, or agents in Particle Swarm optimization methods. Obviously, there is a trade-off between computational cost and accuracy of solution. As expected in Fig. 7c, the steady state solutions of both agents converge to a single value because of the term F
                     
                        cj
                     (∂Ω
                     
                        l
                     , ∂Ω
                     
                        j
                     ) in Eq. (52). As mentioned, based on Fig. 7c, the best performance is achieved by MSLSM. The performance of the stochastic level set method is even worse than region-based level set method in terms of the ability to find details in the image.

In practical image processing, and in particular medical image processing and segmentation, an algorithm that is capable of finding details within the image is required. For example, in images in Tables 2–5, one should be able to find the cancerous cells within the breast tissues. Thus, the algorithms proposed in this article are evaluated based on this set of images and compared with the region-based level set to determine the performance. The relative improvement with respect to region-based LSM is given in the fourth column of each of the Tables 2–5. For a fair comparison, initial guesses for all simulations are the same for all algorithms, except that the multi-agent structure employs another initial guess. Both of these initial conditions are shown in Fig. 5.

The percentage of relative improvement of performance in the fourth columns of Tables 2–5 are calculated based on the ground truth image provided by [36]. Each ground truth image has precisely shown the cancerous cells in a portion of the image, called Ω
                     
                        G
                     . Thus, the calculation should be done based that area only.

The performance, P
                     
                        f
                     , of each algorithm is defined as a sum square error between values of dots (0 or 1) in Ω
                     
                        G
                      of the ground truth image, I
                     
                        G
                     , and the corresponding area in the segmented image, I
                     
                        S
                     , by each algorithm. Note that the ground truth images provided by [36] are not fully recovered images, and only a portion of the images is investigated.
                        
                           (54)
                           
                              
                                 
                                    P
                                 
                                 
                                    f
                                 
                              
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             p
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    (
                                    
                                       
                                          I
                                       
                                       
                                          G
                                       
                                    
                                    (
                                    i
                                    )
                                    -
                                    
                                       
                                          I
                                       
                                       
                                          S
                                       
                                    
                                    (
                                    i
                                    )
                                    )
                                 
                                 
                                    2
                                 
                              
                           
                        
                     where N
                     
                        p
                      is the total number of pixels in ground truth area.

@&#CONCLUSION@&#

Extending the work done by Juan et al. [12], this article investigated Active Contour with Stochastic Front (ACSF) and a multi-agent random structure called Multi-agent Stochastic Level Set (MSLSM). The ACSF, a natural extension of the stochastic level set method, emerges as a well-founded algorithm to represent the stochastic motion of fronts coping with local optima problems. Despite its capability in this regard, there are still some instances where ACSF is not able to find the global solution. A multi-agent structure is thus proposed in this article in order to improve the algorithm. In this method, and similar to the stochastic active contours method, each agent evolves based on its own stochastic dynamics developed in Section 3.1.

The random structure proposed in this article is significantly effective in helping the algorithm escape from local minima and becomes even more competent when utilized by multi-agent structure. Starting from different initial guesses assists the latter algorithm in exploring the feasible region, helping to find every possible feature in the image. Ultimately, all of the agents must converge on the same topology. To do so, one should add a metric to the original functional given in Eq. (9). The results, for example in Fig. 7c, show that, as expected, the multi-agent stochastic level set method is more capable of finding the global solution.

As can be seen in Tables 2–5, both ACSF and MSLSM have significant improvements compared to Region-Based LSM. MSLSM employed two agents. Contrary to what is expected, the relative improvement of MSLSM is not very considerable with respect to ACSF. This is because the ACSF can find most of the cancerous cells within the image, so the relative improvement of MSLSM is not remarkable compared to ACSF. In other words, ACSF with a zero level set presented in Fig. 4 is strong enough to segment the selected images. However, in some cases that ACSF cannot segment the image accurately, MSLSM can help to overcome this problem. For the examples studied here, a structure with 2 agents seems to be capable enough to detect almost all of the cancerous cells in the images, so there is no point in increasing the number of agents to three or more.

It is worth mentioning that what this article defines as global optimum algorithm is somewhat different from what is meant by Bresson et al. [24] in their work. The capability of edge indication of our algorithm is limited to the deterministic model we chose as our baseline (here ACWE), and it cannot be claimed that the algorithm is more capable (compared to ACWE or any other base model we choose) to find the edges with low contrast. One common issue that occurs in segmentation by Active Contours is that depending on the initial guess, some parts of the image will not be discovered by the algorithm especially when there are lots of details in the image, such as application in the medical imaging of breast cancerous tissues Tables 2–5. The reason of this is, once the algorithm finds some parts of the real edges of the image, and all active boundaries are busy with real edges, it will not evolve to detect other edges. This is because if it wants to evolve to detect other features, it should leave a local solution where the deterministic level set method is not able to do so. As the active contour only evolves based on gradient flow; the gradient flow for this current topology is towards the local solution. The first example of our paper is designed to show this concept. As can be seen, the stripes in the zebras bodies are real edges, but the ACWE algorithm is stuck and cannot evolve further to detect all of the stripes. If one runs the algorithm for another initial guess that is located in the region that is not discovered by the first trial, we might be able to detect other stripes. However, it will again be stuck in another solution. The idea behind multi-agent structure is to have an algorithm that discovers all parts of the image. In the best case scenario, each agent can pull out the other agents from their own local solutions, and at the end the whole image is discovered. Stochastic operators can also help to jump from local solutions to discover the whole image, so a combination of these two tools provides a higher probability to detect every single object in an image. If one chooses the baseline model proposed by Bresson et al.[24] with multi-agent ACSF proposed in this paper, the final result is a very sophisticated algorithm that cannot only detect the low contrast edges, but can also detect most of the features in the image.

@&#ACKNOWLEDGMENTS@&#

The authors would like to acknowledge the financial support of Natural Sciences and Research Council of Canada (NSERC) and Ontario Centers of Excellence (OCE).

A standard m-dimensional Brownian motion or standard Wiener process, over [0, T] is a random vector W(t)=[W
                     1(t),…,
                     W
                     
                        m
                     (t)]
                        t⩾0 that is a continuous function of time t
                     ∈[0, T] and satisfies the conditions as follows [40]:
                        
                           1.
                           
                              W(0)=0 (almost sure or with probability 1).

Given by increment W(t)−
                              W(s), for 0⩽
                              s
                              <
                              t
                              ⩽
                              T, the random variable vector has a normal distribution with mean zero and variance t
                              −
                              s; in other words 
                                 
                                    (
                                    W
                                    (
                                    t
                                    )
                                    -
                                    W
                                    (
                                    s
                                    )
                                    )
                                    ∼
                                    
                                       
                                          (
                                          t
                                          -
                                          s
                                          )
                                       
                                    
                                    N
                                    (
                                    0
                                    ,
                                    1
                                    )
                                 
                              , where N(0,1) is a symbol for normally distributed random variable with zero mean and unit variance.

The increments W(t)−
                              W(s) and W(v)−
                              W(u) are independent, ∀ 0⩽
                              s
                              <
                              t
                              <
                              u
                              <
                              v
                              ⩽
                              T.

In addition to these conditions Brownian motion has some other properties such as [43]:
                        
                           1.
                           
                              W(t) has continuous paths (
                                 
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                 
                              -holder continuous).


                              W(t) is nowhere differentiable.

Accumulated variation for this process is infinity, on any finite interval 
                                 
                                    L
                                    ⊂
                                    [
                                    0
                                    ,
                                    T
                                    ]
                                 
                              , meaning that:
                                 
                                    (A.1)
                                    
                                       
                                          
                                             Sup
                                          
                                          
                                             L
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                n
                                             
                                          
                                       
                                       |
                                       W
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       -
                                       W
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             i
                                             -
                                             1
                                          
                                       
                                       )
                                       |
                                       =
                                       ∞
                                    
                                 
                              
                           

For the sake of simplicity since now, we suppose that m
                     =1 unless otherwise stated.

The following theorem is the main result in [27].
                        Theorem 4
                        
                           Consider the following two equations:
                           
                              
                                 (B.1)
                                 
                                    d
                                    ϕ
                                    =
                                    G
                                    (
                                    
                                       
                                          D
                                       
                                       
                                          2
                                       
                                    
                                    ϕ
                                    ,
                                    D
                                    ϕ
                                    ,
                                    x
                                    ,
                                    t
                                    )
                                    dt
                                    +
                                    ∊
                                    |
                                    D
                                    ϕ
                                    |
                                    ∘
                                    dW
                                    (
                                    t
                                    )
                                    
                                    with
                                    
                                    ϕ
                                    (
                                    ·
                                    ,
                                    0
                                    )
                                    =
                                    
                                       
                                          ϕ
                                       
                                       
                                          0
                                       
                                    
                                    (
                                    ·
                                    )
                                 
                              
                           
                           
                              
                                 (B.2)
                                 
                                    d
                                    ϕ
                                    =
                                    G
                                    (
                                    
                                       
                                          D
                                       
                                       
                                          2
                                       
                                    
                                    ϕ
                                    ,
                                    D
                                    ϕ
                                    ,
                                    x
                                    ,
                                    t
                                    )
                                    dt
                                    +
                                    |
                                    D
                                    ϕ
                                    |
                                    
                                       
                                          
                                             
                                                ξ
                                             
                                             
                                                α
                                             
                                          
                                       
                                       
                                          ̇
                                       
                                    
                                    (
                                    t
                                    )
                                    
                                    with
                                    
                                    ϕ
                                    (
                                    ·
                                    ,
                                    0
                                    )
                                    =
                                    
                                       
                                          ϕ
                                       
                                       
                                          0
                                       
                                    
                                    (
                                    ·
                                    )
                                 
                              
                           where ∊
                           ⩾0 and 
                              
                                 
                                    
                                       ξ
                                    
                                    
                                       α
                                    
                                 
                                 :
                                 
                                    
                                       R
                                    
                                    
                                       +
                                    
                                 
                                 →
                                 R
                              
                            is a family of smooth functions. It is “Almost Surely” true that in ω:
                              
                                 1.
                                 Eq. (B.1) 
                                    has a unique solution.
                                 


                                    Assuming {ξ
                                    
                                       α
                                    
                                    (t)}
                                       α>0
                                     
                                    and {ζ
                                    
                                       β
                                    
                                    (t)}
                                       β>0
                                     
                                    are two families of smooth functions in such a way that if α and β
                                    →
                                    0, then ξ
                                    
                                       α
                                     
                                    and ζ
                                    
                                       β
                                     
                                    converge to W uniformly on any compact set in t and almost surely in ω. Let {u
                                    
                                       α
                                    }
                                       α>0
                                     
                                    and {v
                                    
                                       β
                                    }
                                       β>0
                                     
                                    in 
                                    
                                       
                                          BUC
                                          (
                                          
                                             
                                                R
                                             
                                             
                                                +
                                             
                                          
                                          ×
                                          
                                             
                                                R
                                             
                                             
                                                N
                                             
                                          
                                          )
                                       
                                    
                                    , namely a Bounded Uniformly Continuous subset of 
                                    
                                       
                                          
                                             
                                                R
                                             
                                             
                                                +
                                             
                                          
                                          ×
                                          
                                             
                                                R
                                             
                                             
                                                N
                                             
                                          
                                       
                                    
                                    , be the solution of Eq. 
                                    (B.1). Now, suppose that 
                                    
                                       
                                          
                                             
                                                lim
                                             
                                             
                                                α
                                                ,
                                                β
                                                →
                                                0
                                             
                                          
                                          ‖
                                          
                                             
                                                u
                                             
                                             
                                                α
                                             
                                          
                                          (
                                          ·
                                          ,
                                          0
                                          )
                                          -
                                          
                                             
                                                v
                                             
                                             
                                                β
                                             
                                          
                                          (
                                          ·
                                          ,
                                          0
                                          )
                                          
                                             
                                                ‖
                                             
                                             
                                                C
                                                (
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      N
                                                   
                                                
                                                )
                                             
                                          
                                          =
                                          0
                                       
                                    
                                    , then for all T
                                    >
                                    0, 
                                    
                                       
                                          
                                             
                                                lim
                                             
                                             
                                                α
                                                ,
                                                β
                                                →
                                                0
                                             
                                          
                                          ‖
                                          
                                             
                                                u
                                             
                                             
                                                α
                                             
                                          
                                          -
                                          
                                             
                                                v
                                             
                                             
                                                β
                                             
                                          
                                          
                                             
                                                ‖
                                             
                                             
                                                C
                                                (
                                                [
                                                0
                                                ,
                                                T
                                                ]
                                                ×
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      N
                                                   
                                                
                                                )
                                             
                                          
                                          =
                                          0
                                       
                                    
                                    . In other words, any smooth approximation of W makes a series of solutions converging to the unique solution of 
                                    (B.1).


                                    The solution u
                                    
                                       ∊
                                     
                                    of 
                                    (B.2) 
                                    is convergent to the solution of 
                                    (B.1) 
                                    in 
                                    
                                       
                                          C
                                          (
                                          
                                             
                                                R
                                             
                                             
                                                +
                                             
                                          
                                          ×
                                          
                                             
                                                R
                                             
                                             
                                                N
                                             
                                          
                                          )
                                       
                                     
                                    when ∊
                                    →
                                    0.
                                 

@&#REFERENCES@&#

