@&#MAIN-TITLE@&#Tracking multiple interacting targets in a camera network

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We propose a tracker for multiple interacting targets in a camera network.


                        
                        
                           
                           A model is developed to decide the group state of each trajectory.


                        
                        
                           
                           The tracking problem is converted to a network flow problem.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Multi-camera tracking

Multi-target tracking

Interacting targets

Wide-area camera network

Network flow

@&#ABSTRACT@&#


               
               
                  In this paper we propose a framework for tracking multiple interacting targets in a wide-area camera network consisting of both overlapping and non-overlapping cameras. Our method is motivated from observations that both individuals and groups of targets interact with each other in natural scenes. We associate each raw target trajectory (i.e., a tracklet) with a group state, which indicates if the trajectory belongs to an individual or a group. Structural Support Vector Machine (SSVM) is applied to the group states to decide if merge or split events occur in the scene. Information fusion between multiple overlapping cameras is handled using a homography-based voting scheme. The problem of tracking multiple interacting targets is then converted to a network flow problem, for which the solution can be obtained by the K-shortest paths algorithm. We demonstrate the effectiveness of the proposed algorithm on the challenging VideoWeb dataset in which a large amount of multi-person interaction activities are present. Comparative analysis with state-of-the-art methods is also shown.
               
            

@&#INTRODUCTION@&#

Multi-target tracking in a camera network, although attractive to researchers for a long time [1,2], still remains challenging. In particular, large illumination variations across cameras, cluttered scenarios and a camera network with both overlapping and non-overlapping views pose impediments to traditional tracking algorithms. Moreover, multiple cameras require computing associations between detected targets in different views, which can also be a challenging task. In this paper, we propose a novel camera network tracking scheme, called Switching Network Tracker (SNT), for tracking of multiple interacting targets in a cluttered camera network scene with both overlapping and non-overlapping views.

Our scheme is motivated by natural scenes as shown in Fig. 1
                     , where people interact with each other in a camera network. We see that people often congregate together in a way where it may be difficult to individually detect them, and these congregations might split either within the view of an individual camera, or in the blind areas between non-overlapping cameras. When an individual target cannot be detected, we can still get an estimate of the target’s state by tracking the group into which it merged. Therefore, it is necessary to design a tracking scheme for camera networks, which integrates group tracking and individual tracking, and switches smoothly between the two to generate robust individual tracks.

Besides, a wide-area camera network usually consists of both overlapping and non-overlapping views. In order for a tracking scheme to obtain long and stable tracks for every target within and across cameras, both overlapping and non-overlapping views should be addressed. For overlapping views, cooperation among cameras is necessary to improve the system performance. For non-overlapping views, different illumination conditions and the unknown behaviors in blind area between cameras should be taken into consideration in order to obtain a stable tracking system.

There are a few works which systematically address the problem of multi-target tracking in camera networks with both overlapping and non-overlapping views. The papers [3,4] extended the recent multi-target tracking framework in [5,6] to a non-overlapping camera network application. Detections of a person are associated to form a short but robust track, the so called tracklet, for this person. However, the problem of tracking targets in a cluttered scene with a large number of interacting activities has not been addressed in these works. The works in [7,8] addressed the tracking problem in overlapping views with a similar tracklet association scheme, but clutter due to people grouping together was not addressed.

The proposed SNT is designed to handle a cluttered scene with multiple interacting targets. Specifically, the SNT can track individuals and groups simultaneously in a camera network. Individuals are tracked in uncluttered scenes where single targets can be clearly detected, whereas the groups are tracked for cluttered environment where individual target detection is inaccurate or infeasible with state-of-the-art detectors. We assign each detected region with a group state to define if the region is associated with a group or an individual. In order to identify a group state of a detected region, a Structural Support Vector Machine (SSVM) model is constructed, upon local features of each target and the relationships between targets, to determine the merging and splitting events occurring in the scene. In the operational phase of the system, detections that can be associated with high confidence lead to the formation of tracklets. Each tracklet is assigned with a group state by the learned SSVM based on all associated observations from cameras with overlapping views. Then, a homography based target state estimation methodology is applied to fuse tracklets in overlapping views. With the consistent tracking results on overlapping views, the problem of tracking multiple interacting targets in a camera network is formulated as a network flow problem. We show that such a problem can be converted to a mixed integer programming problem and the K-shortest paths algorithm [9,10] is used to obtain the optimal solution.

In the experiments, we work on the VideoWeb dataset [11], which is a publicly available camera network dataset with both overlapping and non-overlapping camera views. To the best of our knowledge, we deal with a far more complex multi-camera scenario than previous works that have looked into this problem [3,4,7,12], in terms of the number of cameras, targets, their actions, and camera fields of view. We demonstrate the effectiveness of our tracking algorithm with thorough test results.

@&#RELATED WORKS@&#

We briefly review the most relevant papers on tracking in camera networks so as to better explain the contribution of the proposed approach. In general, tracking in a camera network can be divided into two parts: tracking in a non-overlapping camera network and tracking in an overlapping camera network.

In the first category, [13] is one of the early works on non-overlapping multi-camera tracking, in which appearance relationships between cameras were used to establish correspondence. The work in [14] learned a camera network topology and path probabilities of objects. Many works focused on spatio-temporal cues to solve the tracking problem. Ref. [15] investigated the unsupervised learning of a model of trajectories based on the activity information. Ref. [16] used a stochastic transition matrix to describe motions between cameras. Similarly, [17,18] proposed new transition distributions based on statistical dependence between observations in different cameras. The work of [1,2,12] learned the brightness transfer functions (BTFs) either online or offline between cameras. Ref. [4] learned an appearance affinity model between two non-overlapping cameras online. Some recent works on tracking in non-overlapping camera views combine both appearance information and spatio-temporal cues together to achieve better results. Refs. [3,19] proposed an optimization framework by combining short term feature correspondences across the cameras with the long-term feature dependency models. Ref. [20] did not use the spatio-temporal cues in multi camera scenarios, but instead investigated directional angles using the spatio-temporal continuity in a single camera field. However, most of these works failed to handle a high clutter scene.

In the second category (overlapping views), most works used systems with calibrated cameras. Ref. [7] projected all the blobs in different cameras onto the ground plane and then performed standard feature association algorithms. Ref. [8] used a similar method but developed a greedy matching algorithm which can achieve results similar to the Hungarian algorithm but with less computation. Ref. [21] determined spatial positions by transforming images based on a ground plane homography. Ref. [22] estimated a ground plane occupancy map to track people by their 2D segmentations in each camera. Ref. [23] exploited both dynamical and geometrical constraints to improve robustness to occlusion. Ref. [24] explored a distributed estimation strategy for tracking and data association.

Tracking methods utilizing group information have been studied in single camera tracking schemes. In the work of [25–27], group information worked as a constraint to improve individual tracking performance. The algorithm in [28] jointly modeled individual and group information. Ref. [29,30] proposed the problem of group tracking with a descriptor of appearance features. Ref. [31] exploited the social force between two pedestrians to associate groups of people. However, none of these works used two classes of trackers that could freely track groups and individuals simultaneously to obtain robust tracks for every target. Person re-identification [32] is another method which finds the one to one correspondences between targets in different cameras. However, no group information is used in such an application, and person re-identification datasets are more constrained than what we deal with in this work.

Our work has three main contributions:
                           
                              1.
                              We propose a novel tracking framework – SNT – for camera networks. The SNT is designed to generate robust and long individual tracks, even in cluttered scenes, by tracking both individuals and groups simultaneously depending on the degree of clutter in the scenes.

We design an SSVM that integrates spatial and temporal relationships between tracklets to detect group formation and splitting in a camera network. With the merging and splitting events, group states of tracklets can be better determined, which is significant for the smooth switching between individual and groups across cameras.

A general tracklet association algorithm is developed for both overlapping and non-overlapping scenes. We introduce group nodes to the standard min-cost network flow problem and modify the problem accordingly to handle multiple interacting targets in a camera network. An approach based on linear programming is proposed to solve the modified network flow problem.

As interactions between targets may lead to a situation where individuals cannot be detected separately, a group model is needed. We are also interested in the merge and split activities of the group so as to obtain a long track for each target.

In the traditional definition of a group [5,25], a tracklet is seen in a group when there is at least one nearby tracklet within the same time window. Corner features were commonly used to cluster the trajectories into groups [33,34], while [35] performed group detection based on tracklets. We use the tracklets as the inputs of our group detector, while the corner features provided additional cues in case of missing detections. Following the method in [6,36], we use the particle filter to associate detections into tracklets. We train an SVM classifier [37] upon the features of the bounding boxes. Note that the group detector is not the focus of our work and can be replaced by any advanced group detector. Three classification scores (named group states g) are obtained: individual (0), group (1) and others (2). 
                        
                           g
                           =
                           2
                        
                      is needed to deal with situations when it is not clear if an individual or group is detected, which can happen when groups merge or split.

There are three possible group events between two group states: merge, split, and stable. The input of the group model is a set of tracklets in camera 
                        
                           
                              
                                 C
                              
                              
                                 m
                              
                           
                           ;
                           
                              
                                 T
                              
                              
                                 
                                    
                                       C
                                    
                                    
                                       m
                                    
                                 
                              
                           
                           =
                           
                              
                                 
                                    
                                       
                                          T
                                       
                                       
                                          1
                                       
                                       
                                          
                                             
                                                C
                                             
                                             
                                                m
                                             
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          T
                                       
                                       
                                          2
                                       
                                       
                                          
                                             
                                                C
                                             
                                             
                                                m
                                             
                                          
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          T
                                       
                                       
                                          i
                                       
                                       
                                          
                                             
                                                C
                                             
                                             
                                                m
                                             
                                          
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          T
                                       
                                       
                                          N
                                       
                                       
                                          
                                             
                                                C
                                             
                                             
                                                m
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     , where N is the total number of tracklets in 
                        
                           
                              
                                 C
                              
                              
                                 m
                              
                           
                        
                     . We consider tracklets 
                        
                           
                              
                                 T
                              
                              
                                 i
                              
                              
                                 
                                    
                                       C
                                    
                                    
                                       m
                                    
                                 
                              
                           
                        
                      and 
                        
                           
                              
                                 T
                              
                              
                                 j
                              
                              
                                 
                                    
                                       C
                                    
                                    
                                       m
                                    
                                 
                              
                           
                        
                      from different times, where 
                        
                           
                              
                                 T
                              
                              
                                 j
                              
                              
                                 
                                    
                                       C
                                    
                                    
                                       m
                                    
                                 
                              
                           
                        
                      starts after 
                        
                           
                              
                                 T
                              
                              
                                 i
                              
                              
                                 
                                    
                                       C
                                    
                                    
                                       m
                                    
                                 
                              
                           
                        
                      ends and the start time of 
                        
                           
                              
                                 T
                              
                              
                                 j
                              
                              
                                 
                                    
                                       C
                                    
                                    
                                       m
                                    
                                 
                              
                           
                        
                      minus the end time of 
                        
                           
                              
                                 T
                              
                              
                                 i
                              
                              
                                 
                                    
                                       C
                                    
                                    
                                       m
                                    
                                 
                              
                           
                        
                      is within a threshold. The group event label y, evaluated over the two time windows, is defined as
                        
                           (1)
                           
                              y
                              
                                 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             i
                                          
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   m
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             T
                                          
                                          
                                             j
                                          
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   m
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                0
                                                ,
                                             
                                             
                                                if
                                                
                                                no
                                                
                                                event
                                                ,
                                             
                                          
                                          
                                             
                                                1
                                                ,
                                             
                                             
                                                if
                                                
                                                merge
                                                
                                                events
                                                
                                                detected
                                                ,
                                             
                                          
                                          
                                             
                                                2
                                                ,
                                             
                                             
                                                if
                                                
                                                split
                                                
                                                events
                                                
                                                detected
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

As discussed above, if 
                        
                           g
                           =
                           2
                        
                      for a tracklet, we need to learn if the tracklet is in a merge/split event. We propose a novel group event learning method which can jointly estimate the group event labels of a set of tracklets. A structural SVM model that integrates motion features with various context features is developed for this purpose. In the most of this section, we drop 
                        
                           
                              
                                 C
                              
                              
                                 m
                              
                           
                        
                      from the notation of a tracklet because the group event detection is performed in every single camera view.

To detect the group state of a tracklet, both spatial context features and temporal context features are needed. This is because a tracklet’s group state change depends on the spatial relationship between this tracklet and other tracklets. A merge/split event also depends on the temporal relationship between two tracklets, i.e., an individual merges to a group over time. A tracklet i’s motion features include the average size, the position on the first and last frame, and the moving speed. A motion feature descriptor of tracklet i is represented as 
                           
                              [
                              
                                 
                                    W
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    H
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    Y
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          x
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          s
                                       
                                       
                                          y
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              ]
                           
                        . We use W and H to represent the average width and height of a tracklet between its first and last frame, and use X and Y to represent the average horizontal and vertical positions of a tracklet on the image plane between its first and last frame. 
                           
                              
                                 
                                    s
                                 
                                 
                                    x
                                 
                              
                           
                         and 
                           
                              
                                 
                                    s
                                 
                                 
                                    y
                                 
                              
                           
                         denote the average moving speed of the tracklet in horizontal and vertical directions.


                        Spatial context feature descriptor: Given a time window 
                           
                              
                                 
                                    N
                                 
                                 
                                    T
                                 
                              
                           
                        , the spatial context feature is the spatial relationship between the interested tracklet and the nearby tracklets. 
                           
                              
                                 
                                    RS
                                 
                                 
                                    ij
                                 
                              
                              (
                              n
                              )
                           
                         and 
                           
                              
                                 
                                    RT
                                 
                                 
                                    ij
                                 
                              
                              (
                              n
                              )
                           
                         are the spatial and temporal relationships of 
                           
                              
                                 
                                    T
                                 
                                 
                                    i
                                 
                              
                           
                         and 
                           
                              
                                 
                                    T
                                 
                                 
                                    j
                                 
                              
                           
                         at frame n. The spatial relationship between these two tracklets is defined as the normalized histogram 
                           
                              
                                 
                                    RS
                                 
                                 
                                    ij
                                 
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          T
                                       
                                    
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    n
                                    =
                                    1
                                 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          T
                                       
                                    
                                 
                              
                              
                              
                                 
                                    RS
                                 
                                 
                                    ij
                                 
                              
                              (
                              n
                              )
                           
                        , where 
                           
                              
                                 
                                    N
                                 
                                 
                                    T
                                 
                              
                           
                         is the number of frames in the time window. 
                           
                              
                                 
                                    RS
                                 
                                 
                                    ij
                                 
                              
                              (
                              n
                              )
                           
                         represents the distance between 
                           
                              
                                 
                                    T
                                 
                                 
                                    i
                                 
                              
                           
                         and 
                           
                              
                                 
                                    T
                                 
                                 
                                    j
                                 
                              
                           
                         at frame n. In practice, 
                           
                              
                                 
                                    RS
                                 
                                 
                                    ij
                                 
                              
                              (
                              n
                              )
                           
                         depends on the motion features of the tracklets. The distance between two tracklets 
                           
                              
                                 
                                    T
                                 
                                 
                                    i
                                 
                              
                           
                         and 
                           
                              
                                 
                                    T
                                 
                                 
                                    j
                                 
                              
                           
                         at frame n is 
                           
                              
                                 
                                    d
                                 
                                 
                                    n
                                 
                              
                              (
                              
                                 
                                    T
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    T
                                 
                                 
                                    j
                                 
                              
                              )
                              =
                              
                                 
                                    
                                       
                                          (
                                          
                                             
                                                X
                                             
                                             
                                                i
                                             
                                          
                                          (
                                          n
                                          )
                                          -
                                          
                                             
                                                X
                                             
                                             
                                                j
                                             
                                          
                                          (
                                          n
                                          )
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          (
                                          
                                             
                                                Y
                                             
                                             
                                                i
                                             
                                          
                                          (
                                          n
                                          )
                                          -
                                          
                                             
                                                Y
                                             
                                             
                                                j
                                             
                                          
                                          (
                                          n
                                          )
                                          )
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                        . The spatial context feature descriptor between 
                           
                              
                                 
                                    T
                                 
                                 
                                    i
                                 
                              
                           
                         and 
                           
                              
                                 
                                    T
                                 
                                 
                                    j
                                 
                              
                           
                         at frame n is defined as
                           
                              (2)
                              
                                 
                                    
                                       RS
                                    
                                    
                                       ij
                                    
                                 
                                 (
                                 n
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         [
                                                         1
                                                         
                                                         0
                                                         
                                                         0
                                                         ]
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   ,
                                                
                                                
                                                   if
                                                   
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   )
                                                   <
                                                   
                                                      min
                                                   
                                                   {
                                                   
                                                      
                                                         W
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   (
                                                   n
                                                   )
                                                   ,
                                                   
                                                      
                                                         W
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   (
                                                   n
                                                   )
                                                   ,
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   (
                                                   n
                                                   )
                                                   ,
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   (
                                                   n
                                                   )
                                                   }
                                                   ,
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         [
                                                         0
                                                         
                                                         0
                                                         
                                                         1
                                                         ]
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   ,
                                                
                                                
                                                   if
                                                   
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   (
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   )
                                                   >
                                                   2
                                                   ×
                                                   
                                                      min
                                                   
                                                   {
                                                   
                                                      
                                                         W
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   (
                                                   n
                                                   )
                                                   ,
                                                   
                                                      
                                                         W
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   (
                                                   n
                                                   )
                                                   ,
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   (
                                                   n
                                                   )
                                                   ,
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   (
                                                   n
                                                   )
                                                   }
                                                   ,
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         [
                                                         0
                                                         
                                                         1
                                                         
                                                         0
                                                         ]
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   ,
                                                
                                                
                                                   otherwise
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     


                        Temporal context feature descriptor: The SNT will not switch the tracking mode until a merge or split event is detected. The temporal relationship between merge/split events and the group states g is considered in the tracking system. There are 5 attribute subsets between two tracklets at two consecutive time windows. The attribute subset definitions can be found in Table 1
                        . If any attribute 
                           
                              
                                 
                                    A
                                 
                                 
                                    i
                                 
                              
                           
                         is satisfied, the corresponding attribute is 1 while the others are 0. 
                           
                              
                                 
                                    A
                                 
                                 
                                    i
                                 
                              
                           
                         is determined by the tracklets’ group states g and the feature descriptors of the tracklets. Note that the potential merge/split events are determined based on the average size change of the tracklets and become cues for the final label of these group events. The average size change cues include the number of persons as well as the size of the group on the image plane. If the number of persons does not change while the size of the group on the image plane has a significant change, there is a high possibility that the person detector missed some persons in the crowded scene. The normalized histogram 
                           
                              
                                 
                                    RT
                                 
                                 
                                    ij
                                 
                              
                           
                         is the temporal context feature of tracklet 
                           
                              
                                 
                                    T
                                 
                                 
                                    i
                                 
                              
                           
                         with respect to tracklet 
                           
                              
                                 
                                    T
                                 
                                 
                                    j
                                 
                              
                           
                        . We define 
                           
                              
                                 
                                    RT
                                 
                                 
                                    ij
                                 
                              
                           
                         as a 5-bin histogram, an example of which is shown in Fig. 2
                        .

Given all the features of tracklets, the goal is to detect the merge or split events. A set of tracklets 
                           
                              T
                           
                         is associated with a label vector 
                           
                              y
                              =
                              {
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                              }
                              ,
                              
                              i
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              N
                           
                        , where 
                           
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                              ∈
                              {
                              0
                              ,
                              1
                              ,
                              2
                              }
                           
                         is the group event label vector of 
                           
                              
                                 
                                    T
                                 
                                 
                                    i
                                 
                              
                           
                        . We infer the group states of the tracklets set from the combination of various context features discussed above. Define 
                           
                              
                                 
                                    D
                                 
                                 
                                    RS
                                 
                              
                           
                         and 
                           
                              
                                 
                                    D
                                 
                                 
                                    RT
                                 
                              
                           
                         as the dimensions of 
                           
                              
                                 
                                    RS
                                 
                                 
                                    ij
                                 
                              
                           
                         and 
                           
                              
                                 
                                    RT
                                 
                                 
                                    ij
                                 
                              
                           
                        . A potential function between features of 
                           
                              T
                           
                         and label y is defined as 
                           
                              F
                              (
                              T
                              ,
                              y
                              )
                           
                        :
                           
                              (3)
                              
                                 F
                                 (
                                 T
                                 ,
                                 y
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                          ,
                                          j
                                          =
                                          1
                                          ,
                                          i
                                          ≠
                                          j
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                 
                                    
                                       w
                                    
                                    
                                       RS
                                       ,
                                       (
                                       
                                          
                                             y
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       RS
                                    
                                    
                                       ij
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                          ,
                                          j
                                          =
                                          1
                                          ,
                                          i
                                          ≠
                                          j
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                 
                                    
                                       w
                                    
                                    
                                       RT
                                       ,
                                       (
                                       
                                          
                                             y
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             y
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       RT
                                    
                                    
                                       ij
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    RS
                                 
                                 
                                    ij
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    
                                       
                                          D
                                       
                                       
                                          RS
                                       
                                    
                                 
                              
                           
                         and 
                           
                              
                                 
                                    RT
                                 
                                 
                                    ij
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    
                                       
                                          D
                                       
                                       
                                          RT
                                       
                                    
                                 
                              
                           
                         are the spatial and temporal context feature descriptors associated with tracklet 
                           
                              
                                 
                                    T
                                 
                                 
                                    i
                                 
                              
                           
                         and 
                           
                              
                                 
                                    T
                                 
                                 
                                    j
                                 
                              
                           
                         respectively. 
                           
                              
                                 
                                    w
                                 
                                 
                                    RS
                                    ,
                                    (
                                    
                                       
                                          y
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    
                                       
                                          D
                                       
                                       
                                          RS
                                       
                                    
                                 
                              
                           
                         and 
                           
                              
                                 
                                    w
                                 
                                 
                                    RT
                                    ,
                                    (
                                    
                                       
                                          y
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          y
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    
                                       
                                          D
                                       
                                       
                                          RT
                                       
                                    
                                 
                              
                           
                         are the weights that capture the spatial and temporal relationships of group event classes 
                           
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                           
                         and 
                           
                              
                                 
                                    y
                                 
                                 
                                    j
                                 
                              
                           
                        . N is the number of tracklets.

The potential function 
                           
                              F
                              (
                              T
                              ,
                              y
                              )
                           
                         can be converted to a linear function with a parameter vector w. Define 
                           
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                           
                         the label vector of the corresponding tracklet 
                           
                              
                                 
                                    T
                                 
                                 
                                    i
                                 
                              
                           
                        . We first rewrite Eq. (3) as:
                           
                              (4)
                              
                                 F
                                 (
                                 T
                                 ,
                                 y
                                 )
                                 =
                                 
                                    
                                       w
                                    
                                    
                                       RS
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                          ,
                                          j
                                          =
                                          1
                                          ,
                                          i
                                          ≠
                                          j
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                 ψ
                                 (
                                 
                                    
                                       RS
                                    
                                    
                                       ij
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       w
                                    
                                    
                                       RT
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                          ,
                                          j
                                          =
                                          1
                                          ,
                                          i
                                          ≠
                                          j
                                       
                                       
                                          N
                                       
                                    
                                 
                                 
                                 ϕ
                                 (
                                 
                                    
                                       RT
                                    
                                    
                                       ij
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       j
                                    
                                 
                                 )
                              
                           
                        where 
                           
                              
                                 
                                    w
                                 
                                 
                                    RS
                                 
                              
                           
                         and 
                           
                              
                                 
                                    w
                                 
                                 
                                    RT
                                 
                              
                           
                         are weight vectors and defined as
                           
                              
                                 
                                    
                                       w
                                    
                                    
                                       RS
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   w
                                                
                                                
                                                   RS
                                                   ,
                                                   (
                                                   1
                                                   ,
                                                   1
                                                   )
                                                
                                                
                                                   T
                                                
                                             
                                             
                                             ⋯
                                             
                                                
                                                   w
                                                
                                                
                                                   RS
                                                   ,
                                                   (
                                                   1
                                                   ,
                                                   N
                                                   )
                                                
                                                
                                                   T
                                                
                                             
                                             
                                             ⋯
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   RS
                                                   ,
                                                   (
                                                   N
                                                   ,
                                                   N
                                                   )
                                                
                                                
                                                   T
                                                
                                             
                                          
                                       
                                    
                                    
                                       T
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       w
                                    
                                    
                                       RT
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   w
                                                
                                                
                                                   RT
                                                   ,
                                                   (
                                                   1
                                                   ,
                                                   1
                                                   )
                                                
                                                
                                                   T
                                                
                                             
                                             
                                             ⋯
                                             
                                                
                                                   w
                                                
                                                
                                                   RT
                                                   ,
                                                   (
                                                   1
                                                   ,
                                                   N
                                                   )
                                                
                                                
                                                   T
                                                
                                             
                                             
                                             ⋯
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   RT
                                                   ,
                                                   (
                                                   N
                                                   ,
                                                   N
                                                   )
                                                
                                                
                                                   T
                                                
                                             
                                          
                                       
                                    
                                    
                                       T
                                    
                                 
                                 ,
                              
                           
                        and 
                           
                              ψ
                              (
                              
                                 
                                    RS
                                 
                                 
                                    ij
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    j
                                 
                              
                              )
                           
                         and 
                           
                              ϕ
                              (
                              
                                 
                                    RT
                                 
                                 
                                    ij
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    j
                                 
                              
                              )
                           
                         have non-zero entries at the position corresponding to class pair 
                           
                              (
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    j
                                 
                              
                              )
                           
                        .

We define the joint weight vector w and the joint feature vector 
                           
                              E
                              (
                              T
                              ,
                              y
                              )
                           
                         as 
                           
                              w
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                RS
                                             
                                             
                                                T
                                             
                                          
                                          ,
                                          
                                             
                                                w
                                             
                                             
                                                RT
                                             
                                             
                                                T
                                             
                                          
                                       
                                    
                                 
                                 
                                    T
                                 
                              
                           
                         and 
                           
                              E
                              (
                              T
                              ,
                              y
                              )
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ,
                                                j
                                                ,
                                                i
                                                ≠
                                                j
                                             
                                          
                                          
                                          ψ
                                          (
                                          
                                             
                                                RS
                                             
                                             
                                                ij
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                j
                                             
                                          
                                          )
                                          ,
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ,
                                                j
                                                ,
                                                i
                                                ≠
                                                j
                                             
                                          
                                          
                                          ϕ
                                          (
                                          
                                             
                                                RT
                                             
                                             
                                                ij
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                j
                                             
                                          
                                          )
                                       
                                    
                                 
                                 
                                    T
                                 
                              
                           
                        , where 
                           
                              i
                              ,
                              j
                              =
                              1
                              ,
                              …
                              ,
                              N
                           
                        . Then Eq. (4) can be expressed as
                           
                              (5)
                              
                                 F
                                 (
                                 T
                                 ,
                                 y
                                 )
                                 =
                                 
                                    
                                       w
                                    
                                    
                                       T
                                    
                                 
                                 E
                                 (
                                 T
                                 ,
                                 y
                                 )
                                 ,
                              
                           
                        
                     

The learning algorithm can be written as
                           
                              (6)
                              
                                 
                                    
                                       w
                                    
                                    
                                       ∗
                                    
                                 
                                 =
                                 arg
                                 
                                    
                                       
                                          min
                                       
                                       
                                          w
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                1
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                w
                                             
                                             
                                                T
                                             
                                          
                                          w
                                          -
                                          C
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   M
                                                
                                             
                                          
                                          
                                          
                                             
                                                w
                                             
                                             
                                                T
                                             
                                          
                                          E
                                          (
                                          
                                             
                                                T
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          +
                                          C
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                
                                                   M
                                                
                                             
                                          
                                          
                                          
                                             
                                                
                                                   max
                                                
                                                
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   E
                                                   (
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                   +
                                                   Δ
                                                   (
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              Δ
                           
                         is the number of tracklets that associate with incorrect labels and C controls the tradeoff between the errors in the training model and margin maximization. Eq. (6) can be converted to an unconstrained convex optimization problem and solved by the cutting plane methodology [38].

In the inference part, we adopt the greedy search methodology in [39–41] to find the optimal label vector 
                           
                              
                                 
                                    y
                                 
                                 
                                    test
                                 
                              
                           
                        . We first initialize the assignment sets, the label set y, and the instanced tracklet set 
                           
                              T
                           
                         as the null sets, indicating no tracklet state is recognized yet. We augment these sets by iteratively adding the labeled tracklet that increases the potential score the most.

Having the group state and the group event label of every tracklet in each camera, tracklet fusion in cameras with overlapping views is performed to obtain the consistent group states for the overlapping tracklets. Then, with single camera tracking being done, the tracklet association scheme is applied to the camera network. The tracklet association scheme aims to associate tracklets into long, stable tracks. If merge/split events are detected by the SSVM group model in Section 2, a group tracklet is associated with its corresponding individual tracks.

The SNT fuses all the tracklets in the overlapping views by a homography transformation between overlapping views similar to [21]. A homography transformation is used to project the ground plane from one camera view to that in another camera view. The group state of one target in different camera views may not be the same because of the differences in the observations. A weighted voting scheme is used to obtain the consistent group state of the same target across all cameras. Specifically, if there is an observation in the overlapping views between at least two cameras, the final group state is a linear combination of the group state from each camera. The group state from the camera with the widest view is assigned the highest weight while the ones from other cameras are assigned low weights. Thresholding is applied then to decide a consistent group state for the target.

We formulate the multi-target tracking task in a single camera as a network flow problem. We assume that there are l time intervals in a video sequence in every camera view. A graph 
                              
                                 G
                                 =
                                 (
                                 V
                                 ,
                                 E
                                 )
                              
                            is built as in Fig. 3
                           . Every tracklet is seen as a node in G, where the group states of it in all the overlapping view cameras are consistent. We also add two virtual nodes: the source node 
                              
                                 
                                    
                                       v
                                    
                                    
                                       start
                                    
                                 
                              
                            and the sink node 
                              
                                 
                                    
                                       v
                                    
                                    
                                       end
                                    
                                 
                              
                            representing the starting and ending nodes. The edges correspond the admissible association between two nodes. The vertex set V consists of a start node 
                              
                                 
                                    
                                       v
                                    
                                    
                                       start
                                    
                                 
                              
                           , a sink node 
                              
                                 
                                    
                                       v
                                    
                                    
                                       end
                                    
                                 
                              
                           , and nodes from the time interval 1 to l. Each edge is assigned a cost 
                              
                                 
                                    
                                       c
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                              
                            which is based on the feature similarity between two nodes i and j. We define 
                              
                                 
                                    
                                       f
                                    
                                    
                                       ij
                                    
                                 
                              
                            as a binary indicator variable that is 1 when there is an association between the nodes i and j and 0 otherwise. Thus,
                              
                                 (7)
                                 
                                    
                                       
                                          f
                                       
                                       
                                          start
                                          ,
                                          i
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      1
                                                      ,
                                                   
                                                   
                                                      if
                                                      
                                                      i
                                                      
                                                      is
                                                      
                                                      the
                                                      
                                                      starting
                                                      
                                                      node
                                                      
                                                      of
                                                      
                                                      a
                                                      
                                                      track
                                                      
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      0
                                                      ,
                                                   
                                                   
                                                      otherwise
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (8)
                                 
                                    
                                       
                                          f
                                       
                                       
                                          i
                                          ,
                                          end
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      1
                                                      ,
                                                   
                                                   
                                                      if
                                                      
                                                      i
                                                      
                                                      is
                                                      
                                                      the
                                                      
                                                      ending
                                                      
                                                      node
                                                      
                                                      of
                                                      
                                                      a
                                                      
                                                      track
                                                      
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      0
                                                      ,
                                                   
                                                   
                                                      otherwise
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (9)
                                 
                                    
                                       
                                          f
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      1
                                                      ,
                                                   
                                                   
                                                      if
                                                      
                                                      there
                                                      
                                                      is
                                                      
                                                      an
                                                      
                                                      admissible
                                                      
                                                      associationbetween
                                                      
                                                      the
                                                      
                                                      nodes
                                                      
                                                      i
                                                      
                                                      and
                                                      
                                                      j
                                                   
                                                
                                                
                                                   
                                                   
                                                      
                                                      in
                                                      
                                                      two
                                                      
                                                      consecutive
                                                      
                                                      time
                                                      
                                                      intervals
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      0
                                                      ,
                                                   
                                                   
                                                      otherwise
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 
                                    
                                       X
                                    
                                    
                                       k
                                    
                                 
                              
                            represents a long, associated track.

For every node, the sum of flows arriving at a node j equals to the sum of outgoing flows from the node j. If there is an association between two tracklets, no other associations are allowed between either of these two tracklets. Thus the following constraint on the variable f must be satisfied,
                              
                                 (10)
                                 
                                    
                                       
                                          f
                                       
                                       
                                          start
                                          ,
                                          j
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                    
                                       
                                          f
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                          
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          j
                                          ,
                                          k
                                       
                                    
                                    +
                                    
                                       
                                          f
                                       
                                       
                                          j
                                          ,
                                          end
                                       
                                    
                                    ,
                                 
                              
                           
                        

While a node can represent either a group or an individual, such a constraint in Eq. (10) cannot be always satisfied because a group can be merged or split into multiple individuals. This might cause a many-to-one matching problem. To avoid such a case, we use the group state of a node as well as the merge/split label obtained from Section 2 to temporarily change the number of nodes. Specifically, if there is a merge/split event before/after a group node, we add virtual group nodes to make the total number of group nodes including the virtual nodes equal to the number of individual nodes before/after the split/merge event. An example is shown in Fig. 3, in which the blue node with solid lines is a group node and the blue node with dotted lines is the virtual node. Thus,
                              
                                 (11)
                                 
                                    
                                       
                                          N
                                       
                                       
                                          t
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            t
                                                            -
                                                            1
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            
                                                               
                                                                  N
                                                               
                                                               
                                                                  ∼
                                                               
                                                            
                                                         
                                                         
                                                            t
                                                            -
                                                            1
                                                         
                                                         
                                                            G
                                                         
                                                      
                                                      ,
                                                   
                                                   
                                                      if
                                                      
                                                      there
                                                      
                                                      is
                                                      
                                                      a
                                                      
                                                      merge
                                                      
                                                      event
                                                      
                                                      before
                                                      
                                                      t
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            t
                                                            +
                                                            1
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            
                                                               
                                                                  N
                                                               
                                                               
                                                                  ∼
                                                               
                                                            
                                                         
                                                         
                                                            t
                                                            +
                                                            1
                                                         
                                                         
                                                            G
                                                         
                                                      
                                                      ,
                                                   
                                                   
                                                      if
                                                      
                                                      there
                                                      
                                                      is
                                                      
                                                      a
                                                      
                                                      split
                                                      
                                                      event
                                                      
                                                      after
                                                      
                                                      t
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      0
                                                      ,
                                                   
                                                   
                                                      otherwise
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 
                                    
                                       N
                                    
                                    
                                       t
                                    
                                 
                              
                            is the number of nodes in time interval t, and 
                              
                                 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             ∼
                                          
                                       
                                    
                                    
                                       t
                                       -
                                       1
                                    
                                    
                                       G
                                    
                                 
                              
                            is the number of the added virtual nodes in time interval 
                              
                                 t
                                 -
                                 1
                              
                           .

We define the cost between two nodes i and j in a graph G as the negative logarithm of the feature similarity between two nodes, which is denoted by 
                              
                                 
                                    
                                       c
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                              
                           , i.e.,
                              
                                 (12)
                                 
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    =
                                    -
                                    log
                                    S
                                    (
                                    
                                       
                                          T
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    
                                       
                                          T
                                       
                                       
                                          j
                                       
                                    
                                    )
                                    ,
                                 
                              
                           where 
                              
                                 S
                              
                            is the similarity function.

The tracking problem in a single camera view is then formulated as
                              
                                 (13)
                                 
                                    Minimize
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                          
                                       
                                    
                                    
                                    
                                       
                                          c
                                       
                                       
                                          start
                                          ,
                                          j
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          start
                                          ,
                                          j
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             ,
                                             j
                                          
                                       
                                    
                                    
                                    
                                       
                                          c
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                          
                                       
                                    
                                    
                                    
                                       
                                          c
                                       
                                       
                                          j
                                          ,
                                          end
                                       
                                    
                                    
                                       
                                          f
                                       
                                       
                                          j
                                          ,
                                          end
                                       
                                    
                                    ,
                                 
                              
                           
                        

We also need to ensure that all flows from the source node 
                              
                                 
                                    
                                       v
                                    
                                    
                                       start
                                    
                                 
                              
                            eventually end up in the sink node 
                              
                                 
                                    
                                       v
                                    
                                    
                                       end
                                    
                                 
                              
                           , i.e.,
                              
                                 (14)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                    
                                       
                                          f
                                       
                                       
                                          start
                                          ,
                                          i
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                          
                                       
                                    
                                    
                                    
                                       
                                          f
                                       
                                       
                                          k
                                          ,
                                          end
                                       
                                    
                                    .
                                 
                              
                           
                        

In a camera network, the problem formulation is similar to the method above. However, some significant differences should be noticed. We assume that an edge only exists between two consecutive time steps excluding the source and sink nodes in a single camera. This is because a target’s motion can be seen continuously. However, such an assumption is not valid for non-overlapping views because of the blind area between camera views. Thus the definition of 
                              
                                 
                                    
                                       f
                                    
                                    
                                       ij
                                    
                                 
                              
                            in Eq. (9) is redefined as
                              
                                 (15)
                                 
                                    
                                       
                                          f
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      1
                                                      ,
                                                   
                                                   
                                                      if
                                                      
                                                      there
                                                      
                                                      is
                                                      
                                                      an
                                                      
                                                      admissible
                                                      
                                                      association
                                                      
                                                      between
                                                   
                                                
                                                
                                                   
                                                   
                                                      the
                                                      
                                                      nodes
                                                      
                                                      i
                                                      
                                                      and
                                                      
                                                      j
                                                      
                                                      within
                                                      
                                                      a
                                                      
                                                      time
                                                      
                                                      window
                                                      ;
                                                   
                                                
                                                
                                                   
                                                      0
                                                      ,
                                                   
                                                   
                                                      otherwise
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

In the network flow in a single camera, a target is seen as a node in every camera. Since the tracklet fusion can be done as stated above, all the observations of the same target are seen as one node in the new network flow framework. Such a simplification can guarantee that Eq. (10) is satisfied. An example of the network flow framework of a camera network can be seen in Fig. 4
                           . The link from the second node at time 1 to the first node of time 3 is because of the blind area between 
                              
                                 
                                    
                                       C
                                    
                                    
                                       a
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       C
                                    
                                    
                                       b
                                    
                                 
                              
                           . Note that a node in camera a can have an edge with another node in the same camera since a target might leave the camera view and return back to the same camera.

The similarity between two observations is defined as 
                              
                                 S
                                 
                                    
                                       
                                          
                                             
                                                O
                                             
                                             
                                                j
                                             
                                             
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      b
                                                   
                                                
                                             
                                          
                                          ,
                                          
                                             
                                                O
                                             
                                             
                                                i
                                             
                                             
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      a
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           , where 
                              
                                 
                                    
                                       O
                                    
                                    
                                       i
                                    
                                    
                                       
                                          
                                             C
                                          
                                          
                                             a
                                          
                                       
                                    
                                 
                              
                            denotes the observation of tracklet i in camera a. 
                              
                                 
                                    
                                       C
                                    
                                    
                                       b
                                    
                                 
                              
                            can be any camera including the camera 
                              
                                 
                                    
                                       C
                                    
                                    
                                       a
                                    
                                 
                              
                           .

The overall problem for tracking multiple interacting targets in a camera network can now be rewritten as a linear programming one.
                              
                                 (16)
                                 
                                    
                                       
                                          
                                             
                                                Minimize
                                             
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      j
                                                   
                                                
                                                
                                                -
                                                log
                                                
                                                   
                                                      
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               start
                                                            
                                                         
                                                         (
                                                         
                                                            
                                                               O
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               
                                                                  
                                                                     C
                                                                  
                                                                  
                                                                     a
                                                                  
                                                               
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      start
                                                      ,
                                                      j
                                                   
                                                
                                                +
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                   
                                                
                                                
                                                -
                                                log
                                                
                                                   
                                                      
                                                         S
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        O
                                                                     
                                                                     
                                                                        j
                                                                     
                                                                     
                                                                        
                                                                           
                                                                              C
                                                                           
                                                                           
                                                                              b
                                                                           
                                                                        
                                                                     
                                                                  
                                                                  ,
                                                                  
                                                                     
                                                                        O
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                     
                                                                        
                                                                           
                                                                              C
                                                                           
                                                                           
                                                                              a
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                   
                                                
                                                +
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                
                                                
                                                -
                                                log
                                                
                                                   
                                                      
                                                         
                                                            
                                                               S
                                                            
                                                            
                                                               end
                                                            
                                                         
                                                         (
                                                         
                                                            
                                                               O
                                                            
                                                            
                                                               i
                                                            
                                                            
                                                               
                                                                  
                                                                     C
                                                                  
                                                                  
                                                                     c
                                                                  
                                                               
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      j
                                                      ,
                                                      end
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                s
                                                .
                                                t
                                                .
                                             
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                   
                                                
                                                ⩾
                                                0
                                                ,
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      start
                                                      ,
                                                      i
                                                   
                                                
                                                ⩾
                                                0
                                                ,
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      i
                                                      ,
                                                      end
                                                   
                                                
                                                ⩾
                                                0
                                                
                                                ∀
                                                (
                                                i
                                                ,
                                                j
                                                )
                                                ∈
                                                E
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                   
                                                
                                                ⩽
                                                1
                                                ,
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      start
                                                      ,
                                                      i
                                                   
                                                
                                                ⩽
                                                1
                                                ,
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      i
                                                      ,
                                                      end
                                                   
                                                
                                                ⩽
                                                1
                                                
                                                ∀
                                                (
                                                i
                                                ,
                                                j
                                                )
                                                ∈
                                                E
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      k
                                                   
                                                
                                                
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      j
                                                      ,
                                                      k
                                                   
                                                
                                                +
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      j
                                                      ,
                                                      end
                                                   
                                                
                                                -
                                                
                                                   
                                                      
                                                         
                                                            
                                                               f
                                                            
                                                            
                                                               start
                                                               ,
                                                               j
                                                            
                                                         
                                                         +
                                                         
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                         
                                                         
                                                            
                                                               f
                                                            
                                                            
                                                               i
                                                               ,
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                                ⩽
                                                0
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      k
                                                   
                                                
                                                
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      k
                                                      ,
                                                      end
                                                   
                                                
                                                -
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                                
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      start
                                                      ,
                                                      i
                                                   
                                                
                                                ⩽
                                                0
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 
                                    
                                       S
                                    
                                    
                                       start
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                O
                                             
                                             
                                                i
                                             
                                             
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      a
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                            represents the probability that the observation i in camera a is the starting point of a track and 
                              
                                 
                                    
                                       S
                                    
                                    
                                       end
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                O
                                             
                                             
                                                i
                                             
                                             
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      c
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                            representing this observation in camera a is the last observation of a track.

The problem in Eq. (16) is similar to a linear programming formulation with discrete variables. A similar problem has been studied in [42–45]. However, ours is the first work that addresses the problem of tracking multiple interacting targets, i.e., both individuals and groups, into the network flow graph, and makes the problem different from existing works. Moreover, we work on a camera network with both overlapping and non-overlapping views while handling the relationships between individuals and groups. We realize that though the integer program (IP) can be solved by any generic IP solver, the size of the NP-complete problem makes the solution impractical. Such a problem is also known as a mixed integer programming problem [46]. Though the branch and bound algorithm has been proved to effectively solve such a problem, recent studies [43] have shown that the complexity of this problem can be reduced by reformulating the problem to a similar problem that approximates the original. The relaxed problem is called the k-shortest node-disjoint paths (KSP) problem on a directed acyclic graph (DAG).

Let 
                           
                              H
                           
                         denote the feasible solutions of the problem in Eq. (16). Thus the optimal solution 
                           
                              
                                 
                                    f
                                 
                                 
                                    ∗
                                 
                              
                           
                         is rewritten as
                           
                              (17)
                              
                                 
                                    
                                       argmin
                                    
                                    
                                       f
                                       ∈
                                       H
                                    
                                 
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          a
                                          ,
                                          b
                                          ,
                                          i
                                          ,
                                          j
                                       
                                    
                                 
                                 
                                 c
                                 
                                    
                                       
                                          
                                             
                                                e
                                             
                                             
                                                i
                                                ,
                                                j
                                             
                                             
                                                a
                                                ,
                                                b
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                              
                           
                        where 
                           
                              c
                              
                                 
                                    
                                       
                                          
                                             e
                                          
                                          
                                             i
                                             ,
                                             j
                                          
                                          
                                             a
                                             ,
                                             b
                                          
                                       
                                    
                                 
                              
                              =
                              -
                              log
                              
                                 
                                    
                                       S
                                       
                                          
                                             
                                                
                                                   
                                                      O
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            b
                                                         
                                                      
                                                   
                                                
                                                ,
                                                
                                                   
                                                      O
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            a
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              -
                              log
                              
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             start
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      O
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            a
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              -
                              log
                              
                                 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             end
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      O
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            a
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        .

The optimal solution in Eq. (17) can be obtained as in [43]. We first run KSP on a single camera assuming the group state of each target is known. Then we add the shape and appearance features and the time gap constraints into the KSP in the camera network tracking scheme. The KSP is rerun and the optimal solution Eq. (17) is obtained. A detailed implementation will be provided in the experimental section.

We perform experiments on the public VideoWeb dataset [11] to assess the effectiveness of our tracking system. It contains both overlapping and non-overlapping views and complex target interactions. In VideoWeb dataset, each scenario has 8 cameras. There are totally 
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                8
                                             
                                          
                                          
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                              =
                              28
                           
                         camera pairs per scenario. Among them, 12 pairs have overlapping views and the rest 16 pairs do not share overlapping views with each other. Each scenario has at least 8 persons walking into different camera views. Each video lasts for 4–6min. 17 challenging scenarios are selected to test our algorithm. We use 7 scenarios for training and the remaining for testing. So totally 80 video sequences are used for testing our algorithm where the total video duration is around 350min and the number of persons is 91. Each video sequence records real-world scenes with complex human activities that are present most of time. The dataset has many challenging scenarios, e.g., people interact with each other while merging to a group and then splitting; people leave a camera view and then come back after a long time; people stay in a cluttered scenario with heavy occlusions. We use 8 cameras to test our tracking algorithm on a camera network while [1,2,4] used 5, 4, 2 cameras respectively.

There are three equations, (12), (16) and (17), where calculation of feature similarity is involved. In the tracking scheme, the optimal solution 
                           
                              
                                 
                                    f
                                 
                                 
                                    ∗
                                 
                              
                           
                         depends on the flow cost in Eq. (17), where the flow cost is defined as a negative logarithm of a feature similarity score S. In Eq. (12), the similarity score is defined as the motion affinity between the features of two tracklets in a single camera. In Eq. (16), feature similarity is necessary because the motion affinities between two tracklets are not reliable. The view and pose of a tracklet can change significantly in different cameras. It is possible that a merge/split event may happen in the blind area between the two camera views. Since the SNT can decide the group state of a tracklet in any camera, in general, two cases need to be considered when calculating feature similarities: two observations are recognized as individuals and at least one observation is recognized as a group.


                        Individual tracklet association. If two observations are recognized as two individuals, we use a linear combination of appearance in HSV space, histogram of oriented gradients (HoG) and pyramid of histograms of orientation gradients (PHoG) as the features of each observation. Firstly, a brightness transfer function (BTF) is applied to transform the appearance of a target from a camera to another. We adopt the method of [2] which can incrementally learn the BTF across cameras. With the transformed color features and the shape features (HoG and PHoG), the feature distance between individuals tracklets can be calculated by Bhattachayya distance which is denoted by 
                           
                              B
                              (
                              .
                              )
                           
                        . Thus, the feature similarity between two tracklets is 
                           
                              S
                              
                                 
                                    
                                       
                                          
                                             O
                                          
                                          
                                             j
                                          
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   b
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             O
                                          
                                          
                                             i
                                          
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   a
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              ∝
                              
                                 
                                    p
                                 
                                 
                                    tran
                                 
                              
                              ·
                              exp
                              
                                 
                                    
                                       -
                                       B
                                       
                                          
                                             
                                                
                                                   
                                                      O
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            b
                                                         
                                                      
                                                   
                                                
                                                ,
                                                
                                                   
                                                      O
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            a
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        , where 
                           
                              
                                 
                                    p
                                 
                                 
                                    tran
                                 
                              
                           
                         denotes the transition probabilities between two cameras.


                        Group tracklet association. If at least one of the two observations in two cameras is a group, two sub-cases should be considered. The first sub-case is that there is no merge/split event in the blind area between two cameras. This means that the same group appears in these two linked cameras. The second sub-case is that a merge/split event occurs in the blind area which makes the targets in these two cameras different.

To associate group observations 
                           
                              
                                 
                                    G
                                 
                                 
                                    i
                                 
                              
                           
                         and 
                           
                              
                                 
                                    G
                                 
                                 
                                    j
                                 
                              
                           
                        , feature similarity between two group regions should be calculated. Similar to [29,30], the appearance and statistical properties of the group region are represented by a covariance descriptor. Given the feature points 
                           
                              
                                 
                                    {
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                    }
                                 
                                 
                                    i
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    
                                       
                                          N
                                       
                                       
                                          PI
                                       
                                    
                                 
                              
                           
                         where 
                           
                              
                                 
                                    N
                                 
                                 
                                    PI
                                 
                              
                           
                         is the number of pixels in the group region, the covariance descriptor is
                           
                              (18)
                              
                                 
                                    
                                       V
                                    
                                    
                                       G
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             PI
                                          
                                       
                                       -
                                       1
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                N
                                             
                                             
                                                PI
                                             
                                          
                                       
                                    
                                 
                                 
                                 (
                                 
                                    
                                       f
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 
                                    
                                       μ
                                    
                                    
                                       G
                                    
                                 
                                 )
                                 
                                    
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             i
                                          
                                       
                                       -
                                       
                                          
                                             μ
                                          
                                          
                                             G
                                          
                                       
                                       )
                                    
                                    
                                       T
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    μ
                                 
                                 
                                    G
                                 
                              
                           
                         is the mean feature vector of these 
                           
                              
                                 
                                    N
                                 
                                 
                                    PI
                                 
                              
                           
                         feature vectors. The feature similarity between two groups in cameras a and b is computed based on their covariance descriptors 
                           
                              
                                 
                                    V
                                 
                                 
                                    
                                       
                                          G
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           
                         and 
                           
                              
                                 
                                    V
                                 
                                 
                                    
                                       
                                          G
                                       
                                       
                                          j
                                       
                                    
                                 
                              
                           
                         between two cameras a and b, i.e.,
                           
                              (19)
                              
                                 S
                                 
                                    
                                       
                                          
                                             
                                                G
                                             
                                             
                                                i
                                             
                                             
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      a
                                                   
                                                
                                             
                                          
                                          ,
                                          
                                             
                                                G
                                             
                                             
                                                j
                                             
                                             
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      b
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 1
                                 -
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                          
                                       
                                       
                                       
                                          
                                             ln
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      
                                                         
                                                            G
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            a
                                                         
                                                      
                                                   
                                                
                                                ,
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      
                                                         
                                                            G
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            C
                                                         
                                                         
                                                            b
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              {
                              
                                 
                                    λ
                                 
                                 
                                    i
                                 
                              
                              }
                           
                         are the generalized eigenvalues of the two group covariance matrices 
                           
                              
                                 
                                    C
                                 
                                 
                                    
                                       
                                          G
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          a
                                       
                                    
                                 
                              
                           
                         and 
                           
                              
                                 
                                    C
                                 
                                 
                                    
                                       
                                          G
                                       
                                       
                                          j
                                       
                                    
                                 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          b
                                       
                                    
                                 
                              
                           
                        .

If 
                           
                              S
                              
                                 
                                    
                                       
                                          
                                             G
                                          
                                          
                                             i
                                          
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   a
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             G
                                          
                                          
                                             j
                                          
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   b
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                         is larger than a given threshold, we consider 
                           
                              
                                 
                                    G
                                 
                                 
                                    j
                                 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          b
                                       
                                    
                                 
                              
                           
                         is a good candidate match to 
                           
                              
                                 
                                    G
                                 
                                 
                                    i
                                 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          a
                                       
                                    
                                 
                              
                           
                        . Otherwise, the two groups are recognized as different. If no group matches 
                           
                              
                                 
                                    G
                                 
                                 
                                    i
                                 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          a
                                       
                                    
                                 
                              
                           
                        , it is highly possible that a merge/split event occurred in the blind area. The number of individuals in two groups are estimated according to the detections in the group. The algorithm to associate group tracklets is listed in Algorithm 1. Given a group tracklet 
                           
                              
                                 
                                    G
                                 
                                 
                                    i
                                 
                              
                           
                         in 
                           
                              
                                 
                                    C
                                 
                                 
                                    a
                                 
                              
                           
                        , the goal of this algorithm is to find a correspondence 
                           
                              
                                 
                                    T
                                 
                                 
                                    j
                                 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          b
                                       
                                    
                                 
                              
                           
                         which is the best match to 
                           
                              
                                 
                                    G
                                 
                                 
                                    i
                                 
                                 
                                    
                                       
                                          C
                                       
                                       
                                          a
                                       
                                    
                                 
                              
                           
                        . Note that we use 
                           
                              
                                 
                                    T
                                 
                                 
                                    j
                                 
                              
                           
                         to represent a candidate tracklet because the candidate can be an individual tracklet. Even if 
                           
                              
                                 
                                    T
                                 
                                 
                                    j
                                 
                              
                           
                         is an individual tracklet, the same method can be applied.
                           Algorithm 1
                           Group tracklet association. 
                                 
                                    
                                 
                              
                           

VideoWeb dataset is very rich in interaction activities. Every video sequence has around 8 merge events and 7 split events on average. Our training samples are video frames of crowded scenes, which contain both individuals and groups. The group and individual labels of the bounding boxes are manually annotated according to the ground truth for training. During the training, SVM is trained upon the pedestrians’ distance features developed based on their bounding boxes. Every camera view is trained separately because the average sizes of pedestrians are different in different camera views. For every camera view, we selected 4 video sequences for training. Each video sequence contains individuals and pedestrian groups where the ground truth is available. In the testing phase, among 80 video sequences, we obtain 3188 groups totally. After tracklet association, 1513 groups are obtained. This means that 1675 groups are associated using the optimization framework in Section 3. The number of people detected per group varies from 2 to 8 depending upon the scenario. In Fig. 5
                        , an example shows that though individuals cannot be recognized in the high clutter, their identities can be recovered after the group splits into individuals.

There are no standard evaluation metrics for a multi-camera tracking scheme, though single camera tracking evaluation metrics have been studied for years [47]. We adopt the evaluation metrics in [48] to fairly evaluate our results because it introduces both single camera and multi-camera evaluation metrics. In the single-camera evaluation, PR (precision), IDC (ID change) and TF (track fragmentation) are adopted. Three metrics are used for the multi-camera tracking evaluation: TL (trajectory length), XFrag (crossing fragments in two different cameras) and XIDS (crossing ID-switches in two cameras).

To the best of our knowledge, there is no existing tracking work based on this public dataset. Comparisons with other multi-camera tracking methods like [1,4] are not feasible as the goals of the algorithms presented there were very different from ours and, therefore, cannot be applied to the Videoweb dataset. Thus, we evaluate our results with respect to the ground truth. We also show comparisons with [2,3]. The average results on all the ten testing scenarios are provided in Table 4.

We first run a particle filter to associate detections into tracklets. After tracklet fusion across overlapping views, the SNT is run to obtain single camera tracking results, the average of which are shown in Table 2
                        . According to the results, our tracker is able to obtain a good precision while the number of track fragmentation and ID change are small. The precision of camera 16 is low as there are many misdetections in this camera view.

The multiple interacting targets tracking results in a camera network are shown in Table 3
                        
                        . We present the results on every scenario we worked on to better represent the performance of our camera network tracker on different scenes. A high trajectory length with low crossing fragments and crossing ID switches in each scene shows the advantage of the proposed algorithm.

Representative tracking results are provided in Fig. 6
                        . Among the 6 time steps, there are totally 7 persons appearing in the scene. Typical scenarios are listed below.
                           
                              •
                              
                                 
                                    
                                       
                                          
                                             t
                                          
                                          
                                             1
                                          
                                       
                                    
                                 : Person 2 and 12, who can be observed by 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             21
                                          
                                       
                                    
                                 , stay individually.


                                 
                                    
                                       
                                          
                                             t
                                          
                                          
                                             2
                                          
                                       
                                    
                                 : Person 2 and 12 interact with each other and person 12 cannot be observed by any camera. The SNT outputs the ID of these two persons as a group 20. The person who stays within the group 5 at 
                                    
                                       
                                          
                                             t
                                          
                                          
                                             1
                                          
                                       
                                    
                                  leaves the group at 
                                    
                                       
                                          
                                             t
                                          
                                          
                                             2
                                          
                                       
                                    
                                  with the ID 3.


                                 
                                    
                                       
                                          
                                             t
                                          
                                          
                                             3
                                          
                                       
                                    
                                 : Person 3 interacts with the group 20, and finally merges to a new group 24. The track of person 10 starts in 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             20
                                          
                                       
                                    
                                 .


                                 
                                    
                                       
                                          
                                             t
                                          
                                          
                                             4
                                          
                                       
                                    
                                 : Group 24 can be observed by 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             17
                                          
                                       
                                       ,
                                       
                                          
                                             C
                                          
                                          
                                             21
                                          
                                       
                                       ,
                                       
                                          
                                             C
                                          
                                          
                                             31
                                          
                                       
                                    
                                  at 
                                    
                                       
                                          
                                             t
                                          
                                          
                                             3
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             t
                                          
                                          
                                             4
                                          
                                       
                                    
                                 . Person 10 walks into the view of 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             16
                                          
                                       
                                       ,
                                       
                                          
                                             C
                                          
                                          
                                             17
                                          
                                       
                                       ,
                                       
                                          
                                             C
                                          
                                          
                                             21
                                          
                                       
                                       ,
                                       
                                          
                                             C
                                          
                                          
                                             31
                                          
                                       
                                       ,
                                       
                                          
                                             C
                                          
                                          
                                             36
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             37
                                          
                                       
                                    
                                  at 
                                    
                                       
                                          
                                             t
                                          
                                          
                                             4
                                          
                                       
                                    
                                 , in which full body detections in 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             17
                                          
                                       
                                       ,
                                       
                                          
                                             C
                                          
                                          
                                             31
                                          
                                       
                                       ,
                                       
                                          
                                             C
                                          
                                          
                                             36
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             37
                                          
                                       
                                    
                                  are obtained by a person detector.


                                 
                                    
                                       
                                          
                                             t
                                          
                                          
                                             5
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             t
                                          
                                          
                                             6
                                          
                                       
                                    
                                 : Person 10 and person 3 merge into group 29 at 
                                    
                                       
                                          
                                             t
                                          
                                          
                                             5
                                          
                                       
                                    
                                 , and walk into the view of 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             27
                                          
                                       
                                    
                                  at 
                                    
                                       
                                          
                                             t
                                          
                                          
                                             6
                                          
                                       
                                    
                                 .

The results show that the track IDs of the same target in overlapping camera are the same, e.g., person 10 and person 12. Another observation is that though only parts of a group (an individual) are observed in some camera, the weighted voting scheme is able to find the correct group state. For instance, at 
                           
                              
                                 
                                    t
                                 
                                 
                                    3
                                 
                              
                           
                        , the group 24 can be fully observed in 
                           
                              
                                 
                                    C
                                 
                                 
                                    21
                                 
                              
                           
                         and 
                           
                              
                                 
                                    C
                                 
                                 
                                    31
                                 
                              
                           
                        . However, only one person can be observed by 
                           
                              
                                 
                                    C
                                 
                                 
                                    17
                                 
                              
                           
                         while a group ID is assigned to this person. A similar example is illustrated in group 29 at 
                           
                              
                                 
                                    t
                                 
                                 
                                    6
                                 
                              
                           
                        . A failure case is represented by red dots where missing detections lead to tracks loss.

@&#CONCLUSION@&#

We have addressed the problem of tracking in a camera network where there are individuals and groups interacting. A structural SVM model was proposed to discriminate between individuals and groups. Observations in overlapping cameras were fused, and associations between those in a camera network were calculated. Formulating the problem of the camera network tracking as a network flow model, a standard linear program problem is obtained. An efficient K-shortest paths algorithm is used to perform robust multi-object tracking. Experimental results on a very challenging public dataset show the robust performance of our tracking system.

@&#ACKNOWLEDGMENT@&#

This work has been partially supported by ONR United States Grant N00014-09-C-0388.

Supplementary data associated with this article can be found, in the online version, at http://dx.doi.org/10.1016/j.cviu.2015.01.002.


                     
                        
                           
                        
                     
                  

@&#REFERENCES@&#

