@&#MAIN-TITLE@&#Characterization of bivariate hierarchical quartic box splines on a three-directional grid

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We identify the subspace of “special quartics” generated by quartic box splines.


                        
                        
                           
                           We establish the completeness of hierarchical 
                                 
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                              -smooth quartic box splines.


                        
                        
                           
                           We characterize the hierarchical space using “special quartic” polynomials.


                        
                        
                           
                           We obtain a basis for the hierarchical spline space over type-I triangulations.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Hierarchical splines

Box splines

Completeness

Adaptive refinement

Three-directional grid

Type-I triangulation

@&#ABSTRACT@&#


               
               
                  We consider the adaptive refinement of bivariate quartic 
                        
                           
                              C
                           
                           
                              2
                           
                        
                     -smooth box spline spaces on the three-directional (type-I) grid G. The polynomial segments of these box splines belong to a certain subspace of the space of quartic polynomials, which will be called the space of special quartics. Given a bounded domain 
                        Ω
                        ⊂
                        
                           
                              R
                           
                           
                              2
                           
                        
                      and finite sequence 
                        
                           
                              (
                              
                                 
                                    G
                                 
                                 
                                    ℓ
                                 
                              
                              )
                           
                           
                              ℓ
                              =
                              0
                              ,
                              …
                              ,
                              N
                           
                        
                      of dyadically refined grids, we obtain a hierarchical grid by selecting mutually disjoint cells from all levels such that their union covers the entire domain. Using a suitable selection procedure allows to define a basis spanning the hierarchical box spline space. The paper derives a characterization of this space. Under certain mild assumptions on the hierarchical grid, the hierarchical spline space is shown to contain all 
                        
                           
                              C
                           
                           
                              2
                           
                        
                     -smooth functions whose restrictions to the cells of the hierarchical grid are special quartic polynomials. Thus, in this case we can give an affirmative answer to the completeness questions for the hierarchical box spline basis.
               
            

@&#INTRODUCTION@&#


                     Box splines and the functions contained in the spaces spanned by them form a very useful class of piecewise polynomial functions on regular grids. They possess a number of useful properties that make them well-suited for applications. It has been shown that box splines have small support (a few cells of the underlying grid), they are non-negative, they form a partition of unity, and that box splines are refinable, i.e., the box spline spaces on refined grids are nested (Böhm, 1983; de Boor and Ron, 2008). Monographs and survey articles about box splines include (de Boor et al., 1993; de Boor and Ron, 2008; Chui, 1988; Prautzsch and Boehm, 2002). Tensor-product B-splines are special instances of box splines also.

From the rich literature on box splines, we mention a few representative publications on three specific topics. Firstly, a substantial number of results on the approximation power of box splines is described in the literature, e.g. (Lyche et al., 2008; Ron and Sivakumar, 1993). Secondly, several publications discuss techniques for the efficient manipulation of box spline bases. A general stable evaluation algorithm is devised in Kobbelt (1997). In Kim and Peters (2009) the problem of efficient evaluation of box splines is addressed by making use of the local Bernstein representation of basis functions on each triangle. Also, numerical integration schemes, which are important for applications, based on quasi-interpolation have been considered in Lamberti (2009), Dagnino et al. (2013).

Using hierarchical splines is a well-established approach to adaptive refinement in geometric modeling (Forsey and Bartels, 1988) and numerical analysis (Mustahsan, 2011; Schillinger et al., 2012; Vuong et al., 2011). Kraft (1998) introduced a basis for hierarchical tensor-product spline spaces using a selection mechanism for B-splines. More recently, a slight modification of this approach was shown to provide a basis with better properties, such as the partition of unity property, strong stability and full approximation power (Giannelli et al., 2012, 2014; Speleers and Manni, 2015). The hierarchical approach has been extended to Powell–Sabin splines, Zwart–Powell elements and B-spline-type basis functions for cubic splines on regular grids (Kang et al., 2014; Speleers et al., 2009; Zore and Jüttler, 2014).

Computations of the dimensions of spline spaces on partitions of a domain and constructions of suitable bases for such spaces are classical problems considered in the theory of multivariate splines (Wang, 2001; Zeng et al., 2015). The completeness question (i.e., how to construct a basis spanning the entire spline space on a partition of a domain) led to the introduction of polynomial splines over hierarchical T-meshes (PHT-splines) (Deng et al., 2006, 2008; Li et al., 2010). Bivariate splines over T-meshes are considered in Schumaker and Wang (2012). A graphical summary of the related literature has been given in Mokriš and Jüttler (2014, Fig. 1). Several publications have addressed the completeness questions for hierarchical spline spaces generated by tensor-product B-splines (Berdinsky et al., 2014; Giannelli and Jüttler, 2013; Mokriš et al., 2014). Given a hierarchical spline space, these publications derive sufficient conditions which guarantee that the associated basis (obtained by Kraft's selection mechanism) spans the entire spline space on the partition of the domain which is determined by the hierarchical space.

The paper explores the hierarchical spline spaces generated by 
                        
                           
                              C
                           
                           
                              2
                           
                        
                     -smooth quartic box splines on nested type-I triangulations of a bounded domain 
                        Ω
                        ⊂
                        
                           
                              R
                           
                           
                              2
                           
                        
                     , cf. Fig. 1
                     . These functions form the mathematical basis of Loop's subdivision scheme and are therefore used to construct the regular parts of the corresponding subdivision surfaces, cf. Loop (1987), Stollnitz et al. (1996). Moreover, it is known that any 
                        
                           
                              C
                           
                           
                              2
                           
                        
                     -smooth piecewise polynomial function of degree 4 on a type-I triangulation of 
                        
                           
                              R
                           
                           
                              2
                           
                        
                      can be represented as a linear combination of box splines plus three (globally supported) truncated power (piecewise polynomial) functions of degree 4. However, the box splines suffice for representing all locally supported 
                     
                        
                           
                              C
                           
                           
                              2
                           
                        
                     -spline in the space, cf. Chui and Wang (1984). On each cell of the triangulation, the space generated by the box splines spans a 12-dimensional subspace of quartic bivariate polynomials. This subspace, which will be called the space of special quartics, is known to contain the cubic polynomials. The current manuscript follows the approach presented in Mokriš et al. (2014) in order to establish the completeness of hierarchical 
                        
                           
                              C
                           
                           
                              2
                           
                        
                     -smooth quartic box splines with respect to special quartics.

Using a suitable selection procedure, which generalizes the hierarchical B-spline basis introduced by Kraft (1997) to quartic 
                        
                           
                              C
                           
                           
                              2
                           
                        
                     -smooth box splines, we define a basis spanning a hierarchical box spline space. We prove that the elements of the space can equivalently be characterized as the 
                        
                           
                              C
                           
                           
                              2
                           
                        
                     -smooth functions whose restrictions to the cells of the hierarchical grid (which consists of mutually disjoint cells from different levels covering the entire domain) are special quartic polynomials.

The remainder of this paper consists of five sections and an appendix. The next section recalls existing results concerning bivariate spline spaces on regular grids and 
                        
                           
                              C
                           
                           
                              2
                           
                        
                     -smooth quartic box splines. It also derives a characterization of 
                        
                           
                              C
                           
                           
                              2
                           
                        
                     -contacts between segments of special quartic polynomials by their box spline coefficients. Section 3 is devoted to the spaces of 
                        
                           
                              C
                           
                           
                              2
                           
                        
                     -smooth functions whose segments are special quartic polynomials on a multi-cell domain, where all cells belong to the same level. For certain multi-cell domains, which are said to be admissible, these spaces are spanned by the associated box splines. These domains are characterized by an offset condition in Section 4. Based on these results, the fifth section discusses the completeness of the hierarchical box spline basis on the associated hierarchical grids. Finally we conclude the paper. The Appendix A proves that the spaces spanned by the special quartic polynomials on each cell are simply restrictions of a globally defined subspace of the space of quartic polynomials.

We recall existing results concerning 
                        
                           
                              C
                           
                           
                              2
                           
                        
                     -smooth quartic splines on regular type-I triangulations and characterize 
                        
                           
                              C
                           
                           
                              2
                           
                        
                     -smooth contacts between special quartic polynomials on adjacent triangular cells.

We consider bivariate splines on a three-directional grid in the plane 
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                        , see Fig. 1. Let us denote by 
                           
                              
                                 P
                              
                              
                                 d
                              
                           
                         the linear space of polynomials in 
                           R
                           [
                           x
                           ,
                           y
                           ]
                         of degree less than 
                           d
                           +
                           1
                        .

Furthermore, we consider a partition 
                           
                              
                                 G
                              
                              
                                 Ω
                              
                           
                         of a polygonal domain 
                           Ω
                           ⊂
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                         into mutually disjoint cells, where each cell is an open set and the closure of the union of all cells equals Ω. In addition we choose a finite-dimensional linear space T of functions on 
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                        .


                        
                           Definition 1
                           We define 
                                 
                                    
                                       S
                                    
                                    
                                       r
                                    
                                 
                                 (
                                 
                                    
                                       G
                                    
                                    
                                       Ω
                                    
                                 
                                 ,
                                 T
                                 )
                               to be the space of 
                                 
                                    
                                       C
                                    
                                    
                                       r
                                    
                                 
                              -smooth functions s on Ω with the property that their restrictions (denoted by the vertical bar 
                                 
                                    
                                       s
                                       |
                                    
                                    
                                       △
                                    
                                 
                              ) to any cell 
                                 △
                                 ∈
                                 
                                    
                                       G
                                    
                                    
                                       Ω
                                    
                                 
                               yields a function which is obtained by restricting a function in T to the cell, i.e.,
                                 
                                    (1)
                                    
                                       
                                          
                                             
                                                
                                                   S
                                                
                                                
                                                   r
                                                
                                             
                                             (
                                             
                                                
                                                   G
                                                
                                                
                                                   Ω
                                                
                                             
                                             ,
                                             T
                                             )
                                             =
                                             
                                                
                                                   {
                                                   s
                                                   ∈
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         r
                                                      
                                                   
                                                   (
                                                   Ω
                                                   )
                                                   :
                                                   s
                                                   |
                                                
                                                
                                                   △
                                                
                                             
                                             ∈
                                             T
                                             |
                                          
                                          
                                             △
                                          
                                       
                                       for all cells 
                                       △
                                       ∈
                                       
                                          
                                             G
                                          
                                          
                                             Ω
                                          
                                       
                                       }
                                       ,
                                    
                                 
                               where the linear space 
                                 
                                    
                                       T
                                       |
                                    
                                    
                                       △
                                    
                                 
                               contains the restrictions of the functions in T to the cell △.

We will call the above space a spline space, and its elements spline functions or simply splines. This definition is quite general and applies to any partition of a planar domain in 
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                         and to any linear space T. A typical choice is 
                           T
                           =
                           
                              
                                 P
                              
                              
                                 d
                              
                           
                        , but other choices are also envisaged in this paper.

In a slight abuse of notation we will also use this definition for the case 
                           r
                           =
                           −
                           1
                        , where we obtain the space 
                           
                              
                                 S
                              
                              
                                 −
                                 1
                              
                           
                           (
                           
                              
                                 G
                              
                              
                                 Ω
                              
                           
                           ,
                           T
                           )
                         of disconnected splines on 
                           
                              
                                 G
                              
                              
                                 Ω
                              
                           
                        . Strictly speaking, these spline functions are well-defined only on the interior of the cells, 
                           
                              
                                 ⋃
                              
                              
                                 △
                                 ∈
                                 
                                    
                                       G
                                    
                                    
                                       Ω
                                    
                                 
                              
                           
                           △
                        , since they may take multiple values on edges and vertices.


                        
                           Example 2
                           If 
                                 T
                                 =
                                 
                                    
                                       P
                                    
                                    
                                       d
                                    
                                 
                              , we obtain the spline space formed by the 
                                 
                                    
                                       C
                                    
                                    
                                       r
                                    
                                 
                              -smooth piecewise polynomials of (total) degree d. Typically, this space is used when considering triangulations of the domain. Alternatively one may consider bivariate tensor-product polynomials 
                                 T
                                 =
                                 
                                    
                                       P
                                    
                                    
                                       d
                                    
                                 
                                 ⊗
                                 
                                    
                                       P
                                    
                                    
                                       d
                                    
                                 
                               of bidegree 
                                 (
                                 d
                                 ,
                                 d
                                 )
                              , which are used in connection with partitions of the domain into axis-aligned boxes. Clearly, it is also possible to consider trigonometric polynomials 
                                 T
                                 =
                                 span
                                 {
                                 1
                                 ,
                                 cos
                                 ⁡
                                 k
                                 x
                                 ,
                                 sin
                                 ⁡
                                 k
                                 x
                                 :
                                 k
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 d
                                 }
                               or multivariate versions thereof. In this paper we are interested in a certain subspace 
                                 T
                                 =
                                 
                                    
                                       P
                                    
                                    
                                       ˆ
                                    
                                 
                               of 
                                 
                                    
                                       P
                                    
                                    
                                       4
                                    
                                 
                               which is generated by the polynomial segments of 
                                 
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                              -smooth quartic box splines on type-I triangulations. ◇

Throughout this paper, we consider a particular triangulation that allows to construct splines with good properties. More precisely, we consider the bi-infinite grid in 
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                         with lines 
                           R
                           ×
                           Z
                         and 
                           Z
                           ×
                           R
                        , and the triangulation obtained by adding the north–east diagonals in the squares of the grid, see Fig. 1. This produces a three-directional grid which we denote by G. The grid G is a set which contains the elementary triangles (which are called cells) as its elements, where each of the triangles is considered as an open subset of 
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                        .

This type of grid is called a type-I triangulation (e.g. Lai and Schumaker, 2007), and spline spaces on triangulations of this type have been studied thoroughly in the rich literature on this subject. In particular, they include box spline spaces, which are interesting due to their elegant construction and simple refinement algorithm.

All results concerning splines on type-I triangulation remain valid under affine transformations of the underlying grid G. For instance, these transformations include scalings of the grid (and we will use this fact later when constructing hierarchical spline spaces), but also affine mappings that transform all triangles into equilateral ones, a particular case which reveals the built-in symmetries of these spline spaces.

We restrict ourselves to polynomials 
                           
                              
                                 P
                              
                              
                                 4
                              
                           
                         of degree up to four and we will denote this space simply by 
                           P
                        . For each triangle 
                           △
                           ∈
                           G
                        , let us denote by 
                           
                              
                                 P
                                 |
                              
                              
                                 △
                              
                           
                         the linear space formed by the restrictions 
                           
                              
                                 f
                                 |
                              
                              
                                 △
                              
                           
                         of all polynomials 
                           f
                           ∈
                           P
                         to △, i.e.,
                           
                              
                                 
                                    
                                       P
                                       |
                                    
                                    
                                       △
                                    
                                 
                                 =
                                 
                                    
                                       {
                                       f
                                       |
                                    
                                    
                                       △
                                    
                                 
                                 :
                                 f
                                 ∈
                                 P
                                 }
                                 .
                              
                           
                         For a given triangle △, any bivariate polynomial can be represented as a linear combination of the associated bivariate Bernstein polynomials on this triangle (Lai and Schumaker, 2007),
                           
                              (2)
                              
                                 
                                    
                                       f
                                       |
                                    
                                    
                                       △
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       i
                                       +
                                       j
                                       +
                                       k
                                       =
                                       4
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       i
                                       j
                                       k
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       i
                                       j
                                       k
                                    
                                    
                                       4
                                    
                                 
                                 
                                 ,
                              
                           
                         with real coefficients 
                           
                              
                                 c
                              
                              
                                 i
                                 j
                                 k
                              
                           
                        . Each Bernstein polynomial 
                           
                              
                                 B
                              
                              
                                 i
                                 j
                                 k
                              
                              
                                 4
                              
                           
                         has an associated anchor point, which possesses the barycentric coordinates 
                           (
                           i
                           /
                           4
                           ,
                           j
                           /
                           4
                           ,
                           k
                           /
                           4
                           )
                         with respect to the triangle. This representation of the polynomials is quite useful for the efficient evaluation of the functions and their derivatives at a given point (Kim and Peters, 2009; Lai and Schumaker, 2007).

The coefficients in Fig. 2
                        , which are placed according to the associated anchor points, define a piecewise polynomial function, whose support is the set of these triangles. The multiple 1/24 of this function is the symmetric quartic box spline (cf. Lai and Schumaker, 2007 for more details). This box spline is a 
                           
                              
                                 C
                              
                              
                                 2
                              
                           
                        -smooth function on the three-direction grid and will be our main object of interest. It will be denoted by 
                           B
                        . Note that this box spline forms the mathematical basis of Loop subdivision surfaces (Loop, 1987; Stollnitz et al., 1996).

The translates
                           
                              
                                 
                                    
                                       β
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 (
                                 ⋅
                                 )
                                 =
                                 B
                                 (
                                 ⋅
                                 −
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 )
                                 ,
                                 
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 ∈
                                 
                                    
                                       Z
                                    
                                    
                                       2
                                    
                                 
                              
                           
                         are known to form a locally linearly independent set
                           
                              (3)
                              
                                 B
                                 =
                                 {
                                 
                                    
                                       β
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 
                                 :
                                 
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 ∈
                                 
                                    
                                       Z
                                    
                                    
                                       2
                                    
                                 
                                 }
                              
                           
                         in the following sense: for any open subset 
                           A
                           ⊂
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                        , the translates
                           
                              
                                 
                                    
                                       B
                                    
                                    
                                       A
                                    
                                 
                                 =
                                 {
                                 
                                    
                                       β
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 ∈
                                 B
                                 :
                                 supp
                                 (
                                 
                                    
                                       β
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 )
                                 ∩
                                 A
                                 ≠
                                 ∅
                                 }
                              
                           
                         restricted to A are linearly independent (Lai and Schumaker, 2007). Here 
                           supp
                           (
                           f
                           )
                         denotes the support of the function f.

By construction, each translated box spline 
                           
                              
                                 β
                              
                              
                                 i
                                 j
                              
                           
                         is associated with the lattice point 
                           (
                           i
                           ,
                           j
                           )
                        . For a cell △ in G, let 
                           
                              
                                 △
                              
                              
                                 ¯
                              
                           
                         denote the closure of △. We consider the translates whose support contains the given cell △,
                           
                              
                                 
                                    
                                       B
                                    
                                    
                                       △
                                    
                                 
                                 =
                                 {
                                 
                                    
                                       β
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 :
                                 supp
                                 (
                                 
                                    
                                       β
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 )
                                 ∩
                                 △
                                 ≠
                                 ∅
                                 }
                                 .
                              
                           
                         This set is formed by the 12 translates 
                           
                              
                                 β
                              
                              
                                 i
                                 j
                              
                           
                        , which are associated with the vertices of the 1-ring neighborhood of △ in the three directional grid, see Fig. 3
                        .

We now consider the linear space spanned by the restrictions of these translates to the given triangle,
                           
                              (4)
                              
                                 
                                    
                                       
                                          
                                             
                                                V
                                             
                                             
                                                △
                                             
                                          
                                          =
                                          (
                                          span
                                          
                                          
                                             
                                                B
                                             
                                             
                                                △
                                             
                                          
                                          )
                                          |
                                       
                                       
                                          △
                                       
                                    
                                    .
                                 
                              
                           
                         Since this space is a genuine subset of quartic polynomials (its dimension is only 12), we will call it the space of special quartics on △.


                        
                           Remark 3
                           It can be shown that 
                                 
                                    
                                       
                                          
                                             V
                                          
                                          
                                             △
                                          
                                       
                                       =
                                       
                                          
                                             P
                                          
                                          
                                             ˆ
                                          
                                       
                                       |
                                    
                                    
                                       △
                                    
                                 
                               where
                                 
                                    (5)
                                    
                                       
                                          
                                             
                                                P
                                             
                                             
                                                ˆ
                                             
                                          
                                          =
                                          span
                                          (
                                          
                                             
                                                P
                                             
                                             
                                                3
                                             
                                          
                                          ∪
                                          {
                                          
                                             
                                                x
                                             
                                             
                                                4
                                             
                                          
                                          −
                                          2
                                          
                                             
                                                x
                                             
                                             
                                                3
                                             
                                          
                                          y
                                          ,
                                          
                                             
                                                y
                                             
                                             
                                                4
                                             
                                          
                                          −
                                          2
                                          x
                                          
                                             
                                                y
                                             
                                             
                                                3
                                             
                                          
                                          }
                                          )
                                          .
                                       
                                    
                                 
                               In particular, it should be noted that 
                                 
                                    
                                       P
                                    
                                    
                                       ˆ
                                    
                                 
                               is independent of the chosen cell △. The proof of this observation is postponed to the Appendix A. ◇

Any polynomial 
                           
                              
                                 f
                                 |
                              
                              
                                 △
                              
                           
                           ∈
                           
                              
                                 V
                              
                              
                                 △
                              
                           
                         has a unique representation
                           
                              
                                 
                                    
                                       f
                                       |
                                    
                                    
                                       △
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 
                                    ∑
                                    
                                       β
                                       ∈
                                       
                                          
                                             B
                                          
                                          
                                             △
                                          
                                       
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       △
                                    
                                    
                                       β
                                    
                                 
                                 
                                    
                                       (
                                       f
                                       |
                                    
                                    
                                       △
                                    
                                 
                                 )
                                 
                                 β
                                 (
                                 x
                                 )
                                 ,
                                 
                                 x
                                 ∈
                                 △
                                 ,
                              
                           
                         for certain coefficients 
                           
                              
                                 λ
                              
                              
                                 △
                              
                              
                                 β
                              
                           
                           
                              
                                 (
                                 f
                                 |
                              
                              
                                 △
                              
                           
                           )
                           ∈
                           R
                        .

Now we consider two cells △ and 
                           
                              
                                 △
                              
                              
                                 ′
                              
                           
                         which share an edge. The 1-rings around △ and 
                           
                              
                                 △
                              
                              
                                 ′
                              
                           
                         have 10 vertices in common, or equivalently, 
                           
                              
                                 B
                              
                              
                                 △
                              
                           
                        , and 
                           
                              
                                 B
                              
                              
                                 
                                    
                                       △
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                         share 10 elements, see Fig. 4
                        .

The following notion of contact will be important in the sequel for the definition of spline spaces. 
                           Definition 4
                           We say that two polynomials 
                                 
                                    
                                       f
                                       |
                                    
                                    
                                       △
                                    
                                 
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       △
                                    
                                 
                               and 
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             ′
                                          
                                       
                                       |
                                    
                                    
                                       
                                          
                                             △
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       
                                          
                                             △
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                               have contact of order 2 (and write 
                                 
                                    
                                       
                                          
                                             f
                                             |
                                          
                                          
                                             △
                                          
                                       
                                       ∼
                                       
                                          
                                             f
                                          
                                          
                                             ′
                                          
                                       
                                       |
                                    
                                    
                                       
                                          
                                             △
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              ), if
                                 
                                    (6)
                                    
                                       
                                          
                                             
                                                
                                                   ∀
                                                   x
                                                   ∈
                                                   
                                                      
                                                         △
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                   ∩
                                                   
                                                      
                                                         
                                                            
                                                               △
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   ,
                                                   
                                                   
                                                   
                                                      
                                                         
                                                            ∂
                                                         
                                                         
                                                            i
                                                            +
                                                            j
                                                         
                                                      
                                                      
                                                         ∂
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         ∂
                                                         
                                                            
                                                               y
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                   f
                                                   |
                                                
                                                
                                                   △
                                                
                                             
                                             (
                                             x
                                             )
                                             =
                                             
                                                
                                                   
                                                      ∂
                                                   
                                                   
                                                      i
                                                      +
                                                      j
                                                   
                                                
                                                
                                                   ∂
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ∂
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   f
                                                
                                                
                                                   ′
                                                
                                             
                                             |
                                          
                                          
                                             
                                                
                                                   △
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                       (
                                       x
                                       )
                                    
                                 
                               for all i and j with 
                                 0
                                 ≤
                                 i
                                 +
                                 j
                                 ≤
                                 2
                              . The derivatives and values at points on the boundary of a triangle are obtained by one-sided limits.

This property of contact, or continuity of higher order, is a desired property in applications. The following lemma will help us to characterize the situation of contact of quartic box splines.


                        
                           Lemma 5
                           
                              Consider a domain 
                              
                                 Ω
                                 =
                                 
                                    
                                       △
                                       ∪
                                       
                                          
                                             △
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    ‾
                                 
                               
                              consisting of two triangles meeting on one edge. Then 
                              
                                 dim
                                 ⁡
                                 
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       G
                                    
                                    
                                       Ω
                                    
                                 
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       ˆ
                                    
                                 
                                 )
                                 =
                                 14
                              
                              .
                           

Let 
                                 ℓ
                                 (
                                 x
                                 ,
                                 y
                                 )
                               be the (implicit) equation of the line that contains the common edge of the two triangles.

Let 
                                 
                                    
                                       
                                          
                                             (
                                             f
                                             |
                                          
                                          
                                             △
                                          
                                       
                                       ,
                                       
                                          
                                             f
                                          
                                          
                                             ′
                                          
                                       
                                       |
                                    
                                    
                                       
                                          
                                             △
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 )
                                 ∈
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       G
                                    
                                    
                                       Ω
                                    
                                 
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       ˆ
                                    
                                 
                                 )
                              , then
                                 
                                    
                                       
                                          
                                             
                                                
                                                   f
                                                   |
                                                
                                                
                                                   △
                                                
                                             
                                             −
                                             
                                                
                                                   f
                                                
                                                
                                                   ′
                                                
                                             
                                             |
                                          
                                          
                                             
                                                
                                                   △
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                       =
                                       
                                          
                                             ℓ
                                          
                                          
                                             3
                                          
                                       
                                       (
                                       a
                                       x
                                       +
                                       b
                                       y
                                       +
                                       c
                                       )
                                       ,
                                    
                                 
                               since 
                                 ℓ
                                 
                                    
                                       (
                                       x
                                       ,
                                       y
                                       )
                                    
                                    
                                       3
                                    
                                 
                                 |
                                 (
                                 f
                                 −
                                 
                                    
                                       f
                                    
                                    
                                       ′
                                    
                                 
                                 )
                               is equivalent to 
                                 
                                    
                                       
                                          
                                             f
                                             |
                                          
                                          
                                             △
                                          
                                       
                                       ∼
                                       
                                          
                                             f
                                          
                                          
                                             ′
                                          
                                       
                                       |
                                    
                                    
                                       
                                          
                                             △
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              . Therefore
                                 
                                    (7)
                                    
                                       f
                                       =
                                       
                                          
                                             f
                                          
                                          
                                             ′
                                          
                                       
                                       +
                                       
                                          
                                             (
                                             A
                                             x
                                             +
                                             B
                                             y
                                             +
                                             C
                                             )
                                          
                                          
                                             3
                                          
                                       
                                       (
                                       a
                                       x
                                       +
                                       b
                                       y
                                       +
                                       c
                                       )
                                       ,
                                    
                                 
                               where 
                                 ℓ
                                 (
                                 x
                                 ,
                                 y
                                 )
                                 =
                                 A
                                 x
                                 +
                                 B
                                 y
                                 +
                                 C
                              , for 
                                 A
                                 ,
                                 B
                                 ,
                                 C
                                 ∈
                                 R
                              .

Since the grid 
                                 
                                    
                                       G
                                    
                                    
                                       Ω
                                    
                                 
                               has only three directions, we only need to consider the cases: 
                                 (
                                 A
                                 ,
                                 B
                                 ,
                                 C
                                 )
                                 =
                                 (
                                 1
                                 ,
                                 0
                                 ,
                                 t
                                 )
                              ,  
                                 (
                                 0
                                 ,
                                 1
                                 ,
                                 t
                                 )
                               or 
                                 (
                                 1
                                 ,
                                 −
                                 1
                                 ,
                                 t
                                 )
                              , for 
                                 t
                                 ∈
                                 R
                              .

If 
                                 (
                                 A
                                 ,
                                 B
                                 ,
                                 C
                                 )
                                 =
                                 (
                                 1
                                 ,
                                 0
                                 ,
                                 t
                                 )
                              , then (7) becomes
                                 
                                    
                                       f
                                       =
                                       
                                          
                                             f
                                          
                                          
                                             ′
                                          
                                       
                                       +
                                       a
                                       
                                          
                                             x
                                          
                                          
                                             4
                                          
                                       
                                       +
                                       b
                                       y
                                       
                                          
                                             x
                                          
                                          
                                             3
                                          
                                       
                                       +
                                       p
                                       (
                                       a
                                       ,
                                       b
                                       ,
                                       c
                                       )
                                    
                                 
                               for a polynomial 
                                 p
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       3
                                    
                                 
                               that depends on 
                                 a
                                 ,
                                 b
                               and c. Since 
                                 f
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       ′
                                    
                                 
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       ˆ
                                    
                                 
                              , from Remark 3 we deduce that 
                                 b
                                 =
                                 −
                                 2
                                 a
                              , leading to
                                 
                                    (8)
                                    
                                       f
                                       =
                                       
                                          
                                             f
                                          
                                          
                                             ′
                                          
                                       
                                       +
                                       a
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             4
                                          
                                       
                                       −
                                       2
                                       
                                          
                                             x
                                          
                                          
                                             3
                                          
                                       
                                       y
                                       )
                                       +
                                       p
                                       (
                                       a
                                       ,
                                       c
                                       )
                                       .
                                    
                                 
                               The case 
                                 (
                                 A
                                 ,
                                 B
                                 ,
                                 C
                                 )
                                 =
                                 (
                                 0
                                 ,
                                 1
                                 ,
                                 t
                                 )
                               is analogous to latter due to the symmetry of the generators of 
                                 
                                    
                                       P
                                    
                                    
                                       ˆ
                                    
                                 
                               with respect to x and y.

It remains to consider 
                                 (
                                 A
                                 ,
                                 B
                                 ,
                                 C
                                 )
                                 =
                                 (
                                 1
                                 ,
                                 −
                                 1
                                 ,
                                 t
                                 )
                              . In this case (7) becomes
                                 
                                    (9)
                                    
                                       f
                                       =
                                       
                                          
                                             f
                                          
                                          
                                             ′
                                          
                                       
                                       +
                                       a
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             4
                                          
                                       
                                       −
                                       3
                                       
                                          
                                             x
                                          
                                          
                                             3
                                          
                                       
                                       y
                                       +
                                       3
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             y
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       x
                                       
                                          
                                             y
                                          
                                          
                                             3
                                          
                                       
                                       )
                                       +
                                       b
                                       (
                                       y
                                       
                                          
                                             x
                                          
                                          
                                             3
                                          
                                       
                                       −
                                       3
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             y
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       3
                                       x
                                       
                                          
                                             y
                                          
                                          
                                             3
                                          
                                       
                                       −
                                       
                                          
                                             y
                                          
                                          
                                             4
                                          
                                       
                                       )
                                       +
                                       p
                                       (
                                       a
                                       ,
                                       b
                                       ,
                                       c
                                       )
                                    
                                 
                               for a polynomial 
                                 p
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       3
                                    
                                 
                               that depends on 
                                 a
                                 ,
                                 b
                               and c. Since 
                                 f
                                 ,
                                 
                                    
                                       f
                                    
                                    
                                       ′
                                    
                                 
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       ˆ
                                    
                                 
                              , from Remark 3 we know that 
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       2
                                    
                                 
                                 ∉
                                 
                                    
                                       P
                                    
                                    
                                       ˆ
                                    
                                 
                              , then we deduce that 
                                 b
                                 =
                                 a
                              , leading to
                                 
                                    
                                       f
                                       =
                                       
                                          
                                             f
                                          
                                          
                                             ′
                                          
                                       
                                       +
                                       a
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             4
                                          
                                       
                                       −
                                       2
                                       
                                          
                                             x
                                          
                                          
                                             3
                                          
                                       
                                       y
                                       )
                                       −
                                       a
                                       (
                                       
                                          
                                             y
                                          
                                          
                                             4
                                          
                                       
                                       −
                                       2
                                       x
                                       
                                          
                                             y
                                          
                                          
                                             3
                                          
                                       
                                       )
                                       +
                                       p
                                       (
                                       a
                                       ,
                                       c
                                       )
                                       .
                                    
                                 
                               Thus, it follows from (8) and (9) that 
                                 dim
                                 ⁡
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       G
                                    
                                    
                                       Ω
                                    
                                 
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       ˆ
                                    
                                 
                                 )
                                 =
                                 14
                              .  □

We now come to the characterization of contact of polynomial pieces.


                        
                           Lemma 6
                           Contact Characterization Lemma (CCL)


                           
                              Consider two special polynomials 
                              
                                 
                                    
                                       f
                                       |
                                    
                                    
                                       △
                                    
                                 
                                 ∈
                                 
                                    
                                       V
                                    
                                    
                                       △
                                    
                                 
                               
                              and 
                              
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             ′
                                          
                                       
                                       |
                                    
                                    
                                       
                                          
                                             △
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 ∈
                                 
                                    
                                       V
                                    
                                    
                                       
                                          
                                             △
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                               
                              on two disjoint triangles 
                              
                                 △
                                 ,
                                 
                                    
                                       △
                                    
                                    
                                       ′
                                    
                                 
                              
                              , and assume that the two triangles share an edge 
                              
                                 e
                                 =
                                 
                                    
                                       △
                                    
                                    
                                       ¯
                                    
                                 
                                 ∩
                                 
                                    
                                       
                                          
                                             △
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       ′
                                    
                                 
                              
                              . The two polynomials 
                              
                                 
                                    
                                       f
                                       |
                                    
                                    
                                       △
                                    
                                 
                               
                              and 
                              
                                 
                                    
                                       
                                          
                                             f
                                          
                                          
                                             ′
                                          
                                       
                                       |
                                    
                                    
                                       
                                          
                                             △
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                               
                              have a contact of order 2 if and only if
                              
                                 
                                    (10)
                                    
                                       
                                          
                                             
                                                
                                                   ∀
                                                   
                                                   β
                                                   ∈
                                                   B
                                                   
                                                   :
                                                   
                                                   β
                                                   |
                                                
                                                
                                                   e
                                                
                                             
                                             ≠
                                             0
                                             |
                                          
                                          
                                             e
                                          
                                       
                                       ⇒
                                       
                                          
                                             λ
                                          
                                          
                                             △
                                          
                                          
                                             β
                                          
                                       
                                       
                                          
                                             (
                                             f
                                             |
                                          
                                          
                                             △
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             λ
                                          
                                          
                                             
                                                
                                                   △
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                          
                                             β
                                          
                                       
                                       
                                          
                                             (
                                             
                                                
                                                   f
                                                
                                                
                                                   ′
                                                
                                             
                                             |
                                          
                                          
                                             
                                                
                                                   △
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                       )
                                       .
                                    
                                 
                              
                           

Firstly, we observe that 
                                 
                                    
                                       
                                          
                                             f
                                             |
                                          
                                          
                                             △
                                          
                                       
                                       ∼
                                       
                                          
                                             f
                                          
                                          
                                             ′
                                          
                                       
                                       |
                                    
                                    
                                       
                                          
                                             △
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                               is equivalent to
                                 
                                    
                                       
                                          
                                             F
                                             =
                                             
                                                
                                                   (
                                                   f
                                                   |
                                                
                                                
                                                   △
                                                
                                             
                                             ,
                                             f
                                             |
                                          
                                          
                                             
                                                
                                                   △
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                       )
                                       ∈
                                       
                                          
                                             S
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       
                                          
                                             G
                                          
                                          
                                             Ω
                                          
                                       
                                       ,
                                       
                                          
                                             P
                                          
                                          
                                             ˆ
                                          
                                       
                                       )
                                       ,
                                    
                                 
                               where 
                                 Ω
                                 =
                                 
                                    
                                       △
                                       ∪
                                       
                                          
                                             △
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    ‾
                                 
                              . Secondly, noting that there are 14 box splines in 
                                 
                                    
                                       B
                                    
                                    
                                       Ω
                                    
                                 
                               (see Fig. 4) and in view of Lemma 5, we conclude that 
                                 
                                    
                                       B
                                    
                                    
                                       Ω
                                    
                                 
                               is a basis for 
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       G
                                    
                                    
                                       Ω
                                    
                                 
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       ˆ
                                    
                                 
                                 )
                              . Consequently, 
                                 F
                                 ∈
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       G
                                    
                                    
                                       Ω
                                    
                                 
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       ˆ
                                    
                                 
                                 )
                               if and only if there exist unique coefficients 
                                 
                                    
                                       c
                                    
                                    
                                       β
                                    
                                 
                                 ∈
                                 R
                               such that
                                 
                                    (11)
                                    
                                       
                                          F
                                          =
                                          
                                             ∑
                                             
                                                β
                                                ∈
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      △
                                                      ∪
                                                      
                                                         
                                                            △
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                c
                                             
                                             
                                                β
                                             
                                          
                                          β
                                          .
                                       
                                    
                                 
                               Thirdly, we consider the restrictions of F to the two triangles,
                                 
                                    
                                       
                                          
                                             
                                                F
                                                |
                                             
                                             
                                                △
                                             
                                          
                                          
                                             
                                                =
                                                
                                                   ∑
                                                   
                                                      β
                                                      ∈
                                                      
                                                         
                                                            B
                                                         
                                                         
                                                            △
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      λ
                                                   
                                                   
                                                      △
                                                   
                                                   
                                                      β
                                                   
                                                
                                                (
                                                f
                                                )
                                                β
                                                ,
                                                
                                                F
                                                |
                                             
                                             
                                                
                                                   
                                                      △
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          =
                                          
                                             ∑
                                             
                                                β
                                                ∈
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      
                                                         
                                                            △
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                λ
                                             
                                             
                                                
                                                   
                                                      △
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                             
                                                β
                                             
                                          
                                          (
                                          
                                             
                                                f
                                             
                                             
                                                ′
                                             
                                          
                                          )
                                          β
                                          .
                                       
                                    
                                 
                               Due to the local linear independence of the box splines, the existence of the representation (11) is equivalent to
                                 
                                    
                                       
                                          
                                             
                                                λ
                                             
                                             
                                                △
                                             
                                             
                                                β
                                             
                                          
                                          (
                                          f
                                          )
                                          =
                                          
                                             
                                                c
                                             
                                             
                                                β
                                             
                                          
                                          =
                                          
                                             
                                                λ
                                             
                                             
                                                △
                                             
                                             
                                                β
                                             
                                          
                                          (
                                          
                                             
                                                f
                                             
                                             
                                                ′
                                             
                                          
                                          )
                                          
                                           for 
                                          
                                          β
                                          ∈
                                          
                                             
                                                B
                                             
                                             
                                                △
                                             
                                          
                                          ∩
                                          
                                             
                                                B
                                             
                                             
                                                
                                                   
                                                      △
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                          .
                                       
                                    
                                 
                               This completes the proof since 
                                 
                                    
                                       B
                                    
                                    
                                       △
                                    
                                 
                                 ∩
                                 
                                    
                                       B
                                    
                                    
                                       
                                          
                                             △
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                               coincides with the set of box splines that do not vanish on the common edge e.  □


                        
                           Remark 7
                           CCL cannot be generalized to two triangles with vertex–vertex contact. In fact, the dimension of the corresponding spline space, which is 18, is then always larger than the number of box splines (either 16 or 17, depending on the type vertex–vertex contact).

We now turn our attention to a domain consisting of a collection of cells and we establish conditions for obtaining a basis of the special quartics on the domain.

In the three-directional grid G, we will consider a finite set of cells (triangles) 
                           M
                           ⊂
                           G
                        . Any such set M corresponds to a bounded domain 
                           M
                        , which is the closure of the union of its cells.

More precisely, we define the union operator U, which maps any element Q of the power set of 
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                         to a subset of 
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                        ,
                           
                              (12)
                              
                                 U
                                 (
                                 Q
                                 )
                                 =
                                 
                                    
                                       
                                          ⋃
                                          
                                             c
                                             ∈
                                             Q
                                          
                                       
                                       c
                                    
                                    ‾
                                 
                              
                           
                         We can now formally define 
                           M
                         as
                           
                              (13)
                              
                                 M
                                 =
                                 U
                                 (
                                 M
                                 )
                                 .
                              
                           
                         If the domain 
                           M
                         is connected, then we will say that the set M of triangles is also connected. We need a stronger version of connectivity which excludes vertex–vertex contacts of triangles.


                        
                           Definition 8
                           A set M of triangles is said to be ⋆-connected if it is connected and if additionally for any two triangles △, 
                                 
                                    
                                       △
                                    
                                    
                                       ′
                                    
                                 
                               in M, which have a common vertex v, 
                                 
                                    
                                       △
                                    
                                    
                                       ¯
                                    
                                 
                                 ∩
                                 
                                    
                                       
                                          
                                             △
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       ′
                                    
                                 
                                 ⊇
                                 {
                                 v
                                 }
                              , there is a chain of triangles 
                                 
                                    
                                       △
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       △
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       △
                                    
                                    
                                       m
                                    
                                 
                               all in M such that 
                                 
                                    
                                       △
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 △
                              , 
                                 
                                    
                                       △
                                    
                                    
                                       m
                                    
                                 
                                 =
                                 
                                    
                                       △
                                    
                                    
                                       ′
                                    
                                 
                               and 
                                 
                                    
                                       
                                          
                                             △
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 ∩
                                 
                                    
                                       
                                          
                                             △
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       e
                                    
                                    
                                       i
                                    
                                 
                               for some edge 
                                 
                                    
                                       e
                                    
                                    
                                       i
                                    
                                 
                                 ∈
                                 M
                               that contains the vertex v, i.e. 
                                 v
                                 ∈
                                 
                                    
                                       e
                                    
                                    
                                       i
                                    
                                 
                              , for 
                                 i
                                 =
                                 0
                                 ,
                                 …
                                 ,
                                 m
                                 −
                                 1
                              .

In particular, two triangles are ⋆-connected triangles if they possess a common edge.

We require the following condition. 
                           Condition 9
                           The set M is assumed to be a union of finitely many mutually disconnected finite sets of triangles, each of which is ⋆-connected.

In particular, this condition on the set of triangles M implies that we do not allow “kissing vertices” in any connected component of 
                           M
                        ; or in other words, M is a triangulation of a 2-manifold 
                           M
                         with boundary.


                        
                           Example 10
                           The domain 
                                 M
                                 =
                                 U
                                 (
                                 M
                                 )
                               in Fig. 5
                               has only one component and it is not ⋆-connected. In Fig. 6
                              , the set of triangles M is modified in several ways by adding and deleting triangles and the different components (when more than one) are all ⋆-connected, and hence the domains satisfy Condition 9. ◇

In the remainder of the paper, every set M is assumed to satisfy Condition 9. The set of the translates of box splines that act on the triangles M will be denoted as
                           
                              
                                 
                                    
                                       B
                                    
                                    
                                       M
                                    
                                 
                                 =
                                 {
                                 
                                    
                                       β
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 ∈
                                 B
                                 
                                 :
                                 
                                 supp
                                 
                                 
                                    
                                       β
                                    
                                    
                                       i
                                       j
                                    
                                 
                                 ∩
                                 M
                                 °
                                 ≠
                                 ∅
                                 }
                                 ,
                              
                           
                         where 
                           M
                           °
                         denotes the interior of 
                           M
                        , see Fig. 7
                         for an example. These basis functions generate a space which we denote by
                           
                              (14)
                              
                                 
                                    
                                       
                                          
                                             V
                                          
                                          
                                             M
                                          
                                       
                                       =
                                       span
                                       
                                       
                                          
                                             B
                                          
                                          
                                             M
                                          
                                       
                                       |
                                    
                                    
                                       M
                                    
                                 
                                 .
                              
                           
                         In particular, when M contains just the single cell △ then
                           
                              
                                 
                                    
                                       
                                          
                                             V
                                          
                                          
                                             M
                                          
                                       
                                       =
                                       
                                          
                                             V
                                          
                                          
                                             {
                                             △
                                             }
                                          
                                       
                                       =
                                       
                                          
                                             V
                                          
                                          
                                             △
                                          
                                       
                                       =
                                       
                                          
                                             P
                                          
                                          
                                             ˆ
                                          
                                       
                                       |
                                    
                                    
                                       △
                                    
                                 
                                 
                                 ,
                              
                           
                         as in Remark 3.

For a finite set of triangles 
                           M
                           ⊂
                           G
                        , we consider the space of disconnected quartics 
                        
                           
                              
                                 S
                              
                              
                                 −
                                 1
                              
                           
                           (
                           M
                           ,
                           P
                           )
                        , and the space of disconnected special quartics 
                        
                           
                              
                                 S
                              
                              
                                 −
                                 1
                              
                           
                           (
                           M
                           ,
                           
                              
                                 P
                              
                              
                                 ˆ
                              
                           
                           )
                        . For 
                           M
                           =
                           {
                           △
                           }
                        , these two spaces coincide with 
                           
                              
                                 P
                                 |
                              
                              
                                 △
                              
                           
                         and with 
                           
                              
                                 
                                    
                                       P
                                    
                                    
                                       ˆ
                                    
                                 
                                 |
                              
                              
                                 △
                              
                           
                        , respectively. It is obvious that 
                           
                              
                                 S
                              
                              
                                 −
                                 1
                              
                           
                           (
                           M
                           ,
                           
                              
                                 P
                              
                              
                                 ˆ
                              
                           
                           )
                           ⊂
                           
                              
                                 S
                              
                              
                                 −
                                 1
                              
                           
                           (
                           M
                           ,
                           P
                           )
                         for any choice of M.

Given a disconnected special quartic 
                           
                              
                                 f
                                 =
                                 
                                    
                                       (
                                       f
                                       |
                                    
                                    
                                       △
                                    
                                 
                                 )
                              
                              
                                 △
                                 ∈
                                 M
                              
                           
                           ∈
                           
                              
                                 S
                              
                              
                                 −
                                 1
                              
                           
                           (
                           M
                           ,
                           
                              
                                 P
                              
                              
                                 ˆ
                              
                           
                           )
                        , we have a local representation
                           
                              
                                 
                                    
                                       
                                          
                                             f
                                             |
                                          
                                          
                                             △
                                          
                                       
                                       (
                                       x
                                       )
                                       =
                                       
                                          ∑
                                          
                                             β
                                             ∈
                                             B
                                          
                                       
                                       
                                          
                                             λ
                                          
                                          
                                             △
                                          
                                          
                                             β
                                          
                                       
                                       
                                          
                                             (
                                             f
                                             |
                                          
                                          
                                             △
                                          
                                       
                                       )
                                       β
                                       |
                                    
                                    
                                       △
                                    
                                 
                                 (
                                 x
                                 )
                                 ,
                                 
                                 x
                                 ∈
                                 △
                                 ,
                              
                           
                         in terms of the restriction of the box splines, for any 
                           △
                           ∈
                           M
                        . However, this representation is generally not available for general disconnected quartics.


                        
                           Lemma 11
                           
                              For a finite set of triangles M, and the corresponding disconnected space 
                              
                                 
                                    
                                       S
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 (
                                 M
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       ˆ
                                    
                                 
                                 )
                              
                              , the space 
                              
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 M
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       ˆ
                                    
                                 
                                 )
                               
                              is precisely
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   S
                                                
                                                
                                                   2
                                                
                                             
                                             (
                                             M
                                             ,
                                             
                                                
                                                   P
                                                
                                                
                                                   ˆ
                                                
                                             
                                             )
                                             =
                                             
                                                
                                                   {
                                                   f
                                                   ∈
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         −
                                                         1
                                                      
                                                   
                                                   (
                                                   M
                                                   ,
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                   )
                                                   
                                                   :
                                                   
                                                   ∀
                                                   △
                                                   ,
                                                   
                                                      
                                                         △
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   ∈
                                                   M
                                                   ,
                                                   
                                                   f
                                                   |
                                                
                                                
                                                   △
                                                
                                             
                                             ∼
                                             f
                                             |
                                          
                                          
                                             
                                                
                                                   △
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                       }
                                    
                                 
                               
                              where the relation ∼ is defined in 
                              
                                 Definition 4
                              
                              .
                           

By the definition of the space of 
                                 
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                               splines given in (1), it is easy to deduce that 
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 M
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       ˆ
                                    
                                 
                                 )
                                 ⊂
                                 
                                    
                                       S
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 (
                                 M
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       ˆ
                                    
                                 
                                 )
                              . Let 
                                 f
                                 ∈
                                 
                                    
                                       S
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 (
                                 M
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       ˆ
                                    
                                 
                                 )
                              , then 
                                 f
                                 ∈
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 M
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       ˆ
                                    
                                 
                                 )
                               if and only if f is a 
                                 
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                               function on M, or equivalently, if and only if for all pair of cells △ and 
                                 
                                    
                                       △
                                    
                                    
                                       ′
                                    
                                 
                               in M satisfy (6) in Definition 4.  □

The space 
                           
                              
                                 S
                              
                              
                                 2
                              
                           
                           (
                           M
                           ,
                           
                              
                                 P
                              
                              
                                 ˆ
                              
                           
                           )
                         will be referred to as the special spline space on M.

As we shall see later, the special spline space 
                           
                              
                                 S
                              
                              
                                 2
                              
                           
                           (
                           M
                           ,
                           
                              
                                 P
                              
                              
                                 ˆ
                              
                           
                           )
                         can be generated by box splines with support on 
                           M
                        , but one may need to use several copies of some of these box splines, as shown in the following Example.


                        
                           Example 12
                           The domain in Fig. 8
                               consists of two ⋆-disconnected triangles. The space of disconnected special quartics consists of pairs of special polynomials, where the first and the second entry of each pair is associated with the first and the second triangle. Since the two triangles are disconnected, the special spline space is equal to the space of disconnected special quartics. Consequently, it has dimension 24 and is therefore not spanned by the 18 box splines whose support intersects this domain. ◇


                        
                           Definition 13
                           For a spline 
                                 β
                                 ∈
                                 
                                    
                                       B
                                    
                                    
                                       M
                                    
                                 
                              , the coefficient graph 
                              
                                 
                                    
                                       Γ
                                    
                                    
                                       β
                                    
                                 
                               associated to β is defined as follows:
                                 
                                    •
                                    The vertices of the graph 
                                          
                                             
                                                Γ
                                             
                                             
                                                β
                                             
                                          
                                        are the cells 
                                          △
                                          ∈
                                          M
                                        such that 
                                          △
                                          ⊆
                                          supp
                                          
                                          β
                                       .

Two vertices of 
                                          
                                             
                                                Γ
                                             
                                             
                                                β
                                             
                                          
                                        are connected by an edge if the corresponding cells 
                                          △
                                          ,
                                          
                                             
                                                △
                                             
                                             
                                                ′
                                             
                                          
                                        have a common edge and 
                                          
                                             
                                                
                                                   
                                                      β
                                                      |
                                                   
                                                   
                                                      
                                                         
                                                            △
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                      ∩
                                                      
                                                         
                                                            
                                                               
                                                                  △
                                                               
                                                               
                                                                  ¯
                                                               
                                                            
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                
                                                ≠
                                                0
                                                |
                                             
                                             
                                                
                                                   
                                                      △
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                                ∩
                                                
                                                   
                                                      
                                                         
                                                            △
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                          
                                       .

We will write 
                           △
                           ∈
                           
                              
                                 Γ
                              
                              
                                 β
                              
                           
                         to indicate that △ corresponds to a vertex of 
                           
                              
                                 Γ
                              
                              
                                 β
                              
                           
                        .


                        
                           Example 14
                           Let us consider the domain in Fig. 9
                              , and the box splines 
                                 
                                    
                                       β
                                    
                                    
                                       i
                                    
                                 
                               
                              
                                 (
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 3
                                 )
                              . The coefficient graphs 
                                 
                                    
                                       Γ
                                    
                                    
                                       
                                          
                                             β
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                               corresponding to these box splines are given in Fig. 10
                              . ◇


                        
                           Proposition 15
                           
                              An element 
                              
                                 f
                                 ∈
                                 
                                    
                                       S
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 (
                                 M
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       ˆ
                                    
                                 
                                 )
                               
                              is in 
                              
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 M
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       ˆ
                                    
                                 
                                 )
                               
                              if and only if the coefficients satisfy 
                              
                                 
                                    
                                       λ
                                    
                                    
                                       △
                                    
                                    
                                       β
                                    
                                 
                                 
                                    
                                       (
                                       f
                                       |
                                    
                                    
                                       △
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       λ
                                    
                                    
                                       
                                          
                                             △
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                       β
                                    
                                 
                                 
                                    
                                       (
                                       f
                                       |
                                    
                                    
                                       
                                          
                                             △
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 )
                              
                              , for all 
                              
                                 β
                                 ∈
                                 
                                    
                                       B
                                    
                                    
                                       M
                                    
                                 
                              
                              , and all pair of cells 
                              
                                 △
                                 ,
                                 
                                    
                                       △
                                    
                                    
                                       ′
                                    
                                 
                               
                              belonging to the same component of 
                              
                                 
                                    
                                       Γ
                                    
                                    
                                       β
                                    
                                 
                              
                              .
                           

Suppose 
                                 f
                                 ∈
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 M
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       ˆ
                                    
                                 
                                 )
                              , and β in 
                                 B
                              . If 
                                 △
                                 =
                                 
                                    
                                       △
                                    
                                    
                                       0
                                    
                                 
                               and 
                                 
                                    
                                       △
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 
                                    
                                       △
                                    
                                    
                                       d
                                       +
                                       1
                                    
                                 
                               are two cells in M corresponding to vertices in the same component of 
                                 
                                    
                                       Γ
                                    
                                    
                                       β
                                    
                                 
                              , then there is a chain of vertices 
                                 
                                    
                                       v
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       d
                                    
                                 
                               in 
                                 
                                    
                                       Γ
                                    
                                    
                                       β
                                    
                                 
                               corresponding to cells 
                                 
                                    
                                       △
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       △
                                    
                                    
                                       d
                                    
                                 
                               in M, such that 
                                 
                                    
                                       △
                                    
                                    
                                       i
                                    
                                 
                               and 
                                 
                                    
                                       △
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                               intersect in an edge, for 
                                 i
                                 =
                                 0
                                 ,
                                 …
                                 ,
                                 d
                              . By Lemma 6, 
                                 
                                    
                                       λ
                                    
                                    
                                       
                                          
                                             △
                                          
                                          
                                             i
                                          
                                       
                                    
                                    
                                       β
                                    
                                 
                                 
                                    
                                       (
                                       f
                                       |
                                    
                                    
                                       
                                          
                                             △
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       λ
                                    
                                    
                                       
                                          
                                             △
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                    
                                    
                                       β
                                    
                                 
                                 
                                    
                                       (
                                       f
                                       |
                                    
                                    
                                       
                                          
                                             △
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                    
                                 
                                 )
                              , and since this is valid for every 
                                 0
                                 ≤
                                 i
                                 ≤
                                 d
                              , then the same follows for △ and 
                                 
                                    
                                       △
                                    
                                    
                                       ′
                                    
                                 
                              .

Conversely, from a similar argument as before, if for any pair of triangles △ and 
                                 
                                    
                                       △
                                    
                                    
                                       ′
                                    
                                 
                               in M with an edge e in common we have that 
                                 
                                    
                                       λ
                                    
                                    
                                       △
                                    
                                    
                                       β
                                    
                                 
                                 
                                    
                                       (
                                       f
                                       |
                                    
                                    
                                       △
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       λ
                                    
                                    
                                       
                                          
                                             △
                                          
                                          
                                             ′
                                          
                                       
                                    
                                    
                                       β
                                    
                                 
                                 
                                    
                                       (
                                       f
                                       |
                                    
                                    
                                       
                                          
                                             △
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 )
                               for every basis function 
                                 β
                                 ∈
                                 B
                               such that 
                                 
                                    
                                       β
                                       |
                                    
                                    
                                       e
                                    
                                 
                                 ≠
                                 0
                              , then by Lemma 6 every linear combination of the basis functions β is in 
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 M
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       ˆ
                                    
                                 
                                 )
                              .  □


                        
                           Definition 16
                           For every 
                                 β
                                 ∈
                                 B
                               and every connected component Φ of 
                                 
                                    
                                       Γ
                                    
                                    
                                       β
                                    
                                 
                               we define the function
                                 
                                    
                                       
                                          
                                             β
                                          
                                          
                                             Φ
                                          
                                       
                                       (
                                       x
                                       )
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   β
                                                   (
                                                   x
                                                   )
                                                
                                                
                                                   if
                                                   
                                                   
                                                   x
                                                   ∈
                                                   U
                                                   (
                                                   Φ
                                                   )
                                                   ,
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   otherwise
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                               The set of these functions, for the different connected components of the graph 
                                 
                                    
                                       Γ
                                    
                                    
                                       β
                                    
                                 
                              , is denoted by Λ, more precisely,
                                 
                                    
                                       Λ
                                       =
                                       
                                          ⋃
                                          
                                             β
                                             ∈
                                             B
                                          
                                       
                                       {
                                       
                                          
                                             β
                                          
                                          
                                             Φ
                                          
                                       
                                       |
                                       
                                       Φ
                                         is a connected component of  
                                       
                                          
                                             Γ
                                          
                                          
                                             β
                                          
                                       
                                       }
                                       .
                                    
                                 
                              
                           


                              The set Λ, when restricted to 
                              
                                 M
                              
                              , forms a locally linearly independent basis for 
                              
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 M
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       ˆ
                                    
                                 
                                 )
                              
                              .
                           

The proof is analogous to that of Theorem 2.12 in Mokriš et al. (2014).


                        
                           Corollary 18
                           
                              If the intersection of the support of each β with the multi-cell domain 
                              
                                 M
                               
                              is ⋆-connected, then the functions in 
                              
                                 
                                    
                                       B
                                    
                                    
                                       M
                                    
                                 
                              
                              , when restricted to 
                              
                                 M
                              
                              , form a basis of 
                              
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 M
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       ˆ
                                    
                                 
                                 )
                              
                              .
                           

If the condition is satisfied, then for each 
                                 β
                                 ∈
                                 
                                    
                                       B
                                    
                                    
                                       M
                                    
                                 
                               the coefficient graph 
                                 
                                    
                                       Γ
                                    
                                    
                                       β
                                    
                                 
                               has either one component or it is empty. The result thus follows from Theorem 17.  □


                        
                           Example 19
                           The graph 
                                 
                                    
                                       Γ
                                    
                                    
                                       β
                                    
                                 
                              , associated to every β with non-empty intersection with the interior of 
                                 M
                               in Fig. 7, has only one component. From the previous Corollary, it follows that the functions in 
                                 
                                    
                                       B
                                    
                                    
                                       M
                                    
                                 
                              , restricted to 
                                 M
                              , form a basis for the special spline space 
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 M
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       ˆ
                                    
                                 
                                 )
                               on the domain 
                                 M
                              . ◇

In view of the discussion in the previous section, we give the following definition.


                     
                        Definition 20
                        A domain 
                              M
                              =
                              U
                              (
                              M
                              )
                            is said to be admissible, if the intersection of the support of any box spline with 
                              M
                            is ⋆-connected.

The following result is then obvious from Corollary 18:


                     
                        Corollary 21
                        
                           For any admissible domain 
                           
                              M
                           
                           , the functions in 
                           
                              
                                 
                                    B
                                 
                                 
                                    M
                                 
                              
                            
                           when restricted to 
                           
                              M
                            
                           form a basis of 
                           
                              
                                 
                                    S
                                 
                                 
                                    2
                                 
                              
                              (
                              M
                              ,
                              
                                 
                                    P
                                 
                                 
                                    ˆ
                                 
                              
                              )
                           
                           .
                        

A subset of admissible domains can be characterized by the offsets of their boundaries.


                     
                        Definition 22
                        We define the offset curve of a multi-cell domain M as follows: Consider any cell (triangle) in 
                              G
                              ∖
                              M
                           . If the boundary of this triangle shares a vertex with 
                              M
                           , but both incident edges are not part of the boundary of 
                              M
                           , then the opposite edge is added to the offset curve. We say that a domain 
                              M
                            satisfies the offset condition if its offset is a simple closed curve or a collection of simple closed curves.


                     
                        Proposition 23
                        
                           If a domain satisfies the offset condition, then it is also admissible.
                        


                     
                        Proof
                        The proof follows from a careful case-by-case analysis.  □


                     
                        Remark 24
                        For the domain on the left in Fig. 11
                            the box splines in 
                              
                                 
                                    B
                                 
                                 
                                    M
                                 
                              
                            form a basis for 
                              
                                 
                                    S
                                 
                                 
                                    2
                                 
                              
                              (
                              M
                              ,
                              
                                 
                                    P
                                 
                                 
                                    ˆ
                                 
                              
                              )
                           . In this situation, when the holes in the domain are “sufficiently small”, they do not split the support of any basis function 
                              β
                              ∈
                              
                                 
                                    B
                                 
                                 
                                    M
                                 
                              
                            and the result follows by Corollary 18. Consequently, the offset condition is not necessary for admissibility. ◇

We define the special spline spaces on a hierarchical grid and a hierarchical basis. We then prove the completeness of this basis under certain assumptions on the domain hierarchy.

Given an integer 
                           N
                           ≥
                           0
                        , we consider the hierarchical grids
                           
                              
                                 
                                    
                                       G
                                    
                                    
                                       ℓ
                                    
                                 
                                 
                                 ,
                                 
                                 
                                 ℓ
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 N
                              
                           
                         such that 
                           
                              
                                 G
                              
                              
                                 ℓ
                                 +
                                 1
                              
                           
                         is obtained from 
                           
                              
                                 G
                              
                              
                                 ℓ
                              
                           
                         by one global, uniform dyadic refinement step, where the coarsest grid 
                           
                              
                                 G
                              
                              
                                 1
                              
                           
                           =
                           G
                         is the one with vertices 
                           
                              
                                 Z
                              
                              
                                 2
                              
                           
                         which has been described in Section 2. More precisely, the grid 
                           
                              
                                 G
                              
                              
                                 ℓ
                                 +
                                 1
                              
                           
                           =
                           
                              1
                              2
                           
                           
                              
                                 G
                              
                              
                                 ℓ
                              
                           
                         is obtained by dividing all edges of triangles of 
                           
                              
                                 G
                              
                              
                                 ℓ
                              
                           
                         into two edges and adding three new interior edges, thus every triangle is split into four smaller ones, see Fig. 12
                        . The index ℓ will be called the level of the grid, and the number N specifies the number thereof. Each grid 
                           
                              
                                 G
                              
                              
                                 ℓ
                              
                           
                         is a set of triangles of the same shape, and these triangles are open sets.

In addition to the union operator U, see (12), which transforms a set Q of subsets of 
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                         into the closed subdomain 
                           U
                           (
                           Q
                           )
                           ⊂
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                         covered by it, we define the triangulation operators 
                        
                           
                              
                                 T
                              
                              
                                 ℓ
                              
                           
                         which restrict the grid of level ℓ to a given subset 
                           Q
                         of 
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                        ,
                           
                              
                                 
                                    
                                       T
                                    
                                    
                                       ℓ
                                    
                                 
                                 (
                                 Q
                                 )
                                 =
                                 {
                                 △
                                 ∈
                                 
                                    
                                       G
                                    
                                    
                                       ℓ
                                    
                                 
                                 
                                 :
                                 
                                 △
                                 ⊆
                                 Q
                                 }
                                 .
                              
                           
                         When applied to subsets of the corresponding grids, these operators are the inverses of the union operator, i.e. for any 
                           
                              
                                 M
                              
                              
                                 ℓ
                              
                           
                           ⊂
                           
                              
                                 G
                              
                              
                                 ℓ
                              
                           
                         we have 
                           
                              
                                 T
                              
                              
                                 ℓ
                              
                           
                           (
                           U
                           (
                           
                              
                                 M
                              
                              
                                 ℓ
                              
                           
                           )
                           )
                           =
                           
                              
                                 M
                              
                              
                                 ℓ
                              
                           
                        .

Let Ω be a domain of 
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                         aligned with level N. More precisely, its boundary ∂Ω is a union of edges from the grid 
                           
                              
                                 G
                              
                              
                                 N
                              
                           
                        , see the top right of Fig. 13
                        . The hierarchical grid is defined by an inversely nested sequence of subdomains 
                           
                              
                                 M
                              
                              
                                 ℓ
                              
                           
                           =
                           U
                           (
                           
                              
                                 M
                              
                              
                                 ℓ
                              
                           
                           )
                         thereof,
                           
                              (15)
                              
                                 ∅
                                 =
                                 
                                    
                                       M
                                    
                                    
                                       0
                                    
                                 
                                 ⊆
                                 
                                    
                                       M
                                    
                                    
                                       1
                                    
                                 
                                 ⊆
                                 ⋯
                                 ⊆
                                 
                                    
                                       M
                                    
                                    
                                       N
                                    
                                 
                                 =
                                 Ω
                                 ,
                              
                           
                         which correspond to subsets of the corresponding grids, 
                           
                              
                                 M
                              
                              
                                 ℓ
                              
                           
                           ⊂
                           
                              
                                 G
                              
                              
                                 ℓ
                              
                           
                        . Thus the boundary 
                           ∂
                           
                              
                                 M
                              
                              
                                 ℓ
                              
                           
                         is a union of edges of the grid 
                           
                              
                                 G
                              
                              
                                 ℓ
                              
                           
                         of the same level. These subdomains were called rings in Giannelli and Jüttler (2013). They are multi-cell domains (with respect to the grid) of level ℓ.

The difference of two successive subdomains
                           
                              
                                 
                                    
                                       D
                                    
                                    
                                       ℓ
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             M
                                          
                                          
                                             ℓ
                                          
                                       
                                       ∖
                                       
                                          
                                             M
                                          
                                          
                                             ℓ
                                             −
                                             1
                                          
                                       
                                    
                                    ‾
                                 
                              
                           
                         and the associated subset 
                           
                              
                                 D
                              
                              
                                 ℓ
                              
                           
                           =
                           
                              
                                 T
                              
                              
                                 ℓ
                              
                           
                           (
                           
                              
                                 D
                              
                              
                                 ℓ
                              
                           
                           )
                         of the grid of level ℓ is called the refinement domain of level ℓ, see Fig. 14
                        . In particular we have 
                           
                              
                                 D
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 M
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 D
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 M
                              
                              
                                 1
                              
                           
                        .

Finally we collect the triangulations of the refinement area and arrive at the hierarchical grid
                        
                           
                              (16)
                              
                                 H
                                 =
                                 
                                    ⋃
                                    
                                       ℓ
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                    
                                       D
                                    
                                    
                                       ℓ
                                    
                                 
                                 ,
                              
                           
                         see Fig. 15
                        . This hierarchical grid, which collects triangles from all levels, provides a representation of the domain 
                           Ω
                           =
                           U
                           (
                           H
                           )
                         as a hierarchical multi-cell domain. We use it to define the hierarchical special spline space
                        
                           
                              
                                 H
                                 =
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 H
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       ˆ
                                    
                                 
                                 )
                                 .
                              
                           
                         Equivalently, the spline functions 
                           s
                           ∈
                           H
                         can be characterized by the fact that their restrictions to the subdomains belong to the corresponding spline spaces:


                        
                           Lemma 25
                           
                              A function 
                              
                                 s
                                 :
                                 Ω
                                 →
                                 R
                               
                              is an element of 
                              
                                 H
                               
                              if and only if
                              
                                 
                                    
                                       
                                          
                                             s
                                             |
                                          
                                          
                                             
                                                
                                                   M
                                                
                                                
                                                   ℓ
                                                
                                             
                                          
                                       
                                       ∈
                                       
                                          
                                             S
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       
                                          
                                             M
                                          
                                          
                                             ℓ
                                          
                                       
                                       ,
                                       
                                          
                                             P
                                          
                                          
                                             ˆ
                                          
                                       
                                       )
                                       .
                                    
                                 
                               
                              holds for all 
                              
                                 ℓ
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 n
                              
                              .
                           

The proof of this simple observation has been omitted.

We consider the box splines 
                           
                              
                                 B
                              
                              
                                 ℓ
                              
                           
                        , which are associated with the grids 
                           
                              
                                 G
                              
                              
                                 ℓ
                              
                           
                        , and the spaces spanned by them. Similar to the grids, these box splines can be obtained by a dilation,
                           
                              
                                 
                                    
                                       B
                                    
                                    
                                       ℓ
                                       +
                                       1
                                    
                                 
                                 =
                                 {
                                 β
                                 (
                                 2
                                 
                                 ⋅
                                 )
                                 
                                 :
                                 
                                 β
                                 ∈
                                 
                                    
                                       B
                                    
                                    
                                       ℓ
                                    
                                 
                                 }
                              
                           
                         from the coarsest basis 
                           
                              
                                 B
                              
                              
                                 1
                              
                           
                           =
                           B
                         which has been defined in Section 2. For each subdomain 
                           
                              
                                 M
                              
                              
                                 ℓ
                              
                           
                         we consider the box splines whose supports possess a non-empty intersection with 
                           
                              
                                 M
                              
                              
                                 ℓ
                              
                           
                        ,
                           
                              
                                 
                                    
                                       B
                                    
                                    
                                       
                                          
                                             M
                                          
                                          
                                             ℓ
                                          
                                       
                                    
                                    
                                       ℓ
                                    
                                 
                                 =
                                 {
                                 β
                                 ∈
                                 
                                    
                                       B
                                    
                                    
                                       ℓ
                                    
                                 
                                 
                                 :
                                 
                                 supp
                                 
                                 β
                                 ∩
                                 
                                    
                                       M
                                    
                                    
                                       ℓ
                                    
                                 
                                 ≠
                                 ∅
                                 }
                                 .
                              
                           
                         The hierarchical spline basis is defined by a selection procedure which was proposed by Kraft (1998) for tensor-product B-splines. We select box splines from all levels,
                           
                              
                                 
                                    
                                       K
                                    
                                    
                                       ℓ
                                    
                                 
                                 =
                                 {
                                 
                                    
                                       β
                                    
                                    
                                       ℓ
                                    
                                 
                                 ∈
                                 
                                    
                                       B
                                    
                                    
                                       
                                          
                                             M
                                          
                                          
                                             ℓ
                                          
                                       
                                    
                                    
                                       ℓ
                                    
                                 
                                 
                                 :
                                 
                                 supp
                                 
                                 
                                    
                                       β
                                    
                                    
                                       ℓ
                                    
                                 
                                 ∩
                                 
                                    
                                       M
                                    
                                    
                                       ℓ
                                       −
                                       1
                                    
                                 
                                 =
                                 ∅
                                 }
                                 ,
                              
                           
                         and collect them into the hierarchical spline basis
                        
                           
                              
                                 K
                                 =
                                 
                                    ⋃
                                    
                                       ℓ
                                       =
                                       1
                                    
                                    N
                                 
                                 
                                    
                                       K
                                    
                                    
                                       ℓ
                                    
                                 
                                 .
                              
                           
                         The linear independence of this set of functions is implied by the local linear independence of the box splines at each level, see Giannelli and Jüttler (2013), Kraft (1998).

Finally we provide a sufficient condition for the completeness of the hierarchical spline basis.


                        
                           Theorem 26
                           
                              The hierarchical spline basis K spans the hierarchical spline space 
                              
                                 H
                               
                              if each subdomain 
                              
                                 
                                    
                                       M
                                    
                                    
                                       ℓ
                                    
                                 
                               
                              is admissible with respect to the grid of level ℓ.
                           

The proof follows standard arguments already presented in Giannelli and Jüttler (2013), Mokriš et al. (2014), for the case of hierarchical tensor B-spline bases. Any spline function 
                                 s
                                 ∈
                                 H
                               admits a representation
                                 
                                    
                                       
                                          
                                             s
                                             =
                                             (
                                             
                                                
                                                   h
                                                
                                                
                                                   1
                                                
                                             
                                             +
                                             ⋯
                                             +
                                             
                                                
                                                   h
                                                
                                                
                                                   N
                                                
                                             
                                             )
                                             |
                                          
                                          
                                             Ω
                                          
                                       
                                       ,
                                    
                                 
                               where 
                                 
                                    
                                       h
                                    
                                    
                                       ℓ
                                    
                                 
                                 ∈
                                 span
                                 
                                 
                                    
                                       B
                                    
                                    
                                       
                                          
                                             M
                                          
                                          
                                             ℓ
                                          
                                       
                                    
                                    
                                       ℓ
                                    
                                 
                               with the property that
                                 
                                    (17)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               h
                                                            
                                                            
                                                               ℓ
                                                            
                                                         
                                                         |
                                                      
                                                      
                                                         
                                                            
                                                               M
                                                            
                                                            
                                                               ℓ
                                                            
                                                         
                                                      
                                                   
                                                   =
                                                   s
                                                   |
                                                
                                                
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         ℓ
                                                      
                                                   
                                                
                                             
                                             −
                                             (
                                             
                                                
                                                   h
                                                
                                                
                                                   1
                                                
                                             
                                             +
                                             …
                                             +
                                             
                                                
                                                   h
                                                
                                                
                                                   ℓ
                                                   −
                                                   1
                                                
                                             
                                             )
                                             |
                                          
                                          
                                             
                                                
                                                   M
                                                
                                                
                                                   ℓ
                                                
                                             
                                          
                                       
                                       ,
                                    
                                 
                               for 
                                 ℓ
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 N
                              . This is proved by induction with respect to ℓ.

For any given level ℓ, all functions 
                                 
                                    
                                       
                                          
                                             h
                                          
                                          
                                             k
                                          
                                       
                                       |
                                    
                                    
                                       
                                          
                                             M
                                          
                                          
                                             ℓ
                                          
                                       
                                    
                                 
                               of lower levels 
                                 k
                                 <
                                 ℓ
                               are contained in 
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       ℓ
                                    
                                 
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       ˆ
                                    
                                 
                                 )
                              , since
                                 
                                    
                                       
                                          
                                             span
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                                
                                                   k
                                                
                                             
                                             |
                                          
                                          
                                             
                                                
                                                   M
                                                
                                                
                                                   ℓ
                                                
                                             
                                          
                                       
                                       ⊂
                                       
                                          
                                             S
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       
                                          
                                             M
                                          
                                          
                                             ℓ
                                          
                                       
                                       ,
                                       
                                          
                                             P
                                          
                                          
                                             ˆ
                                          
                                       
                                       )
                                       .
                                    
                                 
                               
                              Lemma 25 implies 
                                 
                                    
                                       s
                                       |
                                    
                                    
                                       
                                          
                                             M
                                          
                                          
                                             ℓ
                                          
                                       
                                    
                                 
                                 ∈
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       ℓ
                                    
                                 
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       ˆ
                                    
                                 
                                 )
                              . Consequently, the right-hand side of Eq. (17) is contained in 
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 
                                    
                                       M
                                    
                                    
                                       ℓ
                                    
                                 
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       ˆ
                                    
                                 
                                 )
                              . Since the subdomain 
                                 
                                    
                                       M
                                    
                                    
                                       ℓ
                                    
                                 
                               is admissible, we conclude that 
                                 
                                    
                                       h
                                    
                                    
                                       ℓ
                                    
                                 
                                 ∈
                                 span
                                 
                                 
                                    
                                       B
                                    
                                    
                                       
                                          
                                             M
                                          
                                          
                                             ℓ
                                          
                                       
                                    
                                    
                                       ℓ
                                    
                                 
                               according to Corollary 21. In particular, choosing 
                                 ℓ
                                 =
                                 N
                               in Eq. (17) implies the first equation.

Moreover, the construction of the functions 
                                 
                                    
                                       h
                                    
                                    
                                       ℓ
                                    
                                 
                               ensures that
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         ℓ
                                                      
                                                   
                                                   |
                                                
                                                
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         ℓ
                                                         −
                                                         1
                                                      
                                                   
                                                
                                             
                                             =
                                             0
                                             |
                                          
                                          
                                             
                                                
                                                   M
                                                
                                                
                                                   ℓ
                                                   −
                                                   1
                                                
                                             
                                          
                                       
                                       .
                                    
                                 
                               Since the box splines possess the property of local linear independence we can conclude that 
                                 
                                    
                                       h
                                    
                                    
                                       ℓ
                                    
                                 
                                 ∈
                                 span
                                 
                                 
                                    
                                       K
                                    
                                    
                                       ℓ
                                    
                                 
                              . This completes the proof.  □

@&#CONCLUSION@&#

We extended the discussion of the completeness of hierarchical spline spaces from Mokriš et al. (2014) to the case of hierarchies of bivariate quartic 
                        
                           
                              C
                           
                           
                              2
                           
                        
                     -smooth box splines on type-I triangulations. There are two main differences to the original approach, which was formulated for tensor-product splines.

First, since box splines do not span the whole space of quartic polynomials, a special polynomial subspace – the special quartics – had to be introduced. In some sense this situation generalizes the tensor-product case, where the B-splines span a polynomial space of a given (coordinate-wise) bi-degree, instead of the space of bivariate polynomials of a given total degree.

Second, the constraints on the domains are entirely different, due to the differences in the characterization of contacts between polynomial pieces. For bivariate tensor-product splines, both edge-edge and vertex–vertex contacts could be characterized easily by the equality of spline coefficients. In the present case, however, this was possibly solely for edge-edge contacts. Consequently, the completeness of hierarchical splines requires more severe restrictions to the hierarchical grid.

The hierarchical box spline basis does not form a partition of unity. Similar to the approach presented in Giannelli et al. (2012), this property can be recovered with the help of a suitable truncation procedure. Also, in Mokriš et al. (2014) it is described a decoupling procedure that allows to relax the assumptions regarding the hierarchical grid. This approach can be extended to the box spline case as well. Finally it is also possible to combine truncation and decoupling as in Mokriš and Jüttler (2014).

We show that the space 
                        
                           
                              V
                           
                           
                              △
                           
                        
                      defined in Eq. (4) is the restriction of a global space to the triangle, as pointed out in Remark 3. In order to prove this result we use the notation introduced in Section 5. The following proof is not restricted to quartic box splines.


                     
                        Proposition 27
                        
                           Consider a global polynomial 
                           
                              f
                              ∈
                              P
                            
                           defined in 
                           
                              
                                 
                                    R
                                 
                                 
                                    2
                                 
                              
                           
                           . If 
                           
                              
                                 
                                    f
                                    |
                                 
                                 
                                    △
                                 
                              
                              ∈
                              
                                 
                                    V
                                 
                                 
                                    △
                                 
                              
                            
                           for some 
                           
                              △
                              ∈
                              
                                 
                                    G
                                 
                                 
                                    ℓ
                                 
                              
                           
                           , then 
                           
                              
                                 
                                    f
                                    |
                                 
                                 
                                    
                                       
                                          △
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              ∈
                              
                                 
                                    V
                                 
                                 
                                    
                                       
                                          △
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                            
                           for any other cell 
                           
                              
                                 
                                    △
                                 
                                 
                                    ′
                                 
                              
                            
                           in the grid 
                           
                              
                                 
                                    G
                                 
                                 
                                    ℓ
                                 
                              
                           
                           .
                        

We observe that if 
                              △
                              ,
                              
                                 
                                    △
                                 
                                 
                                    ′
                                 
                              
                              ∈
                              
                                 
                                    G
                                 
                                 
                                    ℓ
                                 
                              
                            then both cells are contained in a bigger triangle 
                              
                                 
                                    △
                                 
                                 
                                    ˜
                                 
                              
                            of a grid which we denote as 
                              
                                 
                                    G
                                 
                                 
                                    0
                                 
                              
                           , see Fig. 16
                           . We denote by 
                              
                                 
                                    V
                                 
                                 
                                    
                                       
                                          △
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    0
                                 
                              
                            the restriction of the span of the corresponding box splines (associated with the grid 
                              
                                 
                                    G
                                 
                                 
                                    0
                                 
                              
                           ) to the cell 
                              
                                 
                                    △
                                 
                                 
                                    ˜
                                 
                              
                           . Similarly we denote with 
                              
                                 
                                    V
                                 
                                 
                                    △
                                 
                                 
                                    ℓ
                                 
                              
                            and 
                              
                                 
                                    V
                                 
                                 
                                    
                                       
                                          △
                                       
                                       
                                          ′
                                       
                                    
                                 
                                 
                                    ℓ
                                 
                              
                            the span of the corresponding box splines (associated with the grid 
                              
                                 
                                    G
                                 
                                 
                                    ℓ
                                 
                              
                           ) restricted to these triangles. Clearly, we have that
                              
                                 
                                    dim
                                    ⁡
                                    
                                       
                                          V
                                       
                                       
                                          
                                             
                                                △
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          0
                                       
                                    
                                    =
                                    dim
                                    ⁡
                                    
                                       
                                          V
                                       
                                       
                                          △
                                       
                                       
                                          ℓ
                                       
                                    
                                    =
                                    dim
                                    ⁡
                                    
                                       
                                          V
                                       
                                       
                                          
                                             
                                                △
                                             
                                             
                                                ′
                                             
                                          
                                       
                                       
                                          ℓ
                                       
                                    
                                 
                              
                            because of the symmetry and the scaling invariance of the box spline construction. The box spline spaces on the different levels are nested, hence
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      
                                                         
                                                            △
                                                         
                                                         
                                                            ˜
                                                         
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                
                                                |
                                             
                                             
                                                △
                                             
                                          
                                          ⊆
                                          
                                             
                                                V
                                             
                                             
                                                △
                                             
                                             
                                                ℓ
                                             
                                          
                                          
                                          and
                                          
                                          
                                             
                                                V
                                             
                                             
                                                
                                                   
                                                      △
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                          |
                                       
                                       
                                          
                                             
                                                △
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    ⊆
                                    
                                       
                                          V
                                       
                                       
                                          
                                             
                                                △
                                             
                                             
                                                ′
                                             
                                          
                                       
                                       
                                          ℓ
                                       
                                    
                                    .
                                 
                              
                            Since 
                              
                                 
                                    V
                                 
                                 
                                    
                                       
                                          △
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    0
                                 
                              
                            is a subspace of a polynomial space we also know that
                              
                                 
                                    
                                       
                                          
                                             
                                                dim
                                                ⁡
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      
                                                         
                                                            △
                                                         
                                                         
                                                            ˜
                                                         
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                
                                                =
                                                dim
                                                ⁡
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      
                                                         
                                                            △
                                                         
                                                         
                                                            ˜
                                                         
                                                      
                                                   
                                                   
                                                      0
                                                   
                                                
                                                |
                                             
                                             
                                                △
                                             
                                          
                                          =
                                          dim
                                          ⁡
                                          
                                             
                                                V
                                             
                                             
                                                
                                                   
                                                      △
                                                   
                                                   
                                                      ˜
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                          |
                                       
                                       
                                          
                                             
                                                △
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                            Combining these observations confirms that 
                              
                                 
                                    
                                       
                                          V
                                       
                                       
                                          △
                                       
                                       
                                          ℓ
                                       
                                    
                                    =
                                    
                                       
                                          V
                                       
                                       
                                          
                                             
                                                △
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          0
                                       
                                    
                                    |
                                 
                                 
                                    △
                                 
                              
                            and 
                              
                                 
                                    
                                       
                                          V
                                       
                                       
                                          
                                             
                                                △
                                             
                                             
                                                ′
                                             
                                          
                                       
                                       
                                          ℓ
                                       
                                    
                                    =
                                    
                                       
                                          V
                                       
                                       
                                          
                                             
                                                △
                                             
                                             
                                                ˜
                                             
                                          
                                       
                                       
                                          0
                                       
                                    
                                    |
                                 
                                 
                                    
                                       
                                          △
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           , as we wanted to show.  □

We may therefore define 
                        
                           
                              P
                           
                           
                              ˆ
                           
                        
                      to be this global polynomial space. In the special case of 
                        
                           
                              C
                           
                           
                              2
                           
                        
                      quartic box splines, the above result may be seen directly by using the representation of the polynomial pieces in the monomial basis. For the sake of completeness we report the coefficients of 
                        12
                        
                           
                              β
                           
                           
                              i
                           
                        
                     , 
                        
                           
                              β
                           
                           
                              i
                           
                        
                        ∈
                        
                           
                              β
                           
                           
                              △
                           
                        
                      with respect to the basis (5) of 
                        
                           
                              P
                           
                           
                              ˆ
                           
                        
                      in the matrix
                        
                           
                              
                                 
                                    
                                       
                                       
                                       
                                          1
                                       
                                       
                                          y
                                       
                                       
                                          
                                             
                                                y
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          
                                             
                                                y
                                             
                                             
                                                3
                                             
                                          
                                       
                                       
                                          x
                                       
                                       
                                          x
                                          y
                                       
                                       
                                          x
                                          
                                             
                                                y
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                          y
                                       
                                       
                                          
                                             
                                                x
                                             
                                             
                                                3
                                             
                                          
                                       
                                       
                                          
                                             
                                                x
                                             
                                             
                                                4
                                             
                                          
                                          −
                                          2
                                          
                                             
                                                x
                                             
                                             
                                                3
                                             
                                          
                                          y
                                       
                                       
                                          
                                             
                                                y
                                             
                                             
                                                4
                                             
                                          
                                          −
                                          2
                                          x
                                          
                                             
                                                y
                                             
                                             
                                                3
                                             
                                          
                                       
                                       
                                    
                                    
                                       
                                          
                                             
                                                β
                                             
                                             
                                                1
                                             
                                          
                                       
                                       
                                          [
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          −
                                          1
                                       
                                       
                                          ]
                                       
                                    
                                    
                                       
                                          
                                             
                                                β
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          2
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          
                                             
                                                β
                                             
                                             
                                                3
                                             
                                          
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          2
                                       
                                       
                                          −
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             
                                                β
                                             
                                             
                                                4
                                             
                                          
                                       
                                       
                                          1
                                       
                                       
                                          2
                                       
                                       
                                          0
                                       
                                       
                                          −
                                          6
                                       
                                       
                                          2
                                       
                                       
                                          6
                                       
                                       
                                          6
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          −
                                          4
                                       
                                       
                                          2
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          
                                             
                                                β
                                             
                                             
                                                5
                                             
                                          
                                       
                                       
                                          1
                                       
                                       
                                          4
                                       
                                       
                                          6
                                       
                                       
                                          0
                                       
                                       
                                          −
                                          2
                                       
                                       
                                          −
                                          6
                                       
                                       
                                          −
                                          6
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          2
                                       
                                       
                                          −
                                          1
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          
                                             
                                                β
                                             
                                             
                                                6
                                             
                                          
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          1
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          
                                             
                                                β
                                             
                                             
                                                7
                                             
                                          
                                       
                                       
                                          1
                                       
                                       
                                          −
                                          2
                                       
                                       
                                          0
                                       
                                       
                                          6
                                       
                                       
                                          4
                                       
                                       
                                          −
                                          6
                                       
                                       
                                          −
                                          12
                                       
                                       
                                          6
                                       
                                       
                                          6
                                       
                                       
                                          −
                                          4
                                       
                                       
                                          −
                                          1
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          
                                             
                                                β
                                             
                                             
                                                8
                                             
                                          
                                       
                                       
                                          6
                                       
                                       
                                          0
                                       
                                       
                                          −
                                          12
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          12
                                       
                                       
                                          12
                                       
                                       
                                          −
                                          12
                                       
                                       
                                          −
                                          12
                                       
                                       
                                          8
                                       
                                       
                                          −
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             
                                                β
                                             
                                             
                                                9
                                             
                                          
                                       
                                       
                                          1
                                       
                                       
                                          2
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          −
                                          4
                                       
                                       
                                          −
                                          6
                                       
                                       
                                          0
                                       
                                       
                                          6
                                       
                                       
                                          6
                                       
                                       
                                          −
                                          4
                                       
                                       
                                          1
                                       
                                       
                                          0
                                       
                                    
                                    
                                       
                                          
                                             
                                                β
                                             
                                             
                                                10
                                             
                                          
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          −
                                          2
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          6
                                       
                                       
                                          0
                                       
                                       
                                          −
                                          6
                                       
                                       
                                          2
                                       
                                       
                                          −
                                          1
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          
                                             
                                                β
                                             
                                             
                                                11
                                             
                                          
                                       
                                       
                                          1
                                       
                                       
                                          −
                                          4
                                       
                                       
                                          6
                                       
                                       
                                          0
                                       
                                       
                                          2
                                       
                                       
                                          −
                                          6
                                       
                                       
                                          −
                                          6
                                       
                                       
                                          0
                                       
                                       
                                          12
                                       
                                       
                                          −
                                          4
                                       
                                       
                                          2
                                       
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          
                                             
                                                β
                                             
                                             
                                                12
                                             
                                          
                                       
                                       
                                          1
                                       
                                       
                                          −
                                          2
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          −
                                          2
                                       
                                       
                                          6
                                       
                                       
                                          0
                                       
                                       
                                          0
                                       
                                       
                                          −
                                          6
                                       
                                       
                                          2
                                       
                                       
                                          −
                                          1
                                       
                                       
                                          0
                                       
                                    
                                 
                                 .
                              
                           
                        
                      Each row corresponds to a box spline, following the numbering in Fig. 3. The grid size is 1 and the origin is located at vertex no. 8.

@&#REFERENCES@&#

