@&#MAIN-TITLE@&#Flows over time in time-varying networks: Optimality conditions and strong duality

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Studying a general class of network flows over time in a continuous-time model.


                        
                        
                           
                           Developing the key concepts and techniques that are the cornerstones of static network flows.


                        
                        
                           
                           Establishing reduced cost and negative cycle optimality conditions.


                        
                        
                           
                           Deriving a strong duality result from these optimality conditions.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Flows over time

Continuous linear programming

Optimality conditions

Duality

@&#ABSTRACT@&#


               
               
                  There has been much research on network flows over time due to their important role in real world applications. This has led to many results, but the more challenging continuous time model still lacks some of the key concepts and techniques that are the cornerstones of static network flows. The aim of this paper is to advance the state of the art for dynamic network flows by developing the continuous time analogues of the theory for static network flows. Specifically, we make use of ideas from the static case to establish a reduced cost optimality condition, a negative cycle optimality condition, and a strong duality result for a very general class of network flows over time.
               
            

@&#INTRODUCTION@&#

In various applications of network flows, flow values on arcs are not constant but may change over time due, e.g., to seasonal altering demands, supplies and arc capacities. Moreover, flow does not travel instantaneously through a network but requires a certain amount of time to travel through each arc. These aspects are captured by network flows over time (also called dynamic network flows), which were introduced by Ford and Fulkerson (1958, 1962) in the 1950s. Since then, a large number of authors have studied different features of network flow over time models (see Skutella, 2009 and the references therein).

Research on flows over time has taken two approaches depending on whether a discrete or continuous representation of time is used (Fleischer & Tardos, 1998). Research on the discrete-time model typically uses the time-expanded network, either explicitly in the algorithms, or implicitly in order to proof efficiency of theoretically or practically algorithms (see, e.g., Fleischer & Skutella, 2007). Research on the continuous-time model has been mostly conducted by Anderson, Philpott and Pullan (see, e.g., Anderson, 1989; Anderson & Philpott, 1989, 1994; Philpott, 1982, 1990; Pullan, 1993, 1997), who consider networks with time-varying parameters. They mainly focus on proving the existence and characterization of optimal solutions, establishing a duality theory, and developing solution algorithms.

In this paper, we study the Minimum Cost Flow over time Problem (hereafter called MCFP for brevity) in the continuous time model. Here the task is to find a minimum cost flow to satisfy (time-varying) demands through a capacitated network, in which arc costs can vary with time, each arc has a transit time, and storage (with a corresponding cost) is allowed at the nodes. This problem was first introduced by Anderson (1989), who characterizes extreme point solutions for the problem given rational transit times. Anderson and Philpott (1994) review results relating to MCFP. They introduce a dual problem for MCFP with a corresponding definition of complementary slackness and prove a weak duality result.

A closely related problem to MCFP is the maximum flow over time problem in the continuous-time model. The aim of this problem is to send as much flow as possible through a capacitated network from a source to a sink within a given time interval. This problem was studied by Anderson, Nash, and Philpott (1982). They introduce the concept of continuous-time cuts and establish a MaxFlow-MinCut theorem (see also Anderson & Nash, 1987) for the case that transit times are zero and the transit capacities are bounded measurable. This result was later extended to arbitrary transit times by Philpott (1990) and to a general model combining both discrete and continuous aspects of flows over time into a single model by Koch, Nasrabadi, and Skutella (2010).

In the absence of transit times, MCFP becomes a special type of Separated Continuous Linear Programs (SCLP) (see Anderson, 1978). Pullan (1997) considers a more general class of SCLP with time-delays, so-called Separated Continuous Linear Programs with Time-Delays (SCLPTD). For the case that transit times are rational, Pullan (1997) transforms SCLPTD into a larger problem which is very close to a special class of SCLP and extends some results of SCLP to SCLPTD. In particular, he observes that the main results for SCLP can be extended with ease to give a similar theorem for SCLPTD.

The common approach in solving CLP as well as SCLP is to approximate the original problem with a finite-dimensional linear program by discretization of time. This approach has attracted most of the attention for solving practical problems for the following reasons:
                        
                           1.
                           Discretization of time leads to static problems that can be solved by using traditional methods.

The discrete approximated solutions converge to an optimal solution for the original problem as the discretization becomes finer.

While discretization-based algorithms are mainly used in practice due to these observations, the size of resulting discrete approximations is enormous, which leads to long computation times. Consequently, a number of authors attempted to generalize the simplex method to solve instances of SCLP as well as MCFP without discretization. In particular, Anderson and Philpott (1989) attempt to develop a simplex algorithm for MCFP with zero transit times and piecewise constant/linear input functions. They discuss how the simplex method can be developed for MCFP to directly produce an exact solution, rather than doing a discretization to get an approximation to the optimal solution. But, there are no guarantees for the convergence of this algorithm and it often produces a sequence of solutions which converge to a suboptimal solution. In the most recent paper, Weiss (2008) examines SCLP with piecewise linear problem data and develops a simplex algorithm that gives an exact solution after a finite number of iterations. He also characterizes the form of optimal solutions and establishes a strong duality result.

So far we reviewed the literature on network flows over time where transit times are assumed to be time-invariant. There is also a number of models that allow the transit times to vary over time in both discrete-time model (Cai, Kloks, & Wong, 1997; Cai, Sha, & Wong, 2001; Miller-Hooks & Mahmassani, 1998; Miller-Hooks & Patterson, 2004; Nasrabadi & Hashemi, 2010; Opasanon & Miller-Hooks, 2006; Wen, Çatay, & Eglese, 2013) and continuous-time model (Hashemi & Nasrabadi, 2011; Orda & Rom, 1990, 1991, 1995). In particular, Miller-Hooks and Patterson (2004) present a pseudo-polynomial time algorithm for the problem of sending a given amount of flow from a single source to a single sink at the shortest possible time in a time-varying network, where all parameters can change at discrete points in time. They also present a technique for converting a network with multiple sources and multiple sinks into an equivalent single source and sink network by adding a small number of nodes and arcs to the existing network. Cai et al. (2001) study the problem of sending a given amount of flow from a single source to a single sink with minimum cost in a time-varying network. They present a kind of the successive shortest path algorithm for solving the problem that runs in pseudo-polynomial-time. Nasrabadi and Hashemi (2010) extent this model to multiple sources and multiple sinks in which the supplies at source nodes and demands at sink nodes may vary with time. They present a discrete-time version of the successive shortest path algorithm for solving the resulting problem.


                     Our contribution. In this paper, we are concerned with the development of continuous-time analogues to those concepts and techniques which are the cornerstones of static network flows. Specifically, we develop several network based optimality conditions analogous to that found in static network flows for MCFP with piecewise analytic input functions and rational transit times. We derive a strong duality result from these optimality conditions.

It is worth pointing out that previously, strong duality was developed by Pullan (1996, 1997) for SCLP given piecewise analytic problem data and for SCLPTD with rational transit times and piecewise constant/linear input functions. The main result of his paper is a strong duality theorem for SCLP with piecewise analytic data. He first showed that strong duality holds for SCLP under the conditions of piecewise constant/linear problem data in his original paper (Pullan, 1993) as a consequence of his elegant algorithm. This result was the starting point of an extensive duality theory in Pullan (1996). In this paper, we do not follow the Pullan’s approach, but rather we make use of ideas from the area of static network flows.

The remainder of this paper is organized as follows. Section 2 provides preliminaries and earlier results that are required for the purpose of the paper. In Section 3, we introduce the concept of augmenting paths and cycles, and prove the existence of least cost augmenting paths. We then establish a reduced cost optimality condition, a negative cycle optimality condition, and a strong duality result for MCFP in Section 4. Section 5 is devoted to our conclusions. Our results in Sections 3 and 4 are based on the assumption that the cost functions are continuous. In Appendix A, we show that this assumption makes no restriction and all our results can be extended to the case where cost functions have some discontinuities.

In this section, we give a formal description of MCFP and present some existing results, required throughout the paper.

We are given a directed graph 
                        
                           G
                           =
                           (
                           V
                           ,
                           E
                           )
                        
                      with node set V and arc set E and a time horizon 
                        
                           T
                           >
                           0
                        
                     . We denote an arc e from node v to node w by 
                        
                           e
                           =
                           (
                           v
                           ,
                           w
                           )
                        
                      and assume, without loss of generality, that there is at most one arc between any pair of nodes in G. Each arc e is associated with two functions; the transit cost 
                     
                        
                           
                              
                                 c
                              
                              
                                 e
                              
                           
                           :
                           [
                           0
                           ,
                           T
                           ]
                           →
                           R
                        
                      and the transit capacity 
                     
                        
                           
                              
                                 u
                              
                              
                                 e
                              
                           
                           :
                           [
                           0
                           ,
                           T
                           ]
                           →
                           
                              
                                 R
                              
                              
                                 ⩾
                                 0
                              
                           
                        
                     . Here, 
                        
                           
                              
                                 c
                              
                              
                                 e
                              
                           
                           (
                           θ
                           )
                        
                      gives the cost per flow unit for sending flow in arc e at time 
                        
                           θ
                        
                      and 
                        
                           
                              
                                 u
                              
                              
                                 e
                              
                           
                           (
                           θ
                           )
                        
                      gives an upper bound on the rate (i.e., amount of flow per time unit) at which flow can enter arc e at time 
                        
                           θ
                        
                     . In addition, for each arc e, a transit time 
                     
                        
                           
                              
                                 τ
                              
                              
                                 e
                              
                           
                           ∈
                           R
                        
                      is given. The transit time is the amount of time required to send flow from the tail to the head of e. Thus flow entering arc 
                        
                           e
                           =
                           (
                           v
                           ,
                           w
                           )
                        
                      at time 
                        
                           θ
                        
                      arrives at node w at time 
                        
                           θ
                           +
                           
                              
                                 τ
                              
                              
                                 e
                              
                           
                        
                     .

Each node v is associated with three functions; the storage cost 
                     
                        
                           
                              
                                 c
                              
                              
                                 v
                              
                           
                           :
                           [
                           0
                           ,
                           T
                           ]
                           →
                           R
                        
                     , the storage capacity 
                     
                        
                           
                              
                                 U
                              
                              
                                 v
                              
                           
                           :
                           [
                           0
                           ,
                           T
                           ]
                           →
                           
                              
                                 R
                              
                              
                                 ⩾
                                 0
                              
                           
                        
                     , and the supply/demand rate 
                     
                        
                           
                              
                                 b
                              
                              
                                 v
                              
                           
                           :
                           [
                           0
                           ,
                           T
                           ]
                           →
                           R
                        
                     . Here 
                        
                           
                              
                                 c
                              
                              
                                 v
                              
                           
                           (
                           θ
                           )
                        
                      is the cost per time unit for storing one unit of flow at node v at time 
                        
                           θ
                        
                      and 
                        
                           
                              
                                 U
                              
                              
                                 v
                              
                           
                           (
                           θ
                           )
                        
                      is an upper bound on the amount of flow that can be stored at node v at time 
                        
                           θ
                        
                     . Moreover, depending on whether 
                        
                           
                              
                                 b
                              
                              
                                 v
                              
                           
                           (
                           θ
                           )
                           >
                           0
                        
                      or 
                        
                           
                              
                                 b
                              
                              
                                 v
                              
                           
                           (
                           θ
                           )
                           <
                           0
                        
                     , the value 
                        
                           |
                           
                              
                                 b
                              
                              
                                 v
                              
                           
                           (
                           θ
                           )
                           |
                        
                      denotes the supply or demand rate of flow at node v at time 
                        
                           θ
                        
                     . Thus, the amount of available supply or required demand up to time 
                        
                           θ
                        
                      at node v equals 
                        
                           
                              
                                 B
                              
                              
                                 v
                              
                           
                           (
                           θ
                           )
                           
                           ≔
                           
                           
                              ∫
                              
                                 0
                              
                              
                                 θ
                              
                           
                           
                              
                                 b
                              
                              
                                 v
                              
                           
                           (
                           ϑ
                           )
                           
                           d
                           (
                           ϑ
                           )
                        
                     . In addition, there may be an initial storage 
                        
                           
                              
                                 s
                              
                              
                                 v
                              
                           
                           ∈
                           
                              
                                 R
                              
                              
                                 ⩾
                                 0
                              
                           
                        
                      at node v. In this case, the total supply or demand at node v up to time 
                        
                           θ
                        
                      is given by 
                        
                           
                              
                                 B
                              
                              
                                 v
                              
                           
                           (
                           θ
                           )
                           
                           ≔
                           
                           
                              
                                 s
                              
                              
                                 v
                              
                           
                           +
                           
                              ∫
                              
                                 0
                              
                              
                                 θ
                              
                           
                           
                              
                                 b
                              
                              
                                 v
                              
                           
                           (
                           ϑ
                           )
                           
                           d
                           (
                           ϑ
                           )
                        
                     .

A flow over time (or simply flow) x is described by Lebesgue-measurable functions
                        
                           
                              
                                 
                                    x
                                 
                                 
                                    e
                                 
                              
                              :
                              [
                              0
                              ,
                              T
                              )
                              ⟶
                              
                                 
                                    R
                                 
                                 
                                    ⩾
                                    0
                                 
                              
                              
                              ∀
                              e
                              ∈
                              E
                              .
                           
                        
                     The value 
                        
                           
                              
                                 x
                              
                              
                                 e
                              
                           
                           (
                           θ
                           )
                        
                      denotes the rate of flow entering arc e at the point in time 
                        
                           θ
                        
                     . Therefore, the amount of flow entering arc e up to time 
                        
                           θ
                        
                      equals 
                        
                           
                              
                                 X
                              
                              
                                 e
                              
                           
                           (
                           θ
                           )
                           
                           ≔
                           
                           
                              ∫
                              
                                 0
                              
                              
                                 θ
                              
                           
                           
                              
                                 x
                              
                              
                                 e
                              
                           
                           (
                           ϑ
                           )
                           
                           d
                           ϑ
                        
                     . We let 
                        
                           
                              
                                 X
                              
                              
                                 e
                              
                           
                           -
                           τ
                        
                      to be a shifted function defined by 
                        
                           (
                           
                              
                                 X
                              
                              
                                 e
                              
                           
                           -
                           τ
                           )
                           (
                           θ
                           )
                           
                           ≔
                           
                           
                              
                                 X
                              
                              
                                 e
                              
                           
                           (
                           θ
                           -
                           τ
                           )
                        
                      for each 
                        
                           θ
                           ∈
                           [
                           0
                           ,
                           T
                           )
                        
                     . The flow x induces a storage function 
                        
                           
                              
                                 Y
                              
                              
                                 v
                              
                           
                           :
                           [
                           0
                           ,
                           T
                           )
                           ⟶
                           R
                        
                      at node v by the flow conservation constraint
                     
                        
                           (1)
                           
                              
                                 
                                    Y
                                 
                                 
                                    v
                                 
                              
                              
                              ≔
                              
                              
                                 
                                    B
                                 
                                 
                                    v
                                 
                              
                              -
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       e
                                       ∈
                                       
                                          
                                             δ
                                          
                                          
                                             +
                                          
                                       
                                       (
                                       v
                                       )
                                    
                                 
                              
                              
                                 
                                    X
                                 
                                 
                                    e
                                 
                              
                              -
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       e
                                       ∈
                                       
                                          
                                             δ
                                          
                                          
                                             -
                                          
                                       
                                       (
                                       v
                                       )
                                    
                                 
                              
                              (
                              
                                 
                                    X
                                 
                                 
                                    e
                                 
                              
                              -
                              
                                 
                                    τ
                                 
                                 
                                    e
                                 
                              
                              )
                              ,
                           
                        
                     where the value 
                        
                           
                              
                                 Y
                              
                              
                                 v
                              
                           
                           (
                           θ
                           )
                        
                      measures the amount of flow stored at node v at time 
                        
                           θ
                        
                     . Here and throughout the paper, the notation 
                        
                           
                              
                                 δ
                              
                              
                                 +
                              
                           
                           (
                           v
                           )
                        
                      and 
                        
                           
                              
                                 δ
                              
                              
                                 -
                              
                           
                           (
                           v
                           )
                        
                      are used to denote the set of all arcs leaving and entering node v, respectively. Obviously, the functions 
                        
                           X
                           ,
                           
                           B
                           ,
                           
                           Y
                        
                      are absolutely continuous. Moreover, we can assume without loss of generality that U is absolutely continuous as well. That is why we have used a capital letter to denote these functions in order to distinguish them from bounded measurable functions.

The aim of MCFP is to find a flow over time that satisfies all demands and obeys all transit and storage capacity constraints over the time interval 
                        
                           [
                           0
                           ,
                           T
                           ]
                        
                     , while minimizing the total transit and storage costs. This problem is formulated as an infinite-dimensional linear program with a network structure and arc time-delays as below:
                        
                           (MCFP)
                           
                              
                                 
                                    
                                       
                                          min
                                       
                                    
                                    
                                       
                                       
                                          ∫
                                          
                                             0
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                e
                                                ∈
                                                E
                                             
                                          
                                       
                                       
                                          
                                             c
                                          
                                          
                                             e
                                          
                                       
                                       (
                                       θ
                                       )
                                       
                                          
                                             x
                                          
                                          
                                             e
                                          
                                       
                                       (
                                       θ
                                       )
                                       
                                       d
                                       θ
                                       +
                                       
                                          ∫
                                          
                                             0
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                v
                                                ∈
                                                V
                                             
                                          
                                       
                                       
                                          
                                             c
                                          
                                          
                                             v
                                          
                                       
                                       (
                                       θ
                                       )
                                       
                                          
                                             Y
                                          
                                          
                                             v
                                          
                                       
                                       (
                                       θ
                                       )
                                       
                                       d
                                       θ
                                    
                                 
                                 
                                    
                                       s
                                       .
                                       t.
                                    
                                    
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                e
                                                ∈
                                                
                                                   
                                                      δ
                                                   
                                                   
                                                      +
                                                   
                                                
                                                (
                                                v
                                                )
                                             
                                          
                                       
                                       
                                          
                                             X
                                          
                                          
                                             e
                                          
                                       
                                       -
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                e
                                                ∈
                                                
                                                   
                                                      δ
                                                   
                                                   
                                                      -
                                                   
                                                
                                                (
                                                v
                                                )
                                             
                                          
                                       
                                       (
                                       
                                          
                                             X
                                          
                                          
                                             e
                                          
                                       
                                       -
                                       
                                          
                                             τ
                                          
                                          
                                             e
                                          
                                       
                                       )
                                       +
                                       
                                          
                                             Y
                                          
                                          
                                             v
                                          
                                       
                                       =
                                       
                                          
                                             B
                                          
                                          
                                             v
                                          
                                       
                                       
                                       ∀
                                       v
                                       ∈
                                       V
                                       ,
                                    
                                 
                                 
                                    
                                    
                                       0
                                       ⩽
                                       
                                          
                                             x
                                          
                                          
                                             e
                                          
                                       
                                       ⩽
                                       
                                          
                                             u
                                          
                                          
                                             e
                                          
                                       
                                       
                                       ∀
                                       e
                                       ∈
                                       E
                                       ,
                                    
                                 
                                 
                                    
                                    
                                       0
                                       ⩽
                                       
                                          
                                             Y
                                          
                                          
                                             v
                                          
                                       
                                       ⩽
                                       
                                          
                                             U
                                          
                                          
                                             v
                                          
                                       
                                       
                                       ∀
                                       v
                                       ∈
                                       V
                                       .
                                    
                                 
                              
                           
                        
                     This formulation is equivalent to that given by Anderson (1989) and provides a very general model for network flow over time problems.

We say that flow x (with corresponding storage Y) is feasible if the pair x and Y satisfies the constraints of (MCFP). We require to work within the space 
                        
                           
                              
                                 L
                              
                              
                                 ∞
                              
                           
                           (
                           [
                           0
                           ,
                           T
                           ]
                           )
                        
                      of essentially bounded measurable functions on 
                        
                           [
                           0
                           ,
                           T
                           ]
                        
                      in which equivalent functions differ only on a set of measure zero. In particular, 
                        
                           
                              
                                 c
                              
                              
                                 e
                              
                           
                           ,
                           
                           
                              
                                 u
                              
                              
                                 e
                              
                           
                        
                     , and 
                        
                           
                              
                                 x
                              
                              
                                 e
                              
                           
                        
                      for all 
                        
                           e
                           ∈
                           E
                        
                      and 
                        
                           
                              
                                 c
                              
                              
                                 v
                              
                           
                           ,
                           
                           
                              
                                 b
                              
                              
                                 v
                              
                           
                        
                      for all 
                        
                           v
                           ∈
                           V
                        
                      belong to 
                        
                           
                              
                                 L
                              
                              
                                 ∞
                              
                           
                           (
                           [
                           0
                           ,
                           T
                           ]
                           )
                        
                     . Hence, the feasible region 
                     
                        
                           F
                        
                      of MCFP is defined as
                        
                           
                              F
                              
                              ≔
                              
                              
                                 
                                    
                                       x
                                       ∈
                                       
                                          
                                             L
                                          
                                          
                                             ∞
                                          
                                          
                                             E
                                          
                                       
                                       [
                                       0
                                       ,
                                       T
                                       ]
                                       |
                                       x
                                       
                                       with corresponding storage
                                       
                                       Y
                                       
                                       is feasible for
                                       
                                       (
                                       MCFP
                                       )
                                    
                                 
                              
                              .
                           
                        
                     We assume that 
                        
                           F
                        
                      is not empty. This guarantees the existence of an optimum solution for (MCFP) at an extreme point of 
                        
                           F
                        
                      (see Pullan, 1997, Theorem 3.1).


                     Anderson and Philpott (1994) develop a dual problem for (MCFP) in an analogous manner to that described for static network flows. Before presenting the dual problem, let us assume without loss of generality that the storage costs are zero and there is no initial storage at nodes. Then, the dual problem can be formulated as follows:
                        
                           (MCFP∗)
                           
                              
                                 
                                    
                                       
                                          max
                                       
                                    
                                    
                                       
                                          ∫
                                          
                                             0
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                v
                                                ∈
                                                V
                                             
                                          
                                       
                                       
                                          
                                             b
                                          
                                          
                                             v
                                          
                                       
                                       (
                                       θ
                                       )
                                       
                                          
                                             π
                                          
                                          
                                             v
                                          
                                       
                                       (
                                       θ
                                       )
                                       
                                       d
                                       θ
                                       -
                                       
                                          ∫
                                          
                                             0
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                v
                                                ∈
                                                V
                                             
                                          
                                       
                                       
                                          
                                             U
                                          
                                          
                                             v
                                          
                                       
                                       (
                                       θ
                                       )
                                       
                                       d
                                       
                                          
                                             π
                                          
                                          
                                             v
                                          
                                          
                                             -
                                          
                                       
                                       (
                                       θ
                                       )
                                    
                                 
                                 
                                    
                                    
                                       +
                                       
                                          ∫
                                          
                                             0
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                v
                                                ∈
                                                V
                                             
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             e
                                          
                                       
                                       (
                                       θ
                                       )
                                       
                                          
                                             ρ
                                          
                                          
                                             e
                                          
                                       
                                       (
                                       θ
                                       )
                                       
                                       d
                                       θ
                                    
                                 
                                 
                                    
                                       s
                                       .
                                       t
                                       .
                                    
                                    
                                       
                                          
                                             π
                                          
                                          
                                             v
                                          
                                       
                                       (
                                       θ
                                       )
                                       -
                                       
                                          
                                             π
                                          
                                          
                                             w
                                          
                                       
                                       (
                                       θ
                                       +
                                       
                                          
                                             τ
                                          
                                          
                                             e
                                          
                                       
                                       )
                                       +
                                       
                                          
                                             ρ
                                          
                                          
                                             e
                                          
                                       
                                       (
                                       θ
                                       )
                                       ⩽
                                       
                                          
                                             c
                                          
                                          
                                             e
                                          
                                       
                                       (
                                       θ
                                       )
                                       
                                       ∀
                                       e
                                       =
                                       (
                                       v
                                       ,
                                       w
                                       )
                                       ∈
                                       E
                                       ,
                                       θ
                                       ∈
                                       [
                                       0
                                       ,
                                       T
                                       )
                                       ,
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             π
                                          
                                          
                                             v
                                          
                                       
                                       
                                       of bounded variation and right
                                    
                                 
                                 
                                    
                                    
                                       continuous on
                                       
                                       [
                                       0
                                       ,
                                       T
                                       ]
                                       
                                       with
                                       
                                       
                                          
                                             π
                                          
                                          
                                             v
                                          
                                       
                                       (
                                       T
                                       )
                                       =
                                       0
                                       
                                       ∀
                                       v
                                       ∈
                                       V
                                       ,
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             ρ
                                          
                                          
                                             e
                                          
                                       
                                       ⩽
                                       0
                                       
                                       ∀
                                       e
                                       ∈
                                       E
                                       .
                                    
                                 
                              
                           
                        
                     This formulation requires explanation. Since 
                        
                           
                              
                                 π
                              
                              
                                 v
                              
                           
                        
                      is of bounded variation, there exist two functions 
                        
                           
                              
                                 π
                              
                              
                                 v
                              
                              
                                 +
                              
                           
                        
                      and 
                        
                           
                              
                                 π
                              
                              
                                 v
                              
                              
                                 -
                              
                           
                        
                     , known as the Jordan decomposition of 
                        
                           
                              
                                 π
                              
                              
                                 v
                              
                           
                        
                     , that are monotonic increasing on 
                        
                           [
                           0
                           ,
                           T
                           ]
                        
                      with 
                        
                           
                              
                                 π
                              
                              
                                 v
                              
                           
                           (
                           θ
                           )
                           =
                           
                              
                                 π
                              
                              
                                 v
                              
                              
                                 +
                              
                           
                           (
                           θ
                           )
                           -
                           
                              
                                 π
                              
                              
                                 v
                              
                              
                                 -
                              
                           
                           (
                           θ
                           )
                        
                      for 
                        
                           θ
                           ∈
                           [
                           0
                           ,
                           T
                           ]
                        
                      (see, e.g., Apostol, 1974). The functions 
                        
                           
                              
                                 π
                              
                              
                                 v
                              
                              
                                 +
                              
                           
                        
                      and 
                        
                           
                              
                                 π
                              
                              
                                 v
                              
                              
                                 -
                              
                           
                        
                      are called the positive and negative part of 
                        
                           
                              
                                 π
                              
                              
                                 v
                              
                           
                        
                     , respectively. In the objective function, 
                        
                           
                              
                                 π
                              
                              
                                 v
                              
                              
                                 -
                              
                           
                        
                      denotes the negative part of 
                        
                           
                              
                                 π
                              
                              
                                 v
                              
                           
                        
                      and the notation 
                        
                           
                              ∫
                              
                                 0
                              
                              
                                 T
                              
                           
                           
                              
                                 U
                              
                              
                                 v
                              
                           
                           (
                           θ
                           )
                           
                           d
                           
                              
                                 π
                              
                              
                                 v
                              
                              
                                 -
                              
                           
                           (
                           θ
                           )
                        
                      denotes the Lebesgue–Stieltjes integral of the function 
                        
                           
                              
                                 U
                              
                              
                                 v
                              
                           
                        
                      with respect to function 
                        
                           
                              
                                 π
                              
                              
                                 v
                              
                              
                                 -
                              
                           
                        
                      from 0 to T.

For each 
                        
                           e
                           ∈
                           E
                        
                     , the dual variable 
                        
                           
                              
                                 ρ
                              
                              
                                 e
                              
                           
                        
                      can be eliminated from (MCFP∗) since it appears in the objective function integrated with 
                        
                           
                              
                                 u
                              
                              
                                 e
                              
                           
                        
                      which is nonnegative on 
                        
                           [
                           0
                           ,
                           T
                           ]
                        
                     . Hence, at an optimum solution 
                        
                           
                              
                                 ρ
                              
                              
                                 e
                              
                           
                        
                      should be as large as possible. This observation implies that if we know optimal values for the dual variables 
                        
                           π
                        
                     , we can compute the optimal values for 
                        
                           
                              
                                 ρ
                              
                              
                                 e
                              
                           
                        
                      by
                        
                           (2)
                           
                              
                                 
                                    ρ
                                 
                                 
                                    e
                                 
                              
                              (
                              θ
                              )
                              =
                              
                                 min
                              
                              {
                              0
                              ,
                              
                                 
                                    c
                                 
                                 
                                    e
                                 
                              
                              (
                              θ
                              )
                              -
                              
                                 
                                    π
                                 
                                 
                                    v
                                 
                              
                              (
                              θ
                              )
                              +
                              
                                 
                                    π
                                 
                                 
                                    w
                                 
                              
                              (
                              θ
                              +
                              
                                 
                                    τ
                                 
                                 
                                    e
                                 
                              
                              )
                              }
                              
                              ∀
                              e
                              =
                              (
                              v
                              ,
                              w
                              )
                              ∈
                              E
                              ,
                              
                              θ
                              ∈
                              [
                              0
                              ,
                              T
                              ]
                              .
                           
                        
                     
                     
                        Theorem 1
                        Weak Duality, Anderson and Philpott, 1994
                        


                        
                           
                              
                                 V
                                 [
                                 (
                                 MCFP
                                 )
                                 ]
                                 ⩽
                                 V
                                 [
                                 (
                                 MCFP
                                 *
                                 )
                                 ]
                              
                           .

Here and throughout the rest of this paper, we use 
                        
                           V
                           [
                           OP
                           ]
                        
                      to denote the optimal value of an optimization problem OP. Moreover, we use 
                        
                           V
                           [
                           OP
                           ,
                           x
                           ]
                        
                      to denote the objective function value for a given solution x.

To state the next theorem, we introduce some basic definitions. We say that a monotonic increasing function 
                        
                           f
                           :
                           [
                           a
                           ,
                           b
                           ]
                           →
                           R
                        
                      is strictly increasing at 
                        
                           θ
                           ∈
                           (
                           a
                           ,
                           b
                           )
                        
                      if 
                        
                           f
                           (
                           
                              
                                 θ
                              
                              
                                 1
                              
                           
                           )
                           <
                           f
                           (
                           θ
                           )
                           <
                           f
                           (
                           
                              
                                 θ
                              
                              
                                 2
                              
                           
                           )
                        
                      for any 
                        
                           
                              
                                 θ
                              
                              
                                 1
                              
                           
                           ,
                           
                           
                              
                                 θ
                              
                              
                                 2
                              
                           
                           ∈
                           [
                           a
                           ,
                           b
                           ]
                        
                      with 
                        
                           θ
                           ∈
                           (
                           
                              
                                 θ
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 θ
                              
                              
                                 2
                              
                           
                           )
                           ,
                           f
                        
                      is strictly increasing at a if 
                        
                           f
                           (
                           a
                           )
                           <
                           f
                           (
                           θ
                           )
                        
                      for every 
                        
                           θ
                           ∈
                           (
                           a
                           ,
                           b
                           ]
                        
                     , and f is strictly increasing at b if 
                        
                           f
                           (
                           θ
                           )
                           <
                           f
                           (
                           b
                           )
                        
                      for every 
                        
                           θ
                           ∈
                           [
                           a
                           ,
                           b
                           )
                        
                     . A function f of bounded variation on 
                        
                           [
                           a
                           ,
                           b
                           ]
                        
                      is said to be strictly increasing at 
                        
                           θ
                           ∈
                           [
                           a
                           ,
                           b
                           ]
                        
                      if 
                        
                           
                              
                                 f
                              
                              
                                 +
                              
                           
                        
                      is strictly increasing at 
                        
                           θ
                        
                     , similarly f is strictly decreasing at 
                        
                           θ
                        
                      if 
                        
                           
                              
                                 f
                              
                              
                                 -
                              
                           
                        
                      is strictly increasing at 
                        
                           θ
                        
                     .
                        Theorem 2
                        Complementary Slackness, Anderson and Philpott, 1994
                        


                        
                           Suppose that x with corresponding storage Y derived from 
                           
                              (1)
                            
                           is feasible for 
                           
                              (MCFP)
                            
                           and 
                           
                              
                                 π
                              
                            
                           with corresponding 
                           
                              
                                 ρ
                              
                            
                           given by 
                           
                              (2)
                            
                           is feasible for 
                           
                              (MCFP∗
                              )
                           
                           . If for each 
                           
                              
                                 e
                                 =
                                 (
                                 v
                                 ,
                                 w
                                 )
                                 ∈
                                 E
                                 ,
                                 v
                                 ∈
                                 V
                              
                           
                           , and 
                           
                              
                                 θ
                                 ∈
                                 [
                                 0
                                 ,
                                 T
                                 ]
                              
                           
                           , the following conditions are met:
                           
                              
                                 
                                    (CS1)
                                 
                                 
                                    if 
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                e
                                             
                                          
                                          (
                                          θ
                                          )
                                          -
                                          
                                             
                                                π
                                             
                                             
                                                v
                                             
                                          
                                          (
                                          θ
                                          )
                                          +
                                          
                                             
                                                π
                                             
                                             
                                                w
                                             
                                          
                                          (
                                          θ
                                          +
                                          
                                             
                                                τ
                                             
                                             
                                                e
                                             
                                          
                                          )
                                          >
                                          0
                                       
                                    , then 
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                e
                                             
                                          
                                          (
                                          θ
                                          )
                                          =
                                          0
                                       
                                    ;


                                    if 
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                e
                                             
                                          
                                          (
                                          θ
                                          )
                                          -
                                          
                                             
                                                π
                                             
                                             
                                                v
                                             
                                          
                                          (
                                          θ
                                          )
                                          +
                                          
                                             
                                                π
                                             
                                             
                                                w
                                             
                                          
                                          (
                                          θ
                                          +
                                          
                                             
                                                τ
                                             
                                             
                                                e
                                             
                                          
                                          )
                                          <
                                          0
                                       
                                    , then 
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                e
                                             
                                          
                                          (
                                          θ
                                          )
                                          =
                                          
                                             
                                                u
                                             
                                             
                                                e
                                             
                                          
                                          (
                                          θ
                                          )
                                       
                                    ;


                                    if 
                                    
                                       
                                          
                                             
                                                π
                                             
                                             
                                                v
                                             
                                          
                                       
                                     
                                    is strictly increasing at 
                                    
                                       
                                          θ
                                       
                                    , then 
                                    
                                       
                                          
                                             
                                                Y
                                             
                                             
                                                v
                                             
                                          
                                          (
                                          θ
                                          )
                                          =
                                          0
                                       
                                    ;


                                    if 
                                    
                                       
                                          
                                             
                                                π
                                             
                                             
                                                v
                                             
                                          
                                       
                                     
                                    is strictly decreasing at 
                                    
                                       
                                          θ
                                       
                                    , then 
                                    
                                       
                                          
                                             
                                                Y
                                             
                                             
                                                v
                                             
                                          
                                          (
                                          θ
                                          )
                                          =
                                          
                                             
                                                U
                                             
                                             
                                                v
                                             
                                          
                                          (
                                          θ
                                          )
                                       
                                    .

We shall refer to conditions (CS1)–(CS4) as complementary slackness conditions. The function 
                        
                           π
                        
                      of bounded variation is said to be complementary slack with x if x and 
                        
                           π
                        
                      satisfies these conditions.

It is an open question as to whether a strong duality result can be established whereby 
                        
                           V
                           [
                           
                              (MCFP)
                           
                           ]
                           =
                           V
                           [
                           
                              (MCFP∗)
                           
                           ]
                        
                      and these values are attained in each program. As noted previously, a primal optimal solution exists for (MCFP). Thus we are left with the task to find a dual feasible solution 
                        
                           π
                        
                      for which 
                        
                           V
                           [
                           
                              (MCFP),
                           x
                           ]
                           =
                           V
                           [
                           
                              (MCFP∗),
                           π
                           ]
                        
                     . In general, strong duality may not hold, even for the special case that all transit times are zero (see Pullan, 1997 for some examples). However, we show that strong duality can be derived for (MCFP) and (MCFP∗) under the following assumptions.
                        Assumption 1
                        The transit times 
                              
                                 
                                    
                                       τ
                                    
                                    
                                       e
                                    
                                 
                                 ,
                                 
                                 e
                                 ∈
                                 E
                              
                            are all rational as well as the time horizon T.

The input functions 
                              
                                 
                                    
                                       c
                                    
                                    
                                       e
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       u
                                    
                                    
                                       e
                                    
                                 
                              
                            for all 
                              
                                 e
                                 ∈
                                 E
                              
                            and 
                              
                                 
                                    
                                       b
                                    
                                    
                                       v
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       u
                                    
                                    
                                       v
                                    
                                 
                              
                            for each 
                              
                                 v
                                 ∈
                                 V
                              
                            are all piecewise analytic on 
                              
                                 [
                                 0
                                 ,
                                 T
                                 ]
                              
                           .

We recall that a function 
                        
                           h
                           :
                           [
                           0
                           ,
                           T
                           ]
                           →
                           R
                        
                      is said to piecewise analytic if there exists a partition 
                        
                           {
                           
                              
                                 θ
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 θ
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 θ
                              
                              
                                 m
                              
                           
                           }
                        
                      of 
                        
                           [
                           0
                           ,
                           T
                           ]
                           ,
                           ∊
                           >
                           0
                        
                     , and 
                        
                           
                              
                                 h
                              
                              
                                 k
                              
                           
                        
                      analytic on 
                        
                           (
                           
                              
                                 θ
                              
                              
                                 k
                                 -
                                 1
                              
                           
                           -
                           ∊
                           ,
                           
                              
                                 θ
                              
                              
                                 k
                              
                           
                           )
                        
                      with 
                        
                           
                              
                                 h
                              
                              
                                 k
                              
                           
                           (
                           θ
                           )
                           =
                           h
                           (
                           θ
                           )
                        
                      for all 
                        
                           θ
                           ∈
                           [
                           
                              
                                 θ
                              
                              
                                 k
                                 -
                                 1
                              
                           
                           ,
                           
                              
                                 θ
                              
                              
                                 k
                              
                           
                           )
                        
                      and all 
                        
                           k
                           =
                           1
                           ,
                           …
                           ,
                           m
                        
                     . It follows from this definition that piecewise analytic functions are right-continuous but not necessarily left-continuous. In fact, they may be discontinuous at a finite number of points.

We suppose that Assumptions 1 and 2 hold throughout the rest of the paper. These assumptions guarantee the existence of a piecewise analytic optimal solution for (MCFP).
                        Theorem 3
                        
                           Pullan, 1997
                        


                        
                           Under 
                           
                              Assumptions 1 and 2
                           , if 
                           
                              
                                 F
                              
                            
                           is nonempty, then 
                           
                              (MCFP)
                           
                           
                           has an optimal solution which is also piecewise analytic on 
                           
                              
                                 [
                                 0
                                 ,
                                 T
                                 ]
                              
                           
                           .
                        

A key observation in establishing strong duality for the static minimum cost flow problem is the fact that starting from some feasible flow we can construct a dual solution if the network contains no augmenting cycles with negative cost. More precisely, the shortest distance labels from one specified node to the other nodes in the residual network define a dual feasible solution which is complementary slack with the given feasible flow. We wish to derive duality results for (MCFP) along the same lines. To do so, we need to carry over the concept of least cost augmenting paths to the continuous-time setting.

For each arc 
                        
                           e
                           =
                           (
                           v
                           ,
                           w
                           )
                           ∈
                           E
                        
                     , we create a backward arc 
                     
                        
                           
                              
                                 e
                              
                              
                                 ←
                              
                           
                           
                           ≔
                           
                           (
                           w
                           ,
                           v
                           )
                        
                     . This causes no notational conflict since 
                        
                           (
                           w
                           ,
                           v
                           )
                        
                      is not in E if 
                        
                           (
                           v
                           ,
                           w
                           )
                        
                      belongs to E due to our assumption that there is at most one arc between any pair of nodes. With each backward arc 
                        
                           
                              
                                 e
                              
                              
                                 ←
                              
                           
                        
                      we associate a transit time 
                        
                           
                              
                                 τ
                              
                              
                                 
                                    
                                       e
                                    
                                    
                                       ←
                                    
                                 
                              
                           
                           
                           ≔
                           
                           -
                           
                              
                                 τ
                              
                              
                                 e
                              
                           
                        
                      and a cost function 
                        
                           
                              
                                 c
                              
                              
                                 
                                    
                                       e
                                    
                                    
                                       ←
                                    
                                 
                              
                           
                           
                           ≔
                           
                           -
                           (
                           
                              
                                 c
                              
                              
                                 e
                              
                           
                           -
                           
                              
                                 τ
                              
                              
                                 e
                              
                           
                           )
                        
                     . We denote the set of all backward arcs by 
                        
                           
                              
                                 E
                              
                              
                                 ←
                              
                           
                        
                      and set 
                        
                           
                              
                                 E
                              
                              
                                 r
                              
                           
                           
                           ≔
                           
                           E
                           ∪
                           
                              
                                 E
                              
                              
                                 ←
                              
                           
                        
                     .

Following Philpott (1985), a node-time pair (NTP) is a member of 
                        
                           V
                           ×
                           [
                           0
                           ,
                           T
                           ]
                        
                      which refers to a particular node at a specific time. We say that NTP 
                        
                           (
                           v
                           ,
                           α
                           )
                        
                      is arc-linked to NTP 
                        
                           (
                           w
                           ,
                           β
                           )
                        
                      if we can arrive at w at time 
                        
                           β
                        
                      when departing from v at time 
                        
                           α
                        
                      via 
                        
                           e
                           
                           ≔
                           
                           (
                           v
                           ,
                           w
                           )
                        
                     , i.e., 
                        
                           e
                           ∈
                           
                              
                                 E
                              
                              
                                 r
                              
                           
                           
                           and
                           
                           β
                           =
                           α
                           +
                           
                              
                                 τ
                              
                              
                                 e
                              
                           
                        
                     . We also say that NTP 
                        
                           (
                           v
                           ,
                           α
                           )
                        
                      is node-linked to NTP 
                        
                           (
                           w
                           ,
                           β
                           )
                        
                      if 
                        
                           v
                           =
                           w
                        
                     . A continuous-time dynamic walk from NTP 
                        
                           (
                           v
                           ,
                           α
                           )
                        
                      to NTP 
                        
                           (
                           w
                           ,
                           β
                           )
                        
                      is a sequence of NTPs
                        
                           
                              P
                              :
                              (
                              v
                              ,
                              α
                              )
                              =
                              (
                              
                                 
                                    v
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    θ
                                 
                                 
                                    1
                                 
                              
                              )
                              ,
                              (
                              
                                 
                                    v
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    θ
                                 
                                 
                                    2
                                 
                              
                              )
                              ,
                              …
                              ,
                              (
                              
                                 
                                    v
                                 
                                 
                                    q
                                 
                              
                              ,
                              
                                 
                                    θ
                                 
                                 
                                    q
                                 
                              
                              )
                              =
                              (
                              w
                              ,
                              β
                              )
                              ,
                           
                        
                     such that consecutive members are either arc- or node-linked. The sequence P is called a continuous-time dynamic path if all NTPs are distinct and is called a continuous-time dynamic cycle if 
                        
                           q
                           ⩾
                           3
                           ,
                           
                           (
                           v
                           ,
                           α
                           )
                           =
                           (
                           w
                           ,
                           β
                           )
                        
                     , and all other NTPs are distinct. For reasons of brevity, hereafter, the term “continuous-time dynamic” is omitted when referring to a continuous-time dynamic walk, path, or cycle.

Given a flow over time x with corresponding storage Y, we define the corresponding residual network as follows. Due to Theorem 3, the flow x is assumed to be piecewise analytic. For each arc 
                        
                           e
                           ∈
                           E
                        
                      we define the residual capacity of e and 
                        
                           
                              
                                 e
                              
                              
                                 ←
                              
                           
                        
                      by 
                        
                           
                              
                                 u
                              
                              
                                 e
                              
                              
                                 r
                              
                           
                           
                           ≔
                           
                           
                              
                                 u
                              
                              
                                 e
                              
                              
                                 r
                              
                           
                           -
                           
                              
                                 x
                              
                              
                                 e
                              
                           
                        
                      and 
                        
                           
                              
                                 u
                              
                              
                                 
                                    
                                       e
                                    
                                    
                                       ←
                                    
                                 
                              
                              
                                 r
                              
                           
                           
                           ≔
                           
                           
                              
                                 x
                              
                              
                                 e
                              
                           
                           -
                           
                              
                                 τ
                              
                              
                                 e
                              
                           
                        
                     , respectively. Further, for each node 
                        
                           v
                           ∈
                           V
                        
                     , we define the upper and lower residual capacity of v as 
                        
                           
                              
                                 U
                              
                              
                                 v
                              
                              
                                 r
                              
                           
                           
                           ≔
                           
                           
                              
                                 U
                              
                              
                                 v
                              
                           
                           -
                           
                              
                                 Y
                              
                              
                                 v
                              
                           
                        
                      and 
                        
                           
                              
                                 L
                              
                              
                                 v
                              
                              
                                 r
                              
                           
                           
                           ≔
                           
                           
                              
                                 Y
                              
                              
                                 v
                              
                           
                        
                     , respectively. For any arc 
                        
                           e
                           ∈
                           E
                        
                     , the residual capacities 
                        
                           
                              
                                 u
                              
                              
                                 e
                              
                              
                                 r
                              
                           
                        
                      and 
                        
                           
                              
                                 u
                              
                              
                                 
                                    
                                       e
                                    
                                    
                                       ←
                                    
                                 
                              
                              
                                 r
                              
                           
                        
                      give the maximum additional flow rate that can be sent or removed from arc e, respectively, without violating the arc capacity constraint 
                        
                           0
                           ⩽
                           
                              
                                 x
                              
                              
                                 e
                              
                           
                           ⩽
                           
                              
                                 u
                              
                              
                                 e
                              
                           
                        
                     . Similarly, for any node 
                        
                           v
                           ∈
                           V
                        
                     , the residual capacities 
                        
                           
                              
                                 U
                              
                              
                                 v
                              
                              
                                 r
                              
                           
                        
                      and 
                        
                           
                              
                                 L
                              
                              
                                 v
                              
                              
                                 r
                              
                           
                        
                      give the maximum additional flow that can be stored or removed from node v, respectively, without violating the node capacity constraint 
                        
                           0
                           ⩽
                           
                              
                                 Y
                              
                              
                                 v
                              
                           
                           ⩽
                           
                              
                                 U
                              
                              
                                 v
                              
                           
                        
                     .

The concept of residual network is based on the following intuitive idea. Suppose that the flow rate into arc 
                        
                           e
                           =
                           (
                           v
                           ,
                           w
                           )
                        
                      at time 
                        
                           θ
                        
                      is 
                        
                           
                              
                                 x
                              
                              
                                 e
                              
                           
                           (
                           θ
                           )
                        
                     . Then we can send an additional flow at rate 
                        
                           
                              
                                 u
                              
                              
                                 e
                              
                           
                           (
                           θ
                           )
                           -
                           
                              
                                 x
                              
                              
                                 e
                              
                           
                           (
                           θ
                           )
                        
                      into arc e at time 
                        
                           θ
                        
                     . Also notice that we can send a flow at rate 
                        
                           
                              
                                 x
                              
                              
                                 e
                              
                           
                           (
                           θ
                           )
                        
                      from node w to node v over the backward arc 
                        
                           
                              
                                 e
                              
                              
                                 ←
                              
                           
                        
                      at time 
                        
                           θ
                           +
                           
                              
                                 τ
                              
                              
                                 e
                              
                           
                        
                     , which amounts to canceling the existing flow on the arc e at time 
                        
                           θ
                        
                     . Whereas sending one unit flow along arc e increases the flow cost by 
                        
                           
                              
                                 c
                              
                              
                                 e
                              
                           
                           (
                           θ
                           )
                        
                      units, sending one unit flow from node w to node v on the arc 
                        
                           
                              
                                 e
                              
                              
                                 ←
                              
                           
                        
                      at time 
                        
                           θ
                           +
                           
                              
                                 τ
                              
                              
                                 e
                              
                           
                        
                      decreases the flow cost by 
                        
                           
                              
                                 c
                              
                              
                                 e
                              
                           
                           (
                           θ
                           )
                        
                      units. Hence, the residual capacity and cost of the arc 
                        
                           
                              
                                 e
                              
                              
                                 ←
                              
                           
                        
                      were defined as 
                        
                           
                              
                                 x
                              
                              
                                 e
                              
                           
                           -
                           
                              
                                 τ
                              
                              
                                 e
                              
                           
                        
                      and 
                        
                           -
                           (
                           
                              
                                 c
                              
                              
                                 e
                              
                           
                           -
                           
                              
                                 τ
                              
                              
                                 e
                              
                           
                           )
                        
                     , respectively. The concept of upper and lower residual capacities at nodes is based on a similar idea.

Next, we introduce the concept of strict augmenting paths and cycles for the continuous-time setting. Given a path (or cycle) 
                        
                           P
                           :
                           (
                           
                              
                                 v
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 θ
                              
                              
                                 1
                              
                           
                           )
                           ,
                           …
                           ,
                           (
                           
                              
                                 v
                              
                              
                                 q
                              
                           
                           ,
                           
                              
                                 θ
                              
                              
                                 q
                              
                           
                           )
                        
                     , the residual capacity of P is defined as
                        
                           
                              cap
                              (
                              P
                              )
                              
                              ≔
                              
                              
                                 min
                              
                              {
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    u
                                 
                                 
                                    q
                                    -
                                    1
                                 
                              
                              }
                              ,
                           
                        
                     where for 
                        
                           k
                           =
                           1
                           ,
                           …
                           ,
                           q
                           -
                           1
                        
                     
                     
                        
                           
                              
                                 
                                    u
                                 
                                 
                                    k
                                 
                              
                              
                              ≔
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      e
                                                   
                                                   
                                                      r
                                                   
                                                
                                                (
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                             
                                             
                                                if
                                                
                                                e
                                                
                                                ≔
                                                
                                                (
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      k
                                                   
                                                
                                                ,
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      k
                                                      +
                                                      1
                                                   
                                                
                                                )
                                                ∈
                                                
                                                   
                                                      E
                                                   
                                                   
                                                      r
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   min
                                                
                                                {
                                                
                                                   
                                                      U
                                                   
                                                   
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                   
                                                      r
                                                   
                                                
                                                (
                                                θ
                                                )
                                                |
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      k
                                                   
                                                
                                                ⩽
                                                θ
                                                ⩽
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      k
                                                      +
                                                      1
                                                   
                                                
                                                }
                                             
                                             
                                                if
                                                
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      k
                                                   
                                                
                                                =
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      k
                                                      +
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      k
                                                   
                                                
                                                <
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      k
                                                      +
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   min
                                                
                                                {
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                   
                                                      r
                                                   
                                                
                                                (
                                                θ
                                                )
                                                |
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      k
                                                      +
                                                      1
                                                   
                                                
                                                ⩽
                                                θ
                                                ⩽
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      k
                                                   
                                                
                                                }
                                             
                                             
                                                if
                                                
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      k
                                                   
                                                
                                                =
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      k
                                                      +
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      k
                                                      +
                                                      1
                                                   
                                                
                                                <
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              .
                           
                        
                     Note that 
                        
                           cap
                           (
                           P
                           )
                        
                      is a real number and not a function as time is already encoded within P. Clearly, if 
                        
                           cap
                           (
                           P
                           )
                           >
                           0
                        
                     , one can push additional flow along P without violating capacity constraints. We refer to such a path (or cycle) as a strict augmenting path (or cycle).

The cost of P is defined as the sum of the costs of the arcs at the times when they appear along P, i.e.,
                        
                           (3)
                           
                              c
                              (
                              P
                              )
                              
                              ≔
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       :
                                       
                                          
                                             v
                                          
                                          
                                             k
                                          
                                       
                                       ≠
                                       
                                          
                                             v
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    c
                                 
                                 
                                    
                                       
                                          v
                                       
                                       
                                          k
                                       
                                    
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    θ
                                 
                                 
                                    k
                                 
                              
                              )
                              .
                           
                        
                     Here, the index k varies from 1 to 
                        
                           q
                           -
                           1
                        
                     . Recall that the storage costs are supposed to be zero and therefore the cost of a path or cycle depends only on arc transit costs. We refer to path P as a least cost strict augmenting path if 
                        
                           cap
                           (
                           P
                           )
                           >
                           0
                        
                      and in addition, it has the minimum cost among all strict augmenting paths from NTP 
                        
                           (
                           v
                           ,
                           α
                           )
                        
                      to NTP 
                        
                           (
                           w
                           ,
                           β
                           )
                        
                     .

Before with proceeding our discussion, we give an example to show that it is not enough to define an augmenting path to be a path with positive residual capacity.
                        Example 1
                        Consider a network with two nodes s and t, and one arc 
                              
                                 e
                                 
                                 ≔
                                 
                                 (
                                 s
                                 ,
                                 t
                                 )
                              
                           . We let 
                              
                                 T
                                 
                                 ≔
                                 
                                 1
                              
                            and define 
                              
                                 
                                    
                                       c
                                    
                                    
                                       e
                                    
                                 
                                 (
                                 θ
                                 )
                                 
                                 ≔
                                 
                                 
                                    
                                       u
                                    
                                    
                                       e
                                    
                                 
                                 (
                                 θ
                                 )
                                 
                                 ≔
                                 
                                 2
                                 θ
                              
                            for each 
                              
                                 θ
                                 ∈
                                 [
                                 0
                                 ,
                                 1
                                 ]
                              
                           . Further, we assume that the transit time of e is zero. Storage of one flow unit is allowed at the nodes s and t, i.e., 
                              
                                 
                                    
                                       U
                                    
                                    
                                       s
                                    
                                 
                                 (
                                 θ
                                 )
                                 
                                 ≔
                                 
                                 
                                    
                                       U
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 θ
                                 )
                                 
                                 ≔
                                 
                                 1
                              
                            for all 
                              
                                 θ
                                 ∈
                                 [
                                 0
                                 ,
                                 1
                                 ]
                              
                           . The storage costs are supposed to be zero. Finally, there is a supply rate of 
                              
                                 θ
                              
                            at node s and a demand rate of 
                              
                                 θ
                              
                            at node t, i.e., 
                              
                                 
                                    
                                       b
                                    
                                    
                                       s
                                    
                                 
                                 (
                                 θ
                                 )
                                 
                                 ≔
                                 
                                 -
                                 
                                    
                                       b
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 θ
                                 )
                                 
                                 ≔
                                 
                                 θ
                              
                            for each 
                              
                                 θ
                                 ∈
                                 [
                                 0
                                 ,
                                 1
                                 ]
                              
                           . Hence, there is a unique feasible flow x given by 
                              
                                 
                                    
                                       x
                                    
                                    
                                       e
                                    
                                 
                                 =
                                 θ
                              
                            which is, of course, optimal.

We now examine the existence of least cost strict augmenting paths from NTP 
                              
                                 (
                                 s
                                 ,
                                 0
                                 )
                              
                            to NTPs 
                              
                                 (
                                 t
                                 ,
                                 θ
                                 )
                                 ,
                                 θ
                                 ∈
                                 [
                                 0
                                 ,
                                 θ
                                 ]
                              
                           . For each 
                              
                                 θ
                                 ∈
                                 [
                                 0
                                 ,
                                 1
                                 ]
                              
                           , the cost of path 
                              
                                 
                                    
                                       P
                                    
                                    
                                       θ
                                    
                                 
                                 :
                                 (
                                 s
                                 ,
                                 0
                                 )
                                 ,
                                 (
                                 t
                                 ,
                                 0
                                 )
                                 ,
                                 (
                                 t
                                 ,
                                 θ
                                 )
                              
                            is zero, but 
                              
                                 
                                    
                                       P
                                    
                                    
                                       θ
                                    
                                 
                              
                            is not a strict augmenting path as 
                              
                                 cap
                                 (
                                 
                                    
                                       P
                                    
                                    
                                       θ
                                    
                                 
                                 )
                                 =
                                 0
                              
                           . On the other hand, the path 
                              
                                 
                                    
                                       P
                                    
                                    
                                       θ
                                    
                                    
                                       ∊
                                    
                                 
                                 :
                                 (
                                 s
                                 ,
                                 0
                                 )
                                 ,
                                 (
                                 s
                                 ,
                                 ∊
                                 )
                                 ,
                                 (
                                 t
                                 ,
                                 ∊
                                 )
                                 ,
                                 (
                                 t
                                 ,
                                 θ
                                 )
                              
                            with 
                              
                                 0
                                 <
                                 ∊
                                 <
                                 θ
                              
                           , which uses arc e at point in time 
                              
                                 ∊
                              
                           , is a strict augmenting path whose cost is 
                              
                                 2
                                 ∊
                              
                           . Hence, the cost of path 
                              
                                 
                                    
                                       P
                                    
                                    
                                       θ
                                    
                                    
                                       ∊
                                    
                                 
                              
                            becomes smaller as 
                              
                                 ∊
                              
                            approaches to zero. Consequently, there exist no least cost strict augmenting path from 
                              
                                 (
                                 s
                                 ,
                                 0
                                 )
                              
                            to 
                              
                                 (
                                 t
                                 ,
                                 θ
                                 )
                              
                            for all 
                              
                                 θ
                                 ∈
                                 [
                                 0
                                 ,
                                 1
                                 ]
                              
                           . However, for each 
                              
                                 θ
                                 ∈
                                 [
                                 0
                                 ,
                                 1
                                 ]
                              
                           , one may consider the path 
                              
                                 
                                    
                                       P
                                    
                                    
                                       θ
                                    
                                 
                              
                            as an augmenting path because an additional flow can be sent in the neighborhood of path 
                              
                                 
                                    
                                       P
                                    
                                    
                                       θ
                                    
                                 
                              
                           . Having defined augmenting paths in this manner, the path 
                              
                                 
                                    
                                       P
                                    
                                    
                                       θ
                                    
                                 
                              
                            is a least cost augmenting path from NTP 
                              
                                 (
                                 s
                                 ,
                                 0
                                 )
                              
                            to NTP 
                              
                                 (
                                 t
                                 ,
                                 θ
                                 )
                              
                            for each 
                              
                                 θ
                                 ∈
                                 [
                                 0
                                 ,
                                 1
                                 ]
                              
                           .

It follows from Example 1 that we need to define augmenting paths in an appreciate way. Let P be a given path. We can identify P by a sequence of nodes, say 
                        
                           
                              
                                 v
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 v
                              
                              
                                 q
                              
                           
                        
                      such that 
                        
                           
                              
                                 e
                              
                              
                                 i
                              
                           
                           
                           ≔
                           
                           (
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 i
                                 +
                                 1
                              
                           
                           )
                           ∈
                           
                              
                                 E
                              
                              
                                 r
                              
                           
                           ,
                           
                           i
                           =
                           1
                           ,
                           …
                           ,
                           q
                           -
                           1
                        
                      together with the arrival and departure times 
                        
                           
                              
                                 α
                              
                              
                                 i
                              
                           
                        
                      and 
                        
                           
                              
                                 β
                              
                              
                                 i
                              
                           
                        
                     , respectively, at node i for 
                        
                           i
                           =
                           1
                           ,
                           …
                           ,
                           q
                        
                     , where 
                        
                           
                              
                                 β
                              
                              
                                 i
                                 +
                                 1
                              
                           
                           =
                           
                              
                                 α
                              
                              
                                 i
                              
                           
                           +
                           
                              
                                 τ
                              
                              
                                 
                                    
                                       e
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        
                     . Given an 
                        
                           ∊
                           >
                           0
                        
                     , we define the 
                        
                           ∊
                        
                     
                     -neighborhood 
                     
                        
                           N
                           (
                           P
                           ,
                           ∊
                           )
                        
                      of P as the set of all paths as 
                        
                           
                              
                                 P
                              
                              
                                 ′
                              
                           
                        
                      with the node sequence 
                        
                           
                              
                                 v
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 v
                              
                              
                                 q
                              
                           
                        
                      together with the arrival and departure times 
                        
                           
                              
                                 α
                              
                              
                                 i
                              
                              
                                 ′
                              
                           
                        
                      and 
                        
                           
                              
                                 β
                              
                              
                                 i
                              
                              
                                 ′
                              
                           
                        
                     , respectively, for 
                        
                           i
                           =
                           1
                           ,
                           …
                           ,
                           q
                        
                      such that 
                        
                           
                              
                                 
                                    
                                       
                                          α
                                       
                                       
                                          i
                                       
                                    
                                    -
                                    
                                       
                                          α
                                       
                                       
                                          i
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           
                           <
                           ∊
                        
                      and 
                        
                           
                              
                                 
                                    
                                       
                                          β
                                       
                                       
                                          i
                                       
                                    
                                    -
                                    
                                       
                                          β
                                       
                                       
                                          i
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           
                           <
                           ∊
                        
                      for all 
                        
                           i
                           =
                           1
                           ,
                           …
                           ,
                           q
                        
                     . In other words, a path 
                        
                           
                              
                                 P
                              
                              
                                 ′
                              
                           
                        
                      is contained in 
                        
                           N
                           (
                           P
                           ,
                           ∊
                           )
                        
                      if and only if P and 
                        
                           
                              
                                 P
                              
                              
                                 ′
                              
                           
                        
                      are representable by the same sequence of nodes where all arrival and departure times differ by at most 
                        
                           ∊
                        
                     .

We say that a path is augmenting if it has a strict augmenting path in its neighborhood. Intuitively, the path P is an augmenting path if we can send an additional flow rate along a path in the neighborhood of P. However, we might have some augmenting path with zero residual capacity (see Example 1). An augmenting path P from 
                        
                           (
                           v
                           ,
                           α
                           )
                        
                      to 
                        
                           (
                           w
                           ,
                           β
                           )
                        
                      is said to be a least cost augmenting path if it has the minimum cost among all augmenting paths from 
                        
                           (
                           v
                           ,
                           α
                           )
                        
                      to 
                        
                           (
                           w
                           ,
                           β
                           )
                        
                     . An augmenting cycle is called a negative augmenting cycle if its cost is negative.

In the following, we investigate the existence of least cost augmenting paths from a NTP to all other NTPs. We consider two arbitrary nodes s and t in V and fix NTP 
                        
                           (
                           s
                           ,
                           0
                           )
                        
                      as the source and NTP 
                        
                           (
                           t
                           ,
                           T
                           )
                        
                      as the sink. The question is whether or not there exists a least cost augmenting path from 
                        
                           (
                           s
                           ,
                           0
                           )
                        
                      to 
                        
                           (
                           t
                           ,
                           T
                           )
                        
                     . A closely related problem is already studied by Koch and Nasrabadi (2010), who discuss the continuous-time dynamic shortest path problem with negative transit times. They prove that a dynamic shortest path exists in general if and only if the cost functions are piecewise analytic and transit times are rational. We use the same techniques as in Koch and Nasrabadi (2010) to show that under Assumptions 1 and 2 a least cost augmenting path from NTP 
                        
                           (
                           s
                           ,
                           0
                           )
                        
                      to NTP 
                        
                           (
                           t
                           ,
                           T
                           )
                        
                      exists.

We need to give some definitions. Suppose that 
                        
                           P
                           :
                           (
                           
                              
                                 v
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 θ
                              
                              
                                 1
                              
                           
                           )
                           ,
                           (
                           
                              
                                 i
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 θ
                              
                              
                                 2
                              
                           
                           )
                           ,
                           …
                           ,
                           (
                           
                              
                                 v
                              
                              
                                 q
                              
                           
                           ,
                           
                              
                                 θ
                              
                              
                                 q
                              
                           
                           )
                        
                      is an augmenting path from NTP 
                        
                           (
                           s
                           ,
                           0
                           )
                        
                      to NTP 
                        
                           (
                           t
                           ,
                           T
                           )
                        
                     . The path P is said to be a local least cost augmenting path if there exists an 
                        
                           ∊
                           >
                           0
                        
                      such that 
                        
                           c
                           (
                           P
                           )
                           ⩽
                           c
                           (
                           
                              
                                 P
                              
                              
                                 ′
                              
                           
                           )
                        
                      for all augmenting paths 
                        
                           
                              
                                 P
                              
                              
                                 ′
                              
                           
                        
                      in the 
                        
                           ∊
                        
                     -neighborhood of P.

We next give a characterization of local least cost augmenting paths. Let 
                        
                           Q
                           :
                           (
                           
                              
                                 v
                              
                              
                                 ℓ
                              
                           
                           ,
                           
                              
                                 θ
                              
                              
                                 ℓ
                              
                           
                           )
                           ,
                           …
                           ,
                           (
                           
                              
                                 v
                              
                              
                                 r
                              
                           
                           ,
                           
                              
                                 θ
                              
                              
                                 r
                              
                           
                           )
                        
                      be a subsequence of consecutive NTPs in P. We refer to Q as an arc-subpath of P if any pair of consecutive NTPs in Q are arc-linked, i.e., 
                        
                           (
                           
                              
                                 v
                              
                              
                                 k
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 k
                                 +
                                 1
                              
                           
                           )
                           ∈
                           
                              
                                 E
                              
                              
                                 r
                              
                           
                        
                      for 
                        
                           k
                           =
                           ℓ
                           ,
                           …
                           ,
                           r
                           -
                           1
                        
                     . In this case, Q can be seen as the sequence 
                        
                           (
                           
                              
                                 v
                              
                              
                                 ℓ
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 ℓ
                                 +
                                 1
                              
                           
                           )
                           ,
                           …
                           ,
                           (
                           
                              
                                 v
                              
                              
                                 r
                                 -
                                 1
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 r
                              
                           
                           )
                        
                      of arcs in 
                        
                           
                              
                                 E
                              
                              
                                 r
                              
                           
                        
                      together with starting time 
                        
                           
                              
                                 θ
                              
                              
                                 ℓ
                              
                           
                        
                      from node 
                        
                           
                              
                                 v
                              
                              
                                 ℓ
                              
                           
                        
                     . If in addition, 
                        
                           
                              
                                 v
                              
                              
                                 ℓ
                                 -
                                 1
                              
                           
                           =
                           
                              
                                 v
                              
                              
                                 ℓ
                              
                           
                        
                      or 
                        
                           
                              
                                 v
                              
                              
                                 ℓ
                              
                           
                           =
                           
                              
                                 v
                              
                              
                                 1
                              
                           
                        
                      and 
                        
                           
                              
                                 v
                              
                              
                                 r
                              
                           
                           =
                           
                              
                                 v
                              
                              
                                 r
                                 +
                                 1
                              
                           
                        
                      or 
                        
                           
                              
                                 v
                              
                              
                                 r
                              
                           
                           =
                           
                              
                                 v
                              
                              
                                 q
                              
                           
                        
                     , then Q is called a maximal arc-subpath of P.

In what follows, we suppose that Q is an arc-subpath of P. For a point in time 
                        
                           α
                           ∈
                           [
                           0
                           ,
                           T
                           ]
                        
                     , we define a path 
                        
                           P
                           
                              
                                 |
                              
                              
                                 Q
                              
                           
                           (
                           α
                           )
                        
                      as
                        
                           (4)
                           
                              P
                              
                                 
                                    |
                                 
                                 
                                    Q
                                 
                              
                              (
                              α
                              )
                              :
                              (
                              
                                 
                                    v
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    θ
                                 
                                 
                                    1
                                 
                              
                              )
                              ,
                              …
                              ,
                              
                                 
                                    
                                       
                                          
                                             v
                                          
                                          
                                             
                                                
                                                   ℓ
                                                
                                                
                                                   ∗
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             θ
                                          
                                          
                                             
                                                
                                                   ℓ
                                                
                                                
                                                   ∗
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              ,
                              (
                              
                                 
                                    v
                                 
                                 
                                    ℓ
                                 
                              
                              ,
                              
                                 
                                    α
                                 
                                 
                                    ℓ
                                 
                              
                              )
                              ,
                              …
                              ,
                              (
                              
                                 
                                    v
                                 
                                 
                                    r
                                 
                              
                              ,
                              
                                 
                                    α
                                 
                                 
                                    r
                                 
                              
                              )
                              ,
                              
                                 
                                    
                                       
                                          
                                             v
                                          
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   ∗
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             θ
                                          
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   ∗
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              ,
                              …
                              ,
                              (
                              
                                 
                                    v
                                 
                                 
                                    q
                                 
                              
                              ,
                              
                                 
                                    θ
                                 
                                 
                                    q
                                 
                              
                              )
                              ,
                           
                        
                     
                     
                        
                           (5)
                           
                              with
                              
                              
                                 
                                    ℓ
                                 
                                 
                                    ∗
                                 
                              
                              
                              ≔
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                ℓ
                                                -
                                                1
                                             
                                             
                                                if
                                                
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      ℓ
                                                      -
                                                      1
                                                   
                                                
                                                =
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      ℓ
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ℓ
                                             
                                             
                                                if
                                                
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      ℓ
                                                      -
                                                      1
                                                   
                                                
                                                
                                                ≠
                                                
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      ℓ
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              
                              and
                              
                              
                                 
                                    r
                                 
                                 
                                    ∗
                                 
                              
                              
                              ≔
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                r
                                                +
                                                1
                                             
                                             
                                                if
                                                
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      r
                                                   
                                                
                                                =
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      r
                                                      +
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                r
                                             
                                             
                                                if
                                                
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      r
                                                   
                                                
                                                
                                                ≠
                                                
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      r
                                                      +
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           
                              
                                 α
                              
                              
                                 ℓ
                              
                           
                           
                           ≔
                           
                           α
                        
                      and 
                        
                           
                              
                                 α
                              
                              
                                 k
                                 +
                                 1
                              
                           
                           
                           ≔
                           
                           
                              
                                 α
                              
                              
                                 k
                              
                           
                           +
                           
                              
                                 τ
                              
                              
                                 
                                    
                                       v
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                              
                           
                        
                      for 
                        
                           k
                           =
                           ℓ
                           ,
                           …
                           ,
                           r
                           -
                           1
                        
                     . Roughly speaking, 
                        
                           P
                           
                              
                                 |
                              
                              
                                 Q
                              
                           
                           (
                           α
                           )
                        
                      is constructed from P by shifting the starting time of arc-subpath Q from 
                        
                           
                              
                                 θ
                              
                              
                                 ℓ
                              
                           
                        
                      to 
                        
                           α
                        
                     . It is obvious that 
                        
                           P
                           
                              
                                 |
                              
                              
                                 Q
                              
                           
                           (
                           α
                           )
                        
                      is contained in the 
                        
                           ∊
                        
                     -neighborhood of P for some 
                        
                           ∊
                           >
                           0
                        
                      if 
                        
                           |
                           
                              
                                 θ
                              
                              
                                 ℓ
                              
                           
                           -
                           α
                           |
                           <
                           ∊
                        
                     . We next determine a maximal interval 
                        
                           [
                           a
                           ,
                           b
                           ]
                        
                     , containing 
                        
                           
                              
                                 θ
                              
                              
                                 ℓ
                              
                           
                        
                      so that the path 
                        
                           P
                           
                              
                                 |
                              
                              
                                 Q
                              
                           
                           (
                           α
                           )
                        
                      is an augmenting path for every 
                        
                           α
                           ∈
                           [
                           a
                           ,
                           b
                           ]
                        
                     . Here and subsequently, by maximal we mean with respect to inclusion. To do so, we define a function 
                        
                           f
                           :
                           [
                           0
                           ,
                           T
                           ]
                           →
                           
                              
                                 R
                              
                              
                                 ⩾
                                 0
                              
                           
                        
                      as
                        
                           
                              f
                              (
                              θ
                              )
                              
                              ≔
                              
                              
                                 
                                    
                                       min
                                    
                                    
                                       ℓ
                                       ⩽
                                       k
                                       ⩽
                                       r
                                       -
                                       1
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             
                                                
                                                   e
                                                
                                                
                                                   k
                                                
                                             
                                          
                                          
                                             r
                                          
                                       
                                       
                                          
                                             
                                                θ
                                                +
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         j
                                                         =
                                                         ℓ
                                                      
                                                      
                                                         k
                                                         -
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      τ
                                                   
                                                   
                                                      
                                                         
                                                            e
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              ,
                           
                        
                     where 
                        
                           
                              
                                 e
                              
                              
                                 k
                              
                           
                           =
                           (
                           
                              
                                 v
                              
                              
                                 k
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 k
                                 +
                                 1
                              
                           
                           )
                        
                      for 
                        
                           k
                           =
                           ℓ
                           ,
                           …
                           ,
                           r
                           -
                           1
                        
                     . For each 
                        
                           θ
                           ∈
                           [
                           0
                           ,
                           T
                           ]
                        
                     , the value 
                        
                           f
                           (
                           θ
                           )
                        
                      represents the residual capacity of Q when starting at time 
                        
                           θ
                        
                     . Further, we define two more functions 
                        
                           
                              
                                 g
                              
                              
                                 ℓ
                              
                           
                           ,
                           
                              
                                 g
                              
                              
                                 r
                              
                           
                           :
                           [
                           0
                           ,
                           T
                           ]
                           →
                           
                              
                                 R
                              
                              
                                 ⩾
                                 0
                              
                           
                        
                      as
                        
                           
                              
                                 
                                    g
                                 
                                 
                                    ℓ
                                 
                              
                              (
                              θ
                              )
                              
                              ≔
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      U
                                                   
                                                   
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            ℓ
                                                         
                                                      
                                                   
                                                   
                                                      r
                                                   
                                                
                                                (
                                                θ
                                                )
                                             
                                             
                                                if
                                                
                                                θ
                                                ⩾
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      
                                                         
                                                            ℓ
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                   
                                                
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            ℓ
                                                         
                                                      
                                                   
                                                   
                                                      r
                                                   
                                                
                                                (
                                                θ
                                                )
                                             
                                             
                                                if
                                                
                                                θ
                                                ⩽
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      
                                                         
                                                            ℓ
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                   
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                              
                              and
                              
                              
                                 
                                    g
                                 
                                 
                                    r
                                 
                              
                              (
                              θ
                              )
                              
                              ≔
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                   
                                                   
                                                      r
                                                   
                                                
                                                (
                                                θ
                                                +
                                                
                                                   
                                                      τ
                                                   
                                                   
                                                      Q
                                                   
                                                
                                                )
                                             
                                             
                                                if
                                                
                                                θ
                                                +
                                                
                                                   
                                                      τ
                                                   
                                                   
                                                      Q
                                                   
                                                
                                                ⩾
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                   
                                                
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      U
                                                   
                                                   
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            r
                                                         
                                                      
                                                   
                                                   
                                                      r
                                                   
                                                
                                                (
                                                θ
                                                +
                                                
                                                   
                                                      τ
                                                   
                                                   
                                                      Q
                                                   
                                                
                                                )
                                             
                                             
                                                if
                                                
                                                θ
                                                +
                                                
                                                   
                                                      τ
                                                   
                                                   
                                                      Q
                                                   
                                                
                                                ⩽
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                   
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           
                              
                                 τ
                              
                              
                                 Q
                              
                           
                        
                      is the transit time of arc-subpath Q, i.e., 
                        
                           
                              
                                 τ
                              
                              
                                 Q
                              
                           
                           
                           ≔
                           
                           
                              
                                 ∑
                              
                              
                                 ℓ
                                 ⩽
                                 k
                                 ⩽
                                 r
                                 -
                                 1
                              
                           
                           
                              
                                 τ
                              
                              
                                 
                                    
                                       e
                                    
                                    
                                       k
                                    
                                 
                              
                           
                        
                     . The value 
                        
                           
                              
                                 g
                              
                              
                                 ℓ
                              
                           
                           (
                           θ
                           )
                        
                      gives an upper bound on the amount of flow that can be stored at node 
                        
                           
                              
                                 v
                              
                              
                                 ℓ
                              
                           
                        
                      at time 
                        
                           θ
                        
                      if 
                        
                           θ
                           ⩾
                           
                              
                                 θ
                              
                              
                                 
                                    
                                       ℓ
                                    
                                    
                                       ∗
                                    
                                 
                              
                           
                        
                     , and gives an upper bound on the amount of flow that can be removed from the available storage at node 
                        
                           
                              
                                 v
                              
                              
                                 ℓ
                              
                           
                        
                      at time 
                        
                           θ
                        
                      if 
                        
                           θ
                           ⩽
                           
                              
                                 θ
                              
                              
                                 
                                    
                                       ℓ
                                    
                                    
                                       ∗
                                    
                                 
                              
                           
                        
                     . A similar interpretation holds for the value 
                        
                           
                              
                                 g
                              
                              
                                 r
                              
                           
                           (
                           θ
                           )
                        
                     .

Since P is an augmenting path, 
                        
                           P
                           
                              
                                 |
                              
                              
                                 Q
                              
                           
                           (
                           α
                           )
                        
                      is an augmenting path if 
                        
                           
                              
                                 g
                              
                              
                                 ℓ
                              
                           
                        
                      and 
                        
                           
                              
                                 g
                              
                              
                                 r
                              
                           
                        
                      are strictly positive on 
                        
                           (
                           min
                           {
                           
                              
                                 θ
                              
                              
                                 
                                    
                                       ℓ
                                    
                                    
                                       ∗
                                    
                                 
                              
                           
                           ,
                           α
                           }
                           ,
                           max
                           {
                           
                              
                                 θ
                              
                              
                                 
                                    
                                       ℓ
                                    
                                    
                                       ∗
                                    
                                 
                              
                           
                           ,
                           α
                           }
                           )
                        
                      and 
                        
                           
                              
                                 
                                    min
                                    
                                       
                                          
                                             
                                                
                                                   θ
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         ∗
                                                      
                                                   
                                                
                                             
                                             -
                                             
                                                
                                                   τ
                                                
                                                
                                                   Q
                                                
                                             
                                             ,
                                             α
                                          
                                       
                                    
                                    ,
                                    max
                                    
                                       
                                          
                                             
                                                
                                                   θ
                                                
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         ∗
                                                      
                                                   
                                                
                                             
                                             -
                                             
                                                
                                                   τ
                                                
                                                
                                                   Q
                                                
                                             
                                             ,
                                             α
                                          
                                       
                                    
                                 
                              
                           
                        
                     , respectively, and f is not identically zero on any neighborhood of 
                        
                           α
                        
                     . So let 
                        
                           [
                           
                              
                                 a
                              
                              
                                 ℓ
                              
                           
                           ,
                           
                              
                                 b
                              
                              
                                 ℓ
                              
                           
                           ]
                        
                      be the maximal interval containing 
                        
                           
                              
                                 θ
                              
                              
                                 
                                    
                                       ℓ
                                    
                                    
                                       ∗
                                    
                                 
                              
                           
                        
                      such that 
                        
                           
                              
                                 g
                              
                              
                                 ℓ
                              
                           
                        
                      is strictly positive on 
                        
                           (
                           
                              
                                 a
                              
                              
                                 ℓ
                              
                           
                           ,
                           
                              
                                 b
                              
                              
                                 ℓ
                              
                           
                           )
                           ⧹
                           {
                           
                              
                                 θ
                              
                              
                                 
                                    
                                       ℓ
                                    
                                    
                                       ∗
                                    
                                 
                              
                           
                           }
                        
                     . Similarly, let 
                        
                           [
                           
                              
                                 a
                              
                              
                                 r
                              
                           
                           ,
                           
                              
                                 b
                              
                              
                                 r
                              
                           
                           ]
                        
                      be the maximal interval containing 
                        
                           
                              
                                 θ
                              
                              
                                 
                                    
                                       r
                                    
                                    
                                       ∗
                                    
                                 
                              
                           
                           -
                           
                              
                                 τ
                              
                              
                                 Q
                              
                           
                        
                      such that 
                        
                           
                              
                                 g
                              
                              
                                 r
                              
                           
                        
                      is strictly positive on 
                        
                           (
                           
                              
                                 a
                              
                              
                                 r
                              
                           
                           ,
                           
                              
                                 b
                              
                              
                                 r
                              
                           
                           )
                           ⧹
                           {
                           
                              
                                 θ
                              
                              
                                 
                                    
                                       r
                                    
                                    
                                       ∗
                                    
                                 
                              
                           
                           -
                           
                              
                                 τ
                              
                              
                                 Q
                              
                           
                           }
                        
                     . Finally, let 
                        
                           [
                           
                              
                                 a
                              
                              
                                 f
                              
                           
                           ,
                           
                              
                                 b
                              
                              
                                 f
                              
                           
                           ]
                        
                      be the maximal interval containing 
                        
                           
                              
                                 θ
                              
                              
                                 ℓ
                              
                           
                        
                      such that f is strictly positive on 
                        
                           (
                           
                              
                                 a
                              
                              
                                 ℓ
                              
                           
                           ,
                           
                              
                                 b
                              
                              
                                 ℓ
                              
                           
                           )
                           ⧹
                           {
                           
                              
                                 θ
                              
                              
                                 ℓ
                              
                           
                           }
                        
                     . Then the interval 
                        
                           [
                           a
                           ,
                           b
                           ]
                           
                           ≔
                           
                           [
                           
                              
                                 a
                              
                              
                                 ℓ
                              
                           
                           ,
                           
                              
                                 b
                              
                              
                                 ℓ
                              
                           
                           ]
                           ∩
                           [
                           
                              
                                 a
                              
                              
                                 r
                              
                           
                           ,
                           
                              
                                 b
                              
                              
                                 r
                              
                           
                           ]
                           ∩
                           [
                           
                              
                                 a
                              
                              
                                 f
                              
                           
                           ,
                           
                              
                                 b
                              
                              
                                 f
                              
                           
                           ]
                        
                      contains all points in time 
                        
                           α
                        
                      such that 
                        
                           P
                           
                              
                                 |
                              
                              
                                 Q
                              
                           
                           (
                           α
                           )
                        
                      remains an augmenting path. Further, 
                        
                           [
                           a
                           ,
                           b
                           ]
                        
                      contains 
                        
                           
                              
                                 θ
                              
                              
                                 ℓ
                              
                           
                        
                      as 
                        
                           P
                           =
                           P
                           
                              
                                 |
                              
                              
                                 Q
                              
                           
                           (
                           
                              
                                 θ
                              
                              
                                 ℓ
                              
                           
                           )
                        
                      is an augmenting path. Therefore, 
                        
                           [
                           a
                           ,
                           b
                           ]
                        
                      is the desired maximal interval.

So far, we have determined the maximal interval 
                        
                           [
                           a
                           ,
                           b
                           ]
                        
                      for which the path 
                        
                           P
                           
                              
                                 |
                              
                              
                                 Q
                              
                           
                           (
                           α
                           )
                        
                      is an augmenting path for all 
                        
                           α
                           ∈
                           [
                           a
                           ,
                           b
                           ]
                        
                     . We now define a cost function 
                        
                           
                              
                                 c
                              
                              
                                 Q
                              
                           
                           :
                           [
                           a
                           ,
                           b
                           ]
                           →
                           R
                        
                      with respect to Q as
                        
                           (6)
                           
                              
                                 
                                    c
                                 
                                 
                                    Q
                                 
                              
                              (
                              α
                              )
                              
                              ≔
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       ℓ
                                       ⩽
                                       k
                                       ⩽
                                       r
                                       -
                                       1
                                    
                                 
                              
                              
                                 
                                    c
                                 
                                 
                                    
                                       
                                          e
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    α
                                 
                                 
                                    k
                                 
                              
                              )
                              ,
                           
                        
                     where 
                        
                           
                              
                                 α
                              
                              
                                 ℓ
                              
                           
                           =
                           α
                        
                      and 
                        
                           
                              
                                 α
                              
                              
                                 k
                                 +
                                 1
                              
                           
                           (
                           α
                           )
                           =
                           
                              
                                 α
                              
                              
                                 k
                              
                           
                           +
                           
                              
                                 τ
                              
                              
                                 
                                    
                                       e
                                    
                                    
                                       k
                                    
                                 
                              
                           
                        
                      for 
                        
                           k
                           =
                           ℓ
                           ,
                           …
                           ,
                           r
                           -
                           1
                        
                      as before. It is straightforward that the cost function 
                        
                           
                              
                                 c
                              
                              
                                 Q
                              
                           
                        
                      has a local minimum on 
                        
                           [
                           a
                           ,
                           b
                           ]
                        
                      at the point 
                        
                           
                              
                                 θ
                              
                              
                                 ℓ
                              
                           
                        
                      if P is a local least cost augmenting path. Conversely, if for each arc-subpath Q of P the function 
                        
                           
                              
                                 c
                              
                              
                                 Q
                              
                           
                        
                      attains a local minimum at 
                        
                           
                              
                                 θ
                              
                              
                                 ℓ
                              
                           
                        
                      within the interval 
                        
                           [
                           a
                           ,
                           b
                           ]
                        
                     , then P is a local least cost augmenting path. Thus we have established the following lemma.
                        Lemma 1
                        
                           The path P is a local least cost augmenting path if and only if for each arc-subpath Q of P with starting time 
                           
                              
                                 
                                    
                                       θ
                                    
                                    
                                       ℓ
                                    
                                 
                              
                            
                           the cost function 
                           
                              
                                 
                                    
                                       c
                                    
                                    
                                       Q
                                    
                                 
                              
                           
                           , given by 
                           
                              (6)
                           
                           , has a local minimum at the point 
                           
                              
                                 
                                    
                                       θ
                                    
                                    
                                       ℓ
                                    
                                 
                              
                           
                           .
                        

In what follows, let 
                        
                           
                              
                                 P
                              
                              
                                 loc
                              
                           
                        
                      be the set of all augmenting paths P from NTP 
                        
                           (
                           s
                           ,
                           0
                           )
                        
                      to NTP 
                        
                           (
                           t
                           ,
                           T
                           )
                        
                      such that for each maximal arc-subpath Q of P with starting time 
                        
                           θ
                        
                      the function 
                        
                           
                              
                                 c
                              
                              
                                 Q
                              
                           
                        
                     , given by (6), has a local minimum at 
                        
                           
                              
                                 θ
                              
                              
                                 ℓ
                              
                           
                        
                      and is not constant on any open neighborhood containing 
                        
                           
                              
                                 θ
                              
                              
                                 ℓ
                              
                           
                        
                     . Further, we assume that two paths 
                        
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                        
                      and 
                        
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                        
                      are identified if they differ only in the starting time 
                        
                           
                              
                                 θ
                              
                              
                                 1
                              
                           
                        
                      and 
                        
                           
                              
                                 θ
                              
                              
                                 2
                              
                           
                        
                      (
                        
                           
                              
                                 θ
                              
                              
                                 1
                              
                           
                           <
                           
                              
                                 θ
                              
                              
                                 2
                              
                           
                        
                     ), respectively, of one common arc-subpaths Q and 
                        
                           
                              
                                 c
                              
                              
                                 Q
                              
                           
                        
                      is constant over 
                        
                           [
                           
                              
                                 θ
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 θ
                              
                              
                                 2
                              
                           
                           ]
                        
                     . Note that in this case 
                        
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                        
                      and 
                        
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                        
                      have the same cost, i.e., 
                        
                           c
                           (
                           
                              
                                 P
                              
                              
                                 1
                              
                           
                           )
                           =
                           c
                           (
                           
                              
                                 P
                              
                              
                                 2
                              
                           
                           )
                        
                     . Then, for each local least cost augmenting path, one augmenting path with the same cost is contained in 
                        
                           
                              
                                 P
                              
                              
                                 loc
                              
                           
                        
                     . Notice that 
                        
                           
                              
                                 P
                              
                              
                                 loc
                              
                           
                        
                      can contain also paths which are not local least cost augmenting. Nevertheless, the following lemma shows that the set of local least cost augmenting paths from NTP 
                        
                           (
                           s
                           ,
                           0
                           )
                        
                      to NTP 
                        
                           (
                           t
                           ,
                           T
                           )
                        
                      is finite.
                        Lemma 2
                        
                           The set 
                           
                              
                                 
                                    
                                       P
                                    
                                    
                                       loc
                                    
                                 
                              
                            
                           is finite.
                        

Due to Assumption 1, we can assume without loss of generality that the transit times are integral. Therefore, each arc 
                              
                                 (
                                 v
                                 ,
                                 w
                                 )
                                 ∈
                                 
                                    
                                       E
                                    
                                    
                                       r
                                    
                                 
                              
                            appears at most T times in any arc-subpath of an arbitrary path. In other words, every arc-subpath of any augmenting path contains at most 
                              
                                 T
                                 ·
                                 |
                                 E
                                 |
                              
                            arcs. Consequently, the number of possible maximal arc-subpaths is bounded by a constant where two arc-subpaths that differ by the starting time are identified.

We now assume by contradiction that the cardinality of 
                              
                                 
                                    
                                       P
                                    
                                    
                                       loc
                                    
                                 
                              
                            is infinite. Hence there exists an infinite number of paths in 
                              
                                 
                                    
                                       P
                                    
                                    
                                       loc
                                    
                                 
                              
                            all containing the same maximal arc-subpath Q, but with different starting times. It then follows from Lemma 1 that the cost function 
                              
                                 
                                    
                                       c
                                    
                                    
                                       Q
                                    
                                 
                              
                           , given by (6), has an infinite number of local minimum points. This is a contradiction because 
                              
                                 
                                    
                                       c
                                    
                                    
                                       Q
                                    
                                 
                              
                            is a piecewise analytic function and has only a finite number of local extrema. This establishes the lemma. □

Before we proceed with our discussion, let us make the following assumption.
                        Assumption 3
                        The cost functions 
                              
                                 
                                    
                                       c
                                    
                                    
                                       e
                                    
                                 
                                 ,
                                 
                                 e
                                 ∈
                                 E
                              
                            are continuous.

We suppose that this assumption holds throughout the rest of this and the next section. However, all our results hold for the case in which some cost functions have discontinuities by defining the cost of augmenting paths and cycles in a different, but complicated, way. We discuss further details in Appendix A.

We next show that 
                        
                           
                              
                                 P
                              
                              
                                 loc
                              
                           
                        
                      contains the least cost augmenting path from NTP 
                        
                           (
                           s
                           ,
                           0
                           )
                        
                      to NTP 
                        
                           (
                           t
                           ,
                           T
                           )
                        
                     .
                        Lemma 3
                        
                           Let P be an augmenting path from NTP 
                           
                              
                                 (
                                 s
                                 ,
                                 0
                                 )
                              
                            
                           to NTP 
                           
                              
                                 (
                                 t
                                 ,
                                 T
                                 )
                              
                           
                           . Then there exists an augmenting path 
                           
                              
                                 
                                    
                                       P
                                    
                                    
                                       ′
                                    
                                 
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       loc
                                    
                                 
                              
                            
                           with 
                           
                              
                                 c
                                 (
                                 
                                    
                                       P
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 ⩽
                                 c
                                 (
                                 P
                                 )
                              
                           
                           .
                        

If 
                              
                                 P
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       loc
                                    
                                 
                              
                           , then we are done. So we consider the case where P is not in 
                              
                                 
                                    
                                       P
                                    
                                    
                                       loc
                                    
                                 
                              
                           . In this case we iteratively apply the following procedure to construct an augmenting path 
                              
                                 
                                    
                                       P
                                    
                                    
                                       ′
                                    
                                 
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       loc
                                    
                                 
                              
                            with 
                              
                                 c
                                 (
                                 
                                    
                                       P
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 ⩽
                                 c
                                 (
                                 P
                                 )
                              
                           .
                              
                                 (i)
                                 Let 
                                       
                                          Q
                                          :
                                          (
                                          
                                             
                                                v
                                             
                                             
                                                k
                                             
                                          
                                          ,
                                          
                                             
                                                θ
                                             
                                             
                                                k
                                             
                                          
                                          )
                                          ,
                                          …
                                          ,
                                          (
                                          
                                             
                                                v
                                             
                                             
                                                r
                                             
                                          
                                          ,
                                          
                                             
                                                θ
                                             
                                             
                                                r
                                             
                                          
                                          )
                                       
                                     be a maximal arc-subpath of P such that the cost function 
                                       
                                          
                                             
                                                c
                                             
                                             
                                                Q
                                             
                                          
                                       
                                     does not have a local minimum at 
                                       
                                          
                                             
                                                θ
                                             
                                             
                                                k
                                             
                                          
                                       
                                     or is constant on an open interval containing 
                                       
                                          
                                             
                                                θ
                                             
                                             
                                                k
                                             
                                          
                                       
                                    . Notice that such an arc-subpath exists because of the definition of 
                                       
                                          
                                             
                                                P
                                             
                                             
                                                loc
                                             
                                          
                                       
                                     and the fact that P is not in 
                                       
                                          
                                             
                                                P
                                             
                                             
                                                loc
                                             
                                          
                                       
                                    . Further, choose 
                                       
                                          
                                             
                                                P
                                             
                                             
                                                ′
                                             
                                          
                                       
                                     such that it contains a minimal number of arcs.

Because of Assumption 3, the function 
                                       
                                          
                                             
                                                c
                                             
                                             
                                                Q
                                             
                                          
                                       
                                     is continuous. Thus it takes its minimum over 
                                       
                                          [
                                          a
                                          ,
                                          b
                                          ]
                                       
                                     at some point 
                                       
                                          θ
                                       
                                    . If it has several local minimum, then choose 
                                       
                                          θ
                                       
                                     to be the one with maximum value.

Let 
                                       
                                          P
                                          
                                             
                                                |
                                             
                                             
                                                Q
                                             
                                          
                                          (
                                          θ
                                          )
                                       
                                     be the augmenting path from NTP 
                                       
                                          (
                                          0
                                          ,
                                          1
                                          )
                                       
                                     to NTP 
                                       
                                          (
                                          t
                                          ,
                                          T
                                          )
                                       
                                     obtained from P by shifting the arc-subpath Q by 
                                       
                                          
                                             
                                                θ
                                             
                                             
                                                k
                                             
                                          
                                          -
                                          θ
                                       
                                     time units. Since 
                                       
                                          P
                                          
                                             
                                                |
                                             
                                             
                                                Q
                                             
                                          
                                          (
                                          θ
                                          )
                                       
                                     may contain augmenting cycles, we delete all of them in 
                                       
                                          P
                                          
                                             
                                                |
                                             
                                             
                                                Q
                                             
                                          
                                          (
                                          θ
                                          )
                                       
                                    .

Set 
                                       
                                          P
                                          
                                          ≔
                                          
                                          P
                                          
                                             
                                                |
                                             
                                             
                                                Q
                                             
                                          
                                          (
                                          θ
                                          )
                                       
                                    . If P is not in 
                                       
                                          
                                             
                                                P
                                             
                                             
                                                loc
                                             
                                          
                                       
                                    , then go to (i).

As a consequent of Lemmas 2 and 3, we obtain the following result:
                        Theorem 4
                        
                           There exists a least cost augmenting path from NTP 
                           
                              
                                 (
                                 s
                                 ,
                                 0
                                 )
                              
                            
                           to NTP 
                           
                              
                                 (
                                 t
                                 ,
                                 T
                                 )
                              
                           
                           . In particular, an augmenting path in 
                           
                              
                                 
                                    
                                       P
                                    
                                    
                                       loc
                                    
                                 
                              
                            
                           with minimum cost is the desired path.
                        

We can assume that the network G contains an augmenting path from NTP 
                        
                           (
                           s
                           ,
                           0
                           )
                        
                      to every other NTP. This assumption imposes no loss of generality since this is satisfied, if necessary, by introducing an artificial node a with infinite storage capacity and zero storage cost, and adding artificial arc 
                        
                           (
                           s
                           ,
                           a
                           )
                        
                      joining node s to node a and artificial arcs 
                        
                           (
                           a
                           ,
                           v
                           )
                           ,
                           
                           v
                           ∈
                           V
                           ⧹
                           {
                           s
                           }
                        
                     , linking node a to all nodes in 
                        
                           V
                           ⧹
                           {
                           s
                           }
                        
                     . Each artificial arc has a zero transit time, a large cost, and large capacity. It is clear that no artificial arc would appear in a least cost augmenting path from 
                        
                           (
                           s
                           ,
                           0
                           )
                        
                      to any NTP 
                        
                           (
                           v
                           ,
                           θ
                           )
                        
                      unless network G contains no augmenting path from 
                        
                           (
                           s
                           ,
                           0
                           )
                        
                      to 
                        
                           (
                           v
                           ,
                           θ
                           )
                        
                      without artificial arcs. Therefore, Lemma 2 as well as Lemma 3 remain true if NTP 
                        
                           (
                           t
                           ,
                           T
                           )
                        
                      is replaced by every other NTP 
                        
                           (
                           v
                           ,
                           θ
                           )
                        
                     . This leads to the main result of this section.
                        Theorem 5
                        
                           Suppose that x is a piecewise analytic solution for 
                           
                              (MCFP)
                           
                           . For each NTP 
                           
                              
                                 (
                                 v
                                 ,
                                 θ
                                 )
                              
                           
                           , let 
                           
                              
                                 
                                    
                                       d
                                    
                                    
                                       v
                                    
                                 
                                 (
                                 θ
                                 )
                              
                            
                           be the cost of a least cost augmenting path from 
                           
                              
                                 (
                                 s
                                 ,
                                 0
                                 )
                              
                            
                           to 
                           
                              
                                 (
                                 v
                                 ,
                                 θ
                                 )
                              
                           
                           . Then, for each node 
                           
                              
                                 v
                                 ∈
                                 V
                              
                           
                           , the label 
                           
                              
                                 
                                    
                                       d
                                    
                                    
                                       v
                                    
                                 
                                 (
                                 θ
                                 )
                              
                            
                           exists for all 
                           
                              
                                 θ
                                 ∈
                                 [
                                 0
                                 ,
                                 T
                                 ]
                              
                            
                           and the function 
                           
                              
                                 
                                    
                                       d
                                    
                                    
                                       v
                                    
                                 
                                 :
                                 [
                                 0
                                 ,
                                 T
                                 ]
                                 →
                                 R
                              
                            
                           is piecewise analytic.
                        

The existence of 
                              
                                 
                                    
                                       d
                                    
                                    
                                       v
                                    
                                 
                                 (
                                 θ
                                 )
                              
                            follows from Lemmas 2 and 3 for each NTP 
                              
                                 (
                                 v
                                 ,
                                 θ
                                 )
                              
                           . It thus remains to show that 
                              
                                 
                                    
                                       d
                                    
                                    
                                       v
                                    
                                 
                              
                            is piecewise analytic on 
                              
                                 [
                                 0
                                 ,
                                 T
                                 ]
                              
                            for each 
                              
                                 v
                                 ∈
                                 V
                              
                           . In the following we fix a node 
                              
                                 v
                                 ∈
                                 V
                              
                           . Similar to the definition of 
                              
                                 
                                    
                                       P
                                    
                                    
                                       loc
                                    
                                 
                              
                           , define 
                              
                                 
                                    
                                       P
                                    
                                    
                                       loc
                                    
                                 
                                 (
                                 θ
                                 )
                              
                            as the set of augmenting paths P from 
                              
                                 (
                                 s
                                 ,
                                 0
                                 )
                              
                            to 
                              
                                 (
                                 v
                                 ,
                                 θ
                                 )
                              
                            such that for each maximal arc-subpath Q of P with starting time 
                              
                                 
                                    
                                       θ
                                    
                                    
                                       ′
                                    
                                 
                              
                            the function 
                              
                                 
                                    
                                       c
                                    
                                    
                                       Q
                                    
                                 
                              
                            has a local minimum at 
                              
                                 
                                    
                                       θ
                                    
                                    
                                       ′
                                    
                                 
                              
                            and is not constant on any open neighborhood containing 
                              
                                 
                                    
                                       θ
                                    
                                    
                                       ′
                                    
                                 
                              
                           . Then 
                              
                                 
                                    
                                       P
                                    
                                    
                                       v
                                    
                                 
                                 
                                 ≔
                                 
                                 
                                    
                                       ∪
                                    
                                    
                                       θ
                                       ∈
                                       [
                                       0
                                       ,
                                       T
                                       ]
                                    
                                 
                                 
                                    
                                       P
                                    
                                    
                                       loc
                                    
                                 
                                 (
                                 θ
                                 )
                              
                            contains (nearly) all least cost augmenting paths for any point in time 
                              
                                 θ
                                 ∈
                                 [
                                 0
                                 ,
                                 T
                                 ]
                              
                           .

Next we define an equivalence relation 
                           
                              
                                 ∼
                              
                            on 
                              
                                 
                                    
                                       P
                                    
                                    
                                       v
                                    
                                 
                              
                           . let 
                              
                                 P
                                 :
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 ,
                                 …
                                 ,
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       q
                                    
                                 
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       q
                                    
                                 
                                 )
                              
                            and 
                              
                                 
                                    
                                       P
                                    
                                    
                                       ′
                                    
                                 
                                 :
                                 
                                    
                                       
                                          
                                             
                                                v
                                             
                                             
                                                1
                                             
                                             
                                                ′
                                             
                                          
                                          ,
                                          
                                             
                                                θ
                                             
                                             
                                                1
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       
                                          
                                             
                                                v
                                             
                                             
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                             
                                                ′
                                             
                                          
                                          ,
                                          
                                             
                                                θ
                                             
                                             
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                 
                              
                            be two members of 
                              
                                 
                                    
                                       P
                                    
                                    
                                       v
                                    
                                 
                              
                           . We define 
                              
                                 ∼
                              
                            on 
                              
                                 
                                    
                                       P
                                    
                                    
                                       v
                                    
                                 
                              
                            by 
                              
                                 P
                                 ∼
                                 
                                    
                                       P
                                    
                                    
                                       ′
                                    
                                 
                              
                            if and only if 
                              
                                 q
                                 =
                                 
                                    
                                       q
                                    
                                    
                                       ′
                                    
                                 
                              
                            and there is some 
                              
                                 r
                                 ∈
                                 {
                                 1
                                 ,
                                 …
                                 ,
                                 q
                                 -
                                 1
                                 }
                              
                            such that
                              
                                 (i)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         k
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         k
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         k
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         k
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                          
                                       
                                     for each 
                                       
                                          k
                                          ⩽
                                          r
                                          ,
                                          
                                             
                                                v
                                             
                                             
                                                r
                                             
                                          
                                          =
                                          
                                             
                                                v
                                             
                                             
                                                r
                                                +
                                                1
                                             
                                          
                                          =
                                          
                                             
                                                v
                                             
                                             
                                                r
                                             
                                             
                                                ′
                                             
                                          
                                          =
                                          
                                             
                                                v
                                             
                                             
                                                r
                                                +
                                                1
                                             
                                             
                                                ′
                                             
                                          
                                       
                                     and 
                                       
                                          
                                             
                                                θ
                                             
                                             
                                                r
                                                +
                                                1
                                             
                                          
                                          
                                          ≠
                                          
                                          
                                             
                                                θ
                                             
                                             
                                                k
                                                +
                                                1
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    ,


                                    
                                       
                                          
                                             
                                                v
                                             
                                             
                                                k
                                             
                                          
                                          =
                                          
                                             
                                                v
                                             
                                             
                                                k
                                             
                                             
                                                ′
                                             
                                          
                                       
                                     for each 
                                       
                                          k
                                          ⩾
                                          r
                                          +
                                          1
                                       
                                     and the NTP sequences 
                                       
                                          (
                                          
                                             
                                                v
                                             
                                             
                                                r
                                                +
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                θ
                                             
                                             
                                                r
                                                +
                                                1
                                             
                                          
                                          )
                                          ,
                                          …
                                          ,
                                          (
                                          
                                             
                                                v
                                             
                                             
                                                q
                                             
                                          
                                          ,
                                          
                                             
                                                θ
                                             
                                             
                                                q
                                             
                                          
                                          )
                                       
                                     and 
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         r
                                                         +
                                                         1
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         r
                                                         +
                                                         1
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         
                                                            
                                                               q
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         θ
                                                      
                                                      
                                                         
                                                            
                                                               q
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                             
                                          
                                       
                                     are arc-subpaths of P and 
                                       
                                          
                                             
                                                P
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    , respectively.

Roughly speaking, P and 
                              
                                 
                                    
                                       P
                                    
                                    
                                       ′
                                    
                                 
                              
                            are equivalent if they differ only in the starting time of the last maximal arc-subpath. For an equivalence class 
                              
                                 [
                                 P
                                 ]
                              
                            we denote by 
                              
                                 
                                    
                                       P
                                    
                                    
                                       1
                                    
                                 
                              
                            the path consisting of the first r NTPs of P and by 
                              
                                 
                                    
                                       P
                                    
                                    
                                       2
                                    
                                 
                              
                            the arc-path consisting of the last 
                              
                                 q
                                 -
                                 r
                                 +
                                 1
                              
                            NTPs of P. Note that 
                              
                                 
                                    
                                       P
                                    
                                    
                                       1
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       P
                                    
                                    
                                       2
                                    
                                 
                              
                            can be the empty path: if P is an arc-path we put it in the equivalence class for which 
                              
                                 
                                    
                                       P
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 ∅
                              
                            and 
                              
                                 
                                    
                                       P
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 P
                              
                            and if the the last tow NTPs in P are node-linked, we put it in the equivalence class for which 
                              
                                 
                                    
                                       P
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 P
                              
                            and 
                              
                                 
                                    
                                       P
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 ∅
                              
                           . Therefore, each equivalence class 
                              
                                 [
                                 P
                                 ]
                              
                            is identified by two paths 
                              
                                 
                                    
                                       P
                                    
                                    
                                       1
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       P
                                    
                                    
                                       2
                                    
                                 
                              
                            and these paths are well-defined in the sense that they coincide for any member of 
                              
                                 [
                                 P
                                 ]
                              
                           . Moreover, any augmenting path in 
                              
                                 [
                                 P
                                 ]
                              
                            is obtained by concatenating 
                              
                                 
                                    
                                       P
                                    
                                    
                                       1
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       P
                                    
                                    
                                       2
                                    
                                 
                              
                            and changing the starting time of 
                              
                                 
                                    
                                       P
                                    
                                    
                                       2
                                    
                                 
                              
                           . More precisely, 
                              
                                 [
                                 P
                                 ]
                              
                            contains only the paths 
                              
                                 P
                                 
                                    
                                       |
                                    
                                    
                                       
                                          
                                             P
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 (
                                 θ
                                 -
                                 
                                    
                                       τ
                                    
                                    
                                       
                                          
                                             P
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 )
                                 ,
                                 θ
                                 ∈
                                 [
                                 0
                                 ,
                                 T
                                 ]
                              
                           , for which 
                              
                                 P
                                 
                                    
                                       |
                                    
                                    
                                       
                                          
                                             P
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 (
                                 θ
                                 -
                                 
                                    
                                       τ
                                    
                                    
                                       
                                          
                                             P
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 )
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       v
                                    
                                 
                              
                           .

We next show that the quotient set 
                              
                                 
                                    
                                       P
                                    
                                    
                                       v
                                    
                                 
                                 /
                                 ∼
                              
                            contains a finite number of equivalence classes. Each equivalence class in 
                              
                                 
                                    
                                       P
                                    
                                    
                                       v
                                    
                                 
                                 /
                                 ∼
                              
                            is defined by two paths 
                              
                                 
                                    
                                       P
                                    
                                    
                                       1
                                    
                                 
                              
                            and 
                              
                                 P
                                 2
                              
                            with the following properties:
                              
                                 (1)
                                 The first NTP in 
                                       
                                          
                                             
                                                P
                                             
                                             
                                                1
                                             
                                          
                                       
                                     is 
                                       
                                          (
                                          0
                                          ,
                                          1
                                          )
                                       
                                    , the last NTP in 
                                       
                                          
                                             
                                                P
                                             
                                             
                                                2
                                             
                                          
                                       
                                     is 
                                       
                                          (
                                          v
                                          ,
                                          θ
                                          )
                                       
                                     for some 
                                       
                                          θ
                                          ∈
                                          [
                                          0
                                          ,
                                          T
                                          ]
                                       
                                    , the last two NTPS in 
                                       
                                          P
                                          -
                                          1
                                       
                                     are node-linked, and 
                                       
                                          
                                             
                                                P
                                             
                                             
                                                2
                                             
                                          
                                       
                                     is an arc-path. Moreover, the last NTP in 
                                       
                                          
                                             
                                                P
                                             
                                             
                                                1
                                             
                                          
                                       
                                     and the first NTP in 
                                       
                                          
                                             
                                                P
                                             
                                             
                                                2
                                             
                                          
                                       
                                     coincide.

For each maximal arc-subpath Q of 
                                       
                                          
                                             
                                                P
                                             
                                             
                                                1
                                             
                                          
                                       
                                     with starting time 
                                       
                                          
                                             
                                                θ
                                             
                                             
                                                ′
                                             
                                          
                                       
                                     the function 
                                       
                                          
                                             
                                                c
                                             
                                             
                                                Q
                                             
                                          
                                       
                                     has a local minimum at 
                                       
                                          
                                             
                                                θ
                                             
                                             
                                                ′
                                             
                                          
                                       
                                     and is not constant on any open neighborhood containing 
                                       
                                          θ
                                       
                                    .

The function 
                                       
                                          
                                             
                                                c
                                             
                                             
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                     has a local minimum at 
                                       
                                          
                                             
                                                θ
                                             
                                             
                                                ′
                                             
                                          
                                       
                                     and is not constant on any open neighborhood containing 
                                       
                                          
                                             
                                                θ
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    , where 
                                       
                                          
                                             
                                                θ
                                             
                                             
                                                ′
                                             
                                          
                                       
                                     is starting time of 
                                       
                                          
                                             
                                                P
                                             
                                             
                                                1
                                             
                                          
                                       
                                    .

We now consider an equivalence class 
                              
                                 [
                                 P
                                 ]
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       v
                                    
                                 
                                 /
                                 ∼
                              
                           , given by two paths 
                              
                                 
                                    
                                       P
                                    
                                    
                                       1
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       P
                                    
                                    
                                       2
                                    
                                 
                              
                           . We define a cost function 
                              
                                 
                                    
                                       c
                                    
                                    
                                       [
                                       P
                                       ]
                                    
                                 
                                 :
                                 [
                                 0
                                 ,
                                 T
                                 ]
                                 →
                                 R
                              
                            by
                              
                                 
                                    
                                       
                                          c
                                       
                                       
                                          [
                                          P
                                          ]
                                       
                                    
                                    (
                                    θ
                                    )
                                    
                                    ≔
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      c
                                                      (
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                      +
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            
                                                               
                                                                  P
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      θ
                                                      -
                                                      
                                                         
                                                            τ
                                                         
                                                         
                                                            
                                                               
                                                                  P
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      if
                                                      
                                                      P
                                                      
                                                         
                                                            |
                                                         
                                                         
                                                            
                                                               
                                                                  P
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      θ
                                                      -
                                                      
                                                         
                                                            τ
                                                         
                                                         
                                                            
                                                               
                                                                  P
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                      )
                                                      ∈
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            v
                                                         
                                                      
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      ∞
                                                   
                                                   
                                                      otherwise.
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           In other words, 
                              
                                 
                                    
                                       c
                                    
                                    
                                       [
                                       P
                                       ]
                                    
                                 
                                 (
                                 θ
                                 )
                                 
                                 ≔
                                 
                                 c
                                 (
                                 
                                    
                                       P
                                    
                                    
                                       ′
                                    
                                 
                                 )
                              
                            if there exists a path 
                              
                                 
                                    
                                       P
                                    
                                    
                                       ′
                                    
                                 
                              
                            in 
                              
                                 [
                                 P
                                 ]
                              
                           , whose last NTP is 
                              
                                 (
                                 v
                                 ,
                                 θ
                                 )
                              
                           ; and 
                              
                                 
                                    
                                       c
                                    
                                    
                                       [
                                       P
                                       ]
                                    
                                 
                                 (
                                 θ
                                 )
                                 =
                                 ∞
                              
                            if such a path does not exist in 
                              
                                 [
                                 P
                                 ]
                              
                           . Since 
                              
                                 
                                    
                                       P
                                    
                                    
                                       2
                                    
                                 
                              
                            is an arc-path, 
                              
                                 
                                    
                                       c
                                    
                                    
                                       
                                          
                                             P
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 (
                                 θ
                                 -
                                 
                                    
                                       τ
                                    
                                    
                                       
                                          
                                             P
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 )
                              
                            is piecewise analytic, so is the cost function 
                              
                                 
                                    
                                       c
                                    
                                    
                                       [
                                       P
                                       ]
                                    
                                 
                              
                           .

Following the above discussion, we can express the cost of each path 
                              
                                 P
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       v
                                    
                                 
                              
                            in terms of the cost function 
                              
                                 
                                    
                                       c
                                    
                                    
                                       [
                                       P
                                       ]
                                    
                                 
                              
                            as 
                              
                                 c
                                 (
                                 P
                                 )
                                 =
                                 
                                    
                                       c
                                    
                                    
                                       [
                                       P
                                       ]
                                    
                                 
                                 (
                                 θ
                                 )
                              
                           , where 
                              
                                 θ
                              
                            is the last time that we reach node v along P, i.e., 
                              
                                 (
                                 v
                                 ,
                                 θ
                                 )
                              
                            is the last NTP of P. It implies that
                              
                                 
                                    
                                       
                                          d
                                       
                                       
                                          v
                                       
                                    
                                    (
                                    θ
                                    )
                                    =
                                    
                                       
                                          
                                             min
                                          
                                          
                                             P
                                             ∈
                                             
                                                
                                                   P
                                                
                                                
                                                   v
                                                
                                             
                                             /
                                             ∼
                                          
                                       
                                    
                                    {
                                    
                                       
                                          c
                                       
                                       
                                          [
                                          P
                                          ]
                                       
                                    
                                    (
                                    θ
                                    )
                                    }
                                    
                                    ∀
                                    θ
                                    ∈
                                    [
                                    0
                                    ,
                                    T
                                    ]
                                    .
                                 
                              
                           Therefore 
                              
                                 
                                    
                                       d
                                    
                                    
                                       v
                                    
                                 
                              
                            is piecewise analytic since it is the minimum of a finite number of piecewise analytic functions. □

In this section, we turn our attention to the optimality conditions for MCFP. In particular, we first show that not only conditions (CS1)–(CS4) are sufficient for optimality, but also are necessary under Assumptions 1 and 2. We then extend the negative cycle optimality condition for MCFP and derive a strong duality result between (MCFP) and (MCFP∗). We start with the following lemma which will be used in the proof of the subsequent theorems.
                        Lemma 4
                        
                           Let x be a piecewise analytic flow. Then x is not optimal if there exists a negative augmenting cycle with respect to x.
                        

Suppose that 
                              
                                 W
                                 :
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 ,
                                 …
                                 ,
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       q
                                    
                                 
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       q
                                    
                                 
                                 )
                              
                            is a negative augmenting cycle under x. We show that there exists a cycle 
                              
                                 
                                    
                                       W
                                    
                                    
                                       ′
                                    
                                 
                              
                            with 
                              
                                 cap
                                 (
                                 
                                    
                                       W
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 >
                                 0
                              
                            and 
                              
                                 c
                                 (
                                 
                                    
                                       W
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 <
                                 0
                              
                           . To prove this, let 
                              
                                 Q
                                 :
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       ℓ
                                    
                                 
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       ℓ
                                    
                                 
                                 )
                                 ,
                                 …
                                 ,
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       r
                                    
                                 
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       r
                                    
                                 
                                 )
                              
                            be a maximal arc-subpath of W. Then we know that there is some 
                              
                                 ∊
                                 >
                                 0
                              
                            such that 
                              
                                 W
                                 
                                    
                                       |
                                    
                                    
                                       Q
                                    
                                 
                                 (
                                 α
                                 )
                              
                            is also an augmenting cycle for each 
                              
                                 α
                              
                            in 
                              
                                 (
                                 
                                    
                                       θ
                                    
                                    
                                       ℓ
                                    
                                 
                                 -
                                 ∊
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       ℓ
                                    
                                 
                                 )
                              
                            or 
                              
                                 (
                                 
                                    
                                       θ
                                    
                                    
                                       ℓ
                                    
                                 
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       ℓ
                                    
                                 
                                 +
                                 ∊
                                 )
                              
                           . We assume without loss of generality that 
                              
                                 W
                                 
                                    
                                       |
                                    
                                    
                                       Q
                                    
                                 
                                 (
                                 α
                                 )
                              
                            is an augmenting cycle for each 
                              
                                 α
                              
                            in 
                              
                                 (
                                 
                                    
                                       θ
                                    
                                    
                                       ℓ
                                    
                                 
                                 -
                                 ∊
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       ℓ
                                    
                                 
                                 )
                              
                           . Then for some 
                              
                                 α
                                 ∈
                                 (
                                 
                                    
                                       θ
                                    
                                    
                                       ℓ
                                    
                                 
                                 -
                                 ∊
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       ℓ
                                    
                                 
                                 )
                              
                           , we have 
                              
                                 |
                                 c
                                 (
                                 Q
                                 (
                                 α
                                 )
                                 )
                                 -
                                 c
                                 (
                                 Q
                                 )
                                 |
                                 <
                                 ∊
                              
                           . Here 
                              
                                 Q
                                 (
                                 α
                                 )
                              
                            denotes the arc path 
                              
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       ℓ
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       ℓ
                                       +
                                       1
                                    
                                 
                                 )
                                 ,
                                 …
                                 ,
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       r
                                       -
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       r
                                    
                                 
                                 )
                              
                            with starting time 
                              
                                 α
                              
                           . More precisely, we have 
                              
                                 Q
                                 (
                                 α
                                 )
                                 :
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       ℓ
                                    
                                 
                                 ,
                                 
                                    
                                       α
                                    
                                    
                                       ℓ
                                    
                                 
                                 )
                                 ,
                                 …
                                 ,
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       r
                                    
                                 
                                 ,
                                 
                                    
                                       α
                                    
                                    
                                       r
                                    
                                 
                                 )
                              
                            where 
                              
                                 
                                    
                                       α
                                    
                                    
                                       ℓ
                                    
                                 
                                 =
                                 α
                              
                            and 
                              
                                 
                                    
                                       α
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 (
                                 α
                                 )
                                 =
                                 
                                    
                                       α
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 
                                    
                                       τ
                                    
                                    
                                       
                                          
                                             v
                                          
                                          
                                             k
                                          
                                       
                                       ,
                                       
                                          
                                             v
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                       
                                    
                                 
                              
                            for 
                              
                                 k
                                 =
                                 ℓ
                                 ,
                                 …
                                 ,
                                 r
                                 -
                                 1
                              
                           . Further, 
                              
                                 α
                              
                            can be chosen in such a way that 
                              
                                 cap
                                 (
                                 Q
                                 (
                                 α
                                 )
                                 )
                                 >
                                 0
                              
                           . Now we consider the cycle 
                              
                                 W
                                 
                                    
                                       |
                                    
                                    
                                       Q
                                    
                                 
                                 (
                                 α
                                 )
                              
                            and repeat the above procedure for all remaining maximal arc-subpaths of W. Let 
                              
                                 
                                    
                                       W
                                    
                                    
                                       ′
                                    
                                 
                              
                            be the resulting cycle. It is easy to see that for sufficiently small 
                              
                                 ∊
                                 >
                                 0
                              
                           , we get 
                              
                                 cap
                                 (
                                 
                                    
                                       W
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 >
                                 0
                              
                            and 
                              
                                 c
                                 (
                                 
                                    
                                       W
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 <
                                 0
                              
                           .

Based on the above observation, we assume that 
                              
                                 cap
                                 (
                                 W
                                 )
                                 >
                                 0
                              
                            and 
                              
                                 c
                                 (
                                 W
                                 )
                                 <
                                 0
                              
                           . For every 
                              
                                 k
                                 =
                                 2
                                 ,
                                 …
                                 ,
                                 q
                              
                            with 
                              
                                 
                                    
                                       e
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       k
                                       -
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 ∈
                                 
                                    
                                       E
                                    
                                    
                                       r
                                    
                                 
                              
                           , there exist 
                              
                                 
                                    
                                       δ
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                    
                                       γ
                                    
                                    
                                       k
                                    
                                 
                                 >
                                 0
                              
                            such that
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                e
                                             
                                             
                                                k
                                             
                                          
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    θ
                                    )
                                    ⩾
                                    
                                       
                                          δ
                                       
                                       
                                          k
                                       
                                    
                                    
                                    ∀
                                    θ
                                    ∈
                                    [
                                    
                                       
                                          θ
                                       
                                       
                                          k
                                          -
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          θ
                                       
                                       
                                          k
                                          -
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          γ
                                       
                                       
                                          k
                                       
                                    
                                    )
                                    .
                                 
                              
                           
                        

Let 
                              
                                 δ
                              
                            and 
                              
                                 γ
                              
                            be the minimum of 
                              
                                 
                                    
                                       δ
                                    
                                    
                                       k
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       γ
                                    
                                    
                                       k
                                    
                                 
                              
                           , respectively, and define 
                              
                                 
                                    
                                       ∊
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 2
                                 δ
                                 γ
                              
                           . Moreover, for every 
                              
                                 k
                                 =
                                 2
                                 ,
                                 …
                                 ,
                                 q
                              
                            with 
                              
                                 
                                    
                                       v
                                    
                                    
                                       k
                                       -
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       v
                                    
                                    
                                       k
                                    
                                 
                              
                           , there exist 
                              
                                 
                                    
                                       δ
                                    
                                    
                                       k
                                    
                                 
                                 ,
                                 
                                    
                                       γ
                                    
                                    
                                       k
                                    
                                 
                                 >
                                 0
                              
                            such that
                              
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      U
                                                   
                                                   
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                   
                                                      r
                                                   
                                                
                                                (
                                                θ
                                                )
                                                ⩾
                                                
                                                   
                                                      δ
                                                   
                                                   
                                                      k
                                                   
                                                
                                                
                                                ∀
                                                θ
                                                ∈
                                                (
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      k
                                                      -
                                                      1
                                                   
                                                
                                                -
                                                
                                                   
                                                      γ
                                                   
                                                   
                                                      k
                                                   
                                                
                                                ,
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      k
                                                   
                                                
                                                +
                                                
                                                   
                                                      γ
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                                
                                                if
                                                
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      k
                                                      -
                                                      1
                                                   
                                                
                                                <
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      k
                                                   
                                                
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                   
                                                      r
                                                   
                                                
                                                (
                                                θ
                                                )
                                                ⩾
                                                
                                                   
                                                      δ
                                                   
                                                   
                                                      k
                                                   
                                                
                                                
                                                ∀
                                                θ
                                                ∈
                                                (
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      k
                                                   
                                                
                                                -
                                                
                                                   
                                                      γ
                                                   
                                                   
                                                      k
                                                   
                                                
                                                ,
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      k
                                                      -
                                                      1
                                                   
                                                
                                                +
                                                
                                                   
                                                      γ
                                                   
                                                   
                                                      k
                                                   
                                                
                                                )
                                                
                                                if
                                                
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      k
                                                      -
                                                      1
                                                   
                                                
                                                >
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      k
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           Let 
                              
                                 δ
                              
                            and 
                              
                                 γ
                              
                            be the minimum of 
                              
                                 
                                    
                                       δ
                                    
                                    
                                       k
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       γ
                                    
                                    
                                       k
                                    
                                 
                              
                           , respectively. We then define
                              
                                 
                                    
                                       
                                          ∊
                                       
                                       
                                          k
                                       
                                    
                                    
                                    ≔
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      2
                                                      δ
                                                      γ
                                                      ,
                                                   
                                                   
                                                      if
                                                      
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            k
                                                            -
                                                            1
                                                         
                                                      
                                                      
                                                      ≠
                                                      
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      δ
                                                      ,
                                                   
                                                   
                                                      if
                                                      
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            k
                                                            -
                                                            1
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      ,
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           for 
                              
                                 k
                                 =
                                 2
                                 ,
                                 …
                              
                           , and let
                              
                                 (7)
                                 
                                    
                                       
                                          z
                                       
                                       
                                          ∗
                                       
                                    
                                    
                                    ≔
                                    
                                    
                                       
                                          1
                                       
                                       
                                          2
                                          γ
                                       
                                    
                                    
                                       min
                                    
                                    {
                                    
                                       
                                          ∊
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          ∊
                                       
                                       
                                          3
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          ∊
                                       
                                       
                                          q
                                       
                                    
                                    }
                                    .
                                 
                              
                           We now define
                              
                                 
                                    
                                       
                                          z
                                       
                                       
                                          e
                                       
                                    
                                    (
                                    θ
                                    )
                                    
                                    ≔
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                   
                                                   
                                                      if
                                                      
                                                      e
                                                      =
                                                      (
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            k
                                                            +
                                                            1
                                                         
                                                      
                                                      )
                                                      ∈
                                                      E
                                                      ,
                                                      θ
                                                      ∈
                                                      [
                                                      
                                                         
                                                            θ
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            θ
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      +
                                                      γ
                                                      )
                                                      
                                                      for
                                                      
                                                      k
                                                      =
                                                      1
                                                      ,
                                                      …
                                                      ,
                                                      q
                                                      -
                                                      1
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      -
                                                      
                                                         
                                                            z
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                   
                                                   
                                                      if
                                                      
                                                      e
                                                      =
                                                      (
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            k
                                                            +
                                                            1
                                                         
                                                      
                                                      ,
                                                      i
                                                      =
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      )
                                                      ∈
                                                      E
                                                      ,
                                                      θ
                                                      ∈
                                                      [
                                                      
                                                         
                                                            θ
                                                         
                                                         
                                                            k
                                                            +
                                                            1
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            θ
                                                         
                                                         
                                                            k
                                                            +
                                                            1
                                                         
                                                      
                                                      +
                                                      γ
                                                      )
                                                      ,
                                                      
                                                      for
                                                      
                                                      k
                                                      =
                                                      1
                                                      ,
                                                      …
                                                      ,
                                                      q
                                                      -
                                                      1
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      otherwise.
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           We can easily see that 
                              
                                 x
                                 +
                                 z
                              
                            is a feasible flow.

Thus far we have seen that another feasible flow 
                              
                                 
                                    
                                       x
                                    
                                    
                                       ¯
                                    
                                 
                                 =
                                 x
                                 +
                                 z
                              
                            can be obtained by augmenting a constant flow rate 
                              
                                 
                                    
                                       z
                                    
                                    
                                       ∗
                                    
                                 
                              
                           , given by (7), along the arcs involved in the cycle W. The cost of augmenting, that is, the change in the objective function value in moving from x to 
                              
                                 
                                    
                                       x
                                    
                                    
                                       ¯
                                    
                                 
                              
                           , is computed by 
                              
                                 
                                    
                                       z
                                    
                                    
                                       ∗
                                    
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       2
                                    
                                    
                                       q
                                    
                                 
                                 
                                    
                                       ζ
                                    
                                    
                                       k
                                    
                                 
                              
                           , where
                              
                                 
                                    
                                       
                                          ζ
                                       
                                       
                                          k
                                       
                                    
                                    
                                    ≔
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∫
                                                         
                                                            
                                                               
                                                                  θ
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  θ
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                            +
                                                            γ
                                                         
                                                      
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            
                                                               
                                                                  e
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      θ
                                                      )
                                                      
                                                      dt
                                                   
                                                   
                                                      if
                                                      
                                                      
                                                         
                                                            e
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      =
                                                      (
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            k
                                                            +
                                                            1
                                                         
                                                      
                                                      )
                                                      ∈
                                                      E
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∫
                                                         
                                                            
                                                               
                                                                  t
                                                               
                                                               
                                                                  k
                                                                  +
                                                                  1
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  t
                                                               
                                                               
                                                                  k
                                                                  +
                                                                  1
                                                               
                                                            
                                                            +
                                                            γ
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            c
                                                         
                                                         
                                                            
                                                               
                                                                  e
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      θ
                                                      )
                                                      
                                                      dt
                                                   
                                                   
                                                      if
                                                      
                                                      
                                                         
                                                            e
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      =
                                                      (
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            k
                                                            +
                                                            1
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            v
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      )
                                                      ∈
                                                      E
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      otherwise.
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           for 
                              
                                 k
                                 =
                                 2
                                 ,
                                 …
                                 ,
                                 q
                              
                           . Since 
                              
                                 
                                    
                                       z
                                    
                                    
                                       ∗
                                    
                                 
                                 >
                                 0
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       ¯
                                    
                                 
                              
                            will be a strictly improved feasible solution than 
                              
                                 x
                                 (
                                 θ
                                 )
                              
                            if 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       2
                                    
                                    
                                       q
                                    
                                 
                                 
                                    
                                       ζ
                                    
                                    
                                       k
                                    
                                 
                                 <
                                 0
                              
                           . We know that the cost functions c are piecewise analytic and right-continuous. This implies 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       2
                                    
                                    
                                       q
                                    
                                 
                                 
                                    
                                       ζ
                                    
                                    
                                       k
                                    
                                 
                                 <
                                 0
                              
                            for 
                              
                                 γ
                              
                            small enough since 
                              
                                 c
                                 (
                                 W
                                 )
                                 <
                                 0
                              
                           . This establishes the lemma. □

We are now in a position to prove the main results of this paper.
                        Theorem 6
                        
                           Let x be a piecewise analytic flow. Then x is optimal for 
                           
                              (MCFP)
                            
                           if and only if there is a piecewise analytic function 
                           
                              
                                 π
                              
                            
                           which is complementary slack with x.
                        

The necessary part of the theorem follows immediately from Theorem 2. For the sufficiency, suppose that x with corresponding storage Y is optimal. It follows from Lemma 4 that there are no negative augmenting cycles with respect to x. For each node 
                              
                                 v
                                 ∈
                                 V
                              
                           , we consider the function 
                              
                                 
                                    
                                       d
                                    
                                    
                                       v
                                    
                                 
                                 :
                                 [
                                 0
                                 ,
                                 T
                                 ]
                                 →
                                 R
                              
                           , where 
                              
                                 
                                    
                                       d
                                    
                                    
                                       v
                                    
                                 
                                 (
                                 θ
                                 )
                              
                            is the cost of a least cost augmenting path from 
                              
                                 (
                                 s
                                 ,
                                 0
                                 )
                              
                            to 
                              
                                 (
                                 v
                                 ,
                                 θ
                                 )
                              
                           . By Theorem 5, the function 
                              
                                 
                                    
                                       d
                                    
                                    
                                       v
                                    
                                 
                              
                            is well deffined and is piecewise analytic. We now define 
                              
                                 
                                    
                                       π
                                    
                                    
                                       v
                                    
                                 
                                 
                                 ≔
                                 
                                 -
                                 
                                    
                                       d
                                    
                                    
                                       v
                                    
                                 
                                 ,
                                 v
                                 ∈
                                 V
                              
                            and show that the following conditions are met for each arc 
                              
                                 e
                                 =
                                 (
                                 v
                                 ,
                                 w
                                 )
                              
                            and each node 
                              
                                 v
                                 ∈
                                 V
                              
                            over the time interval 
                              
                                 [
                                 0
                                 ,
                                 T
                                 ]
                              
                           :
                              
                                 (RC1) if 
                                       
                                          
                                             
                                                x
                                             
                                             
                                                e
                                             
                                          
                                          (
                                          θ
                                          )
                                          >
                                          0
                                       
                                    , then 
                                       
                                          
                                             
                                                c
                                             
                                             
                                                e
                                             
                                          
                                          (
                                          θ
                                          )
                                          -
                                          
                                             
                                                π
                                             
                                             
                                                v
                                             
                                          
                                          (
                                          θ
                                          )
                                          +
                                          
                                             
                                                π
                                             
                                             
                                                w
                                             
                                          
                                          (
                                          θ
                                          +
                                          
                                             
                                                τ
                                             
                                             
                                                e
                                             
                                          
                                          )
                                          ⩽
                                          0
                                       
                                    ;

(RC2) if 
                                       
                                          
                                             
                                                x
                                             
                                             
                                                e
                                             
                                          
                                          (
                                          θ
                                          )
                                          <
                                          
                                             
                                                u
                                             
                                             
                                                e
                                             
                                          
                                          (
                                          θ
                                          )
                                       
                                    , then 
                                       
                                          
                                             
                                                c
                                             
                                             
                                                e
                                             
                                          
                                          (
                                          θ
                                          )
                                          -
                                          
                                             
                                                π
                                             
                                             
                                                v
                                             
                                          
                                          (
                                          θ
                                          )
                                          +
                                          
                                             
                                                π
                                             
                                             
                                                w
                                             
                                          
                                          (
                                          θ
                                          +
                                          
                                             
                                                τ
                                             
                                             
                                                e
                                             
                                          
                                          )
                                          ⩾
                                          0
                                       
                                    ;

(RC3) if 
                                       
                                          
                                             
                                                Y
                                             
                                             
                                                v
                                             
                                          
                                          (
                                          θ
                                          )
                                          >
                                          0
                                       
                                     on 
                                       
                                          (
                                          a
                                          ,
                                          b
                                          )
                                       
                                    , then 
                                       
                                          
                                             
                                                π
                                             
                                             
                                                v
                                             
                                          
                                       
                                     is monotonic decreasing on 
                                       
                                          (
                                          a
                                          ,
                                          b
                                          )
                                       
                                    ;

(RC4) if 
                                       
                                          
                                             
                                                Y
                                             
                                             
                                                v
                                             
                                          
                                          (
                                          θ
                                          )
                                          <
                                          
                                             
                                                U
                                             
                                             
                                                v
                                             
                                          
                                          (
                                          θ
                                          )
                                       
                                     on 
                                       
                                          (
                                          a
                                          ,
                                          b
                                          )
                                       
                                    , then 
                                       
                                          
                                             
                                                π
                                             
                                             
                                                v
                                             
                                          
                                       
                                     is monotonic increasing on 
                                       
                                          (
                                          a
                                          ,
                                          b
                                          )
                                       
                                    .

Obviously, conditions (RC1) and (RC2) are equivalent to conditions (CS1) and (CS2), respectively. We next show that the condition (RC3) implies the condition (CS3). To end this, assume that for some node v, the function 
                              
                                 
                                    
                                       π
                                    
                                    
                                       v
                                    
                                 
                              
                            is strictly increasing at some point 
                              
                                 θ
                              
                           . Since 
                              
                                 
                                    
                                       π
                                    
                                    
                                       v
                                    
                                 
                              
                            is piecewise analytic and consequently of bounded variation, there are two monotonic increasing and piecewise analytic functions 
                              
                                 μ
                              
                            and 
                              
                                 η
                              
                            for which 
                              
                                 
                                    
                                       π
                                    
                                    
                                       v
                                    
                                 
                                 =
                                 μ
                                 -
                                 η
                              
                           . Moreover, since 
                              
                                 
                                    
                                       π
                                    
                                    
                                       v
                                    
                                 
                              
                            is strictly increasing at 
                              
                                 θ
                              
                           , there is an open interval 
                              
                                 (
                                 a
                                 ,
                                 b
                                 )
                              
                            containing 
                              
                                 θ
                              
                            such that 
                              
                                 μ
                              
                            is strictly increasing at each point in 
                              
                                 (
                                 a
                                 ,
                                 b
                                 )
                              
                            and 
                              
                                 η
                              
                            is constant over 
                              
                                 (
                                 a
                                 ,
                                 b
                                 )
                              
                           . It now follows from condition (RC3) that 
                              
                                 
                                    
                                       Y
                                    
                                    
                                       v
                                    
                                 
                              
                            is identically zero on 
                              
                                 (
                                 a
                                 ,
                                 b
                                 )
                              
                           . This proves that the condition (RC3) must hold. In a similar way, we can show that the condition (RC4) implies the condition (CS4). Therefore, the pair x and 
                              
                                 π
                              
                            satisfies the conditions (CS1)–(CS4), establishing the theorem. □

The previous theorem shows that the conditions (RC1)–(RC4) are sufficient and necessary for optimality of a given flow x.
                        Theorem 7
                        Negative Cycle Optimality Condition


                        
                           Suppose that x is a piecewise analytic flow. Then x is optimal for 
                           
                              (MCFP)
                            
                           if and only if there is no negative augmenting cycle under x.
                        

Having proved Lemma 4, it is sufficient to prove that x is optimal if there is no negative augmenting cycle under x. Hence, assume that there is no negative cycle with respect to x. By a similar argument as in the proof of Theorem 6, we can deduce that there is a piecewise analytic functions 
                              
                                 π
                              
                            which is complementary slack with x. It now follows from Theorem 2 that x is optimal for (MCFP). □


                           There exist piecewise analytic optimal solutions x and 
                           
                              
                                 π
                              
                            
                           for 
                           
                              (MCFP) and (MCFP∗
                              )
                           
                           , respectively, so that 
                           
                              
                                 V
                                 [
                                 MCFP,
                                 x
                                 ]
                                 =
                                 V
                                 [
                                 
                                    
                                       MCFP
                                    
                                    
                                       ∗
                                    
                                 
                                 ,
                                 π
                                 ]
                              
                           
                           .
                        

We know from Theorem 3 that (MCFP) has a piecewise analytic optimal solution x. Then, it follows from Theorem 6 that there exists a piecewise analytic function 
                              
                                 π
                              
                           , which is complementary slack with x. The assertion now follows from Theorem 2. □

@&#CONCLUSIONS@&#

In this paper, we have studied the minimum cost flow problem in a time-varying network to capture temporal features of many real-world problems. In this problem, arc and node costs, arc and node capacities, and supplies and demands can change over time where time is modeled as a continuum. We developed several network-related optimality conditions under the assumption that the input functions are piecewise analytic and the transit times are constant and rational. These results can be used to develop algorithms for solving the minimum cost flow over time problem in a similar way as in static network flows. For example, Theorem 7 lays the ground for an algorithmic approach like the negative cycle-canceling algorithm for the static minimum cost flow problem. This algorithm maintains a feasible solution at each iteration and successively improves the solution towards optimality. More specifically, the algorithm first establishes an initial feasible solution. It then proceeds by identifying negative augmenting cycles and sending flow along these cycles, while preserving feasibility. The algorithm terminates when the network contains no negative cycle. Theorem 7 implies that when the algorithm terminates it has found an optimal solution. Yet, we have to investigate how to implement the essential steps of such an algorithm. Further details are beyond the scope of this paper and are left for further work.

@&#ACKNOWLEDGMENTS@&#

We would like to thank two anonymous referees for many useful comments that helped to improve the presentation of the paper. We are grateful to Martin Skutella for valuable suggestions that enhanced this paper.

Throughout Section 3, for simplicity of notation and clarity of presentation, we have assumed that the cost functions are continuous. This condition ensures that the cost function 
                        
                           
                              
                                 c
                              
                              
                                 Q
                              
                           
                        
                      is continuous and hence attains it minimum at some point on a closed interval. We have used this fact in Lemma 3 to show that there exists a least cost augmenting path in 
                        
                           
                              
                                 P
                              
                              
                                 loc
                              
                           
                        
                     . Here, we show that all results in Sections 3 and 4 hold for the case in which cost functions have some discontinuities. To do so, we require to define the cost of an augmenting path and cycle in a different way.

Let 
                        
                           P
                           :
                           (
                           
                              
                                 v
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 θ
                              
                              
                                 1
                              
                           
                           )
                           ,
                           …
                           ,
                           (
                           
                              
                                 v
                              
                              
                                 q
                              
                           
                           ,
                           
                              
                                 θ
                              
                              
                                 q
                              
                           
                           )
                        
                      be an augmenting path from NTP 
                        
                           (
                           s
                           ,
                           1
                           )
                        
                      to NTP 
                        
                           (
                           t
                           ,
                           T
                           )
                        
                     . We observe that for 
                        
                           k
                           =
                           1
                           ,
                           …
                           ,
                           q
                           -
                           1
                        
                      the following conditions hold:
                        
                           (i)
                           if 
                                 
                                    
                                       
                                          e
                                       
                                       
                                          k
                                       
                                    
                                    =
                                    (
                                    
                                       
                                          v
                                       
                                       
                                          k
                                       
                                    
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                    )
                                    ∈
                                    
                                       
                                          E
                                       
                                       
                                          r
                                       
                                    
                                 
                              , then 
                                 
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                e
                                             
                                             
                                                k
                                             
                                          
                                       
                                       
                                          r
                                       
                                    
                                 
                               is not identically zero on any open interval containing 
                                 
                                    
                                       
                                          θ
                                       
                                       
                                          k
                                       
                                    
                                 
                              ,

if 
                                 
                                    
                                       
                                          v
                                       
                                       
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          v
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          θ
                                       
                                       
                                          k
                                       
                                    
                                    <
                                    
                                       
                                          θ
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                 
                              , then 
                                 
                                    
                                       
                                          U
                                       
                                       
                                          
                                             
                                                v
                                             
                                             
                                                k
                                             
                                          
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    θ
                                    )
                                    >
                                    0
                                 
                               for each 
                                 
                                    θ
                                    ∈
                                    (
                                    
                                       
                                          θ
                                       
                                       
                                          k
                                       
                                    
                                    ,
                                    
                                       
                                          θ
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                    )
                                 
                              ,

if 
                                 
                                    
                                       
                                          v
                                       
                                       
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          v
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          θ
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                    <
                                    
                                       
                                          θ
                                       
                                       
                                          k
                                       
                                    
                                 
                              , then 
                                 
                                    
                                       
                                          L
                                       
                                       
                                          
                                             
                                                v
                                             
                                             
                                                k
                                             
                                          
                                       
                                       
                                          r
                                       
                                    
                                    (
                                    θ
                                    )
                                    >
                                    0
                                 
                               for each 
                                 
                                    θ
                                    ∈
                                    (
                                    
                                       
                                          θ
                                       
                                       
                                          k
                                          +
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          θ
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                              .

In particular, if 
                        
                           Q
                           :
                           (
                           
                              
                                 v
                              
                              
                                 ℓ
                              
                           
                           ,
                           
                              
                                 θ
                              
                              
                                 ℓ
                              
                           
                           )
                           ,
                           …
                           ,
                           (
                           
                              
                                 v
                              
                              
                                 r
                              
                           
                           ,
                           
                              
                                 θ
                              
                              
                                 r
                              
                           
                           )
                        
                      is a maximal arc-subpath of P, then 
                        
                           P
                           
                              
                                 |
                              
                              
                                 Q
                              
                           
                           (
                           α
                           )
                        
                      is also an augmenting path for each 
                        
                           α
                        
                      in 
                        
                           (
                           
                              
                                 θ
                              
                              
                                 ℓ
                              
                           
                           -
                           ∊
                           ,
                           
                              
                                 θ
                              
                              
                                 ℓ
                              
                           
                           )
                        
                      or 
                        
                           (
                           
                              
                                 θ
                              
                              
                                 ℓ
                              
                           
                           ,
                           
                              
                                 θ
                              
                              
                                 ℓ
                              
                           
                           +
                           ∊
                           )
                        
                      for some sufficiently small 
                        
                           ∊
                           >
                           0
                        
                     . Depending on whether 
                        
                           P
                           
                              
                                 |
                              
                              
                                 Q
                              
                           
                           (
                           α
                           )
                        
                      is an augmenting path for each 
                        
                           α
                        
                      in 
                        
                           (
                           
                              
                                 θ
                              
                              
                                 ℓ
                              
                           
                           -
                           ∊
                           ,
                           
                              
                                 θ
                              
                              
                                 ℓ
                              
                           
                           )
                           ,
                           
                           (
                           
                              
                                 θ
                              
                              
                                 ℓ
                              
                           
                           ,
                           
                              
                                 θ
                              
                              
                                 ℓ
                              
                           
                           +
                           ∊
                           )
                        
                     , or 
                        
                           (
                           
                              
                                 θ
                              
                              
                                 ℓ
                              
                           
                           -
                           ∊
                           ,
                           
                              
                                 θ
                              
                              
                                 ℓ
                              
                           
                           +
                           ∊
                           )
                        
                     , we define the cost 
                        
                           
                              
                                 c
                              
                              
                                 ′
                              
                           
                           (
                           Q
                           )
                        
                      of Q as
                        
                           (8)
                           
                              
                                 
                                    c
                                 
                                 
                                    ′
                                 
                              
                              (
                              Q
                              )
                              
                              ≔
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         k
                                                         =
                                                         ℓ
                                                      
                                                      
                                                         r
                                                         -
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      
                                                         
                                                            e
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                
                                                (
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      k
                                                   
                                                
                                                -
                                                )
                                             
                                             
                                                if
                                                
                                                α
                                                
                                                in
                                                
                                                (
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      ℓ
                                                   
                                                
                                                -
                                                ∊
                                                ,
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      ℓ
                                                   
                                                
                                                )
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         k
                                                         =
                                                         ℓ
                                                      
                                                      
                                                         r
                                                         -
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      
                                                         
                                                            e
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                
                                                (
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      k
                                                   
                                                
                                                +
                                                )
                                             
                                             
                                                if
                                                
                                                α
                                                
                                                in
                                                
                                                (
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      ℓ
                                                   
                                                
                                                ,
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      ℓ
                                                   
                                                
                                                +
                                                ∊
                                                )
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         k
                                                         =
                                                         ℓ
                                                      
                                                      
                                                         r
                                                         -
                                                         1
                                                      
                                                   
                                                
                                                
                                                   min
                                                
                                                {
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      
                                                         
                                                            e
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                
                                                (
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      k
                                                   
                                                
                                                -
                                                )
                                                ,
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      
                                                         
                                                            e
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                
                                                (
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      k
                                                   
                                                
                                                +
                                                )
                                                }
                                             
                                             
                                                if
                                                
                                                α
                                                
                                                in
                                                
                                                (
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      ℓ
                                                   
                                                
                                                -
                                                ∊
                                                ,
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      ℓ
                                                   
                                                
                                                +
                                                ∊
                                                )
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           
                              
                                 e
                              
                              
                                 k
                              
                           
                           =
                           (
                           
                              
                                 v
                              
                              
                                 k
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 k
                                 +
                                 1
                              
                           
                           )
                        
                     . Notice that 
                        
                           
                              
                                 c
                              
                              
                                 
                                    
                                       e
                                    
                                    
                                       k
                                    
                                 
                              
                           
                           (
                           
                              
                                 θ
                              
                              
                                 k
                              
                           
                           -
                           )
                        
                      and 
                        
                           
                              
                                 c
                              
                              
                                 
                                    
                                       e
                                    
                                    
                                       k
                                    
                                 
                              
                           
                           (
                           
                              
                                 θ
                              
                              
                                 k
                              
                           
                           +
                           )
                        
                      denote the limit of 
                        
                           
                              
                                 c
                              
                              
                                 
                                    
                                       e
                                    
                                    
                                       k
                                    
                                 
                              
                           
                        
                      at 
                        
                           
                              
                                 θ
                              
                              
                                 k
                              
                           
                        
                      from the left and from the right, respectively, i.e.,
                        
                           
                              
                                 
                                    c
                                 
                                 
                                    
                                       
                                          e
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    θ
                                 
                                 
                                    k
                                 
                              
                              -
                              )
                              
                              ≔
                              
                              
                                 
                                    
                                       lim
                                    
                                    
                                       t
                                       →
                                       
                                          
                                             θ
                                          
                                          
                                             k
                                          
                                          
                                             -
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    c
                                 
                                 
                                    
                                       
                                          e
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                              (
                              θ
                              )
                              
                              and
                              
                              
                                 
                                    c
                                 
                                 
                                    
                                       
                                          e
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    θ
                                 
                                 
                                    k
                                 
                              
                              +
                              )
                              
                              ≔
                              
                              
                                 
                                    
                                       lim
                                    
                                    
                                       t
                                       →
                                       
                                          
                                             θ
                                          
                                          
                                             k
                                          
                                          
                                             +
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    c
                                 
                                 
                                    
                                       
                                          e
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                              (
                              θ
                              )
                              .
                           
                        
                     
                  

We now define the cost 
                     
                        
                           
                              
                                 c
                              
                              
                                 ′
                              
                           
                           (
                           P
                           )
                        
                      of P as 
                        
                           
                              
                                 c
                              
                              
                                 ′
                              
                           
                           (
                           P
                           )
                           
                           ≔
                           
                           
                              
                                 ∑
                              
                              
                                 Q
                              
                           
                           
                              
                                 c
                              
                              
                                 ′
                              
                           
                           (
                           Q
                           )
                        
                     , where the sum is taken over all maximal arc-subpaths Q of P. Notice that 
                        
                           
                              
                                 c
                              
                              
                                 ′
                              
                           
                           (
                           P
                           )
                        
                      is equal to 
                        
                           c
                           (
                           P
                           )
                        
                     , given by(3), for the case that the cost functions are continuous, but in general it is not the case as shown in the following example.
                        Example 2
                        We consider the network shown in Fig. 1
                           (a). The transit costs and transit capacities are as follows:
                              
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      
                                                         
                                                            e
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                                (
                                                θ
                                                )
                                                =
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  1
                                                               
                                                               
                                                                  0
                                                                  ⩽
                                                                  t
                                                                  <
                                                                  0.5
                                                                  ,
                                                               
                                                            
                                                            
                                                               
                                                                  2
                                                               
                                                               
                                                                  0.5
                                                                  ⩽
                                                                  t
                                                                  <
                                                                  1
                                                                  ,
                                                               
                                                            
                                                            
                                                               
                                                                  1
                                                               
                                                               
                                                                  1
                                                                  ⩽
                                                                  t
                                                                  ⩽
                                                                  2
                                                                  ,
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      
                                                         
                                                            e
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                (
                                                θ
                                                )
                                                =
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  1
                                                               
                                                               
                                                                  0
                                                                  ⩽
                                                                  t
                                                                  <
                                                                  1
                                                                  ,
                                                               
                                                            
                                                            
                                                               
                                                                  2
                                                               
                                                               
                                                                  1
                                                                  ⩽
                                                                  t
                                                                  <
                                                                  1.5
                                                                  ,
                                                               
                                                            
                                                            
                                                               
                                                                  1
                                                               
                                                               
                                                                  1.5
                                                                  ⩽
                                                                  t
                                                                  ⩽
                                                                  2
                                                                  ,
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      
                                                         
                                                            e
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                                (
                                                θ
                                                )
                                                =
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  4
                                                                  t
                                                               
                                                               
                                                                  0
                                                                  ⩽
                                                                  t
                                                                  <
                                                                  1
                                                                  ,
                                                               
                                                            
                                                            
                                                               
                                                                  0
                                                               
                                                               
                                                                  1
                                                                  ⩽
                                                                  t
                                                                  <
                                                                  1.5
                                                                  ,
                                                               
                                                            
                                                            
                                                               
                                                                  1
                                                               
                                                               
                                                                  1.5
                                                                  ⩽
                                                                  t
                                                                  ⩽
                                                                  2
                                                                  ,
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      
                                                         
                                                            e
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                (
                                                θ
                                                )
                                                =
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  1
                                                               
                                                               
                                                                  0
                                                                  ⩽
                                                                  t
                                                                  <
                                                                  0.5
                                                                  ,
                                                               
                                                            
                                                            
                                                               
                                                                  0
                                                               
                                                               
                                                                  0.5
                                                                  ⩽
                                                                  t
                                                                  <
                                                                  1
                                                                  ,
                                                               
                                                            
                                                            
                                                               
                                                                  4
                                                                  t
                                                                  -
                                                                  2
                                                               
                                                               
                                                                  1
                                                                  ⩽
                                                                  t
                                                                  ⩽
                                                                  2
                                                                  .
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           The storage capacities are given as
                              
                                 
                                    
                                       
                                          U
                                       
                                       
                                          s
                                       
                                    
                                    (
                                    θ
                                    )
                                    =
                                    ∞
                                    ,
                                    
                                    
                                       
                                          U
                                       
                                       
                                          v
                                       
                                    
                                    (
                                    θ
                                    )
                                    =
                                    1
                                    ,
                                    
                                    
                                       
                                          U
                                       
                                       
                                          t
                                       
                                    
                                    (
                                    θ
                                    )
                                    =
                                    ∞
                                    ,
                                    
                                    θ
                                    ∈
                                    [
                                    0
                                    ,
                                    2
                                    ]
                                    .
                                 
                              
                           The transit times and storage costs are assumed to be zero. The problem is to send an initial storage of one unit from node 1 to node 3 within the time interval 
                              
                                 [
                                 0
                                 ,
                                 2
                                 ]
                              
                           . One possible solution x is obtained as follows. We send flow into arc 
                              
                                 
                                    
                                       e
                                    
                                    
                                       1
                                    
                                 
                              
                            with rate 
                              
                                 2
                                 θ
                              
                            within the interval 
                              
                                 [
                                 0
                                 ,
                                 1
                                 )
                              
                           . The flow arriving at node 2 is stored there till time 1. So there will be one unit of flow at node 2 at time 1. We send this amount of flow into arc 
                              
                                 
                                    
                                       e
                                    
                                    
                                       2
                                    
                                 
                              
                            with rate 
                              
                                 2
                                 θ
                                 -
                                 2
                              
                            within the interval 
                              
                                 [
                                 1
                                 ,
                                 2
                                 ]
                              
                           . Fig. 1(b) shows the flow x in the corresponding time-expanded network. Formally, x is given by
                              
                                 
                                    
                                       
                                          x
                                       
                                       
                                          
                                             
                                                e
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    (
                                    θ
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      2
                                                      θ
                                                   
                                                   
                                                      θ
                                                      ∈
                                                      [
                                                      0
                                                      ,
                                                      1
                                                      )
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      θ
                                                      ∈
                                                      [
                                                      1
                                                      ,
                                                      2
                                                      )
                                                      ,
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                    
                                       
                                          x
                                       
                                       
                                          
                                             
                                                e
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    (
                                    θ
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      θ
                                                      ∈
                                                      [
                                                      0
                                                      ,
                                                      1
                                                      )
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      2
                                                      θ
                                                      -
                                                      2
                                                   
                                                   
                                                      θ
                                                      ∈
                                                      [
                                                      1
                                                      ,
                                                      2
                                                      ]
                                                      ,
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           with corresponding storage
                              
                                 
                                    
                                       
                                          Y
                                       
                                       
                                          s
                                       
                                    
                                    (
                                    θ
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      1
                                                      -
                                                      
                                                         
                                                            θ
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                      θ
                                                      ∈
                                                      [
                                                      0
                                                      ,
                                                      1
                                                      )
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      θ
                                                      ∈
                                                      [
                                                      1
                                                      ,
                                                      2
                                                      )
                                                      ,
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                    
                                       
                                          Y
                                       
                                       
                                          v
                                       
                                    
                                    (
                                    θ
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            θ
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                      θ
                                                      ∈
                                                      [
                                                      0
                                                      ,
                                                      1
                                                      )
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      2
                                                      θ
                                                      -
                                                      
                                                         
                                                            θ
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                      θ
                                                      ∈
                                                      [
                                                      1
                                                      ,
                                                      2
                                                      )
                                                      ,
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                    
                                       
                                          Y
                                       
                                       
                                          w
                                       
                                    
                                    (
                                    θ
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      θ
                                                      ∈
                                                      [
                                                      0
                                                      ,
                                                      1
                                                      )
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            (
                                                            θ
                                                            -
                                                            1
                                                            )
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                      θ
                                                      ∈
                                                      [
                                                      1
                                                      ,
                                                      2
                                                      )
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

We are now interested in identifying the augmenting paths and augmenting cycles. Fig. 1(c) depicts the network with backward arcs and Fig. 1(d) depicts the paths and cycles with positive residual capacities in the corresponding time-expanded network. However, there are more augmenting paths and cycles in addition to those shown in Fig. 1(d), whose residual capacities are zero. Some of them are given below
                              
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      1
                                                   
                                                
                                                :
                                                (
                                                s
                                                ,
                                                0
                                                )
                                                ,
                                                (
                                                2
                                                ,
                                                0
                                                )
                                                ,
                                                (
                                                3
                                                ,
                                                0
                                                )
                                                ,
                                                (
                                                3
                                                ,
                                                2
                                                )
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      2
                                                   
                                                
                                                :
                                                (
                                                s
                                                ,
                                                0
                                                )
                                                ,
                                                (
                                                2
                                                ,
                                                0
                                                )
                                                ,
                                                (
                                                2
                                                ,
                                                0.5
                                                )
                                                ,
                                                (
                                                3
                                                ,
                                                0.5
                                                )
                                                ,
                                                (
                                                3
                                                ,
                                                2
                                                )
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      3
                                                   
                                                
                                                :
                                                (
                                                s
                                                ,
                                                0
                                                )
                                                ,
                                                (
                                                1
                                                ,
                                                0.5
                                                )
                                                ,
                                                (
                                                2
                                                ,
                                                0.5
                                                )
                                                ,
                                                (
                                                3
                                                ,
                                                0.5
                                                )
                                                (
                                                3
                                                ,
                                                2
                                                )
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      4
                                                   
                                                
                                                :
                                                (
                                                s
                                                ,
                                                0
                                                )
                                                ,
                                                (
                                                1
                                                ,
                                                1.5
                                                )
                                                ,
                                                (
                                                2
                                                ,
                                                1.5
                                                )
                                                ,
                                                (
                                                2
                                                ,
                                                2
                                                )
                                                ,
                                                (
                                                3
                                                ,
                                                2
                                                )
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      5
                                                   
                                                
                                                :
                                                (
                                                s
                                                ,
                                                0
                                                )
                                                ,
                                                (
                                                1
                                                ,
                                                2
                                                )
                                                ,
                                                (
                                                2
                                                ,
                                                2
                                                )
                                                ,
                                                (
                                                3
                                                ,
                                                2
                                                )
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      W
                                                   
                                                   
                                                      1
                                                   
                                                
                                                :
                                                (
                                                s
                                                ,
                                                0
                                                )
                                                ,
                                                (
                                                1
                                                ,
                                                2
                                                )
                                                ,
                                                (
                                                2
                                                ,
                                                2
                                                )
                                                ,
                                                (
                                                3
                                                ,
                                                2
                                                )
                                                ,
                                                (
                                                3
                                                ,
                                                1
                                                )
                                                ,
                                                (
                                                2
                                                ,
                                                1
                                                )
                                                ,
                                                (
                                                2
                                                ,
                                                0
                                                )
                                                ,
                                                (
                                                s
                                                ,
                                                0
                                                )
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      W
                                                   
                                                   
                                                      2
                                                   
                                                
                                                :
                                                (
                                                1
                                                ,
                                                1
                                                )
                                                ,
                                                (
                                                1
                                                ,
                                                2
                                                )
                                                ,
                                                (
                                                2
                                                ,
                                                2
                                                )
                                                ,
                                                (
                                                3
                                                ,
                                                2
                                                )
                                                ,
                                                (
                                                3
                                                ,
                                                1.5
                                                )
                                                ,
                                                (
                                                2
                                                ,
                                                1.5
                                                )
                                                ,
                                                (
                                                2
                                                ,
                                                1
                                                )
                                                ,
                                                (
                                                1
                                                ,
                                                1
                                                )
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      W
                                                   
                                                   
                                                      3
                                                   
                                                
                                                :
                                                (
                                                1
                                                ,
                                                0.5
                                                )
                                                ,
                                                (
                                                1
                                                ,
                                                2
                                                )
                                                ,
                                                (
                                                2
                                                ,
                                                2
                                                )
                                                ,
                                                (
                                                3
                                                ,
                                                2
                                                )
                                                ,
                                                (
                                                3
                                                ,
                                                1.5
                                                )
                                                ,
                                                (
                                                2
                                                ,
                                                1.5
                                                )
                                                ,
                                                (
                                                2
                                                ,
                                                0.5
                                                )
                                                ,
                                                (
                                                1
                                                ,
                                                0.5
                                                )
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           with costs
                              
                                 
                                    
                                       
                                          
                                          
                                             
                                                c
                                                (
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                                =
                                                2
                                                ,
                                                
                                                c
                                                (
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                                =
                                                2
                                                ,
                                                
                                                c
                                                (
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      3
                                                   
                                                
                                                )
                                                =
                                                2
                                                ,
                                                
                                                c
                                                (
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      4
                                                   
                                                
                                                )
                                                =
                                                2
                                                ,
                                                
                                                c
                                                (
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      5
                                                   
                                                
                                                )
                                                =
                                                2
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                (
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                                =
                                                2
                                                ,
                                                
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                (
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                                =
                                                1
                                                ,
                                                
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                (
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      3
                                                   
                                                
                                                )
                                                =
                                                2
                                                ,
                                                
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                (
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      4
                                                   
                                                
                                                )
                                                =
                                                2
                                                ,
                                                
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                (
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      5
                                                   
                                                
                                                )
                                                =
                                                2
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           and
                              
                                 
                                    
                                       
                                          
                                          
                                             
                                                c
                                                (
                                                
                                                   
                                                      W
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                                =
                                                -
                                                1
                                                ,
                                                
                                                c
                                                (
                                                
                                                   
                                                      W
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                                =
                                                -
                                                2
                                                ,
                                                
                                                c
                                                (
                                                
                                                   
                                                      W
                                                   
                                                   
                                                      3
                                                   
                                                
                                                )
                                                =
                                                -
                                                2
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                (
                                                
                                                   
                                                      W
                                                   
                                                   
                                                      1
                                                   
                                                
                                                )
                                                =
                                                -
                                                1
                                                ,
                                                
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                (
                                                
                                                   
                                                      W
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                                =
                                                1
                                                ,
                                                
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                (
                                                
                                                   
                                                      W
                                                   
                                                   
                                                      3
                                                   
                                                
                                                )
                                                =
                                                -
                                                1
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           We observe that the equality 
                              
                                 c
                                 (
                                 P
                                 )
                                 =
                                 
                                    
                                       c
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 P
                                 )
                              
                            does not hold for some path or cycle P.

As mentioned already above, an augmenting path (or cycle) must satisfy the conditions (i)–(ii). But the other direction may not hold, that is, a path satisfying these conditions is not necessarily an augmenting path in general. The following paths and cycles show this fact:
                              
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      6
                                                   
                                                
                                                :
                                                (
                                                s
                                                ,
                                                0
                                                )
                                                ,
                                                (
                                                2
                                                ,
                                                0
                                                )
                                                ,
                                                (
                                                2
                                                ,
                                                1
                                                )
                                                ,
                                                (
                                                3
                                                ,
                                                1
                                                )
                                                ,
                                                (
                                                3
                                                ,
                                                2
                                                )
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      7
                                                   
                                                
                                                :
                                                (
                                                s
                                                ,
                                                0
                                                )
                                                ,
                                                (
                                                1
                                                ,
                                                1
                                                )
                                                ,
                                                (
                                                2
                                                ,
                                                1
                                                )
                                                ,
                                                (
                                                3
                                                ,
                                                1
                                                )
                                                ,
                                                (
                                                3
                                                ,
                                                2
                                                )
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      W
                                                   
                                                   
                                                      4
                                                   
                                                
                                                :
                                                (
                                                1
                                                ,
                                                1
                                                )
                                                ,
                                                (
                                                1
                                                ,
                                                2
                                                )
                                                ,
                                                (
                                                2
                                                ,
                                                2
                                                )
                                                ,
                                                (
                                                3
                                                ,
                                                2
                                                )
                                                ,
                                                (
                                                3
                                                ,
                                                1
                                                )
                                                ,
                                                (
                                                2
                                                ,
                                                1
                                                )
                                                ,
                                                (
                                                1
                                                ,
                                                1
                                                )
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Now let 
                        
                           Q
                           :
                           (
                           
                              
                                 v
                              
                              
                                 ℓ
                              
                           
                           ,
                           
                              
                                 θ
                              
                              
                                 ℓ
                              
                           
                           )
                           ,
                           …
                           ,
                           (
                           
                              
                                 v
                              
                              
                                 r
                              
                           
                           ,
                           
                              
                                 θ
                              
                              
                                 r
                              
                           
                           )
                        
                      be an arc-subpath of P. We have observed that there exists an (inclusion-wise) maximal closed interval 
                        
                           [
                           a
                           ,
                           b
                           ]
                        
                     , say, containing 
                        
                           
                              
                                 θ
                              
                              
                                 α
                              
                           
                        
                      so that the path 
                        
                           P
                           
                              
                                 |
                              
                              
                                 Q
                              
                           
                           (
                           α
                           )
                        
                     , given by (4), is an augmenting path for every 
                        
                           α
                           ∈
                           [
                           a
                           ,
                           b
                           ]
                        
                     . We define a cost function 
                        
                           
                              
                                 c
                              
                              
                                 Q
                              
                              
                                 ′
                              
                           
                           :
                           [
                           a
                           ,
                           b
                           ]
                           →
                           R
                        
                      with respect to Q as
                        
                           
                              
                                 
                                    c
                                 
                                 
                                    Q
                                 
                                 
                                    ′
                                 
                              
                              (
                              α
                              )
                              
                              ≔
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         k
                                                      
                                                      
                                                         ℓ
                                                      
                                                   
                                                
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      
                                                         
                                                            e
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                
                                                (
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      k
                                                   
                                                
                                                -
                                                )
                                             
                                             
                                                α
                                                =
                                                v
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         k
                                                      
                                                      
                                                         ℓ
                                                      
                                                   
                                                
                                                
                                                   min
                                                
                                                {
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      
                                                         
                                                            e
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                
                                                (
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      k
                                                   
                                                
                                                -
                                                )
                                                ,
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      
                                                         
                                                            e
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                
                                                (
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      k
                                                   
                                                
                                                +
                                                )
                                                }
                                             
                                             
                                                α
                                                ∈
                                                (
                                                u
                                                ,
                                                v
                                                )
                                                ,
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         k
                                                      
                                                      
                                                         ℓ
                                                      
                                                   
                                                
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      
                                                         
                                                            e
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                
                                                (
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      k
                                                   
                                                
                                                +
                                                )
                                             
                                             
                                                α
                                                =
                                                u
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           
                              
                                 e
                              
                              
                                 k
                              
                           
                           =
                           (
                           
                              
                                 v
                              
                              
                                 k
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 k
                                 +
                                 1
                              
                           
                           )
                        
                     . We recall that 
                        
                           
                              
                                 α
                              
                              
                                 ℓ
                              
                           
                           =
                           α
                        
                      and 
                        
                           
                              
                                 α
                              
                              
                                 k
                                 +
                                 1
                              
                           
                           (
                           α
                           )
                           =
                           
                              
                                 α
                              
                              
                                 k
                              
                           
                           +
                           
                              
                                 τ
                              
                              
                                 
                                    
                                       e
                                    
                                    
                                       
                                          
                                             e
                                          
                                          
                                             k
                                          
                                       
                                    
                                 
                              
                           
                        
                      for 
                        
                           k
                           =
                           ℓ
                           ,
                           …
                           ,
                           r
                           -
                           1
                        
                     . For the case that 
                        
                           u
                           =
                           v
                           =
                           
                              
                                 t
                              
                              
                                 ℓ
                              
                           
                        
                     , we define 
                        
                           
                              
                                 c
                              
                              
                                 Q
                              
                              
                                 ′
                              
                           
                           (
                           α
                           )
                           
                           ≔
                           
                           
                              
                                 c
                              
                              
                                 ′
                              
                           
                           (
                           Q
                           )
                        
                     , where 
                        
                           
                              
                                 c
                              
                              
                                 ′
                              
                           
                           (
                           Q
                           )
                        
                      is given by (8). The function 
                        
                           
                              
                                 c
                              
                              
                                 Q
                              
                              
                                 ′
                              
                           
                        
                      is lower semi-continuous at any point 
                        
                           α
                           ∈
                           [
                           a
                           ,
                           b
                           ]
                        
                      and such a function attains its local minimum on a closed interval. This fact shows that Theorems 4 and 5 hold.

We next proceed to show that the results in Section 4 are still valid. We consider a feasible flow x and suppose that 
                        
                           W
                           :
                           (
                           
                              
                                 v
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 θ
                              
                              
                                 1
                              
                           
                           )
                           ,
                           …
                           ,
                           (
                           
                              
                                 v
                              
                              
                                 q
                              
                           
                           ,
                           
                              
                                 θ
                              
                              
                                 q
                              
                           
                           )
                        
                      is an augmenting cycle. We have defined the cost of W in two different ways: 
                        
                           
                              
                                 c
                              
                              
                                 ′
                              
                           
                           (
                           W
                           )
                        
                      in terms of the cost of arc-subpaths of W and 
                        
                           c
                           (
                           W
                           )
                        
                      as the sum of the costs of the arcs at the times they appear around the cycle W. Further, we have observed that these two values are not equal in general. However, we have the following result taht provides another characterization of augmenting cycles with negative cost.
                        Lemma 5
                        
                           Let x be a piecewise analytic flow. The network G contains a negative augmenting cycle if and only if there is a cycle W with 
                           
                              
                                 cap
                                 (
                                 W
                                 )
                                 >
                                 0
                              
                            
                           and 
                           
                              
                                 
                                    
                                       c
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 W
                                 )
                                 <
                                 0
                              
                           
                           .
                        

Suppose first that W is a cycle with 
                              
                                 cap
                                 (
                                 W
                                 )
                                 >
                                 0
                              
                            and 
                              
                                 
                                    
                                       c
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 W
                                 )
                                 <
                                 0
                              
                           . Clearly W is an augmenting cycle since 
                              
                                 cap
                                 (
                                 W
                                 )
                                 >
                                 0
                              
                           . So we need to show that 
                              
                                 c
                                 (
                                 W
                                 )
                                 <
                                 0
                              
                           . Recall that 
                              
                                 c
                                 (
                                 W
                                 )
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       Q
                                    
                                 
                                 c
                                 (
                                 Q
                                 )
                              
                            where sum is taken over all maximal arc-subpaths Q of W and 
                              
                                 c
                                 (
                                 Q
                                 )
                              
                            is computed by (3). For each maximal arc-subpath 
                              
                                 Q
                                 :
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       ℓ
                                    
                                 
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       ℓ
                                    
                                 
                                 )
                                 ,
                                 …
                                 ,
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       r
                                    
                                 
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       r
                                    
                                 
                                 )
                              
                            of W, we define 
                              
                                 
                                    
                                       c
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 Q
                                 )
                                 
                                 ≔
                                 
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       :
                                       (
                                       
                                          
                                             v
                                          
                                          
                                             k
                                          
                                       
                                       ,
                                       
                                          
                                             v
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                       
                                       )
                                       ∈
                                       
                                          
                                             E
                                          
                                          
                                             r
                                          
                                       
                                    
                                 
                                 
                                    
                                       c
                                    
                                    
                                       
                                          
                                             v
                                          
                                          
                                             k
                                          
                                       
                                       ,
                                       
                                          
                                             v
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       θ
                                    
                                    
                                       k
                                    
                                 
                                 )
                              
                            where the index k varies from 
                              
                                 ℓ
                              
                            to 
                              
                                 r
                                 -
                                 1
                              
                           . The fact that 
                              
                                 cap
                                 (
                                 W
                                 )
                                 >
                                 0
                              
                            implies that there exists some 
                              
                                 ∊
                                 >
                                 0
                              
                            so that 
                              
                                 W
                                 
                                    
                                       |
                                    
                                    
                                       Q
                                    
                                 
                                 (
                                 α
                                 )
                              
                            is an augmenting cycle for each 
                              
                                 α
                                 ∈
                                 (
                                 
                                    
                                       θ
                                    
                                    
                                       ℓ
                                    
                                 
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       ℓ
                                    
                                 
                                 +
                                 ∊
                                 )
                              
                           . Due to the definition of 
                              
                                 c
                                 (
                                 Q
                                 )
                              
                            and 
                              
                                 
                                    
                                       c
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 Q
                                 )
                              
                            and the fact that cost functions are right-continuous, we can conclude 
                              
                                 c
                                 (
                                 Q
                                 )
                                 ⩽
                                 
                                    
                                       c
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 Q
                                 )
                              
                           . Therefore, 
                              
                                 c
                                 (
                                 W
                                 )
                                 ⩽
                                 
                                    
                                       c
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 W
                                 )
                              
                            which gives the result in one direction.

To prove the other direction, suppose that W is a negative augmenting cycle. Let 
                              
                                 Q
                                 :
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       ℓ
                                    
                                 
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       ℓ
                                    
                                 
                                 )
                                 ,
                                 …
                                 ,
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       r
                                    
                                 
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       r
                                    
                                 
                                 )
                              
                            be a maximal arc-subpath of W. Then we know that there is some 
                              
                                 ∊
                                 >
                                 0
                              
                            such that 
                              
                                 W
                                 
                                    
                                       |
                                    
                                    
                                       Q
                                    
                                 
                                 (
                                 α
                                 )
                              
                            is also an augmenting cycle for each 
                              
                                 α
                              
                            in 
                              
                                 (
                                 
                                    
                                       θ
                                    
                                    
                                       ℓ
                                    
                                 
                                 -
                                 ∊
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       ℓ
                                    
                                 
                                 )
                              
                            or 
                              
                                 (
                                 
                                    
                                       θ
                                    
                                    
                                       ℓ
                                    
                                 
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       ℓ
                                    
                                 
                                 +
                                 ∊
                                 )
                              
                           . We assume without loss of generality that 
                              
                                 W
                                 
                                    
                                       |
                                    
                                    
                                       Q
                                    
                                 
                                 (
                                 α
                                 )
                              
                            is an augmenting cycle for each 
                              
                                 α
                              
                            in 
                              
                                 (
                                 
                                    
                                       θ
                                    
                                    
                                       ℓ
                                    
                                 
                                 -
                                 ∊
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       ℓ
                                    
                                 
                                 )
                              
                           . Then for some 
                              
                                 α
                                 ∈
                                 (
                                 
                                    
                                       θ
                                    
                                    
                                       ℓ
                                    
                                 
                                 -
                                 ∊
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       ℓ
                                    
                                 
                                 )
                              
                           , we have 
                              
                                 |
                                 
                                    
                                       c
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 Q
                                 (
                                 α
                                 )
                                 )
                                 -
                                 c
                                 (
                                 Q
                                 )
                                 |
                                 <
                                 ∊
                              
                           . Here 
                              
                                 Q
                                 (
                                 α
                                 )
                              
                            denotes the arc path 
                              
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       ℓ
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       ℓ
                                       +
                                       1
                                    
                                 
                                 )
                                 ,
                                 …
                                 ,
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       r
                                       -
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       r
                                    
                                 
                                 )
                              
                            with starting time 
                              
                                 α
                              
                           . More precisely, we have 
                              
                                 Q
                                 (
                                 α
                                 )
                                 :
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       ℓ
                                    
                                 
                                 ,
                                 
                                    
                                       α
                                    
                                    
                                       ℓ
                                    
                                 
                                 )
                                 ,
                                 …
                                 ,
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       r
                                    
                                 
                                 ,
                                 
                                    
                                       α
                                    
                                    
                                       r
                                    
                                 
                                 )
                              
                            where 
                              
                                 
                                    
                                       α
                                    
                                    
                                       ℓ
                                    
                                 
                                 =
                                 α
                              
                            and 
                              
                                 
                                    
                                       α
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 (
                                 α
                                 )
                                 =
                                 
                                    
                                       α
                                    
                                    
                                       k
                                    
                                 
                                 +
                                 
                                    
                                       π
                                    
                                    
                                       
                                          
                                             v
                                          
                                          
                                             k
                                          
                                       
                                       ,
                                       
                                          
                                             v
                                          
                                          
                                             k
                                             +
                                             1
                                          
                                       
                                    
                                 
                              
                            for 
                              
                                 k
                                 =
                                 ℓ
                                 ,
                                 …
                                 ,
                                 r
                                 -
                                 1
                              
                           . Further, 
                              
                                 α
                              
                            can be chosen in such a way that 
                              
                                 cap
                                 (
                                 Q
                                 (
                                 α
                                 )
                                 )
                                 >
                                 0
                              
                           . Now we consider the cycle 
                              
                                 W
                                 
                                    
                                       |
                                    
                                    
                                       Q
                                    
                                 
                                 (
                                 α
                                 )
                              
                            and repeat the above procedure for all remaining maximal arc-subpaths of W. Let 
                              
                                 
                                    
                                       W
                                    
                                    
                                       ′
                                    
                                 
                              
                            be the resulting cycle. It is easy to see that for sufficiently small 
                              
                                 ∊
                                 >
                                 0
                              
                           , we get 
                              
                                 cap
                                 (
                                 
                                    
                                       W
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 >
                                 0
                              
                            and 
                              
                                 
                                    
                                       c
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 
                                    
                                       W
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 <
                                 0
                              
                           .□

This lemma implies that all results in Section 4 remain valid even if the cost functions have some discontinuities.

@&#REFERENCES@&#

